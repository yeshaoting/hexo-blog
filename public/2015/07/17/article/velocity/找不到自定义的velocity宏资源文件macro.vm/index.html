
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>找不到自定义的velocity宏资源文件macro.vm | 芳草地</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="yeshaoting">
    

    
    <meta name="description" content="[TOC]
异常描述：VelocityException: Velocimacro : Error using VM library : /WEB-INF/vm/macro.vm问题原因：路径配置错误。
一、项目相关配置1. spring-beans.xmlspring bean velocityEngine1234&amp;lt;bean id=&quot;velocityEngine&quot; class=&quot;org.s">
<meta property="og:type" content="article">
<meta property="og:title" content="找不到自定义的velocity宏资源文件macro.vm">
<meta property="og:url" content="http://yeshaoting.github.io/2015/07/17/article/velocity/找不到自定义的velocity宏资源文件macro.vm/index.html">
<meta property="og:site_name" content="芳草地">
<meta property="og:description" content="[TOC]
异常描述：VelocityException: Velocimacro : Error using VM library : /WEB-INF/vm/macro.vm问题原因：路径配置错误。
一、项目相关配置1. spring-beans.xmlspring bean velocityEngine1234&amp;lt;bean id=&quot;velocityEngine&quot; class=&quot;org.s">
<meta property="og:updated_time" content="2015-07-17T08:41:41.508Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="找不到自定义的velocity宏资源文件macro.vm">
<meta name="twitter:description" content="[TOC]
异常描述：VelocityException: Velocimacro : Error using VM library : /WEB-INF/vm/macro.vm问题原因：路径配置错误。
一、项目相关配置1. spring-beans.xmlspring bean velocityEngine1234&amp;lt;bean id=&quot;velocityEngine&quot; class=&quot;org.s">

    
    <link rel="alternative" href="/atom.xml" title="芳草地" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="芳草地" title="芳草地"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="芳草地">芳草地</a></h1>
				<h2 class="blog-motto">我不是最棒的，但注定我是最有希望的。</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:yeshaoting.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/17/article/velocity/找不到自定义的velocity宏资源文件macro.vm/" title="找不到自定义的velocity宏资源文件macro.vm" itemprop="url">找不到自定义的velocity宏资源文件macro.vm</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="yeshaoting" target="_blank" itemprop="author">yeshaoting</a>
		
  <p class="article-time">
    <time datetime="2015-07-17T08:41:41.508Z" itemprop="datePublished"> 发表于 2015-07-17</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、项目相关配置"><span class="toc-number">1.</span> <span class="toc-text">一、项目相关配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-_spring-beans-xml"><span class="toc-number">1.1.</span> <span class="toc-text">1. spring-beans.xml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-_velocity-properties"><span class="toc-number">1.2.</span> <span class="toc-text">2. velocity.properties</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、解析异常原因"><span class="toc-number">2.</span> <span class="toc-text">二、解析异常原因</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#模板加载配置"><span class="toc-number">2.1.</span> <span class="toc-text">模板加载配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FileResourceLoader说明"><span class="toc-number">2.2.</span> <span class="toc-text">FileResourceLoader说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、小结"><span class="toc-number">3.</span> <span class="toc-text">三、小结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、参考文档"><span class="toc-number">4.</span> <span class="toc-text">四、参考文档</span></a></li></ol>
		
		</div>
		
		<p>[TOC]</p>
<p>异常描述：VelocityException: Velocimacro : Error using VM library : /WEB-INF/vm/macro.vm<br>问题原因：路径配置错误。</p>
<h2 id="一、项目相关配置">一、项目相关配置</h2><h3 id="1-_spring-beans-xml">1. spring-beans.xml</h3><p>spring bean velocityEngine<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">bean</span> <span class="attribute">id</span>=<span class="value">"velocityEngine"</span> <span class="attribute">class</span>=<span class="value">"org.springframework.ui.velocity.VelocityEngineFactoryBean"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"resourceLoaderPath"</span> <span class="attribute">value</span>=<span class="value">"/WEB-INF/vm/"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">property</span> <span class="attribute">name</span>=<span class="value">"configLocation"</span> <span class="attribute">value</span>=<span class="value">"classpath:velocity.properties"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="2-_velocity-properties">2. velocity.properties</h3><p>宏资源文件配置<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">velocimacro.library=/WEB-INF/vm/macro.vm</span><br></pre></td></tr></table></figure></p>
<a id="more"></a>
<h2 id="二、解析异常原因">二、解析异常原因</h2><p>首先，默认velocity模板加载方式为file，对应的资源加载类为：<code>org.apache.velocity.runtime.resource.loader.FileResourceLoader</code>。参见如下 <strong>模板加载配置</strong> 以及 <strong>FileResourceLoader说明</strong> 。</p>
<p>从模板目录/WEB-INF/vm/加载模块文件(<code>ResourceManagerImpl.getResource</code>)。</p>
<p>如果模板文件没有缓存(<code>ResourceManagerImpl.globalCacheglobalCache</code>)，则从目录文件中加载(<code>ResourceManagerImpl.loadResource</code>)。</p>
<p>加载过程中，加载资源文件流，解析并初始化。<code>org.apache.velocity.Template.process()</code><br>此时，调用资源文件加载类FileResourceLoader加载文件。</p>
<p>FileResourceLoader在file.resource.loader.path目录，即spring-beans.xml中配置的resourceLoaderPath目录通过模板名查找并加载模板。<br>如果resourceLoaderPath未配置或者为空的话，则通过绝对路径加载模板；否则，相对于resourceLoaderPath查找模板。<br>如果resourceLoaderPath不为空，模板路径velocimacro.library以/开头，则直接去除/。</p>
<h3 id="模板加载配置">模板加载配置</h3><p>默认的velocity.properties in package <code>org.apache.velocity.runtime.defaults</code>。<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resource.loader = file&#10;&#10;file.resource.loader.description = Velocity File Resource Loader&#10;file.resource.loader.class = org.apache.velocity.runtime.resource.loader.FileResourceLoader&#10;file.resource.loader.path = .&#10;file.resource.loader.cache = false&#10;file.resource.loader.modificationCheckInterval = 2</span><br></pre></td></tr></table></figure></p>
<h3 id="FileResourceLoader说明">FileResourceLoader说明</h3><p>A loader for templates stored on the file system. Treats the template as relative to the configured root path. If the root path is empty treats the template name as an absolute path.</p>
<h2 id="三、小结">三、小结</h2><p>因此，对于当前的项目配置来说，velocity框架实际上是在/WEB-INF/vm/WEB-INF/vm/macro.vm目录加载模板文件macro.vm。</p>
<p><strong>注</strong>：如果希望在class目录加载模板文件，可以考试设置资源文件加载类为：org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader。</p>
<p>修改velocity.properties配置：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resource.loader = class&#10;class.resource.loader.class = org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader&#10;&#10;velocimacro.library=macro.vm</span><br></pre></td></tr></table></figure></p>
<h2 id="四、参考文档">四、参考文档</h2><p><a href="http://stackoverflow.com/questions/3443819/velocity-cant-find-resource" target="_blank" rel="external">http://stackoverflow.com/questions/3443819/velocity-cant-find-resource</a><br><a href="http://velocity.apache.org/engine/releases/velocity-1.6.4/developer-guide.html#Configuring_Resource_Loaders" target="_blank" rel="external">http://velocity.apache.org/engine/releases/velocity-1.6.4/developer-guide.html#Configuring_Resource_Loaders</a><br><a href="http://velocity.apache.org/engine/releases/velocity-1.6.4/apidocs/org/apache/velocity/runtime/resource/loader/ClasspathResourceLoader.html" target="_blank" rel="external">http://velocity.apache.org/engine/releases/velocity-1.6.4/apidocs/org/apache/velocity/runtime/resource/loader/ClasspathResourceLoader.html</a></p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/velocity/">velocity</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://yeshaoting.github.io/2015/07/17/article/velocity/找不到自定义的velocity宏资源文件macro.vm/" data-title="找不到自定义的velocity宏资源文件macro.vm | 芳草地" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/07/17/article/web/自定义taglib/" title="自定义taglib">
  <strong>上一篇：</strong><br/>
  <span>
  自定义taglib</span>
</a>
</div>


<div class="next">
<a href="/2015/07/17/article/spring/spring整合实践 - velocity/"  title="spring整合实践 - velocity">
 <strong>下一篇：</strong><br/> 
 <span>spring整合实践 - velocity
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread" data-thread-key="2015/07/17/article/velocity/找不到自定义的velocity宏资源文件macro.vm/" data-title="找不到自定义的velocity宏资源文件macro.vm" data-url="http://yeshaoting.github.io/2015/07/17/article/velocity/找不到自定义的velocity宏资源文件macro.vm/"></div>
</section>


</div>  

      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、项目相关配置"><span class="toc-number">1.</span> <span class="toc-text">一、项目相关配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-_spring-beans-xml"><span class="toc-number">1.1.</span> <span class="toc-text">1. spring-beans.xml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-_velocity-properties"><span class="toc-number">1.2.</span> <span class="toc-text">2. velocity.properties</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、解析异常原因"><span class="toc-number">2.</span> <span class="toc-text">二、解析异常原因</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#模板加载配置"><span class="toc-number">2.1.</span> <span class="toc-text">模板加载配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FileResourceLoader说明"><span class="toc-number">2.2.</span> <span class="toc-text">FileResourceLoader说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、小结"><span class="toc-number">3.</span> <span class="toc-text">三、小结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、参考文档"><span class="toc-number">4.</span> <span class="toc-text">四、参考文档</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/git/" title="git">git<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/java/" title="java">java<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/linux/" title="linux">linux<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/spring/" title="spring">spring<sup>3</sup></a></li>
		  
		
		  
		
		  
			<li><a href="/categories/web/" title="web">web<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/开发工具/" title="开发工具">开发工具<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/数据库/" title="数据库">数据库<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/linux/" title="linux">linux<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/集锦/" title="集锦">集锦<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/spring/" title="spring">spring<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/小记/" title="小记">小记<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/git/" title="git">git<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/java/" title="java">java<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/mysql/" title="mysql">mysql<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/velocity/" title="velocity">velocity<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/spring特性实践/" title="spring特性实践">spring特性实践<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/spring整合实践/" title="spring整合实践">spring整合实践<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/服务器/" title="服务器">服务器<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/开发工具/" title="开发工具">开发工具<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/nginx/" title="nginx">nginx<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/五笔/" title="五笔">五笔<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/命令/" title="命令">命令<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/ubuntu/" title="ubuntu">ubuntu<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/软件/" title="软件">软件<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/tablib/" title="tablib">tablib<sup>1</sup></a></li>
			
		
			
		
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://jarg.iteye.com" target="_blank" title="爪哇哥的爪哇岛">爪哇哥的爪哇岛</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello, I&#39;m yeshaoting in Sohu. <br/>
			This is my blog, believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/1873363984" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/yeshaoting" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
		<a href="mailto:yeshaoting@163.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2015 
		
		<a href="/about" target="_blank" title="yeshaoting">yeshaoting</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"yeshaoting"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
